<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Place.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">prodDebug</a> &gt; <a href="index.source.html" class="el_package">fr.free.nrw.commons.nearby</a> &gt; <span class="el_source">Place.java</span></div><h1>Place.java</h1><pre class="source lang-java linenums">package fr.free.nrw.commons.nearby;

import android.net.Uri;
import android.os.Parcel;
import android.os.Parcelable;
import android.text.TextUtils;
import androidx.annotation.Nullable;
import org.apache.commons.lang3.StringUtils;
import fr.free.nrw.commons.location.LatLng;
import fr.free.nrw.commons.nearby.model.NearbyResultItem;
import fr.free.nrw.commons.utils.PlaceUtils;
import timber.log.Timber;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

/**
 * A single geolocated Wikidata item
 */
public class Place implements Parcelable {

    public final String language;

    public final String name;

    private final Label label;

    private final String longDescription;

    public final LatLng location;

    private final String category;

    public final String pic;

    // For a place to be existing both destroyed and endTime property should be null but it is also not necessary for a non-existing place to have both properties either one property is enough (in such case that not given property will be considered as null).
    public final Boolean exists;

    public String distance;

    public final Sitelinks siteLinks;

    private boolean isMonument;

    private String thumb;

<span class="nc" id="L45">    public Place() {</span>
<span class="nc" id="L46">        language = null;</span>
<span class="nc" id="L47">        name = null;</span>
<span class="nc" id="L48">        label = null;</span>
<span class="nc" id="L49">        longDescription = null;</span>
<span class="nc" id="L50">        location = null;</span>
<span class="nc" id="L51">        category = null;</span>
<span class="nc" id="L52">        pic = null;</span>
<span class="nc" id="L53">        exists = null;</span>
<span class="nc" id="L54">        siteLinks = null;</span>
<span class="nc" id="L55">    }</span>

<span class="fc" id="L57">    public Place(String language, String name, Label label, String longDescription, LatLng location, String category, Sitelinks siteLinks, String pic, Boolean exists) {</span>
<span class="fc" id="L58">        this.language = language;</span>
<span class="fc" id="L59">        this.name = name;</span>
<span class="fc" id="L60">        this.label = label;</span>
<span class="fc" id="L61">        this.longDescription = longDescription;</span>
<span class="fc" id="L62">        this.location = location;</span>
<span class="fc" id="L63">        this.category = category;</span>
<span class="fc" id="L64">        this.siteLinks = siteLinks;</span>
<span class="pc bpc" id="L65" title="1 of 2 branches missed.">        this.pic = (pic == null) ? &quot;&quot; : pic;</span>
<span class="fc" id="L66">        this.exists = exists;</span>
<span class="fc" id="L67">    }</span>

<span class="nc" id="L69">    public Place(String name, String longDescription, LatLng location, String category, Sitelinks siteLinks, String pic, String thumb) {</span>
<span class="nc" id="L70">        this.name = name;</span>
<span class="nc" id="L71">        this.longDescription = longDescription;</span>
<span class="nc" id="L72">        this.location = location;</span>
<span class="nc" id="L73">        this.category = category;</span>
<span class="nc" id="L74">        this.siteLinks = siteLinks;</span>
<span class="nc bnc" id="L75" title="All 2 branches missed.">        this.pic = (pic == null) ? &quot;&quot; : pic;</span>
<span class="nc bnc" id="L76" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3553)) {</span>
<span class="nc" id="L77">            this.thumb = thumb;</span>
        }
<span class="nc" id="L79">        this.language = null;</span>
<span class="nc" id="L80">        this.label = null;</span>
<span class="nc" id="L81">        this.exists = true;</span>
<span class="nc" id="L82">    }</span>

<span class="nc" id="L84">    public Place(Parcel in) {</span>
<span class="nc" id="L85">        this.language = in.readString();</span>
<span class="nc" id="L86">        this.name = in.readString();</span>
<span class="nc" id="L87">        this.label = (Label) in.readSerializable();</span>
<span class="nc" id="L88">        this.longDescription = in.readString();</span>
<span class="nc" id="L89">        this.location = in.readParcelable(LatLng.class.getClassLoader());</span>
<span class="nc" id="L90">        this.category = in.readString();</span>
<span class="nc" id="L91">        this.siteLinks = in.readParcelable(Sitelinks.class.getClassLoader());</span>
<span class="nc" id="L92">        String picString = in.readString();</span>
<span class="nc bnc" id="L93" title="All 2 branches missed.">        this.pic = (picString == null) ? &quot;&quot; : picString;</span>
<span class="nc" id="L94">        String existString = in.readString();</span>
<span class="nc" id="L95">        this.exists = Boolean.parseBoolean(existString);</span>
<span class="nc bnc" id="L96" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3554)) {</span>
<span class="nc bnc" id="L97" title="All 2 branches missed.">            this.isMonument = in.readInt() == 1;</span>
        }
<span class="nc" id="L99">    }</span>

    public static Place from(NearbyResultItem item) {
<span class="fc" id="L102">        String itemClass = item.getClassName().getValue();</span>
<span class="fc" id="L103">        String classEntityId = &quot;&quot;;</span>
<span class="pc bpc" id="L104" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3556)) {</span>
<span class="pc bpc" id="L105" title="1 of 2 branches missed.">            if (!StringUtils.isBlank(itemClass)) {</span>
<span class="pc bpc" id="L106" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(3555)) {</span>
<span class="fc" id="L107">                    classEntityId = itemClass.replace(&quot;http://www.wikidata.org/entity/&quot;, &quot;&quot;);</span>
                }
            }
        }
        // Set description when not null and not empty
<span class="pc bpc" id="L112" title="6 of 10 branches missed.">        String description = ((ListenerUtil.mutListener.listen(3557) ? (item.getDescription().getValue() != null || !item.getDescription().getValue().isEmpty()) : (item.getDescription().getValue() != null &amp;&amp; !item.getDescription().getValue().isEmpty()))) ? item.getDescription().getValue() : &quot;&quot;;</span>
<span class="pc bpc" id="L113" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3560)) {</span>
            // When description is &quot;?&quot; but we have a valid label, just use the label. So replace &quot;?&quot; by &quot;&quot; in description
<span class="pc bpc" id="L115" title="24 of 26 branches missed.">            description = ((ListenerUtil.mutListener.listen(3559) ? (description.equals(&quot;?&quot;) || ((ListenerUtil.mutListener.listen(3558) ? (item.getLabel().getValue() != null || !item.getLabel().getValue().isEmpty()) : (item.getLabel().getValue() != null &amp;&amp; !item.getLabel().getValue().isEmpty())))) : (description.equals(&quot;?&quot;) &amp;&amp; ((ListenerUtil.mutListener.listen(3558) ? (item.getLabel().getValue() != null || !item.getLabel().getValue().isEmpty()) : (item.getLabel().getValue() != null &amp;&amp; !item.getLabel().getValue().isEmpty()))))) ? &quot;&quot; : description);</span>
        }
<span class="pc bpc" id="L117" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3563)) {</span>
            /*
         * If we have a valid label
         *     - If have a valid label add the description at the end of the string with parenthesis
         *     - If we don't have a valid label, string will include only the description. So add it without paranthesis
         */
<span class="pc bpc" id="L123" title="13 of 20 branches missed.">            description = (((ListenerUtil.mutListener.listen(3561) ? (item.getLabel().getValue() != null || !item.getLabel().getValue().isEmpty()) : (item.getLabel().getValue() != null &amp;&amp; !item.getLabel().getValue().isEmpty()))) ? item.getLabel().getValue() + (((ListenerUtil.mutListener.listen(3562) ? (description != null || !description.isEmpty()) : (description != null &amp;&amp; !description.isEmpty()))) ? &quot; (&quot; + description + &quot;)&quot; : &quot;&quot;) : description);</span>
        }
<span class="fc" id="L125">        return new Place(item.getLabel().getLanguage(), item.getLabel().getValue(), // list</span>
<span class="fc" id="L126">        Label.fromText(classEntityId), // description and label of Wikidata item</span>
<span class="pc bpc" id="L127" title="1 of 2 branches missed.">        description, PlaceUtils.latLngFromPointString(item.getLocation().getValue()), item.getCommonsCategory().getValue(), new Sitelinks.Builder().setWikipediaLink(item.getWikipediaArticle().getValue()).setCommonsLink(item.getCommonsArticle().getValue()).setWikidataLink(item.getItem().getValue()).build(), item.getPic().getValue(), (ListenerUtil.mutListener.listen(3564) ? (// Checking if the place exists or not</span>
<span class="pc bnc" id="L128" title="All 4 branches missed.">        (item.getDestroyed().getValue() == &quot;&quot;) || (item.getEndTime().getValue() == &quot;&quot;)) : (// Checking if the place exists or not</span>
<span class="pc bpc" id="L129" title="2 of 4 branches missed.">        (item.getDestroyed().getValue() == &quot;&quot;) &amp;&amp; (item.getEndTime().getValue() == &quot;&quot;))));</span>
    }

    /**
     * Gets the language of the caption ie name.
     * @return language
     */
    public String getLanguage() {
<span class="nc" id="L137">        return language;</span>
    }

    /**
     * Gets the name of the place
     * @return name
     */
    public String getName() {
<span class="nc" id="L145">        return name;</span>
    }

    /**
     * Gets the label of the place
     * e.g. &quot;building&quot;, &quot;city&quot;, etc
     * @return label
     */
    public Label getLabel() {
<span class="fc" id="L154">        return label;</span>
    }

    public LatLng getLocation() {
<span class="nc" id="L158">        return location;</span>
    }

    /**
     * Gets the long description of the place
     * @return long description
     */
    public String getLongDescription() {
<span class="fc" id="L166">        return longDescription;</span>
    }

    /**
     * Gets the Commons category of the place
     * @return Commons category
     */
    public String getCategory() {
<span class="nc" id="L174">        return category;</span>
    }

    /**
     * Sets the distance of the place from the user's location
     * @param distance distance of place from user's location
     */
    public void setDistance(String distance) {
<span class="pc bpc" id="L182" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3565)) {</span>
<span class="fc" id="L183">            this.distance = distance;</span>
        }
<span class="fc" id="L185">    }</span>

    /**
     * Extracts the entity id from the wikidata link
     * @return returns the entity id if wikidata link destroyed
     */
    @Nullable
    public String getWikiDataEntityId() {
<span class="pc bpc" id="L193" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3567)) {</span>
<span class="pc bpc" id="L194" title="1 of 2 branches missed.">            if (!hasWikidataLink()) {</span>
<span class="nc bnc" id="L195" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(3566)) {</span>
<span class="nc" id="L196">                    Timber.d(&quot;Wikidata entity ID is null for place with sitelink %s&quot;, siteLinks.toString());</span>
                }
<span class="nc" id="L198">                return null;</span>
            }
        }
<span class="fc" id="L201">        String wikiDataLink = siteLinks.getWikidataLink().toString();</span>
<span class="fc" id="L202">        return wikiDataLink.replace(&quot;http://www.wikidata.org/entity/&quot;, &quot;&quot;);</span>
    }

    /**
     * Checks if the Wikidata item has a Wikipedia page associated with it
     * @return true if there is a Wikipedia link
     */
    public boolean hasWikipediaLink() {
<span class="nc bnc" id="L210" title="All 10 branches missed.">        return !((ListenerUtil.mutListener.listen(3568) ? (siteLinks == null &amp;&amp; Uri.EMPTY.equals(siteLinks.getWikipediaLink())) : (siteLinks == null || Uri.EMPTY.equals(siteLinks.getWikipediaLink()))));</span>
    }

    /**
     * Checks if the Wikidata item has a Wikidata page associated with it
     * @return true if there is a Wikidata link
     */
    public boolean hasWikidataLink() {
<span class="pc bpc" id="L218" title="7 of 10 branches missed.">        return !((ListenerUtil.mutListener.listen(3569) ? (siteLinks == null &amp;&amp; Uri.EMPTY.equals(siteLinks.getWikidataLink())) : (siteLinks == null || Uri.EMPTY.equals(siteLinks.getWikidataLink()))));</span>
    }

    /**
     * Checks if the Wikidata item has a Commons page associated with it
     * @return true if there is a Commons link
     */
    public boolean hasCommonsLink() {
<span class="pc bpc" id="L226" title="6 of 10 branches missed.">        return !((ListenerUtil.mutListener.listen(3570) ? (siteLinks == null &amp;&amp; Uri.EMPTY.equals(siteLinks.getCommonsLink())) : (siteLinks == null || Uri.EMPTY.equals(siteLinks.getCommonsLink()))));</span>
    }

    /**
     * Sets that this place in nearby is a WikiData monument
     * @param monument
     */
    public void setMonument(final boolean monument) {
<span class="pc bpc" id="L234" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3571)) {</span>
<span class="fc" id="L235">            isMonument = monument;</span>
        }
<span class="fc" id="L237">    }</span>

    /**
     * Returns if this place is a WikiData monument
     * @return
     */
    public boolean isMonument() {
<span class="fc" id="L244">        return isMonument;</span>
    }

    /**
     * Check if we already have the exact same Place
     * @param o Place being tested
     * @return true if name and location of Place is exactly the same
     */
    @Override
    public boolean equals(Object o) {
<span class="pc bpc" id="L254" title="1 of 2 branches missed.">        if (o instanceof Place) {</span>
<span class="fc" id="L255">            Place that = (Place) o;</span>
<span class="pc bpc" id="L256" title="6 of 10 branches missed.">            return (ListenerUtil.mutListener.listen(3572) ? (this.name.equals(that.name) || this.location.equals(that.location)) : (this.name.equals(that.name) &amp;&amp; this.location.equals(that.location)));</span>
        } else {
<span class="nc" id="L258">            return false;</span>
        }
    }

    @Override
    public int hashCode() {
<span class="pc bpc" id="L264" title="4 of 8 branches missed.">        return (ListenerUtil.mutListener.listen(3576) ? (this.name.hashCode() % 31) : (ListenerUtil.mutListener.listen(3575) ? (this.name.hashCode() / 31) : (ListenerUtil.mutListener.listen(3574) ? (this.name.hashCode() - 31) : (ListenerUtil.mutListener.listen(3573) ? (this.name.hashCode() + 31) : (this.name.hashCode() * 31))))) + this.location.hashCode();</span>
    }

    @Override
    public String toString() {
<span class="nc" id="L269">        return &quot;Place{&quot; + &quot;name='&quot; + name + '\'' + &quot;, lang='&quot; + language + '\'' + &quot;, label='&quot; + label + '\'' + &quot;, longDescription='&quot; + longDescription + '\'' + &quot;, location='&quot; + location + '\'' + &quot;, category='&quot; + category + '\'' + &quot;, distance='&quot; + distance + '\'' + &quot;, siteLinks='&quot; + siteLinks.toString() + '\'' + &quot;, pic='&quot; + pic + '\'' + &quot;, exists='&quot; + exists.toString() + '\'' + '}';</span>
    }

    @Override
    public int describeContents() {
<span class="nc" id="L274">        return 0;</span>
    }

    @Override
    public void writeToParcel(Parcel dest, int flags) {
<span class="nc bnc" id="L279" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3577)) {</span>
<span class="nc" id="L280">            dest.writeString(language);</span>
        }
<span class="nc bnc" id="L282" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3578)) {</span>
<span class="nc" id="L283">            dest.writeString(name);</span>
        }
<span class="nc bnc" id="L285" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3579)) {</span>
<span class="nc" id="L286">            dest.writeSerializable(label);</span>
        }
<span class="nc bnc" id="L288" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3580)) {</span>
<span class="nc" id="L289">            dest.writeString(longDescription);</span>
        }
<span class="nc bnc" id="L291" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3581)) {</span>
<span class="nc" id="L292">            dest.writeParcelable(location, 0);</span>
        }
<span class="nc bnc" id="L294" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3582)) {</span>
<span class="nc" id="L295">            dest.writeString(category);</span>
        }
<span class="nc bnc" id="L297" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3583)) {</span>
<span class="nc" id="L298">            dest.writeParcelable(siteLinks, 0);</span>
        }
<span class="nc bnc" id="L300" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3584)) {</span>
<span class="nc" id="L301">            dest.writeString(pic);</span>
        }
<span class="nc bnc" id="L303" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3585)) {</span>
<span class="nc" id="L304">            dest.writeString(exists.toString());</span>
        }
<span class="nc bnc" id="L306" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3586)) {</span>
<span class="nc bnc" id="L307" title="All 2 branches missed.">            dest.writeInt(isMonument ? 1 : 0);</span>
        }
<span class="nc" id="L309">    }</span>

<span class="fc" id="L311">    public static final Creator&lt;Place&gt; CREATOR = new Creator&lt;Place&gt;() {</span>

        @Override
        public Place createFromParcel(Parcel in) {
<span class="nc" id="L315">            return new Place(in);</span>
        }

        @Override
        public Place[] newArray(int size) {
<span class="nc" id="L320">            return new Place[size];</span>
        }
    };

    public String getThumb() {
<span class="nc" id="L325">        return thumb;</span>
    }

    public void setThumb(String thumb) {
<span class="nc bnc" id="L329" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3587)) {</span>
<span class="nc" id="L330">            this.thumb = thumb;</span>
        }
<span class="nc" id="L332">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span>Generated by the Android Gradle plugin 8.0.2</div></body></html>