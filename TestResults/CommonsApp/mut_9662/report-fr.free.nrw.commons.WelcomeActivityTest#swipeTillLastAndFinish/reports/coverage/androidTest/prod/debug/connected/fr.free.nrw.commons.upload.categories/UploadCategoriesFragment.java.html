<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>UploadCategoriesFragment.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">prodDebug</a> &gt; <a href="index.source.html" class="el_package">fr.free.nrw.commons.upload.categories</a> &gt; <span class="el_source">UploadCategoriesFragment.java</span></div><h1>UploadCategoriesFragment.java</h1><pre class="source lang-java linenums">package fr.free.nrw.commons.upload.categories;

import static fr.free.nrw.commons.wikidata.WikidataConstants.SELECTED_NEARBY_PLACE_CATEGORY;
import android.app.Activity;
import android.app.ProgressDialog;
import android.content.Context;
import android.os.Bundle;
import android.text.Editable;
import android.view.KeyEvent;
import android.view.LayoutInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.ProgressBar;
import android.widget.TextView;
import android.widget.Toast;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.appcompat.app.AppCompatActivity;
import androidx.recyclerview.widget.LinearLayoutManager;
import androidx.recyclerview.widget.RecyclerView;
import butterknife.BindView;
import butterknife.ButterKnife;
import butterknife.OnClick;
import com.google.android.material.textfield.TextInputLayout;
import com.jakewharton.rxbinding2.view.RxView;
import com.jakewharton.rxbinding2.widget.RxTextView;
import fr.free.nrw.commons.Media;
import fr.free.nrw.commons.R;
import fr.free.nrw.commons.category.CategoryItem;
import fr.free.nrw.commons.contributions.ContributionsFragment;
import fr.free.nrw.commons.media.MediaDetailFragment;
import fr.free.nrw.commons.ui.PasteSensitiveTextInputEditText;
import fr.free.nrw.commons.upload.UploadActivity;
import fr.free.nrw.commons.upload.UploadBaseFragment;
import fr.free.nrw.commons.utils.DialogUtil;
import io.reactivex.android.schedulers.AndroidSchedulers;
import io.reactivex.disposables.Disposable;
import java.util.List;
import java.util.Objects;
import java.util.concurrent.TimeUnit;
import javax.inject.Inject;
import kotlin.Unit;
import timber.log.Timber;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

<span class="nc" id="L49">public class UploadCategoriesFragment extends UploadBaseFragment implements CategoriesContract.View {</span>

    @BindView(R.id.tv_title)
    TextView tvTitle;

    @BindView(R.id.tv_subtitle)
    TextView tvSubTitle;

    @BindView(R.id.til_container_search)
    TextInputLayout tilContainerEtSearch;

    @BindView(R.id.et_search)
    PasteSensitiveTextInputEditText etSearch;

    @BindView(R.id.pb_categories)
    ProgressBar pbCategories;

    @BindView(R.id.rv_categories)
    RecyclerView rvCategories;

    @BindView(R.id.tooltip)
    ImageView tooltip;

    @BindView(R.id.btn_next)
    Button btnNext;

    @BindView(R.id.btn_previous)
    Button btnPrevious;

    @Inject
    CategoriesContract.UserActionListener presenter;

    private UploadCategoryAdapter adapter;

    private Disposable subscribe;

    /**
     * Current media
     */
    private Media media;

    /**
     * Progress Dialog for showing background process
     */
    private ProgressDialog progressDialog;

    /**
     * WikiText from the server
     */
    private String wikiText;

    private String nearbyPlaceCategory;

    @Nullable
    @Override
    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
<span class="nc" id="L105">        return inflater.inflate(R.layout.upload_categories_fragment, container, false);</span>
    }

    @Override
    public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {
<span class="nc bnc" id="L110" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6695)) {</span>
<span class="nc" id="L111">            super.onViewCreated(view, savedInstanceState);</span>
        }
<span class="nc bnc" id="L113" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6696)) {</span>
<span class="nc" id="L114">            ButterKnife.bind(this, view);</span>
        }
<span class="nc" id="L116">        final Bundle bundle = getArguments();</span>
<span class="nc bnc" id="L117" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6700)) {</span>
<span class="nc bnc" id="L118" title="All 2 branches missed.">            if (bundle != null) {</span>
<span class="nc bnc" id="L119" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6697)) {</span>
<span class="nc" id="L120">                    media = bundle.getParcelable(&quot;Existing_Categories&quot;);</span>
                }
<span class="nc bnc" id="L122" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6698)) {</span>
<span class="nc" id="L123">                    wikiText = bundle.getString(&quot;WikiText&quot;);</span>
                }
<span class="nc bnc" id="L125" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6699)) {</span>
<span class="nc" id="L126">                    nearbyPlaceCategory = bundle.getString(SELECTED_NEARBY_PLACE_CATEGORY);</span>
                }
            }
        }
<span class="nc bnc" id="L130" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6703)) {</span>
<span class="nc bnc" id="L131" title="All 2 branches missed.">            if (callback != null) {</span>
<span class="nc bnc" id="L132" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6701)) {</span>
<span class="nc" id="L133">                    init();</span>
                }
<span class="nc bnc" id="L135" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6702)) {</span>
<span class="nc" id="L136">                    presenter.getCategories().observe(getViewLifecycleOwner(), this::setCategories);</span>
                }
            }
        }
<span class="nc" id="L140">    }</span>

    private void init() {
<span class="nc bnc" id="L143" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6709)) {</span>
<span class="nc bnc" id="L144" title="All 2 branches missed.">            if (media == null) {</span>
<span class="nc bnc" id="L145" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6708)) {</span>
<span class="nc" id="L146">                    tvTitle.setText(getString(R.string.step_count, callback.getIndexInViewFlipper(this) + 1, callback.getTotalNumberOfSteps(), getString(R.string.categories_activity_title)));</span>
                }
            } else {
<span class="nc bnc" id="L149" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6704)) {</span>
<span class="nc" id="L150">                    tvTitle.setText(R.string.edit_categories);</span>
                }
<span class="nc bnc" id="L152" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6705)) {</span>
<span class="nc" id="L153">                    tvSubTitle.setVisibility(View.GONE);</span>
                }
<span class="nc bnc" id="L155" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6706)) {</span>
<span class="nc" id="L156">                    btnNext.setText(R.string.menu_save_categories);</span>
                }
<span class="nc bnc" id="L158" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6707)) {</span>
<span class="nc" id="L159">                    btnPrevious.setText(R.string.menu_cancel_upload);</span>
                }
            }
        }
<span class="nc bnc" id="L163" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6710)) {</span>
<span class="nc" id="L164">            setTvSubTitle();</span>
        }
<span class="nc bnc" id="L166" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6712)) {</span>
<span class="nc" id="L167">            tooltip.setOnClickListener(new OnClickListener() {</span>

                @Override
                public void onClick(View v) {
<span class="nc bnc" id="L171" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(6711)) {</span>
<span class="nc" id="L172">                        DialogUtil.showAlertDialog(getActivity(), getString(R.string.categories_activity_title), getString(R.string.categories_tooltip), getString(android.R.string.ok), null, true);</span>
                    }
<span class="nc" id="L174">                }</span>
            });
        }
<span class="nc bnc" id="L177" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6715)) {</span>
<span class="nc bnc" id="L178" title="All 2 branches missed.">            if (media == null) {</span>
<span class="nc bnc" id="L179" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6714)) {</span>
<span class="nc" id="L180">                    presenter.onAttachView(this);</span>
                }
            } else {
<span class="nc bnc" id="L183" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6713)) {</span>
<span class="nc" id="L184">                    presenter.onAttachViewWithMedia(this, media);</span>
                }
            }
        }
<span class="nc bnc" id="L188" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6716)) {</span>
<span class="nc" id="L189">            initRecyclerView();</span>
        }
<span class="nc bnc" id="L191" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6717)) {</span>
<span class="nc" id="L192">            addTextChangeListenerToEtSearch();</span>
        }
<span class="nc" id="L194">    }</span>

    private void addTextChangeListenerToEtSearch() {
<span class="nc bnc" id="L197" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6718)) {</span>
<span class="nc" id="L198">            subscribe = RxTextView.textChanges(etSearch).doOnEach(v -&gt; tilContainerEtSearch.setError(null)).takeUntil(RxView.detaches(etSearch)).debounce(500, TimeUnit.MILLISECONDS).observeOn(AndroidSchedulers.mainThread()).subscribe(filter -&gt; searchForCategory(filter.toString()), Timber::e);</span>
        }
<span class="nc" id="L200">    }</span>

    /**
     * Removes  the tv subtitle If the activity is the instance of [UploadActivity] and
     * if multiple files aren't selected.
     */
    private void setTvSubTitle() {
<span class="nc" id="L207">        final Activity activity = getActivity();</span>
<span class="nc bnc" id="L208" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6721)) {</span>
<span class="nc bnc" id="L209" title="All 2 branches missed.">            if (activity instanceof UploadActivity) {</span>
<span class="nc" id="L210">                final boolean isMultipleFileSelected = ((UploadActivity) activity).getIsMultipleFilesSelected();</span>
<span class="nc bnc" id="L211" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6720)) {</span>
<span class="nc bnc" id="L212" title="All 2 branches missed.">                    if (!isMultipleFileSelected) {</span>
<span class="nc bnc" id="L213" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(6719)) {</span>
<span class="nc" id="L214">                            tvSubTitle.setVisibility(View.GONE);</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L220">    }</span>

    private void searchForCategory(String query) {
<span class="nc bnc" id="L223" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6722)) {</span>
<span class="nc" id="L224">            presenter.searchForCategories(query);</span>
        }
<span class="nc" id="L226">    }</span>

    private void initRecyclerView() {
<span class="nc bnc" id="L229" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6723)) {</span>
<span class="nc" id="L230">            adapter = new UploadCategoryAdapter(categoryItem -&gt; {</span>
<span class="nc" id="L231">                presenter.onCategoryItemClicked(categoryItem);</span>
<span class="nc" id="L232">                return Unit.INSTANCE;</span>
            }, nearbyPlaceCategory);
        }
<span class="nc bnc" id="L235" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6724)) {</span>
<span class="nc" id="L236">            rvCategories.setLayoutManager(new LinearLayoutManager(getContext()));</span>
        }
<span class="nc bnc" id="L238" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6725)) {</span>
<span class="nc" id="L239">            rvCategories.setAdapter(adapter);</span>
        }
<span class="nc" id="L241">    }</span>

    @Override
    public void onDestroyView() {
<span class="nc bnc" id="L245" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6726)) {</span>
<span class="nc" id="L246">            super.onDestroyView();</span>
        }
<span class="nc bnc" id="L248" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6727)) {</span>
<span class="nc" id="L249">            presenter.onDetachView();</span>
        }
<span class="nc bnc" id="L251" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6728)) {</span>
<span class="nc" id="L252">            subscribe.dispose();</span>
        }
<span class="nc" id="L254">    }</span>

    @Override
    public void showProgress(boolean shouldShow) {
<span class="nc bnc" id="L258" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6729)) {</span>
<span class="nc bnc" id="L259" title="All 2 branches missed.">            pbCategories.setVisibility(shouldShow ? View.VISIBLE : View.GONE);</span>
        }
<span class="nc" id="L261">    }</span>

    @Override
    public void showError(String error) {
<span class="nc bnc" id="L265" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6730)) {</span>
<span class="nc" id="L266">            tilContainerEtSearch.setError(error);</span>
        }
<span class="nc" id="L268">    }</span>

    @Override
    public void showError(int stringResourceId) {
<span class="nc bnc" id="L272" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6731)) {</span>
<span class="nc" id="L273">            tilContainerEtSearch.setError(getString(stringResourceId));</span>
        }
<span class="nc" id="L275">    }</span>

    @Override
    public void setCategories(List&lt;CategoryItem&gt; categories) {
<span class="nc bnc" id="L279" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6734)) {</span>
<span class="nc bnc" id="L280" title="All 2 branches missed.">            if (categories == null) {</span>
<span class="nc bnc" id="L281" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6733)) {</span>
<span class="nc" id="L282">                    adapter.clear();</span>
                }
            } else {
<span class="nc bnc" id="L285" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6732)) {</span>
<span class="nc" id="L286">                    adapter.setItems(categories);</span>
                }
            }
        }
<span class="nc bnc" id="L290" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6735)) {</span>
<span class="nc" id="L291">            adapter.notifyDataSetChanged();</span>
        }
<span class="nc bnc" id="L293" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6739)) {</span>
            // list and smoothly scroll to the top of the search result list.
<span class="nc" id="L295">            rvCategories.post(new Runnable() {</span>

                @Override
                public void run() {
<span class="nc bnc" id="L299" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(6736)) {</span>
<span class="nc" id="L300">                        rvCategories.smoothScrollToPosition(0);</span>
                    }
<span class="nc bnc" id="L302" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(6738)) {</span>
<span class="nc" id="L303">                        rvCategories.post(new Runnable() {</span>

                            @Override
                            public void run() {
<span class="nc bnc" id="L307" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(6737)) {</span>
<span class="nc" id="L308">                                    rvCategories.smoothScrollToPosition(0);</span>
                                }
<span class="nc" id="L310">                            }</span>
                        });
                    }
<span class="nc" id="L313">                }</span>
            });
        }
<span class="nc" id="L316">    }</span>

    @Override
    public void goToNextScreen() {
<span class="nc bnc" id="L320" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6740)) {</span>
<span class="nc" id="L321">            callback.onNextButtonClicked(callback.getIndexInViewFlipper(this));</span>
        }
<span class="nc" id="L323">    }</span>

    @Override
    public void showNoCategorySelected() {
<span class="nc bnc" id="L327" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6745)) {</span>
<span class="nc bnc" id="L328" title="All 2 branches missed.">            if (media == null) {</span>
<span class="nc bnc" id="L329" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6744)) {</span>
<span class="nc" id="L330">                    DialogUtil.showAlertDialog(getActivity(), getString(R.string.no_categories_selected), getString(R.string.no_categories_selected_warning_desc), getString(R.string.continue_message), getString(R.string.cancel), () -&gt; goToNextScreen(), null);</span>
                }
            } else {
<span class="nc bnc" id="L333" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6741)) {</span>
<span class="nc" id="L334">                    Toast.makeText(requireContext(), getString(R.string.no_categories_selected), Toast.LENGTH_SHORT).show();</span>
                }
<span class="nc bnc" id="L336" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6742)) {</span>
<span class="nc" id="L337">                    presenter.clearPreviousSelection();</span>
                }
<span class="nc bnc" id="L339" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6743)) {</span>
<span class="nc" id="L340">                    goBackToPreviousScreen();</span>
                }
            }
        }
<span class="nc" id="L344">    }</span>

    /**
     * Gets existing categories from media
     */
    @Override
    public List&lt;String&gt; getExistingCategories() {
<span class="nc bnc" id="L351" title="All 2 branches missed.">        return (media == null) ? null : media.getCategories();</span>
    }

    /**
     * Returns required context
     */
    @Override
    public Context getFragmentContext() {
<span class="nc" id="L359">        return requireContext();</span>
    }

    /**
     * Returns to previous fragment
     */
    @Override
    public void goBackToPreviousScreen() {
<span class="nc bnc" id="L367" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6746)) {</span>
<span class="nc" id="L368">            getFragmentManager().popBackStack();</span>
        }
<span class="nc" id="L370">    }</span>

    /**
     * Shows the progress dialog
     */
    @Override
    public void showProgressDialog() {
<span class="nc bnc" id="L377" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6747)) {</span>
<span class="nc" id="L378">            progressDialog = new ProgressDialog(requireContext());</span>
        }
<span class="nc bnc" id="L380" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6748)) {</span>
<span class="nc" id="L381">            progressDialog.setMessage(getString(R.string.please_wait));</span>
        }
<span class="nc bnc" id="L383" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6749)) {</span>
<span class="nc" id="L384">            progressDialog.show();</span>
        }
<span class="nc" id="L386">    }</span>

    /**
     * Hides the progress dialog
     */
    @Override
    public void dismissProgressDialog() {
<span class="nc bnc" id="L393" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6750)) {</span>
<span class="nc" id="L394">            progressDialog.dismiss();</span>
        }
<span class="nc" id="L396">    }</span>

    /**
     * Refreshes the categories
     */
    @Override
    public void refreshCategories() {
<span class="nc" id="L403">        final MediaDetailFragment mediaDetailFragment = (MediaDetailFragment) getParentFragment();</span>
<span class="nc bnc" id="L404" title="All 2 branches missed.">        assert mediaDetailFragment != null;</span>
<span class="nc bnc" id="L405" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6751)) {</span>
<span class="nc" id="L406">            mediaDetailFragment.updateCategories();</span>
        }
<span class="nc" id="L408">    }</span>

    @OnClick(R.id.btn_next)
    public void onNextButtonClicked() {
<span class="nc bnc" id="L412" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6754)) {</span>
<span class="nc bnc" id="L413" title="All 2 branches missed.">            if (media != null) {</span>
<span class="nc bnc" id="L414" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6753)) {</span>
<span class="nc" id="L415">                    presenter.updateCategories(media, wikiText);</span>
                }
            } else {
<span class="nc bnc" id="L418" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6752)) {</span>
<span class="nc" id="L419">                    presenter.verifyCategories();</span>
                }
            }
        }
<span class="nc" id="L423">    }</span>

    @OnClick(R.id.btn_previous)
    public void onPreviousButtonClicked() {
<span class="nc bnc" id="L427" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6760)) {</span>
<span class="nc bnc" id="L428" title="All 2 branches missed.">            if (media != null) {</span>
<span class="nc bnc" id="L429" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6756)) {</span>
<span class="nc" id="L430">                    presenter.clearPreviousSelection();</span>
                }
<span class="nc bnc" id="L432" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6757)) {</span>
<span class="nc" id="L433">                    adapter.setItems(null);</span>
                }
<span class="nc" id="L435">                final MediaDetailFragment mediaDetailFragment = (MediaDetailFragment) getParentFragment();</span>
<span class="nc bnc" id="L436" title="All 2 branches missed.">                assert mediaDetailFragment != null;</span>
<span class="nc bnc" id="L437" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6758)) {</span>
<span class="nc" id="L438">                    mediaDetailFragment.onResume();</span>
                }
<span class="nc bnc" id="L440" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6759)) {</span>
<span class="nc" id="L441">                    goBackToPreviousScreen();</span>
                }
<span class="nc" id="L443">            } else {</span>
<span class="nc bnc" id="L444" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6755)) {</span>
<span class="nc" id="L445">                    callback.onPreviousButtonClicked(callback.getIndexInViewFlipper(this));</span>
                }
            }
        }
<span class="nc" id="L449">    }</span>

    @Override
    protected void onBecameVisible() {
<span class="nc bnc" id="L453" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6761)) {</span>
<span class="nc" id="L454">            super.onBecameVisible();</span>
        }
<span class="nc bnc" id="L456" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6762)) {</span>
<span class="nc" id="L457">            presenter.selectCategories();</span>
        }
<span class="nc" id="L459">        final Editable text = etSearch.getText();</span>
<span class="nc bnc" id="L460" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6764)) {</span>
<span class="nc bnc" id="L461" title="All 2 branches missed.">            if (text != null) {</span>
<span class="nc bnc" id="L462" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6763)) {</span>
<span class="nc" id="L463">                    presenter.searchForCategories(text.toString());</span>
                }
            }
        }
<span class="nc" id="L467">    }</span>

    /**
     * Hides the action bar while opening editing fragment
     */
    @Override
    public void onResume() {
<span class="nc bnc" id="L474" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6765)) {</span>
<span class="nc" id="L475">            super.onResume();</span>
        }
<span class="nc bnc" id="L477" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6773)) {</span>
<span class="nc bnc" id="L478" title="All 2 branches missed.">            if (media != null) {</span>
<span class="nc bnc" id="L479" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6766)) {</span>
<span class="nc" id="L480">                    etSearch.setOnKeyListener((v, keyCode, event) -&gt; {</span>
<span class="nc bnc" id="L481" title="All 2 branches missed.">                        if (keyCode == KeyEvent.KEYCODE_BACK) {</span>
<span class="nc" id="L482">                            etSearch.clearFocus();</span>
<span class="nc" id="L483">                            presenter.clearPreviousSelection();</span>
<span class="nc" id="L484">                            final MediaDetailFragment mediaDetailFragment = (MediaDetailFragment) getParentFragment();</span>
<span class="nc bnc" id="L485" title="All 2 branches missed.">                            assert mediaDetailFragment != null;</span>
<span class="nc" id="L486">                            mediaDetailFragment.onResume();</span>
<span class="nc" id="L487">                            goBackToPreviousScreen();</span>
<span class="nc" id="L488">                            return true;</span>
                        }
<span class="nc" id="L490">                        return false;</span>
                    });
                }
<span class="nc bnc" id="L493" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6767)) {</span>
<span class="nc" id="L494">                    Objects.requireNonNull(getView()).setFocusableInTouchMode(true);</span>
                }
<span class="nc bnc" id="L496" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6768)) {</span>
<span class="nc" id="L497">                    getView().requestFocus();</span>
                }
<span class="nc bnc" id="L499" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6769)) {</span>
<span class="nc" id="L500">                    getView().setOnKeyListener((v, keyCode, event) -&gt; {</span>
<span class="nc bnc" id="L501" title="All 4 branches missed.">                        if (event.getAction() == KeyEvent.ACTION_UP &amp;&amp; keyCode == KeyEvent.KEYCODE_BACK) {</span>
<span class="nc" id="L502">                            presenter.clearPreviousSelection();</span>
<span class="nc" id="L503">                            final MediaDetailFragment mediaDetailFragment = (MediaDetailFragment) getParentFragment();</span>
<span class="nc bnc" id="L504" title="All 2 branches missed.">                            assert mediaDetailFragment != null;</span>
<span class="nc" id="L505">                            mediaDetailFragment.onResume();</span>
<span class="nc" id="L506">                            goBackToPreviousScreen();</span>
<span class="nc" id="L507">                            return true;</span>
                        }
<span class="nc" id="L509">                        return false;</span>
                    });
                }
<span class="nc bnc" id="L512" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6770)) {</span>
<span class="nc" id="L513">                    Objects.requireNonNull(((AppCompatActivity) Objects.requireNonNull(getActivity())).getSupportActionBar()).hide();</span>
                }
<span class="nc bnc" id="L515" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6772)) {</span>
<span class="nc bnc" id="L516" title="All 2 branches missed.">                    if (getParentFragment().getParentFragment().getParentFragment() instanceof ContributionsFragment) {</span>
<span class="nc bnc" id="L517" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(6771)) {</span>
<span class="nc" id="L518">                            ((ContributionsFragment) (getParentFragment().getParentFragment().getParentFragment())).nearbyNotificationCardView.setVisibility(View.GONE);</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L524">    }</span>

    /**
     * Shows the action bar while closing editing fragment
     */
    @Override
    public void onStop() {
<span class="nc bnc" id="L531" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6774)) {</span>
<span class="nc" id="L532">            super.onStop();</span>
        }
<span class="nc bnc" id="L534" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6776)) {</span>
<span class="nc bnc" id="L535" title="All 2 branches missed.">            if (media != null) {</span>
<span class="nc bnc" id="L536" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6775)) {</span>
<span class="nc" id="L537">                    Objects.requireNonNull(((AppCompatActivity) Objects.requireNonNull(getActivity())).getSupportActionBar()).show();</span>
                }
            }
        }
<span class="nc" id="L541">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span>Generated by the Android Gradle plugin 8.0.2</div></body></html>