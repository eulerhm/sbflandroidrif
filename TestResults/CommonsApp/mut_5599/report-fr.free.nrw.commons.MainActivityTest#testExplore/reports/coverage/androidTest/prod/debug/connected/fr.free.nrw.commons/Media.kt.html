<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Media.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">prodDebug</a> &gt; <a href="index.source.html" class="el_package">fr.free.nrw.commons</a> &gt; <span class="el_source">Media.kt</span></div><h1>Media.kt</h1><pre class="source lang-java linenums">package fr.free.nrw.commons

import android.os.Parcelable
import fr.free.nrw.commons.location.LatLng
import kotlinx.android.parcel.Parcelize
import org.wikipedia.dataclient.mwapi.MwQueryPage
import org.wikipedia.page.PageTitle
import java.util.*

<span class="fc" id="L10">@Parcelize</span>
<span class="pc" id="L11">class Media constructor(</span>
    /**
     * @return pageId for the current media object
     * Wikibase Identifier associated with media files
     */
<span class="pc" id="L16">    var pageId: String = UUID.randomUUID().toString(),</span>
<span class="pc" id="L17">    var thumbUrl: String? = null,</span>

    /**
     * Gets image URL
     * @return Image URL
     */
<span class="pc" id="L23">    var imageUrl: String? = null,</span>
    /**
     * Gets the name of the file.
     * @return file name as a string
     */
<span class="pc" id="L28">    var filename: String? = null,</span>
    /**
     * Gets the file description.
     * @return file description as a string
     */
    // monolingual description on input...
    /**
     * Sets the file description.
     * @param fallbackDescription the new description of the file
     */
<span class="pc" id="L38">    var fallbackDescription: String? = null,</span>

    /**
     * Gets the upload date of the file.
     * Can be null.
     * @return upload date as a Date
     */
<span class="pc" id="L45">    var dateUploaded: Date? = null,</span>
    /**
     * Gets the license name of the file.
     * @return license as a String
     */
    /**
     * Sets the license name of the file.
     *
     * @param license license name as a String
     */
<span class="pc" id="L55">    var license: String? = null,</span>
<span class="pc" id="L56">    var licenseUrl: String? = null,</span>
    /**
     * Gets the name of the creator of the file.
     * @return author name as a String
     */
    /**
     * Sets the author name of the file.
     * @param author creator name as a string
     */
<span class="pc" id="L65">    var author: String? = null,</span>

<span class="pc" id="L67">    var user:String?=null,</span>

    /**
     * Gets the categories the file falls under.
     * @return file categories as an ArrayList of Strings
     */
<span class="pc" id="L73">    var categories: List&lt;String&gt;? = null,</span>
    /**
     * Gets the coordinates of where the file was created.
     * @return file coordinates as a LatLng
     */
<span class="pc" id="L78">    var coordinates: LatLng? = null,</span>
<span class="pc" id="L79">    var captions: Map&lt;String, String&gt; = emptyMap(),</span>
<span class="pc" id="L80">    var descriptions: Map&lt;String, String&gt; = emptyMap(),</span>
<span class="pc" id="L81">    var depictionIds: List&lt;String&gt; = emptyList(),</span>
    /**
     * This field was added to find non-hidden categories
     * Stores the mapping of category title to hidden attribute
     * Example: &quot;Mountains&quot; =&gt; false, &quot;CC-BY-SA-2.0&quot; =&gt; true
     */
<span class="pc" id="L87">    var categoriesHiddenStatus: Map&lt;String, Boolean&gt; = emptyMap()</span>
) : Parcelable {

    constructor(
        captions: Map&lt;String, String&gt;,
        categories: List&lt;String&gt;?,
        filename: String?,
        fallbackDescription: String?,
        author: String?, user:String?
<span class="nc" id="L96">    ) : this(</span>
<span class="nc" id="L97">        filename = filename,</span>
<span class="nc" id="L98">        fallbackDescription = fallbackDescription,</span>
<span class="nc" id="L99">        dateUploaded = Date(),</span>
<span class="nc" id="L100">        author = author,</span>
<span class="nc" id="L101">        user=user,</span>
<span class="nc" id="L102">        categories = categories,</span>
<span class="nc" id="L103">        captions = captions</span>
<span class="nc" id="L104">    )</span>

    /**
     * Gets media display title
     * @return Media title
     */
    val displayTitle: String
        get() =
<span class="pc bpc" id="L112" title="1 of 2 branches missed.">            if (filename != null)</span>
<span class="fc" id="L113">                pageTitle.displayTextWithoutNamespace.replaceFirst(&quot;[.][^.]+$&quot;.toRegex(), &quot;&quot;)</span>
            else
<span class="pc" id="L115">                &quot;&quot;</span>

    /**
     * Gets file page title
     * @return New media page title
     */
<span class="fc" id="L121">    val pageTitle: PageTitle get() = Utils.getPageTitle(filename!!)</span>

    /**
     * Returns wikicode to use the media file on a MediaWiki site
     * @return
     */
    val wikiCode: String
<span class="nc" id="L128">        get() = String.format(&quot;[[%s|thumb|%s]]&quot;, filename, mostRelevantCaption)</span>

    val mostRelevantCaption: String
<span class="fc bfc" id="L131" title="All 4 branches covered.">        get() = captions[Locale.getDefault().language]</span>
<span class="fc" id="L132">            ?: captions.values.firstOrNull()</span>
<span class="fc" id="L133">            ?: displayTitle</span>

    /**
     * Gets the categories the file falls under.
     * @return file categories as an ArrayList of Strings
     */
    var addedCategories: List&lt;String&gt;? = null
        // TODO added categories should be removed. It is added for a short fix. On category update,
        //  categories should be re-fetched instead
<span class="nc" id="L142">        get() = field                     // getter</span>
<span class="nc" id="L143">        set(value) { field = value }      // setter</span>
<span class="nc" id="L144">}</span>
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span>Generated by the Android Gradle plugin 8.0.2</div></body></html>