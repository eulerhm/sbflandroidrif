<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>QuizActivity.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">prodDebug</a> &gt; <a href="index.source.html" class="el_package">fr.free.nrw.commons.quiz</a> &gt; <span class="el_source">QuizActivity.java</span></div><h1>QuizActivity.java</h1><pre class="source lang-java linenums">package fr.free.nrw.commons.quiz;

import android.content.Intent;
import android.os.Bundle;
import androidx.appcompat.app.AlertDialog;
import androidx.appcompat.app.AppCompatActivity;
import androidx.vectordrawable.graphics.drawable.VectorDrawableCompat;
import com.facebook.drawee.drawable.ProgressBarDrawable;
import com.facebook.drawee.generic.GenericDraweeHierarchyBuilder;
import fr.free.nrw.commons.databinding.ActivityQuizBinding;
import java.util.ArrayList;
import fr.free.nrw.commons.R;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

<span class="nc" id="L15">public class QuizActivity extends AppCompatActivity {</span>

    private ActivityQuizBinding binding;

<span class="nc" id="L19">    private final QuizController quizController = new QuizController();</span>

<span class="nc" id="L21">    private ArrayList&lt;QuizQuestion&gt; quiz = new ArrayList&lt;&gt;();</span>

<span class="nc" id="L23">    private int questionIndex = 0;</span>

    private int score;

    /**
     * isPositiveAnswerChecked : represents yes click event
     */
    private boolean isPositiveAnswerChecked;

    /**
     * isNegativeAnswerChecked : represents no click event
     */
    private boolean isNegativeAnswerChecked;

    @Override
    protected void onCreate(final Bundle savedInstanceState) {
<span class="nc bnc" id="L39" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1910)) {</span>
<span class="nc" id="L40">            super.onCreate(savedInstanceState);</span>
        }
<span class="nc bnc" id="L42" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1911)) {</span>
<span class="nc" id="L43">            binding = ActivityQuizBinding.inflate(getLayoutInflater());</span>
        }
<span class="nc bnc" id="L45" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1912)) {</span>
<span class="nc" id="L46">            setContentView(binding.getRoot());</span>
        }
<span class="nc bnc" id="L48" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1913)) {</span>
<span class="nc" id="L49">            quizController.initialize(this);</span>
        }
<span class="nc bnc" id="L51" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1914)) {</span>
<span class="nc" id="L52">            setSupportActionBar(binding.toolbar.toolbar);</span>
        }
<span class="nc bnc" id="L54" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1915)) {</span>
<span class="nc" id="L55">            binding.nextButton.setOnClickListener(view -&gt; notKnowAnswer());</span>
        }
<span class="nc bnc" id="L57" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1916)) {</span>
<span class="nc" id="L58">            displayQuestion();</span>
        }
<span class="nc" id="L60">    }</span>

    /**
     * to move to next question and check whether answer is selected or not
     */
    public void setNextQuestion() {
<span class="nc bnc" id="L66" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1925)) {</span>
<span class="nc bnc" id="L67" title="All 66 branches missed.">            if ((ListenerUtil.mutListener.listen(1923) ? ((ListenerUtil.mutListener.listen(1921) ? (questionIndex &gt;= quiz.size()) : (ListenerUtil.mutListener.listen(1920) ? (questionIndex &gt; quiz.size()) : (ListenerUtil.mutListener.listen(1919) ? (questionIndex &lt; quiz.size()) : (ListenerUtil.mutListener.listen(1918) ? (questionIndex != quiz.size()) : (ListenerUtil.mutListener.listen(1917) ? (questionIndex == quiz.size()) : (questionIndex &lt;= quiz.size())))))) || ((ListenerUtil.mutListener.listen(1922) ? (isPositiveAnswerChecked &amp;&amp; isNegativeAnswerChecked) : (isPositiveAnswerChecked || isNegativeAnswerChecked)))) : ((ListenerUtil.mutListener.listen(1921) ? (questionIndex &gt;= quiz.size()) : (ListenerUtil.mutListener.listen(1920) ? (questionIndex &gt; quiz.size()) : (ListenerUtil.mutListener.listen(1919) ? (questionIndex &lt; quiz.size()) : (ListenerUtil.mutListener.listen(1918) ? (questionIndex != quiz.size()) : (ListenerUtil.mutListener.listen(1917) ? (questionIndex == quiz.size()) : (questionIndex &lt;= quiz.size())))))) &amp;&amp; ((ListenerUtil.mutListener.listen(1922) ? (isPositiveAnswerChecked &amp;&amp; isNegativeAnswerChecked) : (isPositiveAnswerChecked || isNegativeAnswerChecked)))))) {</span>
<span class="nc bnc" id="L68" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1924)) {</span>
<span class="nc" id="L69">                    evaluateScore();</span>
                }
            }
        }
<span class="nc" id="L73">    }</span>

    public void notKnowAnswer() {
<span class="nc bnc" id="L76" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1926)) {</span>
<span class="nc" id="L77">            customAlert(&quot;Information&quot;, quiz.get(questionIndex).getAnswerMessage());</span>
        }
<span class="nc" id="L79">    }</span>

    /**
     * to give warning before ending quiz
     */
    @Override
    public void onBackPressed() {
<span class="nc bnc" id="L86" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1927)) {</span>
<span class="nc" id="L87">            new AlertDialog.Builder(this).setTitle(getResources().getString(R.string.warning)).setMessage(getResources().getString(R.string.quiz_back_button)).setPositiveButton(R.string.continue_message, (dialog, which) -&gt; {</span>
<span class="nc" id="L88">                final Intent intent = new Intent(this, QuizResultActivity.class);</span>
<span class="nc" id="L89">                dialog.dismiss();</span>
<span class="nc" id="L90">                intent.putExtra(&quot;QuizResult&quot;, score);</span>
<span class="nc" id="L91">                startActivity(intent);</span>
<span class="nc" id="L92">            }).setNegativeButton(&quot;Cancel&quot;, (dialogInterface, i) -&gt; dialogInterface.dismiss()).create().show();</span>
        }
<span class="nc" id="L94">    }</span>

    /**
     * to display the question
     */
    public void displayQuestion() {
<span class="nc bnc" id="L100" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1928)) {</span>
<span class="nc" id="L101">            quiz = quizController.getQuiz();</span>
        }
<span class="nc bnc" id="L103" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1929)) {</span>
<span class="nc" id="L104">            binding.question.questionText.setText(quiz.get(questionIndex).getQuestion());</span>
        }
<span class="nc bnc" id="L106" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1930)) {</span>
<span class="nc" id="L107">            binding.questionTitle.setText(getResources().getString(R.string.question) + quiz.get(questionIndex).getQuestionNumber());</span>
        }
<span class="nc bnc" id="L109" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1931)) {</span>
<span class="nc" id="L110">            binding.question.questionImage.setHierarchy(GenericDraweeHierarchyBuilder.newInstance(getResources()).setFailureImage(VectorDrawableCompat.create(getResources(), R.drawable.ic_error_outline_black_24dp, getTheme())).setProgressBarImage(new ProgressBarDrawable()).build());</span>
        }
<span class="nc bnc" id="L112" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1932)) {</span>
<span class="nc" id="L113">            binding.question.questionImage.setImageURI(quiz.get(questionIndex).getUrl());</span>
        }
<span class="nc bnc" id="L115" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1933)) {</span>
<span class="nc" id="L116">            isPositiveAnswerChecked = false;</span>
        }
<span class="nc bnc" id="L118" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1934)) {</span>
<span class="nc" id="L119">            isNegativeAnswerChecked = false;</span>
        }
<span class="nc bnc" id="L121" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1935)) {</span>
<span class="nc" id="L122">            binding.answer.quizPositiveAnswer.setOnClickListener(view -&gt; {</span>
<span class="nc" id="L123">                isPositiveAnswerChecked = true;</span>
<span class="nc" id="L124">                setNextQuestion();</span>
<span class="nc" id="L125">            });</span>
        }
<span class="nc bnc" id="L127" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1936)) {</span>
<span class="nc" id="L128">            binding.answer.quizNegativeAnswer.setOnClickListener(view -&gt; {</span>
<span class="nc" id="L129">                isNegativeAnswerChecked = true;</span>
<span class="nc" id="L130">                setNextQuestion();</span>
<span class="nc" id="L131">            });</span>
        }
<span class="nc" id="L133">    }</span>

    /**
     * to evaluate score and check whether answer is correct or wrong
     */
    public void evaluateScore() {
<span class="nc bnc" id="L139" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1943)) {</span>
<span class="nc bnc" id="L140" title="All 42 branches missed.">            if ((ListenerUtil.mutListener.listen(1939) ? (((ListenerUtil.mutListener.listen(1937) ? (quiz.get(questionIndex).isAnswer() || isPositiveAnswerChecked) : (quiz.get(questionIndex).isAnswer() &amp;&amp; isPositiveAnswerChecked))) &amp;&amp; ((ListenerUtil.mutListener.listen(1938) ? (!quiz.get(questionIndex).isAnswer() || isNegativeAnswerChecked) : (!quiz.get(questionIndex).isAnswer() &amp;&amp; isNegativeAnswerChecked)))) : (((ListenerUtil.mutListener.listen(1937) ? (quiz.get(questionIndex).isAnswer() || isPositiveAnswerChecked) : (quiz.get(questionIndex).isAnswer() &amp;&amp; isPositiveAnswerChecked))) || ((ListenerUtil.mutListener.listen(1938) ? (!quiz.get(questionIndex).isAnswer() || isNegativeAnswerChecked) : (!quiz.get(questionIndex).isAnswer() &amp;&amp; isNegativeAnswerChecked)))))) {</span>
<span class="nc bnc" id="L141" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1941)) {</span>
<span class="nc" id="L142">                    customAlert(getResources().getString(R.string.correct), quiz.get(questionIndex).getAnswerMessage());</span>
                }
<span class="nc bnc" id="L144" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1942)) {</span>
<span class="nc" id="L145">                    score++;</span>
                }
            } else {
<span class="nc bnc" id="L148" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1940)) {</span>
<span class="nc" id="L149">                    customAlert(getResources().getString(R.string.wrong), quiz.get(questionIndex).getAnswerMessage());</span>
                }
            }
        }
<span class="nc" id="L153">    }</span>

    /**
     * to display explanation after each answer, update questionIndex and move to next question
     * @param title the alert title
     * @param Message the alert message
     */
    public void customAlert(final String title, final String Message) {
<span class="nc bnc" id="L161" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1944)) {</span>
<span class="nc" id="L162">            new AlertDialog.Builder(this).setTitle(title).setMessage(Message).setPositiveButton(R.string.continue_message, (dialog, which) -&gt; {</span>
<span class="nc" id="L163">                questionIndex++;</span>
<span class="nc bnc" id="L164" title="All 2 branches missed.">                if (questionIndex == quiz.size()) {</span>
<span class="nc" id="L165">                    final Intent intent = new Intent(this, QuizResultActivity.class);</span>
<span class="nc" id="L166">                    dialog.dismiss();</span>
<span class="nc" id="L167">                    intent.putExtra(&quot;QuizResult&quot;, score);</span>
<span class="nc" id="L168">                    startActivity(intent);</span>
<span class="nc" id="L169">                } else {</span>
<span class="nc" id="L170">                    displayQuestion();</span>
                }
<span class="nc" id="L172">            }).create().show();</span>
        }
<span class="nc" id="L174">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span>Generated by the Android Gradle plugin 8.0.2</div></body></html>