<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>HomeActivity.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">agencyXGoogleDebug</a> &gt; <a href="index.source.html" class="el_package">org.onebusaway.android.ui</a> &gt; <span class="el_source">HomeActivity.java</span></div><h1>HomeActivity.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2012-2017 Paul Watts (paulcwatts@gmail.com),
 * University of South Florida (sjbarbeau@gmail.com),
 * Microsoft Corporation
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.onebusaway.android.ui;

import com.google.android.gms.common.ConnectionResult;
import com.google.android.gms.common.GoogleApiAvailability;
import com.google.android.gms.common.api.GoogleApiClient;
import com.google.android.material.floatingactionbutton.FloatingActionButton;
import com.google.firebase.analytics.FirebaseAnalytics;
import com.sothree.slidinguppanel.SlidingUpPanelLayout;
import org.onebusaway.android.BuildConfig;
import org.onebusaway.android.R;
import org.onebusaway.android.app.Application;
import org.onebusaway.android.io.ObaAnalytics;
import org.onebusaway.android.io.elements.ObaRegion;
import org.onebusaway.android.io.elements.ObaRoute;
import org.onebusaway.android.io.elements.ObaStop;
import org.onebusaway.android.io.request.ObaArrivalInfoResponse;
import org.onebusaway.android.map.MapModeController;
import org.onebusaway.android.map.MapParams;
import org.onebusaway.android.map.googlemapsv2.BaseMapFragment;
import org.onebusaway.android.map.googlemapsv2.LayerInfo;
import org.onebusaway.android.region.ObaRegionsTask;
import org.onebusaway.android.report.ui.ReportActivity;
import org.onebusaway.android.travelbehavior.TravelBehaviorManager;
import org.onebusaway.android.travelbehavior.constants.TravelBehaviorConstants;
import org.onebusaway.android.travelbehavior.utils.TravelBehaviorUtils;
import org.onebusaway.android.tripservice.TripService;
import org.onebusaway.android.util.FragmentUtils;
import org.onebusaway.android.util.LocationUtils;
import org.onebusaway.android.util.PermissionUtils;
import org.onebusaway.android.util.PreferenceUtils;
import org.onebusaway.android.util.RegionUtils;
import org.onebusaway.android.util.ShowcaseViewUtils;
import org.onebusaway.android.util.UIUtils;
import org.opentripplanner.routing.bike_rental.BikeRentalStation;
import android.Manifest;
import android.app.Dialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.content.SharedPreferences;
import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;
import android.content.pm.PackageManager.NameNotFoundException;
import android.content.res.Resources;
import android.graphics.Paint;
import android.graphics.drawable.GradientDrawable;
import android.location.Location;
import android.net.Uri;
import android.os.Build;
import android.os.Bundle;
import android.os.Handler;
import android.text.TextUtils;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.view.ViewGroup;
import android.view.Window;
import android.view.accessibility.AccessibilityManager;
import android.view.animation.Animation;
import android.view.animation.Transformation;
import android.widget.ImageButton;
import android.widget.ImageView;
import android.widget.LinearLayout;
import android.widget.ListView;
import android.widget.ProgressBar;
import android.widget.RelativeLayout;
import android.widget.TextView;
import android.widget.Toast;
import java.lang.ref.WeakReference;
import java.util.ArrayList;
import java.util.Collections;
import java.util.Date;
import java.util.HashMap;
import java.util.List;
import androidx.activity.result.ActivityResultLauncher;
import androidx.activity.result.contract.ActivityResultContracts;
import androidx.annotation.NonNull;
import androidx.appcompat.app.AlertDialog;
import androidx.appcompat.app.AppCompatActivity;
import androidx.core.content.ContextCompat;
import androidx.fragment.app.FragmentManager;
import static org.onebusaway.android.ui.NavigationDrawerFragment.NAVDRAWER_ITEM_ACTIVITY_FEED;
import static org.onebusaway.android.ui.NavigationDrawerFragment.NAVDRAWER_ITEM_HELP;
import static org.onebusaway.android.ui.NavigationDrawerFragment.NAVDRAWER_ITEM_MY_REMINDERS;
import static org.onebusaway.android.ui.NavigationDrawerFragment.NAVDRAWER_ITEM_NEARBY;
import static org.onebusaway.android.ui.NavigationDrawerFragment.NAVDRAWER_ITEM_OPEN_SOURCE;
import static org.onebusaway.android.ui.NavigationDrawerFragment.NAVDRAWER_ITEM_PAY_FARE;
import static org.onebusaway.android.ui.NavigationDrawerFragment.NAVDRAWER_ITEM_PINS;
import static org.onebusaway.android.ui.NavigationDrawerFragment.NAVDRAWER_ITEM_PLAN_TRIP;
import static org.onebusaway.android.ui.NavigationDrawerFragment.NAVDRAWER_ITEM_PROFILE;
import static org.onebusaway.android.ui.NavigationDrawerFragment.NAVDRAWER_ITEM_SEND_FEEDBACK;
import static org.onebusaway.android.ui.NavigationDrawerFragment.NAVDRAWER_ITEM_SETTINGS;
import static org.onebusaway.android.ui.NavigationDrawerFragment.NAVDRAWER_ITEM_SIGN_IN;
import static org.onebusaway.android.ui.NavigationDrawerFragment.NAVDRAWER_ITEM_STARRED_ROUTES;
import static org.onebusaway.android.ui.NavigationDrawerFragment.NAVDRAWER_ITEM_STARRED_STOPS;
import static org.onebusaway.android.ui.NavigationDrawerFragment.NavigationDrawerCallbacks;
import static org.onebusaway.android.util.PermissionUtils.BACKGROUND_LOCATION_PERMISSION_REQUEST;
import static org.onebusaway.android.util.PermissionUtils.LOCATION_PERMISSIONS;
import static uk.co.markormesher.android_fab.FloatingActionButton.POSITION_BOTTOM;
import static uk.co.markormesher.android_fab.FloatingActionButton.POSITION_END;
import static uk.co.markormesher.android_fab.FloatingActionButton.POSITION_START;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

<span class="nc" id="L123">public class HomeActivity extends AppCompatActivity implements BaseMapFragment.OnFocusChangedListener, BaseMapFragment.OnProgressBarChangedListener, ArrivalsListFragment.Listener, NavigationDrawerCallbacks, ObaRegionsTask.Callback {</span>

    interface SlidingPanelController {

        /**
         * Sets the height of the sliding panel in pixels
         *
         * @param heightInPixels height of panel in pixels
         */
        void setPanelHeightPixels(int heightInPixels);

        /**
         * Returns the current height of the sliding panel in pixels, or -1 if the panel isn't yet
         * initialized
         *
         * @return the current height of the sliding panel in pixels, or -1 if the panel isn't yet
         * initialized
         */
        int getPanelHeightPixels();
    }

    public static final String TWITTER_URL = &quot;http://mobile.twitter.com/onebusaway&quot;;

    private static final String WHATS_NEW_VER = &quot;whatsNewVer&quot;;

    private static final String CHECK_REGION_VER = &quot;checkRegionVer&quot;;

    private static final int HELP_DIALOG = 1;

    private static final int WHATSNEW_DIALOG = 2;

    private static final int LEGEND_DIALOG = 3;

    // One week, in milliseconds
    private static final long REGION_UPDATE_THRESHOLD = 1000 * 60 * 60 * 24 * 7;

    private static final String TAG = &quot;HomeActivity&quot;;

    WeakReference&lt;AppCompatActivity&gt; mActivityWeakRef;

    ArrivalsListFragment mArrivalsListFragment;

    ArrivalsListHeader mArrivalsListHeader;

    View mArrivalsListHeaderView;

    View mArrivalsListHeaderSubView;

    private FloatingActionButton mFabMyLocation;

    uk.co.markormesher.android_fab.FloatingActionButton mLayersFab;

    private static int MY_LOC_DEFAULT_BOTTOM_MARGIN;

    private static int LAYERS_FAB_DEFAULT_BOTTOM_MARGIN;

    // ms
    private static final int MY_LOC_BTN_ANIM_DURATION = 100;

    Animation mMyLocationAnimation;

    /**
     * GoogleApiClient being used for Location Services
     */
    protected GoogleApiClient mGoogleApiClient;

    // Bottom Sliding panel
    SlidingUpPanelLayout mSlidingPanel;

    public static final int BATTERY_OPTIMIZATIONS_PERMISSION_REQUEST = 111;

    /**
     * Fragment managing the behaviors, interactions and presentation of the navigation drawer.
     */
    private NavigationDrawerFragment mNavigationDrawerFragment;

    /**
     * Currently selected navigation drawer position (so we don't unnecessarily swap fragments
     * if the same item is selected).  Initialized to -1 so the initial callback from
     * NavigationDrawerFragment always instantiates the fragments
     */
<span class="nc" id="L204">    private int mCurrentNavDrawerPosition = -1;</span>

    /**
     * Fragments that can be selected as main content via the NavigationDrawer
     */
    MyStarredStopsFragment mMyStarredStopsFragment;

    MyStarredRoutesFragment mMyStarredRoutesFragment;

    BaseMapFragment mMapFragment;

    MyRemindersFragment mMyRemindersFragment;

    /**
     * Control which menu options are shown per fragment menu groups
     */
<span class="nc" id="L220">    private boolean mShowStarredStopsMenu = false;</span>

<span class="nc" id="L222">    private boolean mShowStarredRoutesMenu = false;</span>

<span class="nc" id="L224">    private boolean mShowArrivalsMenu = false;</span>

    /**
     * Stop that has current focus on the map.  We retain a reference to the StopId,
     * since during rapid rotations its possible that a reference to a ObaStop object in
     * mFocusedStop can still be null, and we don't want to lose the state of which stopId is in
     * focus.  We also need access to the focused stop properties, hence why we also have
     * mFocusedStop
     */
<span class="nc" id="L233">    String mFocusedStopId = null;</span>

    /**
     * Bike rental station ID that has the focus currently.
     */
<span class="nc" id="L238">    String mBikeRentalStationId = null;</span>

<span class="nc" id="L240">    ObaStop mFocusedStop = null;</span>

<span class="nc" id="L242">    ImageView mExpandCollapse = null;</span>

<span class="nc" id="L244">    ProgressBar mMapProgressBar = null;</span>

<span class="nc" id="L246">    boolean mLastMapProgressBarState = true;</span>

    private static final String INITIAL_STARTUP = &quot;initialStartup&quot;;

<span class="nc" id="L250">    boolean mInitialStartup = true;</span>

    private FirebaseAnalytics mFirebaseAnalytics;

    private ActivityResultLauncher&lt;String&gt; travelBehaviorPermissionsLauncher;

    /**
     * Starts the MapActivity with a particular stop focused with the center of
     * the map at a particular point.
     *
     * @param context The context of the activity.
     * @param focusId The stop to focus.
     * @param lat     The latitude of the map center.
     * @param lon     The longitude of the map center.
     */
    public static void start(Context context, String focusId, double lat, double lon) {
<span class="nc bnc" id="L266" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3860)) {</span>
<span class="nc" id="L267">            context.startActivity(makeIntent(context, focusId, lat, lon));</span>
        }
<span class="nc" id="L269">    }</span>

    /**
     * Starts the MapActivity with a particular stop focused with the center of
     * the map at a particular point.
     *
     * @param context The context of the activity.
     * @param stop    The stop to focus on.
     */
    public static void start(Context context, ObaStop stop) {
<span class="nc bnc" id="L279" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3861)) {</span>
<span class="nc" id="L280">            context.startActivity(makeIntent(context, stop));</span>
        }
<span class="nc" id="L282">    }</span>

    /**
     * Starts the MapActivity in &quot;RouteMode&quot;, which shows stops along a route,
     * and does not get new stops when the user pans the map.
     *
     * @param context The context of the activity.
     * @param routeId The route to show.
     */
    public static void start(Context context, String routeId) {
<span class="nc bnc" id="L292" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3862)) {</span>
<span class="nc" id="L293">            context.startActivity(makeIntent(context, routeId));</span>
        }
<span class="nc" id="L295">    }</span>

    /**
     * Returns an intent that will start the MapActivity with a particular stop
     * focused with the center of the map at a particular point.
     *
     * @param context The context of the activity.
     * @param focusId The stop to focus.
     * @param lat     The latitude of the map center.
     * @param lon     The longitude of the map center.
     */
    public static Intent makeIntent(Context context, String focusId, double lat, double lon) {
<span class="nc" id="L307">        Intent myIntent = new Intent(context, HomeActivity.class);</span>
<span class="nc bnc" id="L308" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3863)) {</span>
<span class="nc" id="L309">            myIntent.putExtra(MapParams.STOP_ID, focusId);</span>
        }
<span class="nc bnc" id="L311" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3864)) {</span>
<span class="nc" id="L312">            myIntent.putExtra(MapParams.CENTER_LAT, lat);</span>
        }
<span class="nc bnc" id="L314" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3865)) {</span>
<span class="nc" id="L315">            myIntent.putExtra(MapParams.CENTER_LON, lon);</span>
        }
<span class="nc" id="L317">        return myIntent;</span>
    }

    /**
     * Returns an intent that will start the MapActivity with a particular stop
     * focused with the center of the map at a particular point.
     *
     * @param context The context of the activity.
     * @param stop    The stop to focus on.
     */
    public static Intent makeIntent(Context context, ObaStop stop) {
<span class="nc" id="L328">        Intent myIntent = new Intent(context, HomeActivity.class);</span>
<span class="nc bnc" id="L329" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3866)) {</span>
<span class="nc" id="L330">            myIntent.putExtra(MapParams.STOP_ID, stop.getId());</span>
        }
<span class="nc bnc" id="L332" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3867)) {</span>
<span class="nc" id="L333">            myIntent.putExtra(MapParams.STOP_NAME, stop.getName());</span>
        }
<span class="nc bnc" id="L335" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3868)) {</span>
<span class="nc" id="L336">            myIntent.putExtra(MapParams.STOP_CODE, stop.getStopCode());</span>
        }
<span class="nc bnc" id="L338" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3869)) {</span>
<span class="nc" id="L339">            myIntent.putExtra(MapParams.CENTER_LAT, stop.getLatitude());</span>
        }
<span class="nc bnc" id="L341" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3870)) {</span>
<span class="nc" id="L342">            myIntent.putExtra(MapParams.CENTER_LON, stop.getLongitude());</span>
        }
<span class="nc" id="L344">        return myIntent;</span>
    }

    /**
     * Returns an intent that starts the MapActivity in &quot;RouteMode&quot;, which shows
     * stops along a route, and does not get new stops when the user pans the
     * map.
     *
     * @param context The context of the activity.
     * @param routeId The route to show.
     */
    public static Intent makeIntent(Context context, String routeId) {
<span class="nc" id="L356">        Intent myIntent = new Intent(context, HomeActivity.class);</span>
<span class="nc bnc" id="L357" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3871)) {</span>
<span class="nc" id="L358">            myIntent.putExtra(MapParams.MODE, MapParams.MODE_ROUTE);</span>
        }
<span class="nc bnc" id="L360" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3872)) {</span>
<span class="nc" id="L361">            myIntent.putExtra(MapParams.ZOOM_TO_ROUTE, true);</span>
        }
<span class="nc bnc" id="L363" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3873)) {</span>
<span class="nc" id="L364">            myIntent.putExtra(MapParams.ROUTE_ID, routeId);</span>
        }
<span class="nc" id="L366">        return myIntent;</span>
    }

    SlidingPanelController mSlidingPanelController;

    @Override
    public void onCreate(Bundle savedInstanceState) {
<span class="nc bnc" id="L373" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3874)) {</span>
<span class="nc" id="L374">            requestWindowFeature(Window.FEATURE_INDETERMINATE_PROGRESS);</span>
        }
<span class="nc bnc" id="L376" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3875)) {</span>
<span class="nc" id="L377">            super.onCreate(savedInstanceState);</span>
        }
<span class="nc bnc" id="L379" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3876)) {</span>
<span class="nc" id="L380">            mFirebaseAnalytics = FirebaseAnalytics.getInstance(this);</span>
        }
<span class="nc bnc" id="L382" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3877)) {</span>
<span class="nc" id="L383">            setContentView(R.layout.main);</span>
        }
<span class="nc bnc" id="L385" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3878)) {</span>
<span class="nc" id="L386">            mActivityWeakRef = new WeakReference&lt;&gt;(this);</span>
        }
<span class="nc bnc" id="L388" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3879)) {</span>
<span class="nc" id="L389">            mInitialStartup = Application.getPrefs().getBoolean(INITIAL_STARTUP, true);</span>
        }
<span class="nc bnc" id="L391" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3880)) {</span>
<span class="nc" id="L392">            setupNavigationDrawer();</span>
        }
<span class="nc bnc" id="L394" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3881)) {</span>
<span class="nc" id="L395">            setupSlidingPanel();</span>
        }
<span class="nc bnc" id="L397" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3882)) {</span>
<span class="nc" id="L398">            setupMapState(savedInstanceState);</span>
        }
<span class="nc bnc" id="L400" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3883)) {</span>
<span class="nc" id="L401">            setupLayersSpeedDial();</span>
        }
<span class="nc bnc" id="L403" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3884)) {</span>
<span class="nc" id="L404">            setupMyLocationButton();</span>
        }
<span class="nc bnc" id="L406" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3885)) {</span>
<span class="nc" id="L407">            setupZoomButtons();</span>
        }
<span class="nc bnc" id="L409" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3886)) {</span>
<span class="nc" id="L410">            setupGooglePlayServices();</span>
        }
<span class="nc bnc" id="L412" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3887)) {</span>
<span class="nc" id="L413">            setupPermissions(this);</span>
        }
<span class="nc bnc" id="L415" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3888)) {</span>
<span class="nc" id="L416">            UIUtils.setupActionBar(this);</span>
        }
<span class="nc bnc" id="L418" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3889)) {</span>
<span class="nc" id="L419">            new TravelBehaviorManager(this, getApplicationContext()).registerTravelBehaviorParticipant();</span>
        }
<span class="nc bnc" id="L421" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3892)) {</span>
<span class="nc bnc" id="L422" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(3890) ? (!mInitialStartup &amp;&amp; PermissionUtils.hasGrantedAtLeastOnePermission(this, LOCATION_PERMISSIONS)) : (!mInitialStartup || PermissionUtils.hasGrantedAtLeastOnePermission(this, LOCATION_PERMISSIONS)))) {</span>
<span class="nc bnc" id="L423" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(3891)) {</span>
                    // Otherwise, wait for a permission callback from the BaseMapFragment before checking the region status
<span class="nc" id="L425">                    checkRegionStatus();</span>
                }
            }
        }
        // Check to see if we should show the welcome tutorial
<span class="nc" id="L430">        Bundle b = getIntent().getExtras();</span>
<span class="nc bnc" id="L431" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3895)) {</span>
<span class="nc bnc" id="L432" title="All 2 branches missed.">            if (b != null) {</span>
<span class="nc bnc" id="L433" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(3894)) {</span>
<span class="nc bnc" id="L434" title="All 2 branches missed.">                    if (b.getBoolean(ShowcaseViewUtils.TUTORIAL_WELCOME)) {</span>
<span class="nc bnc" id="L435" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(3893)) {</span>
                            // Show the welcome tutorial
<span class="nc" id="L437">                            ShowcaseViewUtils.showTutorial(ShowcaseViewUtils.TUTORIAL_WELCOME, this, null, false);</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L443">    }</span>

    @Override
    public void onStart() {
<span class="nc bnc" id="L447" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3896)) {</span>
<span class="nc" id="L448">            super.onStart();</span>
        }
<span class="nc bnc" id="L450" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3899)) {</span>
            // Make sure GoogleApiClient is connected, if available
<span class="nc bnc" id="L452" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(3897) ? (mGoogleApiClient != null || !mGoogleApiClient.isConnected()) : (mGoogleApiClient != null &amp;&amp; !mGoogleApiClient.isConnected()))) {</span>
<span class="nc bnc" id="L453" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(3898)) {</span>
<span class="nc" id="L454">                    mGoogleApiClient.connect();</span>
                }
            }
        }
<span class="nc" id="L458">        AccessibilityManager am = (AccessibilityManager) getSystemService(ACCESSIBILITY_SERVICE);</span>
<span class="nc" id="L459">        Boolean isTalkBackEnabled = am.isTouchExplorationEnabled();</span>
<span class="nc bnc" id="L460" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3900)) {</span>
<span class="nc" id="L461">            ObaAnalytics.setAccessibility(mFirebaseAnalytics, isTalkBackEnabled);</span>
        }
<span class="nc" id="L463">    }</span>

    @Override
    public void onResume() {
<span class="nc bnc" id="L467" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3901)) {</span>
<span class="nc" id="L468">            super.onResume();</span>
        }
<span class="nc bnc" id="L470" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3904)) {</span>
            // Make sure header has sliding panel state
<span class="nc bnc" id="L472" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(3902) ? (mArrivalsListHeader != null || mSlidingPanel != null) : (mArrivalsListHeader != null &amp;&amp; mSlidingPanel != null))) {</span>
<span class="nc bnc" id="L473" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(3903)) {</span>
<span class="nc" id="L474">                    mArrivalsListHeader.setSlidingPanelCollapsed(isSlidingPanelCollapsed());</span>
                }
            }
        }
<span class="nc bnc" id="L478" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3907)) {</span>
            // Check if the map zoom controls should be displayed
<span class="nc bnc" id="L480" title="All 2 branches missed.">            if (mCurrentNavDrawerPosition == NAVDRAWER_ITEM_NEARBY) {</span>
<span class="nc bnc" id="L481" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(3906)) {</span>
<span class="nc" id="L482">                    checkDisplayZoomControls();</span>
                }
            } else {
<span class="nc bnc" id="L485" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(3905)) {</span>
<span class="nc" id="L486">                    showZoomControls(false);</span>
                }
            }
        }
<span class="nc bnc" id="L490" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3908)) {</span>
<span class="nc" id="L491">            checkLeftHandMode();</span>
        }
<span class="nc bnc" id="L493" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3909)) {</span>
<span class="nc" id="L494">            updateLayersFab();</span>
        }
<span class="nc bnc" id="L496" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3910)) {</span>
<span class="nc" id="L497">            mFabMyLocation.requestLayout();</span>
        }
<span class="nc" id="L499">    }</span>

    @Override
    protected void onPause() {
<span class="nc bnc" id="L503" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3911)) {</span>
<span class="nc" id="L504">            ShowcaseViewUtils.hideShowcaseView();</span>
        }
<span class="nc bnc" id="L506" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3912)) {</span>
<span class="nc" id="L507">            super.onPause();</span>
        }
<span class="nc" id="L509">    }</span>

    @Override
    public void onStop() {
<span class="nc bnc" id="L513" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3915)) {</span>
            // Tear down GoogleApiClient
<span class="nc bnc" id="L515" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(3913) ? (mGoogleApiClient != null || mGoogleApiClient.isConnected()) : (mGoogleApiClient != null &amp;&amp; mGoogleApiClient.isConnected()))) {</span>
<span class="nc bnc" id="L516" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(3914)) {</span>
<span class="nc" id="L517">                    mGoogleApiClient.disconnect();</span>
                }
            }
        }
<span class="nc bnc" id="L521" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3916)) {</span>
<span class="nc" id="L522">            mLayersFab.closeSpeedDialMenu();</span>
        }
<span class="nc bnc" id="L524" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3917)) {</span>
<span class="nc" id="L525">            super.onStop();</span>
        }
<span class="nc" id="L527">    }</span>

    @Override
    protected void onSaveInstanceState(Bundle outState) {
<span class="nc bnc" id="L531" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3918)) {</span>
<span class="nc" id="L532">            super.onSaveInstanceState(outState);</span>
        }
<span class="nc bnc" id="L534" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3923)) {</span>
<span class="nc bnc" id="L535" title="All 2 branches missed.">            if (mFocusedStopId != null) {</span>
<span class="nc bnc" id="L536" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(3919)) {</span>
<span class="nc" id="L537">                    outState.putString(MapParams.STOP_ID, mFocusedStopId);</span>
                }
<span class="nc bnc" id="L539" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(3922)) {</span>
<span class="nc bnc" id="L540" title="All 2 branches missed.">                    if (mFocusedStop != null) {</span>
<span class="nc bnc" id="L541" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(3920)) {</span>
<span class="nc" id="L542">                            outState.putString(MapParams.STOP_CODE, mFocusedStop.getStopCode());</span>
                        }
<span class="nc bnc" id="L544" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(3921)) {</span>
<span class="nc" id="L545">                            outState.putString(MapParams.STOP_NAME, mFocusedStop.getName());</span>
                        }
                    }
                }
            }
        }
<span class="nc bnc" id="L551" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3925)) {</span>
<span class="nc bnc" id="L552" title="All 2 branches missed.">            if (mBikeRentalStationId != null) {</span>
<span class="nc bnc" id="L553" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(3924)) {</span>
<span class="nc" id="L554">                    outState.putString(MapParams.BIKE_STATION_ID, mBikeRentalStationId);</span>
                }
            }
        }
<span class="nc" id="L558">    }</span>

    @Override
    public void onNavigationDrawerItemSelected(int position) {
<span class="nc bnc" id="L562" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3926)) {</span>
<span class="nc" id="L563">            goToNavDrawerItem(position);</span>
        }
<span class="nc" id="L565">    }</span>

    private void goToNavDrawerItem(int item) {
<span class="nc bnc" id="L568" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3955)) {</span>
            // Update the main content by replacing fragments
<span class="nc bnc" id="L570" title="All 11 branches missed.">            switch(item) {</span>
                case NAVDRAWER_ITEM_STARRED_STOPS:
<span class="nc bnc" id="L572" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(3930)) {</span>
<span class="nc bnc" id="L573" title="All 2 branches missed.">                        if (mCurrentNavDrawerPosition != NAVDRAWER_ITEM_STARRED_STOPS) {</span>
<span class="nc bnc" id="L574" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(3927)) {</span>
<span class="nc" id="L575">                                showStarredStopsFragment();</span>
                            }
<span class="nc bnc" id="L577" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(3928)) {</span>
<span class="nc" id="L578">                                mCurrentNavDrawerPosition = item;</span>
                            }
<span class="nc bnc" id="L580" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(3929)) {</span>
<span class="nc" id="L581">                                ObaAnalytics.reportUiEvent(mFirebaseAnalytics, getString(R.string.analytics_label_button_press_star), null);</span>
                            }
                        }
                    }
                    break;
                case NAVDRAWER_ITEM_STARRED_ROUTES:
<span class="nc bnc" id="L587" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(3934)) {</span>
<span class="nc bnc" id="L588" title="All 2 branches missed.">                        if (mCurrentNavDrawerPosition != NAVDRAWER_ITEM_STARRED_ROUTES) {</span>
<span class="nc bnc" id="L589" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(3931)) {</span>
<span class="nc" id="L590">                                showStarredRoutesFragment();</span>
                            }
<span class="nc bnc" id="L592" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(3932)) {</span>
<span class="nc" id="L593">                                mCurrentNavDrawerPosition = item;</span>
                            }
<span class="nc bnc" id="L595" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(3933)) {</span>
<span class="nc" id="L596">                                ObaAnalytics.reportUiEvent(mFirebaseAnalytics, getString(R.string.analytics_label_button_press_star), null);</span>
                            }
                        }
                    }
                    break;
                // below values are deprecated; fall through to NAVDRAWER_ITEM_NEARBY
                case NAVDRAWER_ITEM_SIGN_IN:
                case NAVDRAWER_ITEM_PROFILE:
                case NAVDRAWER_ITEM_PINS:
                case NAVDRAWER_ITEM_ACTIVITY_FEED:
                case NAVDRAWER_ITEM_NEARBY:
<span class="nc bnc" id="L607" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(3938)) {</span>
<span class="nc bnc" id="L608" title="All 2 branches missed.">                        if (mCurrentNavDrawerPosition != NAVDRAWER_ITEM_NEARBY) {</span>
<span class="nc bnc" id="L609" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(3935)) {</span>
<span class="nc" id="L610">                                showMapFragment();</span>
                            }
<span class="nc bnc" id="L612" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(3936)) {</span>
<span class="nc" id="L613">                                mCurrentNavDrawerPosition = NAVDRAWER_ITEM_NEARBY;</span>
                            }
<span class="nc bnc" id="L615" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(3937)) {</span>
<span class="nc" id="L616">                                ObaAnalytics.reportUiEvent(mFirebaseAnalytics, getString(R.string.analytics_label_button_press_nearby), null);</span>
                            }
                        }
                    }
                    break;
                case NAVDRAWER_ITEM_MY_REMINDERS:
<span class="nc bnc" id="L622" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(3942)) {</span>
<span class="nc bnc" id="L623" title="All 2 branches missed.">                        if (mCurrentNavDrawerPosition != NAVDRAWER_ITEM_MY_REMINDERS) {</span>
<span class="nc bnc" id="L624" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(3939)) {</span>
<span class="nc" id="L625">                                showMyRemindersFragment();</span>
                            }
<span class="nc bnc" id="L627" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(3940)) {</span>
<span class="nc" id="L628">                                mCurrentNavDrawerPosition = item;</span>
                            }
<span class="nc bnc" id="L630" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(3941)) {</span>
<span class="nc" id="L631">                                ObaAnalytics.reportUiEvent(mFirebaseAnalytics, getString(R.string.analytics_label_button_press_reminders), null);</span>
                            }
                        }
                    }
                    break;
                case NAVDRAWER_ITEM_PLAN_TRIP:
<span class="nc" id="L637">                    Intent planTrip = new Intent(HomeActivity.this, TripPlanActivity.class);</span>
<span class="nc bnc" id="L638" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(3943)) {</span>
<span class="nc" id="L639">                        startActivity(planTrip);</span>
                    }
<span class="nc bnc" id="L641" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(3944)) {</span>
<span class="nc" id="L642">                        ObaAnalytics.reportUiEvent(mFirebaseAnalytics, getString(R.string.analytics_label_button_press_trip_plan), null);</span>
                    }
                    break;
                case NAVDRAWER_ITEM_PAY_FARE:
<span class="nc bnc" id="L646" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(3945)) {</span>
<span class="nc" id="L647">                        UIUtils.launchPayMyFareApp(this);</span>
                    }
                    break;
                case NAVDRAWER_ITEM_SETTINGS:
<span class="nc" id="L651">                    Intent preferences = new Intent(HomeActivity.this, PreferencesActivity.class);</span>
<span class="nc bnc" id="L652" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(3946)) {</span>
<span class="nc" id="L653">                        startActivity(preferences);</span>
                    }
<span class="nc bnc" id="L655" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(3947)) {</span>
<span class="nc" id="L656">                        ObaAnalytics.reportUiEvent(mFirebaseAnalytics, getString(R.string.analytics_label_button_press_settings), null);</span>
                    }
                    break;
                case NAVDRAWER_ITEM_HELP:
<span class="nc bnc" id="L660" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(3948)) {</span>
<span class="nc" id="L661">                        showDialog(HELP_DIALOG);</span>
                    }
<span class="nc bnc" id="L663" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(3949)) {</span>
<span class="nc" id="L664">                        ObaAnalytics.reportUiEvent(mFirebaseAnalytics, getString(R.string.analytics_label_button_press_help), null);</span>
                    }
                    break;
                case NAVDRAWER_ITEM_SEND_FEEDBACK:
<span class="nc bnc" id="L668" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(3950)) {</span>
<span class="nc" id="L669">                        ObaAnalytics.reportUiEvent(mFirebaseAnalytics, getString(R.string.analytics_label_button_press_feedback), null);</span>
                    }
<span class="nc bnc" id="L671" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(3951)) {</span>
<span class="nc" id="L672">                        goToSendFeedBack();</span>
                    }
                    break;
                case NAVDRAWER_ITEM_OPEN_SOURCE:
<span class="nc bnc" id="L676" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(3952)) {</span>
<span class="nc" id="L677">                        ObaAnalytics.reportUiEvent(mFirebaseAnalytics, getString(R.string.analytics_label_button_press_open_source), null);</span>
                    }
<span class="nc" id="L679">                    Intent i = new Intent(Intent.ACTION_VIEW);</span>
<span class="nc bnc" id="L680" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(3953)) {</span>
<span class="nc" id="L681">                        i.setData(Uri.parse(getString(R.string.open_source_github)));</span>
                    }
<span class="nc bnc" id="L683" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(3954)) {</span>
<span class="nc" id="L684">                        startActivity(i);</span>
                    }
                    break;
            }
        }
<span class="nc bnc" id="L689" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3956)) {</span>
<span class="nc" id="L690">            invalidateOptionsMenu();</span>
        }
<span class="nc" id="L692">    }</span>

    private void handleNearbySelection() {
<span class="nc" id="L695">    }</span>

    private void showMapFragment() {
<span class="nc" id="L698">        FragmentManager fm = getSupportFragmentManager();</span>
<span class="nc bnc" id="L699" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3957)) {</span>
            /**
             * Hide everything that shouldn't be shown
             */
<span class="nc" id="L703">            hideStarredRoutesFragment();</span>
        }
<span class="nc bnc" id="L705" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3958)) {</span>
<span class="nc" id="L706">            hideStarredStopsFragment();</span>
        }
<span class="nc bnc" id="L708" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3959)) {</span>
<span class="nc" id="L709">            hideReminderFragment();</span>
        }
<span class="nc bnc" id="L711" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3960)) {</span>
<span class="nc" id="L712">            mShowStarredStopsMenu = false;</span>
        }
<span class="nc bnc" id="L714" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3967)) {</span>
            /**
             * Show fragment (we use show instead of replace to keep the map state)
             */
<span class="nc bnc" id="L718" title="All 2 branches missed.">            if (mMapFragment == null) {</span>
<span class="nc bnc" id="L719" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(3961)) {</span>
                    // First check to see if an instance of BaseMapFragment already exists (see #356)
<span class="nc" id="L721">                    mMapFragment = (BaseMapFragment) fm.findFragmentByTag(BaseMapFragment.TAG);</span>
                }
<span class="nc bnc" id="L723" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(3966)) {</span>
<span class="nc bnc" id="L724" title="All 2 branches missed.">                    if (mMapFragment == null) {</span>
<span class="nc bnc" id="L725" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(3962)) {</span>
                            // No existing fragment was found, so create a new one
<span class="nc" id="L727">                            Log.d(TAG, &quot;Creating new BaseMapFragment&quot;);</span>
                        }
<span class="nc bnc" id="L729" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(3963)) {</span>
<span class="nc" id="L730">                            mMapFragment = BaseMapFragment.newInstance();</span>
                        }
<span class="nc bnc" id="L732" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(3964)) {</span>
<span class="nc" id="L733">                            mMapFragment.setOnLocationPermissionResultListener(result -&gt; {</span>
<span class="nc bnc" id="L734" title="All 2 branches missed.">                                if (mInitialStartup) {</span>
                                    // (they'll be asked to manually pick region if they denied)
<span class="nc" id="L736">                                    mInitialStartup = false;</span>
<span class="nc" id="L737">                                    PreferenceUtils.saveBoolean(INITIAL_STARTUP, false);</span>
<span class="nc" id="L738">                                    checkRegionStatus();</span>
                                }
<span class="nc" id="L740">                            });</span>
                        }
<span class="nc bnc" id="L742" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(3965)) {</span>
<span class="nc" id="L743">                            fm.beginTransaction().add(R.id.main_fragment_container, mMapFragment, BaseMapFragment.TAG).commit();</span>
                        }
                    }
                }
            }
        }
<span class="nc bnc" id="L749" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3968)) {</span>
            // Register listener for map focus callbacks
<span class="nc" id="L751">            mMapFragment.setOnFocusChangeListener(this);</span>
        }
<span class="nc bnc" id="L753" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3969)) {</span>
<span class="nc" id="L754">            mMapFragment.setOnProgressBarChangedListener(this);</span>
        }
<span class="nc bnc" id="L756" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3970)) {</span>
<span class="nc" id="L757">            getSupportFragmentManager().beginTransaction().show(mMapFragment).commit();</span>
        }
<span class="nc bnc" id="L759" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3971)) {</span>
<span class="nc" id="L760">            showFloatingActionButtons();</span>
        }
<span class="nc bnc" id="L762" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3973)) {</span>
<span class="nc bnc" id="L763" title="All 2 branches missed.">            if (mLastMapProgressBarState) {</span>
<span class="nc bnc" id="L764" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(3972)) {</span>
<span class="nc" id="L765">                    showMapProgressBar();</span>
                }
            }
        }
<span class="nc bnc" id="L769" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3974)) {</span>
<span class="nc" id="L770">            mShowArrivalsMenu = true;</span>
        }
<span class="nc bnc" id="L772" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3977)) {</span>
<span class="nc bnc" id="L773" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(3975) ? (mFocusedStopId != null || mSlidingPanel != null) : (mFocusedStopId != null &amp;&amp; mSlidingPanel != null))) {</span>
<span class="nc bnc" id="L774" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(3976)) {</span>
                    // if we've focused on a stop, then show the panel that was previously hidden
<span class="nc" id="L776">                    mSlidingPanel.setPanelState(SlidingUpPanelLayout.PanelState.COLLAPSED);</span>
                }
            }
        }
<span class="nc bnc" id="L780" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3978)) {</span>
<span class="nc" id="L781">            setTitle(getResources().getString(R.string.navdrawer_item_nearby));</span>
        }
<span class="nc bnc" id="L783" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3979)) {</span>
<span class="nc" id="L784">            checkDisplayZoomControls();</span>
        }
<span class="nc" id="L786">    }</span>

    private void showStarredStopsFragment() {
<span class="nc" id="L789">        FragmentManager fm = getSupportFragmentManager();</span>
<span class="nc bnc" id="L790" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3980)) {</span>
            /**
             * Hide everything that shouldn't be shown
             */
<span class="nc" id="L794">            hideFloatingActionButtons();</span>
        }
<span class="nc bnc" id="L796" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3981)) {</span>
<span class="nc" id="L797">            hideMapProgressBar();</span>
        }
<span class="nc bnc" id="L799" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3982)) {</span>
<span class="nc" id="L800">            hideMapFragment();</span>
        }
<span class="nc bnc" id="L802" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3983)) {</span>
<span class="nc" id="L803">            hideReminderFragment();</span>
        }
<span class="nc bnc" id="L805" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3984)) {</span>
<span class="nc" id="L806">            hideStarredRoutesFragment();</span>
        }
<span class="nc bnc" id="L808" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3985)) {</span>
<span class="nc" id="L809">            hideSlidingPanel();</span>
        }
<span class="nc bnc" id="L811" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3986)) {</span>
<span class="nc" id="L812">            mShowArrivalsMenu = false;</span>
        }
<span class="nc bnc" id="L814" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3987)) {</span>
<span class="nc" id="L815">            showZoomControls(false);</span>
        }
<span class="nc bnc" id="L817" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3988)) {</span>
            /**
             * Show fragment (we use show instead of replace to keep the map state)
             */
<span class="nc" id="L821">            mShowStarredStopsMenu = true;</span>
        }
<span class="nc bnc" id="L823" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3994)) {</span>
<span class="nc bnc" id="L824" title="All 2 branches missed.">            if (mMyStarredStopsFragment == null) {</span>
<span class="nc bnc" id="L825" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(3989)) {</span>
                    // First check to see if an instance of MyStarredStopsFragment already exists (see #356)
<span class="nc" id="L827">                    mMyStarredStopsFragment = (MyStarredStopsFragment) fm.findFragmentByTag(MyStarredStopsFragment.TAG);</span>
                }
<span class="nc bnc" id="L829" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(3993)) {</span>
<span class="nc bnc" id="L830" title="All 2 branches missed.">                    if (mMyStarredStopsFragment == null) {</span>
<span class="nc bnc" id="L831" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(3990)) {</span>
                            // No existing fragment was found, so create a new one
<span class="nc" id="L833">                            Log.d(TAG, &quot;Creating new MyStarredStopsFragment&quot;);</span>
                        }
<span class="nc bnc" id="L835" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(3991)) {</span>
<span class="nc" id="L836">                            mMyStarredStopsFragment = new MyStarredStopsFragment();</span>
                        }
<span class="nc bnc" id="L838" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(3992)) {</span>
<span class="nc" id="L839">                            fm.beginTransaction().add(R.id.main_fragment_container, mMyStarredStopsFragment, MyStarredStopsFragment.TAG).commit();</span>
                        }
                    }
                }
            }
        }
<span class="nc bnc" id="L845" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3995)) {</span>
<span class="nc" id="L846">            fm.beginTransaction().show(mMyStarredStopsFragment).commit();</span>
        }
<span class="nc bnc" id="L848" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3996)) {</span>
<span class="nc" id="L849">            setTitle(getResources().getString(R.string.navdrawer_item_starred_stops));</span>
        }
<span class="nc" id="L851">    }</span>

    private void showStarredRoutesFragment() {
<span class="nc" id="L854">        FragmentManager fm = getSupportFragmentManager();</span>
<span class="nc bnc" id="L855" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3997)) {</span>
            /**
             * Hide everything that shouldn't be shown
             */
<span class="nc" id="L859">            hideFloatingActionButtons();</span>
        }
<span class="nc bnc" id="L861" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3998)) {</span>
<span class="nc" id="L862">            hideMapProgressBar();</span>
        }
<span class="nc bnc" id="L864" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(3999)) {</span>
<span class="nc" id="L865">            hideMapFragment();</span>
        }
<span class="nc bnc" id="L867" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4000)) {</span>
<span class="nc" id="L868">            hideReminderFragment();</span>
        }
<span class="nc bnc" id="L870" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4001)) {</span>
<span class="nc" id="L871">            hideSlidingPanel();</span>
        }
<span class="nc bnc" id="L873" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4002)) {</span>
<span class="nc" id="L874">            hideStarredStopsFragment();</span>
        }
<span class="nc bnc" id="L876" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4003)) {</span>
<span class="nc" id="L877">            mShowArrivalsMenu = false;</span>
        }
<span class="nc bnc" id="L879" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4004)) {</span>
<span class="nc" id="L880">            showZoomControls(false);</span>
        }
<span class="nc bnc" id="L882" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4005)) {</span>
            /**
             * Show fragment (we use show instead of replace to keep the map state)
             */
<span class="nc" id="L886">            mShowStarredRoutesMenu = true;</span>
        }
<span class="nc bnc" id="L888" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4011)) {</span>
<span class="nc bnc" id="L889" title="All 2 branches missed.">            if (mMyStarredRoutesFragment == null) {</span>
<span class="nc bnc" id="L890" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4006)) {</span>
                    // First check to see if an instance of MyStarredRoutesFragment already exists
<span class="nc" id="L892">                    mMyStarredRoutesFragment = (MyStarredRoutesFragment) fm.findFragmentByTag(MyStarredRoutesFragment.TAG);</span>
                }
<span class="nc bnc" id="L894" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4010)) {</span>
<span class="nc bnc" id="L895" title="All 2 branches missed.">                    if (mMyStarredRoutesFragment == null) {</span>
<span class="nc bnc" id="L896" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4007)) {</span>
                            // No existing fragment was found, so create a new one
<span class="nc" id="L898">                            Log.d(TAG, &quot;Creating new MyStarredRoutesFragment&quot;);</span>
                        }
<span class="nc bnc" id="L900" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4008)) {</span>
<span class="nc" id="L901">                            mMyStarredRoutesFragment = new MyStarredRoutesFragment();</span>
                        }
<span class="nc bnc" id="L903" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4009)) {</span>
<span class="nc" id="L904">                            fm.beginTransaction().add(R.id.main_fragment_container, mMyStarredRoutesFragment, MyStarredRoutesFragment.TAG).commit();</span>
                        }
                    }
                }
            }
        }
<span class="nc bnc" id="L910" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4012)) {</span>
<span class="nc" id="L911">            fm.beginTransaction().show(mMyStarredRoutesFragment).commit();</span>
        }
<span class="nc bnc" id="L913" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4013)) {</span>
<span class="nc" id="L914">            setTitle(getResources().getString(R.string.navdrawer_item_starred_routes));</span>
        }
<span class="nc" id="L916">    }</span>

    private void showMyRemindersFragment() {
<span class="nc" id="L919">        FragmentManager fm = getSupportFragmentManager();</span>
<span class="nc bnc" id="L920" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4014)) {</span>
            /**
             * Hide everything that shouldn't be shown
             */
<span class="nc" id="L924">            hideFloatingActionButtons();</span>
        }
<span class="nc bnc" id="L926" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4015)) {</span>
<span class="nc" id="L927">            hideMapProgressBar();</span>
        }
<span class="nc bnc" id="L929" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4016)) {</span>
<span class="nc" id="L930">            hideStarredRoutesFragment();</span>
        }
<span class="nc bnc" id="L932" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4017)) {</span>
<span class="nc" id="L933">            hideStarredStopsFragment();</span>
        }
<span class="nc bnc" id="L935" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4018)) {</span>
<span class="nc" id="L936">            hideMapFragment();</span>
        }
<span class="nc bnc" id="L938" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4019)) {</span>
<span class="nc" id="L939">            hideSlidingPanel();</span>
        }
<span class="nc bnc" id="L941" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4020)) {</span>
<span class="nc" id="L942">            mShowArrivalsMenu = false;</span>
        }
<span class="nc bnc" id="L944" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4021)) {</span>
<span class="nc" id="L945">            mShowStarredStopsMenu = false;</span>
        }
<span class="nc bnc" id="L947" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4022)) {</span>
<span class="nc" id="L948">            showZoomControls(false);</span>
        }
<span class="nc bnc" id="L950" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4028)) {</span>
            /**
             * Show fragment (we use show instead of replace to keep the map state)
             */
<span class="nc bnc" id="L954" title="All 2 branches missed.">            if (mMyRemindersFragment == null) {</span>
<span class="nc bnc" id="L955" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4023)) {</span>
                    // First check to see if an instance of MyRemindersFragment already exists (see #356)
<span class="nc" id="L957">                    mMyRemindersFragment = (MyRemindersFragment) fm.findFragmentByTag(MyRemindersFragment.TAG);</span>
                }
<span class="nc bnc" id="L959" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4027)) {</span>
<span class="nc bnc" id="L960" title="All 2 branches missed.">                    if (mMyRemindersFragment == null) {</span>
<span class="nc bnc" id="L961" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4024)) {</span>
                            // No existing fragment was found, so create a new one
<span class="nc" id="L963">                            Log.d(TAG, &quot;Creating new MyRemindersFragment&quot;);</span>
                        }
<span class="nc bnc" id="L965" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4025)) {</span>
<span class="nc" id="L966">                            mMyRemindersFragment = new MyRemindersFragment();</span>
                        }
<span class="nc bnc" id="L968" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4026)) {</span>
<span class="nc" id="L969">                            fm.beginTransaction().add(R.id.main_fragment_container, mMyRemindersFragment, MyRemindersFragment.TAG).commit();</span>
                        }
                    }
                }
            }
        }
<span class="nc bnc" id="L975" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4029)) {</span>
<span class="nc" id="L976">            fm.beginTransaction().show(mMyRemindersFragment).commit();</span>
        }
<span class="nc bnc" id="L978" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4030)) {</span>
<span class="nc" id="L979">            setTitle(getResources().getString(R.string.navdrawer_item_my_reminders));</span>
        }
<span class="nc" id="L981">    }</span>

    private void hideMapFragment() {
<span class="nc" id="L984">        FragmentManager fm = getSupportFragmentManager();</span>
<span class="nc bnc" id="L985" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4031)) {</span>
<span class="nc" id="L986">            mMapFragment = (BaseMapFragment) fm.findFragmentByTag(BaseMapFragment.TAG);</span>
        }
<span class="nc bnc" id="L988" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4034)) {</span>
<span class="nc bnc" id="L989" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(4032) ? (mMapFragment != null || !mMapFragment.isHidden()) : (mMapFragment != null &amp;&amp; !mMapFragment.isHidden()))) {</span>
<span class="nc bnc" id="L990" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4033)) {</span>
<span class="nc" id="L991">                    fm.beginTransaction().hide(mMapFragment).commit();</span>
                }
            }
        }
<span class="nc" id="L995">    }</span>

    private void hideStarredStopsFragment() {
<span class="nc" id="L998">        FragmentManager fm = getSupportFragmentManager();</span>
<span class="nc bnc" id="L999" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4035)) {</span>
<span class="nc" id="L1000">            mMyStarredStopsFragment = (MyStarredStopsFragment) fm.findFragmentByTag(MyStarredStopsFragment.TAG);</span>
        }
<span class="nc bnc" id="L1002" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4038)) {</span>
<span class="nc bnc" id="L1003" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(4036) ? (mMyStarredStopsFragment != null || !mMyStarredStopsFragment.isHidden()) : (mMyStarredStopsFragment != null &amp;&amp; !mMyStarredStopsFragment.isHidden()))) {</span>
<span class="nc bnc" id="L1004" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4037)) {</span>
<span class="nc" id="L1005">                    fm.beginTransaction().hide(mMyStarredStopsFragment).commit();</span>
                }
            }
        }
<span class="nc" id="L1009">    }</span>

    private void hideStarredRoutesFragment() {
<span class="nc" id="L1012">        FragmentManager fm = getSupportFragmentManager();</span>
<span class="nc bnc" id="L1013" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4039)) {</span>
<span class="nc" id="L1014">            mMyStarredRoutesFragment = (MyStarredRoutesFragment) fm.findFragmentByTag(MyStarredRoutesFragment.TAG);</span>
        }
<span class="nc bnc" id="L1016" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4042)) {</span>
<span class="nc bnc" id="L1017" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(4040) ? (mMyStarredRoutesFragment != null || !mMyStarredRoutesFragment.isHidden()) : (mMyStarredRoutesFragment != null &amp;&amp; !mMyStarredRoutesFragment.isHidden()))) {</span>
<span class="nc bnc" id="L1018" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4041)) {</span>
<span class="nc" id="L1019">                    fm.beginTransaction().hide(mMyStarredRoutesFragment).commit();</span>
                }
            }
        }
<span class="nc" id="L1023">    }</span>

    private void hideReminderFragment() {
<span class="nc" id="L1026">        FragmentManager fm = getSupportFragmentManager();</span>
<span class="nc bnc" id="L1027" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4043)) {</span>
<span class="nc" id="L1028">            mMyRemindersFragment = (MyRemindersFragment) fm.findFragmentByTag(MyRemindersFragment.TAG);</span>
        }
<span class="nc bnc" id="L1030" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4046)) {</span>
<span class="nc bnc" id="L1031" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(4044) ? (mMyRemindersFragment != null || !mMyRemindersFragment.isHidden()) : (mMyRemindersFragment != null &amp;&amp; !mMyRemindersFragment.isHidden()))) {</span>
<span class="nc bnc" id="L1032" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4045)) {</span>
<span class="nc" id="L1033">                    fm.beginTransaction().hide(mMyRemindersFragment).commit();</span>
                }
            }
        }
<span class="nc" id="L1037">    }</span>

    private void hideSlidingPanel() {
<span class="nc bnc" id="L1040" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4048)) {</span>
<span class="nc bnc" id="L1041" title="All 2 branches missed.">            if (mSlidingPanel != null) {</span>
<span class="nc bnc" id="L1042" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4047)) {</span>
<span class="nc" id="L1043">                    mSlidingPanel.setPanelState(SlidingUpPanelLayout.PanelState.HIDDEN);</span>
                }
            }
        }
<span class="nc" id="L1047">    }</span>

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
<span class="nc bnc" id="L1051" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4049)) {</span>
<span class="nc" id="L1052">            getMenuInflater().inflate(R.menu.main_options, menu);</span>
        }
<span class="nc bnc" id="L1054" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4050)) {</span>
<span class="nc" id="L1055">            UIUtils.setupSearch(this, menu);</span>
        }
<span class="nc bnc" id="L1057" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4051)) {</span>
            // Initialize fragment menu visibility here, so we don't have overlap between the various fragments
<span class="nc" id="L1059">            setupOptionsMenu(menu);</span>
        }
<span class="nc" id="L1061">        return super.onCreateOptionsMenu(menu);</span>
    }

    @Override
    public boolean onPrepareOptionsMenu(Menu menu) {
<span class="nc bnc" id="L1066" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4052)) {</span>
<span class="nc" id="L1067">            super.onPrepareOptionsMenu(menu);</span>
        }
<span class="nc bnc" id="L1069" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4053)) {</span>
            // Manage fragment menu visibility here, so we don't have overlap between the various fragments
<span class="nc" id="L1071">            setupOptionsMenu(menu);</span>
        }
<span class="nc" id="L1073">        return true;</span>
    }

    private void setupOptionsMenu(Menu menu) {
<span class="nc bnc" id="L1077" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4054)) {</span>
<span class="nc" id="L1078">            menu.setGroupVisible(R.id.main_options_menu_group, true);</span>
        }
<span class="nc bnc" id="L1080" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4055)) {</span>
<span class="nc" id="L1081">            menu.setGroupVisible(R.id.arrival_list_menu_group, mShowArrivalsMenu);</span>
        }
<span class="nc bnc" id="L1083" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4056)) {</span>
<span class="nc" id="L1084">            menu.setGroupVisible(R.id.starred_stop_menu_group, mShowStarredStopsMenu);</span>
        }
<span class="nc bnc" id="L1086" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4057)) {</span>
<span class="nc" id="L1087">            menu.setGroupVisible(R.id.starred_route_menu_group, mShowStarredRoutesMenu);</span>
        }
<span class="nc" id="L1089">    }</span>

    @Override
    @SuppressWarnings(&quot;deprecation&quot;)
    public boolean onOptionsItemSelected(MenuItem item) {
<span class="nc bnc" id="L1094" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4058)) {</span>
<span class="nc" id="L1095">            Log.d(TAG, &quot;onOptionsItemSelected&quot;);</span>
        }
<span class="nc" id="L1097">        final int id = item.getItemId();</span>
<span class="nc bnc" id="L1098" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4063)) {</span>
<span class="nc bnc" id="L1099" title="All 2 branches missed.">            if (id == R.id.search) {</span>
<span class="nc bnc" id="L1100" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4061)) {</span>
<span class="nc" id="L1101">                    onSearchRequested();</span>
                }
<span class="nc bnc" id="L1103" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4062)) {</span>
<span class="nc" id="L1104">                    ObaAnalytics.reportUiEvent(mFirebaseAnalytics, getString(R.string.analytics_label_button_press_search_box), null);</span>
                }
<span class="nc" id="L1106">                return true;</span>
<span class="nc bnc" id="L1107" title="All 2 branches missed.">            } else if (id == R.id.recent_stops_routes) {</span>
<span class="nc bnc" id="L1108" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4059)) {</span>
<span class="nc" id="L1109">                    ShowcaseViewUtils.doNotShowTutorial(ShowcaseViewUtils.TUTORIAL_RECENT_STOPS_ROUTES);</span>
                }
<span class="nc" id="L1111">                Intent myIntent = new Intent(this, MyRecentStopsAndRoutesActivity.class);</span>
<span class="nc bnc" id="L1112" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4060)) {</span>
<span class="nc" id="L1113">                    startActivity(myIntent);</span>
                }
<span class="nc" id="L1115">                return true;</span>
            }
        }
<span class="nc" id="L1118">        return super.onOptionsItemSelected(item);</span>
    }

    @Override
    protected Dialog onCreateDialog(int id) {
<span class="nc bnc" id="L1123" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4064)) {</span>
<span class="nc bnc" id="L1124" title="All 4 branches missed.">            switch(id) {</span>
                case HELP_DIALOG:
<span class="nc" id="L1126">                    return createHelpDialog();</span>
                case WHATSNEW_DIALOG:
<span class="nc" id="L1128">                    return createWhatsNewDialog();</span>
                case LEGEND_DIALOG:
<span class="nc" id="L1130">                    return createLegendDialog();</span>
            }
        }
<span class="nc" id="L1133">        return super.onCreateDialog(id);</span>
    }

    @SuppressWarnings(&quot;deprecation&quot;)
    private Dialog createHelpDialog() {
<span class="nc" id="L1138">        AlertDialog.Builder builder = new AlertDialog.Builder(this);</span>
<span class="nc bnc" id="L1139" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4065)) {</span>
<span class="nc" id="L1140">            builder.setTitle(R.string.main_help_title);</span>
        }
        // If a custom API URL is set, hide Contact Us, as we don't have a contact email to use
        int options;
<span class="nc bnc" id="L1144" title="All 2 branches missed.">        if (TextUtils.isEmpty(Application.get().getCustomApiUrl())) {</span>
<span class="nc" id="L1145">            options = R.array.main_help_options;</span>
        } else {
            // Hide &quot;Contact Us&quot;
<span class="nc" id="L1148">            options = R.array.main_help_options_no_contact_us;</span>
        }
<span class="nc bnc" id="L1150" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4078)) {</span>
<span class="nc" id="L1151">            builder.setItems(options, new DialogInterface.OnClickListener() {</span>

                public void onClick(DialogInterface dialog, int which) {
<span class="nc bnc" id="L1154" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4077)) {</span>
<span class="nc bnc" id="L1155" title="All 7 branches missed.">                        switch(which) {</span>
                            case 0:
<span class="nc bnc" id="L1157" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(4066)) {</span>
<span class="nc" id="L1158">                                    ShowcaseViewUtils.resetAllTutorials(HomeActivity.this);</span>
                                }
<span class="nc bnc" id="L1160" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(4067)) {</span>
<span class="nc" id="L1161">                                    NavHelp.goHome(HomeActivity.this, true);</span>
                                }
                                break;
                            case 1:
<span class="nc bnc" id="L1165" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(4068)) {</span>
<span class="nc" id="L1166">                                    showDialog(LEGEND_DIALOG);</span>
                                }
                                break;
                            case 2:
<span class="nc bnc" id="L1170" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(4069)) {</span>
<span class="nc" id="L1171">                                    showDialog(WHATSNEW_DIALOG);</span>
                                }
                                break;
                            case 3:
<span class="nc bnc" id="L1175" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(4070)) {</span>
<span class="nc" id="L1176">                                    AgenciesActivity.start(HomeActivity.this);</span>
                                }
                                break;
                            case 4:
<span class="nc" id="L1180">                                String twitterUrl = TWITTER_URL;</span>
<span class="nc bnc" id="L1181" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(4073)) {</span>
<span class="nc bnc" id="L1182" title="All 10 branches missed.">                                    if ((ListenerUtil.mutListener.listen(4071) ? (Application.get().getCurrentRegion() != null || !TextUtils.isEmpty(Application.get().getCurrentRegion().getTwitterUrl())) : (Application.get().getCurrentRegion() != null &amp;&amp; !TextUtils.isEmpty(Application.get().getCurrentRegion().getTwitterUrl())))) {</span>
<span class="nc bnc" id="L1183" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(4072)) {</span>
<span class="nc" id="L1184">                                            twitterUrl = Application.get().getCurrentRegion().getTwitterUrl();</span>
                                        }
                                    }
                                }
<span class="nc bnc" id="L1188" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(4074)) {</span>
<span class="nc" id="L1189">                                    UIUtils.goToUrl(HomeActivity.this, twitterUrl);</span>
                                }
<span class="nc bnc" id="L1191" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(4075)) {</span>
<span class="nc" id="L1192">                                    ObaAnalytics.reportUiEvent(mFirebaseAnalytics, getString(R.string.analytics_label_twitter), null);</span>
                                }
                                break;
                            case 5:
<span class="nc bnc" id="L1196" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(4076)) {</span>
                                    // Contact us
<span class="nc" id="L1198">                                    goToSendFeedBack();</span>
                                }
                                break;
                        }
                    }
<span class="nc" id="L1203">                }</span>
            });
        }
<span class="nc" id="L1206">        return builder.create();</span>
    }

    @SuppressWarnings(&quot;deprecation&quot;)
    private Dialog createWhatsNewDialog() {
<span class="nc" id="L1211">        TextView textView = (TextView) getLayoutInflater().inflate(R.layout.whats_new_dialog, null);</span>
<span class="nc bnc" id="L1212" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4079)) {</span>
<span class="nc" id="L1213">            textView.setText(R.string.main_help_whatsnew);</span>
        }
<span class="nc" id="L1215">        AlertDialog.Builder builder = new AlertDialog.Builder(this);</span>
<span class="nc bnc" id="L1216" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4080)) {</span>
<span class="nc" id="L1217">            builder.setTitle(R.string.main_help_whatsnew_title);</span>
        }
<span class="nc bnc" id="L1219" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4081)) {</span>
<span class="nc" id="L1220">            builder.setIcon(R.mipmap.ic_launcher);</span>
        }
<span class="nc bnc" id="L1222" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4082)) {</span>
<span class="nc" id="L1223">            builder.setView(textView);</span>
        }
<span class="nc bnc" id="L1225" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4083)) {</span>
<span class="nc" id="L1226">            builder.setNeutralButton(R.string.main_help_close, (dialog, which) -&gt; dismissDialog(WHATSNEW_DIALOG));</span>
        }
<span class="nc bnc" id="L1228" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4086)) {</span>
<span class="nc" id="L1229">            builder.setOnDismissListener(new DialogInterface.OnDismissListener() {</span>

                @Override
                public void onDismiss(DialogInterface dialog) {
<span class="nc" id="L1233">                    boolean showOptOut = Application.getPrefs().getBoolean(ShowcaseViewUtils.TUTORIAL_OPT_OUT_DIALOG, true);</span>
<span class="nc bnc" id="L1234" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4085)) {</span>
<span class="nc bnc" id="L1235" title="All 2 branches missed.">                        if (showOptOut) {</span>
<span class="nc bnc" id="L1236" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(4084)) {</span>
<span class="nc" id="L1237">                                ShowcaseViewUtils.showOptOutDialog(HomeActivity.this);</span>
                            }
                        }
                    }
<span class="nc" id="L1241">                }</span>
            });
        }
<span class="nc" id="L1244">        return builder.create();</span>
    }

    @SuppressWarnings(&quot;deprecation&quot;)
    private Dialog createLegendDialog() {
<span class="nc" id="L1249">        AlertDialog.Builder builder = new AlertDialog.Builder(this);</span>
<span class="nc bnc" id="L1250" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4087)) {</span>
<span class="nc" id="L1251">            builder.setTitle(R.string.main_help_legend_title);</span>
        }
<span class="nc" id="L1253">        Resources resources = getResources();</span>
<span class="nc" id="L1254">        LayoutInflater inflater = LayoutInflater.from(getApplicationContext());</span>
<span class="nc" id="L1255">        View legendDialogView = inflater.inflate(R.layout.legend_dialog, null);</span>
<span class="nc" id="L1256">        final float etaTextFontSize = 30;</span>
        // On time view
<span class="nc" id="L1258">        View etaAndMin = legendDialogView.findViewById(R.id.eta_view_ontime);</span>
<span class="nc" id="L1259">        GradientDrawable d1 = (GradientDrawable) etaAndMin.getBackground();</span>
<span class="nc bnc" id="L1260" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4088)) {</span>
<span class="nc" id="L1261">            d1.setColor(resources.getColor(R.color.stop_info_ontime));</span>
        }
<span class="nc bnc" id="L1263" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4089)) {</span>
<span class="nc" id="L1264">            etaAndMin.findViewById(R.id.eta_realtime_indicator).setVisibility(View.VISIBLE);</span>
        }
<span class="nc" id="L1266">        TextView etaTextView = etaAndMin.findViewById(R.id.eta);</span>
<span class="nc bnc" id="L1267" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4090)) {</span>
<span class="nc" id="L1268">            etaTextView.setTextSize(etaTextFontSize);</span>
        }
<span class="nc bnc" id="L1270" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4091)) {</span>
<span class="nc" id="L1271">            etaTextView.setText(&quot;5&quot;);</span>
        }
<span class="nc bnc" id="L1273" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4092)) {</span>
            // Early View
<span class="nc" id="L1275">            etaAndMin = legendDialogView.findViewById(R.id.eta_view_early);</span>
        }
<span class="nc bnc" id="L1277" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4093)) {</span>
<span class="nc" id="L1278">            d1 = (GradientDrawable) etaAndMin.getBackground();</span>
        }
<span class="nc bnc" id="L1280" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4094)) {</span>
<span class="nc" id="L1281">            d1.setColor(resources.getColor(R.color.stop_info_early));</span>
        }
<span class="nc bnc" id="L1283" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4095)) {</span>
<span class="nc" id="L1284">            etaAndMin.findViewById(R.id.eta_realtime_indicator).setVisibility(View.VISIBLE);</span>
        }
<span class="nc bnc" id="L1286" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4096)) {</span>
<span class="nc" id="L1287">            etaTextView = etaAndMin.findViewById(R.id.eta);</span>
        }
<span class="nc bnc" id="L1289" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4097)) {</span>
<span class="nc" id="L1290">            etaTextView.setTextSize(etaTextFontSize);</span>
        }
<span class="nc bnc" id="L1292" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4098)) {</span>
<span class="nc" id="L1293">            etaTextView.setText(&quot;5&quot;);</span>
        }
<span class="nc bnc" id="L1295" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4099)) {</span>
            // Delayed View
<span class="nc" id="L1297">            etaAndMin = legendDialogView.findViewById(R.id.eta_view_delayed);</span>
        }
<span class="nc bnc" id="L1299" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4100)) {</span>
<span class="nc" id="L1300">            d1 = (GradientDrawable) etaAndMin.getBackground();</span>
        }
<span class="nc bnc" id="L1302" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4101)) {</span>
<span class="nc" id="L1303">            d1.setColor(resources.getColor(R.color.stop_info_delayed));</span>
        }
<span class="nc bnc" id="L1305" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4102)) {</span>
<span class="nc" id="L1306">            etaAndMin.findViewById(R.id.eta_realtime_indicator).setVisibility(View.VISIBLE);</span>
        }
<span class="nc bnc" id="L1308" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4103)) {</span>
<span class="nc" id="L1309">            etaTextView = etaAndMin.findViewById(R.id.eta);</span>
        }
<span class="nc bnc" id="L1311" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4104)) {</span>
<span class="nc" id="L1312">            etaTextView.setTextSize(etaTextFontSize);</span>
        }
<span class="nc bnc" id="L1314" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4105)) {</span>
<span class="nc" id="L1315">            etaTextView.setText(&quot;5&quot;);</span>
        }
<span class="nc bnc" id="L1317" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4106)) {</span>
            // Scheduled View
<span class="nc" id="L1319">            etaAndMin = legendDialogView.findViewById(R.id.eta_view_scheduled);</span>
        }
<span class="nc bnc" id="L1321" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4107)) {</span>
<span class="nc" id="L1322">            d1 = (GradientDrawable) etaAndMin.getBackground();</span>
        }
<span class="nc bnc" id="L1324" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4108)) {</span>
<span class="nc" id="L1325">            d1.setColor(resources.getColor(R.color.stop_info_scheduled_time));</span>
        }
<span class="nc bnc" id="L1327" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4109)) {</span>
<span class="nc" id="L1328">            etaAndMin.findViewById(R.id.eta_realtime_indicator).setVisibility(View.INVISIBLE);</span>
        }
<span class="nc bnc" id="L1330" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4110)) {</span>
<span class="nc" id="L1331">            etaTextView = etaAndMin.findViewById(R.id.eta);</span>
        }
<span class="nc bnc" id="L1333" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4111)) {</span>
<span class="nc" id="L1334">            etaTextView.setTextSize(etaTextFontSize);</span>
        }
<span class="nc bnc" id="L1336" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4112)) {</span>
<span class="nc" id="L1337">            etaTextView.setText(&quot;5&quot;);</span>
        }
<span class="nc bnc" id="L1339" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4113)) {</span>
            // Canceled View
<span class="nc" id="L1341">            etaAndMin = legendDialogView.findViewById(R.id.eta_view_canceled);</span>
        }
<span class="nc bnc" id="L1343" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4114)) {</span>
<span class="nc" id="L1344">            d1 = (GradientDrawable) etaAndMin.getBackground();</span>
        }
<span class="nc bnc" id="L1346" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4115)) {</span>
<span class="nc" id="L1347">            d1.setColor(resources.getColor(R.color.stop_info_scheduled_time));</span>
        }
<span class="nc bnc" id="L1349" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4116)) {</span>
<span class="nc" id="L1350">            etaAndMin.findViewById(R.id.eta_realtime_indicator).setVisibility(View.INVISIBLE);</span>
        }
<span class="nc bnc" id="L1352" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4117)) {</span>
<span class="nc" id="L1353">            etaTextView = etaAndMin.findViewById(R.id.eta);</span>
        }
<span class="nc bnc" id="L1355" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4118)) {</span>
<span class="nc" id="L1356">            etaTextView.setTextSize(etaTextFontSize);</span>
        }
<span class="nc bnc" id="L1358" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4119)) {</span>
<span class="nc" id="L1359">            etaTextView.setText(&quot;5&quot;);</span>
        }
<span class="nc bnc" id="L1361" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4120)) {</span>
<span class="nc" id="L1362">            etaTextView.setPaintFlags(Paint.STRIKE_THRU_TEXT_FLAG);</span>
        }
<span class="nc" id="L1364">        TextView etaMin = etaAndMin.findViewById(R.id.eta_min);</span>
<span class="nc bnc" id="L1365" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4121)) {</span>
<span class="nc" id="L1366">            etaMin.setPaintFlags(Paint.STRIKE_THRU_TEXT_FLAG);</span>
        }
<span class="nc bnc" id="L1368" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4122)) {</span>
<span class="nc" id="L1369">            builder.setView(legendDialogView);</span>
        }
<span class="nc bnc" id="L1371" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4123)) {</span>
<span class="nc" id="L1372">            builder.setNeutralButton(R.string.main_help_close, (dialog, which) -&gt; dismissDialog(LEGEND_DIALOG));</span>
        }
<span class="nc" id="L1374">        return builder.create();</span>
    }

    /**
     * Show the &quot;What's New&quot; message if a new version was just installed
     *
     * @return true if a new version was just installed, false if not
     */
    @SuppressWarnings(&quot;deprecation&quot;)
    private boolean autoShowWhatsNew() {
<span class="nc" id="L1384">        SharedPreferences settings = Application.getPrefs();</span>
        // Get the current app version.
<span class="nc" id="L1386">        PackageManager pm = getPackageManager();</span>
<span class="nc" id="L1387">        PackageInfo appInfo = null;</span>
        try {
<span class="nc bnc" id="L1389" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(4124)) {</span>
<span class="nc" id="L1390">                appInfo = pm.getPackageInfo(getPackageName(), PackageManager.GET_META_DATA);</span>
            }
<span class="nc" id="L1392">        } catch (NameNotFoundException e) {</span>
            // Do nothing, perhaps we'll get to show it again? Or never.
<span class="nc" id="L1394">            return false;</span>
<span class="nc" id="L1395">        }</span>
<span class="nc" id="L1396">        final int oldVer = settings.getInt(WHATS_NEW_VER, 0);</span>
<span class="nc" id="L1397">        final int newVer = appInfo.versionCode;</span>
<span class="nc bnc" id="L1398" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4135)) {</span>
<span class="nc bnc" id="L1399" title="All 106 branches missed.">            if ((ListenerUtil.mutListener.listen(4131) ? ((ListenerUtil.mutListener.listen(4130) ? ((ListenerUtil.mutListener.listen(4129) ? (oldVer &gt;= newVer) : (ListenerUtil.mutListener.listen(4128) ? (oldVer &lt;= newVer) : (ListenerUtil.mutListener.listen(4127) ? (oldVer &gt; newVer) : (ListenerUtil.mutListener.listen(4126) ? (oldVer != newVer) : (ListenerUtil.mutListener.listen(4125) ? (oldVer == newVer) : (oldVer &lt; newVer)))))) || mActivityWeakRef.get() != null) : ((ListenerUtil.mutListener.listen(4129) ? (oldVer &gt;= newVer) : (ListenerUtil.mutListener.listen(4128) ? (oldVer &lt;= newVer) : (ListenerUtil.mutListener.listen(4127) ? (oldVer &gt; newVer) : (ListenerUtil.mutListener.listen(4126) ? (oldVer != newVer) : (ListenerUtil.mutListener.listen(4125) ? (oldVer == newVer) : (oldVer &lt; newVer)))))) &amp;&amp; mActivityWeakRef.get() != null)) || !mActivityWeakRef.get().isFinishing()) : ((ListenerUtil.mutListener.listen(4130) ? ((ListenerUtil.mutListener.listen(4129) ? (oldVer &gt;= newVer) : (ListenerUtil.mutListener.listen(4128) ? (oldVer &lt;= newVer) : (ListenerUtil.mutListener.listen(4127) ? (oldVer &gt; newVer) : (ListenerUtil.mutListener.listen(4126) ? (oldVer != newVer) : (ListenerUtil.mutListener.listen(4125) ? (oldVer == newVer) : (oldVer &lt; newVer)))))) || mActivityWeakRef.get() != null) : ((ListenerUtil.mutListener.listen(4129) ? (oldVer &gt;= newVer) : (ListenerUtil.mutListener.listen(4128) ? (oldVer &lt;= newVer) : (ListenerUtil.mutListener.listen(4127) ? (oldVer &gt; newVer) : (ListenerUtil.mutListener.listen(4126) ? (oldVer != newVer) : (ListenerUtil.mutListener.listen(4125) ? (oldVer == newVer) : (oldVer &lt; newVer)))))) &amp;&amp; mActivityWeakRef.get() != null)) &amp;&amp; !mActivityWeakRef.get().isFinishing()))) {</span>
<span class="nc bnc" id="L1400" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4132)) {</span>
<span class="nc" id="L1401">                    mActivityWeakRef.get().showDialog(WHATSNEW_DIALOG);</span>
                }
<span class="nc bnc" id="L1403" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4133)) {</span>
                    // having the app run again).
<span class="nc" id="L1405">                    TripService.scheduleAll(this, true);</span>
                }
<span class="nc bnc" id="L1407" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4134)) {</span>
<span class="nc" id="L1408">                    PreferenceUtils.saveInt(WHATS_NEW_VER, appInfo.versionCode);</span>
                }
<span class="nc" id="L1410">                return true;</span>
            }
        }
<span class="nc" id="L1413">        return false;</span>
    }

    /**
     * Called by the BaseMapFragment when a stop obtains focus, or no stops have focus
     *
     * @param stop     the ObaStop that obtained focus, or null if no stop is in focus
     * @param routes   a HashMap of all route display names that serve this stop - key is routeId
     * @param location the user touch location on the map, or null if the focus was otherwise
     *                 cleared programmatically
     */
    @Override
    public void onFocusChanged(ObaStop stop, HashMap&lt;String, ObaRoute&gt; routes, Location location) {
<span class="nc bnc" id="L1426" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4138)) {</span>
            // Check to see if we're already focused on this same stop - if so, we shouldn't do anything
<span class="nc bnc" id="L1428" title="All 26 branches missed.">            if ((ListenerUtil.mutListener.listen(4137) ? ((ListenerUtil.mutListener.listen(4136) ? (mFocusedStopId != null || stop != null) : (mFocusedStopId != null &amp;&amp; stop != null)) || mFocusedStopId.equalsIgnoreCase(stop.getId())) : ((ListenerUtil.mutListener.listen(4136) ? (mFocusedStopId != null || stop != null) : (mFocusedStopId != null &amp;&amp; stop != null)) &amp;&amp; mFocusedStopId.equalsIgnoreCase(stop.getId())))) {</span>
<span class="nc" id="L1429">                return;</span>
            }
        }
<span class="nc" id="L1432">        FragmentManager fm = getSupportFragmentManager();</span>
<span class="nc bnc" id="L1433" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4139)) {</span>
            // If the fragment's state has already been saved, then don't change the state (return)
<span class="nc bnc" id="L1435" title="All 2 branches missed.">            if (fm.isStateSaved()) {</span>
<span class="nc" id="L1436">                return;</span>
            }
        }
<span class="nc bnc" id="L1439" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4140)) {</span>
<span class="nc" id="L1440">            mFocusedStop = stop;</span>
        }
<span class="nc bnc" id="L1442" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4151)) {</span>
<span class="nc bnc" id="L1443" title="All 2 branches missed.">            if (stop != null) {</span>
<span class="nc bnc" id="L1444" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4147)) {</span>
<span class="nc" id="L1445">                    mBikeRentalStationId = null;</span>
                }
<span class="nc bnc" id="L1447" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4148)) {</span>
<span class="nc" id="L1448">                    mFocusedStopId = stop.getId();</span>
                }
<span class="nc bnc" id="L1450" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4149)) {</span>
                    // A stop on the map was just tapped, show it in the sliding panel
<span class="nc" id="L1452">                    updateArrivalListFragment(stop.getId(), stop.getName(), stop.getStopCode(), stop, routes);</span>
                }
<span class="nc bnc" id="L1454" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4150)) {</span>
<span class="nc" id="L1455">                    ObaAnalytics.reportUiEvent(mFirebaseAnalytics, getString(R.string.analytics_label_button_press_map_icon), null);</span>
                }
            } else {
<span class="nc bnc" id="L1458" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4141)) {</span>
                    // and clear the currently focused stopId
<span class="nc" id="L1460">                    mFocusedStopId = null;</span>
                }
<span class="nc bnc" id="L1462" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4142)) {</span>
<span class="nc" id="L1463">                    moveFabsLocation();</span>
                }
<span class="nc bnc" id="L1465" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4143)) {</span>
<span class="nc" id="L1466">                    mSlidingPanel.setPanelState(SlidingUpPanelLayout.PanelState.HIDDEN);</span>
                }
<span class="nc bnc" id="L1468" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4145)) {</span>
<span class="nc bnc" id="L1469" title="All 2 branches missed.">                    if (mArrivalsListFragment != null) {</span>
<span class="nc bnc" id="L1470" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4144)) {</span>
<span class="nc" id="L1471">                            fm.beginTransaction().remove(mArrivalsListFragment).commit();</span>
                        }
                    }
                }
<span class="nc bnc" id="L1475" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4146)) {</span>
<span class="nc" id="L1476">                    mShowArrivalsMenu = false;</span>
                }
            }
        }
<span class="nc" id="L1480">    }</span>

    /**
     * Called from the BaseMapFragment when a BikeRentalStation is clicked.
     *
     * @param bikeRentalStation the bike rental station that was clicked.
     */
    @Override
    public void onFocusChanged(BikeRentalStation bikeRentalStation) {
<span class="nc bnc" id="L1489" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4152)) {</span>
<span class="nc" id="L1490">            Log.d(TAG, &quot;Bike Station Clicked on map&quot;);</span>
        }
<span class="nc bnc" id="L1492" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4155)) {</span>
            // Check to see if we're already focused on this same bike rental station - if so, we shouldn't do anything
<span class="nc bnc" id="L1494" title="All 26 branches missed.">            if ((ListenerUtil.mutListener.listen(4154) ? ((ListenerUtil.mutListener.listen(4153) ? (mBikeRentalStationId != null || bikeRentalStation != null) : (mBikeRentalStationId != null &amp;&amp; bikeRentalStation != null)) || mBikeRentalStationId.equalsIgnoreCase(bikeRentalStation.id)) : ((ListenerUtil.mutListener.listen(4153) ? (mBikeRentalStationId != null || bikeRentalStation != null) : (mBikeRentalStationId != null &amp;&amp; bikeRentalStation != null)) &amp;&amp; mBikeRentalStationId.equalsIgnoreCase(bikeRentalStation.id)))) {</span>
<span class="nc" id="L1495">                return;</span>
            }
        }
<span class="nc bnc" id="L1498" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4158)) {</span>
<span class="nc bnc" id="L1499" title="All 2 branches missed.">            if (bikeRentalStation == null) {</span>
<span class="nc bnc" id="L1500" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4157)) {</span>
<span class="nc" id="L1501">                    mBikeRentalStationId = null;</span>
                }
            } else {
<span class="nc bnc" id="L1504" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4156)) {</span>
<span class="nc" id="L1505">                    mBikeRentalStationId = bikeRentalStation.id;</span>
                }
            }
        }
<span class="nc" id="L1509">    }</span>

    @Override
    public void onProgressBarChanged(boolean showProgressBar) {
<span class="nc bnc" id="L1513" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4159)) {</span>
<span class="nc" id="L1514">            mLastMapProgressBarState = showProgressBar;</span>
        }
<span class="nc bnc" id="L1516" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4162)) {</span>
<span class="nc bnc" id="L1517" title="All 2 branches missed.">            if (showProgressBar) {</span>
<span class="nc bnc" id="L1518" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4161)) {</span>
<span class="nc" id="L1519">                    showMapProgressBar();</span>
                }
            } else {
<span class="nc bnc" id="L1522" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4160)) {</span>
<span class="nc" id="L1523">                    hideMapProgressBar();</span>
                }
            }
        }
<span class="nc" id="L1527">    }</span>

    /**
     * Called by the ArrivalsListFragment when the ListView is created
     *
     * @param listView the ListView that was just created
     */
    @Override
    public void onListViewCreated(ListView listView) {
<span class="nc bnc" id="L1536" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4163)) {</span>
            // Set the scrollable view in the sliding panel
<span class="nc" id="L1538">            mSlidingPanel.setScrollableView(listView);</span>
        }
<span class="nc" id="L1540">    }</span>

    /**
     * Called by the ArrivalsListFragment when we have new updated arrival information
     *
     * @param response new arrival information
     */
    @Override
    public void onArrivalTimesUpdated(ObaArrivalInfoResponse response) {
<span class="nc bnc" id="L1549" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4165)) {</span>
<span class="nc bnc" id="L1550" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(4164) ? (response == null &amp;&amp; response.getStop() == null) : (response == null || response.getStop() == null))) {</span>
<span class="nc" id="L1551">                return;</span>
            }
        }
<span class="nc bnc" id="L1554" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4167)) {</span>
            // If we're missing any local references (e.g., if orientation just changed), store the values
<span class="nc bnc" id="L1556" title="All 2 branches missed.">            if (mFocusedStopId == null) {</span>
<span class="nc bnc" id="L1557" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4166)) {</span>
<span class="nc" id="L1558">                    mFocusedStopId = response.getStop().getId();</span>
                }
            }
        }
<span class="nc bnc" id="L1562" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4174)) {</span>
<span class="nc bnc" id="L1563" title="All 2 branches missed.">            if (mFocusedStop == null) {</span>
<span class="nc bnc" id="L1564" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4168)) {</span>
<span class="nc" id="L1565">                    mFocusedStop = response.getStop();</span>
                }
<span class="nc bnc" id="L1567" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4171)) {</span>
                    // Since mFocusedStop was null, the layout changed, and we should recenter map on stop
<span class="nc bnc" id="L1569" title="All 10 branches missed.">                    if ((ListenerUtil.mutListener.listen(4169) ? (mMapFragment != null || mSlidingPanel != null) : (mMapFragment != null &amp;&amp; mSlidingPanel != null))) {</span>
<span class="nc bnc" id="L1570" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4170)) {</span>
<span class="nc bnc" id="L1571" title="All 2 branches missed.">                            mMapFragment.setMapCenter(mFocusedStop.getLocation(), false, mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.ANCHORED);</span>
                        }
                    }
                }
<span class="nc bnc" id="L1575" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4173)) {</span>
                    // ...and we should add a focus marker for this stop
<span class="nc bnc" id="L1577" title="All 2 branches missed.">                    if (mMapFragment != null) {</span>
<span class="nc bnc" id="L1578" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4172)) {</span>
<span class="nc" id="L1579">                            mMapFragment.setFocusStop(mFocusedStop, response.getRoutes());</span>
                        }
                    }
                }
            }
        }
<span class="nc bnc" id="L1585" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4175)) {</span>
            // Header might have changed height, so make sure my location button is set above the header
<span class="nc" id="L1587">            moveFabsLocation();</span>
        }
<span class="nc bnc" id="L1589" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4176)) {</span>
            // Show arrival info related tutorials
<span class="nc" id="L1591">            showArrivalInfoTutorials(response);</span>
        }
<span class="nc" id="L1593">    }</span>

    /**
     * Triggers the various tutorials related to arrival info and the sliding panel header
     *
     * @param response arrival info, which is required for some tutorials
     */
    private void showArrivalInfoTutorials(ObaArrivalInfoResponse response) {
<span class="nc bnc" id="L1601" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4177)) {</span>
            // If we're already showing a ShowcaseView, we don't want to stack another on top
<span class="nc bnc" id="L1603" title="All 2 branches missed.">            if (ShowcaseViewUtils.isShowcaseViewShowing()) {</span>
<span class="nc" id="L1604">                return;</span>
            }
        }
<span class="nc bnc" id="L1607" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4180)) {</span>
            // If we can't see the map or sliding panel, we can't see the arrival info, so return
<span class="nc bnc" id="L1609" title="All 26 branches missed.">            if ((ListenerUtil.mutListener.listen(4179) ? ((ListenerUtil.mutListener.listen(4178) ? (mMapFragment.isHidden() &amp;&amp; !mMapFragment.isVisible()) : (mMapFragment.isHidden() || !mMapFragment.isVisible())) &amp;&amp; mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.HIDDEN) : ((ListenerUtil.mutListener.listen(4178) ? (mMapFragment.isHidden() &amp;&amp; !mMapFragment.isVisible()) : (mMapFragment.isHidden() || !mMapFragment.isVisible())) || mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.HIDDEN))) {</span>
<span class="nc" id="L1610">                return;</span>
            }
        }
<span class="nc bnc" id="L1613" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4181)) {</span>
            // Show the tutorial explaining arrival times
<span class="nc" id="L1615">            ShowcaseViewUtils.showTutorial(ShowcaseViewUtils.TUTORIAL_ARRIVAL_HEADER_ARRIVAL_INFO, this, response, false);</span>
        }
<span class="nc bnc" id="L1617" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4186)) {</span>
            // Make sure the panel is stationary before showing the starred routes tutorial
<span class="nc bnc" id="L1619" title="All 58 branches missed.">            if ((ListenerUtil.mutListener.listen(4184) ? (mSlidingPanel != null || ((ListenerUtil.mutListener.listen(4183) ? ((ListenerUtil.mutListener.listen(4182) ? (isSlidingPanelCollapsed() &amp;&amp; mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.ANCHORED) : (isSlidingPanelCollapsed() || mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.ANCHORED)) &amp;&amp; mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.EXPANDED) : ((ListenerUtil.mutListener.listen(4182) ? (isSlidingPanelCollapsed() &amp;&amp; mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.ANCHORED) : (isSlidingPanelCollapsed() || mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.ANCHORED)) || mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.EXPANDED)))) : (mSlidingPanel != null &amp;&amp; ((ListenerUtil.mutListener.listen(4183) ? ((ListenerUtil.mutListener.listen(4182) ? (isSlidingPanelCollapsed() &amp;&amp; mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.ANCHORED) : (isSlidingPanelCollapsed() || mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.ANCHORED)) &amp;&amp; mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.EXPANDED) : ((ListenerUtil.mutListener.listen(4182) ? (isSlidingPanelCollapsed() &amp;&amp; mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.ANCHORED) : (isSlidingPanelCollapsed() || mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.ANCHORED)) || mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.EXPANDED)))))) {</span>
<span class="nc bnc" id="L1620" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4185)) {</span>
<span class="nc" id="L1621">                    ShowcaseViewUtils.showTutorial(ShowcaseViewUtils.TUTORIAL_ARRIVAL_HEADER_STAR_ROUTE, this, response, false);</span>
                }
            }
        }
<span class="nc bnc" id="L1625" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4187)) {</span>
<span class="nc" id="L1626">            ShowcaseViewUtils.showTutorial(ShowcaseViewUtils.TUTORIAL_RECENT_STOPS_ROUTES, this, null, false);</span>
        }
<span class="nc" id="L1628">    }</span>

    /**
     * Called by the ArrivalListFragment when the user selects the &quot;Show route on map&quot; for a
     * particular route/trip
     *
     * @param arrivalInfo The arrival information for the route/trip that the user selected
     * @return true if the listener has consumed the event, false otherwise
     */
    @Override
    public boolean onShowRouteOnMapSelected(ArrivalInfo arrivalInfo) {
<span class="nc bnc" id="L1639" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4189)) {</span>
            // If the panel is fully expanded, change it to anchored so the user can see the map
<span class="nc bnc" id="L1641" title="All 2 branches missed.">            if (mSlidingPanel != null) {</span>
<span class="nc bnc" id="L1642" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4188)) {</span>
<span class="nc" id="L1643">                    mSlidingPanel.setPanelState(SlidingUpPanelLayout.PanelState.COLLAPSED);</span>
                }
            }
        }
<span class="nc" id="L1647">        Bundle bundle = new Bundle();</span>
<span class="nc bnc" id="L1648" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4190)) {</span>
<span class="nc" id="L1649">            bundle.putBoolean(MapParams.ZOOM_TO_ROUTE, false);</span>
        }
<span class="nc bnc" id="L1651" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4191)) {</span>
<span class="nc" id="L1652">            bundle.putBoolean(MapParams.ZOOM_INCLUDE_CLOSEST_VEHICLE, true);</span>
        }
<span class="nc bnc" id="L1654" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4192)) {</span>
<span class="nc" id="L1655">            bundle.putString(MapParams.ROUTE_ID, arrivalInfo.getInfo().getRouteId());</span>
        }
<span class="nc bnc" id="L1657" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4193)) {</span>
<span class="nc" id="L1658">            mMapFragment.setMapMode(MapParams.MODE_ROUTE, bundle);</span>
        }
<span class="nc" id="L1660">        return true;</span>
    }

    /**
     * Called when the user selects the &quot;Sort by&quot; option in ArrivalsListFragment
     */
    @Override
    public void onSortBySelected() {
<span class="nc bnc" id="L1668" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4196)) {</span>
            // If the sliding panel isn't open, then open it to show what we're sorting
<span class="nc bnc" id="L1670" title="All 2 branches missed.">            if (mSlidingPanel != null) {</span>
<span class="nc bnc" id="L1671" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4195)) {</span>
<span class="nc bnc" id="L1672" title="All 2 branches missed.">                    if (isSlidingPanelCollapsed()) {</span>
<span class="nc bnc" id="L1673" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4194)) {</span>
<span class="nc" id="L1674">                            mSlidingPanel.setPanelState(SlidingUpPanelLayout.PanelState.ANCHORED);</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L1680">    }</span>

    @Override
    public void onBackPressed() {
<span class="nc bnc" id="L1684" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4202)) {</span>
            // Collapse the panel when the user presses the back button
<span class="nc bnc" id="L1686" title="All 2 branches missed.">            if (mSlidingPanel != null) {</span>
<span class="nc bnc" id="L1687" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4199)) {</span>
                    // Collapse the sliding panel if its anchored or expanded
<span class="nc bnc" id="L1689" title="All 10 branches missed.">                    if ((ListenerUtil.mutListener.listen(4197) ? (mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.EXPANDED &amp;&amp; mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.ANCHORED) : (mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.EXPANDED || mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.ANCHORED))) {</span>
<span class="nc bnc" id="L1690" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4198)) {</span>
<span class="nc" id="L1691">                            mSlidingPanel.setPanelState(SlidingUpPanelLayout.PanelState.COLLAPSED);</span>
                        }
<span class="nc" id="L1693">                        return;</span>
                    }
                }
<span class="nc bnc" id="L1696" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4201)) {</span>
                    // Clear focused stop and close the sliding panel if its collapsed
<span class="nc bnc" id="L1698" title="All 2 branches missed.">                    if (mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.COLLAPSED) {</span>
<span class="nc bnc" id="L1699" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4200)) {</span>
                            // panel via BaseMapFragment.OnFocusChangedListener in this.onFocusChanged()
<span class="nc" id="L1701">                            mMapFragment.setFocusStop(null, null);</span>
                        }
<span class="nc" id="L1703">                        return;</span>
                    }
                }
            }
        }
<span class="nc bnc" id="L1708" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4203)) {</span>
<span class="nc" id="L1709">            super.onBackPressed();</span>
        }
<span class="nc" id="L1711">    }</span>

    /**
     * Redraw navigation drawer. This is necessary because we do not know whether to draw the
     * &quot;Plan A Trip&quot; option until a region is selected.
     */
    private void redrawNavigationDrawerFragment() {
<span class="nc bnc" id="L1718" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4205)) {</span>
<span class="nc bnc" id="L1719" title="All 2 branches missed.">            if (mNavigationDrawerFragment != null) {</span>
<span class="nc bnc" id="L1720" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4204)) {</span>
<span class="nc" id="L1721">                    mNavigationDrawerFragment.populateNavDrawer();</span>
                }
            }
        }
<span class="nc" id="L1725">    }</span>

    /**
     * Create a new fragment to show the arrivals list for the given stop.  An ObaStop object
     * should
     * be passed in if available.  In all cases a stopId, stopName, and stopCode must be provided.
     *
     * @param stopId   Stop ID of the stop to show arrivals for
     * @param stopName Stop name of the stop to show arrivals for
     * @param stopCode Stop Code (rider-facing ID) of the stop to show arrivals for
     * @param stop     The ObaStop object for the stop to show arrivals for, or null if we don't
     *                 have
     *                 this yet.
     * @param routes   A HashMap of all route display names that serve this stop - key is routeId,
     *                 or
     *                 null if we don't have this yet.
     */
    private void updateArrivalListFragment(@NonNull String stopId, @NonNull String stopName, @NonNull String stopCode, ObaStop stop, HashMap&lt;String, ObaRoute&gt; routes) {
<span class="nc" id="L1743">        FragmentManager fm = getSupportFragmentManager();</span>
        Intent intent;
<span class="nc bnc" id="L1745" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4206)) {</span>
<span class="nc" id="L1746">            mArrivalsListFragment = new ArrivalsListFragment();</span>
        }
<span class="nc bnc" id="L1748" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4207)) {</span>
<span class="nc" id="L1749">            mArrivalsListFragment.setListener(this);</span>
        }
<span class="nc bnc" id="L1751" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4208)) {</span>
            // Set the header for the arrival list to be the top of the sliding panel
<span class="nc" id="L1753">            mArrivalsListHeader = new ArrivalsListHeader(this, mArrivalsListFragment, getSupportFragmentManager());</span>
        }
<span class="nc bnc" id="L1755" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4209)) {</span>
<span class="nc" id="L1756">            mArrivalsListFragment.setHeader(mArrivalsListHeader, mArrivalsListHeaderView);</span>
        }
<span class="nc bnc" id="L1758" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4210)) {</span>
<span class="nc" id="L1759">            mArrivalsListHeader.setSlidingPanelController(mSlidingPanelController);</span>
        }
<span class="nc bnc" id="L1761" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4211)) {</span>
<span class="nc" id="L1762">            mArrivalsListHeader.setSlidingPanelCollapsed(isSlidingPanelCollapsed());</span>
        }
<span class="nc bnc" id="L1764" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4212)) {</span>
<span class="nc" id="L1765">            mShowArrivalsMenu = true;</span>
        }
<span class="nc bnc" id="L1767" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4213)) {</span>
<span class="nc" id="L1768">            mExpandCollapse = mArrivalsListHeaderView.findViewById(R.id.expand_collapse);</span>
        }
<span class="nc bnc" id="L1770" title="All 10 branches missed.">        if ((ListenerUtil.mutListener.listen(4214) ? (stop != null || routes != null) : (stop != null &amp;&amp; routes != null))) {</span>
            // before getting an API response
<span class="nc" id="L1772">            intent = new ArrivalsListFragment.IntentBuilder(this, stop, routes).build();</span>
        } else {
            // Some fields will be blank until we get an API response
<span class="nc" id="L1775">            intent = new ArrivalsListFragment.IntentBuilder(this, stopId).setStopName(stopName).setStopCode(stopCode).build();</span>
        }
<span class="nc bnc" id="L1777" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4215)) {</span>
<span class="nc" id="L1778">            mArrivalsListFragment.setArguments(FragmentUtils.getIntentArgs(intent));</span>
        }
<span class="nc bnc" id="L1780" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4216)) {</span>
<span class="nc" id="L1781">            fm.beginTransaction().replace(R.id.slidingFragment, mArrivalsListFragment).commit();</span>
        }
<span class="nc bnc" id="L1783" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4217)) {</span>
<span class="nc" id="L1784">            showSlidingPanel();</span>
        }
<span class="nc bnc" id="L1786" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4218)) {</span>
<span class="nc" id="L1787">            moveFabsLocation();</span>
        }
<span class="nc" id="L1789">    }</span>

    private void showSlidingPanel() {
<span class="nc bnc" id="L1792" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4220)) {</span>
<span class="nc bnc" id="L1793" title="All 2 branches missed.">            if (mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.HIDDEN) {</span>
<span class="nc bnc" id="L1794" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4219)) {</span>
<span class="nc" id="L1795">                    mSlidingPanel.setPanelState(SlidingUpPanelLayout.PanelState.COLLAPSED);</span>
                }
            }
        }
<span class="nc" id="L1799">    }</span>

    private void goToSendFeedBack() {
<span class="nc bnc" id="L1802" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4225)) {</span>
<span class="nc bnc" id="L1803" title="All 2 branches missed.">            if (mFocusedStop != null) {</span>
<span class="nc bnc" id="L1804" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4224)) {</span>
<span class="nc" id="L1805">                    ReportActivity.start(this, mFocusedStopId, mFocusedStop.getName(), mFocusedStop.getStopCode(), mFocusedStop.getLatitude(), mFocusedStop.getLongitude(), mGoogleApiClient);</span>
                }
            } else {
<span class="nc" id="L1808">                Location loc = Application.getLastKnownLocation(this, mGoogleApiClient);</span>
<span class="nc bnc" id="L1809" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4223)) {</span>
<span class="nc bnc" id="L1810" title="All 2 branches missed.">                    if (loc != null) {</span>
<span class="nc bnc" id="L1811" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4222)) {</span>
<span class="nc" id="L1812">                            ReportActivity.start(this, loc.getLatitude(), loc.getLongitude(), mGoogleApiClient);</span>
                        }
                    } else {
<span class="nc bnc" id="L1815" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4221)) {</span>
<span class="nc" id="L1816">                            ReportActivity.start(this, mGoogleApiClient);</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L1822">    }</span>

    /**
     * Checks region status, which can potentially including forcing a reload of region
     * info from the server.  Also includes auto-selection of closest region.
     */
    private void checkRegionStatus() {
<span class="nc bnc" id="L1829" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4226)) {</span>
            // First check for custom API URL set by user via Preferences, since if that is set we don't need region info from the REST API
<span class="nc bnc" id="L1831" title="All 2 branches missed.">            if (!TextUtils.isEmpty(Application.get().getCustomApiUrl())) {</span>
<span class="nc" id="L1832">                return;</span>
            }
        }
<span class="nc bnc" id="L1835" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4230)) {</span>
            // Check if region is hard-coded for this build flavor
            if (BuildConfig.USE_FIXED_REGION) {
                ObaRegion r = RegionUtils.getRegionFromBuildFlavor();
                if (!ListenerUtil.mutListener.listen(4227)) {
                    // Set the hard-coded region
                    RegionUtils.saveToProvider(this, Collections.singletonList(r));
                }
                if (!ListenerUtil.mutListener.listen(4228)) {
                    Application.get().setCurrentRegion(r);
                }
                if (!ListenerUtil.mutListener.listen(4229)) {
                    // Disable any region auto-selection in preferences
                    PreferenceUtils.saveBoolean(getString(R.string.preference_key_auto_select_region), false);
                }
                return;
            }
        }
<span class="nc" id="L1853">        boolean forceReload = false;</span>
<span class="nc" id="L1854">        boolean showProgressDialog = true;</span>
<span class="nc bnc" id="L1855" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4243)) {</span>
            // force contacting the server again
<span class="nc bnc" id="L1857" title="All 146 branches missed.">            if ((ListenerUtil.mutListener.listen(4240) ? (Application.get().getCurrentRegion() == null &amp;&amp; (ListenerUtil.mutListener.listen(4239) ? ((ListenerUtil.mutListener.listen(4234) ? (new Date().getTime() % Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4233) ? (new Date().getTime() / Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4232) ? (new Date().getTime() * Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4231) ? (new Date().getTime() + Application.get().getLastRegionUpdateDate()) : (new Date().getTime() - Application.get().getLastRegionUpdateDate()))))) &gt;= REGION_UPDATE_THRESHOLD) : (ListenerUtil.mutListener.listen(4238) ? ((ListenerUtil.mutListener.listen(4234) ? (new Date().getTime() % Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4233) ? (new Date().getTime() / Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4232) ? (new Date().getTime() * Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4231) ? (new Date().getTime() + Application.get().getLastRegionUpdateDate()) : (new Date().getTime() - Application.get().getLastRegionUpdateDate()))))) &lt;= REGION_UPDATE_THRESHOLD) : (ListenerUtil.mutListener.listen(4237) ? ((ListenerUtil.mutListener.listen(4234) ? (new Date().getTime() % Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4233) ? (new Date().getTime() / Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4232) ? (new Date().getTime() * Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4231) ? (new Date().getTime() + Application.get().getLastRegionUpdateDate()) : (new Date().getTime() - Application.get().getLastRegionUpdateDate()))))) &lt; REGION_UPDATE_THRESHOLD) : (ListenerUtil.mutListener.listen(4236) ? ((ListenerUtil.mutListener.listen(4234) ? (new Date().getTime() % Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4233) ? (new Date().getTime() / Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4232) ? (new Date().getTime() * Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4231) ? (new Date().getTime() + Application.get().getLastRegionUpdateDate()) : (new Date().getTime() - Application.get().getLastRegionUpdateDate()))))) != REGION_UPDATE_THRESHOLD) : (ListenerUtil.mutListener.listen(4235) ? ((ListenerUtil.mutListener.listen(4234) ? (new Date().getTime() % Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4233) ? (new Date().getTime() / Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4232) ? (new Date().getTime() * Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4231) ? (new Date().getTime() + Application.get().getLastRegionUpdateDate()) : (new Date().getTime() - Application.get().getLastRegionUpdateDate()))))) == REGION_UPDATE_THRESHOLD) : ((ListenerUtil.mutListener.listen(4234) ? (new Date().getTime() % Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4233) ? (new Date().getTime() / Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4232) ? (new Date().getTime() * Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4231) ? (new Date().getTime() + Application.get().getLastRegionUpdateDate()) : (new Date().getTime() - Application.get().getLastRegionUpdateDate()))))) &gt; REGION_UPDATE_THRESHOLD))))))) : (Application.get().getCurrentRegion() == null || (ListenerUtil.mutListener.listen(4239) ? ((ListenerUtil.mutListener.listen(4234) ? (new Date().getTime() % Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4233) ? (new Date().getTime() / Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4232) ? (new Date().getTime() * Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4231) ? (new Date().getTime() + Application.get().getLastRegionUpdateDate()) : (new Date().getTime() - Application.get().getLastRegionUpdateDate()))))) &gt;= REGION_UPDATE_THRESHOLD) : (ListenerUtil.mutListener.listen(4238) ? ((ListenerUtil.mutListener.listen(4234) ? (new Date().getTime() % Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4233) ? (new Date().getTime() / Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4232) ? (new Date().getTime() * Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4231) ? (new Date().getTime() + Application.get().getLastRegionUpdateDate()) : (new Date().getTime() - Application.get().getLastRegionUpdateDate()))))) &lt;= REGION_UPDATE_THRESHOLD) : (ListenerUtil.mutListener.listen(4237) ? ((ListenerUtil.mutListener.listen(4234) ? (new Date().getTime() % Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4233) ? (new Date().getTime() / Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4232) ? (new Date().getTime() * Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4231) ? (new Date().getTime() + Application.get().getLastRegionUpdateDate()) : (new Date().getTime() - Application.get().getLastRegionUpdateDate()))))) &lt; REGION_UPDATE_THRESHOLD) : (ListenerUtil.mutListener.listen(4236) ? ((ListenerUtil.mutListener.listen(4234) ? (new Date().getTime() % Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4233) ? (new Date().getTime() / Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4232) ? (new Date().getTime() * Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4231) ? (new Date().getTime() + Application.get().getLastRegionUpdateDate()) : (new Date().getTime() - Application.get().getLastRegionUpdateDate()))))) != REGION_UPDATE_THRESHOLD) : (ListenerUtil.mutListener.listen(4235) ? ((ListenerUtil.mutListener.listen(4234) ? (new Date().getTime() % Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4233) ? (new Date().getTime() / Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4232) ? (new Date().getTime() * Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4231) ? (new Date().getTime() + Application.get().getLastRegionUpdateDate()) : (new Date().getTime() - Application.get().getLastRegionUpdateDate()))))) == REGION_UPDATE_THRESHOLD) : ((ListenerUtil.mutListener.listen(4234) ? (new Date().getTime() % Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4233) ? (new Date().getTime() / Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4232) ? (new Date().getTime() * Application.get().getLastRegionUpdateDate()) : (ListenerUtil.mutListener.listen(4231) ? (new Date().getTime() + Application.get().getLastRegionUpdateDate()) : (new Date().getTime() - Application.get().getLastRegionUpdateDate()))))) &gt; REGION_UPDATE_THRESHOLD))))))))) {</span>
<span class="nc bnc" id="L1858" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4241)) {</span>
<span class="nc" id="L1859">                    forceReload = true;</span>
                }
<span class="nc bnc" id="L1861" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4242)) {</span>
<span class="nc" id="L1862">                    Log.d(TAG, &quot;Region info has expired (or does not exist), forcing a reload from the server...&quot;);</span>
                }
            }
        }
<span class="nc bnc" id="L1866" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4245)) {</span>
<span class="nc bnc" id="L1867" title="All 2 branches missed.">            if (Application.get().getCurrentRegion() != null) {</span>
<span class="nc bnc" id="L1868" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4244)) {</span>
                    // We already have region info locally, so just check current region status quietly in the background
<span class="nc" id="L1870">                    showProgressDialog = false;</span>
                }
            }
        }
        try {
<span class="nc" id="L1875">            PackageInfo appInfo = getPackageManager().getPackageInfo(getPackageName(), PackageManager.GET_META_DATA);</span>
<span class="nc" id="L1876">            SharedPreferences settings = Application.getPrefs();</span>
<span class="nc" id="L1877">            final int oldVer = settings.getInt(CHECK_REGION_VER, 0);</span>
<span class="nc" id="L1878">            final int newVer = appInfo.versionCode;</span>
<span class="nc bnc" id="L1879" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(4252)) {</span>
<span class="nc bnc" id="L1880" title="All 22 branches missed.">                if ((ListenerUtil.mutListener.listen(4250) ? (oldVer &gt;= newVer) : (ListenerUtil.mutListener.listen(4249) ? (oldVer &lt;= newVer) : (ListenerUtil.mutListener.listen(4248) ? (oldVer &gt; newVer) : (ListenerUtil.mutListener.listen(4247) ? (oldVer != newVer) : (ListenerUtil.mutListener.listen(4246) ? (oldVer == newVer) : (oldVer &lt; newVer))))))) {</span>
<span class="nc bnc" id="L1881" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4251)) {</span>
<span class="nc" id="L1882">                        forceReload = true;</span>
                    }
                }
            }
<span class="nc bnc" id="L1886" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(4253)) {</span>
<span class="nc" id="L1887">                PreferenceUtils.saveInt(CHECK_REGION_VER, appInfo.versionCode);</span>
            }
<span class="nc" id="L1889">        } catch (NameNotFoundException e) {</span>
<span class="nc" id="L1890">        }</span>
        // Check region status, possibly forcing a reload from server and checking proximity to current region
<span class="nc" id="L1892">        List&lt;ObaRegionsTask.Callback&gt; callbacks = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L1893" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4254)) {</span>
<span class="nc" id="L1894">            callbacks.add(mMapFragment);</span>
        }
<span class="nc bnc" id="L1896" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4255)) {</span>
<span class="nc" id="L1897">            callbacks.add(this);</span>
        }
<span class="nc" id="L1899">        ObaRegionsTask task = new ObaRegionsTask(this, callbacks, forceReload, showProgressDialog);</span>
<span class="nc bnc" id="L1900" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4256)) {</span>
<span class="nc" id="L1901">            task.execute();</span>
        }
<span class="nc" id="L1903">    }</span>

    // 
    @Override
    public void onRegionTaskFinished(boolean currentRegionChanged) {
        // Show &quot;What's New&quot; (which might need refreshed Regions API contents)
<span class="nc" id="L1909">        boolean update = autoShowWhatsNew();</span>
<span class="nc bnc" id="L1910" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4259)) {</span>
            // Redraw nav drawer if the region changed, or if we just installed a new version
<span class="nc bnc" id="L1912" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(4257) ? (currentRegionChanged &amp;&amp; update) : (currentRegionChanged || update))) {</span>
<span class="nc bnc" id="L1913" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4258)) {</span>
<span class="nc" id="L1914">                    redrawNavigationDrawerFragment();</span>
                }
            }
        }
<span class="nc bnc" id="L1918" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4264)) {</span>
            // If region changed and was auto-selected, show user what region we're using
<span class="nc bnc" id="L1920" title="All 58 branches missed.">            if ((ListenerUtil.mutListener.listen(4262) ? ((ListenerUtil.mutListener.listen(4261) ? ((ListenerUtil.mutListener.listen(4260) ? (currentRegionChanged || Application.getPrefs().getBoolean(getString(R.string.preference_key_auto_select_region), true)) : (currentRegionChanged &amp;&amp; Application.getPrefs().getBoolean(getString(R.string.preference_key_auto_select_region), true))) || Application.get().getCurrentRegion() != null) : ((ListenerUtil.mutListener.listen(4260) ? (currentRegionChanged || Application.getPrefs().getBoolean(getString(R.string.preference_key_auto_select_region), true)) : (currentRegionChanged &amp;&amp; Application.getPrefs().getBoolean(getString(R.string.preference_key_auto_select_region), true))) &amp;&amp; Application.get().getCurrentRegion() != null)) || UIUtils.canManageDialog(this)) : ((ListenerUtil.mutListener.listen(4261) ? ((ListenerUtil.mutListener.listen(4260) ? (currentRegionChanged || Application.getPrefs().getBoolean(getString(R.string.preference_key_auto_select_region), true)) : (currentRegionChanged &amp;&amp; Application.getPrefs().getBoolean(getString(R.string.preference_key_auto_select_region), true))) || Application.get().getCurrentRegion() != null) : ((ListenerUtil.mutListener.listen(4260) ? (currentRegionChanged || Application.getPrefs().getBoolean(getString(R.string.preference_key_auto_select_region), true)) : (currentRegionChanged &amp;&amp; Application.getPrefs().getBoolean(getString(R.string.preference_key_auto_select_region), true))) &amp;&amp; Application.get().getCurrentRegion() != null)) &amp;&amp; UIUtils.canManageDialog(this)))) {</span>
<span class="nc bnc" id="L1921" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4263)) {</span>
<span class="nc" id="L1922">                    Toast.makeText(getApplicationContext(), getString(R.string.region_region_found, Application.get().getCurrentRegion().getName()), Toast.LENGTH_LONG).show();</span>
                }
            }
        }
<span class="nc bnc" id="L1926" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4265)) {</span>
<span class="nc" id="L1927">            updateLayersFab();</span>
        }
<span class="nc" id="L1929">    }</span>

    private void setupZoomButtons() {
<span class="nc" id="L1932">        ImageButton mZoomInBtn = findViewById(R.id.btnZoomIn);</span>
<span class="nc" id="L1933">        ImageButton mZoomOutBtn = findViewById(R.id.btnZoomOut);</span>
<span class="nc bnc" id="L1934" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4266)) {</span>
<span class="nc" id="L1935">            mZoomInBtn.setOnClickListener(view -&gt; mMapFragment.zoomIn());</span>
        }
<span class="nc bnc" id="L1937" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4267)) {</span>
<span class="nc" id="L1938">            mZoomOutBtn.setOnClickListener(view -&gt; mMapFragment.zoomOut());</span>
        }
<span class="nc" id="L1940">    }</span>

    private void setupMyLocationButton() {
<span class="nc bnc" id="L1943" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4268)) {</span>
            // Initialize the My Location button
<span class="nc" id="L1945">            mFabMyLocation = findViewById(R.id.btnMyLocation);</span>
        }
<span class="nc bnc" id="L1947" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4269)) {</span>
<span class="nc" id="L1948">            mFabMyLocation.setOnClickListener(view -&gt; {</span>
<span class="nc bnc" id="L1949" title="All 2 branches missed.">                if (mMapFragment != null) {</span>
                    // Reset the preference to ask user to enable location
<span class="nc" id="L1951">                    PreferenceUtils.saveBoolean(getString(R.string.preference_key_never_show_location_dialog), false);</span>
<span class="nc" id="L1952">                    PreferenceUtils.setUserDeniedLocationPermissions(false);</span>
<span class="nc" id="L1953">                    mMapFragment.setMyLocation(true, true);</span>
<span class="nc" id="L1954">                    ObaAnalytics.reportUiEvent(mFirebaseAnalytics, getString(R.string.analytics_label_button_press_location), null);</span>
                }
<span class="nc" id="L1956">            });</span>
        }
<span class="nc" id="L1958">        ViewGroup.MarginLayoutParams p = (ViewGroup.MarginLayoutParams) mFabMyLocation.getLayoutParams();</span>
<span class="nc bnc" id="L1959" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4270)) {</span>
<span class="nc" id="L1960">            MY_LOC_DEFAULT_BOTTOM_MARGIN = p.bottomMargin;</span>
        }
<span class="nc bnc" id="L1962" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4271)) {</span>
<span class="nc" id="L1963">            checkLeftHandMode();</span>
        }
<span class="nc bnc" id="L1965" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4276)) {</span>
<span class="nc bnc" id="L1966" title="All 2 branches missed.">            if (mCurrentNavDrawerPosition == NAVDRAWER_ITEM_NEARBY) {</span>
<span class="nc bnc" id="L1967" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4274)) {</span>
<span class="nc" id="L1968">                    showFloatingActionButtons();</span>
                }
<span class="nc bnc" id="L1970" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4275)) {</span>
<span class="nc" id="L1971">                    showMapProgressBar();</span>
                }
            } else {
<span class="nc bnc" id="L1974" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4272)) {</span>
<span class="nc" id="L1975">                    hideFloatingActionButtons();</span>
                }
<span class="nc bnc" id="L1977" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4273)) {</span>
<span class="nc" id="L1978">                    hideMapProgressBar();</span>
                }
            }
        }
<span class="nc" id="L1982">    }</span>

    private void checkDisplayZoomControls() {
<span class="nc" id="L1985">        boolean displayZoom = Application.getPrefs().getBoolean(getString(R.string.preference_key_show_zoom_controls), false);</span>
<span class="nc bnc" id="L1986" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4277)) {</span>
<span class="nc" id="L1987">            showZoomControls(displayZoom);</span>
        }
<span class="nc" id="L1989">    }</span>

    /**
     * Shows zoom controls if state is true, hides the zoom controls if state is false
     * @param showZoom true if the zoom controls should be visible, false if they should be hidden
     */
    private void showZoomControls(boolean showZoom) {
<span class="nc" id="L1996">        LinearLayout zoomLayout = findViewById(R.id.zoom_buttons_layout);</span>
<span class="nc bnc" id="L1997" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4281)) {</span>
<span class="nc bnc" id="L1998" title="All 2 branches missed.">            if (zoomLayout != null) {</span>
<span class="nc bnc" id="L1999" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4280)) {</span>
<span class="nc bnc" id="L2000" title="All 2 branches missed.">                    if (showZoom) {</span>
<span class="nc bnc" id="L2001" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4279)) {</span>
<span class="nc" id="L2002">                            zoomLayout.setVisibility(LinearLayout.VISIBLE);</span>
                        }
                    } else {
<span class="nc bnc" id="L2005" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4278)) {</span>
<span class="nc" id="L2006">                            zoomLayout.setVisibility(LinearLayout.GONE);</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L2012">    }</span>

    private void checkLeftHandMode() {
<span class="nc" id="L2015">        boolean leftHandMode = Application.getPrefs().getBoolean(getString(R.string.preference_key_left_hand_mode), false);</span>
<span class="nc bnc" id="L2016" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4282)) {</span>
<span class="nc" id="L2017">            setFABLocation(leftHandMode);</span>
        }
<span class="nc" id="L2019">    }</span>

    private void setFABLocation(boolean leftHandMode) {
<span class="nc bnc" id="L2022" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4300)) {</span>
<span class="nc bnc" id="L2023" title="All 2 branches missed.">            if (mFabMyLocation != null) {</span>
<span class="nc" id="L2024">                RelativeLayout.LayoutParams layoutParams = (RelativeLayout.LayoutParams) mFabMyLocation.getLayoutParams();</span>
<span class="nc bnc" id="L2025" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4299)) {</span>
<span class="nc bnc" id="L2026" title="All 2 branches missed.">                    if (leftHandMode) {</span>
<span class="nc bnc" id="L2027" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4291)) {</span>
<span class="nc" id="L2028">                            layoutParams.addRule(RelativeLayout.ALIGN_PARENT_LEFT);</span>
                        }
<span class="nc bnc" id="L2030" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4298)) {</span>
<span class="nc bnc" id="L2031" title="All 22 branches missed.">                            if ((ListenerUtil.mutListener.listen(4296) ? (Build.VERSION.SDK_INT &lt;= Build.VERSION_CODES.JELLY_BEAN_MR1) : (ListenerUtil.mutListener.listen(4295) ? (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.JELLY_BEAN_MR1) : (ListenerUtil.mutListener.listen(4294) ? (Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.JELLY_BEAN_MR1) : (ListenerUtil.mutListener.listen(4293) ? (Build.VERSION.SDK_INT != Build.VERSION_CODES.JELLY_BEAN_MR1) : (ListenerUtil.mutListener.listen(4292) ? (Build.VERSION.SDK_INT == Build.VERSION_CODES.JELLY_BEAN_MR1) : (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.JELLY_BEAN_MR1))))))) {</span>
<span class="nc bnc" id="L2032" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(4297)) {</span>
<span class="nc" id="L2033">                                    layoutParams.removeRule(RelativeLayout.ALIGN_PARENT_RIGHT);</span>
                                }
                            }
                        }
                    } else {
<span class="nc bnc" id="L2038" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4283)) {</span>
<span class="nc" id="L2039">                            layoutParams.addRule(RelativeLayout.ALIGN_PARENT_RIGHT);</span>
                        }
<span class="nc bnc" id="L2041" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4290)) {</span>
<span class="nc bnc" id="L2042" title="All 22 branches missed.">                            if ((ListenerUtil.mutListener.listen(4288) ? (Build.VERSION.SDK_INT &lt;= Build.VERSION_CODES.JELLY_BEAN_MR1) : (ListenerUtil.mutListener.listen(4287) ? (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.JELLY_BEAN_MR1) : (ListenerUtil.mutListener.listen(4286) ? (Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.JELLY_BEAN_MR1) : (ListenerUtil.mutListener.listen(4285) ? (Build.VERSION.SDK_INT != Build.VERSION_CODES.JELLY_BEAN_MR1) : (ListenerUtil.mutListener.listen(4284) ? (Build.VERSION.SDK_INT == Build.VERSION_CODES.JELLY_BEAN_MR1) : (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.JELLY_BEAN_MR1))))))) {</span>
<span class="nc bnc" id="L2043" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(4289)) {</span>
<span class="nc" id="L2044">                                    layoutParams.removeRule(RelativeLayout.ALIGN_PARENT_LEFT);</span>
                                }
                            }
                        }
                    }
                }
            }
        }
<span class="nc bnc" id="L2052" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4304)) {</span>
<span class="nc bnc" id="L2053" title="All 2 branches missed.">            if (mLayersFab != null) {</span>
<span class="nc bnc" id="L2054" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4303)) {</span>
<span class="nc bnc" id="L2055" title="All 2 branches missed.">                    if (leftHandMode) {</span>
<span class="nc bnc" id="L2056" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4302)) {</span>
<span class="nc" id="L2057">                            mLayersFab.setButtonPosition(POSITION_BOTTOM | POSITION_START);</span>
                        }
                    } else {
<span class="nc bnc" id="L2060" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4301)) {</span>
<span class="nc" id="L2061">                            mLayersFab.setButtonPosition(POSITION_BOTTOM | POSITION_END);</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L2067">    }</span>

    /**
     * Moves both Floating Action Buttons as response to sliding panel height changes.
     * &lt;p&gt;
     * Currently there are two FAB that can be moved, the My location button and the Layers button.
     */
    private synchronized void moveFabsLocation() {
<span class="nc bnc" id="L2075" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4305)) {</span>
<span class="nc" id="L2076">            moveFabLocation(mFabMyLocation, MY_LOC_DEFAULT_BOTTOM_MARGIN);</span>
        }
<span class="nc bnc" id="L2078" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4306)) {</span>
<span class="nc" id="L2079">            moveFabLocation(mLayersFab, LAYERS_FAB_DEFAULT_BOTTOM_MARGIN);</span>
        }
<span class="nc" id="L2081">    }</span>

    private void moveFabLocation(final View fab, final int initialMargin) {
<span class="nc bnc" id="L2084" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4307)) {</span>
<span class="nc bnc" id="L2085" title="All 2 branches missed.">            if (fab == null) {</span>
<span class="nc" id="L2086">                return;</span>
            }
        }
<span class="nc bnc" id="L2089" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4310)) {</span>
<span class="nc bnc" id="L2090" title="All 26 branches missed.">            if ((ListenerUtil.mutListener.listen(4309) ? (mMyLocationAnimation != null || ((ListenerUtil.mutListener.listen(4308) ? (mMyLocationAnimation.hasStarted() || !mMyLocationAnimation.hasEnded()) : (mMyLocationAnimation.hasStarted() &amp;&amp; !mMyLocationAnimation.hasEnded())))) : (mMyLocationAnimation != null &amp;&amp; ((ListenerUtil.mutListener.listen(4308) ? (mMyLocationAnimation.hasStarted() || !mMyLocationAnimation.hasEnded()) : (mMyLocationAnimation.hasStarted() &amp;&amp; !mMyLocationAnimation.hasEnded())))))) {</span>
            }
        }
<span class="nc bnc" id="L2093" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4312)) {</span>
<span class="nc bnc" id="L2094" title="All 2 branches missed.">            if (mMyLocationAnimation != null) {</span>
<span class="nc bnc" id="L2095" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4311)) {</span>
<span class="nc" id="L2096">                    mMyLocationAnimation.reset();</span>
                }
            }
        }
        // Post this to a handler to allow the header to settle before animating the button
<span class="nc" id="L2101">        final Handler h = new Handler();</span>
<span class="nc bnc" id="L2102" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4347)) {</span>
<span class="nc" id="L2103">            h.postDelayed(new Runnable() {</span>

                @Override
                public void run() {
<span class="nc" id="L2107">                    final ViewGroup.MarginLayoutParams p = (ViewGroup.MarginLayoutParams) fab.getLayoutParams();</span>
<span class="nc" id="L2108">                    int tempMargin = initialMargin;</span>
<span class="nc bnc" id="L2109" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4317)) {</span>
<span class="nc bnc" id="L2110" title="All 2 branches missed.">                        if (mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.COLLAPSED) {</span>
<span class="nc bnc" id="L2111" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(4315)) {</span>
<span class="nc" id="L2112">                                tempMargin += mSlidingPanel.getPanelHeight();</span>
                            }
<span class="nc bnc" id="L2114" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(4316)) {</span>
<span class="nc bnc" id="L2115" title="All 2 branches missed.">                                if (p.bottomMargin == tempMargin) {</span>
                                    // Button is already in the right position, do nothing
<span class="nc" id="L2117">                                    return;</span>
                                }
                            }
                        } else {
<span class="nc bnc" id="L2121" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(4314)) {</span>
<span class="nc bnc" id="L2122" title="All 2 branches missed.">                                if (mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.HIDDEN) {</span>
<span class="nc bnc" id="L2123" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(4313)) {</span>
<span class="nc bnc" id="L2124" title="All 2 branches missed.">                                        if (p.bottomMargin == tempMargin) {</span>
                                            // Button is already in the right position, do nothing
<span class="nc" id="L2126">                                            return;</span>
                                        }
                                    }
                                }
                            }
                        }
                    }
<span class="nc" id="L2133">                    final int goalMargin = tempMargin;</span>
<span class="nc" id="L2134">                    final int currentMargin = p.bottomMargin;</span>
<span class="nc bnc" id="L2135" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4344)) {</span>
<span class="nc" id="L2136">                        mMyLocationAnimation = new Animation() {</span>

                            @Override
                            protected void applyTransformation(float interpolatedTime, Transformation t) {
                                int bottom;
<span class="nc bnc" id="L2141" title="All 22 branches missed.">                                if ((ListenerUtil.mutListener.listen(4322) ? (goalMargin &gt;= currentMargin) : (ListenerUtil.mutListener.listen(4321) ? (goalMargin &lt;= currentMargin) : (ListenerUtil.mutListener.listen(4320) ? (goalMargin &lt; currentMargin) : (ListenerUtil.mutListener.listen(4319) ? (goalMargin != currentMargin) : (ListenerUtil.mutListener.listen(4318) ? (goalMargin == currentMargin) : (goalMargin &gt; currentMargin))))))) {</span>
<span class="nc bnc" id="L2142" title="All 48 branches missed.">                                    bottom = currentMargin + (int) ((ListenerUtil.mutListener.listen(4342) ? (Math.abs((ListenerUtil.mutListener.listen(4338) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4337) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4336) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4335) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) % interpolatedTime) : (ListenerUtil.mutListener.listen(4341) ? (Math.abs((ListenerUtil.mutListener.listen(4338) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4337) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4336) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4335) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) / interpolatedTime) : (ListenerUtil.mutListener.listen(4340) ? (Math.abs((ListenerUtil.mutListener.listen(4338) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4337) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4336) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4335) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) - interpolatedTime) : (ListenerUtil.mutListener.listen(4339) ? (Math.abs((ListenerUtil.mutListener.listen(4338) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4337) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4336) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4335) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) + interpolatedTime) : (Math.abs((ListenerUtil.mutListener.listen(4338) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4337) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4336) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4335) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) * interpolatedTime))))));</span>
                                } else {
<span class="nc bnc" id="L2144" title="All 248 branches missed.">                                    bottom = (ListenerUtil.mutListener.listen(4334) ? (currentMargin % (int) ((ListenerUtil.mutListener.listen(4330) ? (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) % interpolatedTime) : (ListenerUtil.mutListener.listen(4329) ? (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) / interpolatedTime) : (ListenerUtil.mutListener.listen(4328) ? (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) - interpolatedTime) : (ListenerUtil.mutListener.listen(4327) ? (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) + interpolatedTime) : (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) * interpolatedTime))))))) : (ListenerUtil.mutListener.listen(4333) ? (currentMargin / (int) ((ListenerUtil.mutListener.listen(4330) ? (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) % interpolatedTime) : (ListenerUtil.mutListener.listen(4329) ? (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) / interpolatedTime) : (ListenerUtil.mutListener.listen(4328) ? (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) - interpolatedTime) : (ListenerUtil.mutListener.listen(4327) ? (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) + interpolatedTime) : (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) * interpolatedTime))))))) : (ListenerUtil.mutListener.listen(4332) ? (currentMargin * (int) ((ListenerUtil.mutListener.listen(4330) ? (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) % interpolatedTime) : (ListenerUtil.mutListener.listen(4329) ? (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) / interpolatedTime) : (ListenerUtil.mutListener.listen(4328) ? (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) - interpolatedTime) : (ListenerUtil.mutListener.listen(4327) ? (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) + interpolatedTime) : (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) * interpolatedTime))))))) : (ListenerUtil.mutListener.listen(4331) ? (currentMargin + (int) ((ListenerUtil.mutListener.listen(4330) ? (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) % interpolatedTime) : (ListenerUtil.mutListener.listen(4329) ? (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) / interpolatedTime) : (ListenerUtil.mutListener.listen(4328) ? (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) - interpolatedTime) : (ListenerUtil.mutListener.listen(4327) ? (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) + interpolatedTime) : (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) * interpolatedTime))))))) : (currentMargin - (int) ((ListenerUtil.mutListener.listen(4330) ? (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) % interpolatedTime) : (ListenerUtil.mutListener.listen(4329) ? (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) / interpolatedTime) : (ListenerUtil.mutListener.listen(4328) ? (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) - interpolatedTime) : (ListenerUtil.mutListener.listen(4327) ? (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) + interpolatedTime) : (Math.abs((ListenerUtil.mutListener.listen(4326) ? (currentMargin % goalMargin) : (ListenerUtil.mutListener.listen(4325) ? (currentMargin / goalMargin) : (ListenerUtil.mutListener.listen(4324) ? (currentMargin * goalMargin) : (ListenerUtil.mutListener.listen(4323) ? (currentMargin + goalMargin) : (currentMargin - goalMargin)))))) * interpolatedTime)))))))))));</span>
                                }
<span class="nc bnc" id="L2146" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(4343)) {</span>
<span class="nc" id="L2147">                                    UIUtils.setMargins(fab, p.leftMargin, p.topMargin, p.rightMargin, bottom);</span>
                                }
<span class="nc" id="L2149">                            }</span>
                        };
                    }
<span class="nc bnc" id="L2152" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4345)) {</span>
<span class="nc" id="L2153">                        mMyLocationAnimation.setDuration(MY_LOC_BTN_ANIM_DURATION);</span>
                    }
<span class="nc bnc" id="L2155" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4346)) {</span>
<span class="nc" id="L2156">                        fab.startAnimation(mMyLocationAnimation);</span>
                    }
<span class="nc" id="L2158">                }</span>
            }, 100);
        }
<span class="nc" id="L2161">    }</span>

    private void showFloatingActionButtons() {
<span class="nc bnc" id="L2164" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4349)) {</span>
<span class="nc bnc" id="L2165" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(4348) ? (mFabMyLocation == null || mLayersFab == null) : (mFabMyLocation == null &amp;&amp; mLayersFab == null))) {</span>
<span class="nc" id="L2166">                return;</span>
            }
        }
<span class="nc bnc" id="L2169" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4352)) {</span>
<span class="nc bnc" id="L2170" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(4350) ? (mFabMyLocation != null || mFabMyLocation.getVisibility() != View.VISIBLE) : (mFabMyLocation != null &amp;&amp; mFabMyLocation.getVisibility() != View.VISIBLE))) {</span>
<span class="nc bnc" id="L2171" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4351)) {</span>
<span class="nc" id="L2172">                    mFabMyLocation.setVisibility(View.VISIBLE);</span>
                }
            }
        }
<span class="nc bnc" id="L2176" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4356)) {</span>
<span class="nc bnc" id="L2177" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(4353) ? (mLayersFab != null || mLayersFab.getVisibility() != View.VISIBLE) : (mLayersFab != null &amp;&amp; mLayersFab.getVisibility() != View.VISIBLE))) {</span>
<span class="nc bnc" id="L2178" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4355)) {</span>
<span class="nc bnc" id="L2179" title="All 2 branches missed.">                    if (Application.isBikeshareEnabled()) {</span>
<span class="nc bnc" id="L2180" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4354)) {</span>
<span class="nc" id="L2181">                            mLayersFab.setVisibility(View.VISIBLE);</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L2187">    }</span>

    private void hideFloatingActionButtons() {
<span class="nc bnc" id="L2190" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4358)) {</span>
<span class="nc bnc" id="L2191" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(4357) ? (mFabMyLocation == null || mLayersFab == null) : (mFabMyLocation == null &amp;&amp; mLayersFab == null))) {</span>
<span class="nc" id="L2192">                return;</span>
            }
        }
<span class="nc bnc" id="L2195" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4361)) {</span>
<span class="nc bnc" id="L2196" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(4359) ? (mFabMyLocation != null || mFabMyLocation.getVisibility() != View.GONE) : (mFabMyLocation != null &amp;&amp; mFabMyLocation.getVisibility() != View.GONE))) {</span>
<span class="nc bnc" id="L2197" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4360)) {</span>
<span class="nc" id="L2198">                    mFabMyLocation.setVisibility(View.GONE);</span>
                }
            }
        }
<span class="nc bnc" id="L2202" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4364)) {</span>
<span class="nc bnc" id="L2203" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(4362) ? (mLayersFab != null || mLayersFab.getVisibility() != View.GONE) : (mLayersFab != null &amp;&amp; mLayersFab.getVisibility() != View.GONE))) {</span>
<span class="nc bnc" id="L2204" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4363)) {</span>
<span class="nc" id="L2205">                    mLayersFab.setVisibility(View.GONE);</span>
                }
            }
        }
<span class="nc" id="L2209">    }</span>

    private void showMapProgressBar() {
<span class="nc bnc" id="L2212" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4365)) {</span>
<span class="nc bnc" id="L2213" title="All 2 branches missed.">            if (mMapProgressBar == null) {</span>
<span class="nc" id="L2214">                return;</span>
            }
        }
<span class="nc bnc" id="L2217" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4367)) {</span>
<span class="nc bnc" id="L2218" title="All 2 branches missed.">            if (mMapProgressBar.getVisibility() != View.VISIBLE) {</span>
<span class="nc bnc" id="L2219" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4366)) {</span>
<span class="nc" id="L2220">                    mMapProgressBar.setVisibility(View.VISIBLE);</span>
                }
            }
        }
<span class="nc" id="L2224">    }</span>

    private void hideMapProgressBar() {
<span class="nc bnc" id="L2227" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4368)) {</span>
<span class="nc bnc" id="L2228" title="All 2 branches missed.">            if (mMapProgressBar == null) {</span>
<span class="nc" id="L2229">                return;</span>
            }
        }
<span class="nc bnc" id="L2232" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4370)) {</span>
<span class="nc bnc" id="L2233" title="All 2 branches missed.">            if (mMapProgressBar.getVisibility() != View.GONE) {</span>
<span class="nc bnc" id="L2234" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4369)) {</span>
<span class="nc" id="L2235">                    mMapProgressBar.setVisibility(View.GONE);</span>
                }
            }
        }
<span class="nc" id="L2239">    }</span>

    private void setupNavigationDrawer() {
<span class="nc bnc" id="L2242" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4371)) {</span>
<span class="nc" id="L2243">            mNavigationDrawerFragment = (NavigationDrawerFragment) getSupportFragmentManager().findFragmentById(R.id.navigation_drawer);</span>
        }
<span class="nc bnc" id="L2245" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4372)) {</span>
            // Set up the drawer.
<span class="nc" id="L2247">            mNavigationDrawerFragment.setUp(R.id.navigation_drawer, findViewById(R.id.nav_drawer_left_pane));</span>
        }
        // Was this activity started to show a route or stop on the map? If so, switch to MapFragment
<span class="nc" id="L2250">        Bundle bundle = getIntent().getExtras();</span>
<span class="nc bnc" id="L2251" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4376)) {</span>
<span class="nc bnc" id="L2252" title="All 2 branches missed.">            if (bundle != null) {</span>
<span class="nc" id="L2253">                String routeId = bundle.getString(MapParams.ROUTE_ID);</span>
<span class="nc" id="L2254">                String stopId = bundle.getString(MapParams.STOP_ID);</span>
<span class="nc bnc" id="L2255" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4375)) {</span>
<span class="nc bnc" id="L2256" title="All 10 branches missed.">                    if ((ListenerUtil.mutListener.listen(4373) ? (routeId != null &amp;&amp; stopId != null) : (routeId != null || stopId != null))) {</span>
<span class="nc bnc" id="L2257" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4374)) {</span>
<span class="nc" id="L2258">                            mNavigationDrawerFragment.selectItem(NAVDRAWER_ITEM_NEARBY);</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L2264">    }</span>

    private void setupGooglePlayServices() {
        // Init Google Play Services as early as possible in the Fragment lifecycle to give it time
<span class="nc" id="L2268">        GoogleApiAvailability api = GoogleApiAvailability.getInstance();</span>
<span class="nc bnc" id="L2269" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4379)) {</span>
<span class="nc bnc" id="L2270" title="All 2 branches missed.">            if (api.isGooglePlayServicesAvailable(this) == ConnectionResult.SUCCESS) {</span>
<span class="nc bnc" id="L2271" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4377)) {</span>
<span class="nc" id="L2272">                    mGoogleApiClient = LocationUtils.getGoogleApiClientWithCallbacks(this);</span>
                }
<span class="nc bnc" id="L2274" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4378)) {</span>
<span class="nc" id="L2275">                    mGoogleApiClient.connect();</span>
                }
            }
        }
<span class="nc" id="L2279">    }</span>

    private void setupLayersSpeedDial() {
<span class="nc bnc" id="L2282" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4380)) {</span>
<span class="nc" id="L2283">            mLayersFab = findViewById(R.id.layersSpeedDial);</span>
        }
<span class="nc" id="L2285">        ViewGroup.MarginLayoutParams p = (ViewGroup.MarginLayoutParams) mLayersFab.getLayoutParams();</span>
<span class="nc bnc" id="L2286" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4381)) {</span>
<span class="nc" id="L2287">            LAYERS_FAB_DEFAULT_BOTTOM_MARGIN = p.bottomMargin;</span>
        }
<span class="nc bnc" id="L2289" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4382)) {</span>
<span class="nc" id="L2290">            mLayersFab.setButtonIconResource(R.drawable.ic_layers_white_24dp);</span>
        }
<span class="nc bnc" id="L2292" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4383)) {</span>
<span class="nc" id="L2293">            mLayersFab.setButtonBackgroundColour(ContextCompat.getColor(this, R.color.theme_accent));</span>
        }
<span class="nc" id="L2295">        LayersSpeedDialAdapter adapter = new LayersSpeedDialAdapter(this);</span>
<span class="nc bnc" id="L2296" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4384)) {</span>
            // Add the BaseMapFragment listener to activate the layer on the map
<span class="nc" id="L2298">            adapter.addLayerActivationListener(mMapFragment);</span>
        }
<span class="nc bnc" id="L2300" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4387)) {</span>
            // reference to it only in the main activity.
<span class="nc" id="L2302">            adapter.addLayerActivationListener(new LayersSpeedDialAdapter.LayerActivationListener() {</span>

                @Override
                public void onActivateLayer(LayerInfo layer) {
<span class="nc" id="L2306">                    Handler h = new Handler(getMainLooper());</span>
<span class="nc bnc" id="L2307" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4385)) {</span>
<span class="nc" id="L2308">                        h.postDelayed(() -&gt; mLayersFab.rebuildSpeedDialMenu(), 100);</span>
                    }
<span class="nc" id="L2310">                }</span>

                @Override
                public void onDeactivateLayer(LayerInfo layer) {
<span class="nc" id="L2314">                    Handler h = new Handler(getMainLooper());</span>
<span class="nc bnc" id="L2315" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4386)) {</span>
<span class="nc" id="L2316">                        h.postDelayed(() -&gt; mLayersFab.rebuildSpeedDialMenu(), 100);</span>
                    }
<span class="nc" id="L2318">                }</span>
            });
        }
<span class="nc bnc" id="L2321" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4388)) {</span>
<span class="nc" id="L2322">            mLayersFab.setSpeedDialMenuAdapter(adapter);</span>
        }
<span class="nc bnc" id="L2324" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4389)) {</span>
<span class="nc" id="L2325">            mLayersFab.setOnSpeedDialMenuOpenListener(v -&gt; mLayersFab.setButtonIconResource(R.drawable.ic_add_white_24dp));</span>
        }
<span class="nc bnc" id="L2327" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4390)) {</span>
<span class="nc" id="L2328">            mLayersFab.setOnSpeedDialMenuCloseListener(v -&gt; mLayersFab.setButtonIconResource(R.drawable.ic_layers_white_24dp));</span>
        }
<span class="nc bnc" id="L2330" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4391)) {</span>
<span class="nc" id="L2331">            mLayersFab.setContentCoverEnabled(false);</span>
        }
<span class="nc" id="L2333">    }</span>

    /**
     * Method used to (re)display the layers FAB button when the activity restarts or regions data
     * is updated
     */
    private void updateLayersFab() {
<span class="nc bnc" id="L2340" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4395)) {</span>
<span class="nc bnc" id="L2341" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(4392) ? (Application.isBikeshareEnabled() || mCurrentNavDrawerPosition == NAVDRAWER_ITEM_NEARBY) : (Application.isBikeshareEnabled() &amp;&amp; mCurrentNavDrawerPosition == NAVDRAWER_ITEM_NEARBY))) {</span>
<span class="nc bnc" id="L2342" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4394)) {</span>
<span class="nc" id="L2343">                    mLayersFab.setVisibility(View.VISIBLE);</span>
                }
            } else {
<span class="nc bnc" id="L2346" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4393)) {</span>
<span class="nc" id="L2347">                    mLayersFab.setVisibility(View.GONE);</span>
                }
            }
        }
<span class="nc bnc" id="L2351" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4396)) {</span>
<span class="nc" id="L2352">            mLayersFab.rebuildSpeedDialMenu();</span>
        }
<span class="nc" id="L2354">    }</span>

    private void setupSlidingPanel() {
<span class="nc bnc" id="L2357" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4397)) {</span>
<span class="nc" id="L2358">            mSlidingPanel = findViewById(R.id.bottom_sliding_layout);</span>
        }
<span class="nc bnc" id="L2360" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4398)) {</span>
<span class="nc" id="L2361">            mArrivalsListHeaderView = findViewById(R.id.arrivals_list_header);</span>
        }
<span class="nc bnc" id="L2363" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4399)) {</span>
<span class="nc" id="L2364">            mArrivalsListHeaderSubView = mArrivalsListHeaderView.findViewById(R.id.main_header_content);</span>
        }
<span class="nc bnc" id="L2366" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4400)) {</span>
<span class="nc" id="L2367">            mSlidingPanel.setPanelState(// Don't show the panel until we have content</span>
            SlidingUpPanelLayout.PanelState.HIDDEN);
        }
<span class="nc bnc" id="L2370" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4401)) {</span>
<span class="nc" id="L2371">            mSlidingPanel.setOverlayed(true);</span>
        }
<span class="nc bnc" id="L2373" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4402)) {</span>
<span class="nc" id="L2374">            mSlidingPanel.setAnchorPoint(MapModeController.OVERLAY_PERCENTAGE);</span>
        }
<span class="nc bnc" id="L2376" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4443)) {</span>
<span class="nc" id="L2377">            mSlidingPanel.addPanelSlideListener(new SlidingUpPanelLayout.PanelSlideListener() {</span>

                @Override
                public void onPanelStateChanged(View panel, SlidingUpPanelLayout.PanelState previousState, SlidingUpPanelLayout.PanelState newState) {
<span class="nc bnc" id="L2381" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4403)) {</span>
<span class="nc bnc" id="L2382" title="All 2 branches missed.">                        if (previousState == SlidingUpPanelLayout.PanelState.HIDDEN) {</span>
<span class="nc" id="L2383">                            return;</span>
                        }
                    }
<span class="nc bnc" id="L2386" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4408)) {</span>
<span class="nc bnc" id="L2387" title="All 5 branches missed.">                        switch(newState) {</span>
                            case EXPANDED:
<span class="nc bnc" id="L2389" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(4404)) {</span>
<span class="nc" id="L2390">                                    onPanelExpanded(panel);</span>
                                }
                                break;
                            case COLLAPSED:
<span class="nc bnc" id="L2394" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(4405)) {</span>
<span class="nc" id="L2395">                                    onPanelCollapsed(panel);</span>
                                }
                                break;
                            case ANCHORED:
<span class="nc bnc" id="L2399" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(4406)) {</span>
<span class="nc" id="L2400">                                    onPanelAnchored(panel);</span>
                                }
                                break;
                            case HIDDEN:
<span class="nc bnc" id="L2404" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(4407)) {</span>
<span class="nc" id="L2405">                                    onPanelHidden(panel);</span>
                                }
                                break;
                        }
                    }
<span class="nc" id="L2410">                }</span>

                @Override
                public void onPanelSlide(View panel, float slideOffset) {
<span class="nc bnc" id="L2414" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4409)) {</span>
<span class="nc" id="L2415">                        Log.d(TAG, &quot;onPanelSlide, offset &quot; + slideOffset);</span>
                    }
<span class="nc bnc" id="L2417" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4411)) {</span>
<span class="nc bnc" id="L2418" title="All 2 branches missed.">                        if (mArrivalsListHeader != null) {</span>
<span class="nc bnc" id="L2419" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(4410)) {</span>
<span class="nc" id="L2420">                                mArrivalsListHeader.closeStatusPopups();</span>
                            }
                        }
                    }
<span class="nc" id="L2424">                }</span>

                public void onPanelExpanded(View panel) {
<span class="nc bnc" id="L2427" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4412)) {</span>
<span class="nc" id="L2428">                        Log.d(TAG, &quot;onPanelExpanded&quot;);</span>
                    }
<span class="nc bnc" id="L2430" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4415)) {</span>
<span class="nc bnc" id="L2431" title="All 2 branches missed.">                        if (mArrivalsListHeader != null) {</span>
<span class="nc bnc" id="L2432" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(4413)) {</span>
<span class="nc" id="L2433">                                mArrivalsListHeader.setSlidingPanelCollapsed(false);</span>
                            }
<span class="nc bnc" id="L2435" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(4414)) {</span>
<span class="nc" id="L2436">                                mArrivalsListHeader.refresh();</span>
                            }
                        }
                    }
<span class="nc bnc" id="L2440" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4417)) {</span>
                        // Accessibility
<span class="nc bnc" id="L2442" title="All 2 branches missed.">                        if (mExpandCollapse != null) {</span>
<span class="nc bnc" id="L2443" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(4416)) {</span>
<span class="nc" id="L2444">                                mExpandCollapse.setContentDescription(Application.get().getResources().getString(R.string.stop_header_sliding_panel_open));</span>
                            }
                        }
                    }
<span class="nc" id="L2448">                }</span>

                public void onPanelCollapsed(View panel) {
<span class="nc bnc" id="L2451" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4418)) {</span>
<span class="nc" id="L2452">                        Log.d(TAG, &quot;onPanelCollapsed&quot;);</span>
                    }
<span class="nc bnc" id="L2454" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4420)) {</span>
<span class="nc bnc" id="L2455" title="All 2 branches missed.">                        if (mMapFragment != null) {</span>
<span class="nc bnc" id="L2456" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(4419)) {</span>
<span class="nc" id="L2457">                                mMapFragment.getMapView().setPadding(null, null, null, mSlidingPanel.getPanelHeight());</span>
                            }
                        }
                    }
<span class="nc bnc" id="L2461" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4423)) {</span>
<span class="nc bnc" id="L2462" title="All 2 branches missed.">                        if (mArrivalsListHeader != null) {</span>
<span class="nc bnc" id="L2463" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(4421)) {</span>
<span class="nc" id="L2464">                                mArrivalsListHeader.setSlidingPanelCollapsed(true);</span>
                            }
<span class="nc bnc" id="L2466" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(4422)) {</span>
<span class="nc" id="L2467">                                mArrivalsListHeader.refresh();</span>
                            }
                        }
                    }
<span class="nc bnc" id="L2471" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4424)) {</span>
<span class="nc" id="L2472">                        moveFabsLocation();</span>
                    }
<span class="nc bnc" id="L2474" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4426)) {</span>
                        // Accessibility
<span class="nc bnc" id="L2476" title="All 2 branches missed.">                        if (mExpandCollapse != null) {</span>
<span class="nc bnc" id="L2477" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(4425)) {</span>
<span class="nc" id="L2478">                                mExpandCollapse.setContentDescription(Application.get().getResources().getString(R.string.stop_header_sliding_panel_collapsed));</span>
                            }
                        }
                    }
<span class="nc" id="L2482">                }</span>

                public void onPanelAnchored(View panel) {
<span class="nc bnc" id="L2485" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4427)) {</span>
<span class="nc" id="L2486">                        Log.d(TAG, &quot;onPanelAnchored&quot;);</span>
                    }
<span class="nc bnc" id="L2488" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4429)) {</span>
<span class="nc bnc" id="L2489" title="All 2 branches missed.">                        if (mMapFragment != null) {</span>
<span class="nc bnc" id="L2490" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(4428)) {</span>
<span class="nc" id="L2491">                                mMapFragment.getMapView().setPadding(null, null, null, mSlidingPanel.getPanelHeight());</span>
                            }
                        }
                    }
<span class="nc bnc" id="L2495" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4432)) {</span>
<span class="nc bnc" id="L2496" title="All 10 branches missed.">                        if ((ListenerUtil.mutListener.listen(4430) ? (mFocusedStop != null || mMapFragment != null) : (mFocusedStop != null &amp;&amp; mMapFragment != null))) {</span>
<span class="nc bnc" id="L2497" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(4431)) {</span>
<span class="nc" id="L2498">                                mMapFragment.setMapCenter(mFocusedStop.getLocation(), true, true);</span>
                            }
                        }
                    }
<span class="nc bnc" id="L2502" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4435)) {</span>
<span class="nc bnc" id="L2503" title="All 2 branches missed.">                        if (mArrivalsListHeader != null) {</span>
<span class="nc bnc" id="L2504" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(4433)) {</span>
<span class="nc" id="L2505">                                mArrivalsListHeader.setSlidingPanelCollapsed(false);</span>
                            }
<span class="nc bnc" id="L2507" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(4434)) {</span>
<span class="nc" id="L2508">                                mArrivalsListHeader.refresh();</span>
                            }
                        }
                    }
<span class="nc bnc" id="L2512" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4437)) {</span>
                        // Accessibility
<span class="nc bnc" id="L2514" title="All 2 branches missed.">                        if (mExpandCollapse != null) {</span>
<span class="nc bnc" id="L2515" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(4436)) {</span>
<span class="nc" id="L2516">                                mExpandCollapse.setContentDescription(Application.get().getResources().getString(R.string.stop_header_sliding_panel_open));</span>
                            }
                        }
                    }
<span class="nc" id="L2520">                }</span>

                public void onPanelHidden(View panel) {
<span class="nc bnc" id="L2523" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4438)) {</span>
<span class="nc" id="L2524">                        Log.d(TAG, &quot;onPanelHidden&quot;);</span>
                    }
<span class="nc bnc" id="L2526" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4440)) {</span>
                        // MapFragment or the ArrivalListFragment (e.g., removing the ArrivalListFragment)
<span class="nc bnc" id="L2528" title="All 2 branches missed.">                        if (mMapFragment != null) {</span>
<span class="nc bnc" id="L2529" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(4439)) {</span>
<span class="nc" id="L2530">                                mMapFragment.getMapView().setPadding(null, null, null, 0);</span>
                            }
                        }
                    }
<span class="nc bnc" id="L2534" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4442)) {</span>
                        // Accessibility - reset it here so its ready for next showing
<span class="nc bnc" id="L2536" title="All 2 branches missed.">                        if (mExpandCollapse != null) {</span>
<span class="nc bnc" id="L2537" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(4441)) {</span>
<span class="nc" id="L2538">                                mExpandCollapse.setContentDescription(Application.get().getResources().getString(R.string.stop_header_sliding_panel_collapsed));</span>
                            }
                        }
                    }
<span class="nc" id="L2542">                }</span>
            });
        }
<span class="nc bnc" id="L2545" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4452)) {</span>
<span class="nc" id="L2546">            mSlidingPanelController = new SlidingPanelController() {</span>

                @Override
                public void setPanelHeightPixels(int heightInPixels) {
<span class="nc bnc" id="L2550" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4450)) {</span>
<span class="nc bnc" id="L2551" title="All 2 branches missed.">                        if (mSlidingPanel != null) {</span>
<span class="nc bnc" id="L2552" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(4445)) {</span>
<span class="nc bnc" id="L2553" title="All 10 branches missed.">                                if ((ListenerUtil.mutListener.listen(4444) ? (mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.DRAGGING &amp;&amp; mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.HIDDEN) : (mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.DRAGGING || mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.HIDDEN))) {</span>
                                    // Don't resize header yet - see #294 - header size will be refreshed on panel state change
<span class="nc" id="L2555">                                    return;</span>
                                }
                            }
<span class="nc bnc" id="L2558" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(4449)) {</span>
<span class="nc bnc" id="L2559" title="All 2 branches missed.">                                if (mSlidingPanel.getPanelHeight() != heightInPixels) {</span>
<span class="nc bnc" id="L2560" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(4446)) {</span>
<span class="nc" id="L2561">                                        mSlidingPanel.setPanelHeight(heightInPixels);</span>
                                    }
<span class="nc bnc" id="L2563" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(4447)) {</span>
<span class="nc" id="L2564">                                        mArrivalsListHeaderView.getLayoutParams().height = heightInPixels;</span>
                                    }
<span class="nc bnc" id="L2566" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(4448)) {</span>
<span class="nc" id="L2567">                                        mArrivalsListHeaderSubView.getLayoutParams().height = heightInPixels;</span>
                                    }
                                }
                            }
                        }
                    }
<span class="nc" id="L2573">                }</span>

                @Override
                public int getPanelHeightPixels() {
<span class="nc bnc" id="L2577" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4451)) {</span>
<span class="nc bnc" id="L2578" title="All 2 branches missed.">                        if (mSlidingPanel != null) {</span>
<span class="nc" id="L2579">                            return mSlidingPanel.getPanelHeight();</span>
                        }
                    }
<span class="nc" id="L2582">                    return -1;</span>
                }
            };
        }
<span class="nc" id="L2586">    }</span>

    /**
     * Sets up the initial map state, based on a previous savedInstanceState for this activity,
     * or an Intent that was passed into this activity
     */
    private void setupMapState(Bundle savedInstanceState) {
        String stopId;
        String stopName;
        String stopCode;
        // Check savedInstanceState to see if there is a previous state for this activity
<span class="nc bnc" id="L2597" title="All 2 branches missed.">        if (savedInstanceState != null) {</span>
            // We're recreating an instance with a previous state, so show the focused stop in panel
<span class="nc" id="L2599">            stopId = savedInstanceState.getString(MapParams.STOP_ID);</span>
<span class="nc" id="L2600">            stopName = savedInstanceState.getString(MapParams.STOP_NAME);</span>
<span class="nc" id="L2601">            stopCode = savedInstanceState.getString(MapParams.STOP_CODE);</span>
<span class="nc bnc" id="L2602" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(4470)) {</span>
<span class="nc bnc" id="L2603" title="All 2 branches missed.">                if (stopId != null) {</span>
<span class="nc bnc" id="L2604" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4468)) {</span>
<span class="nc" id="L2605">                        mFocusedStopId = stopId;</span>
                    }
<span class="nc bnc" id="L2607" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4469)) {</span>
                        // We don't have an ObaStop or ObaRoute mapping, so just pass in null for those
<span class="nc" id="L2609">                        updateArrivalListFragment(stopId, stopName, stopCode, null, null);</span>
                    }
                }
            }
        } else {
            // Check intent passed into Activity
<span class="nc" id="L2615">            Bundle bundle = getIntent().getExtras();</span>
<span class="nc bnc" id="L2616" title="All 2 branches missed.">            if (bundle != null) {</span>
                // Did this activity start to focus on a stop?  If so, set focus and show arrival info
<span class="nc" id="L2618">                stopId = bundle.getString(MapParams.STOP_ID);</span>
<span class="nc" id="L2619">                stopName = bundle.getString(MapParams.STOP_NAME);</span>
<span class="nc" id="L2620">                stopCode = bundle.getString(MapParams.STOP_CODE);</span>
<span class="nc" id="L2621">                double lat = bundle.getDouble(MapParams.CENTER_LAT);</span>
<span class="nc" id="L2622">                double lon = bundle.getDouble(MapParams.CENTER_LON);</span>
<span class="nc bnc" id="L2623" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4467)) {</span>
<span class="nc bnc" id="L2624" title="All 146 branches missed.">                    if ((ListenerUtil.mutListener.listen(4464) ? ((ListenerUtil.mutListener.listen(4458) ? (stopId != null || (ListenerUtil.mutListener.listen(4457) ? (lat &gt;= 0.0) : (ListenerUtil.mutListener.listen(4456) ? (lat &lt;= 0.0) : (ListenerUtil.mutListener.listen(4455) ? (lat &gt; 0.0) : (ListenerUtil.mutListener.listen(4454) ? (lat &lt; 0.0) : (ListenerUtil.mutListener.listen(4453) ? (lat == 0.0) : (lat != 0.0))))))) : (stopId != null &amp;&amp; (ListenerUtil.mutListener.listen(4457) ? (lat &gt;= 0.0) : (ListenerUtil.mutListener.listen(4456) ? (lat &lt;= 0.0) : (ListenerUtil.mutListener.listen(4455) ? (lat &gt; 0.0) : (ListenerUtil.mutListener.listen(4454) ? (lat &lt; 0.0) : (ListenerUtil.mutListener.listen(4453) ? (lat == 0.0) : (lat != 0.0)))))))) || (ListenerUtil.mutListener.listen(4463) ? (lon &gt;= 0.0) : (ListenerUtil.mutListener.listen(4462) ? (lon &lt;= 0.0) : (ListenerUtil.mutListener.listen(4461) ? (lon &gt; 0.0) : (ListenerUtil.mutListener.listen(4460) ? (lon &lt; 0.0) : (ListenerUtil.mutListener.listen(4459) ? (lon == 0.0) : (lon != 0.0))))))) : ((ListenerUtil.mutListener.listen(4458) ? (stopId != null || (ListenerUtil.mutListener.listen(4457) ? (lat &gt;= 0.0) : (ListenerUtil.mutListener.listen(4456) ? (lat &lt;= 0.0) : (ListenerUtil.mutListener.listen(4455) ? (lat &gt; 0.0) : (ListenerUtil.mutListener.listen(4454) ? (lat &lt; 0.0) : (ListenerUtil.mutListener.listen(4453) ? (lat == 0.0) : (lat != 0.0))))))) : (stopId != null &amp;&amp; (ListenerUtil.mutListener.listen(4457) ? (lat &gt;= 0.0) : (ListenerUtil.mutListener.listen(4456) ? (lat &lt;= 0.0) : (ListenerUtil.mutListener.listen(4455) ? (lat &gt; 0.0) : (ListenerUtil.mutListener.listen(4454) ? (lat &lt; 0.0) : (ListenerUtil.mutListener.listen(4453) ? (lat == 0.0) : (lat != 0.0)))))))) &amp;&amp; (ListenerUtil.mutListener.listen(4463) ? (lon &gt;= 0.0) : (ListenerUtil.mutListener.listen(4462) ? (lon &lt;= 0.0) : (ListenerUtil.mutListener.listen(4461) ? (lon &gt; 0.0) : (ListenerUtil.mutListener.listen(4460) ? (lon &lt; 0.0) : (ListenerUtil.mutListener.listen(4459) ? (lon == 0.0) : (lon != 0.0))))))))) {</span>
<span class="nc bnc" id="L2625" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4465)) {</span>
<span class="nc" id="L2626">                            mFocusedStopId = stopId;</span>
                        }
<span class="nc bnc" id="L2628" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4466)) {</span>
<span class="nc" id="L2629">                            updateArrivalListFragment(stopId, stopName, stopCode, null, null);</span>
                        }
                    }
                }
            }
        }
<span class="nc bnc" id="L2635" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4471)) {</span>
<span class="nc" id="L2636">            mMapProgressBar = findViewById(R.id.progress_horizontal);</span>
        }
<span class="nc" id="L2638">    }</span>

    /**
     * Setup permissions that are only requested if the user joins the travel behavior study. This
     * method must be called from #onCreate().
     *
     * A call to #requestPhysicalActivityPermission() invokes the permission request, and should only
     * be called in the case when the user opts into the study.
     * @param activity
     */
    private void setupPermissions(AppCompatActivity activity) {
<span class="nc bnc" id="L2649" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4472)) {</span>
<span class="nc" id="L2650">            travelBehaviorPermissionsLauncher = registerForActivityResult(new ActivityResultContracts.RequestPermission(), isGranted -&gt; {</span>
<span class="nc bnc" id="L2651" title="All 2 branches missed.">                if (isGranted) {</span>
                    // User opt-ed into study and granted physical activity tracking - now request background location permissions (when targeting Android 11 we can't request both simultaneously)
<span class="nc bnc" id="L2653" title="All 2 branches missed.">                    if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.M) {</span>
<span class="nc" id="L2654">                        activity.requestPermissions(TravelBehaviorConstants.BACKGROUND_LOCATION_PERMISSION, BACKGROUND_LOCATION_PERMISSION_REQUEST);</span>
                    }
                }
<span class="nc" id="L2657">            });</span>
        }
<span class="nc" id="L2659">    }</span>

    /**
     * Requests physical activity permissions, and then subsequently background location
     * permissions (based on the initialization in #setupPermissions() if the user grants physical
     * activity permissions. This method should only be called after the user opts into the travel behavior study.
     */
    public void requestPhysicalActivityPermission() {
<span class="nc bnc" id="L2667" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4474)) {</span>
<span class="nc bnc" id="L2668" title="All 2 branches missed.">            if (travelBehaviorPermissionsLauncher != null) {</span>
<span class="nc bnc" id="L2669" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4473)) {</span>
<span class="nc" id="L2670">                    travelBehaviorPermissionsLauncher.launch(Manifest.permission.ACTIVITY_RECOGNITION);</span>
                }
            }
        }
<span class="nc" id="L2674">    }</span>

    /**
     * Our definition of collapsed is consistent with SlidingPanel pre-v3.0.0 definition - we don't
     * consider the panel changing from the hidden state to the collapsed state to be a &quot;collapsed&quot;
     * event.  v3.0.0 and higher fire the &quot;collapsed&quot; event when coming from the hidden state.
     * This method provides us with a collapsed state that is consistent with the pre-v3.0.0
     * definition
     * of a collapse event, to make our event model consistent with post v3.0.0 SlidingPanel.
     *
     * @return true if the panel isn't expanded or anchored, false if it is not
     */
    private boolean isSlidingPanelCollapsed() {
<span class="nc bnc" id="L2687" title="All 10 branches missed.">        return !((ListenerUtil.mutListener.listen(4475) ? (mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.EXPANDED &amp;&amp; mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.ANCHORED) : (mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.EXPANDED || mSlidingPanel.getPanelState() == SlidingUpPanelLayout.PanelState.ANCHORED)));</span>
    }

    public ArrivalsListFragment getArrivalsListFragment() {
<span class="nc" id="L2691">        return mArrivalsListFragment;</span>
    }

    private void checkBatteryOptimizations() {
<span class="nc bnc" id="L2695" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4477)) {</span>
<span class="nc bnc" id="L2696" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(4476) ? (PreferenceUtils.getBoolean(getString(R.string.not_request_battery_optimizations_key), false) &amp;&amp; !TravelBehaviorUtils.isUserParticipatingInStudy()) : (PreferenceUtils.getBoolean(getString(R.string.not_request_battery_optimizations_key), false) || !TravelBehaviorUtils.isUserParticipatingInStudy()))) {</span>
<span class="nc" id="L2697">                return;</span>
            }
        }
<span class="nc" id="L2700">        Boolean ignoringBatteryOptimizations = Application.isIgnoringBatteryOptimizations(getApplicationContext());</span>
<span class="nc bnc" id="L2701" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4480)) {</span>
<span class="nc bnc" id="L2702" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(4478) ? (ignoringBatteryOptimizations != null || !ignoringBatteryOptimizations) : (ignoringBatteryOptimizations != null &amp;&amp; !ignoringBatteryOptimizations))) {</span>
<span class="nc bnc" id="L2703" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4479)) {</span>
<span class="nc" id="L2704">                    showIgnoreBatteryOptimizationDialog();</span>
                }
            }
        }
<span class="nc" id="L2708">    }</span>

    private void showIgnoreBatteryOptimizationDialog() {
<span class="nc bnc" id="L2711" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4481)) {</span>
<span class="nc" id="L2712">            new android.app.AlertDialog.Builder(this).setMessage(R.string.application_ignoring_battery_opt_message).setTitle(R.string.application_ignoring_battery_opt_title).setIcon(R.drawable.ic_alert_warning).setCancelable(false).setPositiveButton(R.string.travel_behavior_dialog_yes, (dialog, which) -&gt; {</span>
<span class="nc bnc" id="L2713" title="All 2 branches missed.">                if (PermissionUtils.hasGrantedAllPermissions(this, new String[] { Manifest.permission.REQUEST_IGNORE_BATTERY_OPTIMIZATIONS })) {</span>
<span class="nc" id="L2714">                    UIUtils.openBatteryIgnoreIntent(this);</span>
                } else {
<span class="nc bnc" id="L2716" title="All 2 branches missed.">                    if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.M) {</span>
<span class="nc" id="L2717">                        requestPermissions(new String[] { Manifest.permission.REQUEST_IGNORE_BATTERY_OPTIMIZATIONS }, BATTERY_OPTIMIZATIONS_PERMISSION_REQUEST);</span>
                    }
                }
<span class="nc" id="L2720">                PreferenceUtils.saveBoolean(getString(R.string.not_request_battery_optimizations_key), true);</span>
<span class="nc" id="L2721">            }).setNegativeButton(R.string.travel_behavior_dialog_no, (dialog, which) -&gt; {</span>
<span class="nc" id="L2722">                PreferenceUtils.saveBoolean(getString(R.string.not_request_battery_optimizations_key), true);</span>
<span class="nc" id="L2723">            }).create().show();</span>
        }
<span class="nc" id="L2725">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span>Generated by the Android Gradle plugin 8.2.0</div></body></html>