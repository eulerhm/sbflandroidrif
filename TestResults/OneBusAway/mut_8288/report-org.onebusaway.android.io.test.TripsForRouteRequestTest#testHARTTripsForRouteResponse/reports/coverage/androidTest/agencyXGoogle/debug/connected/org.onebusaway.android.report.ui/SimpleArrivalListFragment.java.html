<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SimpleArrivalListFragment.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">agencyXGoogleDebug</a> &gt; <a href="index.source.html" class="el_package">org.onebusaway.android.report.ui</a> &gt; <span class="el_source">SimpleArrivalListFragment.java</span></div><h1>SimpleArrivalListFragment.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2012-2015 Paul Watts (paulcwatts@gmail.com), University of South Florida,
 * Benjamin Du (bendu@me.com), and individual contributors.
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.onebusaway.android.report.ui;

import android.content.Intent;
import android.graphics.drawable.GradientDrawable;
import android.net.Uri;
import android.os.Bundle;
import android.text.format.DateUtils;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ImageView;
import android.widget.LinearLayout;
import android.widget.TextView;
import androidx.appcompat.app.AppCompatActivity;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import androidx.loader.app.LoaderManager;
import androidx.loader.content.Loader;
import org.onebusaway.android.R;
import org.onebusaway.android.io.ObaApi;
import org.onebusaway.android.io.elements.ObaArrivalInfo;
import org.onebusaway.android.io.elements.ObaReferences;
import org.onebusaway.android.io.elements.ObaStop;
import org.onebusaway.android.io.elements.ObaTrip;
import org.onebusaway.android.io.elements.OccupancyState;
import org.onebusaway.android.io.request.ObaArrivalInfoResponse;
import org.onebusaway.android.map.MapParams;
import org.onebusaway.android.provider.ObaContract;
import org.onebusaway.android.ui.ArrivalInfo;
import org.onebusaway.android.ui.ArrivalsListLoader;
import org.onebusaway.android.util.ArrivalInfoUtils;
import org.onebusaway.android.util.FragmentUtils;
import org.onebusaway.android.util.UIUtils;
import java.util.ArrayList;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

<span class="nc" id="L55">public class SimpleArrivalListFragment extends Fragment implements LoaderManager.LoaderCallbacks&lt;ObaArrivalInfoResponse&gt; {</span>

    public interface Callback {

        void onArrivalItemClicked(ObaArrivalInfo obaArrivalInfo, String agencyName, String blockId);
    }

    private ObaStop mObaStop;

    private String mBundleObaStopId;

    private Callback mCallback;

    public static final String TAG = &quot;SimpArrivalListFragment&quot;;

<span class="nc" id="L70">    private static int ARRIVALS_LIST_LOADER = 3;</span>

    public static void show(AppCompatActivity activity, Integer containerViewId, ObaStop stop, Callback callback) {
<span class="nc" id="L73">        FragmentManager fm = activity.getSupportFragmentManager();</span>
<span class="nc" id="L74">        SimpleArrivalListFragment fragment = new SimpleArrivalListFragment();</span>
<span class="nc bnc" id="L75" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11104)) {</span>
<span class="nc" id="L76">            fragment.setObaStop(stop);</span>
        }
<span class="nc" id="L78">        Intent intent = new Intent(activity, SimpleArrivalListFragment.class);</span>
<span class="nc bnc" id="L79" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11105)) {</span>
<span class="nc" id="L80">            intent.setData(Uri.withAppendedPath(ObaContract.Stops.CONTENT_URI, stop.getId()));</span>
        }
<span class="nc bnc" id="L82" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11106)) {</span>
<span class="nc" id="L83">            fragment.setArguments(FragmentUtils.getIntentArgs(intent));</span>
        }
<span class="nc bnc" id="L85" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11107)) {</span>
<span class="nc" id="L86">            fragment.setCallback(callback);</span>
        }
        try {
<span class="nc" id="L89">            FragmentTransaction ft = fm.beginTransaction();</span>
<span class="nc bnc" id="L90" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11109)) {</span>
<span class="nc" id="L91">                ft.replace(containerViewId, fragment, TAG);</span>
            }
<span class="nc bnc" id="L93" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11110)) {</span>
<span class="nc" id="L94">                ft.addToBackStack(null);</span>
            }
<span class="nc bnc" id="L96" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11111)) {</span>
<span class="nc" id="L97">                ft.commit();</span>
            }
<span class="nc" id="L99">        } catch (IllegalStateException e) {</span>
<span class="nc bnc" id="L100" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11108)) {</span>
<span class="nc" id="L101">                Log.e(TAG, &quot;Cannot show SimpleArrivalListFragment after onSaveInstanceState has been called&quot;);</span>
            }
<span class="nc" id="L103">        }</span>
<span class="nc" id="L104">    }</span>

    @Override
    public void onSaveInstanceState(Bundle outState) {
<span class="nc bnc" id="L108" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11112)) {</span>
<span class="nc" id="L109">            super.onSaveInstanceState(outState);</span>
        }
<span class="nc bnc" id="L111" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11115)) {</span>
<span class="nc bnc" id="L112" title="All 2 branches missed.">            if (mObaStop != null) {</span>
<span class="nc bnc" id="L113" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11114)) {</span>
<span class="nc" id="L114">                    outState.putString(MapParams.STOP_ID, mObaStop.getId());</span>
                }
<span class="nc bnc" id="L116" title="All 2 branches missed.">            } else if (mBundleObaStopId != null) {</span>
<span class="nc bnc" id="L117" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11113)) {</span>
<span class="nc" id="L118">                    outState.putString(MapParams.STOP_ID, mBundleObaStopId);</span>
                }
            }
        }
<span class="nc" id="L122">    }</span>

    @Override
    public void onViewStateRestored(Bundle savedInstanceState) {
<span class="nc bnc" id="L126" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11116)) {</span>
<span class="nc" id="L127">            super.onViewStateRestored(savedInstanceState);</span>
        }
<span class="nc bnc" id="L129" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11118)) {</span>
<span class="nc bnc" id="L130" title="All 2 branches missed.">            if (savedInstanceState != null) {</span>
<span class="nc bnc" id="L131" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11117)) {</span>
<span class="nc" id="L132">                    mBundleObaStopId = savedInstanceState.getString(MapParams.STOP_ID);</span>
                }
            }
        }
<span class="nc" id="L136">    }</span>

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
<span class="nc" id="L140">        return inflater.inflate(R.layout.simple_arrival_list, container, false);</span>
    }

    @Override
    public void onViewCreated(View view, Bundle savedInstanceState) {
<span class="nc bnc" id="L145" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11119)) {</span>
<span class="nc" id="L146">            super.onViewCreated(view, savedInstanceState);</span>
        }
<span class="nc bnc" id="L148" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11120)) {</span>
<span class="nc" id="L149">            ((ImageView) getActivity().findViewById(R.id.arrival_list_action_info)).setColorFilter(getResources().getColor(R.color.material_gray));</span>
        }
<span class="nc" id="L151">    }</span>

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
<span class="nc bnc" id="L155" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11121)) {</span>
<span class="nc" id="L156">            super.onActivityCreated(savedInstanceState);</span>
        }
<span class="nc" id="L158">        LoaderManager mgr = getActivity().getSupportLoaderManager();</span>
<span class="nc bnc" id="L159" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11122)) {</span>
<span class="nc" id="L160">            mgr.initLoader(ARRIVALS_LIST_LOADER, getArguments(), this).forceLoad();</span>
        }
<span class="nc" id="L162">    }</span>

    public void setObaStop(ObaStop obaStop) {
<span class="nc bnc" id="L165" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11123)) {</span>
<span class="nc" id="L166">            mObaStop = obaStop;</span>
        }
<span class="nc" id="L168">    }</span>

    @Override
    public void onResume() {
<span class="nc bnc" id="L172" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11124)) {</span>
<span class="nc" id="L173">            super.onResume();</span>
        }
<span class="nc bnc" id="L175" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11125)) {</span>
<span class="nc" id="L176">            getActivity().getSupportLoaderManager().restartLoader(ARRIVALS_LIST_LOADER, getArguments(), this).forceLoad();</span>
        }
<span class="nc" id="L178">    }</span>

    @Override
    public Loader&lt;ObaArrivalInfoResponse&gt; onCreateLoader(int id, Bundle args) {
        String stopId;
<span class="nc bnc" id="L183" title="All 2 branches missed.">        if (mObaStop == null) {</span>
<span class="nc" id="L184">            stopId = mBundleObaStopId;</span>
        } else {
<span class="nc" id="L186">            stopId = mObaStop.getId();</span>
        }
<span class="nc" id="L188">        return new ArrivalsListLoader(getActivity(), stopId);</span>
    }

    @Override
    public void onLoadFinished(Loader&lt;ObaArrivalInfoResponse&gt; loader, ObaArrivalInfoResponse data) {
        ObaArrivalInfo[] info;
<span class="nc bnc" id="L194" title="All 2 branches missed.">        if (data.getCode() == ObaApi.OBA_OK) {</span>
<span class="nc" id="L195">            info = data.getArrivalInfo();</span>
<span class="nc bnc" id="L196" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11133)) {</span>
<span class="nc bnc" id="L197" title="All 22 branches missed.">                if ((ListenerUtil.mutListener.listen(11130) ? (info.length &gt;= 0) : (ListenerUtil.mutListener.listen(11129) ? (info.length &lt;= 0) : (ListenerUtil.mutListener.listen(11128) ? (info.length &lt; 0) : (ListenerUtil.mutListener.listen(11127) ? (info.length != 0) : (ListenerUtil.mutListener.listen(11126) ? (info.length == 0) : (info.length &gt; 0))))))) {</span>
<span class="nc bnc" id="L198" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11132)) {</span>
<span class="nc" id="L199">                        loadArrivalList(info, data.getRefs(), data.getCurrentTime());</span>
                    }
                } else {
<span class="nc bnc" id="L202" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11131)) {</span>
<span class="nc" id="L203">                        showErrorText();</span>
                    }
                }
            }
        }
<span class="nc" id="L208">    }</span>

    private void showErrorText() {
<span class="nc" id="L211">        String text = getResources().getString(R.string.ri_no_trip);</span>
<span class="nc bnc" id="L212" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11134)) {</span>
<span class="nc" id="L213">            ((TextView) getActivity().findViewById(R.id.simple_arrival_info_text)).setText(text);</span>
        }
<span class="nc" id="L215">    }</span>

    private void loadArrivalList(ObaArrivalInfo[] info, final ObaReferences refs, long currentTime) {
<span class="nc" id="L218">        LinearLayout contentLayout = (LinearLayout) getActivity().findViewById(R.id.simple_arrival_content);</span>
<span class="nc bnc" id="L219" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11135)) {</span>
<span class="nc" id="L220">            contentLayout.removeAllViews();</span>
        }
<span class="nc" id="L222">        ArrayList&lt;ArrivalInfo&gt; arrivalInfos = ArrivalInfoUtils.convertObaArrivalInfo(getActivity(), info, new ArrayList&lt;String&gt;(), currentTime, false);</span>
<span class="nc bnc" id="L223" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11171)) {</span>
            {
<span class="nc" id="L225">                long _loopCounter149 = 0;</span>
<span class="nc bnc" id="L226" title="All 2 branches missed.">                for (ArrivalInfo stopInfo : arrivalInfos) {</span>
<span class="nc" id="L227">                    ListenerUtil.loopListener.listen(&quot;_loopCounter149&quot;, ++_loopCounter149);</span>
<span class="nc" id="L228">                    final ObaArrivalInfo arrivalInfo = stopInfo.getInfo();</span>
<span class="nc" id="L229">                    LayoutInflater inflater = LayoutInflater.from(getActivity());</span>
<span class="nc" id="L230">                    LinearLayout view = (LinearLayout) inflater.inflate(R.layout.arrivals_list_item, null, false);</span>
<span class="nc bnc" id="L231" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11136)) {</span>
<span class="nc" id="L232">                        view.setBackgroundColor(getResources().getColor(R.color.material_background));</span>
                    }
<span class="nc" id="L234">                    TextView route = (TextView) view.findViewById(R.id.route);</span>
<span class="nc" id="L235">                    TextView destination = (TextView) view.findViewById(R.id.destination);</span>
<span class="nc" id="L236">                    TextView time = (TextView) view.findViewById(R.id.time);</span>
<span class="nc" id="L237">                    TextView status = (TextView) view.findViewById(R.id.status);</span>
<span class="nc" id="L238">                    TextView etaView = (TextView) view.findViewById(R.id.eta);</span>
<span class="nc" id="L239">                    TextView minView = (TextView) view.findViewById(R.id.eta_min);</span>
<span class="nc" id="L240">                    ViewGroup realtimeView = (ViewGroup) view.findViewById(R.id.eta_realtime_indicator);</span>
<span class="nc" id="L241">                    ViewGroup occupancyView = view.findViewById(R.id.occupancy);</span>
<span class="nc bnc" id="L242" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11137)) {</span>
<span class="nc" id="L243">                        view.findViewById(R.id.more_horizontal).setVisibility(View.INVISIBLE);</span>
                    }
<span class="nc bnc" id="L245" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11138)) {</span>
<span class="nc" id="L246">                        view.findViewById(R.id.route_favorite).setVisibility(View.INVISIBLE);</span>
                    }
<span class="nc" id="L248">                    String routeShortName = arrivalInfo.getShortName();</span>
<span class="nc bnc" id="L249" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11139)) {</span>
<span class="nc" id="L250">                        route.setText(routeShortName.trim());</span>
                    }
<span class="nc bnc" id="L252" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11140)) {</span>
<span class="nc" id="L253">                        UIUtils.maybeShrinkRouteName(getActivity(), route, routeShortName.trim());</span>
                    }
<span class="nc bnc" id="L255" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11141)) {</span>
<span class="nc" id="L256">                        destination.setText(UIUtils.formatDisplayText(arrivalInfo.getHeadsign()));</span>
                    }
<span class="nc bnc" id="L258" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11142)) {</span>
<span class="nc" id="L259">                        status.setText(stopInfo.getStatusText());</span>
                    }
<span class="nc" id="L261">                    long eta = stopInfo.getEta();</span>
<span class="nc bnc" id="L262" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11152)) {</span>
<span class="nc bnc" id="L263" title="All 22 branches missed.">                        if ((ListenerUtil.mutListener.listen(11147) ? (eta &gt;= 0) : (ListenerUtil.mutListener.listen(11146) ? (eta &lt;= 0) : (ListenerUtil.mutListener.listen(11145) ? (eta &gt; 0) : (ListenerUtil.mutListener.listen(11144) ? (eta &lt; 0) : (ListenerUtil.mutListener.listen(11143) ? (eta != 0) : (eta == 0))))))) {</span>
<span class="nc bnc" id="L264" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11150)) {</span>
<span class="nc" id="L265">                                etaView.setText(R.string.stop_info_eta_now);</span>
                            }
<span class="nc bnc" id="L267" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11151)) {</span>
<span class="nc" id="L268">                                minView.setVisibility(View.GONE);</span>
                            }
                        } else {
<span class="nc bnc" id="L271" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11148)) {</span>
<span class="nc" id="L272">                                etaView.setText(String.valueOf(eta));</span>
                            }
<span class="nc bnc" id="L274" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11149)) {</span>
<span class="nc" id="L275">                                minView.setVisibility(View.VISIBLE);</span>
                            }
                        }
                    }
<span class="nc bnc" id="L279" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11153)) {</span>
<span class="nc" id="L280">                        status.setBackgroundResource(R.drawable.round_corners_style_b_status);</span>
                    }
<span class="nc" id="L282">                    GradientDrawable d = (GradientDrawable) status.getBackground();</span>
<span class="nc" id="L283">                    Integer colorCode = stopInfo.getColor();</span>
<span class="nc" id="L284">                    int color = getActivity().getResources().getColor(colorCode);</span>
<span class="nc bnc" id="L285" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11157)) {</span>
<span class="nc bnc" id="L286" title="All 2 branches missed.">                        if (stopInfo.getPredicted()) {</span>
<span class="nc bnc" id="L287" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11155)) {</span>
                                // Show real-time indicator
<span class="nc" id="L289">                                UIUtils.setRealtimeIndicatorColorByResourceCode(realtimeView, colorCode, android.R.color.transparent);</span>
                            }
<span class="nc bnc" id="L291" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11156)) {</span>
<span class="nc" id="L292">                                realtimeView.setVisibility(View.VISIBLE);</span>
                            }
                        } else {
<span class="nc bnc" id="L295" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11154)) {</span>
<span class="nc" id="L296">                                realtimeView.setVisibility(View.INVISIBLE);</span>
                            }
                        }
                    }
<span class="nc bnc" id="L300" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11158)) {</span>
<span class="nc" id="L301">                        etaView.setTextColor(color);</span>
                    }
<span class="nc bnc" id="L303" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11159)) {</span>
<span class="nc" id="L304">                        minView.setTextColor(color);</span>
                    }
<span class="nc bnc" id="L306" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11160)) {</span>
<span class="nc" id="L307">                        d.setColor(color);</span>
                    }
                    // Set padding on status view
<span class="nc" id="L310">                    int pSides = UIUtils.dpToPixels(getActivity(), 5);</span>
<span class="nc" id="L311">                    int pTopBottom = UIUtils.dpToPixels(getActivity(), 2);</span>
<span class="nc bnc" id="L312" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11161)) {</span>
<span class="nc" id="L313">                        status.setPadding(pSides, pTopBottom, pSides, pTopBottom);</span>
                    }
<span class="nc bnc" id="L315" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11162)) {</span>
<span class="nc" id="L316">                        time.setText(DateUtils.formatDateTime(getActivity(), stopInfo.getDisplayTime(), DateUtils.FORMAT_SHOW_TIME | DateUtils.FORMAT_NO_NOON | DateUtils.FORMAT_NO_MIDNIGHT));</span>
                    }
<span class="nc bnc" id="L318" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11167)) {</span>
                        // Occupancy
<span class="nc bnc" id="L320" title="All 2 branches missed.">                        if (stopInfo.getPredictedOccupancy() != null) {</span>
<span class="nc bnc" id="L321" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11165)) {</span>
                                // Predicted occupancy data
<span class="nc" id="L323">                                UIUtils.setOccupancyVisibilityAndColor(occupancyView, stopInfo.getPredictedOccupancy(), OccupancyState.PREDICTED);</span>
                            }
<span class="nc bnc" id="L325" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11166)) {</span>
<span class="nc" id="L326">                                UIUtils.setOccupancyContentDescription(occupancyView, stopInfo.getPredictedOccupancy(), OccupancyState.PREDICTED);</span>
                            }
                        } else {
<span class="nc bnc" id="L329" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11163)) {</span>
                                // Historical occupancy data
<span class="nc" id="L331">                                UIUtils.setOccupancyVisibilityAndColor(occupancyView, stopInfo.getHistoricalOccupancy(), OccupancyState.HISTORICAL);</span>
                            }
<span class="nc bnc" id="L333" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11164)) {</span>
<span class="nc" id="L334">                                UIUtils.setOccupancyContentDescription(occupancyView, stopInfo.getHistoricalOccupancy(), OccupancyState.HISTORICAL);</span>
                            }
                        }
                    }
<span class="nc" id="L338">                    View reminder = view.findViewById(R.id.reminder);</span>
<span class="nc bnc" id="L339" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11168)) {</span>
<span class="nc" id="L340">                        reminder.setVisibility(View.GONE);</span>
                    }
<span class="nc bnc" id="L342" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11169)) {</span>
<span class="nc" id="L343">                        contentLayout.addView(view);</span>
                    }
<span class="nc bnc" id="L345" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11170)) {</span>
<span class="nc" id="L346">                        view.setOnClickListener(view1 -&gt; {</span>
<span class="nc" id="L347">                            String agencyName = findAgencyNameByRouteId(refs, arrivalInfo.getRouteId());</span>
<span class="nc" id="L348">                            String blockId = findBlockIdByTripId(refs, arrivalInfo.getTripId());</span>
<span class="nc" id="L349">                            mCallback.onArrivalItemClicked(arrivalInfo, agencyName, blockId);</span>
<span class="nc" id="L350">                        });</span>
                    }
<span class="nc" id="L352">                }</span>
            }
        }
<span class="nc" id="L355">    }</span>

    private String findAgencyNameByRouteId(ObaReferences refs, String routeId) {
<span class="nc" id="L358">        String agencyId = refs.getRoute(routeId).getAgencyId();</span>
<span class="nc" id="L359">        return refs.getAgency(agencyId).getId();</span>
    }

    private String findBlockIdByTripId(ObaReferences refs, String tripId) {
<span class="nc" id="L363">        ObaTrip trip = refs.getTrip(tripId);</span>
<span class="nc" id="L364">        return trip.getBlockId();</span>
    }

    @Override
    public void onLoaderReset(Loader&lt;ObaArrivalInfoResponse&gt; loader) {
<span class="nc" id="L369">    }</span>

    @SuppressWarnings(&quot;unused&quot;)
    private ArrivalsListLoader getArrivalsLoader() {
<span class="nc bnc" id="L373" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11172)) {</span>
            // If the Fragment hasn't been attached to an Activity yet, return null
<span class="nc bnc" id="L375" title="All 2 branches missed.">            if (!isAdded()) {</span>
<span class="nc" id="L376">                return null;</span>
            }
        }
<span class="nc" id="L379">        Loader&lt;ObaArrivalInfoResponse&gt; l = getLoaderManager().getLoader(ARRIVALS_LIST_LOADER);</span>
<span class="nc" id="L380">        return (ArrivalsListLoader) l;</span>
    }

    public void setCallback(Callback callback) {
<span class="nc bnc" id="L384" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11173)) {</span>
<span class="nc" id="L385">            mCallback = callback;</span>
        }
<span class="nc" id="L387">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span>Generated by the Android Gradle plugin 8.2.0</div></body></html>