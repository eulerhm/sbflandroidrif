<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>TripInfoActivity.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">agencyXGoogleDebug</a> &gt; <a href="index.source.html" class="el_package">org.onebusaway.android.ui</a> &gt; <span class="el_source">TripInfoActivity.java</span></div><h1>TripInfoActivity.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2011-2015 Paul Watts (paulcwatts@gmail.com), University of South Florida
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.onebusaway.android.ui;

import android.app.AlertDialog;
import android.app.Dialog;
import android.content.ContentResolver;
import android.content.ContentValues;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.content.res.Resources;
import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.text.format.DateUtils;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.Spinner;
import android.widget.TextView;
import android.widget.Toast;
import org.onebusaway.android.R;
import org.onebusaway.android.provider.ObaContract;
import org.onebusaway.android.tripservice.TripService;
import org.onebusaway.android.util.FragmentUtils;
import org.onebusaway.android.util.PreferenceUtils;
import org.onebusaway.android.util.UIUtils;
import java.util.List;
import androidx.appcompat.app.AppCompatActivity;
import androidx.fragment.app.DialogFragment;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.loader.app.LoaderManager;
import androidx.loader.content.CursorLoader;
import androidx.loader.content.Loader;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

<span class="nc" id="L58">public class TripInfoActivity extends AppCompatActivity {</span>

    private static final String TAG = &quot;TripInfoActivity&quot;;

    private static final String ROUTE_ID = &quot;.RouteId&quot;;

    private static final String ROUTE_NAME = &quot;.RouteName&quot;;

    private static final String STOP_NAME = &quot;.StopName&quot;;

    private static final String HEADSIGN = &quot;.Headsign&quot;;

    private static final String DEPARTURE_TIME = &quot;.Depart&quot;;

    // Save/restore values
    private static final String TRIP_NAME = &quot;.TripName&quot;;

    private static final String REMINDER_TIME = &quot;.ReminderTime&quot;;

    private static final String REMINDER_DAYS = &quot;.ReminderDays&quot;;

    public static void start(Context context, String tripId, String stopId) {
<span class="nc" id="L80">        Intent myIntent = new Intent(context, TripInfoActivity.class);</span>
<span class="nc bnc" id="L81" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1941)) {</span>
<span class="nc" id="L82">            myIntent.setData(ObaContract.Trips.buildUri(tripId, stopId));</span>
        }
<span class="nc bnc" id="L84" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1942)) {</span>
<span class="nc" id="L85">            context.startActivity(myIntent);</span>
        }
<span class="nc" id="L87">    }</span>

    public static void start(Context context, String tripId, String stopId, String routeId, String routeName, String stopName, long departureTime, String headsign) {
<span class="nc" id="L90">        Intent myIntent = new Intent(context, TripInfoActivity.class);</span>
<span class="nc bnc" id="L91" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1943)) {</span>
<span class="nc" id="L92">            myIntent.setData(ObaContract.Trips.buildUri(tripId, stopId));</span>
        }
<span class="nc bnc" id="L94" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1944)) {</span>
<span class="nc" id="L95">            myIntent.putExtra(ROUTE_ID, routeId);</span>
        }
<span class="nc bnc" id="L97" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1945)) {</span>
<span class="nc" id="L98">            myIntent.putExtra(ROUTE_NAME, routeName);</span>
        }
<span class="nc bnc" id="L100" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1946)) {</span>
<span class="nc" id="L101">            myIntent.putExtra(STOP_NAME, stopName);</span>
        }
<span class="nc bnc" id="L103" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1947)) {</span>
<span class="nc" id="L104">            myIntent.putExtra(DEPARTURE_TIME, departureTime);</span>
        }
<span class="nc bnc" id="L106" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1948)) {</span>
<span class="nc" id="L107">            myIntent.putExtra(HEADSIGN, headsign);</span>
        }
<span class="nc bnc" id="L109" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1949)) {</span>
<span class="nc" id="L110">            context.startActivity(myIntent);</span>
        }
<span class="nc" id="L112">    }</span>

    @Override
    public void onCreate(Bundle savedInstanceState) {
<span class="nc bnc" id="L116" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1950)) {</span>
<span class="nc" id="L117">            super.onCreate(savedInstanceState);</span>
        }
<span class="nc bnc" id="L119" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1951)) {</span>
<span class="nc" id="L120">            UIUtils.setupActionBar(this);</span>
        }
<span class="nc" id="L122">        FragmentManager fm = getSupportFragmentManager();</span>
<span class="nc bnc" id="L123" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1954)) {</span>
            // Create the list fragment and add it as our sole content.
<span class="nc bnc" id="L125" title="All 2 branches missed.">            if (fm.findFragmentById(android.R.id.content) == null) {</span>
<span class="nc" id="L126">                TripInfoFragment content = new TripInfoFragment();</span>
<span class="nc bnc" id="L127" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1952)) {</span>
<span class="nc" id="L128">                    content.setArguments(FragmentUtils.getIntentArgs(getIntent()));</span>
                }
<span class="nc bnc" id="L130" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1953)) {</span>
<span class="nc" id="L131">                    fm.beginTransaction().add(android.R.id.content, content).commit();</span>
                }
            }
        }
<span class="nc" id="L135">    }</span>

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
<span class="nc bnc" id="L139" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1956)) {</span>
<span class="nc bnc" id="L140" title="All 2 branches missed.">            if (item.getItemId() == android.R.id.home) {</span>
<span class="nc bnc" id="L141" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1955)) {</span>
                    // go up from here.
<span class="nc" id="L143">                    finish();</span>
                }
<span class="nc" id="L145">                return true;</span>
            }
        }
<span class="nc" id="L148">        return false;</span>
    }

    TripInfoFragment getTripInfoFragment() {
<span class="nc" id="L152">        FragmentManager fm = getSupportFragmentManager();</span>
<span class="nc" id="L153">        return (TripInfoFragment) fm.findFragmentById(android.R.id.content);</span>
    }

<span class="nc" id="L156">    public static final class TripInfoFragment extends Fragment implements LoaderManager.LoaderCallbacks&lt;Cursor&gt; {</span>

        private static final String TAG_DELETE_DIALOG = &quot;.DeleteDialog&quot;;

<span class="nc" id="L160">        private static final String[] PROJECTION = { ObaContract.Trips.NAME, ObaContract.Trips.REMINDER, ObaContract.Trips.DAYS, ObaContract.Trips.ROUTE_ID, ObaContract.Trips.HEADSIGN, ObaContract.Trips.DEPARTURE };</span>

        private static final int COL_NAME = 0;

        private static final int COL_REMINDER = 1;

        private static final int COL_DAYS = 2;

        private static final int COL_ROUTE_ID = 3;

        private static final int COL_HEADSIGN = 4;

        private static final int COL_DEPARTURE = 5;

        private Uri mTripUri;

        private String mTripId;

        private String mRouteId;

        private String mRouteName;

        private String mStopId;

        private String mStopName;

        private String mHeadsign;

        private String mTripName;

        private long mDepartTime;

        // DB Value, not selection value
        private int mReminderTime;

        private int mReminderDays;

<span class="nc" id="L197">        private boolean mNewTrip = true;</span>

        @Override
        public void onActivityCreated(Bundle savedInstanceState) {
<span class="nc bnc" id="L201" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1957)) {</span>
<span class="nc" id="L202">                super.onActivityCreated(savedInstanceState);</span>
            }
<span class="nc bnc" id="L204" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1958)) {</span>
<span class="nc" id="L205">                setHasOptionsMenu(true);</span>
            }
<span class="nc bnc" id="L207" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1963)) {</span>
<span class="nc bnc" id="L208" title="All 2 branches missed.">                if (savedInstanceState != null) {</span>
<span class="nc bnc" id="L209" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(1961)) {</span>
<span class="nc" id="L210">                        initFromBundle(savedInstanceState);</span>
                    }
<span class="nc bnc" id="L212" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(1962)) {</span>
<span class="nc" id="L213">                        initForm();</span>
                    }
<span class="nc bnc" id="L215" title="All 2 branches missed.">                } else if (initFromBundle(getArguments())) {</span>
<span class="nc bnc" id="L216" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(1960)) {</span>
<span class="nc" id="L217">                        getLoaderManager().initLoader(0, null, this);</span>
                    }
                } else {
<span class="nc bnc" id="L220" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(1959)) {</span>
<span class="nc" id="L221">                        Log.e(TAG, &quot;Information missing from intent&quot;);</span>
                    }
<span class="nc" id="L223">                    return;</span>
                }
            }
<span class="nc" id="L226">        }</span>

        @Override
        public View onCreateView(LayoutInflater inflater, ViewGroup root, Bundle savedInstanceState) {
<span class="nc bnc" id="L230" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1964)) {</span>
<span class="nc bnc" id="L231" title="All 2 branches missed.">                if (root == null) {</span>
                    // reason to create our view.
<span class="nc" id="L233">                    return null;</span>
                }
            }
<span class="nc" id="L236">            return inflater.inflate(R.layout.trip_info, null);</span>
        }

        @Override
        public Loader&lt;Cursor&gt; onCreateLoader(int id, Bundle args) {
<span class="nc" id="L241">            return new CursorLoader(getActivity(), mTripUri, PROJECTION, null, null, null);</span>
        }

        @Override
        public void onLoadFinished(Loader&lt;Cursor&gt; loader, Cursor data) {
<span class="nc bnc" id="L246" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1965)) {</span>
<span class="nc bnc" id="L247" title="All 2 branches missed.">                mNewTrip = !initFromCursor(data);</span>
            }
<span class="nc bnc" id="L249" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1966)) {</span>
<span class="nc" id="L250">                initForm();</span>
            }
<span class="nc bnc" id="L252" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1967)) {</span>
<span class="nc" id="L253">                getActivity().supportInvalidateOptionsMenu();</span>
            }
<span class="nc" id="L255">        }</span>

        @Override
        public void onLoaderReset(Loader&lt;Cursor&gt; loader) {
<span class="nc" id="L259">        }</span>

        private boolean initFromBundle(Bundle bundle) {
<span class="nc" id="L262">            final Uri data = bundle.getParcelable(FragmentUtils.URI);</span>
<span class="nc bnc" id="L263" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1968)) {</span>
<span class="nc bnc" id="L264" title="All 2 branches missed.">                if (data == null) {</span>
<span class="nc" id="L265">                    return false;</span>
                }
            }
<span class="nc" id="L268">            List&lt;String&gt; segments = data.getPathSegments();</span>
<span class="nc bnc" id="L269" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1969)) {</span>
<span class="nc" id="L270">                mTripId = segments.get(1);</span>
            }
<span class="nc bnc" id="L272" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1970)) {</span>
<span class="nc" id="L273">                mStopId = segments.get(2);</span>
            }
<span class="nc bnc" id="L275" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1971)) {</span>
<span class="nc" id="L276">                mTripUri = data;</span>
            }
<span class="nc bnc" id="L278" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1973)) {</span>
<span class="nc bnc" id="L279" title="All 10 branches missed.">                if ((ListenerUtil.mutListener.listen(1972) ? (mTripId == null &amp;&amp; mStopId == null) : (mTripId == null || mStopId == null))) {</span>
<span class="nc" id="L280">                    return false;</span>
                }
            }
<span class="nc bnc" id="L283" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1974)) {</span>
<span class="nc" id="L284">                mRouteId = bundle.getString(ROUTE_ID);</span>
            }
<span class="nc bnc" id="L286" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1975)) {</span>
<span class="nc" id="L287">                mHeadsign = bundle.getString(HEADSIGN);</span>
            }
<span class="nc bnc" id="L289" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1976)) {</span>
<span class="nc" id="L290">                mDepartTime = bundle.getLong(DEPARTURE_TIME);</span>
            }
<span class="nc bnc" id="L292" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1977)) {</span>
<span class="nc" id="L293">                mStopName = bundle.getString(STOP_NAME);</span>
            }
<span class="nc bnc" id="L295" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1978)) {</span>
<span class="nc" id="L296">                mRouteName = bundle.getString(ROUTE_NAME);</span>
            }
<span class="nc bnc" id="L298" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1981)) {</span>
                // If we get this, update it in the DB.
<span class="nc bnc" id="L300" title="All 2 branches missed.">                if (mRouteName != null) {</span>
<span class="nc" id="L301">                    ContentValues values = new ContentValues();</span>
<span class="nc bnc" id="L302" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(1979)) {</span>
<span class="nc" id="L303">                        values.put(ObaContract.Routes.SHORTNAME, mRouteName);</span>
                    }
<span class="nc bnc" id="L305" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(1980)) {</span>
<span class="nc" id="L306">                        ObaContract.Routes.insertOrUpdate(getActivity(), mRouteId, values, false);</span>
                    }
                }
            }
<span class="nc" id="L310">            String name = bundle.getString(TRIP_NAME);</span>
<span class="nc bnc" id="L311" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1983)) {</span>
<span class="nc bnc" id="L312" title="All 2 branches missed.">                if (name != null) {</span>
<span class="nc bnc" id="L313" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(1982)) {</span>
<span class="nc" id="L314">                        mTripName = name;</span>
                    }
                }
            }
<span class="nc bnc" id="L318" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1984)) {</span>
<span class="nc" id="L319">                mReminderTime = bundle.getInt(REMINDER_TIME, mReminderTime);</span>
            }
<span class="nc bnc" id="L321" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1985)) {</span>
<span class="nc" id="L322">                mReminderDays = bundle.getInt(REMINDER_DAYS, mReminderDays);</span>
            }
<span class="nc" id="L324">            return true;</span>
        }

        private boolean initFromCursor(Cursor cursor) {
<span class="nc bnc" id="L328" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1993)) {</span>
<span class="nc bnc" id="L329" title="All 50 branches missed.">                if ((ListenerUtil.mutListener.listen(1991) ? (cursor == null &amp;&amp; (ListenerUtil.mutListener.listen(1990) ? (cursor.getCount() &gt;= 1) : (ListenerUtil.mutListener.listen(1989) ? (cursor.getCount() &lt;= 1) : (ListenerUtil.mutListener.listen(1988) ? (cursor.getCount() &gt; 1) : (ListenerUtil.mutListener.listen(1987) ? (cursor.getCount() != 1) : (ListenerUtil.mutListener.listen(1986) ? (cursor.getCount() == 1) : (cursor.getCount() &lt; 1))))))) : (cursor == null || (ListenerUtil.mutListener.listen(1990) ? (cursor.getCount() &gt;= 1) : (ListenerUtil.mutListener.listen(1989) ? (cursor.getCount() &lt;= 1) : (ListenerUtil.mutListener.listen(1988) ? (cursor.getCount() &gt; 1) : (ListenerUtil.mutListener.listen(1987) ? (cursor.getCount() != 1) : (ListenerUtil.mutListener.listen(1986) ? (cursor.getCount() == 1) : (cursor.getCount() &lt; 1))))))))) {</span>
<span class="nc bnc" id="L330" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(1992)) {</span>
                        // Reminder defaults to 10 in the UI
<span class="nc" id="L332">                        mReminderTime = PreferenceUtils.getInt(getString(R.string.preference_key_default_reminder_time), 10);</span>
                    }
<span class="nc" id="L334">                    return false;</span>
                }
            }
<span class="nc bnc" id="L337" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1994)) {</span>
<span class="nc" id="L338">                cursor.moveToFirst();</span>
            }
<span class="nc bnc" id="L340" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1995)) {</span>
<span class="nc" id="L341">                mTripName = cursor.getString(COL_NAME);</span>
            }
<span class="nc bnc" id="L343" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1996)) {</span>
<span class="nc" id="L344">                mReminderTime = cursor.getInt(COL_REMINDER);</span>
            }
<span class="nc bnc" id="L346" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1997)) {</span>
<span class="nc" id="L347">                mReminderDays = cursor.getInt(COL_DAYS);</span>
            }
<span class="nc bnc" id="L349" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(1999)) {</span>
                // values in the db.
<span class="nc bnc" id="L351" title="All 2 branches missed.">                if (mRouteId == null) {</span>
<span class="nc bnc" id="L352" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(1998)) {</span>
<span class="nc" id="L353">                        mRouteId = cursor.getString(COL_ROUTE_ID);</span>
                    }
                }
            }
<span class="nc bnc" id="L357" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2001)) {</span>
<span class="nc bnc" id="L358" title="All 2 branches missed.">                if (mHeadsign == null) {</span>
<span class="nc bnc" id="L359" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2000)) {</span>
<span class="nc" id="L360">                        mHeadsign = cursor.getString(COL_HEADSIGN);</span>
                    }
                }
            }
<span class="nc bnc" id="L364" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2008)) {</span>
<span class="nc bnc" id="L365" title="All 22 branches missed.">                if ((ListenerUtil.mutListener.listen(2006) ? (mDepartTime &gt;= 0) : (ListenerUtil.mutListener.listen(2005) ? (mDepartTime &lt;= 0) : (ListenerUtil.mutListener.listen(2004) ? (mDepartTime &gt; 0) : (ListenerUtil.mutListener.listen(2003) ? (mDepartTime &lt; 0) : (ListenerUtil.mutListener.listen(2002) ? (mDepartTime != 0) : (mDepartTime == 0))))))) {</span>
<span class="nc bnc" id="L366" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2007)) {</span>
<span class="nc" id="L367">                        mDepartTime = ObaContract.Trips.convertDBToTime(cursor.getInt(COL_DEPARTURE));</span>
                    }
                }
            }
<span class="nc bnc" id="L371" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2010)) {</span>
                // If we don't have the route name, look it up in the DB
<span class="nc bnc" id="L373" title="All 2 branches missed.">                if (mRouteName == null) {</span>
<span class="nc bnc" id="L374" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2009)) {</span>
<span class="nc" id="L375">                        mRouteName = TripService.getRouteShortName(getActivity(), mRouteId);</span>
                    }
                }
            }
<span class="nc bnc" id="L379" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2012)) {</span>
<span class="nc bnc" id="L380" title="All 2 branches missed.">                if (mStopName == null) {</span>
<span class="nc bnc" id="L381" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2011)) {</span>
<span class="nc" id="L382">                        mStopName = UIUtils.stringForQuery(getActivity(), Uri.withAppendedPath(ObaContract.Stops.CONTENT_URI, mStopId), ObaContract.Stops.NAME);</span>
                    }
                }
            }
<span class="nc" id="L386">            return true;</span>
        }

        private void initForm() {
<span class="nc" id="L390">            View view = getView();</span>
<span class="nc" id="L391">            final Spinner reminder = (Spinner) view.findViewById(R.id.trip_info_reminder_time);</span>
<span class="nc" id="L392">            ArrayAdapter&lt;?&gt; adapter = ArrayAdapter.createFromResource(getActivity(), R.array.reminder_time, android.R.layout.simple_spinner_item);</span>
<span class="nc bnc" id="L393" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2013)) {</span>
<span class="nc" id="L394">                adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);</span>
            }
<span class="nc bnc" id="L396" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2014)) {</span>
<span class="nc" id="L397">                reminder.setAdapter(adapter);</span>
            }
            // 
<span class="nc" id="L400">            final TextView stopName = (TextView) view.findViewById(R.id.stop_name);</span>
<span class="nc bnc" id="L401" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2015)) {</span>
<span class="nc" id="L402">                stopName.setText(UIUtils.formatDisplayText(mStopName));</span>
            }
<span class="nc" id="L404">            final TextView routeName = (TextView) view.findViewById(R.id.route_name);</span>
<span class="nc bnc" id="L405" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2016)) {</span>
<span class="nc" id="L406">                routeName.setText(UIUtils.formatDisplayText(getString(R.string.trip_info_route, mRouteName)));</span>
            }
<span class="nc" id="L408">            final TextView headsign = (TextView) view.findViewById(R.id.headsign);</span>
<span class="nc bnc" id="L409" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2017)) {</span>
<span class="nc" id="L410">                headsign.setText(UIUtils.formatDisplayText(mHeadsign));</span>
            }
<span class="nc" id="L412">            final TextView departText = (TextView) view.findViewById(R.id.departure_time);</span>
<span class="nc bnc" id="L413" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2018)) {</span>
<span class="nc" id="L414">                departText.setText(getDepartureTime(getActivity(), mDepartTime));</span>
            }
<span class="nc" id="L416">            final TextView tripName = (TextView) view.findViewById(R.id.name);</span>
<span class="nc bnc" id="L417" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2019)) {</span>
<span class="nc" id="L418">                tripName.setText(mTripName);</span>
            }
<span class="nc bnc" id="L420" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2020)) {</span>
<span class="nc" id="L421">                reminder.setSelection(reminderToSelection(mReminderTime));</span>
            }
<span class="nc" id="L423">            final Button repeats = (Button) view.findViewById(R.id.trip_info_reminder_days);</span>
<span class="nc bnc" id="L424" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2021)) {</span>
<span class="nc" id="L425">                repeats.setText(getRepeatText(getActivity(), mReminderDays));</span>
            }
<span class="nc bnc" id="L427" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2023)) {</span>
                // 
<span class="nc" id="L429">                repeats.setOnClickListener(new View.OnClickListener() {</span>

                    public void onClick(View v) {
<span class="nc bnc" id="L432" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2022)) {</span>
<span class="nc" id="L433">                            showReminderDaysDialog();</span>
                        }
<span class="nc" id="L435">                    }</span>
                });
            }
<span class="nc" id="L438">        }</span>

        void finish() {
<span class="nc bnc" id="L441" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2024)) {</span>
                // But for now, the retains original, pre-fragment functionality.
<span class="nc" id="L443">                getActivity().finish();</span>
            }
<span class="nc" id="L445">        }</span>

        @Override
        public void onSaveInstanceState(Bundle outState) {
<span class="nc bnc" id="L449" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2025)) {</span>
<span class="nc" id="L450">                super.onSaveInstanceState(outState);</span>
            }
<span class="nc bnc" id="L452" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2026)) {</span>
<span class="nc" id="L453">                outState.putParcelable(FragmentUtils.URI, mTripUri);</span>
            }
<span class="nc bnc" id="L455" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2027)) {</span>
<span class="nc" id="L456">                outState.putString(ROUTE_ID, mRouteId);</span>
            }
<span class="nc bnc" id="L458" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2028)) {</span>
<span class="nc" id="L459">                outState.putString(ROUTE_NAME, mRouteName);</span>
            }
<span class="nc bnc" id="L461" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2029)) {</span>
<span class="nc" id="L462">                outState.putString(STOP_NAME, mStopName);</span>
            }
<span class="nc bnc" id="L464" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2030)) {</span>
<span class="nc" id="L465">                outState.putString(HEADSIGN, mHeadsign);</span>
            }
<span class="nc bnc" id="L467" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2031)) {</span>
<span class="nc" id="L468">                outState.putLong(DEPARTURE_TIME, mDepartTime);</span>
            }
<span class="nc" id="L470">            View view = getView();</span>
<span class="nc" id="L471">            Spinner reminderView = (Spinner) view.findViewById(R.id.trip_info_reminder_time);</span>
<span class="nc" id="L472">            TextView nameView = (TextView) view.findViewById(R.id.name);</span>
<span class="nc" id="L473">            final int reminder = selectionToReminder(reminderView.getSelectedItemPosition());</span>
<span class="nc bnc" id="L474" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2032)) {</span>
<span class="nc" id="L475">                outState.putString(TRIP_NAME, nameView.getText().toString());</span>
            }
<span class="nc bnc" id="L477" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2033)) {</span>
<span class="nc" id="L478">                outState.putInt(REMINDER_TIME, reminder);</span>
            }
<span class="nc bnc" id="L480" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2034)) {</span>
<span class="nc" id="L481">                outState.putInt(REMINDER_DAYS, mReminderDays);</span>
            }
<span class="nc" id="L483">        }</span>

        @Override
        public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {
<span class="nc bnc" id="L487" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2035)) {</span>
<span class="nc" id="L488">                inflater.inflate(R.menu.trip_info_options, menu);</span>
            }
<span class="nc" id="L490">        }</span>

        @Override
        public void onPrepareOptionsMenu(Menu menu) {
<span class="nc bnc" id="L494" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2036)) {</span>
<span class="nc bnc" id="L495" title="All 2 branches missed.">                menu.findItem(R.id.trip_info_delete).setVisible(!mNewTrip);</span>
            }
<span class="nc" id="L497">        }</span>

        @Override
        public boolean onOptionsItemSelected(MenuItem item) {
<span class="nc" id="L501">            int id = item.getItemId();</span>
<span class="nc bnc" id="L502" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2043)) {</span>
<span class="nc bnc" id="L503" title="All 2 branches missed.">                if (id == R.id.trip_info_save) {</span>
<span class="nc bnc" id="L504" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2042)) {</span>
<span class="nc" id="L505">                        saveTrip();</span>
                    }
<span class="nc bnc" id="L507" title="All 2 branches missed.">                } else if (id == R.id.trip_info_delete) {</span>
<span class="nc" id="L508">                    Bundle args = new Bundle();</span>
<span class="nc bnc" id="L509" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2039)) {</span>
<span class="nc" id="L510">                        args.putParcelable(&quot;uri&quot;, mTripUri);</span>
                    }
<span class="nc" id="L512">                    DeleteDialog dialog = new DeleteDialog();</span>
<span class="nc bnc" id="L513" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2040)) {</span>
<span class="nc" id="L514">                        dialog.setArguments(args);</span>
                    }
<span class="nc bnc" id="L516" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2041)) {</span>
<span class="nc" id="L517">                        dialog.show(getActivity().getSupportFragmentManager(), TAG_DELETE_DIALOG);</span>
                    }
<span class="nc bnc" id="L519" title="All 2 branches missed.">                } else if (id == R.id.show_route) {</span>
<span class="nc bnc" id="L520" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2038)) {</span>
<span class="nc" id="L521">                        RouteInfoActivity.start(getActivity(), mRouteId);</span>
                    }
<span class="nc" id="L523">                    return true;</span>
<span class="nc bnc" id="L524" title="All 2 branches missed.">                } else if (id == R.id.show_stop) {</span>
<span class="nc bnc" id="L525" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2037)) {</span>
<span class="nc" id="L526">                        new ArrivalsListActivity.Builder(getActivity(), mStopId).setStopName(mStopName).start();</span>
                    }
<span class="nc" id="L528">                    return true;</span>
                }
            }
<span class="nc" id="L531">            return false;</span>
        }

        public void saveTrip() {
            // 
<span class="nc" id="L536">            View view = getView();</span>
<span class="nc" id="L537">            final Spinner reminderView = (Spinner) view.findViewById(R.id.trip_info_reminder_time);</span>
<span class="nc" id="L538">            final TextView nameView = (TextView) view.findViewById(R.id.name);</span>
<span class="nc" id="L539">            final int reminder = selectionToReminder(reminderView.getSelectedItemPosition());</span>
<span class="nc" id="L540">            ContentValues values = new ContentValues();</span>
<span class="nc bnc" id="L541" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2044)) {</span>
<span class="nc" id="L542">                values.put(ObaContract.Trips.ROUTE_ID, mRouteId);</span>
            }
<span class="nc bnc" id="L544" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2045)) {</span>
<span class="nc" id="L545">                values.put(ObaContract.Trips.DEPARTURE, ObaContract.Trips.convertTimeToDB(mDepartTime));</span>
            }
<span class="nc bnc" id="L547" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2046)) {</span>
<span class="nc" id="L548">                values.put(ObaContract.Trips.HEADSIGN, mHeadsign);</span>
            }
<span class="nc bnc" id="L550" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2047)) {</span>
<span class="nc" id="L551">                values.put(ObaContract.Trips.NAME, nameView.getText().toString());</span>
            }
<span class="nc bnc" id="L553" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2048)) {</span>
<span class="nc" id="L554">                values.put(ObaContract.Trips.REMINDER, reminder);</span>
            }
<span class="nc bnc" id="L556" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2049)) {</span>
<span class="nc" id="L557">                values.put(ObaContract.Trips.DAYS, mReminderDays);</span>
            }
            // Insert or update?
<span class="nc" id="L560">            ContentResolver cr = getActivity().getContentResolver();</span>
<span class="nc" id="L561">            Cursor c = cr.query(mTripUri, new String[] { ObaContract.Trips._ID }, null, null, null);</span>
<span class="nc bnc" id="L562" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2060)) {</span>
<span class="nc bnc" id="L563" title="All 50 branches missed.">                if ((ListenerUtil.mutListener.listen(2055) ? (c != null || (ListenerUtil.mutListener.listen(2054) ? (c.getCount() &gt;= 0) : (ListenerUtil.mutListener.listen(2053) ? (c.getCount() &lt;= 0) : (ListenerUtil.mutListener.listen(2052) ? (c.getCount() &lt; 0) : (ListenerUtil.mutListener.listen(2051) ? (c.getCount() != 0) : (ListenerUtil.mutListener.listen(2050) ? (c.getCount() == 0) : (c.getCount() &gt; 0))))))) : (c != null &amp;&amp; (ListenerUtil.mutListener.listen(2054) ? (c.getCount() &gt;= 0) : (ListenerUtil.mutListener.listen(2053) ? (c.getCount() &lt;= 0) : (ListenerUtil.mutListener.listen(2052) ? (c.getCount() &lt; 0) : (ListenerUtil.mutListener.listen(2051) ? (c.getCount() != 0) : (ListenerUtil.mutListener.listen(2050) ? (c.getCount() == 0) : (c.getCount() &gt; 0))))))))) {</span>
<span class="nc bnc" id="L564" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2059)) {</span>
                        // Update
<span class="nc" id="L566">                        cr.update(mTripUri, values, null, null);</span>
                    }
                } else {
<span class="nc bnc" id="L569" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2056)) {</span>
<span class="nc" id="L570">                        values.put(ObaContract.Trips._ID, mTripId);</span>
                    }
<span class="nc bnc" id="L572" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2057)) {</span>
<span class="nc" id="L573">                        values.put(ObaContract.Trips.STOP_ID, mStopId);</span>
                    }
<span class="nc bnc" id="L575" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2058)) {</span>
<span class="nc" id="L576">                        cr.insert(ObaContract.Trips.CONTENT_URI, values);</span>
                    }
                }
            }
<span class="nc bnc" id="L580" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2062)) {</span>
<span class="nc bnc" id="L581" title="All 2 branches missed.">                if (c != null) {</span>
<span class="nc bnc" id="L582" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2061)) {</span>
<span class="nc" id="L583">                        c.close();</span>
                    }
                }
            }
<span class="nc bnc" id="L587" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2063)) {</span>
<span class="nc" id="L588">                TripService.scheduleAll(getActivity(), true);</span>
            }
<span class="nc bnc" id="L590" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2064)) {</span>
<span class="nc" id="L591">                PreferenceUtils.saveInt(getString(R.string.preference_key_default_reminder_time), reminder);</span>
            }
<span class="nc bnc" id="L593" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2065)) {</span>
<span class="nc" id="L594">                Toast.makeText(getActivity(), R.string.trip_info_saved, Toast.LENGTH_SHORT).show();</span>
            }
<span class="nc bnc" id="L596" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2066)) {</span>
<span class="nc" id="L597">                finish();</span>
            }
<span class="nc" id="L599">        }</span>

        void showReminderDaysDialog() {
<span class="nc" id="L602">            final boolean[] checks = ObaContract.Trips.daysToArray(mReminderDays);</span>
<span class="nc" id="L603">            Bundle args = new Bundle();</span>
<span class="nc bnc" id="L604" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2067)) {</span>
<span class="nc" id="L605">                args.putBooleanArray(ReminderDaysDialog.CHECKS, checks);</span>
            }
<span class="nc" id="L607">            ReminderDaysDialog frag = new ReminderDaysDialog();</span>
<span class="nc bnc" id="L608" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2068)) {</span>
<span class="nc" id="L609">                frag.setArguments(args);</span>
            }
<span class="nc bnc" id="L611" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2069)) {</span>
<span class="nc" id="L612">                frag.show(getActivity().getSupportFragmentManager(), &quot;.ReminderDaysDialog&quot;);</span>
            }
<span class="nc" id="L614">        }</span>

<span class="nc" id="L616">        public static class ReminderDaysDialog extends DialogFragment implements DialogInterface.OnMultiChoiceClickListener, DialogInterface.OnClickListener {</span>

            static final String CHECKS = &quot;.checks&quot;;

            private boolean[] mChecks;

            @Override
            public Dialog onCreateDialog(Bundle savedInstanceState) {
<span class="nc" id="L624">                Bundle args = getArguments();</span>
<span class="nc bnc" id="L625" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2070)) {</span>
<span class="nc" id="L626">                    mChecks = args.getBooleanArray(CHECKS);</span>
                }
<span class="nc bnc" id="L628" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2072)) {</span>
<span class="nc bnc" id="L629" title="All 2 branches missed.">                    if (savedInstanceState != null) {</span>
<span class="nc bnc" id="L630" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2071)) {</span>
<span class="nc" id="L631">                            mChecks = args.getBooleanArray(CHECKS);</span>
                        }
                    }
                }
<span class="nc" id="L635">                AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());</span>
<span class="nc" id="L636">                return builder.setTitle(R.string.trip_info_reminder_repeat).setMultiChoiceItems(R.array.reminder_days, mChecks, this).setPositiveButton(R.string.trip_info_save, this).setNegativeButton(R.string.trip_info_dismiss, null).create();</span>
            }

            @Override
            public void onSaveInstanceState(Bundle outState) {
<span class="nc bnc" id="L641" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2073)) {</span>
<span class="nc" id="L642">                    outState.putBooleanArray(CHECKS, mChecks);</span>
                }
<span class="nc" id="L644">            }</span>

            @Override
            public void onClick(DialogInterface dialog, int which) {
<span class="nc" id="L648">                TripInfoActivity act = (TripInfoActivity) getActivity();</span>
                // Get the fragment we want...
<span class="nc" id="L650">                TripInfoFragment frag = act.getTripInfoFragment();</span>
<span class="nc bnc" id="L651" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2074)) {</span>
<span class="nc" id="L652">                    frag.setReminderDays(mChecks);</span>
                }
<span class="nc bnc" id="L654" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2075)) {</span>
<span class="nc" id="L655">                    dialog.dismiss();</span>
                }
<span class="nc" id="L657">            }</span>

            @Override
            public void onClick(DialogInterface arg0, int which, boolean isChecked) {
<span class="nc bnc" id="L661" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2076)) {</span>
<span class="nc" id="L662">                    mChecks[which] = isChecked;</span>
                }
<span class="nc" id="L664">            }</span>
        }

        private void setReminderDays(boolean[] checks) {
<span class="nc" id="L668">            View view = getView();</span>
<span class="nc bnc" id="L669" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2077)) {</span>
<span class="nc" id="L670">                mReminderDays = ObaContract.Trips.arrayToDays(checks);</span>
            }
<span class="nc" id="L672">            final Button repeats = (Button) view.findViewById(R.id.trip_info_reminder_days);</span>
<span class="nc bnc" id="L673" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2078)) {</span>
<span class="nc" id="L674">                repeats.setText(getRepeatText(getActivity(), mReminderDays));</span>
            }
<span class="nc" id="L676">        }</span>

<span class="nc" id="L678">        public static class DeleteDialog extends DialogFragment {</span>

            @Override
            public Dialog onCreateDialog(Bundle savedInstanceState) {
<span class="nc" id="L682">                Bundle args = getArguments();</span>
<span class="nc" id="L683">                final Uri tripUri = args.getParcelable(&quot;uri&quot;);</span>
<span class="nc" id="L684">                AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());</span>
<span class="nc bnc" id="L685" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2083)) {</span>
<span class="nc" id="L686">                    builder.setMessage(R.string.trip_info_delete_trip).setTitle(R.string.trip_info_delete).setIcon(android.R.drawable.ic_dialog_alert).setPositiveButton(android.R.string.ok, new DialogInterface.OnClickListener() {</span>

                        public void onClick(DialogInterface dialog, int which) {
<span class="nc" id="L689">                            ContentResolver cr = getActivity().getContentResolver();</span>
<span class="nc bnc" id="L690" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2080)) {</span>
<span class="nc" id="L691">                                cr.delete(tripUri, null, null);</span>
                            }
<span class="nc bnc" id="L693" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2081)) {</span>
<span class="nc" id="L694">                                TripService.scheduleAll(getActivity(), true);</span>
                            }
<span class="nc bnc" id="L696" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2082)) {</span>
<span class="nc" id="L697">                                getActivity().finish();</span>
                            }
<span class="nc" id="L699">                        }</span>
<span class="nc" id="L700">                    }).setNegativeButton(android.R.string.cancel, new DialogInterface.OnClickListener() {</span>

                        public void onClick(DialogInterface dialog, int which) {
<span class="nc bnc" id="L703" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2079)) {</span>
<span class="nc" id="L704">                                dialog.dismiss();</span>
                            }
<span class="nc" id="L706">                        }</span>
                    });
                }
<span class="nc" id="L709">                return builder.create();</span>
            }
        }

        // This converts what's in the database to what can be displayed in the spinner.
        private static int reminderToSelection(int reminder) {
<span class="nc bnc" id="L715" title="All 10 branches missed.">            switch(reminder) {</span>
                case 0:
<span class="nc" id="L717">                    return 0;</span>
                case 1:
<span class="nc" id="L719">                    return 1;</span>
                case 3:
<span class="nc" id="L721">                    return 2;</span>
                case 5:
<span class="nc" id="L723">                    return 3;</span>
                case 10:
<span class="nc" id="L725">                    return 4;</span>
                case 15:
<span class="nc" id="L727">                    return 5;</span>
                case 20:
<span class="nc" id="L729">                    return 6;</span>
                case 25:
<span class="nc" id="L731">                    return 7;</span>
                case 30:
<span class="nc" id="L733">                    return 8;</span>
                default:
<span class="nc bnc" id="L735" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2084)) {</span>
<span class="nc" id="L736">                        Log.e(TAG, &quot;Invalid reminder value in DB: &quot; + reminder);</span>
                    }
<span class="nc" id="L738">                    return 0;</span>
            }
        }

        private static int selectionToReminder(int selection) {
<span class="nc bnc" id="L743" title="All 10 branches missed.">            switch(selection) {</span>
                case 0:
<span class="nc" id="L745">                    return 0;</span>
                case 1:
<span class="nc" id="L747">                    return 1;</span>
                case 2:
<span class="nc" id="L749">                    return 3;</span>
                case 3:
<span class="nc" id="L751">                    return 5;</span>
                case 4:
<span class="nc" id="L753">                    return 10;</span>
                case 5:
<span class="nc" id="L755">                    return 15;</span>
                case 6:
<span class="nc" id="L757">                    return 20;</span>
                case 7:
<span class="nc" id="L759">                    return 25;</span>
                case 8:
<span class="nc" id="L761">                    return 30;</span>
                default:
<span class="nc bnc" id="L763" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2085)) {</span>
<span class="nc" id="L764">                        Log.e(TAG, &quot;Invalid selection: &quot; + selection);</span>
                    }
<span class="nc" id="L766">                    return 0;</span>
            }
        }
    }

    static String getDepartureTime(Context ctx, long departure) {
<span class="nc" id="L772">        return ctx.getString(R.string.trip_info_depart, DateUtils.formatDateTime(ctx, departure, DateUtils.FORMAT_SHOW_TIME | DateUtils.FORMAT_NO_NOON | DateUtils.FORMAT_NO_MIDNIGHT));</span>
    }

    static String getRepeatText(Context ctx, int days) {
<span class="nc" id="L776">        final Resources res = ctx.getResources();</span>
<span class="nc bnc" id="L777" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2086)) {</span>
<span class="nc bnc" id="L778" title="All 2 branches missed.">            if ((days &amp; ObaContract.Trips.DAY_ALL) == ObaContract.Trips.DAY_ALL) {</span>
<span class="nc" id="L779">                return res.getString(R.string.trip_info_repeat_everyday);</span>
            }
        }
<span class="nc bnc" id="L782" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2093)) {</span>
<span class="nc bnc" id="L783" title="All 50 branches missed.">            if ((ListenerUtil.mutListener.listen(2092) ? (((days &amp; ObaContract.Trips.DAY_WEEKDAY) == ObaContract.Trips.DAY_WEEKDAY) || (ListenerUtil.mutListener.listen(2091) ? ((days &amp; ~ObaContract.Trips.DAY_WEEKDAY) &gt;= 0) : (ListenerUtil.mutListener.listen(2090) ? ((days &amp; ~ObaContract.Trips.DAY_WEEKDAY) &lt;= 0) : (ListenerUtil.mutListener.listen(2089) ? ((days &amp; ~ObaContract.Trips.DAY_WEEKDAY) &gt; 0) : (ListenerUtil.mutListener.listen(2088) ? ((days &amp; ~ObaContract.Trips.DAY_WEEKDAY) &lt; 0) : (ListenerUtil.mutListener.listen(2087) ? ((days &amp; ~ObaContract.Trips.DAY_WEEKDAY) != 0) : ((days &amp; ~ObaContract.Trips.DAY_WEEKDAY) == 0))))))) : (((days &amp; ObaContract.Trips.DAY_WEEKDAY) == ObaContract.Trips.DAY_WEEKDAY) &amp;&amp; (ListenerUtil.mutListener.listen(2091) ? ((days &amp; ~ObaContract.Trips.DAY_WEEKDAY) &gt;= 0) : (ListenerUtil.mutListener.listen(2090) ? ((days &amp; ~ObaContract.Trips.DAY_WEEKDAY) &lt;= 0) : (ListenerUtil.mutListener.listen(2089) ? ((days &amp; ~ObaContract.Trips.DAY_WEEKDAY) &gt; 0) : (ListenerUtil.mutListener.listen(2088) ? ((days &amp; ~ObaContract.Trips.DAY_WEEKDAY) &lt; 0) : (ListenerUtil.mutListener.listen(2087) ? ((days &amp; ~ObaContract.Trips.DAY_WEEKDAY) != 0) : ((days &amp; ~ObaContract.Trips.DAY_WEEKDAY) == 0))))))))) {</span>
<span class="nc" id="L784">                return res.getString(R.string.trip_info_repeat_weekdays);</span>
            }
        }
<span class="nc bnc" id="L787" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2099)) {</span>
<span class="nc bnc" id="L788" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(2098) ? (days &gt;= 0) : (ListenerUtil.mutListener.listen(2097) ? (days &lt;= 0) : (ListenerUtil.mutListener.listen(2096) ? (days &gt; 0) : (ListenerUtil.mutListener.listen(2095) ? (days &lt; 0) : (ListenerUtil.mutListener.listen(2094) ? (days != 0) : (days == 0))))))) {</span>
<span class="nc" id="L789">                return res.getString(R.string.trip_info_repeat_norepeat);</span>
            }
        }
        // Otherwise, it's not normal -- format a string
<span class="nc" id="L793">        final boolean[] array = ObaContract.Trips.daysToArray(days);</span>
<span class="nc" id="L794">        final String[] dayNames = res.getStringArray(R.array.reminder_days);</span>
<span class="nc" id="L795">        StringBuffer buf = new StringBuffer();</span>
        // Find the first day
<span class="nc" id="L797">        int rangeStart = 0;</span>
<span class="nc bnc" id="L798" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2155)) {</span>
            {
<span class="nc" id="L800">                long _loopCounter25 = 0;</span>
<span class="nc bnc" id="L801" title="All 22 branches missed.">                while ((ListenerUtil.mutListener.listen(2154) ? (rangeStart &gt;= 7) : (ListenerUtil.mutListener.listen(2153) ? (rangeStart &lt;= 7) : (ListenerUtil.mutListener.listen(2152) ? (rangeStart &gt; 7) : (ListenerUtil.mutListener.listen(2151) ? (rangeStart != 7) : (ListenerUtil.mutListener.listen(2150) ? (rangeStart == 7) : (rangeStart &lt; 7))))))) {</span>
<span class="nc" id="L802">                    ListenerUtil.loopListener.listen(&quot;_loopCounter25&quot;, ++_loopCounter25);</span>
<span class="nc bnc" id="L803" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2106)) {</span>
                        {
<span class="nc" id="L805">                            long _loopCounter23 = 0;</span>
<span class="nc bnc" id="L806" title="All 50 branches missed.">                            for (; (ListenerUtil.mutListener.listen(2105) ? ((ListenerUtil.mutListener.listen(2104) ? (rangeStart &gt;= 7) : (ListenerUtil.mutListener.listen(2103) ? (rangeStart &lt;= 7) : (ListenerUtil.mutListener.listen(2102) ? (rangeStart &gt; 7) : (ListenerUtil.mutListener.listen(2101) ? (rangeStart != 7) : (ListenerUtil.mutListener.listen(2100) ? (rangeStart == 7) : (rangeStart &lt; 7)))))) || !array[rangeStart]) : ((ListenerUtil.mutListener.listen(2104) ? (rangeStart &gt;= 7) : (ListenerUtil.mutListener.listen(2103) ? (rangeStart &lt;= 7) : (ListenerUtil.mutListener.listen(2102) ? (rangeStart &gt; 7) : (ListenerUtil.mutListener.listen(2101) ? (rangeStart != 7) : (ListenerUtil.mutListener.listen(2100) ? (rangeStart == 7) : (rangeStart &lt; 7)))))) &amp;&amp; !array[rangeStart])); ++rangeStart) {</span>
<span class="nc" id="L807">                                ListenerUtil.loopListener.listen(&quot;_loopCounter23&quot;, ++_loopCounter23);</span>
                            }
                        }
                    }
<span class="nc bnc" id="L811" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2112)) {</span>
<span class="nc bnc" id="L812" title="All 22 branches missed.">                        if ((ListenerUtil.mutListener.listen(2111) ? (rangeStart &gt;= 7) : (ListenerUtil.mutListener.listen(2110) ? (rangeStart &lt;= 7) : (ListenerUtil.mutListener.listen(2109) ? (rangeStart &gt; 7) : (ListenerUtil.mutListener.listen(2108) ? (rangeStart &lt; 7) : (ListenerUtil.mutListener.listen(2107) ? (rangeStart != 7) : (rangeStart == 7))))))) {</span>
<span class="nc" id="L813">                            break;</span>
                        }
                    }
<span class="nc bnc" id="L816" title="All 8 branches missed.">                    int rangeEnd = (ListenerUtil.mutListener.listen(2116) ? (rangeStart % 1) : (ListenerUtil.mutListener.listen(2115) ? (rangeStart / 1) : (ListenerUtil.mutListener.listen(2114) ? (rangeStart * 1) : (ListenerUtil.mutListener.listen(2113) ? (rangeStart - 1) : (rangeStart + 1)))));</span>
<span class="nc bnc" id="L817" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2123)) {</span>
                        {
<span class="nc" id="L819">                            long _loopCounter24 = 0;</span>
<span class="nc bnc" id="L820" title="All 50 branches missed.">                            for (; (ListenerUtil.mutListener.listen(2122) ? ((ListenerUtil.mutListener.listen(2121) ? (rangeEnd &gt;= 7) : (ListenerUtil.mutListener.listen(2120) ? (rangeEnd &lt;= 7) : (ListenerUtil.mutListener.listen(2119) ? (rangeEnd &gt; 7) : (ListenerUtil.mutListener.listen(2118) ? (rangeEnd != 7) : (ListenerUtil.mutListener.listen(2117) ? (rangeEnd == 7) : (rangeEnd &lt; 7)))))) || array[rangeEnd]) : ((ListenerUtil.mutListener.listen(2121) ? (rangeEnd &gt;= 7) : (ListenerUtil.mutListener.listen(2120) ? (rangeEnd &lt;= 7) : (ListenerUtil.mutListener.listen(2119) ? (rangeEnd &gt; 7) : (ListenerUtil.mutListener.listen(2118) ? (rangeEnd != 7) : (ListenerUtil.mutListener.listen(2117) ? (rangeEnd == 7) : (rangeEnd &lt; 7)))))) &amp;&amp; array[rangeEnd])); ++rangeEnd) {</span>
<span class="nc" id="L821">                                ListenerUtil.loopListener.listen(&quot;_loopCounter24&quot;, ++_loopCounter24);</span>
                            }
                        }
                    }
<span class="nc bnc" id="L825" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2130)) {</span>
<span class="nc bnc" id="L826" title="All 22 branches missed.">                        if ((ListenerUtil.mutListener.listen(2128) ? (buf.length() &gt;= 0) : (ListenerUtil.mutListener.listen(2127) ? (buf.length() &lt;= 0) : (ListenerUtil.mutListener.listen(2126) ? (buf.length() &gt; 0) : (ListenerUtil.mutListener.listen(2125) ? (buf.length() &lt; 0) : (ListenerUtil.mutListener.listen(2124) ? (buf.length() == 0) : (buf.length() != 0))))))) {</span>
<span class="nc bnc" id="L827" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2129)) {</span>
                                // TODO: Move to string table
<span class="nc" id="L829">                                buf.append(&quot;, &quot;);</span>
                            }
                        }
                    }
<span class="nc bnc" id="L833" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2148)) {</span>
                        // Single day?
<span class="nc bnc" id="L835" title="All 70 branches missed.">                        if ((ListenerUtil.mutListener.listen(2139) ? (((ListenerUtil.mutListener.listen(2134) ? (rangeEnd % rangeStart) : (ListenerUtil.mutListener.listen(2133) ? (rangeEnd / rangeStart) : (ListenerUtil.mutListener.listen(2132) ? (rangeEnd * rangeStart) : (ListenerUtil.mutListener.listen(2131) ? (rangeEnd + rangeStart) : (rangeEnd - rangeStart)))))) &gt;= 1) : (ListenerUtil.mutListener.listen(2138) ? (((ListenerUtil.mutListener.listen(2134) ? (rangeEnd % rangeStart) : (ListenerUtil.mutListener.listen(2133) ? (rangeEnd / rangeStart) : (ListenerUtil.mutListener.listen(2132) ? (rangeEnd * rangeStart) : (ListenerUtil.mutListener.listen(2131) ? (rangeEnd + rangeStart) : (rangeEnd - rangeStart)))))) &lt;= 1) : (ListenerUtil.mutListener.listen(2137) ? (((ListenerUtil.mutListener.listen(2134) ? (rangeEnd % rangeStart) : (ListenerUtil.mutListener.listen(2133) ? (rangeEnd / rangeStart) : (ListenerUtil.mutListener.listen(2132) ? (rangeEnd * rangeStart) : (ListenerUtil.mutListener.listen(2131) ? (rangeEnd + rangeStart) : (rangeEnd - rangeStart)))))) &gt; 1) : (ListenerUtil.mutListener.listen(2136) ? (((ListenerUtil.mutListener.listen(2134) ? (rangeEnd % rangeStart) : (ListenerUtil.mutListener.listen(2133) ? (rangeEnd / rangeStart) : (ListenerUtil.mutListener.listen(2132) ? (rangeEnd * rangeStart) : (ListenerUtil.mutListener.listen(2131) ? (rangeEnd + rangeStart) : (rangeEnd - rangeStart)))))) &lt; 1) : (ListenerUtil.mutListener.listen(2135) ? (((ListenerUtil.mutListener.listen(2134) ? (rangeEnd % rangeStart) : (ListenerUtil.mutListener.listen(2133) ? (rangeEnd / rangeStart) : (ListenerUtil.mutListener.listen(2132) ? (rangeEnd * rangeStart) : (ListenerUtil.mutListener.listen(2131) ? (rangeEnd + rangeStart) : (rangeEnd - rangeStart)))))) != 1) : (((ListenerUtil.mutListener.listen(2134) ? (rangeEnd % rangeStart) : (ListenerUtil.mutListener.listen(2133) ? (rangeEnd / rangeStart) : (ListenerUtil.mutListener.listen(2132) ? (rangeEnd * rangeStart) : (ListenerUtil.mutListener.listen(2131) ? (rangeEnd + rangeStart) : (rangeEnd - rangeStart)))))) == 1))))))) {</span>
<span class="nc bnc" id="L836" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2147)) {</span>
<span class="nc" id="L837">                                buf.append(dayNames[rangeStart]);</span>
                            }
                        } else {
<span class="nc bnc" id="L840" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2140)) {</span>
<span class="nc" id="L841">                                buf.append(dayNames[rangeStart]);</span>
                            }
<span class="nc bnc" id="L843" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2141)) {</span>
                                // TODO: Move to string table
<span class="nc" id="L845">                                buf.append(&quot; - &quot;);</span>
                            }
<span class="nc bnc" id="L847" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2146)) {</span>
<span class="nc bnc" id="L848" title="All 8 branches missed.">                                buf.append(dayNames[(ListenerUtil.mutListener.listen(2145) ? (rangeEnd % 1) : (ListenerUtil.mutListener.listen(2144) ? (rangeEnd / 1) : (ListenerUtil.mutListener.listen(2143) ? (rangeEnd * 1) : (ListenerUtil.mutListener.listen(2142) ? (rangeEnd + 1) : (rangeEnd - 1)))))]);</span>
                            }
                        }
                    }
<span class="nc bnc" id="L852" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2149)) {</span>
<span class="nc" id="L853">                        rangeStart = rangeEnd;</span>
                    }
<span class="nc" id="L855">                }</span>
            }
        }
<span class="nc" id="L858">        return res.getString(R.string.trip_info_repeat_every, buf.toString());</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span>Generated by the Android Gradle plugin 8.2.0</div></body></html>