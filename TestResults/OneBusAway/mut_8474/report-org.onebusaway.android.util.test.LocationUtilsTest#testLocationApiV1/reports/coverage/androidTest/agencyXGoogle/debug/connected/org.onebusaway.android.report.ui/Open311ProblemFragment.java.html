<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Open311ProblemFragment.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">agencyXGoogleDebug</a> &gt; <a href="index.source.html" class="el_package">org.onebusaway.android.report.ui</a> &gt; <span class="el_source">Open311ProblemFragment.java</span></div><h1>Open311ProblemFragment.java</h1><pre class="source lang-java linenums">/*
* Copyright (C) 2014-2015 University of South Florida (sjbarbeau@gmail.com)
*
* Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*      http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
package org.onebusaway.android.report.ui;

import android.app.Activity;
import android.app.ProgressDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.database.Cursor;
import android.graphics.Bitmap;
import android.graphics.Color;
import android.graphics.Typeface;
import android.graphics.drawable.BitmapDrawable;
import android.location.Location;
import android.net.Uri;
import android.os.Bundle;
import android.os.Parcelable;
import android.provider.MediaStore;
import android.text.InputType;
import android.text.Spannable;
import android.text.SpannableString;
import android.text.TextUtils;
import android.text.style.ForegroundColorSpan;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Button;
import android.widget.CheckBox;
import android.widget.CompoundButton;
import android.widget.EditText;
import android.widget.ImageView;
import android.widget.LinearLayout;
import android.widget.RadioButton;
import android.widget.RadioGroup;
import android.widget.RelativeLayout;
import android.widget.TextView;
import com.google.firebase.analytics.FirebaseAnalytics;
import org.onebusaway.android.R;
import org.onebusaway.android.app.Application;
import org.onebusaway.android.io.ObaAnalytics;
import org.onebusaway.android.io.elements.ObaArrivalInfo;
import org.onebusaway.android.io.elements.ObaStop;
import org.onebusaway.android.io.elements.ObaTripStatus;
import org.onebusaway.android.report.connection.ServiceDescriptionTask;
import org.onebusaway.android.report.connection.ServiceRequestTask;
import org.onebusaway.android.report.constants.ReportConstants;
import org.onebusaway.android.report.ui.model.AttributeValue;
import org.onebusaway.android.report.ui.util.IssueLocationHelper;
import org.onebusaway.android.report.ui.util.ServiceUtils;
import org.onebusaway.android.util.MyTextUtils;
import org.onebusaway.android.util.PreferenceUtils;
import org.onebusaway.android.util.UIUtils;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.text.DateFormat;
import java.text.DecimalFormat;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.HashMap;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;
import androidx.annotation.Nullable;
import androidx.appcompat.app.AppCompatActivity;
import androidx.appcompat.widget.PopupMenu;
import androidx.core.content.ContextCompat;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import edu.usf.cutr.open311client.Open311;
import edu.usf.cutr.open311client.constants.Open311DataType;
import edu.usf.cutr.open311client.models.Open311Attribute;
import edu.usf.cutr.open311client.models.Open311AttributePair;
import edu.usf.cutr.open311client.models.Open311User;
import edu.usf.cutr.open311client.models.Service;
import edu.usf.cutr.open311client.models.ServiceDescription;
import edu.usf.cutr.open311client.models.ServiceDescriptionRequest;
import edu.usf.cutr.open311client.models.ServiceRequest;
import edu.usf.cutr.open311client.models.ServiceRequestResponse;
import edu.usf.cutr.open311client.utils.Open311Validator;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

<span class="nc" id="L102">public class Open311ProblemFragment extends BaseReportFragment implements ServiceDescriptionTask.Callback, ServiceRequestTask.Callback {</span>

    private ImageView mIssueImageView;

    private String mImagePath;

    private Open311 mOpen311;

    private Service mService;

    private String mAgencyName;

    // Block ID for the mArrivalInfo
    private String mBlockId;

    // Arrival information for trip problem
    private ObaArrivalInfo mArrivalInfo;

    // Captured image url
    private Uri mCapturedImageURI;

    // Open311 service description result for selected service code
    private ServiceDescription mServiceDescription;

    // Store ServiceDescription Task Result if host activity haven't been created
    private ServiceDescription mServiceDescriptionTaskResult;

    // Load dynamic open311 fields into info layout
    private LinearLayout mInfoLayout;

    private CheckBox mAnonymousReportingCheckBox;

    private EditText mContactNameView;

    private EditText mContactLastNameView;

    private EditText mContactEmailView;

    private EditText mContactPhoneView;

    private ProgressDialog mProgressDialog;

<span class="nc" id="L144">    private boolean mIsProgressDialogShowing = false;</span>

<span class="nc" id="L146">    private Map&lt;Integer, AttributeValue&gt; mAttributeValueHashMap = new HashMap&lt;&gt;();</span>

<span class="nc" id="L148">    private Map&lt;Integer, View&gt; mDynamicAttributeUIMap = new HashMap&lt;&gt;();</span>

    // Maps attribute name + id with its key
<span class="nc" id="L151">    private Map&lt;String, String&gt; mOpen311AttributeKeyNameMap = new HashMap&lt;&gt;();</span>

    private ServiceRequestTask mRequestTask;

    private ReportProblemFragmentCallback mCallback;

    public static final String TAG = &quot;Open311ProblemFragment&quot;;

    private static final String ATTRIBUTES = &quot;.attributes&quot;;

    private static final String IMAGE_PATH = &quot;.image&quot;;

    private static final String IMAGE_URI = &quot;.imageUri&quot;;

    private static final String IMAGE_THUMBNAIL = &quot;.imageThumbnail&quot;;

    private static final String TRIP_INFO = &quot;.tripInfo&quot;;

    private static final String SHOW_PROGRESS_DIALOG = &quot;.showProgressDialog&quot;;

    private static final String AGENCY_NAME = &quot;.agencyName&quot;;

    private static final String BLOCK_ID = &quot;.blockId&quot;;

    private FirebaseAnalytics mFirebaseAnalytics;

    public static void show(AppCompatActivity activity, Integer containerViewId, Open311 open311, Service service, ObaArrivalInfo obaArrivalInfo, String agencyName, String blockId) {
<span class="nc" id="L178">        FragmentManager fm = activity.getSupportFragmentManager();</span>
<span class="nc" id="L179">        Open311ProblemFragment fragment = new Open311ProblemFragment();</span>
<span class="nc bnc" id="L180" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11233)) {</span>
<span class="nc" id="L181">            fragment.setOpen311(open311);</span>
        }
<span class="nc bnc" id="L183" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11234)) {</span>
<span class="nc" id="L184">            fragment.setService(service);</span>
        }
<span class="nc bnc" id="L186" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11235)) {</span>
<span class="nc" id="L187">            fragment.setArrivalInfo(obaArrivalInfo);</span>
        }
<span class="nc bnc" id="L189" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11236)) {</span>
<span class="nc" id="L190">            fragment.setAgencyName(agencyName);</span>
        }
<span class="nc bnc" id="L192" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11237)) {</span>
<span class="nc" id="L193">            fragment.setBlockId(blockId);</span>
        }
        try {
<span class="nc" id="L196">            FragmentTransaction ft = fm.beginTransaction();</span>
<span class="nc bnc" id="L197" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11239)) {</span>
<span class="nc" id="L198">                ft.replace(containerViewId, fragment, TAG);</span>
            }
<span class="nc bnc" id="L200" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11240)) {</span>
<span class="nc" id="L201">                ft.addToBackStack(null);</span>
            }
<span class="nc bnc" id="L203" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11241)) {</span>
<span class="nc" id="L204">                ft.commit();</span>
            }
<span class="nc" id="L206">        } catch (IllegalStateException e) {</span>
<span class="nc bnc" id="L207" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11238)) {</span>
<span class="nc" id="L208">                Log.e(TAG, &quot;Cannot show Open311ProblemFragment after onSaveInstanceState has been called&quot;);</span>
            }
<span class="nc" id="L210">        }</span>
<span class="nc" id="L211">    }</span>

    public static void show(AppCompatActivity activity, Integer containerViewId, Open311 open311, Service service) {
<span class="nc bnc" id="L214" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11242)) {</span>
<span class="nc" id="L215">            Open311ProblemFragment.show(activity, containerViewId, open311, service, null, null, null);</span>
        }
<span class="nc" id="L217">    }</span>

    @Override
    public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
<span class="nc" id="L221">        View rootView = inflater.inflate(R.layout.open311_issue, container, false);</span>
<span class="nc bnc" id="L222" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11243)) {</span>
<span class="nc" id="L223">            setRetainInstance(true);</span>
        }
<span class="nc bnc" id="L225" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11244)) {</span>
<span class="nc" id="L226">            setHasOptionsMenu(Boolean.TRUE);</span>
        }
<span class="nc bnc" id="L228" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11245)) {</span>
<span class="nc" id="L229">            mFirebaseAnalytics = FirebaseAnalytics.getInstance(getActivity());</span>
        }
<span class="nc" id="L231">        return rootView;</span>
    }

    @Override
    public void onViewCreated(View view, @Nullable Bundle savedInstanceState) {
<span class="nc bnc" id="L236" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11246)) {</span>
<span class="nc" id="L237">            super.onViewCreated(view, savedInstanceState);</span>
        }
<span class="nc bnc" id="L239" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11247)) {</span>
<span class="nc" id="L240">            setupViews(savedInstanceState);</span>
        }
<span class="nc bnc" id="L242" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11248)) {</span>
<span class="nc" id="L243">            setupIconColors();</span>
        }
<span class="nc bnc" id="L245" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11249)) {</span>
<span class="nc" id="L246">            setUpContactInfoViews();</span>
        }
<span class="nc bnc" id="L248" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11250)) {</span>
<span class="nc" id="L249">            callServiceDescription();</span>
        }
<span class="nc" id="L251">    }</span>

    @Override
    public void onSaveInstanceState(Bundle outState) {
<span class="nc bnc" id="L255" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11251)) {</span>
<span class="nc" id="L256">            super.onSaveInstanceState(outState);</span>
        }
<span class="nc" id="L258">        List&lt;AttributeValue&gt; attributeValues = createAttributeValues(mServiceDescription);</span>
<span class="nc bnc" id="L259" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11258)) {</span>
<span class="nc bnc" id="L260" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(11256) ? (attributeValues.size() &gt;= 0) : (ListenerUtil.mutListener.listen(11255) ? (attributeValues.size() &lt;= 0) : (ListenerUtil.mutListener.listen(11254) ? (attributeValues.size() &lt; 0) : (ListenerUtil.mutListener.listen(11253) ? (attributeValues.size() != 0) : (ListenerUtil.mutListener.listen(11252) ? (attributeValues.size() == 0) : (attributeValues.size() &gt; 0))))))) {</span>
<span class="nc bnc" id="L261" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11257)) {</span>
<span class="nc" id="L262">                    outState.putParcelableArrayList(ATTRIBUTES, (ArrayList&lt;? extends Parcelable&gt;) attributeValues);</span>
                }
            }
        }
<span class="nc bnc" id="L266" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11262)) {</span>
<span class="nc bnc" id="L267" title="All 2 branches missed.">            if (mImagePath != null) {</span>
<span class="nc bnc" id="L268" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11259)) {</span>
<span class="nc" id="L269">                    outState.putParcelable(IMAGE_URI, mCapturedImageURI);</span>
                }
<span class="nc bnc" id="L271" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11260)) {</span>
<span class="nc" id="L272">                    outState.putString(IMAGE_PATH, mImagePath);</span>
                }
<span class="nc" id="L274">                Bitmap bitmap = ((BitmapDrawable) mIssueImageView.getDrawable()).getBitmap();</span>
<span class="nc bnc" id="L275" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11261)) {</span>
<span class="nc" id="L276">                    outState.putParcelable(IMAGE_THUMBNAIL, bitmap);</span>
                }
            }
        }
<span class="nc bnc" id="L280" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11264)) {</span>
<span class="nc bnc" id="L281" title="All 2 branches missed.">            if (mArrivalInfo != null) {</span>
<span class="nc bnc" id="L282" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11263)) {</span>
<span class="nc" id="L283">                    outState.putSerializable(TRIP_INFO, mArrivalInfo);</span>
                }
            }
        }
<span class="nc bnc" id="L287" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11266)) {</span>
<span class="nc bnc" id="L288" title="All 2 branches missed.">            if (mIsProgressDialogShowing) {</span>
<span class="nc bnc" id="L289" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11265)) {</span>
                    // Dismiss the progress dialog when orientation change to prevent leaked window
<span class="nc" id="L291">                    mProgressDialog.dismiss();</span>
                }
            }
        }
<span class="nc bnc" id="L295" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11267)) {</span>
<span class="nc" id="L296">            outState.putBoolean(SHOW_PROGRESS_DIALOG, mIsProgressDialogShowing);</span>
        }
<span class="nc bnc" id="L298" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11268)) {</span>
<span class="nc" id="L299">            outState.putString(AGENCY_NAME, mAgencyName);</span>
        }
<span class="nc bnc" id="L301" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11269)) {</span>
<span class="nc" id="L302">            outState.putString(BLOCK_ID, mBlockId);</span>
        }
<span class="nc" id="L304">    }</span>

    @Override
    public void onViewStateRestored(@Nullable Bundle savedInstanceState) {
<span class="nc bnc" id="L308" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11270)) {</span>
<span class="nc" id="L309">            super.onViewStateRestored(savedInstanceState);</span>
        }
<span class="nc bnc" id="L311" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11283)) {</span>
<span class="nc bnc" id="L312" title="All 2 branches missed.">            if (savedInstanceState != null) {</span>
<span class="nc bnc" id="L313" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11271)) {</span>
<span class="nc" id="L314">                    mCapturedImageURI = savedInstanceState.getParcelable(IMAGE_URI);</span>
                }
<span class="nc bnc" id="L316" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11272)) {</span>
<span class="nc" id="L317">                    mImagePath = savedInstanceState.getString(IMAGE_PATH);</span>
                }
<span class="nc bnc" id="L319" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11273)) {</span>
<span class="nc" id="L320">                    mArrivalInfo = (ObaArrivalInfo) savedInstanceState.getSerializable(TRIP_INFO);</span>
                }
<span class="nc bnc" id="L322" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11274)) {</span>
<span class="nc" id="L323">                    mAgencyName = savedInstanceState.getString(AGENCY_NAME);</span>
                }
<span class="nc bnc" id="L325" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11275)) {</span>
<span class="nc" id="L326">                    mBlockId = savedInstanceState.getString(BLOCK_ID);</span>
                }
<span class="nc" id="L328">                List&lt;AttributeValue&gt; values = savedInstanceState.getParcelableArrayList(ATTRIBUTES);</span>
<span class="nc bnc" id="L329" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11276)) {</span>
<span class="nc" id="L330">                    mAttributeValueHashMap.clear();</span>
                }
<span class="nc bnc" id="L332" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11279)) {</span>
<span class="nc bnc" id="L333" title="All 2 branches missed.">                    if (values != null) {</span>
<span class="nc bnc" id="L334" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11278)) {</span>
                            {
<span class="nc" id="L336">                                long _loopCounter150 = 0;</span>
<span class="nc bnc" id="L337" title="All 2 branches missed.">                                for (AttributeValue v : values) {</span>
<span class="nc" id="L338">                                    ListenerUtil.loopListener.listen(&quot;_loopCounter150&quot;, ++_loopCounter150);</span>
<span class="nc bnc" id="L339" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11277)) {</span>
<span class="nc" id="L340">                                        mAttributeValueHashMap.put(v.getCode(), v);</span>
                                    }
<span class="nc" id="L342">                                }</span>
                            }
                        }
                    }
                }
<span class="nc bnc" id="L347" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11280)) {</span>
<span class="nc" id="L348">                    mIsProgressDialogShowing = savedInstanceState.getBoolean(SHOW_PROGRESS_DIALOG);</span>
                }
<span class="nc bnc" id="L350" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11282)) {</span>
<span class="nc bnc" id="L351" title="All 2 branches missed.">                    if (mIsProgressDialogShowing) {</span>
<span class="nc bnc" id="L352" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11281)) {</span>
<span class="nc" id="L353">                            showProgressDialog(true);</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L359">    }</span>

    @Override
    public void onAttach(Context context) {
<span class="nc bnc" id="L363" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11284)) {</span>
<span class="nc" id="L364">            super.onAttach(context);</span>
        }
<span class="nc bnc" id="L366" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11287)) {</span>
<span class="nc bnc" id="L367" title="All 2 branches missed.">            if (mServiceDescriptionTaskResult != null) {</span>
<span class="nc bnc" id="L368" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11285)) {</span>
                    // Reload service description task if the activity restored
<span class="nc" id="L370">                    this.onServiceDescriptionTaskCompleted(mServiceDescriptionTaskResult);</span>
                }
<span class="nc bnc" id="L372" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11286)) {</span>
<span class="nc" id="L373">                    mServiceDescriptionTaskResult = null;</span>
                }
            }
        }
        try {
<span class="nc bnc" id="L378" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11288)) {</span>
<span class="nc" id="L379">                mCallback = (ReportProblemFragmentCallback) context;</span>
            }
<span class="nc" id="L381">        } catch (ClassCastException e) {</span>
<span class="nc" id="L382">            throw new ClassCastException(&quot;ReportProblemFragmentCallback should be implemented&quot; + &quot; in parent activity&quot;);</span>
<span class="nc" id="L383">        }</span>
<span class="nc" id="L384">    }</span>

    /**
     * Initialize UI components
     */
    private void setupViews(Bundle bundle) {
<span class="nc bnc" id="L390" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11289)) {</span>
<span class="nc" id="L391">            mIssueImageView = (ImageView) findViewById(R.id.ri_imageView);</span>
        }
<span class="nc bnc" id="L393" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11292)) {</span>
<span class="nc bnc" id="L394" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(11290) ? (bundle != null || bundle.getParcelable(IMAGE_THUMBNAIL) != null) : (bundle != null &amp;&amp; bundle.getParcelable(IMAGE_THUMBNAIL) != null))) {</span>
<span class="nc bnc" id="L395" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11291)) {</span>
<span class="nc" id="L396">                    mIssueImageView.setImageBitmap((Bitmap) bundle.getParcelable(IMAGE_THUMBNAIL));</span>
                }
            }
        }
<span class="nc bnc" id="L400" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11293)) {</span>
<span class="nc" id="L401">            mInfoLayout = (LinearLayout) findViewById(R.id.ri_info_layout);</span>
        }
<span class="nc" id="L403">        Button addImageButton = (Button) findViewById(R.id.ri_attach_image);</span>
<span class="nc" id="L404">        final PopupMenu popupMenu = new PopupMenu(getActivity(), addImageButton);</span>
<span class="nc bnc" id="L405" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11294)) {</span>
<span class="nc" id="L406">            popupMenu.inflate(R.menu.report_issue_add_image);</span>
        }
<span class="nc bnc" id="L408" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11296)) {</span>
<span class="nc" id="L409">            addImageButton.setOnClickListener(new View.OnClickListener() {</span>

                @Override
                public void onClick(View v) {
<span class="nc bnc" id="L413" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11295)) {</span>
<span class="nc" id="L414">                        popupMenu.show();</span>
                    }
<span class="nc" id="L416">                }</span>
            });
        }
<span class="nc bnc" id="L419" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11300)) {</span>
<span class="nc" id="L420">            popupMenu.setOnMenuItemClickListener(new PopupMenu.OnMenuItemClickListener() {</span>

                @Override
                public boolean onMenuItemClick(MenuItem item) {
<span class="nc bnc" id="L424" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11299)) {</span>
<span class="nc bnc" id="L425" title="All 3 branches missed.">                        switch(item.getItemId()) {</span>
                            case R.id.ri_button_camera:
<span class="nc bnc" id="L427" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11297)) {</span>
<span class="nc" id="L428">                                    openCamera();</span>
                                }
                                break;
                            case R.id.ri_button_gallery:
<span class="nc bnc" id="L432" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11298)) {</span>
<span class="nc" id="L433">                                    openGallery();</span>
                                }
                                break;
                            default:
                                break;
                        }
                    }
<span class="nc" id="L440">                    return true;</span>
                }
            });
        }
<span class="nc bnc" id="L444" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11301)) {</span>
<span class="nc" id="L445">            mAnonymousReportingCheckBox = (CheckBox) findViewById(R.id.rici_anonymous_checkbox);</span>
        }
<span class="nc bnc" id="L447" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11303)) {</span>
<span class="nc" id="L448">            mAnonymousReportingCheckBox.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {</span>

                @Override
                public void onCheckedChanged(CompoundButton compoundButton, boolean isChecked) {
<span class="nc bnc" id="L452" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11302)) {</span>
<span class="nc" id="L453">                        disableEnableContactInfoViews(isChecked);</span>
                    }
<span class="nc" id="L455">                }</span>
            });
        }
<span class="nc bnc" id="L458" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11304)) {</span>
            // Setup contact info views
<span class="nc" id="L460">            mContactNameView = ((EditText) findViewById(R.id.rici_name_editText));</span>
        }
<span class="nc bnc" id="L462" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11305)) {</span>
<span class="nc" id="L463">            mContactLastNameView = ((EditText) findViewById(R.id.rici_lastname_editText));</span>
        }
<span class="nc bnc" id="L465" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11306)) {</span>
<span class="nc" id="L466">            mContactEmailView = ((EditText) findViewById(R.id.rici_email_editText));</span>
        }
<span class="nc bnc" id="L468" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11307)) {</span>
<span class="nc" id="L469">            mContactPhoneView = ((EditText) findViewById(R.id.rici_phone_editText));</span>
        }
<span class="nc" id="L471">    }</span>

    private void setupIconColors() {
<span class="nc bnc" id="L474" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11308)) {</span>
<span class="nc" id="L475">            ((ImageView) findViewById(R.id.ri_ic_app_feedback)).setColorFilter(getResources().getColor(R.color.material_gray));</span>
        }
<span class="nc bnc" id="L477" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11309)) {</span>
<span class="nc" id="L478">            ((ImageView) findViewById(R.id.ri_ic_image_picker)).setColorFilter(getResources().getColor(R.color.material_gray));</span>
        }
<span class="nc bnc" id="L480" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11310)) {</span>
<span class="nc" id="L481">            ((ImageView) findViewById(R.id.ri_ic_username)).setColorFilter(getResources().getColor(R.color.material_gray));</span>
        }
<span class="nc bnc" id="L483" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11311)) {</span>
<span class="nc" id="L484">            ((ImageView) findViewById(R.id.ri_ic_customer_service_email)).setColorFilter(getResources().getColor(R.color.material_gray));</span>
        }
<span class="nc bnc" id="L486" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11312)) {</span>
<span class="nc" id="L487">            ((ImageView) findViewById(R.id.ri_ic_customer_service_phone)).setColorFilter(getResources().getColor(R.color.material_gray));</span>
        }
<span class="nc bnc" id="L489" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11313)) {</span>
<span class="nc" id="L490">            ((ImageView) findViewById(R.id.ri_ic_anonymous)).setColorFilter(getResources().getColor(R.color.material_gray));</span>
        }
<span class="nc" id="L492">    }</span>

    private void callServiceDescription() {
<span class="nc bnc" id="L495" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11314)) {</span>
<span class="nc bnc" id="L496" title="All 2 branches missed.">            if (mOpen311 == null) {</span>
<span class="nc" id="L497">                return;</span>
            }
        }
<span class="nc bnc" id="L500" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11315)) {</span>
<span class="nc" id="L501">            showProgress(Boolean.TRUE);</span>
        }
<span class="nc" id="L503">        Location location = getIssueLocationHelper().getIssueLocation();</span>
<span class="nc" id="L504">        ServiceDescriptionRequest sdr = new ServiceDescriptionRequest(location.getLatitude(), location.getLongitude(), mOpen311.getJurisdiction(), mService.getService_code());</span>
<span class="nc" id="L505">        ServiceDescriptionTask sdt = new ServiceDescriptionTask(sdr, mOpen311, Open311ProblemFragment.this);</span>
<span class="nc bnc" id="L506" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11316)) {</span>
<span class="nc" id="L507">            sdt.execute();</span>
        }
<span class="nc" id="L509">    }</span>

    /**
     * Update ui if service description request is success
     */
    @Override
    public void onServiceDescriptionTaskCompleted(ServiceDescription serviceDescription) {
<span class="nc bnc" id="L516" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11323)) {</span>
<span class="nc bnc" id="L517" title="All 2 branches missed.">            if (isActivityAttached()) {</span>
<span class="nc bnc" id="L518" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11318)) {</span>
<span class="nc" id="L519">                    showProgress(Boolean.FALSE);</span>
                }
<span class="nc bnc" id="L521" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11322)) {</span>
<span class="nc bnc" id="L522" title="All 2 branches missed.">                    if (serviceDescription.isSuccess()) {</span>
<span class="nc bnc" id="L523" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11321)) {</span>
<span class="nc" id="L524">                            createServiceDescriptionUI(serviceDescription);</span>
                        }
                    } else {
<span class="nc bnc" id="L527" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11319)) {</span>
<span class="nc" id="L528">                            createToastMessage(getString(R.string.ri_service_description_problem));</span>
                        }
<span class="nc bnc" id="L530" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11320)) {</span>
                            // Close open311 fragment
<span class="nc" id="L532">                            ((InfrastructureIssueActivity) getActivity()).removeOpen311ProblemFragment();</span>
                        }
                    }
                }
            } else {
<span class="nc bnc" id="L537" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11317)) {</span>
<span class="nc" id="L538">                    mServiceDescriptionTaskResult = serviceDescription;</span>
                }
            }
        }
<span class="nc" id="L542">    }</span>

    /**
     * Show the result of the open311 issue submission
     */
    @Override
    public void onServiceRequestTaskCompleted(ServiceRequestResponse response) {
<span class="nc bnc" id="L549" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11324)) {</span>
<span class="nc" id="L550">            showProgressDialog(false);</span>
        }
<span class="nc bnc" id="L552" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11329)) {</span>
<span class="nc bnc" id="L553" title="All 2 branches missed.">            if (response.isSuccess()) {</span>
<span class="nc bnc" id="L554" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11328)) {</span>
<span class="nc" id="L555">                    mCallback.onReportSent();</span>
                }
            } else {
<span class="nc" id="L558">                String message = response.getErrorMessage();</span>
<span class="nc bnc" id="L559" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11326)) {</span>
<span class="nc bnc" id="L560" title="All 2 branches missed.">                    if (TextUtils.isEmpty(message)) {</span>
<span class="nc bnc" id="L561" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11325)) {</span>
<span class="nc" id="L562">                            message = getString(R.string.ri_unsuccessful_submit);</span>
                        }
                    }
                }
<span class="nc bnc" id="L566" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11327)) {</span>
<span class="nc" id="L567">                    createToastMessage(message);</span>
                }
            }
        }
<span class="nc" id="L571">    }</span>

    @Override
    public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {
<span class="nc bnc" id="L575" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11330)) {</span>
<span class="nc" id="L576">            inflater.inflate(R.menu.report_issue_action, menu);</span>
        }
<span class="nc bnc" id="L578" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11331)) {</span>
<span class="nc" id="L579">            super.onCreateOptionsMenu(menu, inflater);</span>
        }
<span class="nc" id="L581">    }</span>

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
<span class="nc bnc" id="L585" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11333)) {</span>
<span class="nc bnc" id="L586" title="All 2 branches missed.">            if (item.getItemId() == R.id.report_problem_send) {</span>
<span class="nc bnc" id="L587" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11332)) {</span>
<span class="nc" id="L588">                    submitReport();</span>
                }
            }
        }
<span class="nc" id="L592">        return super.onOptionsItemSelected(item);</span>
    }

    @Override
    public void onActivityResult(int requestCode, int resultCode, Intent data) {
<span class="nc bnc" id="L597" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11334)) {</span>
<span class="nc" id="L598">            super.onActivityResult(requestCode, resultCode, data);</span>
        }
<span class="nc bnc" id="L600" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11342)) {</span>
<span class="nc bnc" id="L601" title="All 26 branches missed.">            if ((ListenerUtil.mutListener.listen(11336) ? ((ListenerUtil.mutListener.listen(11335) ? (requestCode == ReportConstants.GALLERY_INTENT || resultCode == Activity.RESULT_OK) : (requestCode == ReportConstants.GALLERY_INTENT &amp;&amp; resultCode == Activity.RESULT_OK)) || data != null) : ((ListenerUtil.mutListener.listen(11335) ? (requestCode == ReportConstants.GALLERY_INTENT || resultCode == Activity.RESULT_OK) : (requestCode == ReportConstants.GALLERY_INTENT &amp;&amp; resultCode == Activity.RESULT_OK)) &amp;&amp; data != null))) {</span>
<span class="nc bnc" id="L602" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11337)) {</span>
                    // Get the gallery image info
<span class="nc" id="L604">                    mCapturedImageURI = data.getData();</span>
                }
<span class="nc" id="L606">                String[] filePathColumn = { MediaStore.Images.Media.DATA };</span>
<span class="nc" id="L607">                Cursor cursor = getActivity().getContentResolver().query(mCapturedImageURI, filePathColumn, null, null, null);</span>
<span class="nc bnc" id="L608" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11338)) {</span>
<span class="nc bnc" id="L609" title="All 2 branches missed.">                    if (cursor == null)</span>
<span class="nc" id="L610">                        return;</span>
                }
<span class="nc bnc" id="L612" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11339)) {</span>
<span class="nc" id="L613">                    cursor.moveToFirst();</span>
                }
<span class="nc" id="L615">                int columnIndex = cursor.getColumnIndex(filePathColumn[0]);</span>
<span class="nc bnc" id="L616" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11340)) {</span>
<span class="nc" id="L617">                    mImagePath = cursor.getString(columnIndex);</span>
                }
<span class="nc bnc" id="L619" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11341)) {</span>
<span class="nc" id="L620">                    cursor.close();</span>
                }
            }
        }
<span class="nc bnc" id="L624" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11348)) {</span>
            // Whether image was from gallery or captured via camera, we need to downscale it for ImageView
<span class="nc bnc" id="L626" title="All 26 branches missed.">            if ((ListenerUtil.mutListener.listen(11344) ? (((ListenerUtil.mutListener.listen(11343) ? (requestCode == ReportConstants.GALLERY_INTENT &amp;&amp; requestCode == ReportConstants.CAPTURE_PICTURE_INTENT) : (requestCode == ReportConstants.GALLERY_INTENT || requestCode == ReportConstants.CAPTURE_PICTURE_INTENT))) || resultCode == Activity.RESULT_OK) : (((ListenerUtil.mutListener.listen(11343) ? (requestCode == ReportConstants.GALLERY_INTENT &amp;&amp; requestCode == ReportConstants.CAPTURE_PICTURE_INTENT) : (requestCode == ReportConstants.GALLERY_INTENT || requestCode == ReportConstants.CAPTURE_PICTURE_INTENT))) &amp;&amp; resultCode == Activity.RESULT_OK))) {</span>
                // Load thumbnail to avoid OutOfMemory issue on Galaxy S5 - see #730
<span class="nc" id="L628">                Bitmap thumbnail = null;</span>
                try {
<span class="nc bnc" id="L630" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11346)) {</span>
<span class="nc" id="L631">                        thumbnail = UIUtils.decodeSampledBitmapFromFile(mImagePath, mIssueImageView.getWidth(), mIssueImageView.getHeight());</span>
                    }
<span class="nc" id="L633">                } catch (IOException e) {</span>
<span class="nc bnc" id="L634" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11345)) {</span>
<span class="nc" id="L635">                        e.printStackTrace();</span>
                    }
<span class="nc" id="L637">                }</span>
<span class="nc bnc" id="L638" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11347)) {</span>
<span class="nc" id="L639">                    mIssueImageView.setImageBitmap(thumbnail);</span>
                }
            }
        }
<span class="nc" id="L643">    }</span>

    /**
     * Prepare submit forms and submit report
     */
    private void submitReport() {
<span class="nc bnc" id="L649" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11349)) {</span>
            // Save the open311 user
<span class="nc" id="L651">            saveOpen311User();</span>
        }
        // Prepare issue description
<span class="nc" id="L654">        String description = ((EditText) getActivity().findViewById(R.id.ri_editTextDesc)).getText().toString();</span>
        Open311User open311User;
<span class="nc bnc" id="L656" title="All 2 branches missed.">        if (!mAnonymousReportingCheckBox.isChecked()) {</span>
<span class="nc" id="L657">            open311User = getOpen311UserFromUI();</span>
        } else {
<span class="nc" id="L659">            open311User = getOpen311UserFromStrings();</span>
        }
<span class="nc" id="L661">        String appUid = PreferenceUtils.getString(Application.APP_UID);</span>
<span class="nc" id="L662">        IssueLocationHelper issueLocationHelper = getIssueLocationHelper();</span>
<span class="nc" id="L663">        ServiceRequest.Builder builder = new ServiceRequest.Builder();</span>
<span class="nc bnc" id="L664" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11350)) {</span>
<span class="nc" id="L665">            builder.setJurisdiction_id(mOpen311.getJurisdiction()).setService_code(mService.getService_code()).setService_name(mService.getService_name()).setLatitude(issueLocationHelper.getIssueLocation().getLatitude()).setLongitude(issueLocationHelper.getIssueLocation().getLongitude()).setSummary(null).setDescription(description).setEmail(open311User.getEmail()).setFirst_name(open311User.getName()).setLast_name(open311User.getLastName()).setPhone(open311User.getPhone()).setAddress_string(getCurrentAddress()).setDevice_id(appUid);</span>
        }
<span class="nc bnc" id="L667" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11352)) {</span>
<span class="nc bnc" id="L668" title="All 2 branches missed.">            if (mImagePath != null) {</span>
<span class="nc bnc" id="L669" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11351)) {</span>
<span class="nc" id="L670">                    attachImage(builder);</span>
                }
            }
        }
<span class="nc" id="L674">        ServiceRequest serviceRequest = builder.createServiceRequest();</span>
<span class="nc" id="L675">        List&lt;Open311AttributePair&gt; attributes = createOpen311Attributes(mServiceDescription);</span>
<span class="nc bnc" id="L676" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11353)) {</span>
<span class="nc" id="L677">            serviceRequest.setAttributes(attributes);</span>
        }
<span class="nc" id="L679">        int errorCode = Open311Validator.validateServiceRequest(serviceRequest, mOpen311.getOpen311Option().getOpen311Type(), mServiceDescription);</span>
<span class="nc bnc" id="L680" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11362)) {</span>
<span class="nc bnc" id="L681" title="All 2 branches missed.">            if (Open311Validator.isValid(errorCode)) {</span>
<span class="nc bnc" id="L682" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11357)) {</span>
                    // Append transit service parameters to issue description
<span class="nc bnc" id="L684" title="All 2 branches missed.">                    if (ServiceUtils.isTransitServiceByType(mService.getType())) {</span>
<span class="nc bnc" id="L685" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11355)) {</span>
<span class="nc" id="L686">                            description += getTransitIssueParameters(mService);</span>
                        }
<span class="nc bnc" id="L688" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11356)) {</span>
<span class="nc" id="L689">                            serviceRequest.setDescription(description);</span>
                        }
                    }
                }
<span class="nc bnc" id="L693" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11358)) {</span>
                    // Start progress
<span class="nc" id="L695">                    showProgressDialog(true);</span>
                }
<span class="nc bnc" id="L697" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11359)) {</span>
<span class="nc" id="L698">                    mRequestTask = new ServiceRequestTask(mOpen311, serviceRequest, this);</span>
                }
<span class="nc bnc" id="L700" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11360)) {</span>
<span class="nc" id="L701">                    mRequestTask.execute();</span>
                }
<span class="nc bnc" id="L703" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11361)) {</span>
<span class="nc" id="L704">                    ObaAnalytics.reportUiEvent(mFirebaseAnalytics, getString(R.string.analytics_problem), mService.getService_name());</span>
                }
            } else {
<span class="nc bnc" id="L707" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11354)) {</span>
<span class="nc" id="L708">                    createToastMessage(Open311Validator.getErrorMessageForServiceRequestByErrorCode(errorCode));</span>
                }
            }
        }
<span class="nc" id="L712">    }</span>

    /**
     * Attaches the captured image saved in this fragment to the provided builder
     *
     * @param builder the builder to attach the image to
     */
    private void attachImage(ServiceRequest.Builder builder) {
        // Downsample the image file to avoid uploading huge images
<span class="nc" id="L721">        File smallImageFile = null;</span>
        try {
<span class="nc bnc" id="L723" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11365)) {</span>
<span class="nc" id="L724">                smallImageFile = UIUtils.createImageFile(getContext(), &quot;-small&quot;);</span>
            }
<span class="nc" id="L726">        } catch (IOException ex) {</span>
<span class="nc bnc" id="L727" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11363)) {</span>
                // Error occurred while creating the File
<span class="nc" id="L729">                createToastMessage(getString(R.string.ri_resize_image_problem));</span>
            }
<span class="nc bnc" id="L731" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11364)) {</span>
<span class="nc" id="L732">                Log.e(TAG, &quot;Couldn't resize image - &quot; + ex);</span>
            }
<span class="nc" id="L734">        }</span>
<span class="nc bnc" id="L735" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11375)) {</span>
            // Continue only if the File was successfully created
<span class="nc bnc" id="L737" title="All 2 branches missed.">            if (smallImageFile != null) {</span>
                // Max SeeClickFix resolution image is &quot;800x600 image center cropped&quot;
<span class="nc" id="L739">                final int WIDTH = 800, HEIGHT = 800;</span>
                Bitmap smallImage;
<span class="nc" id="L741">                FileOutputStream out = null;</span>
                try {
<span class="nc" id="L743">                    smallImage = UIUtils.decodeSampledBitmapFromFile(mImagePath, WIDTH, HEIGHT);</span>
<span class="nc bnc" id="L744" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11372)) {</span>
<span class="nc" id="L745">                        out = new FileOutputStream(smallImageFile);</span>
                    }
<span class="nc bnc" id="L747" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11373)) {</span>
<span class="nc" id="L748">                        smallImage.compress(Bitmap.CompressFormat.JPEG, 100, out);</span>
                    }
<span class="nc bnc" id="L750" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11374)) {</span>
<span class="nc" id="L751">                        out.flush();</span>
                    }
<span class="nc" id="L753">                } catch (IOException e) {</span>
<span class="nc bnc" id="L754" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11367)) {</span>
<span class="nc" id="L755">                        e.printStackTrace();</span>
                    }
<span class="nc bnc" id="L757" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11368)) {</span>
                        // Just use the full size image
<span class="nc" id="L759">                        smallImageFile = new File(mImagePath);</span>
                    }
                } finally {
<span class="nc bnc" id="L762" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11371)) {</span>
<span class="nc bnc" id="L763" title="All 2 branches missed.">                        if (out != null) {</span>
                            try {
<span class="nc bnc" id="L765" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11370)) {</span>
<span class="nc" id="L766">                                    out.close();</span>
                                }
<span class="nc" id="L768">                            } catch (IOException e) {</span>
<span class="nc bnc" id="L769" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11369)) {</span>
<span class="nc" id="L770">                                    e.printStackTrace();</span>
                                }
<span class="nc" id="L772">                            }</span>
                        }
                    }
                }
<span class="nc" id="L776">            } else {</span>
<span class="nc bnc" id="L777" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11366)) {</span>
                    // Just use the full size image
<span class="nc" id="L779">                    smallImageFile = new File(mImagePath);</span>
                }
            }
        }
<span class="nc bnc" id="L783" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11376)) {</span>
<span class="nc" id="L784">            builder.setMedia(smallImageFile);</span>
        }
<span class="nc" id="L786">    }</span>

    /**
     * Generates stop and trip problem parameters for given open311 service
     *
     * @param service open311 service
     * @return a string containing parameters
     */
    private String getTransitIssueParameters(Service service) {
<span class="nc" id="L795">        StringBuilder sb = new StringBuilder();</span>
<span class="nc" id="L796">        ObaStop obaStop = getIssueLocationHelper().getObaStop();</span>
<span class="nc bnc" id="L797" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11377)) {</span>
<span class="nc bnc" id="L798" title="All 2 branches missed.">            if (obaStop == null) {</span>
<span class="nc" id="L799">                return sb.toString();</span>
            }
        }
<span class="nc bnc" id="L802" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11378)) {</span>
<span class="nc" id="L803">            sb.append(getString(R.string.ri_append_start));</span>
        }
<span class="nc bnc" id="L805" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11433)) {</span>
<span class="nc bnc" id="L806" title="All 2 branches missed.">            if (ServiceUtils.isTransitStopServiceByType(service.getType())) {</span>
<span class="nc bnc" id="L807" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11431)) {</span>
                    // Append stop service params
<span class="nc" id="L809">                    sb.append(getResources().getString(R.string.ri_append_gtfs_stop_id, obaStop.getId()));</span>
                }
<span class="nc bnc" id="L811" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11432)) {</span>
<span class="nc" id="L812">                    sb.append(getResources().getString(R.string.ri_append_stop_name, obaStop.getName()));</span>
                }
<span class="nc bnc" id="L814" title="All 2 branches missed.">            } else if (ServiceUtils.isTransitTripServiceByType(service.getType())) {</span>
<span class="nc bnc" id="L815" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11430)) {</span>
<span class="nc bnc" id="L816" title="All 2 branches missed.">                    if (mArrivalInfo != null) {</span>
                        // Append trip service params
<span class="nc" id="L818">                        DateFormat dateFormat = new SimpleDateFormat(&quot;MM-dd-yyyy&quot;);</span>
<span class="nc bnc" id="L819" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11379)) {</span>
<span class="nc" id="L820">                            sb.append(getResources().getString(R.string.ri_append_service_date, dateFormat.format(new Date(mArrivalInfo.getServiceDate()))));</span>
                        }
<span class="nc bnc" id="L822" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11381)) {</span>
<span class="nc bnc" id="L823" title="All 2 branches missed.">                            if (mAgencyName != null) {</span>
<span class="nc bnc" id="L824" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11380)) {</span>
<span class="nc" id="L825">                                    sb.append(getResources().getString(R.string.ri_append_agency_name, mAgencyName));</span>
                                }
                            }
                        }
<span class="nc bnc" id="L829" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11382)) {</span>
<span class="nc" id="L830">                            sb.append(getResources().getString(R.string.ri_append_gtfs_stop_id, obaStop.getId()));</span>
                        }
<span class="nc bnc" id="L832" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11383)) {</span>
<span class="nc" id="L833">                            sb.append(getResources().getString(R.string.ri_append_stop_name, obaStop.getName()));</span>
                        }
<span class="nc bnc" id="L835" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11384)) {</span>
<span class="nc" id="L836">                            sb.append(getResources().getString(R.string.ri_append_route_id, mArrivalInfo.getRouteId()));</span>
                        }
<span class="nc" id="L838">                        String routeDisplayName = UIUtils.getRouteDisplayName(mArrivalInfo);</span>
<span class="nc bnc" id="L839" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11386)) {</span>
<span class="nc bnc" id="L840" title="All 2 branches missed.">                            if (!TextUtils.isEmpty(routeDisplayName)) {</span>
<span class="nc bnc" id="L841" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11385)) {</span>
<span class="nc" id="L842">                                    sb.append(getResources().getString(R.string.ri_append_route_display_name, routeDisplayName));</span>
                                }
                            }
                        }
<span class="nc bnc" id="L846" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11388)) {</span>
<span class="nc bnc" id="L847" title="All 2 branches missed.">                            if (mBlockId != null) {</span>
<span class="nc bnc" id="L848" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11387)) {</span>
<span class="nc" id="L849">                                    sb.append(getResources().getString(R.string.ri_append_block_id, mBlockId));</span>
                                }
                            }
                        }
<span class="nc bnc" id="L853" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11389)) {</span>
<span class="nc" id="L854">                            sb.append(getResources().getString(R.string.ri_append_trip_id, mArrivalInfo.getTripId()));</span>
                        }
<span class="nc bnc" id="L856" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11390)) {</span>
<span class="nc" id="L857">                            sb.append(getResources().getString(R.string.ri_append_trip_name, mArrivalInfo.getHeadsign()));</span>
                        }
<span class="nc bnc" id="L859" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11391)) {</span>
<span class="nc" id="L860">                            sb.append(getResources().getString(R.string.ri_append_predicted, Boolean.valueOf(mArrivalInfo.getPredicted())));</span>
                        }
<span class="nc" id="L862">                        ObaTripStatus tripStatus = mArrivalInfo.getTripStatus();</span>
<span class="nc bnc" id="L863" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11423)) {</span>
<span class="nc bnc" id="L864" title="All 10 branches missed.">                            if ((ListenerUtil.mutListener.listen(11392) ? (tripStatus != null || mArrivalInfo.getPredicted()) : (tripStatus != null &amp;&amp; mArrivalInfo.getPredicted()))) {</span>
<span class="nc bnc" id="L865" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11393)) {</span>
<span class="nc" id="L866">                                    sb.append(getResources().getString(R.string.ri_append_vehicle_id, mArrivalInfo.getVehicleId()));</span>
                                }
<span class="nc" id="L868">                                Location lastKnownLocation = tripStatus.getLastKnownLocation();</span>
<span class="nc bnc" id="L869" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11395)) {</span>
<span class="nc bnc" id="L870" title="All 2 branches missed.">                                    if (lastKnownLocation != null) {</span>
<span class="nc" id="L871">                                        String locationString = lastKnownLocation.getLatitude() + &quot; &quot; + lastKnownLocation.getLongitude();</span>
<span class="nc bnc" id="L872" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(11394)) {</span>
<span class="nc" id="L873">                                            sb.append(getResources().getString(R.string.ri_append_vehicle_location, locationString));</span>
                                        }
                                    }
                                }
<span class="nc" id="L877">                                DecimalFormat numberFormat = new DecimalFormat(&quot;#.000&quot;);</span>
<span class="nc bnc" id="L878" title="All 8 branches missed.">                                double scheduleDeviation = (ListenerUtil.mutListener.listen(11399) ? (tripStatus.getScheduleDeviation() % 60.0) : (ListenerUtil.mutListener.listen(11398) ? (tripStatus.getScheduleDeviation() * 60.0) : (ListenerUtil.mutListener.listen(11397) ? (tripStatus.getScheduleDeviation() - 60.0) : (ListenerUtil.mutListener.listen(11396) ? (tripStatus.getScheduleDeviation() + 60.0) : (tripStatus.getScheduleDeviation() / 60.0)))));</span>
<span class="nc bnc" id="L879" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11422)) {</span>
<span class="nc bnc" id="L880" title="All 22 branches missed.">                                    if ((ListenerUtil.mutListener.listen(11404) ? (scheduleDeviation &gt;= 0.0) : (ListenerUtil.mutListener.listen(11403) ? (scheduleDeviation &lt;= 0.0) : (ListenerUtil.mutListener.listen(11402) ? (scheduleDeviation &gt; 0.0) : (ListenerUtil.mutListener.listen(11401) ? (scheduleDeviation &lt; 0.0) : (ListenerUtil.mutListener.listen(11400) ? (scheduleDeviation != 0.0) : (scheduleDeviation == 0.0))))))) {</span>
<span class="nc bnc" id="L881" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(11421)) {</span>
<span class="nc" id="L882">                                            sb.append(getResources().getString(R.string.ri_append_schedule_deviation, &quot;0&quot;));</span>
                                        }
<span class="nc bnc" id="L884" title="All 22 branches missed.">                                    } else if ((ListenerUtil.mutListener.listen(11409) ? (scheduleDeviation &gt;= 0) : (ListenerUtil.mutListener.listen(11408) ? (scheduleDeviation &lt;= 0) : (ListenerUtil.mutListener.listen(11407) ? (scheduleDeviation &gt; 0) : (ListenerUtil.mutListener.listen(11406) ? (scheduleDeviation != 0) : (ListenerUtil.mutListener.listen(11405) ? (scheduleDeviation == 0) : (scheduleDeviation &lt; 0))))))) {</span>
<span class="nc bnc" id="L885" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(11420)) {</span>
<span class="nc bnc" id="L886" title="All 8 branches missed.">                                            sb.append(getResources().getString(R.string.ri_append_schedule_deviation_early, numberFormat.format((ListenerUtil.mutListener.listen(11419) ? (scheduleDeviation % -1.0) : (ListenerUtil.mutListener.listen(11418) ? (scheduleDeviation / -1.0) : (ListenerUtil.mutListener.listen(11417) ? (scheduleDeviation - -1.0) : (ListenerUtil.mutListener.listen(11416) ? (scheduleDeviation + -1.0) : (scheduleDeviation * -1.0))))))));</span>
                                        }
<span class="nc bnc" id="L888" title="All 22 branches missed.">                                    } else if ((ListenerUtil.mutListener.listen(11414) ? (scheduleDeviation &gt;= 0) : (ListenerUtil.mutListener.listen(11413) ? (scheduleDeviation &lt;= 0) : (ListenerUtil.mutListener.listen(11412) ? (scheduleDeviation &lt; 0) : (ListenerUtil.mutListener.listen(11411) ? (scheduleDeviation != 0) : (ListenerUtil.mutListener.listen(11410) ? (scheduleDeviation == 0) : (scheduleDeviation &gt; 0))))))) {</span>
<span class="nc bnc" id="L889" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(11415)) {</span>
<span class="nc" id="L890">                                            sb.append(getResources().getString(R.string.ri_append_schedule_deviation_late, numberFormat.format(scheduleDeviation)));</span>
                                        }
                                    }
                                }
                            }
                        }
<span class="nc bnc" id="L896" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11424)) {</span>
<span class="nc" id="L897">                            dateFormat = new SimpleDateFormat(&quot;hh:mm a&quot;);</span>
                        }
<span class="nc bnc" id="L899" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11429)) {</span>
<span class="nc bnc" id="L900" title="All 2 branches missed.">                            if (mArrivalInfo.getPredicted()) {</span>
<span class="nc bnc" id="L901" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11427)) {</span>
<span class="nc" id="L902">                                    sb.append(getResources().getString(R.string.ri_append_arrival_time, dateFormat.format(new Date(mArrivalInfo.getPredictedArrivalTime()))));</span>
                                }
<span class="nc bnc" id="L904" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11428)) {</span>
<span class="nc" id="L905">                                    sb.append(getResources().getString(R.string.ri_append_departure_time, dateFormat.format(new Date(mArrivalInfo.getPredictedDepartureTime()))));</span>
                                }
                            } else {
<span class="nc bnc" id="L908" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11425)) {</span>
<span class="nc" id="L909">                                    sb.append(getResources().getString(R.string.ri_append_arrival_time, dateFormat.format(new Date(mArrivalInfo.getScheduledArrivalTime()))));</span>
                                }
<span class="nc bnc" id="L911" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11426)) {</span>
<span class="nc" id="L912">                                    sb.append(getResources().getString(R.string.ri_append_departure_time, dateFormat.format(new Date(mArrivalInfo.getScheduledDepartureTime()))));</span>
                                }
                            }
                        }
                    }
                }
            }
        }
<span class="nc" id="L920">        return sb.toString();</span>
    }

    /**
     * Creates open311 question and answer attributes to submit a report
     * Reads from dynamically created UI
     *
     * @param serviceDescription contains attribute types
     * @return List of code value pair of attributes
     */
    private List&lt;Open311AttributePair&gt; createOpen311Attributes(ServiceDescription serviceDescription) {
<span class="nc" id="L931">        List&lt;Open311AttributePair&gt; attributes = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L932" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11459)) {</span>
            {
<span class="nc" id="L934">                long _loopCounter153 = 0;</span>
<span class="nc bnc" id="L935" title="All 2 branches missed.">                for (Open311Attribute open311Attribute : serviceDescription.getAttributes()) {</span>
<span class="nc" id="L936">                    ListenerUtil.loopListener.listen(&quot;_loopCounter153&quot;, ++_loopCounter153);</span>
<span class="nc bnc" id="L937" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11458)) {</span>
<span class="nc bnc" id="L938" title="All 2 branches missed.">                        if (Boolean.valueOf(open311Attribute.getVariable())) {</span>
<span class="nc bnc" id="L939" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11457)) {</span>
<span class="nc bnc" id="L940" title="All 58 branches missed.">                                if ((ListenerUtil.mutListener.listen(11436) ? ((ListenerUtil.mutListener.listen(11435) ? ((ListenerUtil.mutListener.listen(11434) ? (Open311DataType.STRING.equals(open311Attribute.getDatatype()) &amp;&amp; Open311DataType.TEXT.equals(open311Attribute.getDatatype())) : (Open311DataType.STRING.equals(open311Attribute.getDatatype()) || Open311DataType.TEXT.equals(open311Attribute.getDatatype()))) &amp;&amp; Open311DataType.NUMBER.equals(open311Attribute.getDatatype())) : ((ListenerUtil.mutListener.listen(11434) ? (Open311DataType.STRING.equals(open311Attribute.getDatatype()) &amp;&amp; Open311DataType.TEXT.equals(open311Attribute.getDatatype())) : (Open311DataType.STRING.equals(open311Attribute.getDatatype()) || Open311DataType.TEXT.equals(open311Attribute.getDatatype()))) || Open311DataType.NUMBER.equals(open311Attribute.getDatatype()))) &amp;&amp; Open311DataType.DATETIME.equals(open311Attribute.getDatatype())) : ((ListenerUtil.mutListener.listen(11435) ? ((ListenerUtil.mutListener.listen(11434) ? (Open311DataType.STRING.equals(open311Attribute.getDatatype()) &amp;&amp; Open311DataType.TEXT.equals(open311Attribute.getDatatype())) : (Open311DataType.STRING.equals(open311Attribute.getDatatype()) || Open311DataType.TEXT.equals(open311Attribute.getDatatype()))) &amp;&amp; Open311DataType.NUMBER.equals(open311Attribute.getDatatype())) : ((ListenerUtil.mutListener.listen(11434) ? (Open311DataType.STRING.equals(open311Attribute.getDatatype()) &amp;&amp; Open311DataType.TEXT.equals(open311Attribute.getDatatype())) : (Open311DataType.STRING.equals(open311Attribute.getDatatype()) || Open311DataType.TEXT.equals(open311Attribute.getDatatype()))) || Open311DataType.NUMBER.equals(open311Attribute.getDatatype()))) || Open311DataType.DATETIME.equals(open311Attribute.getDatatype())))) {</span>
<span class="nc" id="L941">                                    EditText et = (EditText) mDynamicAttributeUIMap.get(open311Attribute.getCode());</span>
<span class="nc bnc" id="L942" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11456)) {</span>
<span class="nc bnc" id="L943" title="All 2 branches missed.">                                        if (et != null) {</span>
<span class="nc bnc" id="L944" title="All 2 branches missed.">                                            if (!ListenerUtil.mutListener.listen(11455)) {</span>
<span class="nc" id="L945">                                                attributes.add(new Open311AttributePair(open311Attribute.getCode(), et.getText().toString(), open311Attribute.getDatatype()));</span>
                                            }
                                        }
                                    }
<span class="nc bnc" id="L949" title="All 2 branches missed.">                                } else if (Open311DataType.SINGLEVALUELIST.equals(open311Attribute.getDatatype())) {</span>
<span class="nc" id="L950">                                    RadioGroup rg = (RadioGroup) mDynamicAttributeUIMap.get(open311Attribute.getCode());</span>
<span class="nc bnc" id="L951" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11454)) {</span>
<span class="nc bnc" id="L952" title="All 2 branches missed.">                                        if (rg != null) {</span>
<span class="nc" id="L953">                                            int count = rg.getChildCount();</span>
<span class="nc bnc" id="L954" title="All 2 branches missed.">                                            if (!ListenerUtil.mutListener.listen(11453)) {</span>
                                                {
<span class="nc" id="L956">                                                    long _loopCounter152 = 0;</span>
<span class="nc bnc" id="L957" title="All 22 branches missed.">                                                    for (int i = 0; (ListenerUtil.mutListener.listen(11452) ? (i &gt;= count) : (ListenerUtil.mutListener.listen(11451) ? (i &lt;= count) : (ListenerUtil.mutListener.listen(11450) ? (i &gt; count) : (ListenerUtil.mutListener.listen(11449) ? (i != count) : (ListenerUtil.mutListener.listen(11448) ? (i == count) : (i &lt; count)))))); i++) {</span>
<span class="nc" id="L958">                                                        ListenerUtil.loopListener.listen(&quot;_loopCounter152&quot;, ++_loopCounter152);</span>
<span class="nc" id="L959">                                                        RadioButton rb = (RadioButton) rg.getChildAt(i);</span>
<span class="nc bnc" id="L960" title="All 2 branches missed.">                                                        if (!ListenerUtil.mutListener.listen(11447)) {</span>
<span class="nc bnc" id="L961" title="All 2 branches missed.">                                                            if (rb.isChecked()) {</span>
<span class="nc" id="L962">                                                                String attributeKey = mOpen311AttributeKeyNameMap.get(open311Attribute.getCode() + rb.getText().toString());</span>
<span class="nc bnc" id="L963" title="All 2 branches missed.">                                                                if (!ListenerUtil.mutListener.listen(11446)) {</span>
<span class="nc" id="L964">                                                                    attributes.add(new Open311AttributePair(open311Attribute.getCode(), attributeKey, open311Attribute.getDatatype()));</span>
                                                                }
                                                                break;
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
<span class="nc bnc" id="L974" title="All 2 branches missed.">                                } else if (Open311DataType.MULTIVALUELIST.equals(open311Attribute.getDatatype())) {</span>
<span class="nc" id="L975">                                    LinearLayout ll = (LinearLayout) mDynamicAttributeUIMap.get(open311Attribute.getCode());</span>
<span class="nc bnc" id="L976" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11445)) {</span>
<span class="nc bnc" id="L977" title="All 2 branches missed.">                                        if (ll != null) {</span>
<span class="nc" id="L978">                                            int count = ll.getChildCount();</span>
<span class="nc bnc" id="L979" title="All 2 branches missed.">                                            if (!ListenerUtil.mutListener.listen(11444)) {</span>
                                                {
<span class="nc" id="L981">                                                    long _loopCounter151 = 0;</span>
<span class="nc bnc" id="L982" title="All 22 branches missed.">                                                    for (int i = 0; (ListenerUtil.mutListener.listen(11443) ? (i &gt;= count) : (ListenerUtil.mutListener.listen(11442) ? (i &lt;= count) : (ListenerUtil.mutListener.listen(11441) ? (i &gt; count) : (ListenerUtil.mutListener.listen(11440) ? (i != count) : (ListenerUtil.mutListener.listen(11439) ? (i == count) : (i &lt; count)))))); i++) {</span>
<span class="nc" id="L983">                                                        ListenerUtil.loopListener.listen(&quot;_loopCounter151&quot;, ++_loopCounter151);</span>
<span class="nc" id="L984">                                                        CheckBox cb = (CheckBox) ll.getChildAt(i);</span>
<span class="nc bnc" id="L985" title="All 2 branches missed.">                                                        if (!ListenerUtil.mutListener.listen(11438)) {</span>
<span class="nc bnc" id="L986" title="All 2 branches missed.">                                                            if (cb.isChecked()) {</span>
<span class="nc" id="L987">                                                                String attributeKey = mOpen311AttributeKeyNameMap.get(open311Attribute.getCode() + cb.getText().toString());</span>
<span class="nc bnc" id="L988" title="All 2 branches missed.">                                                                if (!ListenerUtil.mutListener.listen(11437)) {</span>
<span class="nc" id="L989">                                                                    attributes.add(new Open311AttributePair(open311Attribute.getCode(), attributeKey, open311Attribute.getDatatype()));</span>
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
<span class="nc" id="L1002">                }</span>
            }
        }
<span class="nc" id="L1005">        return attributes;</span>
    }

    /**
     * This method dynamically reads all user inputted the values from the screen and puts into a
     * list
     *
     * @param serviceDescription displayed service description
     * @return List of attribute values
     */
    private List&lt;AttributeValue&gt; createAttributeValues(ServiceDescription serviceDescription) {
<span class="nc" id="L1016">        List&lt;AttributeValue&gt; values = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L1017" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11460)) {</span>
<span class="nc bnc" id="L1018" title="All 2 branches missed.">            if (serviceDescription == null) {</span>
<span class="nc" id="L1019">                return values;</span>
            }
        }
<span class="nc bnc" id="L1022" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11495)) {</span>
            {
<span class="nc" id="L1024">                long _loopCounter156 = 0;</span>
<span class="nc bnc" id="L1025" title="All 2 branches missed.">                for (Open311Attribute open311Attribute : serviceDescription.getAttributes()) {</span>
<span class="nc" id="L1026">                    ListenerUtil.loopListener.listen(&quot;_loopCounter156&quot;, ++_loopCounter156);</span>
<span class="nc bnc" id="L1027" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11494)) {</span>
<span class="nc bnc" id="L1028" title="All 2 branches missed.">                        if (Boolean.valueOf(open311Attribute.getVariable())) {</span>
<span class="nc bnc" id="L1029" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11493)) {</span>
<span class="nc bnc" id="L1030" title="All 58 branches missed.">                                if ((ListenerUtil.mutListener.listen(11463) ? ((ListenerUtil.mutListener.listen(11462) ? ((ListenerUtil.mutListener.listen(11461) ? (Open311DataType.STRING.equals(open311Attribute.getDatatype()) &amp;&amp; Open311DataType.TEXT.equals(open311Attribute.getDatatype())) : (Open311DataType.STRING.equals(open311Attribute.getDatatype()) || Open311DataType.TEXT.equals(open311Attribute.getDatatype()))) &amp;&amp; Open311DataType.NUMBER.equals(open311Attribute.getDatatype())) : ((ListenerUtil.mutListener.listen(11461) ? (Open311DataType.STRING.equals(open311Attribute.getDatatype()) &amp;&amp; Open311DataType.TEXT.equals(open311Attribute.getDatatype())) : (Open311DataType.STRING.equals(open311Attribute.getDatatype()) || Open311DataType.TEXT.equals(open311Attribute.getDatatype()))) || Open311DataType.NUMBER.equals(open311Attribute.getDatatype()))) &amp;&amp; Open311DataType.DATETIME.equals(open311Attribute.getDatatype())) : ((ListenerUtil.mutListener.listen(11462) ? ((ListenerUtil.mutListener.listen(11461) ? (Open311DataType.STRING.equals(open311Attribute.getDatatype()) &amp;&amp; Open311DataType.TEXT.equals(open311Attribute.getDatatype())) : (Open311DataType.STRING.equals(open311Attribute.getDatatype()) || Open311DataType.TEXT.equals(open311Attribute.getDatatype()))) &amp;&amp; Open311DataType.NUMBER.equals(open311Attribute.getDatatype())) : ((ListenerUtil.mutListener.listen(11461) ? (Open311DataType.STRING.equals(open311Attribute.getDatatype()) &amp;&amp; Open311DataType.TEXT.equals(open311Attribute.getDatatype())) : (Open311DataType.STRING.equals(open311Attribute.getDatatype()) || Open311DataType.TEXT.equals(open311Attribute.getDatatype()))) || Open311DataType.NUMBER.equals(open311Attribute.getDatatype()))) || Open311DataType.DATETIME.equals(open311Attribute.getDatatype())))) {</span>
<span class="nc" id="L1031">                                    EditText et = (EditText) mDynamicAttributeUIMap.get(open311Attribute.getCode());</span>
<span class="nc bnc" id="L1032" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11492)) {</span>
<span class="nc bnc" id="L1033" title="All 2 branches missed.">                                        if (et != null) {</span>
<span class="nc" id="L1034">                                            AttributeValue value = new AttributeValue(open311Attribute.getCode());</span>
<span class="nc bnc" id="L1035" title="All 2 branches missed.">                                            if (!ListenerUtil.mutListener.listen(11490)) {</span>
<span class="nc" id="L1036">                                                value.addValue(et.getText().toString());</span>
                                            }
<span class="nc bnc" id="L1038" title="All 2 branches missed.">                                            if (!ListenerUtil.mutListener.listen(11491)) {</span>
<span class="nc" id="L1039">                                                values.add(value);</span>
                                            }
                                        }
                                    }
<span class="nc bnc" id="L1043" title="All 2 branches missed.">                                } else if (Open311DataType.SINGLEVALUELIST.equals(open311Attribute.getDatatype())) {</span>
<span class="nc" id="L1044">                                    RadioGroup rg = (RadioGroup) mDynamicAttributeUIMap.get(open311Attribute.getCode());</span>
<span class="nc bnc" id="L1045" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11489)) {</span>
<span class="nc bnc" id="L1046" title="All 2 branches missed.">                                        if (rg != null) {</span>
<span class="nc" id="L1047">                                            int count = rg.getChildCount();</span>
<span class="nc bnc" id="L1048" title="All 2 branches missed.">                                            if (!ListenerUtil.mutListener.listen(11488)) {</span>
                                                {
<span class="nc" id="L1050">                                                    long _loopCounter155 = 0;</span>
<span class="nc bnc" id="L1051" title="All 22 branches missed.">                                                    for (int i = 0; (ListenerUtil.mutListener.listen(11487) ? (i &gt;= count) : (ListenerUtil.mutListener.listen(11486) ? (i &lt;= count) : (ListenerUtil.mutListener.listen(11485) ? (i &gt; count) : (ListenerUtil.mutListener.listen(11484) ? (i != count) : (ListenerUtil.mutListener.listen(11483) ? (i == count) : (i &lt; count)))))); i++) {</span>
<span class="nc" id="L1052">                                                        ListenerUtil.loopListener.listen(&quot;_loopCounter155&quot;, ++_loopCounter155);</span>
<span class="nc" id="L1053">                                                        RadioButton rb = (RadioButton) rg.getChildAt(i);</span>
<span class="nc bnc" id="L1054" title="All 2 branches missed.">                                                        if (!ListenerUtil.mutListener.listen(11482)) {</span>
<span class="nc bnc" id="L1055" title="All 2 branches missed.">                                                            if (rb.isChecked()) {</span>
<span class="nc" id="L1056">                                                                AttributeValue value = new AttributeValue(open311Attribute.getCode());</span>
<span class="nc bnc" id="L1057" title="All 2 branches missed.">                                                                if (!ListenerUtil.mutListener.listen(11480)) {</span>
<span class="nc" id="L1058">                                                                    value.addValue(rb.getText().toString());</span>
                                                                }
<span class="nc bnc" id="L1060" title="All 2 branches missed.">                                                                if (!ListenerUtil.mutListener.listen(11481)) {</span>
<span class="nc" id="L1061">                                                                    values.add(value);</span>
                                                                }
                                                                break;
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
<span class="nc bnc" id="L1071" title="All 2 branches missed.">                                } else if (Open311DataType.MULTIVALUELIST.equals(open311Attribute.getDatatype())) {</span>
<span class="nc" id="L1072">                                    LinearLayout ll = (LinearLayout) mDynamicAttributeUIMap.get(open311Attribute.getCode());</span>
<span class="nc bnc" id="L1073" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11479)) {</span>
<span class="nc bnc" id="L1074" title="All 2 branches missed.">                                        if (ll != null) {</span>
<span class="nc" id="L1075">                                            int count = ll.getChildCount();</span>
<span class="nc" id="L1076">                                            AttributeValue value = new AttributeValue(open311Attribute.getCode());</span>
<span class="nc bnc" id="L1077" title="All 2 branches missed.">                                            if (!ListenerUtil.mutListener.listen(11471)) {</span>
                                                {
<span class="nc" id="L1079">                                                    long _loopCounter154 = 0;</span>
<span class="nc bnc" id="L1080" title="All 22 branches missed.">                                                    for (int i = 0; (ListenerUtil.mutListener.listen(11470) ? (i &gt;= count) : (ListenerUtil.mutListener.listen(11469) ? (i &lt;= count) : (ListenerUtil.mutListener.listen(11468) ? (i &gt; count) : (ListenerUtil.mutListener.listen(11467) ? (i != count) : (ListenerUtil.mutListener.listen(11466) ? (i == count) : (i &lt; count)))))); i++) {</span>
<span class="nc" id="L1081">                                                        ListenerUtil.loopListener.listen(&quot;_loopCounter154&quot;, ++_loopCounter154);</span>
<span class="nc" id="L1082">                                                        CheckBox cb = (CheckBox) ll.getChildAt(i);</span>
<span class="nc bnc" id="L1083" title="All 2 branches missed.">                                                        if (!ListenerUtil.mutListener.listen(11465)) {</span>
<span class="nc bnc" id="L1084" title="All 2 branches missed.">                                                            if (cb.isChecked()) {</span>
<span class="nc bnc" id="L1085" title="All 2 branches missed.">                                                                if (!ListenerUtil.mutListener.listen(11464)) {</span>
<span class="nc" id="L1086">                                                                    value.addValue(cb.getText().toString());</span>
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
<span class="nc bnc" id="L1093" title="All 2 branches missed.">                                            if (!ListenerUtil.mutListener.listen(11478)) {</span>
<span class="nc bnc" id="L1094" title="All 22 branches missed.">                                                if ((ListenerUtil.mutListener.listen(11476) ? (value.getValues().size() &gt;= 0) : (ListenerUtil.mutListener.listen(11475) ? (value.getValues().size() &lt;= 0) : (ListenerUtil.mutListener.listen(11474) ? (value.getValues().size() &lt; 0) : (ListenerUtil.mutListener.listen(11473) ? (value.getValues().size() != 0) : (ListenerUtil.mutListener.listen(11472) ? (value.getValues().size() == 0) : (value.getValues().size() &gt; 0)))))))</span>
<span class="nc bnc" id="L1095" title="All 2 branches missed.">                                                    if (!ListenerUtil.mutListener.listen(11477)) {</span>
<span class="nc" id="L1096">                                                        values.add(value);</span>
                                                    }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
<span class="nc" id="L1105">                }</span>
            }
        }
<span class="nc" id="L1108">        return values;</span>
    }

    /**
     * From https://developer.android.com/training/camera/photobasics.html#TaskPath
     */
    private void openCamera() {
<span class="nc" id="L1115">        Intent takePictureIntent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);</span>
<span class="nc bnc" id="L1116" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11504)) {</span>
            // Ensure that there's a camera activity to handle the intent
<span class="nc bnc" id="L1118" title="All 2 branches missed.">            if (takePictureIntent.resolveActivity(getActivity().getPackageManager()) != null) {</span>
                // Create the File where the photo should go
<span class="nc" id="L1120">                File photoFile = null;</span>
                try {
<span class="nc bnc" id="L1122" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11498)) {</span>
<span class="nc" id="L1123">                        photoFile = UIUtils.createImageFile(getContext(), null);</span>
                    }
<span class="nc" id="L1125">                } catch (IOException ex) {</span>
<span class="nc bnc" id="L1126" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11496)) {</span>
                        // Error occurred while creating the File
<span class="nc" id="L1128">                        createToastMessage(getString(R.string.ri_open_camera_problem));</span>
                    }
<span class="nc bnc" id="L1130" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11497)) {</span>
<span class="nc" id="L1131">                        Log.e(TAG, &quot;Couldn't open camera - &quot; + ex);</span>
                    }
<span class="nc" id="L1133">                }</span>
<span class="nc bnc" id="L1134" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11503)) {</span>
                    // Continue only if the File was successfully created
<span class="nc bnc" id="L1136" title="All 2 branches missed.">                    if (photoFile != null) {</span>
<span class="nc bnc" id="L1137" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11499)) {</span>
                            // Save a file: path for use with ACTION_VIEW intents
<span class="nc" id="L1139">                            mImagePath = photoFile.getAbsolutePath();</span>
                        }
<span class="nc bnc" id="L1141" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11500)) {</span>
<span class="nc" id="L1142">                            mCapturedImageURI = Uri.fromFile(photoFile);</span>
                        }
<span class="nc bnc" id="L1144" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11501)) {</span>
<span class="nc" id="L1145">                            takePictureIntent.putExtra(MediaStore.EXTRA_OUTPUT, mCapturedImageURI);</span>
                        }
<span class="nc bnc" id="L1147" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11502)) {</span>
<span class="nc" id="L1148">                            startActivityForResult(takePictureIntent, ReportConstants.CAPTURE_PICTURE_INTENT);</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L1154">    }</span>

    private void openGallery() {
<span class="nc" id="L1157">        Intent intent = new Intent(Intent.ACTION_PICK, MediaStore.Images.Media.EXTERNAL_CONTENT_URI);</span>
<span class="nc bnc" id="L1158" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11505)) {</span>
<span class="nc" id="L1159">            startActivityForResult(intent, ReportConstants.GALLERY_INTENT);</span>
        }
<span class="nc" id="L1161">    }</span>

    /**
     * Dynamically creates Open311 questions from service description
     *
     * @param serviceDescription contains Open311 questions
     */
    public void createServiceDescriptionUI(ServiceDescription serviceDescription) {
<span class="nc bnc" id="L1169" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11506)) {</span>
<span class="nc" id="L1170">            clearInfoField();</span>
        }
<span class="nc bnc" id="L1172" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11507)) {</span>
<span class="nc" id="L1173">            this.mServiceDescription = serviceDescription;</span>
        }
<span class="nc bnc" id="L1175" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11510)) {</span>
<span class="nc bnc" id="L1176" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(11508) ? (!&quot;&quot;.equals(mService.getDescription()) || mService.getDescription() != null) : (!&quot;&quot;.equals(mService.getDescription()) &amp;&amp; mService.getDescription() != null))) {</span>
<span class="nc bnc" id="L1177" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11509)) {</span>
<span class="nc" id="L1178">                    addDescriptionText(mService.getDescription());</span>
                }
            }
        }
<span class="nc bnc" id="L1182" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11513)) {</span>
<span class="nc bnc" id="L1183" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(11511) ? (mArrivalInfo != null || ServiceUtils.isTransitTripServiceByType(mService.getType())) : (mArrivalInfo != null &amp;&amp; ServiceUtils.isTransitTripServiceByType(mService.getType())))) {</span>
<span class="nc bnc" id="L1184" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11512)) {</span>
<span class="nc" id="L1185">                    createTripHeadsign(mArrivalInfo.getHeadsign());</span>
                }
            }
        }
<span class="nc bnc" id="L1189" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11523)) {</span>
            {
<span class="nc" id="L1191">                long _loopCounter157 = 0;</span>
<span class="nc bnc" id="L1192" title="All 2 branches missed.">                for (Open311Attribute open311Attribute : serviceDescription.getAttributes()) {</span>
<span class="nc" id="L1193">                    ListenerUtil.loopListener.listen(&quot;_loopCounter157&quot;, ++_loopCounter157);</span>
<span class="nc bnc" id="L1194" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11522)) {</span>
<span class="nc bnc" id="L1195" title="All 2 branches missed.">                        if (!Boolean.valueOf(open311Attribute.getVariable())) {</span>
<span class="nc bnc" id="L1196" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11521)) {</span>
<span class="nc" id="L1197">                                addDescriptionText(open311Attribute.getDescription());</span>
                            }
                        } else {
<span class="nc bnc" id="L1200" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11520)) {</span>
<span class="nc bnc" id="L1201" title="All 58 branches missed.">                                if ((ListenerUtil.mutListener.listen(11516) ? ((ListenerUtil.mutListener.listen(11515) ? ((ListenerUtil.mutListener.listen(11514) ? (Open311DataType.STRING.equals(open311Attribute.getDatatype()) &amp;&amp; Open311DataType.TEXT.equals(open311Attribute.getDatatype())) : (Open311DataType.STRING.equals(open311Attribute.getDatatype()) || Open311DataType.TEXT.equals(open311Attribute.getDatatype()))) &amp;&amp; Open311DataType.NUMBER.equals(open311Attribute.getDatatype())) : ((ListenerUtil.mutListener.listen(11514) ? (Open311DataType.STRING.equals(open311Attribute.getDatatype()) &amp;&amp; Open311DataType.TEXT.equals(open311Attribute.getDatatype())) : (Open311DataType.STRING.equals(open311Attribute.getDatatype()) || Open311DataType.TEXT.equals(open311Attribute.getDatatype()))) || Open311DataType.NUMBER.equals(open311Attribute.getDatatype()))) &amp;&amp; Open311DataType.DATETIME.equals(open311Attribute.getDatatype())) : ((ListenerUtil.mutListener.listen(11515) ? ((ListenerUtil.mutListener.listen(11514) ? (Open311DataType.STRING.equals(open311Attribute.getDatatype()) &amp;&amp; Open311DataType.TEXT.equals(open311Attribute.getDatatype())) : (Open311DataType.STRING.equals(open311Attribute.getDatatype()) || Open311DataType.TEXT.equals(open311Attribute.getDatatype()))) &amp;&amp; Open311DataType.NUMBER.equals(open311Attribute.getDatatype())) : ((ListenerUtil.mutListener.listen(11514) ? (Open311DataType.STRING.equals(open311Attribute.getDatatype()) &amp;&amp; Open311DataType.TEXT.equals(open311Attribute.getDatatype())) : (Open311DataType.STRING.equals(open311Attribute.getDatatype()) || Open311DataType.TEXT.equals(open311Attribute.getDatatype()))) || Open311DataType.NUMBER.equals(open311Attribute.getDatatype()))) || Open311DataType.DATETIME.equals(open311Attribute.getDatatype())))) {</span>
<span class="nc bnc" id="L1202" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11519)) {</span>
<span class="nc" id="L1203">                                        createEditText(open311Attribute);</span>
                                    }
<span class="nc bnc" id="L1205" title="All 2 branches missed.">                                } else if (Open311DataType.SINGLEVALUELIST.equals(open311Attribute.getDatatype())) {</span>
<span class="nc bnc" id="L1206" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11518)) {</span>
<span class="nc" id="L1207">                                        createSingleValueList(open311Attribute);</span>
                                    }
<span class="nc bnc" id="L1209" title="All 2 branches missed.">                                } else if (Open311DataType.MULTIVALUELIST.equals(open311Attribute.getDatatype())) {</span>
<span class="nc bnc" id="L1210" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11517)) {</span>
<span class="nc" id="L1211">                                        createMultiValueList(open311Attribute);</span>
                                    }
                                }
                            }
                        }
                    }
<span class="nc" id="L1217">                }</span>
            }
        }
<span class="nc" id="L1220">    }</span>

    /**
     * Dynamically creates an edit text
     *
     * @param open311Attribute contains the open311 attributes
     */
    private void createEditText(Open311Attribute open311Attribute) {
<span class="nc" id="L1228">        LayoutInflater inflater = LayoutInflater.from(getActivity());</span>
<span class="nc" id="L1229">        RelativeLayout layout = (RelativeLayout) inflater.inflate(R.layout.report_issue_text_item, null, false);</span>
<span class="nc" id="L1230">        ImageView icon = ((ImageView) layout.findViewById(R.id.ri_ic_question_answer));</span>
<span class="nc bnc" id="L1231" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11524)) {</span>
<span class="nc" id="L1232">            icon.setColorFilter(getResources().getColor(R.color.material_gray));</span>
        }
<span class="nc" id="L1234">        Spannable desc = new SpannableString(MyTextUtils.toSentenceCase(open311Attribute.getDescription()));</span>
<span class="nc" id="L1235">        EditText editText = ((EditText) layout.findViewById(R.id.riti_editText));</span>
<span class="nc bnc" id="L1236" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11528)) {</span>
<span class="nc bnc" id="L1237" title="All 2 branches missed.">            if (open311Attribute.getRequired()) {</span>
<span class="nc" id="L1238">                Spannable req = new SpannableString(&quot;(required)&quot;);</span>
<span class="nc bnc" id="L1239" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11526)) {</span>
<span class="nc" id="L1240">                    req.setSpan(new ForegroundColorSpan(Color.RED), 0, req.length(), Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);</span>
                }
<span class="nc bnc" id="L1242" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11527)) {</span>
<span class="nc" id="L1243">                    editText.setHint(TextUtils.concat(desc, &quot; &quot;, req));</span>
                }
<span class="nc" id="L1245">            } else {</span>
<span class="nc bnc" id="L1246" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11525)) {</span>
<span class="nc" id="L1247">                    editText.setHint(desc);</span>
                }
            }
        }
<span class="nc bnc" id="L1251" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11531)) {</span>
<span class="nc bnc" id="L1252" title="All 2 branches missed.">            if (Open311DataType.NUMBER.equals(open311Attribute.getDatatype())) {</span>
<span class="nc bnc" id="L1253" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11530)) {</span>
<span class="nc" id="L1254">                    editText.setInputType(InputType.TYPE_CLASS_NUMBER);</span>
                }
<span class="nc bnc" id="L1256" title="All 2 branches missed.">            } else if (Open311DataType.DATETIME.equals(open311Attribute.getDatatype())) {</span>
<span class="nc bnc" id="L1257" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11529)) {</span>
<span class="nc" id="L1258">                    editText.setInputType(InputType.TYPE_CLASS_DATETIME);</span>
                }
            }
        }
        // Restore view state from attribute result hash map
<span class="nc" id="L1263">        AttributeValue av = mAttributeValueHashMap.get(open311Attribute.getCode());</span>
<span class="nc bnc" id="L1264" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11533)) {</span>
<span class="nc bnc" id="L1265" title="All 2 branches missed.">            if (av != null) {</span>
<span class="nc bnc" id="L1266" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11532)) {</span>
<span class="nc" id="L1267">                    editText.setText(av.getSingleValue());</span>
                }
            }
        }
<span class="nc bnc" id="L1271" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11538)) {</span>
            // And if this is a bus stop field
<span class="nc bnc" id="L1273" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(11534) ? (ServiceUtils.isTransitServiceByType(mService.getType()) || ServiceUtils.isStopIdField(open311Attribute.getDescription())) : (ServiceUtils.isTransitServiceByType(mService.getType()) &amp;&amp; ServiceUtils.isStopIdField(open311Attribute.getDescription())))) {</span>
<span class="nc bnc" id="L1274" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11535)) {</span>
<span class="nc" id="L1275">                    icon.setImageDrawable(ContextCompat.getDrawable(getActivity(), R.drawable.ic_stop_flag_triangle));</span>
                }
<span class="nc" id="L1277">                ObaStop obaStop = getIssueLocationHelper().getObaStop();</span>
<span class="nc bnc" id="L1278" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11537)) {</span>
<span class="nc bnc" id="L1279" title="All 2 branches missed.">                    if (obaStop != null) {</span>
<span class="nc bnc" id="L1280" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11536)) {</span>
<span class="nc" id="L1281">                            editText.setText(obaStop.getStopCode());</span>
                        }
                    }
                }
            }
        }
<span class="nc bnc" id="L1287" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11539)) {</span>
<span class="nc" id="L1288">            mInfoLayout.addView(layout);</span>
        }
<span class="nc bnc" id="L1290" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11540)) {</span>
<span class="nc" id="L1291">            mDynamicAttributeUIMap.put(open311Attribute.getCode(), editText);</span>
        }
<span class="nc" id="L1293">    }</span>

    /**
     * Dynamically creates radio buttons
     *
     * @param open311Attribute contains the open311 attributes
     */
    private void createSingleValueList(Open311Attribute open311Attribute) {
<span class="nc" id="L1301">        ArrayList&lt;Object&gt; values = (ArrayList&lt;Object&gt;) open311Attribute.getValues();</span>
<span class="nc bnc" id="L1302" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11574)) {</span>
<span class="nc bnc" id="L1303" title="All 50 branches missed.">            if ((ListenerUtil.mutListener.listen(11546) ? (values != null || (ListenerUtil.mutListener.listen(11545) ? (values.size() &gt;= 0) : (ListenerUtil.mutListener.listen(11544) ? (values.size() &lt;= 0) : (ListenerUtil.mutListener.listen(11543) ? (values.size() &lt; 0) : (ListenerUtil.mutListener.listen(11542) ? (values.size() != 0) : (ListenerUtil.mutListener.listen(11541) ? (values.size() == 0) : (values.size() &gt; 0))))))) : (values != null &amp;&amp; (ListenerUtil.mutListener.listen(11545) ? (values.size() &gt;= 0) : (ListenerUtil.mutListener.listen(11544) ? (values.size() &lt;= 0) : (ListenerUtil.mutListener.listen(11543) ? (values.size() &lt; 0) : (ListenerUtil.mutListener.listen(11542) ? (values.size() != 0) : (ListenerUtil.mutListener.listen(11541) ? (values.size() == 0) : (values.size() &gt; 0))))))))) {</span>
<span class="nc" id="L1304">                LayoutInflater inflater = LayoutInflater.from(getActivity());</span>
<span class="nc" id="L1305">                RelativeLayout layout = (RelativeLayout) inflater.inflate(R.layout.report_issue_single_value_list_item, null, false);</span>
<span class="nc bnc" id="L1306" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11547)) {</span>
<span class="nc" id="L1307">                    layout.setSaveEnabled(true);</span>
                }
<span class="nc bnc" id="L1309" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11548)) {</span>
<span class="nc" id="L1310">                    ((ImageView) layout.findViewById(R.id.ri_ic_radio)).setColorFilter(getResources().getColor(R.color.material_gray));</span>
                }
<span class="nc" id="L1312">                Spannable word = new SpannableString(open311Attribute.getDescription());</span>
<span class="nc bnc" id="L1313" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11549)) {</span>
<span class="nc" id="L1314">                    ((TextView) layout.findViewById(R.id.risvli_textView)).setText(word);</span>
                }
<span class="nc bnc" id="L1316" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11552)) {</span>
<span class="nc bnc" id="L1317" title="All 2 branches missed.">                    if (open311Attribute.getRequired()) {</span>
<span class="nc" id="L1318">                        Spannable wordTwo = new SpannableString(&quot; *Required&quot;);</span>
<span class="nc bnc" id="L1319" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11550)) {</span>
<span class="nc" id="L1320">                            wordTwo.setSpan(new ForegroundColorSpan(Color.RED), 0, wordTwo.length(), Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);</span>
                        }
<span class="nc bnc" id="L1322" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11551)) {</span>
<span class="nc" id="L1323">                            ((TextView) layout.findViewById(R.id.risvli_textView)).append(wordTwo);</span>
                        }
                    }
                }
<span class="nc" id="L1327">                RadioGroup rg = (RadioGroup) layout.findViewById(R.id.risvli_radioGroup);</span>
<span class="nc bnc" id="L1328" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11553)) {</span>
<span class="nc" id="L1329">                    rg.setOrientation(RadioGroup.VERTICAL);</span>
                }
                // Restore view state from attribute result hash map
<span class="nc" id="L1332">                AttributeValue av = mAttributeValueHashMap.get(open311Attribute.getCode());</span>
<span class="nc" id="L1333">                String entryValue = null;</span>
<span class="nc bnc" id="L1334" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11555)) {</span>
<span class="nc bnc" id="L1335" title="All 2 branches missed.">                    if (av != null) {</span>
<span class="nc bnc" id="L1336" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11554)) {</span>
<span class="nc" id="L1337">                            entryValue = av.getSingleValue();</span>
                        }
                    }
                }
<span class="nc bnc" id="L1341" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11571)) {</span>
                    {
<span class="nc" id="L1343">                        long _loopCounter159 = 0;</span>
<span class="nc bnc" id="L1344" title="All 22 branches missed.">                        for (int i = 0; (ListenerUtil.mutListener.listen(11570) ? (i &gt;= values.size()) : (ListenerUtil.mutListener.listen(11569) ? (i &lt;= values.size()) : (ListenerUtil.mutListener.listen(11568) ? (i &gt; values.size()) : (ListenerUtil.mutListener.listen(11567) ? (i != values.size()) : (ListenerUtil.mutListener.listen(11566) ? (i == values.size()) : (i &lt; values.size())))))); i++) {</span>
<span class="nc" id="L1345">                            ListenerUtil.loopListener.listen(&quot;_loopCounter159&quot;, ++_loopCounter159);</span>
<span class="nc" id="L1346">                            LinkedHashMap&lt;String, String&gt; value = (LinkedHashMap&lt;String, String&gt;) values.get(i);</span>
<span class="nc" id="L1347">                            RadioButton rb = new RadioButton(getActivity());</span>
<span class="nc bnc" id="L1348" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11556)) {</span>
                                // the RadioButtons are added to the radioGroup instead of the layout
<span class="nc" id="L1350">                                rg.addView(rb);</span>
                            }
<span class="nc" id="L1352">                            String attributeKey = &quot;&quot;;</span>
<span class="nc" id="L1353">                            String attributeValue = &quot;&quot;;</span>
<span class="nc bnc" id="L1354" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11564)) {</span>
                                {
<span class="nc" id="L1356">                                    long _loopCounter158 = 0;</span>
<span class="nc bnc" id="L1357" title="All 2 branches missed.">                                    for (LinkedHashMap.Entry&lt;String, String&gt; entry : value.entrySet()) {</span>
<span class="nc" id="L1358">                                        ListenerUtil.loopListener.listen(&quot;_loopCounter158&quot;, ++_loopCounter158);</span>
<span class="nc bnc" id="L1359" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(11563)) {</span>
<span class="nc bnc" id="L1360" title="All 2 branches missed.">                                            if (Open311Attribute.NAME.equals(entry.getKey())) {</span>
<span class="nc bnc" id="L1361" title="All 2 branches missed.">                                                if (!ListenerUtil.mutListener.listen(11558)) {</span>
<span class="nc" id="L1362">                                                    rb.setText(entry.getValue());</span>
                                                }
<span class="nc bnc" id="L1364" title="All 2 branches missed.">                                                if (!ListenerUtil.mutListener.listen(11561)) {</span>
<span class="nc bnc" id="L1365" title="All 10 branches missed.">                                                    if ((ListenerUtil.mutListener.listen(11559) ? (entryValue != null || entryValue.equalsIgnoreCase(entry.getValue())) : (entryValue != null &amp;&amp; entryValue.equalsIgnoreCase(entry.getValue())))) {</span>
<span class="nc bnc" id="L1366" title="All 2 branches missed.">                                                        if (!ListenerUtil.mutListener.listen(11560)) {</span>
<span class="nc" id="L1367">                                                            rb.setChecked(true);</span>
                                                        }
                                                    }
                                                }
<span class="nc bnc" id="L1371" title="All 2 branches missed.">                                                if (!ListenerUtil.mutListener.listen(11562)) {</span>
<span class="nc" id="L1372">                                                    attributeKey = open311Attribute.getCode() + entry.getValue();</span>
                                                }
<span class="nc bnc" id="L1374" title="All 2 branches missed.">                                            } else if (Open311Attribute.KEY.equals(entry.getKey())) {</span>
<span class="nc bnc" id="L1375" title="All 2 branches missed.">                                                if (!ListenerUtil.mutListener.listen(11557)) {</span>
<span class="nc" id="L1376">                                                    attributeValue = entry.getValue();</span>
                                                }
                                            }
                                        }
<span class="nc" id="L1380">                                    }</span>
                                }
                            }
<span class="nc bnc" id="L1383" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11565)) {</span>
<span class="nc" id="L1384">                                mOpen311AttributeKeyNameMap.put(attributeKey, attributeValue);</span>
                            }
                        }
                    }
                }
<span class="nc bnc" id="L1389" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11572)) {</span>
<span class="nc" id="L1390">                    mInfoLayout.addView(layout);</span>
                }
<span class="nc bnc" id="L1392" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11573)) {</span>
<span class="nc" id="L1393">                    mDynamicAttributeUIMap.put(open311Attribute.getCode(), rg);</span>
                }
            }
        }
<span class="nc" id="L1397">    }</span>

    /**
     * Dynamically creates checkboxes
     *
     * @param open311Attribute contains the open311 attributes
     */
    private void createMultiValueList(Open311Attribute open311Attribute) {
<span class="nc" id="L1405">        ArrayList&lt;Object&gt; values = (ArrayList&lt;Object&gt;) open311Attribute.getValues();</span>
<span class="nc bnc" id="L1406" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11604)) {</span>
<span class="nc bnc" id="L1407" title="All 50 branches missed.">            if ((ListenerUtil.mutListener.listen(11580) ? (values != null || (ListenerUtil.mutListener.listen(11579) ? (values.size() &gt;= 0) : (ListenerUtil.mutListener.listen(11578) ? (values.size() &lt;= 0) : (ListenerUtil.mutListener.listen(11577) ? (values.size() &lt; 0) : (ListenerUtil.mutListener.listen(11576) ? (values.size() != 0) : (ListenerUtil.mutListener.listen(11575) ? (values.size() == 0) : (values.size() &gt; 0))))))) : (values != null &amp;&amp; (ListenerUtil.mutListener.listen(11579) ? (values.size() &gt;= 0) : (ListenerUtil.mutListener.listen(11578) ? (values.size() &lt;= 0) : (ListenerUtil.mutListener.listen(11577) ? (values.size() &lt; 0) : (ListenerUtil.mutListener.listen(11576) ? (values.size() != 0) : (ListenerUtil.mutListener.listen(11575) ? (values.size() == 0) : (values.size() &gt; 0))))))))) {</span>
<span class="nc" id="L1408">                LayoutInflater inflater = LayoutInflater.from(getActivity());</span>
<span class="nc" id="L1409">                RelativeLayout layout = (RelativeLayout) inflater.inflate(R.layout.report_issue_multi_value_list_item, null, false);</span>
<span class="nc bnc" id="L1410" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11581)) {</span>
<span class="nc" id="L1411">                    ((ImageView) layout.findViewById(R.id.ri_ic_checkbox)).setColorFilter(getResources().getColor(R.color.material_gray));</span>
                }
<span class="nc" id="L1413">                Spannable word = new SpannableString(open311Attribute.getDescription());</span>
<span class="nc bnc" id="L1414" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11582)) {</span>
<span class="nc" id="L1415">                    ((TextView) layout.findViewById(R.id.rimvli_textView)).setText(word);</span>
                }
<span class="nc bnc" id="L1417" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11585)) {</span>
<span class="nc bnc" id="L1418" title="All 2 branches missed.">                    if (open311Attribute.getRequired()) {</span>
<span class="nc" id="L1419">                        Spannable wordTwo = new SpannableString(&quot; *Required&quot;);</span>
<span class="nc bnc" id="L1420" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11583)) {</span>
<span class="nc" id="L1421">                            wordTwo.setSpan(new ForegroundColorSpan(Color.RED), 0, wordTwo.length(), Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);</span>
                        }
<span class="nc bnc" id="L1423" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11584)) {</span>
<span class="nc" id="L1424">                            ((TextView) layout.findViewById(R.id.rimvli_textView)).append(wordTwo);</span>
                        }
                    }
                }
                // Restore view state from attribute result hash map
<span class="nc" id="L1429">                AttributeValue av = mAttributeValueHashMap.get(open311Attribute.getCode());</span>
<span class="nc" id="L1430">                LinearLayout cg = (LinearLayout) layout.findViewById(R.id.rimvli_checkBoxGroup);</span>
<span class="nc bnc" id="L1431" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11601)) {</span>
                    {
<span class="nc" id="L1433">                        long _loopCounter161 = 0;</span>
<span class="nc bnc" id="L1434" title="All 22 branches missed.">                        for (int i = 0; (ListenerUtil.mutListener.listen(11600) ? (i &gt;= values.size()) : (ListenerUtil.mutListener.listen(11599) ? (i &lt;= values.size()) : (ListenerUtil.mutListener.listen(11598) ? (i &gt; values.size()) : (ListenerUtil.mutListener.listen(11597) ? (i != values.size()) : (ListenerUtil.mutListener.listen(11596) ? (i == values.size()) : (i &lt; values.size())))))); i++) {</span>
<span class="nc" id="L1435">                            ListenerUtil.loopListener.listen(&quot;_loopCounter161&quot;, ++_loopCounter161);</span>
<span class="nc" id="L1436">                            LinkedHashMap&lt;String, String&gt; value = (LinkedHashMap&lt;String, String&gt;) values.get(i);</span>
<span class="nc" id="L1437">                            CheckBox cb = new CheckBox(getActivity());</span>
<span class="nc bnc" id="L1438" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11586)) {</span>
<span class="nc" id="L1439">                                cg.addView(cb);</span>
                            }
<span class="nc" id="L1441">                            String attributeKey = &quot;&quot;;</span>
<span class="nc" id="L1442">                            String attributeValue = &quot;&quot;;</span>
<span class="nc bnc" id="L1443" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11594)) {</span>
                                {
<span class="nc" id="L1445">                                    long _loopCounter160 = 0;</span>
<span class="nc bnc" id="L1446" title="All 2 branches missed.">                                    for (LinkedHashMap.Entry&lt;String, String&gt; entry : value.entrySet()) {</span>
<span class="nc" id="L1447">                                        ListenerUtil.loopListener.listen(&quot;_loopCounter160&quot;, ++_loopCounter160);</span>
<span class="nc bnc" id="L1448" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(11593)) {</span>
<span class="nc bnc" id="L1449" title="All 2 branches missed.">                                            if (Open311Attribute.NAME.equals(entry.getKey())) {</span>
<span class="nc bnc" id="L1450" title="All 2 branches missed.">                                                if (!ListenerUtil.mutListener.listen(11588)) {</span>
<span class="nc" id="L1451">                                                    cb.setText(entry.getValue());</span>
                                                }
<span class="nc bnc" id="L1453" title="All 2 branches missed.">                                                if (!ListenerUtil.mutListener.listen(11591)) {</span>
<span class="nc bnc" id="L1454" title="All 10 branches missed.">                                                    if ((ListenerUtil.mutListener.listen(11589) ? (av != null || av.getValues().contains(entry.getValue())) : (av != null &amp;&amp; av.getValues().contains(entry.getValue())))) {</span>
<span class="nc bnc" id="L1455" title="All 2 branches missed.">                                                        if (!ListenerUtil.mutListener.listen(11590)) {</span>
<span class="nc" id="L1456">                                                            cb.setChecked(true);</span>
                                                        }
                                                    }
                                                }
<span class="nc bnc" id="L1460" title="All 2 branches missed.">                                                if (!ListenerUtil.mutListener.listen(11592)) {</span>
<span class="nc" id="L1461">                                                    attributeKey = open311Attribute.getCode() + entry.getValue();</span>
                                                }
<span class="nc bnc" id="L1463" title="All 2 branches missed.">                                            } else if (Open311Attribute.KEY.equals(entry.getKey())) {</span>
<span class="nc bnc" id="L1464" title="All 2 branches missed.">                                                if (!ListenerUtil.mutListener.listen(11587)) {</span>
<span class="nc" id="L1465">                                                    attributeValue = entry.getValue();</span>
                                                }
                                            }
                                        }
<span class="nc" id="L1469">                                    }</span>
                                }
                            }
<span class="nc bnc" id="L1472" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11595)) {</span>
<span class="nc" id="L1473">                                mOpen311AttributeKeyNameMap.put(attributeKey, attributeValue);</span>
                            }
                        }
                    }
                }
<span class="nc bnc" id="L1478" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11602)) {</span>
<span class="nc" id="L1479">                    mInfoLayout.addView(layout);</span>
                }
<span class="nc bnc" id="L1481" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11603)) {</span>
<span class="nc" id="L1482">                    mDynamicAttributeUIMap.put(open311Attribute.getCode(), cg);</span>
                }
            }
        }
<span class="nc" id="L1486">    }</span>

    private void createTripHeadsign(String text) {
<span class="nc" id="L1489">        LayoutInflater inflater = LayoutInflater.from(getActivity());</span>
<span class="nc" id="L1490">        RelativeLayout layout = (RelativeLayout) inflater.inflate(R.layout.report_issue_description_item, null, false);</span>
<span class="nc" id="L1491">        LinearLayout linear = (LinearLayout) findViewById(R.id.ri_report_stop_problem);</span>
<span class="nc" id="L1492">        TextView tv = ((TextView) layout.findViewById(R.id.riii_textView));</span>
<span class="nc bnc" id="L1493" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11605)) {</span>
<span class="nc" id="L1494">            tv.setText(UIUtils.formatDisplayText(text));</span>
        }
<span class="nc bnc" id="L1496" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11606)) {</span>
<span class="nc" id="L1497">            tv.setTypeface(null, Typeface.NORMAL);</span>
        }
<span class="nc bnc" id="L1499" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11607)) {</span>
<span class="nc" id="L1500">            linear.addView(layout, 0);</span>
        }
<span class="nc" id="L1502">        ImageView imageView = (ImageView) layout.findViewById(R.id.ic_action_info);</span>
<span class="nc bnc" id="L1503" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11608)) {</span>
<span class="nc" id="L1504">            imageView.setImageResource(R.drawable.ic_trip_details);</span>
        }
<span class="nc bnc" id="L1506" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11609)) {</span>
<span class="nc" id="L1507">            imageView.setColorFilter(getResources().getColor(R.color.material_gray));</span>
        }
<span class="nc" id="L1509">    }</span>

    private void clearInfoField() {
<span class="nc bnc" id="L1512" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11610)) {</span>
<span class="nc" id="L1513">            mInfoLayout.removeAllViewsInLayout();</span>
        }
<span class="nc" id="L1515">    }</span>

    private void addDescriptionText(String text) {
<span class="nc" id="L1518">        LayoutInflater inflater = LayoutInflater.from(getActivity());</span>
<span class="nc" id="L1519">        RelativeLayout layout = (RelativeLayout) inflater.inflate(R.layout.report_issue_description_item, null, false);</span>
<span class="nc bnc" id="L1520" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11611)) {</span>
<span class="nc" id="L1521">            ((TextView) layout.findViewById(R.id.riii_textView)).setText(text);</span>
        }
<span class="nc bnc" id="L1523" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11612)) {</span>
<span class="nc" id="L1524">            mInfoLayout.addView(layout);</span>
        }
<span class="nc bnc" id="L1526" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11613)) {</span>
<span class="nc" id="L1527">            ((ImageView) layout.findViewById(R.id.ic_action_info)).setColorFilter(getResources().getColor(R.color.material_gray));</span>
        }
<span class="nc" id="L1529">    }</span>

    /**
     * Set up USer contact information view
     */
    private void setUpContactInfoViews() {
<span class="nc" id="L1535">        Open311User open311User = getOpen311UserFromSharedPref();</span>
<span class="nc bnc" id="L1536" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11615)) {</span>
<span class="nc bnc" id="L1537" title="All 2 branches missed.">            if (open311User.getName() != null)</span>
<span class="nc bnc" id="L1538" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11614)) {</span>
<span class="nc" id="L1539">                    mContactNameView.setText(open311User.getName());</span>
                }
        }
<span class="nc bnc" id="L1542" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11617)) {</span>
<span class="nc bnc" id="L1543" title="All 2 branches missed.">            if (open311User.getLastName() != null)</span>
<span class="nc bnc" id="L1544" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11616)) {</span>
<span class="nc" id="L1545">                    mContactLastNameView.setText(open311User.getLastName());</span>
                }
        }
<span class="nc bnc" id="L1548" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11619)) {</span>
<span class="nc bnc" id="L1549" title="All 2 branches missed.">            if (open311User.getEmail() != null)</span>
<span class="nc bnc" id="L1550" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11618)) {</span>
<span class="nc" id="L1551">                    mContactEmailView.setText(open311User.getEmail());</span>
                }
        }
<span class="nc bnc" id="L1554" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11621)) {</span>
<span class="nc bnc" id="L1555" title="All 2 branches missed.">            if (open311User.getPhone() != null)</span>
<span class="nc bnc" id="L1556" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11620)) {</span>
<span class="nc" id="L1557">                    mContactPhoneView.setText(open311User.getPhone());</span>
                }
        }
<span class="nc" id="L1560">    }</span>

    /**
     * This method disables or enables editing for contact info fields
     *
     * @param isDisabled true if you want to disable contact info fields
     */
    private void disableEnableContactInfoViews(boolean isDisabled) {
<span class="nc bnc" id="L1568" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11622)) {</span>
<span class="nc bnc" id="L1569" title="All 2 branches missed.">            mContactNameView.setEnabled(!isDisabled);</span>
        }
<span class="nc bnc" id="L1571" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11623)) {</span>
<span class="nc bnc" id="L1572" title="All 2 branches missed.">            mContactLastNameView.setEnabled(!isDisabled);</span>
        }
<span class="nc bnc" id="L1574" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11624)) {</span>
<span class="nc bnc" id="L1575" title="All 2 branches missed.">            mContactEmailView.setEnabled(!isDisabled);</span>
        }
<span class="nc bnc" id="L1577" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11625)) {</span>
<span class="nc bnc" id="L1578" title="All 2 branches missed.">            mContactPhoneView.setEnabled(!isDisabled);</span>
        }
<span class="nc" id="L1580">    }</span>

    /**
     * Get open311 user from shared preferences
     *
     * @return Open311User
     */
    private Open311User getOpen311UserFromSharedPref() {
<span class="nc" id="L1588">        return new Open311User(PreferenceUtils.getString(ReportConstants.PREF_NAME), PreferenceUtils.getString(ReportConstants.PREF_LAST_NAME), PreferenceUtils.getString(ReportConstants.PREF_EMAIL), PreferenceUtils.getString(ReportConstants.PREF_PHONE));</span>
    }

    /**
     * Get open311 user from fields on the screen
     *
     * @return Open311User
     */
    private Open311User getOpen311UserFromUI() {
<span class="nc" id="L1597">        String name = ((EditText) findViewById(R.id.rici_name_editText)).getText().toString();</span>
<span class="nc" id="L1598">        String lastName = ((EditText) findViewById(R.id.rici_lastname_editText)).getText().toString();</span>
<span class="nc" id="L1599">        String email = ((EditText) findViewById(R.id.rici_email_editText)).getText().toString();</span>
<span class="nc" id="L1600">        String phone = ((EditText) findViewById(R.id.rici_phone_editText)).getText().toString();</span>
<span class="nc" id="L1601">        return new Open311User(name, lastName, email, phone);</span>
    }

    /**
     * Get open311 user from static strings for anonymous reporting
     *
     * @return Open311User
     */
    public Open311User getOpen311UserFromStrings() {
<span class="nc" id="L1610">        String name = getString(R.string.ri_static_user_name);</span>
<span class="nc" id="L1611">        String lastName = getString(R.string.ri_static_user_last_name);</span>
<span class="nc" id="L1612">        String email = getString(R.string.ri_static_user_email);</span>
<span class="nc" id="L1613">        String phone = getString(R.string.ri_static_user_phone);</span>
<span class="nc" id="L1614">        return new Open311User(name, lastName, email, phone);</span>
    }

    /**
     * Save open311 user to shared prefs
     */
    private void saveOpen311User() {
<span class="nc" id="L1621">        String name = ((EditText) findViewById(R.id.rici_name_editText)).getText().toString();</span>
<span class="nc" id="L1622">        String lastName = ((EditText) findViewById(R.id.rici_lastname_editText)).getText().toString();</span>
<span class="nc" id="L1623">        String email = ((EditText) findViewById(R.id.rici_email_editText)).getText().toString();</span>
<span class="nc" id="L1624">        String phone = ((EditText) findViewById(R.id.rici_phone_editText)).getText().toString();</span>
<span class="nc bnc" id="L1625" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11626)) {</span>
<span class="nc" id="L1626">            PreferenceUtils.saveString(ReportConstants.PREF_NAME, name);</span>
        }
<span class="nc bnc" id="L1628" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11627)) {</span>
<span class="nc" id="L1629">            PreferenceUtils.saveString(ReportConstants.PREF_LAST_NAME, lastName);</span>
        }
<span class="nc bnc" id="L1631" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11628)) {</span>
<span class="nc" id="L1632">            PreferenceUtils.saveString(ReportConstants.PREF_EMAIL, email);</span>
        }
<span class="nc bnc" id="L1634" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11629)) {</span>
<span class="nc" id="L1635">            PreferenceUtils.saveString(ReportConstants.PREF_PHONE, phone);</span>
        }
<span class="nc" id="L1637">    }</span>

    private IssueLocationHelper getIssueLocationHelper() {
<span class="nc" id="L1640">        return ((InfrastructureIssueActivity) getActivity()).getIssueLocationHelper();</span>
    }

    private String getCurrentAddress() {
<span class="nc" id="L1644">        String address = ((InfrastructureIssueActivity) getActivity()).getCurrentAddress();</span>
<span class="nc bnc" id="L1645" title="All 2 branches missed.">        if (TextUtils.isEmpty(address)) {</span>
<span class="nc" id="L1646">            return null;</span>
        } else {
<span class="nc" id="L1648">            return address;</span>
        }
    }

    /**
     * Show a progress icon on the action bar
     *
     * @param visible show or hide the progress icon based
     */
    private void showProgress(Boolean visible) {
<span class="nc" id="L1658">        InfrastructureIssueActivity activity = ((InfrastructureIssueActivity) getActivity());</span>
<span class="nc bnc" id="L1659" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11631)) {</span>
<span class="nc bnc" id="L1660" title="All 2 branches missed.">            if (activity != null) {</span>
<span class="nc bnc" id="L1661" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11630)) {</span>
<span class="nc" id="L1662">                    activity.showProgress(visible);</span>
                }
            }
        }
<span class="nc" id="L1666">    }</span>

    /**
     * Show a progress dialog on the screen
     *
     * @param visible show or hide the progress icon based
     */
    private void showProgressDialog(boolean visible) {
<span class="nc bnc" id="L1674" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11648)) {</span>
<span class="nc bnc" id="L1675" title="All 2 branches missed.">            if (visible) {</span>
<span class="nc bnc" id="L1676" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11636)) {</span>
<span class="nc" id="L1677">                    mIsProgressDialogShowing = true;</span>
                }
<span class="nc bnc" id="L1679" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11637)) {</span>
<span class="nc" id="L1680">                    mProgressDialog = new ProgressDialog(getActivity());</span>
                }
<span class="nc bnc" id="L1682" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11638)) {</span>
<span class="nc" id="L1683">                    mProgressDialog.setMessage(getActivity().getString(R.string.ri_submitting_message));</span>
                }
<span class="nc bnc" id="L1685" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11639)) {</span>
<span class="nc" id="L1686">                    mProgressDialog.setIndeterminate(true);</span>
                }
<span class="nc bnc" id="L1688" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11640)) {</span>
<span class="nc" id="L1689">                    mProgressDialog.setCancelable(false);</span>
                }
<span class="nc bnc" id="L1691" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11641)) {</span>
<span class="nc" id="L1692">                    mProgressDialog.setCanceledOnTouchOutside(false);</span>
                }
<span class="nc bnc" id="L1694" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11646)) {</span>
<span class="nc" id="L1695">                    mProgressDialog.setButton(ProgressDialog.BUTTON_NEGATIVE, &quot;Cancel&quot;, new DialogInterface.OnClickListener() {</span>

                        @Override
                        public void onClick(DialogInterface dialogInterface, int i) {
<span class="nc bnc" id="L1699" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11643)) {</span>
<span class="nc bnc" id="L1700" title="All 2 branches missed.">                                if (mRequestTask != null) {</span>
<span class="nc bnc" id="L1701" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11642)) {</span>
<span class="nc" id="L1702">                                        mRequestTask.cancel(true);</span>
                                    }
                                }
                            }
<span class="nc bnc" id="L1706" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11644)) {</span>
<span class="nc" id="L1707">                                mIsProgressDialogShowing = false;</span>
                            }
<span class="nc bnc" id="L1709" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11645)) {</span>
<span class="nc" id="L1710">                                mProgressDialog.dismiss();</span>
                            }
<span class="nc" id="L1712">                        }</span>
                    });
                }
<span class="nc bnc" id="L1715" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11647)) {</span>
<span class="nc" id="L1716">                    mProgressDialog.show();</span>
                }
<span class="nc bnc" id="L1718" title="All 26 branches missed.">            } else if ((ListenerUtil.mutListener.listen(11633) ? ((ListenerUtil.mutListener.listen(11632) ? (mProgressDialog != null || !visible) : (mProgressDialog != null &amp;&amp; !visible)) || mProgressDialog.isShowing()) : ((ListenerUtil.mutListener.listen(11632) ? (mProgressDialog != null || !visible) : (mProgressDialog != null &amp;&amp; !visible)) &amp;&amp; mProgressDialog.isShowing()))) {</span>
<span class="nc bnc" id="L1719" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11634)) {</span>
<span class="nc" id="L1720">                    mIsProgressDialogShowing = false;</span>
                }
<span class="nc bnc" id="L1722" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11635)) {</span>
<span class="nc" id="L1723">                    mProgressDialog.dismiss();</span>
                }
            }
        }
<span class="nc" id="L1727">    }</span>

    private boolean isActivityAttached() {
<span class="nc bnc" id="L1730" title="All 2 branches missed.">        return getActivity() != null;</span>
    }

    public void setOpen311(Open311 open311) {
<span class="nc bnc" id="L1734" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11649)) {</span>
<span class="nc" id="L1735">            mOpen311 = open311;</span>
        }
<span class="nc" id="L1737">    }</span>

    public void setService(Service service) {
<span class="nc bnc" id="L1740" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11650)) {</span>
<span class="nc" id="L1741">            mService = service;</span>
        }
<span class="nc" id="L1743">    }</span>

    public void setArrivalInfo(ObaArrivalInfo arrivalInfo) {
<span class="nc bnc" id="L1746" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11651)) {</span>
<span class="nc" id="L1747">            mArrivalInfo = arrivalInfo;</span>
        }
<span class="nc" id="L1749">    }</span>

    public void setAgencyName(String agencyName) {
<span class="nc bnc" id="L1752" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11652)) {</span>
<span class="nc" id="L1753">            this.mAgencyName = agencyName;</span>
        }
<span class="nc" id="L1755">    }</span>

    public void setBlockId(String blockId) {
<span class="nc bnc" id="L1758" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11653)) {</span>
<span class="nc" id="L1759">            mBlockId = blockId;</span>
        }
<span class="nc" id="L1761">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span>Generated by the Android Gradle plugin 8.2.0</div></body></html>