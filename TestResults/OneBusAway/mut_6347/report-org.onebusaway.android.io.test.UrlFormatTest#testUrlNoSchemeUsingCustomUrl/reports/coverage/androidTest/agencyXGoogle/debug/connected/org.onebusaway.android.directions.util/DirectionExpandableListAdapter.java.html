<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DirectionExpandableListAdapter.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">agencyXGoogleDebug</a> &gt; <a href="index.source.html" class="el_package">org.onebusaway.android.directions.util</a> &gt; <span class="el_source">DirectionExpandableListAdapter.java</span></div><h1>DirectionExpandableListAdapter.java</h1><pre class="source lang-java linenums">/*
 * Copyright 2012 University of South Florida
 * 
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *        http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and 
 * limitations under the License.
 */
package org.onebusaway.android.directions.util;

import org.onebusaway.android.R;
import org.onebusaway.android.directions.model.Direction;
import android.app.Activity;
import android.content.Context;
import android.graphics.Color;
import android.graphics.Typeface;
import android.text.SpannableString;
import android.text.TextUtils;
import android.text.style.StyleSpan;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseExpandableListAdapter;
import android.widget.ImageView;
import android.widget.TextView;
import java.util.ArrayList;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

public class DirectionExpandableListAdapter extends BaseExpandableListAdapter {

    Context mContext;

    int mDirectionLayoutResourceId;

    int mSubDirectionLayoutResourceId;

<span class="nc" id="L44">    Direction[] mData = null;</span>

<span class="nc" id="L46">    public DirectionExpandableListAdapter(Context context, int directionLayoutResourceId, int subDirectionLayoutResourceId, Direction[] data) {</span>
<span class="nc bnc" id="L47" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6069)) {</span>
<span class="nc" id="L48">            mDirectionLayoutResourceId = directionLayoutResourceId;</span>
        }
<span class="nc bnc" id="L50" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6070)) {</span>
<span class="nc" id="L51">            mSubDirectionLayoutResourceId = subDirectionLayoutResourceId;</span>
        }
<span class="nc bnc" id="L53" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6071)) {</span>
<span class="nc" id="L54">            mContext = context;</span>
        }
<span class="nc bnc" id="L56" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6072)) {</span>
<span class="nc" id="L57">            mData = data;</span>
        }
<span class="nc" id="L59">    }</span>

    @Override
    public Object getChild(int groupPosition, int childPosition) {
<span class="nc" id="L63">        ArrayList&lt;Direction&gt; subDirections = mData[groupPosition].getSubDirections();</span>
<span class="nc bnc" id="L64" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6074)) {</span>
<span class="nc bnc" id="L65" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(6073) ? (subDirections != null || !subDirections.isEmpty()) : (subDirections != null &amp;&amp; !subDirections.isEmpty()))) {</span>
<span class="nc" id="L66">                return subDirections.get(childPosition);</span>
            }
        }
<span class="nc" id="L69">        return null;</span>
    }

    @Override
    public long getChildId(int groupPosition, int childPosition) {
<span class="nc" id="L74">        return childPosition;</span>
    }

    @Override
    public int getChildrenCount(int groupPosition) {
<span class="nc" id="L79">        ArrayList&lt;Direction&gt; subDirections = mData[groupPosition].getSubDirections();</span>
<span class="nc bnc" id="L80" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6075)) {</span>
<span class="nc bnc" id="L81" title="All 2 branches missed.">            if (subDirections != null) {</span>
<span class="nc" id="L82">                return subDirections.size();</span>
            }
        }
<span class="nc" id="L85">        return 0;</span>
    }

    @Override
    public View getChildView(int groupPosition, int childPosition, boolean isLastChild, View convertView, ViewGroup parent) {
<span class="nc" id="L90">        View row = convertView;</span>
<span class="nc" id="L91">        DirectionHolder holder = null;</span>
<span class="nc bnc" id="L92" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6082)) {</span>
<span class="nc bnc" id="L93" title="All 2 branches missed.">            if (row == null) {</span>
<span class="nc" id="L94">                LayoutInflater inflater = ((Activity) mContext).getLayoutInflater();</span>
<span class="nc bnc" id="L95" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6077)) {</span>
<span class="nc" id="L96">                    row = inflater.inflate(mSubDirectionLayoutResourceId, parent, false);</span>
                }
<span class="nc bnc" id="L98" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6078)) {</span>
<span class="nc" id="L99">                    holder = new DirectionHolder();</span>
                }
<span class="nc bnc" id="L101" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6079)) {</span>
<span class="nc" id="L102">                    holder.imgIcon = (ImageView) row.findViewById(R.id.imgIcon);</span>
                }
<span class="nc bnc" id="L104" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6080)) {</span>
<span class="nc" id="L105">                    holder.txtDirection = (TextView) row.findViewById(R.id.directionText);</span>
                }
<span class="nc bnc" id="L107" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6081)) {</span>
<span class="nc" id="L108">                    row.setTag(holder);</span>
                }
<span class="nc" id="L110">            } else {</span>
<span class="nc bnc" id="L111" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6076)) {</span>
<span class="nc" id="L112">                    holder = (DirectionHolder) row.getTag();</span>
                }
            }
        }
<span class="nc" id="L116">        Direction subDirection = (Direction) getChild(groupPosition, childPosition);</span>
<span class="nc bnc" id="L117" title="All 2 branches missed.">        CharSequence text = subDirection == null ? &quot;null here&quot; : subDirection.getDirectionText();</span>
<span class="nc bnc" id="L118" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6083)) {</span>
<span class="nc" id="L119">            holder.txtDirection.setText(text);</span>
        }
<span class="nc bnc" id="L121" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6087)) {</span>
<span class="nc bnc" id="L122" title="All 2 branches missed.">            if (subDirection.getIcon() != -1) {</span>
<span class="nc bnc" id="L123" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6085)) {</span>
<span class="nc" id="L124">                    holder.imgIcon.setImageResource(subDirection.getIcon());</span>
                }
<span class="nc bnc" id="L126" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6086)) {</span>
<span class="nc" id="L127">                    holder.imgIcon.setColorFilter(Color.GRAY);</span>
                }
            } else {
<span class="nc bnc" id="L130" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6084)) {</span>
<span class="nc" id="L131">                    holder.imgIcon.setVisibility(View.INVISIBLE);</span>
                }
            }
        }
<span class="nc" id="L135">        return row;</span>
    }

    @Override
    public Object getGroup(int groupPosition) {
<span class="nc" id="L140">        return mData[groupPosition];</span>
    }

    @Override
    public int getGroupCount() {
<span class="nc" id="L145">        return mData.length;</span>
    }

    @Override
    public long getGroupId(int groupPosition) {
<span class="nc" id="L150">        return groupPosition;</span>
    }

    @Override
    public View getGroupView(int groupPosition, boolean isExpanded, View convertView, ViewGroup parent) {
<span class="nc" id="L155">        View row = convertView;</span>
<span class="nc" id="L156">        DirectionHolder holder = null;</span>
<span class="nc bnc" id="L157" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6095)) {</span>
<span class="nc bnc" id="L158" title="All 2 branches missed.">            if (row == null) {</span>
<span class="nc" id="L159">                LayoutInflater inflater = ((Activity) mContext).getLayoutInflater();</span>
<span class="nc bnc" id="L160" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6089)) {</span>
<span class="nc" id="L161">                    row = inflater.inflate(mDirectionLayoutResourceId, parent, false);</span>
                }
<span class="nc bnc" id="L163" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6090)) {</span>
<span class="nc" id="L164">                    holder = new DirectionHolder();</span>
                }
<span class="nc bnc" id="L166" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6091)) {</span>
<span class="nc" id="L167">                    holder.imgIcon = (ImageView) row.findViewById(R.id.imgIcon);</span>
                }
<span class="nc bnc" id="L169" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6092)) {</span>
<span class="nc" id="L170">                    holder.noIconText = (TextView) row.findViewById(R.id.noIconText);</span>
                }
<span class="nc bnc" id="L172" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6093)) {</span>
<span class="nc" id="L173">                    holder.txtDirection = (TextView) row.findViewById(R.id.directionText);</span>
                }
<span class="nc bnc" id="L175" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6094)) {</span>
<span class="nc" id="L176">                    row.setTag(holder);</span>
                }
<span class="nc" id="L178">            } else {</span>
<span class="nc bnc" id="L179" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6088)) {</span>
<span class="nc" id="L180">                    holder = (DirectionHolder) row.getTag();</span>
                }
            }
        }
<span class="nc" id="L184">        Direction dir = mData[groupPosition];</span>
<span class="nc bnc" id="L185" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6114)) {</span>
<span class="nc bnc" id="L186" title="All 2 branches missed.">            if (!dir.isTransit()) {</span>
<span class="nc bnc" id="L187" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6108)) {</span>
<span class="nc" id="L188">                    holder.txtDirection.setText(dir.getDirectionIndex() + &quot;. &quot; + dir.getDirectionText());</span>
                }
<span class="nc bnc" id="L190" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6109)) {</span>
<span class="nc" id="L191">                    holder.imgIcon.setVisibility(View.VISIBLE);</span>
                }
<span class="nc bnc" id="L193" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6113)) {</span>
<span class="nc bnc" id="L194" title="All 2 branches missed.">                    if (dir.getIcon() != -1) {</span>
<span class="nc bnc" id="L195" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(6111)) {</span>
<span class="nc" id="L196">                            holder.imgIcon.setImageResource(dir.getIcon());</span>
                        }
<span class="nc bnc" id="L198" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(6112)) {</span>
<span class="nc" id="L199">                            holder.imgIcon.setColorFilter(Color.GRAY);</span>
                        }
                    } else {
<span class="nc bnc" id="L202" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(6110)) {</span>
<span class="nc" id="L203">                            holder.imgIcon.setVisibility(View.INVISIBLE);</span>
                        }
                    }
                }
            } else {
<span class="nc" id="L208">                CharSequence textBeforeTime = dir.getDirectionIndex() + &quot;. &quot; + dir.getService();</span>
                CharSequence text;
<span class="nc" id="L210">                CharSequence time = dir.getOldTime();</span>
<span class="nc" id="L211">                text = new SpannableString(textBeforeTime);</span>
<span class="nc bnc" id="L212" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6098)) {</span>
<span class="nc bnc" id="L213" title="All 2 branches missed.">                    if (dir.isRealTimeInfo()) {</span>
<span class="nc bnc" id="L214" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(6097)) {</span>
<span class="nc bnc" id="L215" title="All 2 branches missed.">                            if (dir.getNewTime() != null) {</span>
<span class="nc bnc" id="L216" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(6096)) {</span>
<span class="nc" id="L217">                                    time = dir.getNewTime();</span>
                                }
                            }
                        }
                    }
                }
<span class="nc" id="L223">                text = TextUtils.concat(text, &quot; &quot;, time, &quot;\n&quot;, dir.getPlaceAndHeadsign());</span>
<span class="nc bnc" id="L224" title="All 2 branches missed.">                if (!TextUtils.isEmpty(dir.getAgency())) {</span>
<span class="nc" id="L225">                    text = TextUtils.concat(text, &quot;\n&quot;, dir.getAgency());</span>
                }
<span class="nc bnc" id="L227" title="All 2 branches missed.">                if (!TextUtils.isEmpty(dir.getExtra())) {</span>
<span class="nc" id="L228">                    SpannableString extraSpannableString = new SpannableString(dir.getExtra());</span>
<span class="nc bnc" id="L229" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(6099)) {</span>
<span class="nc" id="L230">                        extraSpannableString.setSpan(new StyleSpan(Typeface.ITALIC), 0, extraSpannableString.length(), 0);</span>
                    }
<span class="nc" id="L232">                    text = TextUtils.concat(text, &quot;\n&quot;, extraSpannableString);</span>
                }
<span class="nc bnc" id="L234" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6100)) {</span>
<span class="nc" id="L235">                    holder.txtDirection.setText(text);</span>
                }
<span class="nc bnc" id="L237" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6107)) {</span>
<span class="nc bnc" id="L238" title="All 2 branches missed.">                    if (dir.getIcon() == -1) {</span>
<span class="nc bnc" id="L239" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(6105)) {</span>
<span class="nc" id="L240">                            holder.imgIcon.setVisibility(View.INVISIBLE);</span>
                        }
<span class="nc bnc" id="L242" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(6106)) {</span>
<span class="nc" id="L243">                            holder.noIconText.setVisibility(View.VISIBLE);</span>
                        }
                    } else {
<span class="nc bnc" id="L246" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(6101)) {</span>
<span class="nc" id="L247">                            holder.imgIcon.setVisibility(View.VISIBLE);</span>
                        }
<span class="nc bnc" id="L249" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(6102)) {</span>
<span class="nc" id="L250">                            holder.imgIcon.setImageResource(dir.getIcon());</span>
                        }
<span class="nc bnc" id="L252" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(6103)) {</span>
<span class="nc" id="L253">                            holder.imgIcon.setColorFilter(Color.GRAY);</span>
                        }
<span class="nc bnc" id="L255" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(6104)) {</span>
<span class="nc" id="L256">                            holder.noIconText.setVisibility(View.INVISIBLE);</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L262">        return row;</span>
    }

    @Override
    public boolean isChildSelectable(int groupPosition, int childPosition) {
<span class="nc" id="L267">        return true;</span>
    }

    @Override
    public boolean hasStableIds() {
<span class="nc" id="L272">        return true;</span>
    }

<span class="nc" id="L275">    static class DirectionHolder {</span>

        ImageView imgIcon;

        TextView noIconText;

        TextView txtDirection;
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span>Generated by the Android Gradle plugin 8.2.0</div></body></html>