<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>MyRecentStopsAndRoutesActivity.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">agencyXGoogleDebug</a> &gt; <a href="index.source.html" class="el_package">org.onebusaway.android.ui</a> &gt; <span class="el_source">MyRecentStopsAndRoutesActivity.java</span></div><h1>MyRecentStopsAndRoutesActivity.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2010-2015 Paul Watts (paulcwatts@gmail.com),
 * University of South Florida (sjbarbeau@gmail.com)
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.onebusaway.android.ui;

import android.content.Intent;
import android.content.SharedPreferences;
import android.content.res.Resources;
import android.os.Bundle;
import org.onebusaway.android.R;
import org.onebusaway.android.app.Application;
import org.onebusaway.android.util.PreferenceUtils;
import org.onebusaway.android.util.UIUtils;
import androidx.appcompat.app.ActionBar;
import androidx.core.content.ContextCompat;
import androidx.core.content.pm.ShortcutInfoCompat;
import androidx.core.content.pm.ShortcutManagerCompat;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

<span class="nc" id="L33">public class MyRecentStopsAndRoutesActivity extends MyTabActivityBase {</span>

    @Override
    protected void onCreate(Bundle savedInstanceState) {
<span class="nc bnc" id="L37" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(157)) {</span>
<span class="nc" id="L38">            super.onCreate(savedInstanceState);</span>
        }
<span class="nc" id="L40">        Intent myIntent = getIntent();</span>
<span class="nc bnc" id="L41" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(161)) {</span>
<span class="nc bnc" id="L42" title="All 2 branches missed.">            if (Intent.ACTION_CREATE_SHORTCUT.equals(myIntent.getAction())) {</span>
<span class="nc" id="L43">                ShortcutInfoCompat shortcut = getShortcut();</span>
<span class="nc bnc" id="L44" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(158)) {</span>
<span class="nc" id="L45">                    ShortcutManagerCompat.requestPinShortcut(this, shortcut, null);</span>
                }
<span class="nc bnc" id="L47" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(159)) {</span>
<span class="nc" id="L48">                    setResult(RESULT_OK, shortcut.getIntent());</span>
                }
<span class="nc bnc" id="L50" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(160)) {</span>
<span class="nc" id="L51">                    finish();</span>
                }
            }
        }
<span class="nc" id="L55">        final Resources res = getResources();</span>
<span class="nc" id="L56">        final ActionBar bar = getSupportActionBar();</span>
<span class="nc bnc" id="L57" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(162)) {</span>
<span class="nc" id="L58">            bar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);</span>
        }
<span class="nc bnc" id="L60" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(163)) {</span>
<span class="nc" id="L61">            bar.setDisplayOptions(0, ActionBar.DISPLAY_SHOW_TITLE);</span>
        }
<span class="nc bnc" id="L63" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(164)) {</span>
<span class="nc" id="L64">            bar.addTab(bar.newTab().setTag(MyRecentStopsFragment.TAB_NAME).setText(res.getString(R.string.my_recent_stops)).setIcon(ContextCompat.getDrawable(this, R.drawable.ic_tab_recent)).setTabListener(new TabListener&lt;MyRecentStopsFragment&gt;(this, MyRecentStopsFragment.TAB_NAME, MyRecentStopsFragment.class)));</span>
        }
<span class="nc bnc" id="L66" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(165)) {</span>
<span class="nc" id="L67">            bar.addTab(bar.newTab().setTag(MyRecentRoutesFragment.TAB_NAME).setText(res.getString(R.string.my_recent_routes)).setIcon(ContextCompat.getDrawable(this, R.drawable.ic_tab_recent)).setTabListener(new TabListener&lt;MyRecentRoutesFragment&gt;(this, MyRecentRoutesFragment.TAB_NAME, MyRecentRoutesFragment.class)));</span>
        }
<span class="nc bnc" id="L69" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(166)) {</span>
<span class="nc" id="L70">            restoreDefaultTab();</span>
        }
<span class="nc bnc" id="L72" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(167)) {</span>
<span class="nc" id="L73">            UIUtils.setupActionBar(this);</span>
        }
<span class="nc bnc" id="L75" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(168)) {</span>
<span class="nc" id="L76">            setTitle(R.string.my_recent_title);</span>
        }
<span class="nc" id="L78">    }</span>

    @Override
    protected String getLastTabPref() {
<span class="nc" id="L82">        return &quot;RecentRoutesStopsActivity.LastTab&quot;;</span>
    }

    /**
     * Override default tab handling behavior of MyTabActivityBase - use tab text instead of tag
     * for saving to preference. See #585.
     */
    @Override
    protected void restoreDefaultTab() {
        final String def;
<span class="nc bnc" id="L92" title="All 2 branches missed.">        if (mDefaultTab != null) {</span>
<span class="nc" id="L93">            def = mDefaultTab;</span>
<span class="nc bnc" id="L94" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(186)) {</span>
<span class="nc bnc" id="L95" title="All 2 branches missed.">                if (def != null) {</span>
                    // Find this tab...
<span class="nc" id="L97">                    final ActionBar bar = getSupportActionBar();</span>
<span class="nc bnc" id="L98" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(185)) {</span>
                        {
<span class="nc" id="L100">                            long _loopCounter1 = 0;</span>
<span class="nc bnc" id="L101" title="All 22 branches missed.">                            for (int i = 0; (ListenerUtil.mutListener.listen(184) ? (i &gt;= bar.getTabCount()) : (ListenerUtil.mutListener.listen(183) ? (i &lt;= bar.getTabCount()) : (ListenerUtil.mutListener.listen(182) ? (i &gt; bar.getTabCount()) : (ListenerUtil.mutListener.listen(181) ? (i != bar.getTabCount()) : (ListenerUtil.mutListener.listen(180) ? (i == bar.getTabCount()) : (i &lt; bar.getTabCount())))))); ++i) {</span>
<span class="nc" id="L102">                                ListenerUtil.loopListener.listen(&quot;_loopCounter1&quot;, ++_loopCounter1);</span>
<span class="nc" id="L103">                                ActionBar.Tab tab = bar.getTabAt(i);</span>
<span class="nc bnc" id="L104" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(179)) {</span>
                                    // Still use tab.getTag() here, as its driven by intent or saved instance state
<span class="nc bnc" id="L106" title="All 2 branches missed.">                                    if (def.equals(tab.getTag())) {</span>
<span class="nc bnc" id="L107" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(178)) {</span>
<span class="nc" id="L108">                                            tab.select();</span>
                                        }
                                    }
                                }
                            }
                        }
                    }
<span class="nc" id="L115">                }</span>
            }
        } else {
<span class="nc" id="L118">            SharedPreferences settings = Application.getPrefs();</span>
<span class="nc" id="L119">            def = settings.getString(getLastTabPref(), null);</span>
<span class="nc bnc" id="L120" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(177)) {</span>
<span class="nc bnc" id="L121" title="All 2 branches missed.">                if (def != null) {</span>
                    // Find this tab...
<span class="nc" id="L123">                    final ActionBar bar = getSupportActionBar();</span>
<span class="nc bnc" id="L124" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(176)) {</span>
                        {
<span class="nc" id="L126">                            long _loopCounter0 = 0;</span>
<span class="nc bnc" id="L127" title="All 22 branches missed.">                            for (int i = 0; (ListenerUtil.mutListener.listen(175) ? (i &gt;= bar.getTabCount()) : (ListenerUtil.mutListener.listen(174) ? (i &lt;= bar.getTabCount()) : (ListenerUtil.mutListener.listen(173) ? (i &gt; bar.getTabCount()) : (ListenerUtil.mutListener.listen(172) ? (i != bar.getTabCount()) : (ListenerUtil.mutListener.listen(171) ? (i == bar.getTabCount()) : (i &lt; bar.getTabCount())))))); ++i) {</span>
<span class="nc" id="L128">                                ListenerUtil.loopListener.listen(&quot;_loopCounter0&quot;, ++_loopCounter0);</span>
<span class="nc" id="L129">                                ActionBar.Tab tab = bar.getTabAt(i);</span>
<span class="nc bnc" id="L130" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(170)) {</span>
<span class="nc bnc" id="L131" title="All 2 branches missed.">                                    if (def.equals(tab.getText())) {</span>
<span class="nc bnc" id="L132" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(169)) {</span>
<span class="nc" id="L133">                                            tab.select();</span>
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
<span class="nc" id="L143">    }</span>

    /**
     * Override default tab handling behavior of MyTabActivityBase - use tab text instead of tag
     * for saving to preference. See #585.
     */
    @Override
    public void onDestroy() {
<span class="nc bnc" id="L151" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(189)) {</span>
            // If there was a tab in the intent, don't save it
<span class="nc bnc" id="L153" title="All 2 branches missed.">            if (mDefaultTab == null) {</span>
<span class="nc" id="L154">                final ActionBar bar = getSupportActionBar();</span>
<span class="nc" id="L155">                final ActionBar.Tab tab = bar.getSelectedTab();</span>
<span class="nc bnc" id="L156" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(187)) {</span>
<span class="nc" id="L157">                    PreferenceUtils.saveString(getLastTabPref(), (String) tab.getText());</span>
                }
<span class="nc bnc" id="L159" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(188)) {</span>
                    // preference we set above.  FIXME - this is a total hack.
<span class="nc" id="L161">                    mDefaultTab = &quot;hack&quot;;</span>
                }
            }
        }
<span class="nc bnc" id="L165" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(190)) {</span>
<span class="nc" id="L166">            super.onDestroy();</span>
        }
<span class="nc" id="L168">    }</span>

    private ShortcutInfoCompat getShortcut() {
<span class="nc" id="L171">        return UIUtils.makeShortcutInfo(this, getString(R.string.my_recent_title), new Intent(this, MyRecentStopsAndRoutesActivity.class), R.drawable.ic_history);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span>Generated by the Android Gradle plugin 8.2.0</div></body></html>