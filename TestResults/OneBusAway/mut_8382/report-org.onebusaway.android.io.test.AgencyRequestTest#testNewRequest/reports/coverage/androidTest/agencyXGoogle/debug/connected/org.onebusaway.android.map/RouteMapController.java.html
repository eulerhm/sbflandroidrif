<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>RouteMapController.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">agencyXGoogleDebug</a> &gt; <a href="index.source.html" class="el_package">org.onebusaway.android.map</a> &gt; <span class="el_source">RouteMapController.java</span></div><h1>RouteMapController.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2011-2014 Paul Watts (paulcwatts@gmail.com),
 * University of South Florida (sjbarbeau@gmail.com), and individual contributors.
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.onebusaway.android.map;

import org.onebusaway.android.R;
import org.onebusaway.android.app.Application;
import org.onebusaway.android.io.ObaApi;
import org.onebusaway.android.io.elements.ObaRoute;
import org.onebusaway.android.io.elements.ObaStop;
import org.onebusaway.android.io.request.ObaStopsForRouteRequest;
import org.onebusaway.android.io.request.ObaStopsForRouteResponse;
import org.onebusaway.android.io.request.ObaTripsForRouteRequest;
import org.onebusaway.android.io.request.ObaTripsForRouteResponse;
import org.onebusaway.android.map.googlemapsv2.BaseMapFragment;
import org.onebusaway.android.util.LocationUtils;
import org.onebusaway.android.util.UIUtils;
import android.app.Activity;
import android.content.Context;
import android.location.Location;
import android.os.Bundle;
import android.os.Handler;
import android.text.TextUtils;
import android.util.Log;
import android.view.View;
import android.widget.ProgressBar;
import android.widget.TextView;
import java.util.HashSet;
import java.util.List;
import java.util.concurrent.TimeUnit;
import androidx.loader.app.LoaderManager;
import androidx.loader.content.AsyncTaskLoader;
import androidx.loader.content.Loader;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

public class RouteMapController implements MapModeController {

    private static final String TAG = &quot;RouteMapController&quot;;

    private static final int ROUTES_LOADER = 5677;

    private static final int VEHICLES_LOADER = 5678;

    private final Callback mFragment;

    private String mRouteId;

    private boolean mZoomToRoute;

    private boolean mZoomIncludeClosestVehicle;

    private int mLineOverlayColor;

    private RoutePopup mRoutePopup;

    private int mShortAnimationDuration;

    // available in SherlockMapActivity
    private Loader&lt;ObaStopsForRouteResponse&gt; mRouteLoader;

    private RouteLoaderListener mRouteLoaderListener;

    private Loader&lt;ObaTripsForRouteResponse&gt; mVehiclesLoader;

    private VehicleLoaderListener mVehicleLoaderListener;

    private long mLastUpdatedTimeVehicles;

<span class="nc" id="L82">    public RouteMapController(Callback callback) {</span>
<span class="nc" id="L83">        mFragment = callback;</span>
<span class="nc bnc" id="L84" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10046)) {</span>
<span class="nc" id="L85">            mLineOverlayColor = mFragment.getActivity().getResources().getColor(R.color.route_line_color_default);</span>
        }
<span class="nc bnc" id="L87" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10047)) {</span>
<span class="nc" id="L88">            mShortAnimationDuration = mFragment.getActivity().getResources().getInteger(android.R.integer.config_shortAnimTime);</span>
        }
<span class="nc bnc" id="L90" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10048)) {</span>
<span class="nc" id="L91">            mRoutePopup = new RoutePopup();</span>
        }
<span class="nc bnc" id="L93" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10049)) {</span>
<span class="nc" id="L94">            mRouteLoaderListener = new RouteLoaderListener();</span>
        }
<span class="nc bnc" id="L96" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10050)) {</span>
<span class="nc" id="L97">            mVehicleLoaderListener = new VehicleLoaderListener();</span>
        }
<span class="nc" id="L99">    }</span>

    @Override
    public void setState(Bundle args) {
<span class="nc bnc" id="L103" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10051)) {</span>
<span class="nc bnc" id="L104" title="All 2 branches missed.">            if (args == null) {</span>
<span class="nc" id="L105">                throw new IllegalArgumentException(&quot;args cannot be null&quot;);</span>
            }
        }
<span class="nc" id="L108">        String routeId = args.getString(MapParams.ROUTE_ID);</span>
        // If the previous map zoom isn't the default, then zoom to that level as a start
<span class="nc" id="L110">        float mapZoom = args.getFloat(MapParams.ZOOM, MapParams.DEFAULT_ZOOM);</span>
<span class="nc bnc" id="L111" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10053)) {</span>
<span class="nc bnc" id="L112" title="All 2 branches missed.">            if (mapZoom != MapParams.DEFAULT_ZOOM) {</span>
<span class="nc bnc" id="L113" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10052)) {</span>
<span class="nc" id="L114">                    mFragment.getMapView().setZoom(mapZoom);</span>
                }
            }
        }
<span class="nc bnc" id="L118" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10054)) {</span>
<span class="nc" id="L119">            mZoomToRoute = args.getBoolean(MapParams.ZOOM_TO_ROUTE, false);</span>
        }
<span class="nc bnc" id="L121" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10055)) {</span>
<span class="nc" id="L122">            mZoomIncludeClosestVehicle = args.getBoolean(MapParams.ZOOM_INCLUDE_CLOSEST_VEHICLE, false);</span>
        }
<span class="nc bnc" id="L124" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10068)) {</span>
<span class="nc bnc" id="L125" title="All 2 branches missed.">            if (!routeId.equals(mRouteId)) {</span>
<span class="nc bnc" id="L126" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10058)) {</span>
<span class="nc bnc" id="L127" title="All 2 branches missed.">                    if (mRouteId != null) {</span>
<span class="nc bnc" id="L128" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(10057)) {</span>
<span class="nc" id="L129">                            clearCurrentState();</span>
                        }
                    }
                }
<span class="nc bnc" id="L133" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10059)) {</span>
                    // Set up the new route
<span class="nc" id="L135">                    mRouteId = routeId;</span>
                }
<span class="nc bnc" id="L137" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10060)) {</span>
<span class="nc" id="L138">                    mRoutePopup.showLoading();</span>
                }
<span class="nc bnc" id="L140" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10061)) {</span>
<span class="nc" id="L141">                    mFragment.showProgress(true);</span>
                }
<span class="nc bnc" id="L143" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10062)) {</span>
                    // mFragment.getLoaderManager().restartLoader(ROUTES_LOADER, null, this);
<span class="nc" id="L145">                    mRouteLoader = mRouteLoaderListener.onCreateLoader(ROUTES_LOADER, null);</span>
                }
<span class="nc bnc" id="L147" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10063)) {</span>
<span class="nc" id="L148">                    mRouteLoader.registerListener(0, mRouteLoaderListener);</span>
                }
<span class="nc bnc" id="L150" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10064)) {</span>
<span class="nc" id="L151">                    mRouteLoader.startLoading();</span>
                }
<span class="nc bnc" id="L153" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10065)) {</span>
<span class="nc" id="L154">                    mVehiclesLoader = mVehicleLoaderListener.onCreateLoader(VEHICLES_LOADER, null);</span>
                }
<span class="nc bnc" id="L156" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10066)) {</span>
<span class="nc" id="L157">                    mVehiclesLoader.registerListener(0, mVehicleLoaderListener);</span>
                }
<span class="nc bnc" id="L159" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10067)) {</span>
<span class="nc" id="L160">                    mVehiclesLoader.startLoading();</span>
                }
            } else {
<span class="nc bnc" id="L163" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10056)) {</span>
                    // We are returning to the route view with the route already set, so show the header
<span class="nc" id="L165">                    mRoutePopup.show();</span>
                }
            }
        }
<span class="nc" id="L169">    }</span>

    /**
     * Clears the current state of the controller, so a new route can be loaded
     */
    private void clearCurrentState() {
<span class="nc bnc" id="L175" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10069)) {</span>
            // Stop loaders and refresh handler
<span class="nc" id="L177">            mRouteLoader.stopLoading();</span>
        }
<span class="nc bnc" id="L179" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10070)) {</span>
<span class="nc" id="L180">            mRouteLoader.reset();</span>
        }
<span class="nc bnc" id="L182" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10071)) {</span>
<span class="nc" id="L183">            mVehiclesLoader.stopLoading();</span>
        }
<span class="nc bnc" id="L185" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10072)) {</span>
<span class="nc" id="L186">            mVehiclesLoader.reset();</span>
        }
<span class="nc bnc" id="L188" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10073)) {</span>
<span class="nc" id="L189">            mVehicleRefreshHandler.removeCallbacks(mVehicleRefresh);</span>
        }
<span class="nc bnc" id="L191" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10074)) {</span>
            // Clear the existing route and vehicle overlays
<span class="nc" id="L193">            mFragment.getMapView().removeRouteOverlay();</span>
        }
<span class="nc bnc" id="L195" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10075)) {</span>
<span class="nc" id="L196">            mFragment.getMapView().removeVehicleOverlay();</span>
        }
<span class="nc bnc" id="L198" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10076)) {</span>
            // Clear the existing stop icons, but leave the currently focused stop
<span class="nc" id="L200">            mFragment.getMapView().removeStopOverlay(false);</span>
        }
<span class="nc" id="L202">    }</span>

    @Override
    public String getMode() {
<span class="nc" id="L206">        return MapParams.MODE_ROUTE;</span>
    }

    @Override
    public void destroy() {
<span class="nc bnc" id="L211" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10077)) {</span>
<span class="nc" id="L212">            mRoutePopup.hide();</span>
        }
<span class="nc bnc" id="L214" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10078)) {</span>
<span class="nc" id="L215">            mFragment.getMapView().removeRouteOverlay();</span>
        }
<span class="nc bnc" id="L217" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10079)) {</span>
<span class="nc" id="L218">            mVehicleRefreshHandler.removeCallbacks(mVehicleRefresh);</span>
        }
<span class="nc bnc" id="L220" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10080)) {</span>
<span class="nc" id="L221">            mFragment.getMapView().removeVehicleOverlay();</span>
        }
<span class="nc" id="L223">    }</span>

    @Override
    public void onPause() {
<span class="nc bnc" id="L227" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10081)) {</span>
<span class="nc" id="L228">            mVehicleRefreshHandler.removeCallbacks(mVehicleRefresh);</span>
        }
<span class="nc" id="L230">    }</span>

    /**
     * This is called when fm.beginTransaction().hide() or fm.beginTransaction().show() is called
     *
     * @param hidden True if the fragment is now hidden, false if it is not visible.
     */
    @Override
    public void onHidden(boolean hidden) {
<span class="nc bnc" id="L239" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10084)) {</span>
            // If the fragment is no longer visible, hide the route header - otherwise, show it
<span class="nc bnc" id="L241" title="All 2 branches missed.">            if (hidden) {</span>
<span class="nc bnc" id="L242" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10083)) {</span>
<span class="nc" id="L243">                    mRoutePopup.hide();</span>
                }
            } else {
<span class="nc bnc" id="L246" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10082)) {</span>
<span class="nc" id="L247">                    mRoutePopup.show();</span>
                }
            }
        }
<span class="nc" id="L251">    }</span>

    @Override
    public void onResume() {
<span class="nc bnc" id="L255" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10085)) {</span>
            // Make sure we schedule a future update for vehicles
<span class="nc" id="L257">            mVehicleRefreshHandler.removeCallbacks(mVehicleRefresh);</span>
        }
<span class="nc bnc" id="L259" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10092)) {</span>
<span class="nc bnc" id="L260" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(10090) ? (mLastUpdatedTimeVehicles &gt;= 0) : (ListenerUtil.mutListener.listen(10089) ? (mLastUpdatedTimeVehicles &lt;= 0) : (ListenerUtil.mutListener.listen(10088) ? (mLastUpdatedTimeVehicles &gt; 0) : (ListenerUtil.mutListener.listen(10087) ? (mLastUpdatedTimeVehicles &lt; 0) : (ListenerUtil.mutListener.listen(10086) ? (mLastUpdatedTimeVehicles != 0) : (mLastUpdatedTimeVehicles == 0))))))) {</span>
<span class="nc bnc" id="L261" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10091)) {</span>
                    // to the loader to reschedule when load is complete
<span class="nc" id="L263">                    mVehicleRefreshHandler.postDelayed(mVehicleRefresh, VEHICLE_REFRESH_PERIOD);</span>
                }
<span class="nc" id="L265">                return;</span>
            }
        }
<span class="nc bnc" id="L268" title="All 8 branches missed.">        long elapsedTimeMillis = TimeUnit.NANOSECONDS.toMillis((ListenerUtil.mutListener.listen(10096) ? (UIUtils.getCurrentTimeForComparison() % mLastUpdatedTimeVehicles) : (ListenerUtil.mutListener.listen(10095) ? (UIUtils.getCurrentTimeForComparison() / mLastUpdatedTimeVehicles) : (ListenerUtil.mutListener.listen(10094) ? (UIUtils.getCurrentTimeForComparison() * mLastUpdatedTimeVehicles) : (ListenerUtil.mutListener.listen(10093) ? (UIUtils.getCurrentTimeForComparison() + mLastUpdatedTimeVehicles) : (UIUtils.getCurrentTimeForComparison() - mLastUpdatedTimeVehicles))))));</span>
        long refreshPeriod;
<span class="nc bnc" id="L270" title="All 22 branches missed.">        if ((ListenerUtil.mutListener.listen(10101) ? (elapsedTimeMillis &gt;= VEHICLE_REFRESH_PERIOD) : (ListenerUtil.mutListener.listen(10100) ? (elapsedTimeMillis &lt;= VEHICLE_REFRESH_PERIOD) : (ListenerUtil.mutListener.listen(10099) ? (elapsedTimeMillis &lt; VEHICLE_REFRESH_PERIOD) : (ListenerUtil.mutListener.listen(10098) ? (elapsedTimeMillis != VEHICLE_REFRESH_PERIOD) : (ListenerUtil.mutListener.listen(10097) ? (elapsedTimeMillis == VEHICLE_REFRESH_PERIOD) : (elapsedTimeMillis &gt; VEHICLE_REFRESH_PERIOD))))))) {</span>
            // Schedule an immediate update, if we're past the normal period after a load
<span class="nc" id="L272">            refreshPeriod = 100;</span>
        } else {
            // Schedule an update so a total of VEHICLE_REFRESH_PERIOD has elapsed since the last update
<span class="nc bnc" id="L275" title="All 8 branches missed.">            refreshPeriod = (ListenerUtil.mutListener.listen(10105) ? (VEHICLE_REFRESH_PERIOD % elapsedTimeMillis) : (ListenerUtil.mutListener.listen(10104) ? (VEHICLE_REFRESH_PERIOD / elapsedTimeMillis) : (ListenerUtil.mutListener.listen(10103) ? (VEHICLE_REFRESH_PERIOD * elapsedTimeMillis) : (ListenerUtil.mutListener.listen(10102) ? (VEHICLE_REFRESH_PERIOD + elapsedTimeMillis) : (VEHICLE_REFRESH_PERIOD - elapsedTimeMillis)))));</span>
        }
<span class="nc bnc" id="L277" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10106)) {</span>
<span class="nc" id="L278">            mVehicleRefreshHandler.postDelayed(mVehicleRefresh, refreshPeriod);</span>
        }
<span class="nc" id="L280">    }</span>

    @Override
    public void onSaveInstanceState(Bundle outState) {
<span class="nc bnc" id="L284" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10107)) {</span>
<span class="nc" id="L285">            outState.putString(MapParams.ROUTE_ID, mRouteId);</span>
        }
<span class="nc bnc" id="L287" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10108)) {</span>
<span class="nc" id="L288">            outState.putBoolean(MapParams.ZOOM_TO_ROUTE, mZoomToRoute);</span>
        }
<span class="nc bnc" id="L290" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10109)) {</span>
<span class="nc" id="L291">            outState.putBoolean(MapParams.ZOOM_INCLUDE_CLOSEST_VEHICLE, mZoomIncludeClosestVehicle);</span>
        }
<span class="nc" id="L293">        Location centerLocation = mFragment.getMapView().getMapCenterAsLocation();</span>
<span class="nc bnc" id="L294" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10110)) {</span>
<span class="nc" id="L295">            outState.putDouble(MapParams.CENTER_LAT, centerLocation.getLatitude());</span>
        }
<span class="nc bnc" id="L297" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10111)) {</span>
<span class="nc" id="L298">            outState.putDouble(MapParams.CENTER_LON, centerLocation.getLongitude());</span>
        }
<span class="nc bnc" id="L300" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10112)) {</span>
<span class="nc" id="L301">            outState.putFloat(MapParams.ZOOM, mFragment.getMapView().getZoomLevelAsFloat());</span>
        }
<span class="nc" id="L303">    }</span>

    @Override
    public void onViewStateRestored(Bundle savedInstanceState) {
<span class="nc bnc" id="L307" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10113)) {</span>
<span class="nc bnc" id="L308" title="All 2 branches missed.">            if (savedInstanceState == null) {</span>
<span class="nc" id="L309">                return;</span>
            }
        }
<span class="nc" id="L312">        String stopId = savedInstanceState.getString(MapParams.STOP_ID);</span>
<span class="nc bnc" id="L313" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10129)) {</span>
<span class="nc bnc" id="L314" title="All 2 branches missed.">            if (stopId == null) {</span>
<span class="nc" id="L315">                float mapZoom = savedInstanceState.getFloat(MapParams.ZOOM, MapParams.DEFAULT_ZOOM);</span>
<span class="nc bnc" id="L316" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10115)) {</span>
<span class="nc bnc" id="L317" title="All 2 branches missed.">                    if (mapZoom != MapParams.DEFAULT_ZOOM) {</span>
<span class="nc bnc" id="L318" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(10114)) {</span>
<span class="nc" id="L319">                            mFragment.getMapView().setZoom(mapZoom);</span>
                        }
                    }
                }
<span class="nc" id="L323">                double lat = savedInstanceState.getDouble(MapParams.CENTER_LAT);</span>
<span class="nc" id="L324">                double lon = savedInstanceState.getDouble(MapParams.CENTER_LON);</span>
<span class="nc bnc" id="L325" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10128)) {</span>
<span class="nc bnc" id="L326" title="All 90 branches missed.">                    if ((ListenerUtil.mutListener.listen(10126) ? ((ListenerUtil.mutListener.listen(10120) ? (lat &gt;= 0.0d) : (ListenerUtil.mutListener.listen(10119) ? (lat &lt;= 0.0d) : (ListenerUtil.mutListener.listen(10118) ? (lat &gt; 0.0d) : (ListenerUtil.mutListener.listen(10117) ? (lat &lt; 0.0d) : (ListenerUtil.mutListener.listen(10116) ? (lat == 0.0d) : (lat != 0.0d)))))) || (ListenerUtil.mutListener.listen(10125) ? (lon &gt;= 0.0d) : (ListenerUtil.mutListener.listen(10124) ? (lon &lt;= 0.0d) : (ListenerUtil.mutListener.listen(10123) ? (lon &gt; 0.0d) : (ListenerUtil.mutListener.listen(10122) ? (lon &lt; 0.0d) : (ListenerUtil.mutListener.listen(10121) ? (lon == 0.0d) : (lon != 0.0d))))))) : ((ListenerUtil.mutListener.listen(10120) ? (lat &gt;= 0.0d) : (ListenerUtil.mutListener.listen(10119) ? (lat &lt;= 0.0d) : (ListenerUtil.mutListener.listen(10118) ? (lat &gt; 0.0d) : (ListenerUtil.mutListener.listen(10117) ? (lat &lt; 0.0d) : (ListenerUtil.mutListener.listen(10116) ? (lat == 0.0d) : (lat != 0.0d)))))) &amp;&amp; (ListenerUtil.mutListener.listen(10125) ? (lon &gt;= 0.0d) : (ListenerUtil.mutListener.listen(10124) ? (lon &lt;= 0.0d) : (ListenerUtil.mutListener.listen(10123) ? (lon &gt; 0.0d) : (ListenerUtil.mutListener.listen(10122) ? (lon &lt; 0.0d) : (ListenerUtil.mutListener.listen(10121) ? (lon == 0.0d) : (lon != 0.0d))))))))) {</span>
<span class="nc" id="L327">                        Location location = LocationUtils.makeLocation(lat, lon);</span>
<span class="nc bnc" id="L328" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(10127)) {</span>
<span class="nc" id="L329">                            mFragment.getMapView().setMapCenter(location, false, false);</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L335">    }</span>

    @Override
    public void onLocation() {
<span class="nc" id="L339">    }</span>

    @Override
    public void onNoLocation() {
<span class="nc" id="L343">    }</span>

    @Override
    public void notifyMapChanged() {
<span class="nc" id="L347">    }</span>

    // 
    private class RoutePopup {

        private final Activity mActivity;

        private final View mView;

        private final TextView mRouteShortName;

        private final TextView mRouteLongName;

        private final TextView mAgencyName;

        private final ProgressBar mProgressBar;

        // Prevents completely hiding vehicle markers at top of route
        private int VEHICLE_MARKER_PADDING;

<span class="nc" id="L367">        RoutePopup() {</span>
<span class="nc" id="L368">            mActivity = mFragment.getActivity();</span>
<span class="nc bnc" id="L369" title="All 8 branches missed.">            float paddingDp = (ListenerUtil.mutListener.listen(10133) ? (mActivity.getResources().getDimension(R.dimen.map_route_vehicle_markers_padding) % mActivity.getResources().getDisplayMetrics().density) : (ListenerUtil.mutListener.listen(10132) ? (mActivity.getResources().getDimension(R.dimen.map_route_vehicle_markers_padding) * mActivity.getResources().getDisplayMetrics().density) : (ListenerUtil.mutListener.listen(10131) ? (mActivity.getResources().getDimension(R.dimen.map_route_vehicle_markers_padding) - mActivity.getResources().getDisplayMetrics().density) : (ListenerUtil.mutListener.listen(10130) ? (mActivity.getResources().getDimension(R.dimen.map_route_vehicle_markers_padding) + mActivity.getResources().getDisplayMetrics().density) : (mActivity.getResources().getDimension(R.dimen.map_route_vehicle_markers_padding) / mActivity.getResources().getDisplayMetrics().density)))));</span>
<span class="nc bnc" id="L370" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10134)) {</span>
<span class="nc" id="L371">                VEHICLE_MARKER_PADDING = UIUtils.dpToPixels(mActivity, paddingDp);</span>
            }
<span class="nc" id="L373">            mView = mActivity.findViewById(R.id.route_info);</span>
<span class="nc bnc" id="L374" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10135)) {</span>
<span class="nc" id="L375">                mFragment.getMapView().setPadding(null, mView.getHeight() + VEHICLE_MARKER_PADDING, null, null);</span>
            }
<span class="nc" id="L377">            mRouteShortName = (TextView) mView.findViewById(R.id.short_name);</span>
<span class="nc" id="L378">            mRouteLongName = (TextView) mView.findViewById(R.id.long_name);</span>
<span class="nc" id="L379">            mAgencyName = (TextView) mView.findViewById(R.id.agency);</span>
<span class="nc" id="L380">            mProgressBar = (ProgressBar) mView.findViewById(R.id.route_info_loading_spinner);</span>
            // Make sure the cancel button is shown
<span class="nc" id="L382">            View cancel = mView.findViewById(R.id.cancel_route_mode);</span>
<span class="nc bnc" id="L383" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10136)) {</span>
<span class="nc" id="L384">                cancel.setVisibility(View.VISIBLE);</span>
            }
<span class="nc bnc" id="L386" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10142)) {</span>
<span class="nc" id="L387">                cancel.setOnClickListener(new View.OnClickListener() {</span>

                    @Override
                    public void onClick(View v) {
<span class="nc" id="L391">                        ObaMapView obaMapView = mFragment.getMapView();</span>
                        // We want to preserve the current zoom and center.
<span class="nc" id="L393">                        Bundle bundle = new Bundle();</span>
<span class="nc bnc" id="L394" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(10137)) {</span>
<span class="nc" id="L395">                            bundle.putBoolean(MapParams.DO_N0T_CENTER_ON_LOCATION, true);</span>
                        }
<span class="nc bnc" id="L397" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(10138)) {</span>
<span class="nc" id="L398">                            bundle.putFloat(MapParams.ZOOM, obaMapView.getZoomLevelAsFloat());</span>
                        }
<span class="nc" id="L400">                        Location point = obaMapView.getMapCenterAsLocation();</span>
<span class="nc bnc" id="L401" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(10139)) {</span>
<span class="nc" id="L402">                            bundle.putDouble(MapParams.CENTER_LAT, point.getLatitude());</span>
                        }
<span class="nc bnc" id="L404" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(10140)) {</span>
<span class="nc" id="L405">                            bundle.putDouble(MapParams.CENTER_LON, point.getLongitude());</span>
                        }
<span class="nc bnc" id="L407" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(10141)) {</span>
<span class="nc" id="L408">                            mFragment.setMapMode(MapParams.MODE_STOP, bundle);</span>
                        }
<span class="nc" id="L410">                    }</span>
                });
            }
<span class="nc" id="L413">        }</span>

        void showLoading() {
<span class="nc bnc" id="L416" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10143)) {</span>
<span class="nc" id="L417">                mFragment.getMapView().setPadding(null, mView.getHeight() + VEHICLE_MARKER_PADDING, null, null);</span>
            }
<span class="nc bnc" id="L419" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10144)) {</span>
<span class="nc" id="L420">                UIUtils.hideViewWithoutAnimation(mRouteShortName);</span>
            }
<span class="nc bnc" id="L422" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10145)) {</span>
<span class="nc" id="L423">                UIUtils.hideViewWithoutAnimation(mRouteLongName);</span>
            }
<span class="nc bnc" id="L425" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10146)) {</span>
<span class="nc" id="L426">                UIUtils.showViewWithoutAnimation(mView);</span>
            }
<span class="nc bnc" id="L428" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10147)) {</span>
<span class="nc" id="L429">                UIUtils.showViewWithoutAnimation(mProgressBar);</span>
            }
<span class="nc" id="L431">        }</span>

        /**
         * Show the route header and populate it with the provided information
         * @param route route information to show in the header
         * @param agencyName agency name to show in the header
         */
        void show(ObaRoute route, String agencyName) {
<span class="nc bnc" id="L439" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10148)) {</span>
<span class="nc" id="L440">                mRouteShortName.setText(UIUtils.formatDisplayText(UIUtils.getRouteDisplayName(route)));</span>
            }
<span class="nc bnc" id="L442" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10149)) {</span>
<span class="nc" id="L443">                mRouteLongName.setText(UIUtils.formatDisplayText(UIUtils.getRouteDescription(route)));</span>
            }
<span class="nc bnc" id="L445" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10150)) {</span>
<span class="nc" id="L446">                mAgencyName.setText(agencyName);</span>
            }
<span class="nc bnc" id="L448" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10151)) {</span>
<span class="nc" id="L449">                show();</span>
            }
<span class="nc" id="L451">        }</span>

        /**
         * Show the route header with the existing route information
         */
        void show() {
<span class="nc bnc" id="L457" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10152)) {</span>
<span class="nc" id="L458">                UIUtils.hideViewWithAnimation(mProgressBar, mShortAnimationDuration);</span>
            }
<span class="nc bnc" id="L460" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10153)) {</span>
<span class="nc" id="L461">                UIUtils.showViewWithAnimation(mRouteShortName, mShortAnimationDuration);</span>
            }
<span class="nc bnc" id="L463" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10154)) {</span>
<span class="nc" id="L464">                UIUtils.showViewWithAnimation(mRouteLongName, mShortAnimationDuration);</span>
            }
<span class="nc bnc" id="L466" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10155)) {</span>
<span class="nc" id="L467">                UIUtils.showViewWithAnimation(mView, mShortAnimationDuration);</span>
            }
<span class="nc bnc" id="L469" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10156)) {</span>
<span class="nc" id="L470">                mFragment.getMapView().setPadding(null, mView.getHeight() + VEHICLE_MARKER_PADDING, null, null);</span>
            }
<span class="nc" id="L472">        }</span>

        void hide() {
<span class="nc bnc" id="L475" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10157)) {</span>
<span class="nc" id="L476">                mFragment.getMapView().setPadding(null, 0, null, null);</span>
            }
<span class="nc bnc" id="L478" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10158)) {</span>
<span class="nc" id="L479">                UIUtils.hideViewWithAnimation(mView, mShortAnimationDuration);</span>
            }
<span class="nc" id="L481">        }</span>
    }

<span class="nc" id="L484">    private static final long VEHICLE_REFRESH_PERIOD = TimeUnit.SECONDS.toMillis(10);</span>

<span class="nc" id="L486">    private final Handler mVehicleRefreshHandler = new Handler();</span>

<span class="nc" id="L488">    private final Runnable mVehicleRefresh = new Runnable() {</span>

        public void run() {
<span class="nc bnc" id="L491" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10159)) {</span>
<span class="nc" id="L492">                refresh();</span>
            }
<span class="nc" id="L494">        }</span>
    };

    /**
     * Refresh vehicle data from the OBA server
     */
    private void refresh() {
<span class="nc bnc" id="L501" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10161)) {</span>
<span class="nc bnc" id="L502" title="All 2 branches missed.">            if (mVehiclesLoader != null) {</span>
<span class="nc bnc" id="L503" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10160)) {</span>
<span class="nc" id="L504">                    mVehiclesLoader.onContentChanged();</span>
                }
            }
        }
<span class="nc" id="L508">    }</span>

    private static class RoutesLoader extends AsyncTaskLoader&lt;ObaStopsForRouteResponse&gt; {

        private final String mRouteId;

        public RoutesLoader(Context context, String routeId) {
<span class="nc" id="L515">            super(context);</span>
<span class="nc" id="L516">            mRouteId = routeId;</span>
<span class="nc" id="L517">        }</span>

        @Override
        public ObaStopsForRouteResponse loadInBackground() {
<span class="nc bnc" id="L521" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10164)) {</span>
<span class="nc bnc" id="L522" title="All 10 branches missed.">                if ((ListenerUtil.mutListener.listen(10162) ? (Application.get().getCurrentRegion() == null || TextUtils.isEmpty(Application.get().getCustomApiUrl())) : (Application.get().getCurrentRegion() == null &amp;&amp; TextUtils.isEmpty(Application.get().getCustomApiUrl())))) {</span>
<span class="nc bnc" id="L523" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(10163)) {</span>
                        // We don't have region info or manually entered API to know what server to contact
<span class="nc" id="L525">                        Log.d(TAG, &quot;Trying to load stops for route from server &quot; + &quot;without OBA REST API endpoint, aborting...&quot;);</span>
                    }
<span class="nc" id="L527">                    return null;</span>
                }
            }
            // Make OBA REST API call to the server and return result
<span class="nc" id="L531">            return new ObaStopsForRouteRequest.Builder(getContext(), mRouteId).setIncludeShapes(true).build().call();</span>
        }

        @Override
        public void deliverResult(ObaStopsForRouteResponse data) {
<span class="nc bnc" id="L536" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10165)) {</span>
                // mResponse = data;
<span class="nc" id="L538">                super.deliverResult(data);</span>
            }
<span class="nc" id="L540">        }</span>

        @Override
        public void onStartLoading() {
<span class="nc bnc" id="L544" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10166)) {</span>
<span class="nc" id="L545">                forceLoad();</span>
            }
<span class="nc" id="L547">        }</span>
    }

<span class="nc" id="L550">    class RouteLoaderListener implements LoaderManager.LoaderCallbacks&lt;ObaStopsForRouteResponse&gt;, Loader.OnLoadCompleteListener&lt;ObaStopsForRouteResponse&gt; {</span>

        @Override
        public Loader&lt;ObaStopsForRouteResponse&gt; onCreateLoader(int id, Bundle args) {
<span class="nc" id="L554">            return new RoutesLoader(mFragment.getActivity(), mRouteId);</span>
        }

        @Override
        public void onLoadFinished(Loader&lt;ObaStopsForRouteResponse&gt; loader, ObaStopsForRouteResponse response) {
<span class="nc" id="L559">            ObaMapView obaMapView = mFragment.getMapView();</span>
<span class="nc bnc" id="L560" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10169)) {</span>
<span class="nc bnc" id="L561" title="All 10 branches missed.">                if ((ListenerUtil.mutListener.listen(10167) ? (response == null &amp;&amp; response.getCode() != ObaApi.OBA_OK) : (response == null || response.getCode() != ObaApi.OBA_OK))) {</span>
<span class="nc bnc" id="L562" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(10168)) {</span>
<span class="nc" id="L563">                        BaseMapFragment.showMapError(response);</span>
                    }
<span class="nc" id="L565">                    return;</span>
                }
            }
<span class="nc" id="L568">            ObaRoute route = response.getRoute(response.getRouteId());</span>
<span class="nc bnc" id="L569" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10170)) {</span>
<span class="nc" id="L570">                mRoutePopup.show(route, response.getAgency(route.getAgencyId()).getName());</span>
            }
<span class="nc bnc" id="L572" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10172)) {</span>
<span class="nc bnc" id="L573" title="All 2 branches missed.">                if (route.getColor() != null) {</span>
<span class="nc bnc" id="L574" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(10171)) {</span>
<span class="nc" id="L575">                        mLineOverlayColor = route.getColor();</span>
                    }
                }
            }
<span class="nc bnc" id="L579" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10173)) {</span>
<span class="nc" id="L580">                obaMapView.setRouteOverlay(mLineOverlayColor, response.getShapes());</span>
            }
            // Set the stops for this route
<span class="nc" id="L583">            List&lt;ObaStop&gt; stops = response.getStops();</span>
<span class="nc bnc" id="L584" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10174)) {</span>
<span class="nc" id="L585">                mFragment.showStops(stops, response);</span>
            }
<span class="nc bnc" id="L587" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10175)) {</span>
<span class="nc" id="L588">                mFragment.showProgress(false);</span>
            }
<span class="nc bnc" id="L590" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10178)) {</span>
<span class="nc bnc" id="L591" title="All 2 branches missed.">                if (mZoomToRoute) {</span>
<span class="nc bnc" id="L592" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(10176)) {</span>
<span class="nc" id="L593">                        obaMapView.zoomToRoute();</span>
                    }
<span class="nc bnc" id="L595" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(10177)) {</span>
<span class="nc" id="L596">                        mZoomToRoute = false;</span>
                    }
                }
            }
<span class="nc bnc" id="L600" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10179)) {</span>
                // wait to zoom till we have the right response
<span class="nc" id="L602">                obaMapView.postInvalidate();</span>
            }
<span class="nc" id="L604">        }</span>

        @Override
        public void onLoaderReset(Loader&lt;ObaStopsForRouteResponse&gt; loader) {
<span class="nc bnc" id="L608" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10180)) {</span>
<span class="nc" id="L609">                mFragment.getMapView().removeRouteOverlay();</span>
            }
<span class="nc bnc" id="L611" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10181)) {</span>
<span class="nc" id="L612">                mFragment.getMapView().removeVehicleOverlay();</span>
            }
<span class="nc" id="L614">        }</span>

        @Override
        public void onLoadComplete(Loader&lt;ObaStopsForRouteResponse&gt; loader, ObaStopsForRouteResponse response) {
<span class="nc bnc" id="L618" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10182)) {</span>
<span class="nc" id="L619">                onLoadFinished(loader, response);</span>
            }
<span class="nc" id="L621">        }</span>
    }

    private static class VehiclesLoader extends AsyncTaskLoader&lt;ObaTripsForRouteResponse&gt; {

        private final String mRouteId;

        public VehiclesLoader(Context context, String routeId) {
<span class="nc" id="L629">            super(context);</span>
<span class="nc" id="L630">            mRouteId = routeId;</span>
<span class="nc" id="L631">        }</span>

        @Override
        public ObaTripsForRouteResponse loadInBackground() {
<span class="nc bnc" id="L635" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10185)) {</span>
<span class="nc bnc" id="L636" title="All 10 branches missed.">                if ((ListenerUtil.mutListener.listen(10183) ? (Application.get().getCurrentRegion() == null || TextUtils.isEmpty(Application.get().getCustomApiUrl())) : (Application.get().getCurrentRegion() == null &amp;&amp; TextUtils.isEmpty(Application.get().getCustomApiUrl())))) {</span>
<span class="nc bnc" id="L637" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(10184)) {</span>
                        // We don't have region info or manually entered API to know what server to contact
<span class="nc" id="L639">                        Log.d(TAG, &quot;Trying to load trips (vehicles) for route from server &quot; + &quot;without OBA REST API endpoint, aborting...&quot;);</span>
                    }
<span class="nc" id="L641">                    return null;</span>
                }
            }
            // Make OBA REST API call to the server and return result
<span class="nc" id="L645">            return new ObaTripsForRouteRequest.Builder(getContext(), mRouteId).setIncludeStatus(true).build().call();</span>
        }

        @Override
        public void deliverResult(ObaTripsForRouteResponse data) {
<span class="nc bnc" id="L650" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10186)) {</span>
<span class="nc" id="L651">                super.deliverResult(data);</span>
            }
<span class="nc" id="L653">        }</span>

        @Override
        public void onStartLoading() {
<span class="nc bnc" id="L657" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10187)) {</span>
<span class="nc" id="L658">                forceLoad();</span>
            }
<span class="nc" id="L660">        }</span>
    }

<span class="nc" id="L663">    class VehicleLoaderListener implements LoaderManager.LoaderCallbacks&lt;ObaTripsForRouteResponse&gt;, Loader.OnLoadCompleteListener&lt;ObaTripsForRouteResponse&gt; {</span>

<span class="nc" id="L665">        HashSet&lt;String&gt; routes = new HashSet&lt;&gt;(1);</span>

        @Override
        public Loader&lt;ObaTripsForRouteResponse&gt; onCreateLoader(int id, Bundle args) {
<span class="nc" id="L669">            return new VehiclesLoader(mFragment.getActivity(), mRouteId);</span>
        }

        @Override
        public void onLoadFinished(Loader&lt;ObaTripsForRouteResponse&gt; loader, ObaTripsForRouteResponse response) {
<span class="nc" id="L674">            ObaMapView obaMapView = mFragment.getMapView();</span>
<span class="nc bnc" id="L675" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10190)) {</span>
<span class="nc bnc" id="L676" title="All 10 branches missed.">                if ((ListenerUtil.mutListener.listen(10188) ? (response == null &amp;&amp; response.getCode() != ObaApi.OBA_OK) : (response == null || response.getCode() != ObaApi.OBA_OK))) {</span>
<span class="nc bnc" id="L677" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(10189)) {</span>
<span class="nc" id="L678">                        BaseMapFragment.showMapError(response);</span>
                    }
<span class="nc" id="L680">                    return;</span>
                }
            }
<span class="nc bnc" id="L683" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10191)) {</span>
<span class="nc" id="L684">                routes.clear();</span>
            }
<span class="nc bnc" id="L686" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10192)) {</span>
<span class="nc" id="L687">                routes.add(mRouteId);</span>
            }
<span class="nc bnc" id="L689" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10193)) {</span>
<span class="nc" id="L690">                obaMapView.updateVehicles(routes, response);</span>
            }
<span class="nc bnc" id="L692" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10196)) {</span>
<span class="nc bnc" id="L693" title="All 2 branches missed.">                if (mZoomIncludeClosestVehicle) {</span>
<span class="nc bnc" id="L694" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(10194)) {</span>
<span class="nc" id="L695">                        obaMapView.zoomIncludeClosestVehicle(routes, response);</span>
                    }
<span class="nc bnc" id="L697" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(10195)) {</span>
<span class="nc" id="L698">                        mZoomIncludeClosestVehicle = false;</span>
                    }
                }
            }
<span class="nc bnc" id="L702" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10197)) {</span>
<span class="nc" id="L703">                mLastUpdatedTimeVehicles = UIUtils.getCurrentTimeForComparison();</span>
            }
<span class="nc bnc" id="L705" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10198)) {</span>
                // Clear any pending refreshes
<span class="nc" id="L707">                mVehicleRefreshHandler.removeCallbacks(mVehicleRefresh);</span>
            }
<span class="nc bnc" id="L709" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10199)) {</span>
                // Post an update
<span class="nc" id="L711">                mVehicleRefreshHandler.postDelayed(mVehicleRefresh, VEHICLE_REFRESH_PERIOD);</span>
            }
<span class="nc" id="L713">        }</span>

        @Override
        public void onLoaderReset(Loader&lt;ObaTripsForRouteResponse&gt; loader) {
<span class="nc bnc" id="L717" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10200)) {</span>
<span class="nc" id="L718">                mFragment.getMapView().removeVehicleOverlay();</span>
            }
<span class="nc" id="L720">        }</span>

        @Override
        public void onLoadComplete(Loader&lt;ObaTripsForRouteResponse&gt; loader, ObaTripsForRouteResponse response) {
<span class="nc bnc" id="L724" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10201)) {</span>
<span class="nc" id="L725">                onLoadFinished(loader, response);</span>
            }
<span class="nc" id="L727">        }</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span>Generated by the Android Gradle plugin 8.2.0</div></body></html>