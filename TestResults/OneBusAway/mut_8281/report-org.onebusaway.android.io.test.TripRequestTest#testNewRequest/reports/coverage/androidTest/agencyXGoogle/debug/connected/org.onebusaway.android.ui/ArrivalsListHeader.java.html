<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ArrivalsListHeader.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">agencyXGoogleDebug</a> &gt; <a href="index.source.html" class="el_package">org.onebusaway.android.ui</a> &gt; <span class="el_source">ArrivalsListHeader.java</span></div><h1>ArrivalsListHeader.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2011-2017 Paul Watts (paulcwatts@gmail.com),
 * University of South Florida (sjbarbeau@gmail.com),
 * Microsoft Corporation
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.onebusaway.android.ui;

import android.annotation.TargetApi;
import android.content.ContentQueryMap;
import android.content.ContentValues;
import android.content.Context;
import android.content.Intent;
import android.content.res.Resources;
import android.graphics.Paint;
import android.graphics.drawable.ColorDrawable;
import android.graphics.drawable.GradientDrawable;
import android.location.Location;
import android.net.Uri;
import android.os.Build;
import android.text.TextUtils;
import android.text.format.DateUtils;
import android.text.style.ClickableSpan;
import android.util.Log;
import android.view.KeyEvent;
import android.view.LayoutInflater;
import android.view.MotionEvent;
import android.view.View;
import android.view.ViewGroup;
import android.view.animation.Animation;
import android.view.animation.RotateAnimation;
import android.view.inputmethod.EditorInfo;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.ImageView;
import android.widget.PopupWindow;
import android.widget.ProgressBar;
import android.widget.RelativeLayout;
import android.widget.TableLayout;
import android.widget.TextView;
import androidx.fragment.app.FragmentManager;
import com.google.firebase.analytics.FirebaseAnalytics;
import org.onebusaway.android.R;
import org.onebusaway.android.app.Application;
import org.onebusaway.android.io.ObaAnalytics;
import org.onebusaway.android.io.elements.ObaArrivalInfo;
import org.onebusaway.android.io.elements.ObaRegion;
import org.onebusaway.android.io.elements.Status;
import org.onebusaway.android.provider.ObaContract;
import org.onebusaway.android.util.ArrivalInfoUtils;
import org.onebusaway.android.util.UIUtils;
import java.util.ArrayList;
import java.util.List;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

// 
class ArrivalsListHeader {

    interface Controller {

        Location getStopLocation();

        String getStopName();

        String getStopDirection();

        String getUserStopName();

        String getStopId();

        void setUserStopName(String userName);

        long getLastGoodResponseTime();

        // Returns a sorted list (by ETA) of arrival times for the current stop
        ArrayList&lt;ArrivalInfo&gt; getArrivalInfo();

        ArrayList&lt;String&gt; getRoutesFilter();

        void setRoutesFilter(ArrayList&lt;String&gt; filter);

        int getNumRoutes();

        boolean isFavoriteStop();

        boolean setFavoriteStop(boolean favorite);

        AlertList getAlertList();

        List&lt;String&gt; getRouteDisplayNames();

        /**
         * Gets the range of arrival info (i.e., arrival info for the next &quot;minutesAfter&quot; minutes),
         * or -1 if this information isn't available
         *
         * @return minutesAfter the range of arrival info (i.e., arrival info for the next
         * &quot;minutesAfter&quot; minutes), or -1 if this information isn't available
         */
        int getMinutesAfter();

        /**
         * Shows the list item menu for the given view and arrival info
         *
         * @param v    view for the container of the arrival info
         * @param stop arrival info to show a list for
         */
        void showListItemMenu(View v, final ArrivalInfo stop);

        /**
         * Triggers a local refresh of the controller content (i.e., does not trigger another
         * call to the server)
         */
        void refreshLocal();

        /**
         * Triggers a full refresh of arrivals from the OBA server
         */
        void refresh();
    }

    private static final String TAG = &quot;ArrivalsListHeader&quot;;

    private Controller mController;

    private Context mContext;

    private Resources mResources;

    private FragmentManager mFragmentManager;

    // Entire header parent view
    private View mView;

    // Holds everything except for the mFilterGroup
    private View mMainContainerView;

    private View mNameContainerView;

    private View mEditNameContainerView;

    private TextView mNameView;

    private TextView mDirectionView;

    private EditText mEditNameView;

    private ImageButton mStopFavorite;

    private View mFilterGroup;

    private TextView mShowAllView;

    private ClickableSpan mShowAllClick;

<span class="nc" id="L166">    private boolean mInNameEdit = false;</span>

    // Default state for the header is inside a sliding fragment
<span class="nc" id="L169">    private boolean mIsSlidingPanelCollapsed = true;</span>

    private int mShortAnimationDuration;

    private ProgressBar mProgressBar;

    private ImageButton mStopInfo;

    private ImageView mExpandCollapse;

    /**
     * Variables used to show/hide alerts in the header
     */
    private ImageView mAlertView;

<span class="nc" id="L184">    boolean mHasWarning = false;</span>

<span class="nc" id="L186">    boolean mHasError = false;</span>

<span class="nc" id="L188">    boolean mIsAlertHidden = false;</span>

    // All arrival info returned by the adapter
    private ArrayList&lt;ArrivalInfo&gt; mArrivalInfo;

    // Arrival info for the two rows of arrival info in the header
<span class="nc" id="L194">    private ArrayList&lt;ArrivalInfo&gt; mHeaderArrivalInfo = new ArrayList&lt;&gt;(2);</span>

    // Trip (e.g., reminder) content for this stop
    protected ContentQueryMap mTripsForStop;

    // Allows external classes to show/hide arrivals
<span class="nc" id="L200">    private boolean mShowArrivals = true;</span>

    // -1 if mArrivalInfo hasn't been refreshed
<span class="nc" id="L203">    int mNumHeaderArrivals = -1;</span>

    private TextView mNoArrivals;

<span class="nc" id="L207">    private final float ETA_TEXT_SIZE_SP = 30;</span>

<span class="nc" id="L209">    private final float ETA_TEXT_NOW_SIZE_SP = 28;</span>

    // Row 1
    private View mEtaContainer1;

    private ImageButton mEtaRouteFavorite1;

    private ImageButton mEtaReminder1;

    private TextView mEtaRouteName1;

    private TextView mEtaRouteDirection1;

    private RelativeLayout mEtaAndMin1;

    private TextView mEtaArrivalInfo1;

    private TextView mEtaMin1;

    private ViewGroup mEtaRealtime1;

    private ImageButton mEtaMoreVert1;

    private PopupWindow mPopup1;

    private View mEtaSeparator;

    // Row 2
    private View mEtaContainer2;

    private ImageButton mEtaRouteFavorite2;

    private ImageButton mEtaReminder2;

    private TextView mEtaRouteName2;

    private TextView mEtaRouteDirection2;

    private RelativeLayout mEtaAndMin2;

    private TextView mEtaArrivalInfo2;

    private TextView mEtaMin2;

    private ViewGroup mEtaRealtime2;

    private ImageButton mEtaMoreVert2;

    private PopupWindow mPopup2;

    // 50%
    private static final float ANIM_PIVOT_VALUE = 0.5f;

    // 0 degrees (no rotation)
    private static final float ANIM_STATE_NORMAL = 0.0f;

    // 180 degrees
    private static final float ANIM_STATE_INVERTED = 180.0f;

    // milliseconds
    private static final long ANIM_DURATION = 300;

    // Manages header size in &quot;stop name edit mode&quot;
    private int cachedExpandCollapseViewVisibility;

    private static float HEADER_HEIGHT_NO_ARRIVALS_DP;

    private static float HEADER_HEIGHT_ONE_ARRIVAL_DP;

    private static float HEADER_HEIGHT_TWO_ARRIVALS_DP;

    private static float HEADER_HEIGHT_EDIT_NAME_DP;

    private static float HEADER_OFFSET_FILTER_ROUTES_DP;

    // Controller to change parent sliding panel
    HomeActivity.SlidingPanelController mSlidingPanelController;

    private FirebaseAnalytics mFirebaseAnalytics;

<span class="nc" id="L289">    ArrivalsListHeader(Context context, Controller controller, FragmentManager fm) {</span>
<span class="nc bnc" id="L290" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2360)) {</span>
<span class="nc" id="L291">            mController = controller;</span>
        }
<span class="nc bnc" id="L293" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2361)) {</span>
<span class="nc" id="L294">            mContext = context;</span>
        }
<span class="nc bnc" id="L296" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2362)) {</span>
<span class="nc" id="L297">            mResources = context.getResources();</span>
        }
<span class="nc bnc" id="L299" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2363)) {</span>
<span class="nc" id="L300">            mFragmentManager = fm;</span>
        }
<span class="nc bnc" id="L302" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2364)) {</span>
<span class="nc" id="L303">            mFirebaseAnalytics = FirebaseAnalytics.getInstance(context);</span>
        }
<span class="nc bnc" id="L305" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2365)) {</span>
            // Retrieve and cache the system's default &quot;short&quot; animation time.
<span class="nc" id="L307">            mShortAnimationDuration = mResources.getInteger(android.R.integer.config_shortAnimTime);</span>
        }
<span class="nc" id="L309">    }</span>

    void initView(View view) {
<span class="nc bnc" id="L312" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2366)) {</span>
            // Clear any existing arrival info
<span class="nc" id="L314">            mArrivalInfo = null;</span>
        }
<span class="nc bnc" id="L316" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2367)) {</span>
<span class="nc" id="L317">            mHeaderArrivalInfo.clear();</span>
        }
<span class="nc bnc" id="L319" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2368)) {</span>
<span class="nc" id="L320">            mNumHeaderArrivals = -1;</span>
        }
<span class="nc bnc" id="L322" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2373)) {</span>
            // Cache the ArrivalsListHeader height values
<span class="nc bnc" id="L324" title="All 8 branches missed.">            HEADER_HEIGHT_NO_ARRIVALS_DP = (ListenerUtil.mutListener.listen(2372) ? (view.getResources().getDimension(R.dimen.arrival_header_height_no_arrivals) % view.getResources().getDisplayMetrics().density) : (ListenerUtil.mutListener.listen(2371) ? (view.getResources().getDimension(R.dimen.arrival_header_height_no_arrivals) * view.getResources().getDisplayMetrics().density) : (ListenerUtil.mutListener.listen(2370) ? (view.getResources().getDimension(R.dimen.arrival_header_height_no_arrivals) - view.getResources().getDisplayMetrics().density) : (ListenerUtil.mutListener.listen(2369) ? (view.getResources().getDimension(R.dimen.arrival_header_height_no_arrivals) + view.getResources().getDisplayMetrics().density) : (view.getResources().getDimension(R.dimen.arrival_header_height_no_arrivals) / view.getResources().getDisplayMetrics().density)))));</span>
        }
<span class="nc bnc" id="L326" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2378)) {</span>
<span class="nc bnc" id="L327" title="All 8 branches missed.">            HEADER_HEIGHT_ONE_ARRIVAL_DP = (ListenerUtil.mutListener.listen(2377) ? (view.getResources().getDimension(R.dimen.arrival_header_height_one_arrival) % view.getResources().getDisplayMetrics().density) : (ListenerUtil.mutListener.listen(2376) ? (view.getResources().getDimension(R.dimen.arrival_header_height_one_arrival) * view.getResources().getDisplayMetrics().density) : (ListenerUtil.mutListener.listen(2375) ? (view.getResources().getDimension(R.dimen.arrival_header_height_one_arrival) - view.getResources().getDisplayMetrics().density) : (ListenerUtil.mutListener.listen(2374) ? (view.getResources().getDimension(R.dimen.arrival_header_height_one_arrival) + view.getResources().getDisplayMetrics().density) : (view.getResources().getDimension(R.dimen.arrival_header_height_one_arrival) / view.getResources().getDisplayMetrics().density)))));</span>
        }
<span class="nc bnc" id="L329" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2383)) {</span>
<span class="nc bnc" id="L330" title="All 8 branches missed.">            HEADER_HEIGHT_TWO_ARRIVALS_DP = (ListenerUtil.mutListener.listen(2382) ? (view.getResources().getDimension(R.dimen.arrival_header_height_two_arrivals) % view.getResources().getDisplayMetrics().density) : (ListenerUtil.mutListener.listen(2381) ? (view.getResources().getDimension(R.dimen.arrival_header_height_two_arrivals) * view.getResources().getDisplayMetrics().density) : (ListenerUtil.mutListener.listen(2380) ? (view.getResources().getDimension(R.dimen.arrival_header_height_two_arrivals) - view.getResources().getDisplayMetrics().density) : (ListenerUtil.mutListener.listen(2379) ? (view.getResources().getDimension(R.dimen.arrival_header_height_two_arrivals) + view.getResources().getDisplayMetrics().density) : (view.getResources().getDimension(R.dimen.arrival_header_height_two_arrivals) / view.getResources().getDisplayMetrics().density)))));</span>
        }
<span class="nc bnc" id="L332" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2388)) {</span>
<span class="nc bnc" id="L333" title="All 8 branches missed.">            HEADER_OFFSET_FILTER_ROUTES_DP = (ListenerUtil.mutListener.listen(2387) ? (view.getResources().getDimension(R.dimen.arrival_header_height_offset_filter_routes) % view.getResources().getDisplayMetrics().density) : (ListenerUtil.mutListener.listen(2386) ? (view.getResources().getDimension(R.dimen.arrival_header_height_offset_filter_routes) * view.getResources().getDisplayMetrics().density) : (ListenerUtil.mutListener.listen(2385) ? (view.getResources().getDimension(R.dimen.arrival_header_height_offset_filter_routes) - view.getResources().getDisplayMetrics().density) : (ListenerUtil.mutListener.listen(2384) ? (view.getResources().getDimension(R.dimen.arrival_header_height_offset_filter_routes) + view.getResources().getDisplayMetrics().density) : (view.getResources().getDimension(R.dimen.arrival_header_height_offset_filter_routes) / view.getResources().getDisplayMetrics().density)))));</span>
        }
<span class="nc bnc" id="L335" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2393)) {</span>
<span class="nc bnc" id="L336" title="All 8 branches missed.">            HEADER_HEIGHT_EDIT_NAME_DP = (ListenerUtil.mutListener.listen(2392) ? (view.getResources().getDimension(R.dimen.arrival_header_height_edit_name) % view.getResources().getDisplayMetrics().density) : (ListenerUtil.mutListener.listen(2391) ? (view.getResources().getDimension(R.dimen.arrival_header_height_edit_name) * view.getResources().getDisplayMetrics().density) : (ListenerUtil.mutListener.listen(2390) ? (view.getResources().getDimension(R.dimen.arrival_header_height_edit_name) - view.getResources().getDisplayMetrics().density) : (ListenerUtil.mutListener.listen(2389) ? (view.getResources().getDimension(R.dimen.arrival_header_height_edit_name) + view.getResources().getDisplayMetrics().density) : (view.getResources().getDimension(R.dimen.arrival_header_height_edit_name) / view.getResources().getDisplayMetrics().density)))));</span>
        }
<span class="nc bnc" id="L338" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2394)) {</span>
            // Init views
<span class="nc" id="L340">            mView = view;</span>
        }
<span class="nc bnc" id="L342" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2395)) {</span>
<span class="nc" id="L343">            mMainContainerView = mView.findViewById(R.id.main_header_content);</span>
        }
<span class="nc bnc" id="L345" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2396)) {</span>
<span class="nc" id="L346">            mNameContainerView = mView.findViewById(R.id.stop_name_and_info_container);</span>
        }
<span class="nc bnc" id="L348" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2397)) {</span>
<span class="nc" id="L349">            mEditNameContainerView = mView.findViewById(R.id.edit_name_container);</span>
        }
<span class="nc bnc" id="L351" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2398)) {</span>
<span class="nc" id="L352">            mNameView = (TextView) mView.findViewById(R.id.stop_name);</span>
        }
<span class="nc bnc" id="L354" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2399)) {</span>
<span class="nc" id="L355">            mDirectionView = (TextView) mView.findViewById(R.id.stop_direction);</span>
        }
<span class="nc bnc" id="L357" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2400)) {</span>
<span class="nc" id="L358">            mEditNameView = (EditText) mView.findViewById(R.id.edit_name);</span>
        }
<span class="nc bnc" id="L360" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2401)) {</span>
<span class="nc" id="L361">            mStopFavorite = (ImageButton) mView.findViewById(R.id.stop_favorite);</span>
        }
<span class="nc bnc" id="L363" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2402)) {</span>
<span class="nc" id="L364">            mStopFavorite.setColorFilter(mView.getResources().getColor(R.color.header_text_color));</span>
        }
<span class="nc bnc" id="L366" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2403)) {</span>
<span class="nc" id="L367">            mFilterGroup = mView.findViewById(R.id.filter_group);</span>
        }
<span class="nc bnc" id="L369" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2404)) {</span>
<span class="nc" id="L370">            mShowAllView = (TextView) mView.findViewById(R.id.show_all);</span>
        }
<span class="nc bnc" id="L372" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2405)) {</span>
            // Remove any previous clickable spans - we're recycling views between fragments for efficiency
<span class="nc" id="L374">            UIUtils.removeAllClickableSpans(mShowAllView);</span>
        }
<span class="nc bnc" id="L376" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2407)) {</span>
<span class="nc" id="L377">            mShowAllClick = new ClickableSpan() {</span>

                public void onClick(View v) {
<span class="nc bnc" id="L380" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2406)) {</span>
<span class="nc" id="L381">                        mController.setRoutesFilter(new ArrayList&lt;String&gt;());</span>
                    }
<span class="nc" id="L383">                }</span>
            };
        }
<span class="nc bnc" id="L386" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2408)) {</span>
<span class="nc" id="L387">            UIUtils.setClickableSpan(mShowAllView, mShowAllClick);</span>
        }
<span class="nc bnc" id="L389" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2409)) {</span>
<span class="nc" id="L390">            mNoArrivals = (TextView) mView.findViewById(R.id.no_arrivals);</span>
        }
<span class="nc bnc" id="L392" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2410)) {</span>
            // First ETA row
<span class="nc" id="L394">            mEtaContainer1 = mView.findViewById(R.id.eta_container1);</span>
        }
<span class="nc bnc" id="L396" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2411)) {</span>
<span class="nc" id="L397">            mEtaRouteFavorite1 = (ImageButton) mEtaContainer1.findViewById(R.id.eta_route_favorite);</span>
        }
<span class="nc bnc" id="L399" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2412)) {</span>
<span class="nc" id="L400">            mEtaRouteFavorite1.setColorFilter(mView.getResources().getColor(R.color.header_text_color));</span>
        }
<span class="nc bnc" id="L402" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2413)) {</span>
<span class="nc" id="L403">            mEtaReminder1 = (ImageButton) mEtaContainer1.findViewById(R.id.reminder);</span>
        }
<span class="nc bnc" id="L405" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2414)) {</span>
<span class="nc" id="L406">            mEtaReminder1.setColorFilter(mView.getResources().getColor(R.color.header_text_color));</span>
        }
<span class="nc bnc" id="L408" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2415)) {</span>
<span class="nc" id="L409">            mEtaRouteName1 = (TextView) mEtaContainer1.findViewById(R.id.eta_route_name);</span>
        }
<span class="nc bnc" id="L411" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2416)) {</span>
<span class="nc" id="L412">            mEtaRouteDirection1 = (TextView) mEtaContainer1.findViewById(R.id.eta_route_direction);</span>
        }
<span class="nc bnc" id="L414" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2417)) {</span>
<span class="nc" id="L415">            mEtaAndMin1 = (RelativeLayout) mEtaContainer1.findViewById(R.id.eta_and_min);</span>
        }
<span class="nc bnc" id="L417" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2418)) {</span>
<span class="nc" id="L418">            mEtaArrivalInfo1 = (TextView) mEtaContainer1.findViewById(R.id.eta);</span>
        }
<span class="nc bnc" id="L420" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2419)) {</span>
<span class="nc" id="L421">            mEtaMin1 = (TextView) mEtaContainer1.findViewById(R.id.eta_min);</span>
        }
<span class="nc bnc" id="L423" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2420)) {</span>
<span class="nc" id="L424">            mEtaRealtime1 = (ViewGroup) mEtaContainer1.findViewById(R.id.eta_realtime_indicator);</span>
        }
<span class="nc bnc" id="L426" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2421)) {</span>
<span class="nc" id="L427">            mEtaMoreVert1 = (ImageButton) mEtaContainer1.findViewById(R.id.eta_more_vert);</span>
        }
<span class="nc bnc" id="L429" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2422)) {</span>
<span class="nc" id="L430">            mEtaMoreVert1.setColorFilter(mView.getResources().getColor(R.color.header_text_color));</span>
        }
<span class="nc bnc" id="L432" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2423)) {</span>
<span class="nc" id="L433">            mEtaSeparator = mView.findViewById(R.id.eta_separator);</span>
        }
<span class="nc bnc" id="L435" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2424)) {</span>
            // Second ETA row
<span class="nc" id="L437">            mEtaContainer2 = mView.findViewById(R.id.eta_container2);</span>
        }
<span class="nc bnc" id="L439" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2425)) {</span>
<span class="nc" id="L440">            mEtaRouteFavorite2 = (ImageButton) mEtaContainer2.findViewById(R.id.eta_route_favorite);</span>
        }
<span class="nc bnc" id="L442" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2426)) {</span>
<span class="nc" id="L443">            mEtaRouteFavorite2.setColorFilter(mView.getResources().getColor(R.color.header_text_color));</span>
        }
<span class="nc bnc" id="L445" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2427)) {</span>
<span class="nc" id="L446">            mEtaReminder2 = (ImageButton) mEtaContainer2.findViewById(R.id.reminder);</span>
        }
<span class="nc bnc" id="L448" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2428)) {</span>
<span class="nc" id="L449">            mEtaReminder2.setColorFilter(mView.getResources().getColor(R.color.header_text_color));</span>
        }
<span class="nc bnc" id="L451" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2429)) {</span>
<span class="nc" id="L452">            mEtaRouteName2 = (TextView) mEtaContainer2.findViewById(R.id.eta_route_name);</span>
        }
<span class="nc bnc" id="L454" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2430)) {</span>
<span class="nc" id="L455">            mEtaAndMin2 = (RelativeLayout) mEtaContainer2.findViewById(R.id.eta_and_min);</span>
        }
<span class="nc bnc" id="L457" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2431)) {</span>
<span class="nc" id="L458">            mEtaRouteDirection2 = (TextView) mEtaContainer2.findViewById(R.id.eta_route_direction);</span>
        }
<span class="nc bnc" id="L460" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2432)) {</span>
<span class="nc" id="L461">            mEtaArrivalInfo2 = (TextView) mEtaContainer2.findViewById(R.id.eta);</span>
        }
<span class="nc bnc" id="L463" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2433)) {</span>
<span class="nc" id="L464">            mEtaMin2 = (TextView) mEtaContainer2.findViewById(R.id.eta_min);</span>
        }
<span class="nc bnc" id="L466" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2434)) {</span>
<span class="nc" id="L467">            mEtaRealtime2 = (ViewGroup) mEtaContainer2.findViewById(R.id.eta_realtime_indicator);</span>
        }
<span class="nc bnc" id="L469" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2435)) {</span>
<span class="nc" id="L470">            mEtaMoreVert2 = (ImageButton) mEtaContainer2.findViewById(R.id.eta_more_vert);</span>
        }
<span class="nc bnc" id="L472" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2436)) {</span>
<span class="nc" id="L473">            mEtaMoreVert2.setColorFilter(mView.getResources().getColor(R.color.header_text_color));</span>
        }
<span class="nc bnc" id="L475" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2437)) {</span>
<span class="nc" id="L476">            mProgressBar = (ProgressBar) mView.findViewById(R.id.header_loading_spinner);</span>
        }
<span class="nc bnc" id="L478" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2438)) {</span>
<span class="nc" id="L479">            mStopInfo = (ImageButton) mView.findViewById(R.id.stop_info_button);</span>
        }
<span class="nc bnc" id="L481" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2439)) {</span>
<span class="nc" id="L482">            mExpandCollapse = (ImageView) mView.findViewById(R.id.expand_collapse);</span>
        }
<span class="nc bnc" id="L484" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2440)) {</span>
<span class="nc" id="L485">            mAlertView = (ImageView) mView.findViewById(R.id.alert);</span>
        }
<span class="nc bnc" id="L487" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2441)) {</span>
<span class="nc" id="L488">            mAlertView.setColorFilter(mView.getResources().getColor(R.color.header_text_color));</span>
        }
<span class="nc bnc" id="L490" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2442)) {</span>
<span class="nc" id="L491">            mAlertView.setVisibility(View.GONE);</span>
        }
<span class="nc bnc" id="L493" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2443)) {</span>
<span class="nc" id="L494">            resetExpandCollapseAnimation();</span>
        }
<span class="nc bnc" id="L496" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2444)) {</span>
            // Initialize right margin view visibilities
<span class="nc" id="L498">            UIUtils.showViewWithAnimation(mProgressBar, mShortAnimationDuration);</span>
        }
<span class="nc bnc" id="L500" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2445)) {</span>
<span class="nc" id="L501">            UIUtils.hideViewWithAnimation(mEtaContainer1, mShortAnimationDuration);</span>
        }
<span class="nc bnc" id="L503" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2446)) {</span>
<span class="nc" id="L504">            UIUtils.hideViewWithAnimation(mEtaSeparator, mShortAnimationDuration);</span>
        }
<span class="nc bnc" id="L506" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2447)) {</span>
<span class="nc" id="L507">            UIUtils.hideViewWithAnimation(mEtaContainer2, mShortAnimationDuration);</span>
        }
        // Initialize stop info view
<span class="nc" id="L510">        final ObaRegion obaRegion = Application.get().getCurrentRegion();</span>
<span class="nc bnc" id="L511" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2459)) {</span>
<span class="nc bnc" id="L512" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(2448) ? (obaRegion == null &amp;&amp; TextUtils.isEmpty(obaRegion.getStopInfoUrl())) : (obaRegion == null || TextUtils.isEmpty(obaRegion.getStopInfoUrl())))) {</span>
<span class="nc bnc" id="L513" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2458)) {</span>
                    // This region doesn't support StopInfo - hide the info icon
<span class="nc" id="L515">                    mStopInfo.setVisibility(View.GONE);</span>
                }
            } else {
<span class="nc bnc" id="L518" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2449)) {</span>
<span class="nc" id="L519">                    mStopInfo.setVisibility(View.VISIBLE);</span>
                }
<span class="nc bnc" id="L521" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2457)) {</span>
<span class="nc" id="L522">                    mStopInfo.setOnClickListener(new View.OnClickListener() {</span>

                        @Override
                        public void onClick(View v) {
                            // Assemble StopInfo URL for the current stop
<span class="nc" id="L527">                            Uri stopInfoUri = Uri.parse(obaRegion.getStopInfoUrl());</span>
<span class="nc" id="L528">                            Uri.Builder stopInfoBuilder = stopInfoUri.buildUpon();</span>
<span class="nc bnc" id="L529" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2450)) {</span>
<span class="nc" id="L530">                                stopInfoBuilder.appendPath(mContext.getString(R.string.stop_info_url_path));</span>
                            }
<span class="nc bnc" id="L532" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2451)) {</span>
<span class="nc" id="L533">                                stopInfoBuilder.appendPath(mController.getStopId());</span>
                            }
<span class="nc bnc" id="L535" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2452)) {</span>
<span class="nc" id="L536">                                Log.d(TAG, &quot;StopInfoUrl - &quot; + stopInfoBuilder.build());</span>
                            }
<span class="nc" id="L538">                            Intent i = new Intent(Intent.ACTION_VIEW);</span>
<span class="nc bnc" id="L539" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2453)) {</span>
<span class="nc" id="L540">                                i.setData(stopInfoBuilder.build());</span>
                            }
<span class="nc bnc" id="L542" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2454)) {</span>
<span class="nc" id="L543">                                mContext.startActivity(i);</span>
                            }
<span class="nc bnc" id="L545" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2456)) {</span>
                                // Analytics
<span class="nc bnc" id="L547" title="All 2 branches missed.">                                if (obaRegion.getName() != null) {</span>
<span class="nc bnc" id="L548" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(2455)) {</span>
<span class="nc" id="L549">                                        ObaAnalytics.reportUiEvent(mFirebaseAnalytics, mContext.getString(R.string.analytics_label_button_press_stopinfo), null);</span>
                                    }
                                }
                            }
<span class="nc" id="L553">                        }</span>
                    });
                }
            }
        }
<span class="nc bnc" id="L558" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2462)) {</span>
<span class="nc" id="L559">            mStopFavorite.setOnClickListener(new View.OnClickListener() {</span>

                @Override
                public void onClick(View v) {
<span class="nc bnc" id="L563" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2460)) {</span>
<span class="nc bnc" id="L564" title="All 2 branches missed.">                        mController.setFavoriteStop(!mController.isFavoriteStop());</span>
                    }
<span class="nc bnc" id="L566" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2461)) {</span>
<span class="nc" id="L567">                        refreshStopFavorite();</span>
                    }
<span class="nc" id="L569">                }</span>
            });
        }
<span class="nc bnc" id="L572" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2464)) {</span>
<span class="nc" id="L573">            mNameView.setOnClickListener(new View.OnClickListener() {</span>

                @Override
                public void onClick(View v) {
<span class="nc bnc" id="L577" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2463)) {</span>
<span class="nc" id="L578">                        beginNameEdit(null);</span>
                    }
<span class="nc" id="L580">                }</span>
            });
        }
        // Implement the &quot;Save&quot; and &quot;Clear&quot; buttons
<span class="nc" id="L584">        View save = mView.findViewById(R.id.edit_name_save);</span>
<span class="nc bnc" id="L585" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2467)) {</span>
<span class="nc" id="L586">            save.setOnClickListener(new View.OnClickListener() {</span>

                @Override
                public void onClick(View v) {
<span class="nc bnc" id="L590" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2465)) {</span>
<span class="nc" id="L591">                        mController.setUserStopName(mEditNameView.getText().toString());</span>
                    }
<span class="nc bnc" id="L593" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2466)) {</span>
<span class="nc" id="L594">                        endNameEdit();</span>
                    }
<span class="nc" id="L596">                }</span>
            });
        }
<span class="nc bnc" id="L599" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2471)) {</span>
<span class="nc" id="L600">            mEditNameView.setOnEditorActionListener(new TextView.OnEditorActionListener() {</span>

                @Override
                public boolean onEditorAction(TextView v, int actionId, KeyEvent event) {
<span class="nc bnc" id="L604" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2470)) {</span>
<span class="nc bnc" id="L605" title="All 2 branches missed.">                        if (actionId == EditorInfo.IME_ACTION_DONE) {</span>
<span class="nc bnc" id="L606" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2468)) {</span>
<span class="nc" id="L607">                                mController.setUserStopName(mEditNameView.getText().toString());</span>
                            }
<span class="nc bnc" id="L609" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2469)) {</span>
<span class="nc" id="L610">                                endNameEdit();</span>
                            }
<span class="nc" id="L612">                            return true;</span>
                        }
                    }
<span class="nc" id="L615">                    return false;</span>
                }
            });
        }
        // &quot;Cancel&quot;
<span class="nc" id="L620">        View cancel = mView.findViewById(R.id.edit_name_cancel);</span>
<span class="nc bnc" id="L621" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2473)) {</span>
<span class="nc" id="L622">            cancel.setOnClickListener(new View.OnClickListener() {</span>

                @Override
                public void onClick(View v) {
<span class="nc bnc" id="L626" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2472)) {</span>
<span class="nc" id="L627">                        endNameEdit();</span>
                    }
<span class="nc" id="L629">                }</span>
            });
        }
<span class="nc" id="L632">        View clear = mView.findViewById(R.id.edit_name_revert);</span>
<span class="nc bnc" id="L633" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2476)) {</span>
<span class="nc" id="L634">            clear.setOnClickListener(new View.OnClickListener() {</span>

                @Override
                public void onClick(View v) {
<span class="nc bnc" id="L638" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2474)) {</span>
<span class="nc" id="L639">                        mController.setUserStopName(null);</span>
                    }
<span class="nc bnc" id="L641" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2475)) {</span>
<span class="nc" id="L642">                        endNameEdit();</span>
                    }
<span class="nc" id="L644">                }</span>
            });
        }
<span class="nc" id="L647">    }</span>

    /**
     * Used to give the header control over the containing sliding panel, primarily to change the
     * panel header height
     */
    public void setSlidingPanelController(HomeActivity.SlidingPanelController controller) {
<span class="nc bnc" id="L654" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2477)) {</span>
<span class="nc" id="L655">            mSlidingPanelController = controller;</span>
        }
<span class="nc" id="L657">    }</span>

    /**
     * Should be called from onPause() of context hosting this header
     */
    public void onPause() {
<span class="nc bnc" id="L663" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2480)) {</span>
            // If we're editing a stop name, close out the editing session
<span class="nc bnc" id="L665" title="All 2 branches missed.">            if (mInNameEdit) {</span>
<span class="nc bnc" id="L666" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2478)) {</span>
<span class="nc" id="L667">                    mController.setUserStopName(null);</span>
                }
<span class="nc bnc" id="L669" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2479)) {</span>
<span class="nc" id="L670">                    endNameEdit();</span>
                }
            }
        }
<span class="nc" id="L674">    }</span>

    public synchronized void setSlidingPanelCollapsed(boolean collapsed) {
<span class="nc bnc" id="L677" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2484)) {</span>
            // If the state has changed and image is initialized, then rotate the expand/collapse image
<span class="nc bnc" id="L679" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(2481) ? (mExpandCollapse != null || collapsed != mIsSlidingPanelCollapsed) : (mExpandCollapse != null &amp;&amp; collapsed != mIsSlidingPanelCollapsed))) {</span>
<span class="nc bnc" id="L680" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2482)) {</span>
                    // Update value
<span class="nc" id="L682">                    mIsSlidingPanelCollapsed = collapsed;</span>
                }
<span class="nc bnc" id="L684" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2483)) {</span>
<span class="nc" id="L685">                    doExpandCollapseRotation(collapsed);</span>
                }
            }
        }
<span class="nc" id="L689">    }</span>

    /**
     * Sets the trip details (e.g., reminders) for this stop
     */
    public void setTripsForStop(ContentQueryMap tripsForStop) {
<span class="nc bnc" id="L695" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2485)) {</span>
<span class="nc" id="L696">            mTripsForStop = tripsForStop;</span>
        }
<span class="nc bnc" id="L698" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2486)) {</span>
<span class="nc" id="L699">            refreshArrivalInfoVisibilityAndListeners();</span>
        }
<span class="nc" id="L701">    }</span>

    @TargetApi(Build.VERSION_CODES.HONEYCOMB_MR1)
    private void doExpandCollapseRotation(boolean collapsed) {
<span class="nc bnc" id="L705" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2488)) {</span>
<span class="nc bnc" id="L706" title="All 2 branches missed.">            if (!UIUtils.canAnimateViewModern()) {</span>
<span class="nc bnc" id="L707" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2487)) {</span>
<span class="nc" id="L708">                    rotateExpandCollapseImageViewLegacy(collapsed);</span>
                }
<span class="nc" id="L710">                return;</span>
            }
        }
<span class="nc bnc" id="L713" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2491)) {</span>
<span class="nc bnc" id="L714" title="All 2 branches missed.">            if (!collapsed) {</span>
<span class="nc bnc" id="L715" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2490)) {</span>
                    // Rotate clockwise
<span class="nc" id="L717">                    mExpandCollapse.animate().setDuration(ANIM_DURATION).rotationBy(ANIM_STATE_INVERTED);</span>
                }
            } else {
<span class="nc bnc" id="L720" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2489)) {</span>
                    // Rotate counter-clockwise
<span class="nc" id="L722">                    mExpandCollapse.animate().setDuration(ANIM_DURATION).rotationBy(-ANIM_STATE_INVERTED);</span>
                }
            }
        }
<span class="nc" id="L726">    }</span>

    private void rotateExpandCollapseImageViewLegacy(boolean isSlidingPanelCollapsed) {
        RotateAnimation rotate;
<span class="nc bnc" id="L730" title="All 2 branches missed.">        if (!isSlidingPanelCollapsed) {</span>
            // Rotate clockwise
<span class="nc" id="L732">            rotate = getRotation(ANIM_STATE_NORMAL, ANIM_STATE_INVERTED);</span>
        } else {
            // Rotate counter-clockwise
<span class="nc" id="L735">            rotate = getRotation(ANIM_STATE_INVERTED, ANIM_STATE_NORMAL);</span>
        }
<span class="nc bnc" id="L737" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2492)) {</span>
<span class="nc" id="L738">            mExpandCollapse.setAnimation(rotate);</span>
        }
<span class="nc" id="L740">    }</span>

    /**
     * Resets the animation that has been applied to the expand/collapse indicator image
     */
    @TargetApi(Build.VERSION_CODES.HONEYCOMB_MR1)
    private synchronized void resetExpandCollapseAnimation() {
<span class="nc bnc" id="L747" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2493)) {</span>
<span class="nc bnc" id="L748" title="All 2 branches missed.">            if (mExpandCollapse == null) {</span>
<span class="nc" id="L749">                return;</span>
            }
        }
<span class="nc bnc" id="L752" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2497)) {</span>
<span class="nc bnc" id="L753" title="All 2 branches missed.">            if (UIUtils.canAnimateViewModern()) {</span>
<span class="nc bnc" id="L754" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2496)) {</span>
<span class="nc bnc" id="L755" title="All 2 branches missed.">                    if (mExpandCollapse.getRotation() != 0) {</span>
<span class="nc bnc" id="L756" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2495)) {</span>
<span class="nc" id="L757">                            mExpandCollapse.setRotation(0);</span>
                        }
                    }
                }
            } else {
<span class="nc bnc" id="L762" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2494)) {</span>
<span class="nc" id="L763">                    mExpandCollapse.clearAnimation();</span>
                }
            }
        }
<span class="nc" id="L767">    }</span>

    /**
     * Allows external classes to set whether or not the expand/collapse indicator should be
     * shown (e.g., if the header is not in a sliding window, we don't want to show it)
     *
     * @param value true if the expand/collapse indicator should be shown, false if it should not
     */
    public void showExpandCollapseIndicator(boolean value) {
<span class="nc bnc" id="L776" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2501)) {</span>
<span class="nc bnc" id="L777" title="All 2 branches missed.">            if (mExpandCollapse != null) {</span>
<span class="nc bnc" id="L778" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2500)) {</span>
<span class="nc bnc" id="L779" title="All 2 branches missed.">                    if (value) {</span>
<span class="nc bnc" id="L780" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2499)) {</span>
<span class="nc" id="L781">                            mExpandCollapse.setVisibility(View.VISIBLE);</span>
                        }
                    } else {
<span class="nc bnc" id="L784" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2498)) {</span>
<span class="nc" id="L785">                            mExpandCollapse.setVisibility(View.GONE);</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L791">    }</span>

    /**
     * Allows external classes to show or hide arrival information in the header
     *
     * @param value true if the arrival info should be shown, false if it should not
     */
    public void showArrivals(boolean value) {
<span class="nc bnc" id="L799" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2502)) {</span>
<span class="nc" id="L800">            mShowArrivals = value;</span>
        }
<span class="nc bnc" id="L802" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2509)) {</span>
<span class="nc bnc" id="L803" title="All 2 branches missed.">            if (mView != null) {</span>
<span class="nc" id="L804">                TableLayout arrivalTable = (TableLayout) mView.findViewById(R.id.eta_table);</span>
<span class="nc bnc" id="L805" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2508)) {</span>
<span class="nc bnc" id="L806" title="All 2 branches missed.">                    if (arrivalTable != null) {</span>
<span class="nc bnc" id="L807" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2507)) {</span>
<span class="nc bnc" id="L808" title="All 2 branches missed.">                            if (mShowArrivals) {</span>
<span class="nc bnc" id="L809" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2505)) {</span>
<span class="nc" id="L810">                                    arrivalTable.setVisibility(View.VISIBLE);</span>
                                }
<span class="nc bnc" id="L812" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2506)) {</span>
<span class="nc" id="L813">                                    mProgressBar.setVisibility(View.VISIBLE);</span>
                                }
                            } else {
<span class="nc bnc" id="L816" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2503)) {</span>
<span class="nc" id="L817">                                    arrivalTable.setVisibility(View.GONE);</span>
                                }
<span class="nc bnc" id="L819" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2504)) {</span>
<span class="nc" id="L820">                                    mProgressBar.setVisibility(View.GONE);</span>
                                }
                            }
                        }
                    }
                }
            }
        }
<span class="nc" id="L828">    }</span>

    /**
     * Returns true if the header is showing arrival info, false if it is not
     *
     * @return true if the header is showing arrival info, false if it is not
     */
    public boolean isShowingArrivals() {
<span class="nc" id="L836">        return mShowArrivals;</span>
    }

    /**
     * Creates and returns a new rotation animation for the expand/collapse image based on the
     * provided startState and endState.
     *
     * @param startState beginning state of the image, either ANIM_STATE_NORMAL or
     *                   ANIM_STATE_INVERTED
     * @param endState   end state of the image, either ANIM_STATE_NORMAL or ANIM_STATE_INVERTED
     * @return a new rotation animation for the expand/collapse image
     */
    private static RotateAnimation getRotation(float startState, float endState) {
<span class="nc" id="L849">        RotateAnimation r = new RotateAnimation(startState, endState, Animation.RELATIVE_TO_SELF, ANIM_PIVOT_VALUE, Animation.RELATIVE_TO_SELF, ANIM_PIVOT_VALUE);</span>
<span class="nc bnc" id="L850" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2510)) {</span>
<span class="nc" id="L851">            r.setDuration(ANIM_DURATION);</span>
        }
<span class="nc bnc" id="L853" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2511)) {</span>
<span class="nc" id="L854">            r.setFillAfter(true);</span>
        }
<span class="nc" id="L856">        return r;</span>
    }

    synchronized void refresh() {
<span class="nc bnc" id="L860" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2512)) {</span>
<span class="nc" id="L861">            refreshName();</span>
        }
<span class="nc bnc" id="L863" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2513)) {</span>
<span class="nc" id="L864">            refreshArrivalInfoData();</span>
        }
<span class="nc bnc" id="L866" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2514)) {</span>
<span class="nc" id="L867">            refreshStopFavorite();</span>
        }
<span class="nc bnc" id="L869" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2515)) {</span>
<span class="nc" id="L870">            refreshFilter();</span>
        }
<span class="nc bnc" id="L872" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2516)) {</span>
<span class="nc" id="L873">            refreshError();</span>
        }
<span class="nc bnc" id="L875" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2517)) {</span>
<span class="nc" id="L876">            refreshHiddenAlerts();</span>
        }
<span class="nc bnc" id="L878" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2518)) {</span>
<span class="nc" id="L879">            refreshArrivalInfoVisibilityAndListeners();</span>
        }
<span class="nc bnc" id="L881" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2519)) {</span>
<span class="nc" id="L882">            refreshHeaderSize();</span>
        }
<span class="nc" id="L884">    }</span>

    private void refreshName() {
<span class="nc bnc" id="L887" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2520)) {</span>
<span class="nc bnc" id="L888" title="All 2 branches missed.">            if (mController == null) {</span>
<span class="nc" id="L889">                return;</span>
            }
        }
<span class="nc" id="L892">        String name = mController.getStopName();</span>
<span class="nc" id="L893">        String userName = mController.getUserStopName();</span>
<span class="nc" id="L894">        String stopDirection = mController.getStopDirection();</span>
<span class="nc bnc" id="L895" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2523)) {</span>
<span class="nc bnc" id="L896" title="All 2 branches missed.">            if (!TextUtils.isEmpty(userName)) {</span>
<span class="nc bnc" id="L897" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2522)) {</span>
<span class="nc" id="L898">                    mNameView.setText(UIUtils.formatDisplayText(userName));</span>
                }
<span class="nc bnc" id="L900" title="All 2 branches missed.">            } else if (name != null) {</span>
<span class="nc bnc" id="L901" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2521)) {</span>
<span class="nc" id="L902">                    mNameView.setText(UIUtils.formatDisplayText(name));</span>
                }
            }
        }
<span class="nc bnc" id="L906" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2527)) {</span>
<span class="nc bnc" id="L907" title="All 2 branches missed.">            if (!TextUtils.isEmpty(stopDirection)) {</span>
<span class="nc bnc" id="L908" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2525)) {</span>
<span class="nc" id="L909">                    mDirectionView.setText(mContext.getString(R.string.arrival_list_stop_directions, stopDirection));</span>
                }
<span class="nc bnc" id="L911" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2526)) {</span>
<span class="nc" id="L912">                    mDirectionView.setVisibility(View.VISIBLE);</span>
                }
            } else {
<span class="nc bnc" id="L915" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2524)) {</span>
<span class="nc" id="L916">                    mDirectionView.setVisibility(View.GONE);</span>
                }
            }
        }
<span class="nc" id="L920">    }</span>

    /**
     * Refreshes the arrival info data to be displayed in the header based on the most recent
     * arrival info, and sets the number of arrival rows that should be displayed in the header
     */
    private void refreshArrivalInfoData() {
<span class="nc bnc" id="L927" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2528)) {</span>
<span class="nc bnc" id="L928" title="All 2 branches missed.">            if (mController == null) {</span>
<span class="nc" id="L929">                return;</span>
            }
        }
<span class="nc bnc" id="L932" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2529)) {</span>
<span class="nc" id="L933">            mArrivalInfo = mController.getArrivalInfo();</span>
        }
<span class="nc bnc" id="L935" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2530)) {</span>
<span class="nc" id="L936">            mHeaderArrivalInfo.clear();</span>
        }
<span class="nc bnc" id="L938" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2636)) {</span>
<span class="nc bnc" id="L939" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(2531) ? (mArrivalInfo != null || !mInNameEdit) : (mArrivalInfo != null &amp;&amp; !mInNameEdit))) {</span>
                // Get the indexes for arrival times that should be featured in the header
<span class="nc" id="L941">                ArrayList&lt;Integer&gt; etaIndexes = ArrivalInfoUtils.findPreferredArrivalIndexes(mArrivalInfo);</span>
<span class="nc bnc" id="L942" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2635)) {</span>
<span class="nc bnc" id="L943" title="All 2 branches missed.">                    if (etaIndexes != null) {</span>
                        // We have a non-negative ETA for at least one bus - fill the first arrival row
<span class="nc" id="L945">                        final int i1 = etaIndexes.get(0);</span>
<span class="nc" id="L946">                        ObaArrivalInfo info1 = mArrivalInfo.get(i1).getInfo();</span>
<span class="nc" id="L947">                        boolean isFavorite = ObaContract.RouteHeadsignFavorites.isFavorite(info1.getRouteId(), info1.getHeadsign(), info1.getStopId());</span>
<span class="nc bnc" id="L948" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2542)) {</span>
<span class="nc bnc" id="L949" title="All 2 branches missed.">                            mEtaRouteFavorite1.setImageResource(isFavorite ? R.drawable.focus_star_on : R.drawable.focus_star_off);</span>
                        }
<span class="nc bnc" id="L951" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2548)) {</span>
<span class="nc bnc" id="L952" title="All 10 branches missed.">                            if ((ListenerUtil.mutListener.listen(2543) ? (info1.getTripStatus() != null || Status.CANCELED.equals(info1.getTripStatus().getStatus())) : (info1.getTripStatus() != null &amp;&amp; Status.CANCELED.equals(info1.getTripStatus().getStatus())))) {</span>
<span class="nc bnc" id="L953" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2544)) {</span>
                                    // Trip is canceled - strike through text fields
<span class="nc" id="L955">                                    mEtaRouteName1.setPaintFlags(Paint.STRIKE_THRU_TEXT_FLAG);</span>
                                }
<span class="nc bnc" id="L957" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2545)) {</span>
<span class="nc" id="L958">                                    mEtaRouteDirection1.setPaintFlags(Paint.STRIKE_THRU_TEXT_FLAG);</span>
                                }
<span class="nc bnc" id="L960" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2546)) {</span>
<span class="nc" id="L961">                                    mEtaArrivalInfo1.setPaintFlags(Paint.STRIKE_THRU_TEXT_FLAG);</span>
                                }
<span class="nc bnc" id="L963" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2547)) {</span>
<span class="nc" id="L964">                                    mEtaMin1.setPaintFlags(Paint.STRIKE_THRU_TEXT_FLAG);</span>
                                }
                            }
                        }
<span class="nc bnc" id="L968" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2549)) {</span>
<span class="nc" id="L969">                            mEtaRouteName1.setText(info1.getShortName());</span>
                        }
<span class="nc bnc" id="L971" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2550)) {</span>
<span class="nc" id="L972">                            mEtaRouteDirection1.setText(UIUtils.formatDisplayText(info1.getHeadsign()));</span>
                        }
<span class="nc" id="L974">                        long eta = mArrivalInfo.get(i1).getEta();</span>
<span class="nc bnc" id="L975" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2567)) {</span>
<span class="nc bnc" id="L976" title="All 22 branches missed.">                            if ((ListenerUtil.mutListener.listen(2555) ? (eta &gt;= 0) : (ListenerUtil.mutListener.listen(2554) ? (eta &lt;= 0) : (ListenerUtil.mutListener.listen(2553) ? (eta &gt; 0) : (ListenerUtil.mutListener.listen(2552) ? (eta &lt; 0) : (ListenerUtil.mutListener.listen(2551) ? (eta != 0) : (eta == 0))))))) {</span>
<span class="nc bnc" id="L977" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2564)) {</span>
<span class="nc" id="L978">                                    mEtaArrivalInfo1.setText(mContext.getString(R.string.stop_info_eta_now));</span>
                                }
<span class="nc bnc" id="L980" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2565)) {</span>
<span class="nc" id="L981">                                    mEtaArrivalInfo1.setTextSize(ETA_TEXT_NOW_SIZE_SP);</span>
                                }
<span class="nc bnc" id="L983" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2566)) {</span>
<span class="nc" id="L984">                                    UIUtils.hideViewWithAnimation(mEtaMin1, mShortAnimationDuration);</span>
                                }
<span class="nc bnc" id="L986" title="All 22 branches missed.">                            } else if ((ListenerUtil.mutListener.listen(2560) ? (eta &gt;= 0) : (ListenerUtil.mutListener.listen(2559) ? (eta &lt;= 0) : (ListenerUtil.mutListener.listen(2558) ? (eta &lt; 0) : (ListenerUtil.mutListener.listen(2557) ? (eta != 0) : (ListenerUtil.mutListener.listen(2556) ? (eta == 0) : (eta &gt; 0))))))) {</span>
<span class="nc bnc" id="L987" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2561)) {</span>
<span class="nc" id="L988">                                    mEtaArrivalInfo1.setText(Long.toString(eta));</span>
                                }
<span class="nc bnc" id="L990" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2562)) {</span>
<span class="nc" id="L991">                                    mEtaArrivalInfo1.setTextSize(ETA_TEXT_SIZE_SP);</span>
                                }
<span class="nc bnc" id="L993" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2563)) {</span>
<span class="nc" id="L994">                                    UIUtils.showViewWithAnimation(mEtaMin1, mShortAnimationDuration);</span>
                                }
                            }
                        }
<span class="nc bnc" id="L998" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2568)) {</span>
<span class="nc" id="L999">                            mEtaAndMin1.setBackgroundResource(R.drawable.round_corners_style_b_header_status);</span>
                        }
<span class="nc" id="L1001">                        GradientDrawable d1 = (GradientDrawable) mEtaAndMin1.getBackground();</span>
<span class="nc" id="L1002">                        final int c1 = mArrivalInfo.get(i1).getColor();</span>
<span class="nc bnc" id="L1003" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2571)) {</span>
<span class="nc bnc" id="L1004" title="All 2 branches missed.">                            if (c1 != R.color.stop_info_ontime) {</span>
<span class="nc bnc" id="L1005" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2570)) {</span>
                                    // Show early/late/scheduled color
<span class="nc" id="L1007">                                    d1.setColor(mResources.getColor(c1));</span>
                                }
                            } else {
<span class="nc bnc" id="L1010" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2569)) {</span>
                                    // For on-time, use header on time color for better customization (#429)
<span class="nc" id="L1012">                                    d1.setColor(mResources.getColor(R.color.header_stop_info_ontime));</span>
                                }
                            }
                        }
<span class="nc bnc" id="L1016" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2577)) {</span>
<span class="nc" id="L1017">                            mEtaAndMin1.setOnClickListener(new View.OnClickListener() {</span>

                                @Override
                                public void onClick(View v) {
<span class="nc bnc" id="L1021" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(2574)) {</span>
<span class="nc bnc" id="L1022" title="All 10 branches missed.">                                        if ((ListenerUtil.mutListener.listen(2572) ? (mPopup1 != null || mPopup1.isShowing()) : (mPopup1 != null &amp;&amp; mPopup1.isShowing()))) {</span>
<span class="nc bnc" id="L1023" title="All 2 branches missed.">                                            if (!ListenerUtil.mutListener.listen(2573)) {</span>
<span class="nc" id="L1024">                                                mPopup1.dismiss();</span>
                                            }
<span class="nc" id="L1026">                                            return;</span>
                                        }
                                    }
<span class="nc bnc" id="L1029" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(2575)) {</span>
<span class="nc" id="L1030">                                        mPopup1 = setupPopup(0, c1, mArrivalInfo.get(i1).getStatusText());</span>
                                    }
<span class="nc bnc" id="L1032" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(2576)) {</span>
<span class="nc" id="L1033">                                        mPopup1.showAsDropDown(mEtaAndMin1);</span>
                                    }
<span class="nc" id="L1035">                                }</span>
                            });
                        }
<span class="nc bnc" id="L1038" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2582)) {</span>
<span class="nc bnc" id="L1039" title="All 2 branches missed.">                            if (mArrivalInfo.get(i1).getPredicted()) {</span>
<span class="nc bnc" id="L1040" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2581)) {</span>
                                    // We have real-time data - show the indicator
<span class="nc" id="L1042">                                    UIUtils.showViewWithAnimation(mEtaRealtime1, mShortAnimationDuration);</span>
                                }
                            } else {
<span class="nc bnc" id="L1045" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2578)) {</span>
                                    // We only have schedule data - hide the indicator
<span class="nc" id="L1047">                                    mEtaRealtime1.setVisibility(View.INVISIBLE);</span>
                                }
<span class="nc bnc" id="L1049" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2580)) {</span>
                                    // If this is frequency-based data, indicate that arrival is approximate
<span class="nc bnc" id="L1051" title="All 2 branches missed.">                                    if (mArrivalInfo.get(i1).getInfo().getFrequency() != null) {</span>
<span class="nc bnc" id="L1052" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(2579)) {</span>
<span class="nc" id="L1053">                                            mEtaArrivalInfo1.setText(mResources.getString(R.string.stop_info_frequency_approximate) + mEtaArrivalInfo1.getText());</span>
                                        }
                                    }
                                }
                            }
                        }
<span class="nc bnc" id="L1059" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2583)) {</span>
                            // Save the arrival info for the options menu later
<span class="nc" id="L1061">                            mHeaderArrivalInfo.add(mArrivalInfo.get(i1));</span>
                        }
<span class="nc bnc" id="L1063" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2634)) {</span>
                            // If there is another arrival, fill the second row with it
<span class="nc bnc" id="L1065" title="All 22 branches missed.">                            if ((ListenerUtil.mutListener.listen(2588) ? (etaIndexes.size() &lt;= 2) : (ListenerUtil.mutListener.listen(2587) ? (etaIndexes.size() &gt; 2) : (ListenerUtil.mutListener.listen(2586) ? (etaIndexes.size() &lt; 2) : (ListenerUtil.mutListener.listen(2585) ? (etaIndexes.size() != 2) : (ListenerUtil.mutListener.listen(2584) ? (etaIndexes.size() == 2) : (etaIndexes.size() &gt;= 2))))))) {</span>
<span class="nc" id="L1066">                                final int i2 = etaIndexes.get(1);</span>
<span class="nc" id="L1067">                                ObaArrivalInfo info2 = mArrivalInfo.get(i2).getInfo();</span>
<span class="nc" id="L1068">                                boolean isFavorite2 = ObaContract.RouteHeadsignFavorites.isFavorite(info2.getRouteId(), info2.getHeadsign(), info2.getStopId());</span>
<span class="nc bnc" id="L1069" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2590)) {</span>
<span class="nc bnc" id="L1070" title="All 2 branches missed.">                                    mEtaRouteFavorite2.setImageResource(isFavorite2 ? R.drawable.focus_star_on : R.drawable.focus_star_off);</span>
                                }
<span class="nc bnc" id="L1072" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2596)) {</span>
<span class="nc bnc" id="L1073" title="All 10 branches missed.">                                    if ((ListenerUtil.mutListener.listen(2591) ? (info2.getTripStatus() != null || Status.CANCELED.equals(info2.getTripStatus().getStatus())) : (info2.getTripStatus() != null &amp;&amp; Status.CANCELED.equals(info2.getTripStatus().getStatus())))) {</span>
<span class="nc bnc" id="L1074" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(2592)) {</span>
                                            // Trip is canceled - strike through text fields
<span class="nc" id="L1076">                                            mEtaRouteName2.setPaintFlags(Paint.STRIKE_THRU_TEXT_FLAG);</span>
                                        }
<span class="nc bnc" id="L1078" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(2593)) {</span>
<span class="nc" id="L1079">                                            mEtaRouteDirection2.setPaintFlags(Paint.STRIKE_THRU_TEXT_FLAG);</span>
                                        }
<span class="nc bnc" id="L1081" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(2594)) {</span>
<span class="nc" id="L1082">                                            mEtaArrivalInfo2.setPaintFlags(Paint.STRIKE_THRU_TEXT_FLAG);</span>
                                        }
<span class="nc bnc" id="L1084" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(2595)) {</span>
<span class="nc" id="L1085">                                            mEtaMin2.setPaintFlags(Paint.STRIKE_THRU_TEXT_FLAG);</span>
                                        }
                                    }
                                }
<span class="nc bnc" id="L1089" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2597)) {</span>
<span class="nc" id="L1090">                                    mEtaRouteName2.setText(info2.getShortName());</span>
                                }
<span class="nc bnc" id="L1092" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2598)) {</span>
<span class="nc" id="L1093">                                    mEtaRouteDirection2.setText(UIUtils.formatDisplayText(info2.getHeadsign()));</span>
                                }
<span class="nc bnc" id="L1095" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2599)) {</span>
<span class="nc" id="L1096">                                    eta = mArrivalInfo.get(i2).getEta();</span>
                                }
<span class="nc bnc" id="L1098" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2616)) {</span>
<span class="nc bnc" id="L1099" title="All 22 branches missed.">                                    if ((ListenerUtil.mutListener.listen(2604) ? (eta &gt;= 0) : (ListenerUtil.mutListener.listen(2603) ? (eta &lt;= 0) : (ListenerUtil.mutListener.listen(2602) ? (eta &gt; 0) : (ListenerUtil.mutListener.listen(2601) ? (eta &lt; 0) : (ListenerUtil.mutListener.listen(2600) ? (eta != 0) : (eta == 0))))))) {</span>
<span class="nc bnc" id="L1100" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(2613)) {</span>
<span class="nc" id="L1101">                                            mEtaArrivalInfo2.setText(mContext.getString(R.string.stop_info_eta_now));</span>
                                        }
<span class="nc bnc" id="L1103" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(2614)) {</span>
<span class="nc" id="L1104">                                            mEtaArrivalInfo2.setTextSize(ETA_TEXT_NOW_SIZE_SP);</span>
                                        }
<span class="nc bnc" id="L1106" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(2615)) {</span>
<span class="nc" id="L1107">                                            UIUtils.hideViewWithAnimation(mEtaMin2, mShortAnimationDuration);</span>
                                        }
<span class="nc bnc" id="L1109" title="All 22 branches missed.">                                    } else if ((ListenerUtil.mutListener.listen(2609) ? (eta &gt;= 0) : (ListenerUtil.mutListener.listen(2608) ? (eta &lt;= 0) : (ListenerUtil.mutListener.listen(2607) ? (eta &lt; 0) : (ListenerUtil.mutListener.listen(2606) ? (eta != 0) : (ListenerUtil.mutListener.listen(2605) ? (eta == 0) : (eta &gt; 0))))))) {</span>
<span class="nc bnc" id="L1110" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(2610)) {</span>
<span class="nc" id="L1111">                                            mEtaArrivalInfo2.setText(Long.toString(eta));</span>
                                        }
<span class="nc bnc" id="L1113" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(2611)) {</span>
<span class="nc" id="L1114">                                            mEtaArrivalInfo2.setTextSize(ETA_TEXT_SIZE_SP);</span>
                                        }
<span class="nc bnc" id="L1116" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(2612)) {</span>
<span class="nc" id="L1117">                                            UIUtils.showViewWithAnimation(mEtaMin2, mShortAnimationDuration);</span>
                                        }
                                    }
                                }
<span class="nc bnc" id="L1121" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2617)) {</span>
<span class="nc" id="L1122">                                    mEtaAndMin2.setBackgroundResource(R.drawable.round_corners_style_b_header_status);</span>
                                }
<span class="nc" id="L1124">                                GradientDrawable d2 = (GradientDrawable) mEtaAndMin2.getBackground();</span>
<span class="nc" id="L1125">                                final int c2 = mArrivalInfo.get(i2).getColor();</span>
<span class="nc bnc" id="L1126" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2620)) {</span>
<span class="nc bnc" id="L1127" title="All 2 branches missed.">                                    if (c2 != R.color.stop_info_ontime) {</span>
<span class="nc bnc" id="L1128" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(2619)) {</span>
                                            // Show early/late/scheduled color
<span class="nc" id="L1130">                                            d2.setColor(mResources.getColor(c2));</span>
                                        }
                                    } else {
<span class="nc bnc" id="L1133" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(2618)) {</span>
                                            // For on-time, use header on time color for better customization (#429)
<span class="nc" id="L1135">                                            d2.setColor(mResources.getColor(R.color.header_stop_info_ontime));</span>
                                        }
                                    }
                                }
<span class="nc bnc" id="L1139" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2626)) {</span>
<span class="nc" id="L1140">                                    mEtaAndMin2.setOnClickListener(new View.OnClickListener() {</span>

                                        @Override
                                        public void onClick(View v) {
<span class="nc bnc" id="L1144" title="All 2 branches missed.">                                            if (!ListenerUtil.mutListener.listen(2623)) {</span>
<span class="nc bnc" id="L1145" title="All 10 branches missed.">                                                if ((ListenerUtil.mutListener.listen(2621) ? (mPopup2 != null || mPopup2.isShowing()) : (mPopup2 != null &amp;&amp; mPopup2.isShowing()))) {</span>
<span class="nc bnc" id="L1146" title="All 2 branches missed.">                                                    if (!ListenerUtil.mutListener.listen(2622)) {</span>
<span class="nc" id="L1147">                                                        mPopup2.dismiss();</span>
                                                    }
<span class="nc" id="L1149">                                                    return;</span>
                                                }
                                            }
<span class="nc bnc" id="L1152" title="All 2 branches missed.">                                            if (!ListenerUtil.mutListener.listen(2624)) {</span>
<span class="nc" id="L1153">                                                mPopup2 = setupPopup(1, c2, mArrivalInfo.get(i2).getStatusText());</span>
                                            }
<span class="nc bnc" id="L1155" title="All 2 branches missed.">                                            if (!ListenerUtil.mutListener.listen(2625)) {</span>
<span class="nc" id="L1156">                                                mPopup2.showAsDropDown(mEtaAndMin2);</span>
                                            }
<span class="nc" id="L1158">                                        }</span>
                                    });
                                }
<span class="nc bnc" id="L1161" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2631)) {</span>
<span class="nc bnc" id="L1162" title="All 2 branches missed.">                                    if (mArrivalInfo.get(i2).getPredicted()) {</span>
<span class="nc bnc" id="L1163" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(2630)) {</span>
                                            // We have real-time data - show the indicator
<span class="nc" id="L1165">                                            UIUtils.showViewWithAnimation(mEtaRealtime2, mShortAnimationDuration);</span>
                                        }
                                    } else {
<span class="nc bnc" id="L1168" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(2627)) {</span>
                                            // We only have schedule data - hide the indicator
<span class="nc" id="L1170">                                            mEtaRealtime2.setVisibility(View.INVISIBLE);</span>
                                        }
<span class="nc bnc" id="L1172" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(2629)) {</span>
                                            // If this is frequency-based data, indicate that arrival is approximate
<span class="nc bnc" id="L1174" title="All 2 branches missed.">                                            if (mArrivalInfo.get(i2).getInfo().getFrequency() != null) {</span>
<span class="nc bnc" id="L1175" title="All 2 branches missed.">                                                if (!ListenerUtil.mutListener.listen(2628)) {</span>
<span class="nc" id="L1176">                                                    mEtaArrivalInfo2.setText(mResources.getString(R.string.stop_info_frequency_approximate) + mEtaArrivalInfo2.getText());</span>
                                                }
                                            }
                                        }
                                    }
                                }
<span class="nc bnc" id="L1182" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2632)) {</span>
<span class="nc" id="L1183">                                    mNumHeaderArrivals = 2;</span>
                                }
<span class="nc bnc" id="L1185" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2633)) {</span>
                                    // Save the arrival info for the options menu later
<span class="nc" id="L1187">                                    mHeaderArrivalInfo.add(mArrivalInfo.get(i2));</span>
                                }
<span class="nc" id="L1189">                            } else {</span>
<span class="nc bnc" id="L1190" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2589)) {</span>
<span class="nc" id="L1191">                                    mNumHeaderArrivals = 1;</span>
                                }
                            }
                        }
<span class="nc" id="L1195">                    } else {</span>
                        // Show abbreviated &quot;no upcoming arrivals&quot; message (e.g., &quot;35+ min&quot;)
<span class="nc" id="L1197">                        int minAfter = mController.getMinutesAfter();</span>
<span class="nc bnc" id="L1198" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2540)) {</span>
<span class="nc bnc" id="L1199" title="All 22 branches missed.">                            if ((ListenerUtil.mutListener.listen(2536) ? (minAfter &gt;= -1) : (ListenerUtil.mutListener.listen(2535) ? (minAfter &lt;= -1) : (ListenerUtil.mutListener.listen(2534) ? (minAfter &gt; -1) : (ListenerUtil.mutListener.listen(2533) ? (minAfter &lt; -1) : (ListenerUtil.mutListener.listen(2532) ? (minAfter == -1) : (minAfter != -1))))))) {</span>
<span class="nc bnc" id="L1200" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2539)) {</span>
<span class="nc" id="L1201">                                    mNoArrivals.setText(UIUtils.getNoArrivalsMessage(mContext, minAfter, false, false));</span>
                                }
                            } else {
<span class="nc bnc" id="L1204" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2537)) {</span>
                                    // Assume 35 minutes, because that's the API default
<span class="nc" id="L1206">                                    minAfter = 35;</span>
                                }
<span class="nc bnc" id="L1208" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(2538)) {</span>
<span class="nc" id="L1209">                                    mNoArrivals.setText(UIUtils.getNoArrivalsMessage(mContext, minAfter, false, false));</span>
                                }
                            }
                        }
<span class="nc bnc" id="L1213" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2541)) {</span>
<span class="nc" id="L1214">                            mNumHeaderArrivals = 0;</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L1220">    }</span>

    /**
     * Sets the popup for the status
     *
     * @param index      0 if this is for the top ETA row, 1 if it is for the second
     * @param color      color resource id to use for the popup background
     * @param statusText text to show in the status popup
     * @return a new PopupWindow initialized based on the provided parameters
     */
    private PopupWindow setupPopup(final int index, int color, String statusText) {
<span class="nc" id="L1231">        LayoutInflater inflater = LayoutInflater.from(mContext);</span>
<span class="nc" id="L1232">        TextView statusView = (TextView) inflater.inflate(R.layout.arrivals_list_tv_template_style_b_status_large, null);</span>
<span class="nc bnc" id="L1233" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2637)) {</span>
<span class="nc" id="L1234">            statusView.setBackgroundResource(R.drawable.round_corners_style_b_status);</span>
        }
<span class="nc" id="L1236">        GradientDrawable d = (GradientDrawable) statusView.getBackground();</span>
<span class="nc bnc" id="L1237" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2640)) {</span>
<span class="nc bnc" id="L1238" title="All 2 branches missed.">            if (color != R.color.stop_info_ontime) {</span>
<span class="nc bnc" id="L1239" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2639)) {</span>
                    // Show early/late color
<span class="nc" id="L1241">                    d.setColor(mResources.getColor(color));</span>
                }
            } else {
<span class="nc bnc" id="L1244" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2638)) {</span>
                    // For on-time, use header on time color for better customization (#429)
<span class="nc" id="L1246">                    d.setColor(mResources.getColor(R.color.header_stop_info_ontime));</span>
                }
            }
        }
<span class="nc bnc" id="L1250" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2641)) {</span>
<span class="nc" id="L1251">            d.setStroke(UIUtils.dpToPixels(mContext, 1), mResources.getColor(R.color.header_text_color));</span>
        }
<span class="nc" id="L1253">        int pSides = UIUtils.dpToPixels(mContext, 5);</span>
<span class="nc" id="L1254">        int pTopBottom = UIUtils.dpToPixels(mContext, 2);</span>
<span class="nc bnc" id="L1255" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2642)) {</span>
<span class="nc" id="L1256">            statusView.setPadding(pSides, pTopBottom, pSides, pTopBottom);</span>
        }
<span class="nc bnc" id="L1258" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2643)) {</span>
<span class="nc" id="L1259">            statusView.setLayoutParams(new ViewGroup.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT));</span>
        }
<span class="nc bnc" id="L1261" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2644)) {</span>
<span class="nc" id="L1262">            statusView.measure(TextView.MeasureSpec.UNSPECIFIED, TextView.MeasureSpec.UNSPECIFIED);</span>
        }
<span class="nc bnc" id="L1264" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2645)) {</span>
<span class="nc" id="L1265">            statusView.setText(statusText);</span>
        }
<span class="nc" id="L1267">        PopupWindow p = new PopupWindow(statusView, statusView.getWidth(), statusView.getHeight());</span>
<span class="nc bnc" id="L1268" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2646)) {</span>
<span class="nc" id="L1269">            p.setWindowLayoutMode(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT);</span>
        }
<span class="nc bnc" id="L1271" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2647)) {</span>
<span class="nc" id="L1272">            p.setBackgroundDrawable(new ColorDrawable(mResources.getColor(android.R.color.transparent)));</span>
        }
<span class="nc bnc" id="L1274" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2648)) {</span>
<span class="nc" id="L1275">            p.setOutsideTouchable(true);</span>
        }
<span class="nc bnc" id="L1277" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2649)) {</span>
<span class="nc" id="L1278">            p.setTouchInterceptor(new View.OnTouchListener() {</span>

                @Override
                public boolean onTouch(View v, MotionEvent event) {
                    boolean touchInView;
<span class="nc bnc" id="L1283" title="All 2 branches missed.">                    if (index == 0) {</span>
<span class="nc" id="L1284">                        touchInView = UIUtils.isTouchInView(mEtaAndMin1, event);</span>
                    } else {
<span class="nc" id="L1286">                        touchInView = UIUtils.isTouchInView(mEtaAndMin2, event);</span>
                    }
<span class="nc" id="L1288">                    return touchInView;</span>
                }
            });
        }
<span class="nc" id="L1292">        return p;</span>
    }

    private void refreshStopFavorite() {
<span class="nc bnc" id="L1296" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2650)) {</span>
<span class="nc bnc" id="L1297" title="All 2 branches missed.">            mStopFavorite.setImageResource(mController.isFavoriteStop() ? R.drawable.focus_star_on : R.drawable.focus_star_off);</span>
        }
<span class="nc" id="L1299">    }</span>

    /**
     * Refreshes the routes filter, and displays/hides it if necessary
     */
    private void refreshFilter() {
<span class="nc bnc" id="L1305" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2651)) {</span>
<span class="nc bnc" id="L1306" title="All 2 branches missed.">            if (mController == null) {</span>
<span class="nc" id="L1307">                return;</span>
            }
        }
<span class="nc" id="L1310">        TextView v = (TextView) mView.findViewById(R.id.filter_text);</span>
<span class="nc" id="L1311">        ArrayList&lt;String&gt; routesFilter = mController.getRoutesFilter();</span>
<span class="nc bnc" id="L1312" title="All 2 branches missed.">        final int num = (routesFilter != null) ? routesFilter.size() : 0;</span>
<span class="nc bnc" id="L1313" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2662)) {</span>
<span class="nc bnc" id="L1314" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(2656) ? (num &gt;= 0) : (ListenerUtil.mutListener.listen(2655) ? (num &lt;= 0) : (ListenerUtil.mutListener.listen(2654) ? (num &lt; 0) : (ListenerUtil.mutListener.listen(2653) ? (num != 0) : (ListenerUtil.mutListener.listen(2652) ? (num == 0) : (num &gt; 0))))))) {</span>
<span class="nc" id="L1315">                final int total = mController.getNumRoutes();</span>
<span class="nc bnc" id="L1316" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2658)) {</span>
<span class="nc" id="L1317">                    v.setText(mContext.getString(R.string.stop_info_filter_header, num, total));</span>
                }
<span class="nc bnc" id="L1319" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2661)) {</span>
                    // Show the filter text (except when in name edit mode)
<span class="nc bnc" id="L1321" title="All 2 branches missed.">                    if (mInNameEdit) {</span>
<span class="nc bnc" id="L1322" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2660)) {</span>
<span class="nc" id="L1323">                            mFilterGroup.setVisibility(View.GONE);</span>
                        }
                    } else {
<span class="nc bnc" id="L1326" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2659)) {</span>
<span class="nc" id="L1327">                            mFilterGroup.setVisibility(View.VISIBLE);</span>
                        }
                    }
                }
<span class="nc" id="L1331">            } else {</span>
<span class="nc bnc" id="L1332" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2657)) {</span>
<span class="nc" id="L1333">                    mFilterGroup.setVisibility(View.GONE);</span>
                }
            }
        }
<span class="nc" id="L1337">    }</span>

    /**
     * Returns true if we're filtering routes from the user's view, or false if we're not
     *
     * @return true if we're filtering routes from the user's view, or false if we're not
     */
    private boolean isFilteringRoutes() {
<span class="nc" id="L1345">        ArrayList&lt;String&gt; routesFilter = mController.getRoutesFilter();</span>
<span class="nc bnc" id="L1346" title="All 2 branches missed.">        final int num = (routesFilter != null) ? routesFilter.size() : 0;</span>
<span class="nc bnc" id="L1347" title="All 22 branches missed.">        return (ListenerUtil.mutListener.listen(2667) ? (num &gt;= 0) : (ListenerUtil.mutListener.listen(2666) ? (num &lt;= 0) : (ListenerUtil.mutListener.listen(2665) ? (num &lt; 0) : (ListenerUtil.mutListener.listen(2664) ? (num != 0) : (ListenerUtil.mutListener.listen(2663) ? (num == 0) : (num &gt; 0))))));</span>
    }

    /**
     * Hides the progress bar, and replaces it with the correct content depending on sliding
     * panel state and arrival info
     */
    @TargetApi(Build.VERSION_CODES.HONEYCOMB)
    private void refreshArrivalInfoVisibilityAndListeners() {
<span class="nc bnc" id="L1356" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2668)) {</span>
<span class="nc bnc" id="L1357" title="All 2 branches missed.">            if (mInNameEdit) {</span>
                // If the user is editing a stop name, we shouldn't show any of these views
<span class="nc" id="L1359">                return;</span>
            }
        }
<span class="nc bnc" id="L1362" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2674)) {</span>
<span class="nc bnc" id="L1363" title="All 2 branches missed.">            if (mArrivalInfo == null) {</span>
<span class="nc bnc" id="L1364" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2669)) {</span>
                    // We don't have any arrival info yet, so make sure the progress bar is running
<span class="nc" id="L1366">                    UIUtils.showViewWithAnimation(mProgressBar, mShortAnimationDuration);</span>
                }
<span class="nc bnc" id="L1368" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2670)) {</span>
                    // Hide all the arrival views
<span class="nc" id="L1370">                    UIUtils.hideViewWithAnimation(mNoArrivals, mShortAnimationDuration);</span>
                }
<span class="nc bnc" id="L1372" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2671)) {</span>
<span class="nc" id="L1373">                    UIUtils.hideViewWithAnimation(mEtaContainer1, mShortAnimationDuration);</span>
                }
<span class="nc bnc" id="L1375" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2672)) {</span>
<span class="nc" id="L1376">                    UIUtils.hideViewWithAnimation(mEtaSeparator, mShortAnimationDuration);</span>
                }
<span class="nc bnc" id="L1378" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2673)) {</span>
<span class="nc" id="L1379">                    UIUtils.hideViewWithAnimation(mEtaContainer2, mShortAnimationDuration);</span>
                }
<span class="nc" id="L1381">                return;</span>
            }
        }
<span class="nc bnc" id="L1384" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2684)) {</span>
<span class="nc bnc" id="L1385" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(2679) ? (mNumHeaderArrivals &gt;= 0) : (ListenerUtil.mutListener.listen(2678) ? (mNumHeaderArrivals &lt;= 0) : (ListenerUtil.mutListener.listen(2677) ? (mNumHeaderArrivals &gt; 0) : (ListenerUtil.mutListener.listen(2676) ? (mNumHeaderArrivals &lt; 0) : (ListenerUtil.mutListener.listen(2675) ? (mNumHeaderArrivals != 0) : (mNumHeaderArrivals == 0))))))) {</span>
<span class="nc bnc" id="L1386" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2680)) {</span>
                    // &quot;No routes&quot; message should be shown
<span class="nc" id="L1388">                    UIUtils.showViewWithAnimation(mNoArrivals, mShortAnimationDuration);</span>
                }
<span class="nc bnc" id="L1390" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2681)) {</span>
                    // Hide all others
<span class="nc" id="L1392">                    UIUtils.hideViewWithAnimation(mEtaContainer1, mShortAnimationDuration);</span>
                }
<span class="nc bnc" id="L1394" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2682)) {</span>
<span class="nc" id="L1395">                    UIUtils.hideViewWithAnimation(mEtaSeparator, mShortAnimationDuration);</span>
                }
<span class="nc bnc" id="L1397" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2683)) {</span>
<span class="nc" id="L1398">                    UIUtils.hideViewWithAnimation(mEtaContainer2, mShortAnimationDuration);</span>
                }
            }
        }
<span class="nc bnc" id="L1402" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2702)) {</span>
            // Show at least the first row of arrival info, if we have one or more records
<span class="nc bnc" id="L1404" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(2689) ? (mNumHeaderArrivals &lt;= 1) : (ListenerUtil.mutListener.listen(2688) ? (mNumHeaderArrivals &gt; 1) : (ListenerUtil.mutListener.listen(2687) ? (mNumHeaderArrivals &lt; 1) : (ListenerUtil.mutListener.listen(2686) ? (mNumHeaderArrivals != 1) : (ListenerUtil.mutListener.listen(2685) ? (mNumHeaderArrivals == 1) : (mNumHeaderArrivals &gt;= 1))))))) {</span>
<span class="nc bnc" id="L1405" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2690)) {</span>
                    // Show the first row of arrival info
<span class="nc" id="L1407">                    UIUtils.showViewWithAnimation(mEtaContainer1, mShortAnimationDuration);</span>
                }
<span class="nc bnc" id="L1409" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2691)) {</span>
                    // Hide no arrivals
<span class="nc" id="L1411">                    UIUtils.hideViewWithAnimation(mNoArrivals, mShortAnimationDuration);</span>
                }
                // Setup tapping on star for first row
<span class="nc" id="L1414">                final ObaArrivalInfo info1 = mHeaderArrivalInfo.get(0).getInfo();</span>
<span class="nc" id="L1415">                final boolean isRouteFavorite = ObaContract.RouteHeadsignFavorites.isFavorite(info1.getRouteId(), info1.getHeadsign(), info1.getStopId());</span>
<span class="nc bnc" id="L1416" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2696)) {</span>
<span class="nc" id="L1417">                    mEtaRouteFavorite1.setOnClickListener(new View.OnClickListener() {</span>

                        @Override
                        public void onClick(View v) {
                            // Show dialog for setting route favorite
<span class="nc bnc" id="L1422" title="All 2 branches missed.">                            RouteFavoriteDialogFragment dialog = new RouteFavoriteDialogFragment.Builder(info1.getRouteId(), UIUtils.formatDisplayText(info1.getHeadsign())).setRouteShortName(info1.getShortName()).setRouteLongName(info1.getRouteLongName()).setStopId(info1.getStopId()).setFavorite(!isRouteFavorite).build();</span>
<span class="nc bnc" id="L1423" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2694)) {</span>
<span class="nc" id="L1424">                                dialog.setCallback(new RouteFavoriteDialogFragment.Callback() {</span>

                                    @Override
                                    public void onSelectionComplete(boolean savedFavorite) {
<span class="nc bnc" id="L1428" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(2693)) {</span>
<span class="nc bnc" id="L1429" title="All 2 branches missed.">                                            if (savedFavorite) {</span>
<span class="nc bnc" id="L1430" title="All 2 branches missed.">                                                if (!ListenerUtil.mutListener.listen(2692)) {</span>
<span class="nc" id="L1431">                                                    mController.refreshLocal();</span>
                                                }
                                            }
                                        }
<span class="nc" id="L1435">                                    }</span>
                                });
                            }
<span class="nc bnc" id="L1438" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2695)) {</span>
<span class="nc" id="L1439">                                dialog.show(mFragmentManager, RouteFavoriteDialogFragment.TAG);</span>
                            }
<span class="nc" id="L1441">                        }</span>
                    });
                }
<span class="nc bnc" id="L1444" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2698)) {</span>
<span class="nc" id="L1445">                    mEtaReminder1.setOnClickListener(new View.OnClickListener() {</span>

                        @Override
                        public void onClick(View v) {
<span class="nc bnc" id="L1449" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2697)) {</span>
                                // Add / edit reminder
<span class="nc" id="L1451">                                TripInfoActivity.start(mContext, info1.getTripId(), mController.getStopId(), info1.getRouteId(), info1.getShortName(), mController.getStopName(), info1.getScheduledDepartureTime(), info1.getHeadsign());</span>
                            }
<span class="nc" id="L1453">                        }</span>
                    });
                }
<span class="nc bnc" id="L1456" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2700)) {</span>
                    // Setup &quot;more&quot; button click for first row
<span class="nc" id="L1458">                    mEtaMoreVert1.setOnClickListener(new View.OnClickListener() {</span>

                        @Override
                        public void onClick(View v) {
<span class="nc bnc" id="L1462" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2699)) {</span>
<span class="nc" id="L1463">                                mController.showListItemMenu(mEtaContainer1, mHeaderArrivalInfo.get(0));</span>
                            }
<span class="nc" id="L1465">                        }</span>
                    });
                }
                // Show or hide reminder for first row
<span class="nc" id="L1469">                View r = mEtaContainer1.findViewById(R.id.reminder);</span>
<span class="nc bnc" id="L1470" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2701)) {</span>
<span class="nc" id="L1471">                    refreshReminder(mHeaderArrivalInfo.get(0).getInfo().getTripId(), r);</span>
                }
            }
        }
<span class="nc bnc" id="L1475" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2722)) {</span>
<span class="nc bnc" id="L1476" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(2707) ? (mNumHeaderArrivals &lt;= 2) : (ListenerUtil.mutListener.listen(2706) ? (mNumHeaderArrivals &gt; 2) : (ListenerUtil.mutListener.listen(2705) ? (mNumHeaderArrivals &lt; 2) : (ListenerUtil.mutListener.listen(2704) ? (mNumHeaderArrivals != 2) : (ListenerUtil.mutListener.listen(2703) ? (mNumHeaderArrivals == 2) : (mNumHeaderArrivals &gt;= 2))))))) {</span>
<span class="nc bnc" id="L1477" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2710)) {</span>
                    // Also show the 2nd row of arrival info
<span class="nc" id="L1479">                    UIUtils.showViewWithAnimation(mEtaSeparator, mShortAnimationDuration);</span>
                }
<span class="nc bnc" id="L1481" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2711)) {</span>
<span class="nc" id="L1482">                    UIUtils.showViewWithAnimation(mEtaContainer2, mShortAnimationDuration);</span>
                }
                // Setup tapping on star for second row
<span class="nc" id="L1485">                final ObaArrivalInfo info2 = mHeaderArrivalInfo.get(1).getInfo();</span>
<span class="nc" id="L1486">                final boolean isRouteFavorite2 = ObaContract.RouteHeadsignFavorites.isFavorite(info2.getRouteId(), info2.getHeadsign(), info2.getStopId());</span>
<span class="nc bnc" id="L1487" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2716)) {</span>
<span class="nc" id="L1488">                    mEtaRouteFavorite2.setOnClickListener(new View.OnClickListener() {</span>

                        @Override
                        public void onClick(View v) {
                            // Show dialog for setting route favorite
<span class="nc bnc" id="L1493" title="All 2 branches missed.">                            RouteFavoriteDialogFragment dialog = new RouteFavoriteDialogFragment.Builder(info2.getRouteId(), info2.getHeadsign()).setRouteShortName(info2.getShortName()).setRouteLongName(info2.getRouteLongName()).setStopId(info2.getStopId()).setFavorite(!isRouteFavorite2).build();</span>
<span class="nc bnc" id="L1494" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2714)) {</span>
<span class="nc" id="L1495">                                dialog.setCallback(new RouteFavoriteDialogFragment.Callback() {</span>

                                    @Override
                                    public void onSelectionComplete(boolean savedFavorite) {
<span class="nc bnc" id="L1499" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(2713)) {</span>
<span class="nc bnc" id="L1500" title="All 2 branches missed.">                                            if (savedFavorite) {</span>
<span class="nc bnc" id="L1501" title="All 2 branches missed.">                                                if (!ListenerUtil.mutListener.listen(2712)) {</span>
<span class="nc" id="L1502">                                                    mController.refreshLocal();</span>
                                                }
                                            }
                                        }
<span class="nc" id="L1506">                                    }</span>
                                });
                            }
<span class="nc bnc" id="L1509" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2715)) {</span>
<span class="nc" id="L1510">                                dialog.show(mFragmentManager, RouteFavoriteDialogFragment.TAG);</span>
                            }
<span class="nc" id="L1512">                        }</span>
                    });
                }
<span class="nc bnc" id="L1515" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2718)) {</span>
<span class="nc" id="L1516">                    mEtaReminder2.setOnClickListener(new View.OnClickListener() {</span>

                        @Override
                        public void onClick(View v) {
<span class="nc bnc" id="L1520" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2717)) {</span>
                                // Add / edit reminder
<span class="nc" id="L1522">                                TripInfoActivity.start(mContext, info2.getTripId(), mController.getStopId(), info2.getRouteId(), info2.getShortName(), mController.getStopName(), info2.getScheduledDepartureTime(), info2.getHeadsign());</span>
                            }
<span class="nc" id="L1524">                        }</span>
                    });
                }
<span class="nc bnc" id="L1527" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2720)) {</span>
                    // Setup &quot;more&quot; button click for second row
<span class="nc" id="L1529">                    mEtaMoreVert2.setOnClickListener(new View.OnClickListener() {</span>

                        @Override
                        public void onClick(View v) {
<span class="nc bnc" id="L1533" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2719)) {</span>
<span class="nc" id="L1534">                                mController.showListItemMenu(mEtaContainer2, mHeaderArrivalInfo.get(1));</span>
                            }
<span class="nc" id="L1536">                        }</span>
                    });
                }
                // Show or hide reminder for second row
<span class="nc" id="L1540">                View r = mEtaContainer2.findViewById(R.id.reminder);</span>
<span class="nc bnc" id="L1541" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2721)) {</span>
<span class="nc" id="L1542">                    refreshReminder(mHeaderArrivalInfo.get(1).getInfo().getTripId(), r);</span>
                }
<span class="nc" id="L1544">            } else {</span>
<span class="nc bnc" id="L1545" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2708)) {</span>
                    // Hide the 2nd row of arrival info and related views - we only had one arrival info
<span class="nc" id="L1547">                    UIUtils.hideViewWithAnimation(mEtaSeparator, mShortAnimationDuration);</span>
                }
<span class="nc bnc" id="L1549" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2709)) {</span>
<span class="nc" id="L1550">                    UIUtils.hideViewWithAnimation(mEtaContainer2, mShortAnimationDuration);</span>
                }
            }
        }
<span class="nc bnc" id="L1554" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2723)) {</span>
            // Hide progress bar
<span class="nc" id="L1556">            UIUtils.hideViewWithAnimation(mProgressBar, mShortAnimationDuration);</span>
        }
<span class="nc" id="L1558">    }</span>

    /**
     * Shows or hides a reminder in the header, based on whether there is a saved reminder for
     * the given tripId and the current stop
     * @param tripId tripId to search for reminders for in the database
     * @param v reminder view to show or hide, based on whether the there is or isn't a reminder for
     *          this tripId and stop
     */
    void refreshReminder(String tripId, View v) {
<span class="nc" id="L1568">        ContentValues values = null;</span>
<span class="nc bnc" id="L1569" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2725)) {</span>
<span class="nc bnc" id="L1570" title="All 2 branches missed.">            if (mTripsForStop != null) {</span>
<span class="nc bnc" id="L1571" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2724)) {</span>
<span class="nc" id="L1572">                    values = mTripsForStop.getValues(tripId);</span>
                }
            }
        }
<span class="nc bnc" id="L1576" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2728)) {</span>
<span class="nc bnc" id="L1577" title="All 2 branches missed.">            if (values != null) {</span>
<span class="nc bnc" id="L1578" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2727)) {</span>
                    // A reminder exists for this trip
<span class="nc" id="L1580">                    v.setVisibility(View.VISIBLE);</span>
                }
            } else {
<span class="nc bnc" id="L1583" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2726)) {</span>
<span class="nc" id="L1584">                    v.setVisibility(View.GONE);</span>
                }
            }
        }
<span class="nc" id="L1588">    }</span>

    /**
     * Sets the header to the correct size based on the number of arrivals currently
     * shown in the header, and whether the panel is collapsed, anchored, or expanded.
     */
    void refreshHeaderSize() {
<span class="nc bnc" id="L1595" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2731)) {</span>
<span class="nc bnc" id="L1596" title="All 2 branches missed.">            if (mInNameEdit) {</span>
<span class="nc bnc" id="L1597" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2730)) {</span>
                    // header)
<span class="nc bnc" id="L1599" title="All 2 branches missed.">                    if (!mShowArrivals) {</span>
<span class="nc bnc" id="L1600" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2729)) {</span>
<span class="nc" id="L1601">                            setHeaderSize(HEADER_HEIGHT_EDIT_NAME_DP);</span>
                        }
                    }
                }
<span class="nc" id="L1605">                return;</span>
            }
        }
<span class="nc" id="L1608">        float newSize = 0;</span>
<span class="nc bnc" id="L1609" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2751)) {</span>
            // Change the header size based on arrival info and if a route filter is used
<span class="nc bnc" id="L1611" title="All 2 branches missed.">            if (!mShowArrivals) {</span>
<span class="nc bnc" id="L1612" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2750)) {</span>
                    // size
<span class="nc" id="L1614">                    newSize = HEADER_HEIGHT_NO_ARRIVALS_DP;</span>
                }
<span class="nc bnc" id="L1616" title="All 90 branches missed.">            } else if ((ListenerUtil.mutListener.listen(2742) ? ((ListenerUtil.mutListener.listen(2736) ? (mNumHeaderArrivals &gt;= 0) : (ListenerUtil.mutListener.listen(2735) ? (mNumHeaderArrivals &lt;= 0) : (ListenerUtil.mutListener.listen(2734) ? (mNumHeaderArrivals &gt; 0) : (ListenerUtil.mutListener.listen(2733) ? (mNumHeaderArrivals &lt; 0) : (ListenerUtil.mutListener.listen(2732) ? (mNumHeaderArrivals != 0) : (mNumHeaderArrivals == 0)))))) &amp;&amp; (ListenerUtil.mutListener.listen(2741) ? (mNumHeaderArrivals &gt;= 1) : (ListenerUtil.mutListener.listen(2740) ? (mNumHeaderArrivals &lt;= 1) : (ListenerUtil.mutListener.listen(2739) ? (mNumHeaderArrivals &gt; 1) : (ListenerUtil.mutListener.listen(2738) ? (mNumHeaderArrivals &lt; 1) : (ListenerUtil.mutListener.listen(2737) ? (mNumHeaderArrivals != 1) : (mNumHeaderArrivals == 1))))))) : ((ListenerUtil.mutListener.listen(2736) ? (mNumHeaderArrivals &gt;= 0) : (ListenerUtil.mutListener.listen(2735) ? (mNumHeaderArrivals &lt;= 0) : (ListenerUtil.mutListener.listen(2734) ? (mNumHeaderArrivals &gt; 0) : (ListenerUtil.mutListener.listen(2733) ? (mNumHeaderArrivals &lt; 0) : (ListenerUtil.mutListener.listen(2732) ? (mNumHeaderArrivals != 0) : (mNumHeaderArrivals == 0)))))) || (ListenerUtil.mutListener.listen(2741) ? (mNumHeaderArrivals &gt;= 1) : (ListenerUtil.mutListener.listen(2740) ? (mNumHeaderArrivals &lt;= 1) : (ListenerUtil.mutListener.listen(2739) ? (mNumHeaderArrivals &gt; 1) : (ListenerUtil.mutListener.listen(2738) ? (mNumHeaderArrivals &lt; 1) : (ListenerUtil.mutListener.listen(2737) ? (mNumHeaderArrivals != 1) : (mNumHeaderArrivals == 1))))))))) {</span>
<span class="nc bnc" id="L1617" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2749)) {</span>
<span class="nc" id="L1618">                    newSize = HEADER_HEIGHT_ONE_ARRIVAL_DP;</span>
                }
<span class="nc bnc" id="L1620" title="All 22 branches missed.">            } else if ((ListenerUtil.mutListener.listen(2747) ? (mNumHeaderArrivals &gt;= 2) : (ListenerUtil.mutListener.listen(2746) ? (mNumHeaderArrivals &lt;= 2) : (ListenerUtil.mutListener.listen(2745) ? (mNumHeaderArrivals &gt; 2) : (ListenerUtil.mutListener.listen(2744) ? (mNumHeaderArrivals &lt; 2) : (ListenerUtil.mutListener.listen(2743) ? (mNumHeaderArrivals != 2) : (mNumHeaderArrivals == 2))))))) {</span>
<span class="nc bnc" id="L1621" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2748)) {</span>
<span class="nc" id="L1622">                    newSize = HEADER_HEIGHT_TWO_ARRIVALS_DP;</span>
                }
            }
        }
<span class="nc bnc" id="L1626" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2753)) {</span>
            // If we're showing the route filter, than add the offset so this filter view has room
<span class="nc bnc" id="L1628" title="All 2 branches missed.">            if (isFilteringRoutes()) {</span>
<span class="nc bnc" id="L1629" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2752)) {</span>
<span class="nc" id="L1630">                    newSize += HEADER_OFFSET_FILTER_ROUTES_DP;</span>
                }
            }
        }
<span class="nc bnc" id="L1634" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2760)) {</span>
<span class="nc bnc" id="L1635" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(2758) ? (newSize &gt;= 0) : (ListenerUtil.mutListener.listen(2757) ? (newSize &lt;= 0) : (ListenerUtil.mutListener.listen(2756) ? (newSize &gt; 0) : (ListenerUtil.mutListener.listen(2755) ? (newSize &lt; 0) : (ListenerUtil.mutListener.listen(2754) ? (newSize == 0) : (newSize != 0))))))) {</span>
<span class="nc bnc" id="L1636" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2759)) {</span>
<span class="nc" id="L1637">                    setHeaderSize(newSize);</span>
                }
            }
        }
<span class="nc" id="L1641">    }</span>

    /**
     * Re-size the header layout to the provided size, in dp
     *
     * @param newHeightDp the new header layout height, in dp
     */
    void setHeaderSize(float newHeightDp) {
<span class="nc" id="L1649">        int heightPixels = UIUtils.dpToPixels(mContext, newHeightDp);</span>
<span class="nc bnc" id="L1650" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2764)) {</span>
<span class="nc bnc" id="L1651" title="All 2 branches missed.">            if (mSlidingPanelController != null) {</span>
<span class="nc bnc" id="L1652" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2763)) {</span>
<span class="nc" id="L1653">                    mSlidingPanelController.setPanelHeightPixels(heightPixels);</span>
                }
            } else {
<span class="nc bnc" id="L1656" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2761)) {</span>
                    // If we're in the ArrivalListActivity and not the sliding panel, resize the header here
<span class="nc" id="L1658">                    mView.getLayoutParams().height = heightPixels;</span>
                }
<span class="nc bnc" id="L1660" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2762)) {</span>
<span class="nc" id="L1661">                    mMainContainerView.getLayoutParams().height = heightPixels;</span>
                }
            }
        }
<span class="nc" id="L1665">    }</span>

    private static class ResponseError implements AlertList.Alert {

        private final CharSequence mString;

<span class="nc" id="L1671">        ResponseError(CharSequence seq) {</span>
<span class="nc" id="L1672">            mString = seq;</span>
<span class="nc" id="L1673">        }</span>

        @Override
        public String getId() {
<span class="nc" id="L1677">            return &quot;STATIC: RESPONSE ERROR&quot;;</span>
        }

        @Override
        public int getType() {
<span class="nc" id="L1682">            return TYPE_ERROR;</span>
        }

        @Override
        public int getFlags() {
<span class="nc" id="L1687">            return 0;</span>
        }

        @Override
        public CharSequence getString() {
<span class="nc" id="L1692">            return mString;</span>
        }

        @Override
        public void onClick() {
<span class="nc" id="L1697">        }</span>

        @Override
        public int hashCode() {
<span class="nc" id="L1701">            return getId().hashCode();</span>
        }

        @Override
        public boolean equals(Object obj) {
<span class="nc bnc" id="L1706" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2765)) {</span>
<span class="nc bnc" id="L1707" title="All 2 branches missed.">                if (this == obj) {</span>
<span class="nc" id="L1708">                    return true;</span>
                }
            }
<span class="nc bnc" id="L1711" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2766)) {</span>
<span class="nc bnc" id="L1712" title="All 2 branches missed.">                if (obj == null) {</span>
<span class="nc" id="L1713">                    return false;</span>
                }
            }
<span class="nc bnc" id="L1716" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2767)) {</span>
<span class="nc bnc" id="L1717" title="All 2 branches missed.">                if (getClass() != obj.getClass()) {</span>
<span class="nc" id="L1718">                    return false;</span>
                }
            }
<span class="nc" id="L1721">            ResponseError other = (ResponseError) obj;</span>
<span class="nc bnc" id="L1722" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2768)) {</span>
<span class="nc bnc" id="L1723" title="All 2 branches missed.">                if (!getId().equals(other.getId())) {</span>
<span class="nc" id="L1724">                    return false;</span>
                }
            }
<span class="nc" id="L1727">            return true;</span>
        }
    }

<span class="nc" id="L1731">    private ResponseError mResponseError = null;</span>

    private void refreshError() {
<span class="nc bnc" id="L1734" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2769)) {</span>
<span class="nc bnc" id="L1735" title="All 2 branches missed.">            if (mController == null) {</span>
<span class="nc" id="L1736">                return;</span>
            }
        }
<span class="nc" id="L1739">        final long now = System.currentTimeMillis();</span>
<span class="nc" id="L1740">        final long responseTime = mController.getLastGoodResponseTime();</span>
<span class="nc" id="L1741">        AlertList alerts = mController.getAlertList();</span>
<span class="nc bnc" id="L1742" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2770)) {</span>
<span class="nc" id="L1743">            mHasWarning = false;</span>
        }
<span class="nc bnc" id="L1745" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2771)) {</span>
<span class="nc" id="L1746">            mHasError = false;</span>
        }
<span class="nc bnc" id="L1748" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2773)) {</span>
<span class="nc bnc" id="L1749" title="All 2 branches missed.">            if (mResponseError != null) {</span>
<span class="nc bnc" id="L1750" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2772)) {</span>
<span class="nc" id="L1751">                    alerts.remove(mResponseError);</span>
                }
            }
        }
<span class="nc bnc" id="L1755" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2795)) {</span>
<span class="nc bnc" id="L1756" title="All 282 branches missed.">            if ((ListenerUtil.mutListener.listen(2792) ? ((ListenerUtil.mutListener.listen(2778) ? ((responseTime) &gt;= 0) : (ListenerUtil.mutListener.listen(2777) ? ((responseTime) &lt;= 0) : (ListenerUtil.mutListener.listen(2776) ? ((responseTime) &gt; 0) : (ListenerUtil.mutListener.listen(2775) ? ((responseTime) &lt; 0) : (ListenerUtil.mutListener.listen(2774) ? ((responseTime) == 0) : ((responseTime) != 0)))))) || ((ListenerUtil.mutListener.listen(2791) ? (((ListenerUtil.mutListener.listen(2782) ? (now % responseTime) : (ListenerUtil.mutListener.listen(2781) ? (now / responseTime) : (ListenerUtil.mutListener.listen(2780) ? (now * responseTime) : (ListenerUtil.mutListener.listen(2779) ? (now + responseTime) : (now - responseTime)))))) &lt;= (ListenerUtil.mutListener.listen(2786) ? (2 % DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2785) ? (2 / DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2784) ? (2 - DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2783) ? (2 + DateUtils.MINUTE_IN_MILLIS) : (2 * DateUtils.MINUTE_IN_MILLIS)))))) : (ListenerUtil.mutListener.listen(2790) ? (((ListenerUtil.mutListener.listen(2782) ? (now % responseTime) : (ListenerUtil.mutListener.listen(2781) ? (now / responseTime) : (ListenerUtil.mutListener.listen(2780) ? (now * responseTime) : (ListenerUtil.mutListener.listen(2779) ? (now + responseTime) : (now - responseTime)))))) &gt; (ListenerUtil.mutListener.listen(2786) ? (2 % DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2785) ? (2 / DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2784) ? (2 - DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2783) ? (2 + DateUtils.MINUTE_IN_MILLIS) : (2 * DateUtils.MINUTE_IN_MILLIS)))))) : (ListenerUtil.mutListener.listen(2789) ? (((ListenerUtil.mutListener.listen(2782) ? (now % responseTime) : (ListenerUtil.mutListener.listen(2781) ? (now / responseTime) : (ListenerUtil.mutListener.listen(2780) ? (now * responseTime) : (ListenerUtil.mutListener.listen(2779) ? (now + responseTime) : (now - responseTime)))))) &lt; (ListenerUtil.mutListener.listen(2786) ? (2 % DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2785) ? (2 / DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2784) ? (2 - DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2783) ? (2 + DateUtils.MINUTE_IN_MILLIS) : (2 * DateUtils.MINUTE_IN_MILLIS)))))) : (ListenerUtil.mutListener.listen(2788) ? (((ListenerUtil.mutListener.listen(2782) ? (now % responseTime) : (ListenerUtil.mutListener.listen(2781) ? (now / responseTime) : (ListenerUtil.mutListener.listen(2780) ? (now * responseTime) : (ListenerUtil.mutListener.listen(2779) ? (now + responseTime) : (now - responseTime)))))) != (ListenerUtil.mutListener.listen(2786) ? (2 % DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2785) ? (2 / DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2784) ? (2 - DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2783) ? (2 + DateUtils.MINUTE_IN_MILLIS) : (2 * DateUtils.MINUTE_IN_MILLIS)))))) : (ListenerUtil.mutListener.listen(2787) ? (((ListenerUtil.mutListener.listen(2782) ? (now % responseTime) : (ListenerUtil.mutListener.listen(2781) ? (now / responseTime) : (ListenerUtil.mutListener.listen(2780) ? (now * responseTime) : (ListenerUtil.mutListener.listen(2779) ? (now + responseTime) : (now - responseTime)))))) == (ListenerUtil.mutListener.listen(2786) ? (2 % DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2785) ? (2 / DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2784) ? (2 - DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2783) ? (2 + DateUtils.MINUTE_IN_MILLIS) : (2 * DateUtils.MINUTE_IN_MILLIS)))))) : (((ListenerUtil.mutListener.listen(2782) ? (now % responseTime) : (ListenerUtil.mutListener.listen(2781) ? (now / responseTime) : (ListenerUtil.mutListener.listen(2780) ? (now * responseTime) : (ListenerUtil.mutListener.listen(2779) ? (now + responseTime) : (now - responseTime)))))) &gt;= (ListenerUtil.mutListener.listen(2786) ? (2 % DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2785) ? (2 / DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2784) ? (2 - DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2783) ? (2 + DateUtils.MINUTE_IN_MILLIS) : (2 * DateUtils.MINUTE_IN_MILLIS))))))))))))) : ((ListenerUtil.mutListener.listen(2778) ? ((responseTime) &gt;= 0) : (ListenerUtil.mutListener.listen(2777) ? ((responseTime) &lt;= 0) : (ListenerUtil.mutListener.listen(2776) ? ((responseTime) &gt; 0) : (ListenerUtil.mutListener.listen(2775) ? ((responseTime) &lt; 0) : (ListenerUtil.mutListener.listen(2774) ? ((responseTime) == 0) : ((responseTime) != 0)))))) &amp;&amp; ((ListenerUtil.mutListener.listen(2791) ? (((ListenerUtil.mutListener.listen(2782) ? (now % responseTime) : (ListenerUtil.mutListener.listen(2781) ? (now / responseTime) : (ListenerUtil.mutListener.listen(2780) ? (now * responseTime) : (ListenerUtil.mutListener.listen(2779) ? (now + responseTime) : (now - responseTime)))))) &lt;= (ListenerUtil.mutListener.listen(2786) ? (2 % DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2785) ? (2 / DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2784) ? (2 - DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2783) ? (2 + DateUtils.MINUTE_IN_MILLIS) : (2 * DateUtils.MINUTE_IN_MILLIS)))))) : (ListenerUtil.mutListener.listen(2790) ? (((ListenerUtil.mutListener.listen(2782) ? (now % responseTime) : (ListenerUtil.mutListener.listen(2781) ? (now / responseTime) : (ListenerUtil.mutListener.listen(2780) ? (now * responseTime) : (ListenerUtil.mutListener.listen(2779) ? (now + responseTime) : (now - responseTime)))))) &gt; (ListenerUtil.mutListener.listen(2786) ? (2 % DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2785) ? (2 / DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2784) ? (2 - DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2783) ? (2 + DateUtils.MINUTE_IN_MILLIS) : (2 * DateUtils.MINUTE_IN_MILLIS)))))) : (ListenerUtil.mutListener.listen(2789) ? (((ListenerUtil.mutListener.listen(2782) ? (now % responseTime) : (ListenerUtil.mutListener.listen(2781) ? (now / responseTime) : (ListenerUtil.mutListener.listen(2780) ? (now * responseTime) : (ListenerUtil.mutListener.listen(2779) ? (now + responseTime) : (now - responseTime)))))) &lt; (ListenerUtil.mutListener.listen(2786) ? (2 % DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2785) ? (2 / DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2784) ? (2 - DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2783) ? (2 + DateUtils.MINUTE_IN_MILLIS) : (2 * DateUtils.MINUTE_IN_MILLIS)))))) : (ListenerUtil.mutListener.listen(2788) ? (((ListenerUtil.mutListener.listen(2782) ? (now % responseTime) : (ListenerUtil.mutListener.listen(2781) ? (now / responseTime) : (ListenerUtil.mutListener.listen(2780) ? (now * responseTime) : (ListenerUtil.mutListener.listen(2779) ? (now + responseTime) : (now - responseTime)))))) != (ListenerUtil.mutListener.listen(2786) ? (2 % DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2785) ? (2 / DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2784) ? (2 - DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2783) ? (2 + DateUtils.MINUTE_IN_MILLIS) : (2 * DateUtils.MINUTE_IN_MILLIS)))))) : (ListenerUtil.mutListener.listen(2787) ? (((ListenerUtil.mutListener.listen(2782) ? (now % responseTime) : (ListenerUtil.mutListener.listen(2781) ? (now / responseTime) : (ListenerUtil.mutListener.listen(2780) ? (now * responseTime) : (ListenerUtil.mutListener.listen(2779) ? (now + responseTime) : (now - responseTime)))))) == (ListenerUtil.mutListener.listen(2786) ? (2 % DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2785) ? (2 / DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2784) ? (2 - DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2783) ? (2 + DateUtils.MINUTE_IN_MILLIS) : (2 * DateUtils.MINUTE_IN_MILLIS)))))) : (((ListenerUtil.mutListener.listen(2782) ? (now % responseTime) : (ListenerUtil.mutListener.listen(2781) ? (now / responseTime) : (ListenerUtil.mutListener.listen(2780) ? (now * responseTime) : (ListenerUtil.mutListener.listen(2779) ? (now + responseTime) : (now - responseTime)))))) &gt;= (ListenerUtil.mutListener.listen(2786) ? (2 % DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2785) ? (2 / DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2784) ? (2 - DateUtils.MINUTE_IN_MILLIS) : (ListenerUtil.mutListener.listen(2783) ? (2 + DateUtils.MINUTE_IN_MILLIS) : (2 * DateUtils.MINUTE_IN_MILLIS))))))))))))))) {</span>
<span class="nc" id="L1757">                CharSequence relativeTime = DateUtils.getRelativeTimeSpanString(responseTime, now, DateUtils.MINUTE_IN_MILLIS, 0);</span>
<span class="nc" id="L1758">                CharSequence s = mContext.getString(R.string.stop_info_old_data, relativeTime);</span>
<span class="nc bnc" id="L1759" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2793)) {</span>
<span class="nc" id="L1760">                    mResponseError = new ResponseError(s);</span>
                }
<span class="nc bnc" id="L1762" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2794)) {</span>
<span class="nc" id="L1763">                    alerts.insert(mResponseError, 0);</span>
                }
            }
        }
<span class="nc bnc" id="L1767" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2805)) {</span>
            {
<span class="nc" id="L1769">                long _loopCounter28 = 0;</span>
<span class="nc bnc" id="L1770" title="All 22 branches missed.">                for (int i = 0; (ListenerUtil.mutListener.listen(2804) ? (i &gt;= alerts.getCount()) : (ListenerUtil.mutListener.listen(2803) ? (i &lt;= alerts.getCount()) : (ListenerUtil.mutListener.listen(2802) ? (i &gt; alerts.getCount()) : (ListenerUtil.mutListener.listen(2801) ? (i != alerts.getCount()) : (ListenerUtil.mutListener.listen(2800) ? (i == alerts.getCount()) : (i &lt; alerts.getCount())))))); i++) {</span>
<span class="nc" id="L1771">                    ListenerUtil.loopListener.listen(&quot;_loopCounter28&quot;, ++_loopCounter28);</span>
<span class="nc" id="L1772">                    AlertList.Alert a = alerts.getItem(i);</span>
<span class="nc bnc" id="L1773" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2797)) {</span>
<span class="nc bnc" id="L1774" title="All 2 branches missed.">                        if (a.getType() == AlertList.Alert.TYPE_WARNING) {</span>
<span class="nc bnc" id="L1775" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2796)) {</span>
<span class="nc" id="L1776">                                mHasWarning = true;</span>
                            }
                        }
                    }
<span class="nc bnc" id="L1780" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2799)) {</span>
<span class="nc bnc" id="L1781" title="All 2 branches missed.">                        if (a.getType() == AlertList.Alert.TYPE_ERROR) {</span>
<span class="nc bnc" id="L1782" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2798)) {</span>
<span class="nc" id="L1783">                                mHasError = true;</span>
                            }
                        }
                    }
                }
            }
        }
<span class="nc bnc" id="L1790" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2814)) {</span>
<span class="nc bnc" id="L1791" title="All 2 branches missed.">            if (mHasError) {</span>
<span class="nc bnc" id="L1792" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2811)) {</span>
                    // UIHelp.showViewWithAnimation(mAlertView, mShortAnimationDuration);
<span class="nc" id="L1794">                    mAlertView.setVisibility(View.VISIBLE);</span>
                }
<span class="nc bnc" id="L1796" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2812)) {</span>
<span class="nc" id="L1797">                    mAlertView.setColorFilter(mResources.getColor(R.color.alert_icon_error));</span>
                }
<span class="nc bnc" id="L1799" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2813)) {</span>
<span class="nc" id="L1800">                    mAlertView.setContentDescription(mResources.getString(R.string.alert_content_description_error));</span>
                }
<span class="nc bnc" id="L1802" title="All 2 branches missed.">            } else if (mHasWarning) {</span>
<span class="nc bnc" id="L1803" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2808)) {</span>
                    // UIHelp.showViewWithAnimation(mAlertView, mShortAnimationDuration);
<span class="nc" id="L1805">                    mAlertView.setVisibility(View.VISIBLE);</span>
                }
<span class="nc bnc" id="L1807" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2809)) {</span>
<span class="nc" id="L1808">                    mAlertView.setColorFilter(mResources.getColor(R.color.alert_icon_warning));</span>
                }
<span class="nc bnc" id="L1810" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2810)) {</span>
<span class="nc" id="L1811">                    mAlertView.setContentDescription(mResources.getString(R.string.alert_content_description_warning));</span>
                }
            } else {
<span class="nc bnc" id="L1814" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2806)) {</span>
                    // UIHelp.hideViewWithAnimation(mAlertView, mShortAnimationDuration);
<span class="nc" id="L1816">                    mAlertView.setVisibility(View.GONE);</span>
                }
<span class="nc bnc" id="L1818" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2807)) {</span>
<span class="nc" id="L1819">                    mAlertView.setContentDescription(&quot;&quot;);</span>
                }
            }
        }
<span class="nc" id="L1823">    }</span>

<span class="nc" id="L1825">    private ShowHiddenAlert mShowHiddenAlert = null;</span>

    private static class ShowHiddenAlert implements AlertList.Alert {

        private final CharSequence mString;

        private final Controller mController;

<span class="nc" id="L1833">        ShowHiddenAlert(CharSequence seq, Controller controller) {</span>
<span class="nc" id="L1834">            mString = seq;</span>
<span class="nc" id="L1835">            mController = controller;</span>
<span class="nc" id="L1836">        }</span>

        @Override
        public String getId() {
<span class="nc" id="L1840">            return &quot;STATIC: SHOW HIDDEN ALERT&quot;;</span>
        }

        @Override
        public int getType() {
<span class="nc" id="L1845">            return TYPE_SHOW_HIDDEN_ALERTS;</span>
        }

        @Override
        public int getFlags() {
<span class="nc" id="L1850">            return FLAG_HASMORE;</span>
        }

        @Override
        public CharSequence getString() {
<span class="nc" id="L1855">            return mString;</span>
        }

        @Override
        public void onClick() {
<span class="nc bnc" id="L1860" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2815)) {</span>
<span class="nc" id="L1861">                ObaContract.ServiceAlerts.showAllAlerts();</span>
            }
<span class="nc bnc" id="L1863" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2816)) {</span>
<span class="nc" id="L1864">                mController.refresh();</span>
            }
<span class="nc" id="L1866">        }</span>

        @Override
        public int hashCode() {
<span class="nc" id="L1870">            return getId().hashCode();</span>
        }

        @Override
        public boolean equals(Object obj) {
<span class="nc bnc" id="L1875" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2817)) {</span>
<span class="nc bnc" id="L1876" title="All 2 branches missed.">                if (this == obj) {</span>
<span class="nc" id="L1877">                    return true;</span>
                }
            }
<span class="nc bnc" id="L1880" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2818)) {</span>
<span class="nc bnc" id="L1881" title="All 2 branches missed.">                if (obj == null) {</span>
<span class="nc" id="L1882">                    return false;</span>
                }
            }
<span class="nc bnc" id="L1885" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2819)) {</span>
<span class="nc bnc" id="L1886" title="All 2 branches missed.">                if (getClass() != obj.getClass()) {</span>
<span class="nc" id="L1887">                    return false;</span>
                }
            }
<span class="nc" id="L1890">            ShowHiddenAlert other = (ShowHiddenAlert) obj;</span>
<span class="nc" id="L1891">            return getId().equals(other.getId());</span>
        }
    }

    private void refreshHiddenAlerts() {
<span class="nc bnc" id="L1896" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2820)) {</span>
<span class="nc bnc" id="L1897" title="All 2 branches missed.">            if (mController == null) {</span>
<span class="nc" id="L1898">                return;</span>
            }
        }
<span class="nc" id="L1901">        AlertList alerts = mController.getAlertList();</span>
<span class="nc bnc" id="L1902" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2821)) {</span>
<span class="nc" id="L1903">            mIsAlertHidden = alerts.isAlertHidden();</span>
        }
<span class="nc bnc" id="L1905" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2823)) {</span>
<span class="nc bnc" id="L1906" title="All 2 branches missed.">            if (mShowHiddenAlert != null) {</span>
<span class="nc bnc" id="L1907" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2822)) {</span>
<span class="nc" id="L1908">                    alerts.remove(mShowHiddenAlert);</span>
                }
            }
        }
<span class="nc bnc" id="L1912" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2826)) {</span>
<span class="nc bnc" id="L1913" title="All 2 branches missed.">            if (mIsAlertHidden) {</span>
<span class="nc" id="L1914">                CharSequence cs = mContext.getResources().getQuantityString(R.plurals.alert_filter_text, alerts.getHiddenAlertCount(), alerts.getHiddenAlertCount());</span>
<span class="nc bnc" id="L1915" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2824)) {</span>
<span class="nc" id="L1916">                    mShowHiddenAlert = new ShowHiddenAlert(cs, mController);</span>
                }
<span class="nc bnc" id="L1918" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2825)) {</span>
<span class="nc" id="L1919">                    alerts.insert(mShowHiddenAlert, alerts.getCount());</span>
                }
            }
        }
<span class="nc" id="L1923">    }</span>

    synchronized void beginNameEdit(String initial) {
<span class="nc bnc" id="L1926" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2827)) {</span>
            // editable, so we should go into edit mode.
<span class="nc bnc" id="L1928" title="All 2 branches missed.">            mEditNameView.setText((initial != null) ? initial : mNameView.getText());</span>
        }
<span class="nc bnc" id="L1930" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2828)) {</span>
<span class="nc" id="L1931">            mNameContainerView.setVisibility(View.GONE);</span>
        }
<span class="nc bnc" id="L1933" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2829)) {</span>
<span class="nc" id="L1934">            mFilterGroup.setVisibility(View.GONE);</span>
        }
<span class="nc bnc" id="L1936" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2830)) {</span>
<span class="nc" id="L1937">            mStopFavorite.setVisibility(View.GONE);</span>
        }
<span class="nc bnc" id="L1939" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2831)) {</span>
<span class="nc" id="L1940">            mEtaContainer1.setVisibility(View.GONE);</span>
        }
<span class="nc bnc" id="L1942" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2832)) {</span>
<span class="nc" id="L1943">            mEtaSeparator.setVisibility(View.GONE);</span>
        }
<span class="nc bnc" id="L1945" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2833)) {</span>
<span class="nc" id="L1946">            mEtaContainer2.setVisibility(View.GONE);</span>
        }
<span class="nc bnc" id="L1948" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2834)) {</span>
<span class="nc" id="L1949">            mNoArrivals.setVisibility(View.GONE);</span>
        }
<span class="nc bnc" id="L1951" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2835)) {</span>
<span class="nc" id="L1952">            mAlertView.setVisibility(View.GONE);</span>
        }
<span class="nc bnc" id="L1954" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2836)) {</span>
            // Save mExpandCollapse visibility state
<span class="nc" id="L1956">            cachedExpandCollapseViewVisibility = mExpandCollapse.getVisibility();</span>
        }
<span class="nc bnc" id="L1958" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2838)) {</span>
<span class="nc bnc" id="L1959" title="All 2 branches missed.">            if (!UIUtils.canAnimateViewModern()) {</span>
<span class="nc bnc" id="L1960" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2837)) {</span>
                    // View won't disappear without clearing the legacy rotation animation
<span class="nc" id="L1962">                    mExpandCollapse.clearAnimation();</span>
                }
            }
        }
<span class="nc bnc" id="L1966" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2839)) {</span>
<span class="nc" id="L1967">            mExpandCollapse.setVisibility(View.GONE);</span>
        }
<span class="nc bnc" id="L1969" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2840)) {</span>
<span class="nc" id="L1970">            mEditNameContainerView.setVisibility(View.VISIBLE);</span>
        }
<span class="nc bnc" id="L1972" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2842)) {</span>
            // header)
<span class="nc bnc" id="L1974" title="All 2 branches missed.">            if (!mShowArrivals) {</span>
<span class="nc bnc" id="L1975" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2841)) {</span>
<span class="nc" id="L1976">                    setHeaderSize(HEADER_HEIGHT_EDIT_NAME_DP);</span>
                }
            }
        }
<span class="nc bnc" id="L1980" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2843)) {</span>
<span class="nc" id="L1981">            mEditNameView.requestFocus();</span>
        }
<span class="nc bnc" id="L1983" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2844)) {</span>
<span class="nc" id="L1984">            mEditNameView.setSelection(mEditNameView.getText().length());</span>
        }
<span class="nc bnc" id="L1986" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2845)) {</span>
<span class="nc" id="L1987">            mInNameEdit = true;</span>
        }
<span class="nc bnc" id="L1989" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2846)) {</span>
            // Open soft keyboard if no physical keyboard is open
<span class="nc" id="L1991">            UIUtils.openKeyboard(mContext);</span>
        }
<span class="nc" id="L1993">    }</span>

    synchronized void endNameEdit() {
<span class="nc bnc" id="L1996" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2847)) {</span>
<span class="nc" id="L1997">            mInNameEdit = false;</span>
        }
<span class="nc bnc" id="L1999" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2848)) {</span>
<span class="nc" id="L2000">            mNameContainerView.setVisibility(View.VISIBLE);</span>
        }
<span class="nc bnc" id="L2002" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2849)) {</span>
<span class="nc" id="L2003">            mEditNameContainerView.setVisibility(View.GONE);</span>
        }
<span class="nc bnc" id="L2005" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2850)) {</span>
<span class="nc" id="L2006">            mStopFavorite.setVisibility(View.VISIBLE);</span>
        }
<span class="nc bnc" id="L2008" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2851)) {</span>
<span class="nc" id="L2009">            mExpandCollapse.setVisibility(cachedExpandCollapseViewVisibility);</span>
        }
<span class="nc bnc" id="L2011" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2852)) {</span>
<span class="nc" id="L2012">            mNoArrivals.setVisibility(View.VISIBLE);</span>
        }
<span class="nc bnc" id="L2014" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2855)) {</span>
<span class="nc bnc" id="L2015" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(2853) ? (mHasError &amp;&amp; mHasWarning) : (mHasError || mHasWarning))) {</span>
<span class="nc bnc" id="L2016" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2854)) {</span>
<span class="nc" id="L2017">                    mAlertView.setVisibility(View.VISIBLE);</span>
                }
            }
        }
<span class="nc bnc" id="L2021" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2856)) {</span>
            // Hide soft keyboard
<span class="nc" id="L2023">            UIUtils.closeKeyboard(mContext, mEditNameView);</span>
        }
<span class="nc bnc" id="L2025" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2857)) {</span>
<span class="nc" id="L2026">            refresh();</span>
        }
<span class="nc" id="L2028">    }</span>

    /**
     * Closes any open status popups displayed by the header
     */
    public void closeStatusPopups() {
<span class="nc bnc" id="L2034" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2859)) {</span>
<span class="nc bnc" id="L2035" title="All 2 branches missed.">            if (mPopup1 != null) {</span>
<span class="nc bnc" id="L2036" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2858)) {</span>
<span class="nc" id="L2037">                    mPopup1.dismiss();</span>
                }
            }
        }
<span class="nc bnc" id="L2041" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2861)) {</span>
<span class="nc bnc" id="L2042" title="All 2 branches missed.">            if (mPopup2 != null) {</span>
<span class="nc bnc" id="L2043" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2860)) {</span>
<span class="nc" id="L2044">                    mPopup2.dismiss();</span>
                }
            }
        }
<span class="nc" id="L2048">    }</span>

    public void showProgress(boolean visibility) {
<span class="nc bnc" id="L2051" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2862)) {</span>
<span class="nc bnc" id="L2052" title="All 2 branches missed.">            if (mProgressBar == null)</span>
<span class="nc" id="L2053">                return;</span>
        }
<span class="nc bnc" id="L2055" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2865)) {</span>
<span class="nc bnc" id="L2056" title="All 2 branches missed.">            if (visibility) {</span>
<span class="nc bnc" id="L2057" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2864)) {</span>
<span class="nc" id="L2058">                    mProgressBar.setVisibility(View.VISIBLE);</span>
                }
            } else {
<span class="nc bnc" id="L2061" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2863)) {</span>
<span class="nc" id="L2062">                    mProgressBar.setVisibility(View.GONE);</span>
                }
            }
        }
<span class="nc" id="L2066">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span>Generated by the Android Gradle plugin 8.2.0</div></body></html>