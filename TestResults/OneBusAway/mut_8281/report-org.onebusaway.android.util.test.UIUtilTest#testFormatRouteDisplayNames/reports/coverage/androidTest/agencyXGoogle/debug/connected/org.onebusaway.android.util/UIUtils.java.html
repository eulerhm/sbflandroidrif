<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>UIUtils.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">agencyXGoogleDebug</a> &gt; <a href="index.source.html" class="el_package">org.onebusaway.android.util</a> &gt; <span class="el_source">UIUtils.java</span></div><h1>UIUtils.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2010-2017 Paul Watts (paulcwatts@gmail.com),
 * University of South  Florida (sjbarbeau@gmail.com), Microsoft Corporation
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.onebusaway.android.util;

import android.animation.Animator;
import android.animation.AnimatorListenerAdapter;
import android.annotation.TargetApi;
import android.app.Activity;
import android.app.SearchManager;
import android.content.ActivityNotFoundException;
import android.content.ContentQueryMap;
import android.content.ContentResolver;
import android.content.ContentValues;
import android.content.Context;
import android.content.Intent;
import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;
import android.content.res.ColorStateList;
import android.content.res.Resources;
import android.database.Cursor;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Matrix;
import android.graphics.PorterDuff;
import android.graphics.Rect;
import android.graphics.drawable.Drawable;
import android.graphics.drawable.GradientDrawable;
import android.graphics.drawable.LayerDrawable;
import android.location.Location;
import android.media.ExifInterface;
import android.net.ConnectivityManager;
import android.net.NetworkInfo;
import android.net.Uri;
import android.os.Build;
import android.os.Bundle;
import android.os.Environment;
import android.os.SystemClock;
import android.provider.Settings;
import android.text.Spannable;
import android.text.TextUtils;
import android.text.format.DateUtils;
import android.text.method.LinkMovementMethod;
import android.text.style.ClickableSpan;
import android.util.Log;
import android.util.TypedValue;
import android.view.Menu;
import android.view.MenuItem;
import android.view.MotionEvent;
import android.view.View;
import android.view.ViewGroup;
import android.view.inputmethod.InputMethodManager;
import android.widget.CheckBox;
import android.widget.ImageView;
import android.widget.TextView;
import android.widget.Toast;
import androidx.annotation.DrawableRes;
import androidx.annotation.NonNull;
import androidx.appcompat.app.ActionBar;
import androidx.appcompat.app.AlertDialog;
import androidx.appcompat.app.AppCompatActivity;
import androidx.appcompat.app.AppCompatDelegate;
import androidx.appcompat.widget.SearchView;
import androidx.core.content.ContextCompat;
import androidx.core.content.pm.ShortcutInfoCompat;
import androidx.core.content.pm.ShortcutManagerCompat;
import androidx.core.content.res.ResourcesCompat;
import androidx.core.graphics.drawable.DrawableCompat;
import androidx.core.graphics.drawable.IconCompat;
import androidx.core.util.Pair;
import androidx.core.view.MenuItemCompat;
import androidx.core.widget.ImageViewCompat;
import androidx.fragment.app.Fragment;
import com.google.android.gms.common.GoogleApiAvailability;
import com.google.firebase.analytics.FirebaseAnalytics;
import org.onebusaway.android.R;
import org.onebusaway.android.app.Application;
import org.onebusaway.android.io.ObaAnalytics;
import org.onebusaway.android.io.ObaApi;
import org.onebusaway.android.io.elements.ObaArrivalInfo;
import org.onebusaway.android.io.elements.ObaRegion;
import org.onebusaway.android.io.elements.ObaRoute;
import org.onebusaway.android.io.elements.ObaSituation;
import org.onebusaway.android.io.elements.ObaStop;
import org.onebusaway.android.io.elements.Occupancy;
import org.onebusaway.android.io.elements.OccupancyState;
import org.onebusaway.android.io.request.ObaArrivalInfoResponse;
import org.onebusaway.android.map.MapParams;
import org.onebusaway.android.provider.ObaContract;
import org.onebusaway.android.ui.ArrivalsListActivity;
import org.onebusaway.android.ui.HomeActivity;
import org.onebusaway.android.ui.RouteInfoActivity;
import org.onebusaway.android.view.RealtimeIndicatorView;
import org.onebusaway.util.comparators.AlphanumComparator;
import java.io.File;
import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.Date;
import java.util.HashMap;
import java.util.HashSet;
import java.util.List;
import java.util.concurrent.TimeUnit;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

/**
 * A class containing utility methods related to the user interface
 */
<span class="nc" id="L126">public final class UIUtils {</span>

    private static final String TAG = &quot;UIHelp&quot;;

    public static void setupActionBar(AppCompatActivity activity) {
<span class="nc" id="L131">        ActionBar bar = activity.getSupportActionBar();</span>
<span class="nc bnc" id="L132" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6960)) {</span>
<span class="nc" id="L133">            bar.setIcon(android.R.color.transparent);</span>
        }
<span class="nc bnc" id="L135" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6961)) {</span>
<span class="nc" id="L136">            bar.setDisplayShowTitleEnabled(true);</span>
        }
<span class="nc bnc" id="L138" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6963)) {</span>
            // HomeActivity is the root for all other activities
<span class="nc bnc" id="L140" title="All 2 branches missed.">            if (!(activity instanceof HomeActivity)) {</span>
<span class="nc bnc" id="L141" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6962)) {</span>
<span class="nc" id="L142">                    bar.setDisplayHomeAsUpEnabled(true);</span>
                }
            }
        }
<span class="nc" id="L146">    }</span>

    /**
     * Sets up the search view in the action bar
     */
    public static void setupSearch(Activity activity, Menu menu) {
<span class="nc" id="L152">        SearchManager searchManager = (SearchManager) activity.getSystemService(Context.SEARCH_SERVICE);</span>
<span class="nc" id="L153">        final MenuItem searchMenu = menu.findItem(R.id.action_search);</span>
<span class="nc" id="L154">        SearchView searchView = (SearchView) MenuItemCompat.getActionView(searchMenu);</span>
<span class="nc bnc" id="L155" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6964)) {</span>
<span class="nc" id="L156">            searchView.setSearchableInfo(searchManager.getSearchableInfo(activity.getComponentName()));</span>
        }
<span class="nc bnc" id="L158" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6967)) {</span>
            // Close the keyboard and SearchView at same time when the back button is pressed
<span class="nc" id="L160">            searchView.setOnQueryTextFocusChangeListener(new View.OnFocusChangeListener() {</span>

                @Override
                public void onFocusChange(View view, boolean queryTextFocused) {
<span class="nc bnc" id="L164" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(6966)) {</span>
<span class="nc bnc" id="L165" title="All 2 branches missed.">                        if (!queryTextFocused) {</span>
<span class="nc bnc" id="L166" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(6965)) {</span>
<span class="nc" id="L167">                                MenuItemCompat.collapseActionView(searchMenu);</span>
                            }
                        }
                    }
<span class="nc" id="L171">                }</span>
            });
        }
<span class="nc" id="L174">    }</span>

    public static void showProgress(Fragment fragment, boolean visible) {
<span class="nc" id="L177">        AppCompatActivity act = (AppCompatActivity) fragment.getActivity();</span>
<span class="nc bnc" id="L178" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6969)) {</span>
<span class="nc bnc" id="L179" title="All 2 branches missed.">            if (act != null) {</span>
<span class="nc bnc" id="L180" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6968)) {</span>
<span class="nc" id="L181">                    act.setSupportProgressBarIndeterminateVisibility(visible);</span>
                }
            }
        }
<span class="nc" id="L185">    }</span>

    public static void setClickableSpan(TextView v, ClickableSpan span) {
<span class="nc" id="L188">        Spannable text = (Spannable) v.getText();</span>
<span class="nc bnc" id="L189" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6970)) {</span>
<span class="nc" id="L190">            text.setSpan(span, 0, text.length(), 0);</span>
        }
<span class="nc bnc" id="L192" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6971)) {</span>
<span class="nc" id="L193">            v.setMovementMethod(LinkMovementMethod.getInstance());</span>
        }
<span class="nc" id="L195">    }</span>

    public static void removeAllClickableSpans(TextView v) {
<span class="nc" id="L198">        Spannable text = (Spannable) v.getText();</span>
<span class="nc" id="L199">        ClickableSpan[] spans = text.getSpans(0, text.length(), ClickableSpan.class);</span>
<span class="nc bnc" id="L200" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6973)) {</span>
            {
<span class="nc" id="L202">                long _loopCounter77 = 0;</span>
<span class="nc bnc" id="L203" title="All 2 branches missed.">                for (ClickableSpan cs : spans) {</span>
<span class="nc" id="L204">                    ListenerUtil.loopListener.listen(&quot;_loopCounter77&quot;, ++_loopCounter77);</span>
<span class="nc bnc" id="L205" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(6972)) {</span>
<span class="nc" id="L206">                        text.removeSpan(cs);</span>
                    }
                }
            }
        }
<span class="nc" id="L211">    }</span>

    public static int getStopDirectionText(String direction) {
<span class="nc bnc" id="L214" title="All 2 branches missed.">        if (direction.equals(&quot;N&quot;)) {</span>
<span class="nc" id="L215">            return R.string.direction_n;</span>
<span class="nc bnc" id="L216" title="All 2 branches missed.">        } else if (direction.equals(&quot;NW&quot;)) {</span>
<span class="nc" id="L217">            return R.string.direction_nw;</span>
<span class="nc bnc" id="L218" title="All 2 branches missed.">        } else if (direction.equals(&quot;W&quot;)) {</span>
<span class="nc" id="L219">            return R.string.direction_w;</span>
<span class="nc bnc" id="L220" title="All 2 branches missed.">        } else if (direction.equals(&quot;SW&quot;)) {</span>
<span class="nc" id="L221">            return R.string.direction_sw;</span>
<span class="nc bnc" id="L222" title="All 2 branches missed.">        } else if (direction.equals(&quot;S&quot;)) {</span>
<span class="nc" id="L223">            return R.string.direction_s;</span>
<span class="nc bnc" id="L224" title="All 2 branches missed.">        } else if (direction.equals(&quot;SE&quot;)) {</span>
<span class="nc" id="L225">            return R.string.direction_se;</span>
<span class="nc bnc" id="L226" title="All 2 branches missed.">        } else if (direction.equals(&quot;E&quot;)) {</span>
<span class="nc" id="L227">            return R.string.direction_e;</span>
<span class="nc bnc" id="L228" title="All 2 branches missed.">        } else if (direction.equals(&quot;NE&quot;)) {</span>
<span class="nc" id="L229">            return R.string.direction_ne;</span>
        } else {
<span class="nc" id="L231">            return R.string.direction_none;</span>
        }
    }

    public static String getRouteDisplayName(String routeShortName, String routeLongName) {
<span class="nc bnc" id="L236" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6974)) {</span>
<span class="nc bnc" id="L237" title="All 2 branches missed.">            if (!TextUtils.isEmpty(routeShortName)) {</span>
<span class="nc" id="L238">                return routeShortName;</span>
            }
        }
<span class="nc bnc" id="L241" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6975)) {</span>
<span class="nc bnc" id="L242" title="All 2 branches missed.">            if (!TextUtils.isEmpty(routeLongName)) {</span>
<span class="nc" id="L243">                return routeLongName;</span>
            }
        }
        // Just so we never return null.
<span class="nc" id="L247">        return &quot;&quot;;</span>
    }

    public static String getRouteDisplayName(ObaRoute route) {
<span class="nc" id="L251">        return getRouteDisplayName(route.getShortName(), route.getLongName());</span>
    }

    public static String getRouteDisplayName(ObaArrivalInfo arrivalInfo) {
<span class="nc" id="L255">        return getRouteDisplayName(arrivalInfo.getShortName(), arrivalInfo.getRouteLongName());</span>
    }

    public static String getRouteDescription(ObaRoute route) {
<span class="nc" id="L259">        String shortName = route.getShortName();</span>
<span class="nc" id="L260">        String longName = route.getLongName();</span>
<span class="nc bnc" id="L261" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6977)) {</span>
<span class="nc bnc" id="L262" title="All 2 branches missed.">            if (TextUtils.isEmpty(shortName)) {</span>
<span class="nc bnc" id="L263" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6976)) {</span>
<span class="nc" id="L264">                    shortName = longName;</span>
                }
            }
        }
<span class="nc bnc" id="L268" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6980)) {</span>
<span class="nc bnc" id="L269" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(6978) ? (TextUtils.isEmpty(longName) &amp;&amp; shortName.equals(longName)) : (TextUtils.isEmpty(longName) || shortName.equals(longName)))) {</span>
<span class="nc bnc" id="L270" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6979)) {</span>
<span class="nc" id="L271">                    longName = route.getDescription();</span>
                }
            }
        }
<span class="nc" id="L275">        return UIUtils.formatDisplayText(longName);</span>
    }

    /**
     * Returns a formatted displayText for displaying in the UI for stops, routes, and headsigns, or
     * null if the displayText is null.  If the displayText IS ALL CAPS and more than one word and
     * does not contain SPLC (see #883), it will be converted to title case (Is All Caps), otherwise
     * the returned string will match the input.
     *
     * @param displayText displayText to be formatted
     * @return formatted text for stop, route, and heasigns for displaying in the UI, or null if the
     * displayText is null.  If the displayText IS ALL CAPS and more than one word and does not
     * contain SPLC (see #883), it will be converted to title case (Is All Caps), otherwise the
     * returned string will match the input.
     */
    public static String formatDisplayText(String displayText) {
<span class="nc bnc" id="L291" title="All 2 branches missed.">        if (displayText == null) {</span>
<span class="nc" id="L292">            return null;</span>
        }
        // See #883 for &quot;SPLC&quot; logic
<span class="nc bnc" id="L295" title="All 26 branches missed.">        if ((ListenerUtil.mutListener.listen(6982) ? ((ListenerUtil.mutListener.listen(6981) ? (MyTextUtils.isAllCaps(displayText) || displayText.contains(&quot; &quot;)) : (MyTextUtils.isAllCaps(displayText) &amp;&amp; displayText.contains(&quot; &quot;))) || !displayText.contains(&quot;SPLC&quot;)) : ((ListenerUtil.mutListener.listen(6981) ? (MyTextUtils.isAllCaps(displayText) || displayText.contains(&quot; &quot;)) : (MyTextUtils.isAllCaps(displayText) &amp;&amp; displayText.contains(&quot; &quot;))) &amp;&amp; !displayText.contains(&quot;SPLC&quot;)))) {</span>
<span class="nc" id="L296">            return MyTextUtils.toTitleCase(displayText);</span>
        } else {
<span class="nc" id="L298">            return displayText;</span>
        }
    }

    // available.
    public static void setStopDirection(View v, String direction, boolean show) {
<span class="nc" id="L304">        final TextView text = (TextView) v;</span>
<span class="nc" id="L305">        final int directionText = UIUtils.getStopDirectionText(direction);</span>
<span class="nc bnc" id="L306" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6987)) {</span>
<span class="nc bnc" id="L307" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(6983) ? ((directionText != R.string.direction_none) &amp;&amp; show) : ((directionText != R.string.direction_none) || show))) {</span>
<span class="nc bnc" id="L308" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6985)) {</span>
<span class="nc" id="L309">                    text.setText(directionText);</span>
                }
<span class="nc bnc" id="L311" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6986)) {</span>
<span class="nc" id="L312">                    text.setVisibility(View.VISIBLE);</span>
                }
            } else {
<span class="nc bnc" id="L315" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6984)) {</span>
<span class="nc" id="L316">                    text.setVisibility(View.GONE);</span>
                }
            }
        }
<span class="nc" id="L320">    }</span>

    // Common code to set a route list item view
    public static void setRouteView(View view, ObaRoute route) {
<span class="nc" id="L324">        TextView shortNameText = (TextView) view.findViewById(R.id.short_name);</span>
<span class="nc" id="L325">        TextView longNameText = (TextView) view.findViewById(R.id.long_name);</span>
<span class="nc" id="L326">        String shortName = route.getShortName();</span>
<span class="nc" id="L327">        String longName = UIUtils.formatDisplayText(route.getLongName());</span>
<span class="nc bnc" id="L328" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6989)) {</span>
<span class="nc bnc" id="L329" title="All 2 branches missed.">            if (TextUtils.isEmpty(shortName)) {</span>
<span class="nc bnc" id="L330" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6988)) {</span>
<span class="nc" id="L331">                    shortName = longName;</span>
                }
            }
        }
<span class="nc bnc" id="L335" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6992)) {</span>
<span class="nc bnc" id="L336" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(6990) ? (TextUtils.isEmpty(longName) &amp;&amp; shortName.equals(longName)) : (TextUtils.isEmpty(longName) || shortName.equals(longName)))) {</span>
<span class="nc bnc" id="L337" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(6991)) {</span>
<span class="nc" id="L338">                    longName = UIUtils.formatDisplayText(route.getDescription());</span>
                }
            }
        }
<span class="nc bnc" id="L342" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6993)) {</span>
<span class="nc" id="L343">            shortNameText.setText(shortName);</span>
        }
<span class="nc bnc" id="L345" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(6994)) {</span>
<span class="nc" id="L346">            longNameText.setText(longName);</span>
        }
<span class="nc" id="L348">    }</span>

<span class="fc" id="L350">    private static final String[] STOP_USER_PROJECTION = { ObaContract.Stops._ID, ObaContract.Stops.FAVORITE, ObaContract.Stops.USER_NAME };</span>

    public static class StopUserInfoMap {

        private final ContentQueryMap mMap;

<span class="nc" id="L356">        public StopUserInfoMap(Context context) {</span>
<span class="nc" id="L357">            ContentResolver cr = context.getContentResolver();</span>
<span class="nc" id="L358">            Cursor c = cr.query(ObaContract.Stops.CONTENT_URI, STOP_USER_PROJECTION, &quot;(&quot; + ObaContract.Stops.USER_NAME + &quot; IS NOT NULL)&quot; + &quot;OR (&quot; + ObaContract.Stops.FAVORITE + &quot;=1)&quot;, null, null);</span>
<span class="nc" id="L359">            mMap = new ContentQueryMap(c, ObaContract.Stops._ID, true, null);</span>
<span class="nc" id="L360">        }</span>

        public void close() {
<span class="nc bnc" id="L363" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(6995)) {</span>
<span class="nc" id="L364">                mMap.close();</span>
            }
<span class="nc" id="L366">        }</span>

        public void requery() {
<span class="nc bnc" id="L369" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(6996)) {</span>
<span class="nc" id="L370">                mMap.requery();</span>
            }
<span class="nc" id="L372">        }</span>

        public void setView(View stopRoot, String stopId, String stopName) {
<span class="nc" id="L375">            TextView nameView = (TextView) stopRoot.findViewById(R.id.stop_name);</span>
<span class="nc bnc" id="L376" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(6997)) {</span>
<span class="nc" id="L377">                setView2(nameView, stopId, stopName, true);</span>
            }
<span class="nc" id="L379">        }</span>

        /**
         * This should be used with compound drawables
         */
        public void setView2(TextView nameView, String stopId, String stopName, boolean showIcon) {
<span class="nc" id="L385">            ContentValues values = mMap.getValues(stopId);</span>
<span class="nc" id="L386">            int icon = 0;</span>
<span class="nc bnc" id="L387" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7008)) {</span>
<span class="nc bnc" id="L388" title="All 2 branches missed.">                if (values != null) {</span>
<span class="nc" id="L389">                    Integer i = values.getAsInteger(ObaContract.Stops.FAVORITE);</span>
<span class="nc bnc" id="L390" title="All 50 branches missed.">                    final boolean favorite = (ListenerUtil.mutListener.listen(7004) ? ((i != null) || ((ListenerUtil.mutListener.listen(7003) ? (i &gt;= 1) : (ListenerUtil.mutListener.listen(7002) ? (i &lt;= 1) : (ListenerUtil.mutListener.listen(7001) ? (i &gt; 1) : (ListenerUtil.mutListener.listen(7000) ? (i &lt; 1) : (ListenerUtil.mutListener.listen(6999) ? (i != 1) : (i == 1)))))))) : ((i != null) &amp;&amp; ((ListenerUtil.mutListener.listen(7003) ? (i &gt;= 1) : (ListenerUtil.mutListener.listen(7002) ? (i &lt;= 1) : (ListenerUtil.mutListener.listen(7001) ? (i &gt; 1) : (ListenerUtil.mutListener.listen(7000) ? (i &lt; 1) : (ListenerUtil.mutListener.listen(6999) ? (i != 1) : (i == 1)))))))));</span>
<span class="nc" id="L391">                    final String userName = values.getAsString(ObaContract.Stops.USER_NAME);</span>
<span class="nc bnc" id="L392" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7005)) {</span>
<span class="nc bnc" id="L393" title="All 2 branches missed.">                        nameView.setText(TextUtils.isEmpty(userName) ? UIUtils.formatDisplayText(stopName) : userName);</span>
                    }
<span class="nc bnc" id="L395" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7007)) {</span>
<span class="nc bnc" id="L396" title="All 10 branches missed.">                        icon = (ListenerUtil.mutListener.listen(7006) ? (favorite || showIcon) : (favorite &amp;&amp; showIcon)) ? R.drawable.ic_toggle_star : 0;</span>
                    }
<span class="nc" id="L398">                } else {</span>
<span class="nc bnc" id="L399" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(6998)) {</span>
<span class="nc" id="L400">                        nameView.setText(UIUtils.formatDisplayText(stopName));</span>
                    }
                }
            }
<span class="nc bnc" id="L404" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7009)) {</span>
<span class="nc" id="L405">                nameView.setCompoundDrawablesWithIntrinsicBounds(icon, 0, 0, 0);</span>
            }
<span class="nc" id="L407">        }</span>
    }

    /**
     * Returns a comma-delimited list of route display names that serve a stop
     * &lt;p/&gt;
     * For example, if a stop was served by &quot;14&quot; and &quot;54&quot;, this method will return &quot;14,54&quot;
     *
     * @param stop   the stop for which the route display names should be serialized
     * @param routes a HashMap containing all routes that serve this stop, with the routeId as the
     *               key.
     *               Note that for efficiency this routes HashMap may contain routes that don't
     *               serve this stop as well -
     *               the routes for the stop are referenced via stop.getRouteDisplayNames()
     * @return comma-delimited list of route display names that serve a stop
     */
    public static String serializeRouteDisplayNames(ObaStop stop, HashMap&lt;String, ObaRoute&gt; routes) {
<span class="nc" id="L424">        StringBuffer sb = new StringBuffer();</span>
<span class="nc" id="L425">        String[] routeIds = stop.getRouteIds();</span>
<span class="nc bnc" id="L426" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7029)) {</span>
            {
<span class="nc" id="L428">                long _loopCounter78 = 0;</span>
<span class="nc bnc" id="L429" title="All 22 branches missed.">                for (int i = 0; (ListenerUtil.mutListener.listen(7028) ? (i &gt;= routeIds.length) : (ListenerUtil.mutListener.listen(7027) ? (i &lt;= routeIds.length) : (ListenerUtil.mutListener.listen(7026) ? (i &gt; routeIds.length) : (ListenerUtil.mutListener.listen(7025) ? (i != routeIds.length) : (ListenerUtil.mutListener.listen(7024) ? (i == routeIds.length) : (i &lt; routeIds.length)))))); i++) {</span>
<span class="nc" id="L430">                    ListenerUtil.loopListener.listen(&quot;_loopCounter78&quot;, ++_loopCounter78);</span>
<span class="nc bnc" id="L431" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7012)) {</span>
<span class="nc bnc" id="L432" title="All 2 branches missed.">                        if (routes != null) {</span>
<span class="nc" id="L433">                            ObaRoute route = routes.get(routeIds[i]);</span>
<span class="nc bnc" id="L434" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7011)) {</span>
<span class="nc" id="L435">                                sb.append(getRouteDisplayName(route));</span>
                            }
<span class="nc" id="L437">                        } else {</span>
<span class="nc bnc" id="L438" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7010)) {</span>
                                // We don't have route mappings - use routeIds
<span class="nc" id="L440">                                sb.append(routeIds[i]);</span>
                            }
                        }
                    }
<span class="nc bnc" id="L444" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7023)) {</span>
<span class="nc bnc" id="L445" title="All 70 branches missed.">                        if ((ListenerUtil.mutListener.listen(7021) ? (i &gt;= (ListenerUtil.mutListener.listen(7016) ? (routeIds.length % 1) : (ListenerUtil.mutListener.listen(7015) ? (routeIds.length / 1) : (ListenerUtil.mutListener.listen(7014) ? (routeIds.length * 1) : (ListenerUtil.mutListener.listen(7013) ? (routeIds.length + 1) : (routeIds.length - 1)))))) : (ListenerUtil.mutListener.listen(7020) ? (i &lt;= (ListenerUtil.mutListener.listen(7016) ? (routeIds.length % 1) : (ListenerUtil.mutListener.listen(7015) ? (routeIds.length / 1) : (ListenerUtil.mutListener.listen(7014) ? (routeIds.length * 1) : (ListenerUtil.mutListener.listen(7013) ? (routeIds.length + 1) : (routeIds.length - 1)))))) : (ListenerUtil.mutListener.listen(7019) ? (i &gt; (ListenerUtil.mutListener.listen(7016) ? (routeIds.length % 1) : (ListenerUtil.mutListener.listen(7015) ? (routeIds.length / 1) : (ListenerUtil.mutListener.listen(7014) ? (routeIds.length * 1) : (ListenerUtil.mutListener.listen(7013) ? (routeIds.length + 1) : (routeIds.length - 1)))))) : (ListenerUtil.mutListener.listen(7018) ? (i &lt; (ListenerUtil.mutListener.listen(7016) ? (routeIds.length % 1) : (ListenerUtil.mutListener.listen(7015) ? (routeIds.length / 1) : (ListenerUtil.mutListener.listen(7014) ? (routeIds.length * 1) : (ListenerUtil.mutListener.listen(7013) ? (routeIds.length + 1) : (routeIds.length - 1)))))) : (ListenerUtil.mutListener.listen(7017) ? (i == (ListenerUtil.mutListener.listen(7016) ? (routeIds.length % 1) : (ListenerUtil.mutListener.listen(7015) ? (routeIds.length / 1) : (ListenerUtil.mutListener.listen(7014) ? (routeIds.length * 1) : (ListenerUtil.mutListener.listen(7013) ? (routeIds.length + 1) : (routeIds.length - 1)))))) : (i != (ListenerUtil.mutListener.listen(7016) ? (routeIds.length % 1) : (ListenerUtil.mutListener.listen(7015) ? (routeIds.length / 1) : (ListenerUtil.mutListener.listen(7014) ? (routeIds.length * 1) : (ListenerUtil.mutListener.listen(7013) ? (routeIds.length + 1) : (routeIds.length - 1)))))))))))) {</span>
<span class="nc bnc" id="L446" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7022)) {</span>
<span class="nc" id="L447">                                sb.append(&quot;,&quot;);</span>
                            }
                        }
                    }
                }
            }
        }
<span class="nc" id="L454">        return sb.toString();</span>
    }

    /**
     * Returns a list of route display names from a serialized list of route display names
     * &lt;p/&gt;
     * See {@link #serializeRouteDisplayNames(ObaStop, java.util.HashMap)}
     *
     * @param serializedRouteDisplayNames comma-separate list of routeIds from serializeRouteDisplayNames()
     * @return list of route display names
     */
    public static List&lt;String&gt; deserializeRouteDisplayNames(String serializedRouteDisplayNames) {
<span class="nc" id="L466">        String[] routes = serializedRouteDisplayNames.split(&quot;,&quot;);</span>
<span class="nc" id="L467">        return Arrays.asList(routes);</span>
    }

    /**
     * Returns a formatted and sorted list of route display names for presentation in a single line
     * &lt;p/&gt;
     * For example, the following list:
     * &lt;p/&gt;
     * 11,1,15, 8b
     * &lt;p/&gt;
     * ...would be formatted as:
     * &lt;p/&gt;
     * 4, 8b, 11, 15
     *
     * @param routeDisplayNames          list of route display names
     * @param nextArrivalRouteShortNames the short route names of the next X arrivals at the stop
     *                                   that are the same.  These will be highlighted in the
     *                                   results.
     * @return a formatted and sorted list of route display names for presentation in a single line
     */
    public static String formatRouteDisplayNames(List&lt;String&gt; routeDisplayNames, List&lt;String&gt; nextArrivalRouteShortNames) {
<span class="pc bpc" id="L488" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7030)) {</span>
<span class="fc" id="L489">            Collections.sort(routeDisplayNames, new AlphanumComparator());</span>
        }
<span class="fc" id="L491">        StringBuffer sb = new StringBuffer();</span>
<span class="pc bpc" id="L492" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7053)) {</span>
            {
<span class="fc" id="L494">                long _loopCounter80 = 0;</span>
<span class="pc bpc" id="L495" title="15 of 22 branches missed.">                for (int i = 0; (ListenerUtil.mutListener.listen(7052) ? (i &gt;= routeDisplayNames.size()) : (ListenerUtil.mutListener.listen(7051) ? (i &lt;= routeDisplayNames.size()) : (ListenerUtil.mutListener.listen(7050) ? (i &gt; routeDisplayNames.size()) : (ListenerUtil.mutListener.listen(7049) ? (i != routeDisplayNames.size()) : (ListenerUtil.mutListener.listen(7048) ? (i == routeDisplayNames.size()) : (i &lt; routeDisplayNames.size())))))); i++) {</span>
<span class="fc" id="L496">                    ListenerUtil.loopListener.listen(&quot;_loopCounter80&quot;, ++_loopCounter80);</span>
<span class="fc" id="L497">                    boolean match = false;</span>
<span class="pc bpc" id="L498" title="1 of 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7033)) {</span>
                        {
<span class="fc" id="L500">                            long _loopCounter79 = 0;</span>
<span class="fc bfc" id="L501" title="All 2 branches covered.">                            for (String nextArrivalRouteShortName : nextArrivalRouteShortNames) {</span>
<span class="fc" id="L502">                                ListenerUtil.loopListener.listen(&quot;_loopCounter79&quot;, ++_loopCounter79);</span>
<span class="pc bpc" id="L503" title="1 of 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(7032)) {</span>
<span class="fc bfc" id="L504" title="All 2 branches covered.">                                    if (routeDisplayNames.get(i).equalsIgnoreCase(nextArrivalRouteShortName)) {</span>
<span class="pc bpc" id="L505" title="1 of 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(7031)) {</span>
<span class="fc" id="L506">                                            match = true;</span>
                                        }
                                        break;
                                    }
                                }
<span class="fc" id="L511">                            }</span>
                        }
                    }
<span class="pc bpc" id="L514" title="1 of 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7036)) {</span>
<span class="fc bfc" id="L515" title="All 2 branches covered.">                        if (match) {</span>
<span class="pc bpc" id="L516" title="1 of 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7035)) {</span>
                                // If this route name matches a route name for the next X arrivals that are the same, highlight this route in the text
<span class="fc" id="L518">                                sb.append(routeDisplayNames.get(i) + &quot;*&quot;);</span>
                            }
                        } else {
<span class="pc bpc" id="L521" title="1 of 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7034)) {</span>
                                // Just append the normally-formatted route name
<span class="fc" id="L523">                                sb.append(routeDisplayNames.get(i));</span>
                            }
                        }
                    }
<span class="pc bpc" id="L527" title="1 of 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7047)) {</span>
<span class="pc bpc" id="L528" title="59 of 70 branches missed.">                        if ((ListenerUtil.mutListener.listen(7045) ? (i &gt;= (ListenerUtil.mutListener.listen(7040) ? (routeDisplayNames.size() % 1) : (ListenerUtil.mutListener.listen(7039) ? (routeDisplayNames.size() / 1) : (ListenerUtil.mutListener.listen(7038) ? (routeDisplayNames.size() * 1) : (ListenerUtil.mutListener.listen(7037) ? (routeDisplayNames.size() + 1) : (routeDisplayNames.size() - 1)))))) : (ListenerUtil.mutListener.listen(7044) ? (i &lt;= (ListenerUtil.mutListener.listen(7040) ? (routeDisplayNames.size() % 1) : (ListenerUtil.mutListener.listen(7039) ? (routeDisplayNames.size() / 1) : (ListenerUtil.mutListener.listen(7038) ? (routeDisplayNames.size() * 1) : (ListenerUtil.mutListener.listen(7037) ? (routeDisplayNames.size() + 1) : (routeDisplayNames.size() - 1)))))) : (ListenerUtil.mutListener.listen(7043) ? (i &gt; (ListenerUtil.mutListener.listen(7040) ? (routeDisplayNames.size() % 1) : (ListenerUtil.mutListener.listen(7039) ? (routeDisplayNames.size() / 1) : (ListenerUtil.mutListener.listen(7038) ? (routeDisplayNames.size() * 1) : (ListenerUtil.mutListener.listen(7037) ? (routeDisplayNames.size() + 1) : (routeDisplayNames.size() - 1)))))) : (ListenerUtil.mutListener.listen(7042) ? (i &lt; (ListenerUtil.mutListener.listen(7040) ? (routeDisplayNames.size() % 1) : (ListenerUtil.mutListener.listen(7039) ? (routeDisplayNames.size() / 1) : (ListenerUtil.mutListener.listen(7038) ? (routeDisplayNames.size() * 1) : (ListenerUtil.mutListener.listen(7037) ? (routeDisplayNames.size() + 1) : (routeDisplayNames.size() - 1)))))) : (ListenerUtil.mutListener.listen(7041) ? (i == (ListenerUtil.mutListener.listen(7040) ? (routeDisplayNames.size() % 1) : (ListenerUtil.mutListener.listen(7039) ? (routeDisplayNames.size() / 1) : (ListenerUtil.mutListener.listen(7038) ? (routeDisplayNames.size() * 1) : (ListenerUtil.mutListener.listen(7037) ? (routeDisplayNames.size() + 1) : (routeDisplayNames.size() - 1)))))) : (i != (ListenerUtil.mutListener.listen(7040) ? (routeDisplayNames.size() % 1) : (ListenerUtil.mutListener.listen(7039) ? (routeDisplayNames.size() / 1) : (ListenerUtil.mutListener.listen(7038) ? (routeDisplayNames.size() * 1) : (ListenerUtil.mutListener.listen(7037) ? (routeDisplayNames.size() + 1) : (routeDisplayNames.size() - 1)))))))))))) {</span>
<span class="pc bpc" id="L529" title="1 of 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7046)) {</span>
<span class="fc" id="L530">                                sb.append(&quot;, &quot;);</span>
                            }
                        }
                    }
                }
            }
        }
<span class="fc" id="L537">        return sb.toString();</span>
    }

    /**
     * Generates the dialog text that is used to show detailed information about a particular stop
     *
     * @return a pair of Strings consisting of the &lt;dialog title, dialog message&gt;
     */
    public static Pair&lt;String, String&gt; createStopDetailsDialogText(Context context, String stopName, String stopUserName, String stopCode, String stopDirection, List&lt;String&gt; routeDisplayNames) {
<span class="nc" id="L546">        final String newLine = &quot;\n&quot;;</span>
<span class="nc" id="L547">        String title = &quot;&quot;;</span>
<span class="nc" id="L548">        StringBuilder message = new StringBuilder();</span>
<span class="nc bnc" id="L549" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7058)) {</span>
<span class="nc bnc" id="L550" title="All 2 branches missed.">            if (!TextUtils.isEmpty(stopUserName)) {</span>
<span class="nc bnc" id="L551" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7055)) {</span>
<span class="nc" id="L552">                    title = stopUserName;</span>
                }
<span class="nc bnc" id="L554" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7057)) {</span>
<span class="nc bnc" id="L555" title="All 2 branches missed.">                    if (stopName != null) {</span>
<span class="nc bnc" id="L556" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7056)) {</span>
                            // Show official stop name in addition to user name
<span class="nc" id="L558">                            message.append(context.getString(R.string.stop_info_official_stop_name_label, stopName)).append(newLine);</span>
                        }
                    }
                }
<span class="nc bnc" id="L562" title="All 2 branches missed.">            } else if (stopName != null) {</span>
<span class="nc bnc" id="L563" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7054)) {</span>
<span class="nc" id="L564">                    title = stopName;</span>
                }
            }
        }
<span class="nc bnc" id="L568" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7060)) {</span>
<span class="nc bnc" id="L569" title="All 2 branches missed.">            if (stopCode != null) {</span>
<span class="nc bnc" id="L570" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7059)) {</span>
<span class="nc" id="L571">                    message.append(context.getString(R.string.stop_details_code, stopCode) + newLine);</span>
                }
            }
        }
<span class="nc bnc" id="L575" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7062)) {</span>
            // Routes that serve this stop
<span class="nc bnc" id="L577" title="All 2 branches missed.">            if (routeDisplayNames != null) {</span>
<span class="nc" id="L578">                String routes = context.getString(R.string.stop_info_route_ids_label) + &quot; &quot; + UIUtils.formatRouteDisplayNames(routeDisplayNames, new ArrayList&lt;String&gt;());</span>
<span class="nc bnc" id="L579" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7061)) {</span>
<span class="nc" id="L580">                    message.append(routes);</span>
                }
            }
        }
<span class="nc bnc" id="L584" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7064)) {</span>
<span class="nc bnc" id="L585" title="All 2 branches missed.">            if (!TextUtils.isEmpty(stopDirection)) {</span>
<span class="nc bnc" id="L586" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7063)) {</span>
<span class="nc" id="L587">                    message.append(newLine).append(context.getString(UIUtils.getStopDirectionText(stopDirection)));</span>
                }
            }
        }
<span class="nc" id="L591">        return new Pair(title, message.toString());</span>
    }

    /**
     * Builds an AlertDialog with the given title and message
     *
     * @return an AlertDialog with the given title and message
     */
    public static AlertDialog buildAlertDialog(Context context, String title, String message) {
<span class="nc" id="L600">        AlertDialog.Builder builder = new AlertDialog.Builder(context);</span>
<span class="nc bnc" id="L601" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7065)) {</span>
<span class="nc" id="L602">            builder.setTitle(title);</span>
        }
<span class="nc bnc" id="L604" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7066)) {</span>
<span class="nc" id="L605">            builder.setMessage(message);</span>
        }
<span class="nc" id="L607">        return builder.create();</span>
    }

    /**
     * Creates a new shortcut for the provided stop, and returns the ShortcutInfo for that shortcut
     * @param context Context used to create the shortcut
     * @param shortcutName the shortcutName for the stop shortcut
     * @param builder Instance of ArrivalsListActivity.Builder for the provided stop
     * @return the ShortcutInfo for the created shortcut
     */
    public static ShortcutInfoCompat createStopShortcut(Context context, String shortcutName, ArrivalsListActivity.Builder builder) {
<span class="nc" id="L618">        final ShortcutInfoCompat shortcut = UIUtils.makeShortcutInfo(context, shortcutName, builder.getIntent(), R.drawable.ic_stop_flag_triangle);</span>
<span class="nc bnc" id="L619" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7067)) {</span>
<span class="nc" id="L620">            ShortcutManagerCompat.requestPinShortcut(context, shortcut, null);</span>
        }
<span class="nc" id="L622">        return shortcut;</span>
    }

    /**
     * Creates a new shortcut for the provided route, and returns the ShortcutInfo for that shortcut
     * @param context Context used to create the shortcut
     * @param routeId ID of the route
     * @param routeName short name of the route
     * @return the ShortcutInfo for the created shortcut
     */
    public static ShortcutInfoCompat createRouteShortcut(Context context, String routeId, String routeName) {
<span class="nc" id="L633">        final ShortcutInfoCompat shortcut = UIUtils.makeShortcutInfo(context, routeName, RouteInfoActivity.makeIntent(context, routeId), R.drawable.ic_trip_details);</span>
<span class="nc bnc" id="L634" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7068)) {</span>
<span class="nc" id="L635">            ShortcutManagerCompat.requestPinShortcut(context, shortcut, null);</span>
        }
<span class="nc" id="L637">        return shortcut;</span>
    }

    /**
     * Default implementation for making a ShortcutInfoCompat object.  Note that this method doesn't
     * create the actual shortcut on the launcher - ShortcutManagerCompat.requestPinShortcut() must
     * be called with the ShortcutInfoCompat returned from this method to create the shortcut
     * on the launcher.
     *
     * @param name       The name of the shortcut
     * @param destIntent The destination intent
     * @param icon       Resource ID for the shortcut icon - should be black so it can be tinted and
     *                   60dp (2dp of asset padding) for high resolution on launcher screens
     * @return ShortcutInfoCompat that can be used to request pinning the shortcut
     */
    public static ShortcutInfoCompat makeShortcutInfo(Context context, String name, Intent destIntent, @DrawableRes int icon) {
<span class="nc bnc" id="L653" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7069)) {</span>
            // Make sure the shortcut Activity always launches on top (#626)
<span class="nc" id="L655">            destIntent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);</span>
        }
<span class="nc bnc" id="L657" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7070)) {</span>
<span class="nc" id="L658">            destIntent.setAction(Intent.ACTION_VIEW);</span>
        }
<span class="nc" id="L660">        Drawable drawableIcon = ResourcesCompat.getDrawable(context.getResources(), icon, context.getTheme());</span>
<span class="nc bnc" id="L661" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7071)) {</span>
<span class="nc" id="L662">            drawableIcon.setColorFilter(ContextCompat.getColor(context, R.color.shortcut_icon), PorterDuff.Mode.SRC_IN);</span>
        }
<span class="nc" id="L664">        Drawable drawableBackground = ResourcesCompat.getDrawable(context.getResources(), R.drawable.launcher_background, context.getTheme());</span>
<span class="nc" id="L665">        final LayerDrawable layerDrawable = new LayerDrawable(new Drawable[] { drawableBackground, drawableIcon });</span>
<span class="nc" id="L666">        int backgroundInset = UIUtils.dpToPixels(context, 2.0f);</span>
<span class="nc bnc" id="L667" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7072)) {</span>
<span class="nc" id="L668">            layerDrawable.setLayerInset(0, backgroundInset, backgroundInset, backgroundInset, backgroundInset);</span>
        }
<span class="nc" id="L670">        int iconInset = UIUtils.dpToPixels(context, 7.0f);</span>
<span class="nc bnc" id="L671" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7073)) {</span>
<span class="nc" id="L672">            layerDrawable.setLayerInset(1, iconInset, iconInset, iconInset, iconInset);</span>
        }
<span class="nc" id="L674">        final Bitmap b = Bitmap.createBitmap(layerDrawable.getIntrinsicWidth(), layerDrawable.getIntrinsicHeight(), Bitmap.Config.ARGB_8888);</span>
<span class="nc" id="L675">        final Canvas canvas = new Canvas(b);</span>
<span class="nc bnc" id="L676" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7074)) {</span>
<span class="nc" id="L677">            layerDrawable.setBounds(0, 0, canvas.getWidth(), canvas.getHeight());</span>
        }
<span class="nc bnc" id="L679" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7075)) {</span>
<span class="nc" id="L680">            layerDrawable.draw(canvas);</span>
        }
<span class="nc" id="L682">        return new ShortcutInfoCompat.Builder(context, name).setShortLabel(name).setIcon(IconCompat.createWithBitmap(b)).setIntent(destIntent).build();</span>
    }

    public static void goToUrl(Context context, String url) {
<span class="nc" id="L686">        Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));</span>
        try {
<span class="nc bnc" id="L688" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7077)) {</span>
<span class="nc" id="L689">                context.startActivity(intent);</span>
            }
<span class="nc" id="L691">        } catch (ActivityNotFoundException e) {</span>
<span class="nc bnc" id="L692" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7076)) {</span>
<span class="nc" id="L693">                Toast.makeText(context, context.getString(R.string.browser_error), Toast.LENGTH_SHORT).show();</span>
            }
<span class="nc" id="L695">        }</span>
<span class="nc" id="L696">    }</span>

    public static void goToPhoneDialer(Context context, String url) {
<span class="nc" id="L699">        Intent intent = new Intent(Intent.ACTION_DIAL);</span>
<span class="nc bnc" id="L700" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7078)) {</span>
<span class="nc" id="L701">            intent.setData(Uri.parse(url));</span>
        }
<span class="nc bnc" id="L703" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7079)) {</span>
<span class="nc" id="L704">            context.startActivity(intent);</span>
        }
<span class="nc" id="L706">    }</span>

    /**
     * Opens email apps based on the given email address
     * @param email address
     * @param location string that shows the current location
     */
    public static void sendEmail(Context context, String email, String location) {
<span class="nc bnc" id="L714" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7080)) {</span>
<span class="nc" id="L715">            sendEmail(context, email, location, null, false);</span>
        }
<span class="nc" id="L717">    }</span>

    /**
     * Opens email apps based on the given email address
     * @param email address
     * @param location string that shows the current location
     * @param tripPlanUrl trip planning URL that failed, if this is a trip problem error report, or null if it's not
     */
    public static void sendEmail(Context context, String email, String location, String tripPlanUrl, boolean tripPlanFail) {
<span class="nc" id="L726">        String obaRegionName = RegionUtils.getObaRegionName();</span>
<span class="nc" id="L727">        boolean autoRegion = Application.getPrefs().getBoolean(context.getString(R.string.preference_key_auto_select_region), true);</span>
        String regionSelectionMethod;
<span class="nc bnc" id="L729" title="All 2 branches missed.">        if (autoRegion) {</span>
<span class="nc" id="L730">            regionSelectionMethod = context.getString(R.string.region_selected_auto);</span>
        } else {
<span class="nc" id="L732">            regionSelectionMethod = context.getString(R.string.region_selected_manually);</span>
        }
<span class="nc bnc" id="L734" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7081)) {</span>
<span class="nc" id="L735">            UIUtils.sendEmail(context, email, location, obaRegionName, regionSelectionMethod, tripPlanUrl, tripPlanFail);</span>
        }
<span class="nc" id="L737">    }</span>

    /**
     * Opens email apps based on the given email address
     * @param email address
     * @param location string that shows the current location
     * @param regionName name of the current api region
     * @param regionSelectionMethod string that shows if the current api region selected manually or
     *                              automatically
     * @param tripPlanUrl trip planning URL that failed, if this is a trip problem error report, or null if it's not
     */
    private static void sendEmail(Context context, String email, String location, String regionName, String regionSelectionMethod, String tripPlanUrl, boolean tripPlanFail) {
<span class="nc" id="L749">        PackageManager pm = context.getPackageManager();</span>
        PackageInfo appInfoOba;
        PackageInfo appInfoGps;
<span class="nc" id="L752">        String obaVersion = &quot;&quot;;</span>
<span class="nc" id="L753">        String googlePlayServicesAppVersion = &quot;&quot;;</span>
        try {
<span class="nc" id="L755">            appInfoOba = pm.getPackageInfo(context.getPackageName(), PackageManager.GET_META_DATA);</span>
<span class="nc bnc" id="L756" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7082)) {</span>
<span class="nc" id="L757">                obaVersion = appInfoOba.versionName;</span>
            }
<span class="nc" id="L759">        } catch (PackageManager.NameNotFoundException e) {</span>
<span class="nc" id="L760">        }</span>
        try {
<span class="nc" id="L762">            appInfoGps = pm.getPackageInfo(GoogleApiAvailability.GOOGLE_PLAY_SERVICES_PACKAGE, 0);</span>
<span class="nc bnc" id="L763" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7083)) {</span>
<span class="nc" id="L764">                googlePlayServicesAppVersion = appInfoGps.versionName;</span>
            }
<span class="nc" id="L766">        } catch (PackageManager.NameNotFoundException e) {</span>
<span class="nc" id="L767">        }</span>
        String body;
<span class="nc bnc" id="L769" title="All 2 branches missed.">        if (location != null) {</span>
            // Have location
<span class="nc bnc" id="L771" title="All 2 branches missed.">            if (tripPlanUrl == null) {</span>
                // No trip plan
<span class="nc" id="L773">                body = context.getString(R.string.bug_report_body, obaVersion, Build.MODEL, Build.VERSION.RELEASE, Build.VERSION.SDK_INT, googlePlayServicesAppVersion, GoogleApiAvailability.GOOGLE_PLAY_SERVICES_VERSION_CODE, regionName, regionSelectionMethod, location);</span>
            } else {
                // Trip plan
<span class="nc bnc" id="L776" title="All 2 branches missed.">                if (tripPlanFail) {</span>
<span class="nc" id="L777">                    body = context.getString(R.string.bug_report_body_trip_plan_fail, obaVersion, Build.MODEL, Build.VERSION.RELEASE, Build.VERSION.SDK_INT, googlePlayServicesAppVersion, GoogleApiAvailability.GOOGLE_PLAY_SERVICES_VERSION_CODE, regionName, regionSelectionMethod, location, tripPlanUrl);</span>
                } else {
<span class="nc" id="L779">                    body = context.getString(R.string.bug_report_body_trip_plan, obaVersion, Build.MODEL, Build.VERSION.RELEASE, Build.VERSION.SDK_INT, googlePlayServicesAppVersion, GoogleApiAvailability.GOOGLE_PLAY_SERVICES_VERSION_CODE, regionName, regionSelectionMethod, location, tripPlanUrl);</span>
                }
            }
        } else {
            // No location
<span class="nc bnc" id="L784" title="All 2 branches missed.">            if (tripPlanUrl == null) {</span>
                // No trip plan
<span class="nc" id="L786">                body = context.getString(R.string.bug_report_body_without_location, obaVersion, Build.MODEL, Build.VERSION.RELEASE, Build.VERSION.SDK_INT);</span>
            } else {
                // Trip plan
<span class="nc bnc" id="L789" title="All 2 branches missed.">                if (tripPlanFail) {</span>
<span class="nc" id="L790">                    body = context.getString(R.string.bug_report_body_trip_plan_without_location_fail, obaVersion, Build.MODEL, Build.VERSION.RELEASE, Build.VERSION.SDK_INT, tripPlanUrl);</span>
                } else {
<span class="nc" id="L792">                    body = context.getString(R.string.bug_report_body_trip_plan_without_location, obaVersion, Build.MODEL, Build.VERSION.RELEASE, Build.VERSION.SDK_INT, tripPlanUrl);</span>
                }
            }
        }
<span class="nc" id="L796">        Intent send = new Intent(Intent.ACTION_SEND);</span>
<span class="nc bnc" id="L797" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7084)) {</span>
<span class="nc" id="L798">            send.putExtra(Intent.EXTRA_EMAIL, new String[] { email });</span>
        }
        // Show trip planner subject line if we have a trip planning URL
        String subject;
<span class="nc bnc" id="L802" title="All 2 branches missed.">        if (tripPlanUrl == null) {</span>
<span class="nc bnc" id="L803" title="All 2 branches missed.">            if (tripPlanFail) {</span>
<span class="nc" id="L804">                subject = context.getString(R.string.bug_report_subject_trip_plan);</span>
            } else {
<span class="nc" id="L806">                subject = context.getString(R.string.bug_report_subject);</span>
            }
        } else {
<span class="nc bnc" id="L809" title="All 2 branches missed.">            if (tripPlanFail) {</span>
<span class="nc" id="L810">                subject = context.getString(R.string.bug_report_subject_trip_plan_fail);</span>
            } else {
<span class="nc" id="L812">                subject = context.getString(R.string.bug_report_subject_trip_plan);</span>
            }
        }
<span class="nc bnc" id="L815" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7085)) {</span>
<span class="nc" id="L816">            send.putExtra(Intent.EXTRA_SUBJECT, subject);</span>
        }
<span class="nc bnc" id="L818" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7086)) {</span>
<span class="nc" id="L819">            send.putExtra(Intent.EXTRA_TEXT, body);</span>
        }
<span class="nc bnc" id="L821" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7087)) {</span>
<span class="nc" id="L822">            send.setType(&quot;message/rfc822&quot;);</span>
        }
        try {
<span class="nc bnc" id="L825" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7089)) {</span>
<span class="nc" id="L826">                context.startActivity(Intent.createChooser(send, subject));</span>
            }
<span class="nc" id="L828">        } catch (ActivityNotFoundException e) {</span>
<span class="nc bnc" id="L829" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7088)) {</span>
<span class="nc" id="L830">                Toast.makeText(context, R.string.bug_report_error, Toast.LENGTH_LONG).show();</span>
            }
<span class="nc" id="L832">        }</span>
<span class="nc" id="L833">    }</span>

    public static String getRouteErrorString(Context context, int code) {
<span class="nc bnc" id="L836" title="All 2 branches missed.">        if (!isConnected(context)) {</span>
<span class="nc bnc" id="L837" title="All 2 branches missed.">            if (isAirplaneMode(context)) {</span>
<span class="nc" id="L838">                return context.getString(R.string.airplane_mode_error);</span>
            } else {
<span class="nc" id="L840">                return context.getString(R.string.no_network_error);</span>
            }
        }
<span class="nc bnc" id="L843" title="All 5 branches missed.">        switch(code) {</span>
            case ObaApi.OBA_INTERNAL_ERROR:
<span class="nc" id="L845">                return context.getString(R.string.internal_error);</span>
            case ObaApi.OBA_NOT_FOUND:
<span class="nc" id="L847">                ObaRegion r = Application.get().getCurrentRegion();</span>
<span class="nc bnc" id="L848" title="All 2 branches missed.">                if (r != null) {</span>
<span class="nc" id="L849">                    return context.getString(R.string.route_not_found_error_with_region_name, r.getName());</span>
                } else {
<span class="nc" id="L851">                    return context.getString(R.string.route_not_found_error_no_region);</span>
                }
            case ObaApi.OBA_BAD_GATEWAY:
<span class="nc" id="L854">                return context.getString(R.string.bad_gateway_error);</span>
            case ObaApi.OBA_OUT_OF_MEMORY:
<span class="nc" id="L856">                return context.getString(R.string.out_of_memory_error);</span>
            default:
<span class="nc" id="L858">                return context.getString(R.string.generic_comm_error);</span>
        }
    }

    public static String getStopErrorString(Context context, int code) {
<span class="nc bnc" id="L863" title="All 2 branches missed.">        if (!isConnected(context)) {</span>
<span class="nc bnc" id="L864" title="All 2 branches missed.">            if (isAirplaneMode(context)) {</span>
<span class="nc" id="L865">                return context.getString(R.string.airplane_mode_error);</span>
            } else {
<span class="nc" id="L867">                return context.getString(R.string.no_network_error);</span>
            }
        }
<span class="nc bnc" id="L870" title="All 5 branches missed.">        switch(code) {</span>
            case ObaApi.OBA_INTERNAL_ERROR:
<span class="nc" id="L872">                return context.getString(R.string.internal_error);</span>
            case ObaApi.OBA_NOT_FOUND:
<span class="nc" id="L874">                ObaRegion r = Application.get().getCurrentRegion();</span>
<span class="nc bnc" id="L875" title="All 2 branches missed.">                if (r != null) {</span>
<span class="nc" id="L876">                    return context.getString(R.string.stop_not_found_error_with_region_name, r.getName());</span>
                } else {
<span class="nc" id="L878">                    return context.getString(R.string.stop_not_found_error_no_region);</span>
                }
            case ObaApi.OBA_BAD_GATEWAY:
<span class="nc" id="L881">                return context.getString(R.string.bad_gateway_error);</span>
            case ObaApi.OBA_OUT_OF_MEMORY:
<span class="nc" id="L883">                return context.getString(R.string.out_of_memory_error);</span>
            default:
<span class="nc" id="L885">                return context.getString(R.string.generic_comm_error);</span>
        }
    }

    /**
     * Returns the resource ID for a user-friendly error message based on device state (if a
     * network
     * connection is available or airplane mode is on) or an OBA REST API response code
     *
     * @param code The status code (one of the ObaApi.OBA_* constants)
     * @return the resource ID for a user-friendly error message based on device state (if a network
     * connection is available or airplane mode is on) or an OBA REST API response code
     */
    public static int getMapErrorString(Context context, int code) {
<span class="nc bnc" id="L899" title="All 2 branches missed.">        if (!isConnected(context)) {</span>
<span class="nc bnc" id="L900" title="All 2 branches missed.">            if (isAirplaneMode(context)) {</span>
<span class="nc" id="L901">                return R.string.airplane_mode_error;</span>
            } else {
<span class="nc" id="L903">                return R.string.no_network_error;</span>
            }
        }
<span class="nc bnc" id="L906" title="All 4 branches missed.">        switch(code) {</span>
            case ObaApi.OBA_INTERNAL_ERROR:
<span class="nc" id="L908">                return R.string.internal_error;</span>
            case ObaApi.OBA_BAD_GATEWAY:
<span class="nc" id="L910">                return R.string.bad_gateway_error;</span>
            case ObaApi.OBA_OUT_OF_MEMORY:
<span class="nc" id="L912">                return R.string.out_of_memory_error;</span>
            default:
<span class="nc" id="L914">                return R.string.map_generic_error;</span>
        }
    }

    /**
     * Returns true if the device is in Airplane Mode, and false if the device isn't in Airplane
     * mode or if it can't be determined
     * @param context
     * @return true if the device is in Airplane Mode, and false if the device isn't in Airplane
     * mode or if it can't be determined
     */
    public static boolean isAirplaneMode(Context context) {
<span class="nc bnc" id="L926" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7090)) {</span>
<span class="nc bnc" id="L927" title="All 2 branches missed.">            if (context == null) {</span>
                // If the context is null, we can't get airplane mode state - assume no
<span class="nc" id="L929">                return false;</span>
            }
        }
<span class="nc" id="L932">        ContentResolver cr = context.getContentResolver();</span>
<span class="nc bnc" id="L933" title="All 2 branches missed.">        return Settings.System.getInt(cr, Settings.System.AIRPLANE_MODE_ON, 0) != 0;</span>
    }

    /**
     * Returns true if the device is connected to a network, and false if the device isn't or if it
     * can't be determined
     * @param context
     * @return true if the device is connected to a network, and false if the device isn't or if it
     * can't be determined
     */
    public static boolean isConnected(Context context) {
<span class="nc bnc" id="L944" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7091)) {</span>
<span class="nc bnc" id="L945" title="All 2 branches missed.">            if (context == null) {</span>
                // If the context is null, we can't get connected state - assume yes
<span class="nc" id="L947">                return true;</span>
            }
        }
<span class="nc" id="L950">        ConnectivityManager cm = (ConnectivityManager) context.getSystemService(Context.CONNECTIVITY_SERVICE);</span>
<span class="nc" id="L951">        NetworkInfo activeNetwork = cm.getActiveNetworkInfo();</span>
<span class="nc bnc" id="L952" title="All 10 branches missed.">        return (ListenerUtil.mutListener.listen(7092) ? ((activeNetwork != null) || activeNetwork.isConnectedOrConnecting()) : ((activeNetwork != null) &amp;&amp; activeNetwork.isConnectedOrConnecting()));</span>
    }

    /**
     * Returns the first string for the query URI.
     */
    public static String stringForQuery(Context context, Uri uri, String column) {
<span class="nc" id="L959">        ContentResolver cr = context.getContentResolver();</span>
<span class="nc" id="L960">        Cursor c = cr.query(uri, new String[] { column }, null, null, null);</span>
<span class="nc bnc" id="L961" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7095)) {</span>
<span class="nc bnc" id="L962" title="All 2 branches missed.">            if (c != null) {</span>
                try {
<span class="nc bnc" id="L964" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7094)) {</span>
<span class="nc bnc" id="L965" title="All 2 branches missed.">                        if (c.moveToFirst()) {</span>
<span class="nc" id="L966">                            return c.getString(0);</span>
                        }
                    }
                } finally {
<span class="nc bnc" id="L970" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7093)) {</span>
<span class="nc" id="L971">                        c.close();</span>
                    }
                }
            }
        }
<span class="nc" id="L976">        return &quot;&quot;;</span>
    }

    public static Integer intForQuery(Context context, Uri uri, String column) {
<span class="nc" id="L980">        ContentResolver cr = context.getContentResolver();</span>
<span class="nc" id="L981">        Cursor c = cr.query(uri, new String[] { column }, null, null, null);</span>
<span class="nc bnc" id="L982" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7098)) {</span>
<span class="nc bnc" id="L983" title="All 2 branches missed.">            if (c != null) {</span>
                try {
<span class="nc bnc" id="L985" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7097)) {</span>
<span class="nc bnc" id="L986" title="All 2 branches missed.">                        if (c.moveToFirst()) {</span>
<span class="nc" id="L987">                            return c.getInt(0);</span>
                        }
                    }
                } finally {
<span class="nc bnc" id="L991" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7096)) {</span>
<span class="nc" id="L992">                        c.close();</span>
                    }
                }
            }
        }
<span class="nc" id="L997">        return null;</span>
    }

    public static final int MINUTES_IN_HOUR = 60;

    /**
     * Takes the number of minutes, and returns a user-readable string
     * saying the number of minutes in which no arrivals are coming,
     * or the number of hours and minutes if minutes if minutes &gt; 60
     *
     * @param minutes            number of minutes for which there are no upcoming arrivals
     * @param additionalArrivals true if the response should include the word additional, false if
     *                           it should not
     * @param shortFormat        true if the format should be abbreviated, false if it should be
     *                           long
     * @return a user-readable string saying the number of minutes in which no arrivals are coming,
     * or the number of hours and minutes if minutes &gt; 60
     */
    public static String getNoArrivalsMessage(Context context, int minutes, boolean additionalArrivals, boolean shortFormat) {
<span class="nc bnc" id="L1016" title="All 22 branches missed.">        if ((ListenerUtil.mutListener.listen(7103) ? (minutes &gt;= MINUTES_IN_HOUR) : (ListenerUtil.mutListener.listen(7102) ? (minutes &gt; MINUTES_IN_HOUR) : (ListenerUtil.mutListener.listen(7101) ? (minutes &lt; MINUTES_IN_HOUR) : (ListenerUtil.mutListener.listen(7100) ? (minutes != MINUTES_IN_HOUR) : (ListenerUtil.mutListener.listen(7099) ? (minutes == MINUTES_IN_HOUR) : (minutes &lt;= MINUTES_IN_HOUR))))))) {</span>
            // Return just minutes
<span class="nc bnc" id="L1018" title="All 2 branches missed.">            if (additionalArrivals) {</span>
<span class="nc bnc" id="L1019" title="All 2 branches missed.">                if (shortFormat) {</span>
                    // Abbreviated version
<span class="nc" id="L1021">                    return context.getString(R.string.stop_info_no_additional_data_minutes_short_format, minutes);</span>
                } else {
                    // Long version
<span class="nc" id="L1024">                    return context.getString(R.string.stop_info_no_additional_data_minutes, minutes);</span>
                }
            } else {
<span class="nc bnc" id="L1027" title="All 2 branches missed.">                if (shortFormat) {</span>
                    // Abbreviated version
<span class="nc" id="L1029">                    return context.getString(R.string.stop_info_nodata_minutes_short_format, minutes);</span>
                } else {
                    // Long version
<span class="nc" id="L1032">                    return context.getString(R.string.stop_info_nodata_minutes, minutes);</span>
                }
            }
        } else {
            // Return hours and minutes
<span class="nc bnc" id="L1037" title="All 2 branches missed.">            if (additionalArrivals) {</span>
<span class="nc bnc" id="L1038" title="All 2 branches missed.">                if (shortFormat) {</span>
                    // Abbreviated version
<span class="nc bnc" id="L1040" title="All 24 branches missed.">                    return context.getResources().getQuantityString(R.plurals.stop_info_no_additional_data_hours_minutes_short_format, (ListenerUtil.mutListener.listen(7143) ? (minutes % 60) : (ListenerUtil.mutListener.listen(7142) ? (minutes * 60) : (ListenerUtil.mutListener.listen(7141) ? (minutes - 60) : (ListenerUtil.mutListener.listen(7140) ? (minutes + 60) : (minutes / 60))))), (ListenerUtil.mutListener.listen(7147) ? (minutes / 60) : (ListenerUtil.mutListener.listen(7146) ? (minutes * 60) : (ListenerUtil.mutListener.listen(7145) ? (minutes - 60) : (ListenerUtil.mutListener.listen(7144) ? (minutes + 60) : (minutes % 60))))), (ListenerUtil.mutListener.listen(7151) ? (minutes % 60) : (ListenerUtil.mutListener.listen(7150) ? (minutes * 60) : (ListenerUtil.mutListener.listen(7149) ? (minutes - 60) : (ListenerUtil.mutListener.listen(7148) ? (minutes + 60) : (minutes / 60))))));</span>
                } else {
                    // Long version
<span class="nc bnc" id="L1043" title="All 24 branches missed.">                    return context.getResources().getQuantityString(R.plurals.stop_info_no_additional_data_hours_minutes, (ListenerUtil.mutListener.listen(7131) ? (minutes % 60) : (ListenerUtil.mutListener.listen(7130) ? (minutes * 60) : (ListenerUtil.mutListener.listen(7129) ? (minutes - 60) : (ListenerUtil.mutListener.listen(7128) ? (minutes + 60) : (minutes / 60))))), (ListenerUtil.mutListener.listen(7135) ? (minutes / 60) : (ListenerUtil.mutListener.listen(7134) ? (minutes * 60) : (ListenerUtil.mutListener.listen(7133) ? (minutes - 60) : (ListenerUtil.mutListener.listen(7132) ? (minutes + 60) : (minutes % 60))))), (ListenerUtil.mutListener.listen(7139) ? (minutes % 60) : (ListenerUtil.mutListener.listen(7138) ? (minutes * 60) : (ListenerUtil.mutListener.listen(7137) ? (minutes - 60) : (ListenerUtil.mutListener.listen(7136) ? (minutes + 60) : (minutes / 60))))));</span>
                }
            } else {
<span class="nc bnc" id="L1046" title="All 2 branches missed.">                if (shortFormat) {</span>
                    // Abbreviated version
<span class="nc bnc" id="L1048" title="All 24 branches missed.">                    return context.getResources().getQuantityString(R.plurals.stop_info_nodata_hours_minutes_short_format, (ListenerUtil.mutListener.listen(7119) ? (minutes % 60) : (ListenerUtil.mutListener.listen(7118) ? (minutes * 60) : (ListenerUtil.mutListener.listen(7117) ? (minutes - 60) : (ListenerUtil.mutListener.listen(7116) ? (minutes + 60) : (minutes / 60))))), (ListenerUtil.mutListener.listen(7123) ? (minutes / 60) : (ListenerUtil.mutListener.listen(7122) ? (minutes * 60) : (ListenerUtil.mutListener.listen(7121) ? (minutes - 60) : (ListenerUtil.mutListener.listen(7120) ? (minutes + 60) : (minutes % 60))))), (ListenerUtil.mutListener.listen(7127) ? (minutes % 60) : (ListenerUtil.mutListener.listen(7126) ? (minutes * 60) : (ListenerUtil.mutListener.listen(7125) ? (minutes - 60) : (ListenerUtil.mutListener.listen(7124) ? (minutes + 60) : (minutes / 60))))));</span>
                } else {
                    // Long version
<span class="nc bnc" id="L1051" title="All 24 branches missed.">                    return context.getResources().getQuantityString(R.plurals.stop_info_nodata_hours_minutes, (ListenerUtil.mutListener.listen(7107) ? (minutes % 60) : (ListenerUtil.mutListener.listen(7106) ? (minutes * 60) : (ListenerUtil.mutListener.listen(7105) ? (minutes - 60) : (ListenerUtil.mutListener.listen(7104) ? (minutes + 60) : (minutes / 60))))), (ListenerUtil.mutListener.listen(7111) ? (minutes / 60) : (ListenerUtil.mutListener.listen(7110) ? (minutes * 60) : (ListenerUtil.mutListener.listen(7109) ? (minutes - 60) : (ListenerUtil.mutListener.listen(7108) ? (minutes + 60) : (minutes % 60))))), (ListenerUtil.mutListener.listen(7115) ? (minutes % 60) : (ListenerUtil.mutListener.listen(7114) ? (minutes * 60) : (ListenerUtil.mutListener.listen(7113) ? (minutes - 60) : (ListenerUtil.mutListener.listen(7112) ? (minutes + 60) : (minutes / 60))))));</span>
                }
            }
        }
    }

    /**
     * Returns true if the activity is still active and dialogs can be managed (i.e., displayed
     * or dismissed), or false if it is
     * not
     *
     * @param activity Activity to check for displaying/dismissing a dialog
     * @return true if the activity is still active and dialogs can be managed, or false if it is
     * not
     */
    public static boolean canManageDialog(Activity activity) {
<span class="nc bnc" id="L1067" title="All 2 branches missed.">        if (activity == null) {</span>
<span class="nc" id="L1068">            return false;</span>
        }
<span class="nc bnc" id="L1070" title="All 22 branches missed.">        if ((ListenerUtil.mutListener.listen(7156) ? (Build.VERSION.SDK_INT &lt;= Build.VERSION_CODES.JELLY_BEAN_MR1) : (ListenerUtil.mutListener.listen(7155) ? (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.JELLY_BEAN_MR1) : (ListenerUtil.mutListener.listen(7154) ? (Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.JELLY_BEAN_MR1) : (ListenerUtil.mutListener.listen(7153) ? (Build.VERSION.SDK_INT != Build.VERSION_CODES.JELLY_BEAN_MR1) : (ListenerUtil.mutListener.listen(7152) ? (Build.VERSION.SDK_INT == Build.VERSION_CODES.JELLY_BEAN_MR1) : (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.JELLY_BEAN_MR1))))))) {</span>
<span class="nc bnc" id="L1071" title="All 10 branches missed.">            return (ListenerUtil.mutListener.listen(7157) ? (!activity.isFinishing() || !activity.isDestroyed()) : (!activity.isFinishing() &amp;&amp; !activity.isDestroyed()));</span>
        } else {
<span class="nc bnc" id="L1073" title="All 2 branches missed.">            return !activity.isFinishing();</span>
        }
    }

    /**
     * Returns true if the context is an Activity and is still active and dialogs can be managed
     * (i.e., displayed or dismissed) OR the context is not an Activity, or false if the Activity
     * is
     * no longer active.
     *
     * NOTE: We really shouldn't display dialogs from a Service - a notification is a better way
     * to communicate with the user.
     *
     * @param context Context to check for displaying/dismissing a dialog
     * @return true if the context is an Activity and is still active and dialogs can be managed
     * (i.e., displayed or dismissed) OR the context is not an Activity, or false if the Activity
     * is
     * no longer active
     */
    public static boolean canManageDialog(Context context) {
<span class="nc bnc" id="L1093" title="All 2 branches missed.">        if (context == null) {</span>
<span class="nc" id="L1094">            return false;</span>
        }
<span class="nc bnc" id="L1096" title="All 2 branches missed.">        if (context instanceof Activity) {</span>
<span class="nc" id="L1097">            return canManageDialog((Activity) context);</span>
        } else {
            // need to do this, we don't have any way of checking whether its possible
<span class="nc" id="L1100">            return true;</span>
        }
    }

    /**
     * Returns true if the API level supports animating Views using ViewPropertyAnimator, false if
     * it doesn't
     *
     * @return true if the API level supports animating Views using ViewPropertyAnimator, false if
     * it doesn't
     */
    public static boolean canAnimateViewModern() {
<span class="nc bnc" id="L1112" title="All 22 branches missed.">        return (ListenerUtil.mutListener.listen(7162) ? (Build.VERSION.SDK_INT &lt;= Build.VERSION_CODES.HONEYCOMB_MR1) : (ListenerUtil.mutListener.listen(7161) ? (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.HONEYCOMB_MR1) : (ListenerUtil.mutListener.listen(7160) ? (Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.HONEYCOMB_MR1) : (ListenerUtil.mutListener.listen(7159) ? (Build.VERSION.SDK_INT != Build.VERSION_CODES.HONEYCOMB_MR1) : (ListenerUtil.mutListener.listen(7158) ? (Build.VERSION.SDK_INT == Build.VERSION_CODES.HONEYCOMB_MR1) : (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.HONEYCOMB_MR1))))));</span>
    }

    /**
     * Returns true if the API level supports canceling existing animations via the
     * ViewPropertyAnimator, and false if it does not
     *
     * @return true if the API level supports canceling existing animations via the
     * ViewPropertyAnimator, and false if it does not
     */
    public static boolean canCancelAnimation() {
<span class="nc bnc" id="L1123" title="All 22 branches missed.">        return (ListenerUtil.mutListener.listen(7167) ? (Build.VERSION.SDK_INT &lt;= Build.VERSION_CODES.ICE_CREAM_SANDWICH) : (ListenerUtil.mutListener.listen(7166) ? (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.ICE_CREAM_SANDWICH) : (ListenerUtil.mutListener.listen(7165) ? (Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.ICE_CREAM_SANDWICH) : (ListenerUtil.mutListener.listen(7164) ? (Build.VERSION.SDK_INT != Build.VERSION_CODES.ICE_CREAM_SANDWICH) : (ListenerUtil.mutListener.listen(7163) ? (Build.VERSION.SDK_INT == Build.VERSION_CODES.ICE_CREAM_SANDWICH) : (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.ICE_CREAM_SANDWICH))))));</span>
    }

    /**
     * Returns true if the API level supports our Arrival Info Style B (sort by route) views, false
     * if it does not.  See #350 and #275.
     *
     * @return true if the API level supports our Arrival Info Style B (sort by route) views, false
     * if it does not
     */
    public static boolean canSupportArrivalInfoStyleB() {
<span class="nc bnc" id="L1134" title="All 22 branches missed.">        return (ListenerUtil.mutListener.listen(7172) ? (Build.VERSION.SDK_INT &lt;= Build.VERSION_CODES.ICE_CREAM_SANDWICH) : (ListenerUtil.mutListener.listen(7171) ? (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.ICE_CREAM_SANDWICH) : (ListenerUtil.mutListener.listen(7170) ? (Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.ICE_CREAM_SANDWICH) : (ListenerUtil.mutListener.listen(7169) ? (Build.VERSION.SDK_INT != Build.VERSION_CODES.ICE_CREAM_SANDWICH) : (ListenerUtil.mutListener.listen(7168) ? (Build.VERSION.SDK_INT == Build.VERSION_CODES.ICE_CREAM_SANDWICH) : (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.ICE_CREAM_SANDWICH))))));</span>
    }

    /**
     * Shows a view, using animation if the platform supports it
     *
     * @param v                 View to show
     * @param animationDuration duration of animation
     */
    @TargetApi(14)
    public static void showViewWithAnimation(final View v, int animationDuration) {
<span class="nc bnc" id="L1145" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7174)) {</span>
            // If we're on a legacy device, show the view without the animation
<span class="nc bnc" id="L1147" title="All 2 branches missed.">            if (!canAnimateViewModern()) {</span>
<span class="nc bnc" id="L1148" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7173)) {</span>
<span class="nc" id="L1149">                    showViewWithoutAnimation(v);</span>
                }
<span class="nc" id="L1151">                return;</span>
            }
        }
<span class="nc bnc" id="L1154" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7176)) {</span>
<span class="nc bnc" id="L1155" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(7175) ? (v.getVisibility() == View.VISIBLE || v.getAlpha() == 1) : (v.getVisibility() == View.VISIBLE &amp;&amp; v.getAlpha() == 1))) {</span>
                // View is already visible and not transparent, return without doing anything
<span class="nc" id="L1157">                return;</span>
            }
        }
<span class="nc bnc" id="L1160" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7177)) {</span>
<span class="nc" id="L1161">            v.clearAnimation();</span>
        }
<span class="nc bnc" id="L1163" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7179)) {</span>
<span class="nc bnc" id="L1164" title="All 2 branches missed.">            if (canCancelAnimation()) {</span>
<span class="nc bnc" id="L1165" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7178)) {</span>
<span class="nc" id="L1166">                    v.animate().cancel();</span>
                }
            }
        }
<span class="nc bnc" id="L1170" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7182)) {</span>
<span class="nc bnc" id="L1171" title="All 2 branches missed.">            if (v.getVisibility() != View.VISIBLE) {</span>
<span class="nc bnc" id="L1172" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7180)) {</span>
                    // (but fully transparent) during the animation.
<span class="nc" id="L1174">                    v.setAlpha(0f);</span>
                }
<span class="nc bnc" id="L1176" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7181)) {</span>
<span class="nc" id="L1177">                    v.setVisibility(View.VISIBLE);</span>
                }
            }
        }
<span class="nc bnc" id="L1181" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7183)) {</span>
            // Animate the content view to 100% opacity, and clear any animation listener set on the view.
<span class="nc" id="L1183">            v.animate().alpha(1f).setDuration(animationDuration).setListener(null);</span>
        }
<span class="nc" id="L1185">    }</span>

    /**
     * Shows a view without using animation
     *
     * @param v View to show
     */
    public static void showViewWithoutAnimation(final View v) {
<span class="nc bnc" id="L1193" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7184)) {</span>
<span class="nc bnc" id="L1194" title="All 2 branches missed.">            if (v.getVisibility() == View.VISIBLE) {</span>
                // View is already visible, return without doing anything
<span class="nc" id="L1196">                return;</span>
            }
        }
<span class="nc bnc" id="L1199" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7185)) {</span>
<span class="nc" id="L1200">            v.setVisibility(View.VISIBLE);</span>
        }
<span class="nc" id="L1202">    }</span>

    /**
     * Hides a view, using animation if the platform supports it
     *
     * @param v                 View to hide
     * @param animationDuration duration of animation
     */
    @TargetApi(14)
    public static void hideViewWithAnimation(final View v, int animationDuration) {
<span class="nc bnc" id="L1212" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7187)) {</span>
            // If we're on a legacy device, hide the view without the animation
<span class="nc bnc" id="L1214" title="All 2 branches missed.">            if (!canAnimateViewModern()) {</span>
<span class="nc bnc" id="L1215" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7186)) {</span>
<span class="nc" id="L1216">                    hideViewWithoutAnimation(v);</span>
                }
<span class="nc" id="L1218">                return;</span>
            }
        }
<span class="nc bnc" id="L1221" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7188)) {</span>
<span class="nc bnc" id="L1222" title="All 2 branches missed.">            if (v.getVisibility() == View.GONE) {</span>
                // View is already gone, return without doing anything
<span class="nc" id="L1224">                return;</span>
            }
        }
<span class="nc bnc" id="L1227" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7189)) {</span>
<span class="nc" id="L1228">            v.clearAnimation();</span>
        }
<span class="nc bnc" id="L1230" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7191)) {</span>
<span class="nc bnc" id="L1231" title="All 2 branches missed.">            if (canCancelAnimation()) {</span>
<span class="nc bnc" id="L1232" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7190)) {</span>
<span class="nc" id="L1233">                    v.animate().cancel();</span>
                }
            }
        }
<span class="nc bnc" id="L1237" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7193)) {</span>
            // an optimization step (it won't participate in layout passes, etc.)
<span class="nc" id="L1239">            v.animate().alpha(0f).setDuration(animationDuration).setListener(new AnimatorListenerAdapter() {</span>

                @Override
                public void onAnimationEnd(Animator animation) {
<span class="nc bnc" id="L1243" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7192)) {</span>
<span class="nc" id="L1244">                        v.setVisibility(View.GONE);</span>
                    }
<span class="nc" id="L1246">                }</span>
            });
        }
<span class="nc" id="L1249">    }</span>

    /**
     * Hides a view without using animation
     *
     * @param v View to hide
     */
    public static void hideViewWithoutAnimation(final View v) {
<span class="nc bnc" id="L1257" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7194)) {</span>
<span class="nc bnc" id="L1258" title="All 2 branches missed.">            if (v.getVisibility() == View.GONE) {</span>
                // View is already gone, return without doing anything
<span class="nc" id="L1260">                return;</span>
            }
        }
<span class="nc bnc" id="L1263" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7195)) {</span>
            // Hide the view without animation
<span class="nc" id="L1265">            v.setVisibility(View.GONE);</span>
        }
<span class="nc" id="L1267">    }</span>

    /**
     * Prints View visibility information to the log for debugging purposes
     *
     * @param v View to log visibility information for
     */
    @TargetApi(12)
    public static void logViewVisibility(View v) {
<span class="nc bnc" id="L1276" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7203)) {</span>
<span class="nc bnc" id="L1277" title="All 2 branches missed.">            if (v != null) {</span>
<span class="nc bnc" id="L1278" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7202)) {</span>
<span class="nc bnc" id="L1279" title="All 2 branches missed.">                    if (v.getVisibility() == View.VISIBLE) {</span>
<span class="nc bnc" id="L1280" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7199)) {</span>
<span class="nc" id="L1281">                            Log.d(TAG, v.getContext().getResources().getResourceEntryName(v.getId()) + &quot; is visible&quot;);</span>
                        }
<span class="nc bnc" id="L1283" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7201)) {</span>
<span class="nc bnc" id="L1284" title="All 2 branches missed.">                            if (UIUtils.canAnimateViewModern()) {</span>
<span class="nc bnc" id="L1285" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(7200)) {</span>
<span class="nc" id="L1286">                                    Log.d(TAG, v.getContext().getResources().getResourceEntryName(v.getId()) + &quot; alpha - &quot; + v.getAlpha());</span>
                                }
                            }
                        }
<span class="nc bnc" id="L1290" title="All 2 branches missed.">                    } else if (v.getVisibility() == View.INVISIBLE) {</span>
<span class="nc bnc" id="L1291" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7198)) {</span>
<span class="nc" id="L1292">                            Log.d(TAG, v.getContext().getResources().getResourceEntryName(v.getId()) + &quot; is INVISIBLE&quot;);</span>
                        }
<span class="nc bnc" id="L1294" title="All 2 branches missed.">                    } else if (v.getVisibility() == View.GONE) {</span>
<span class="nc bnc" id="L1295" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7197)) {</span>
<span class="nc" id="L1296">                            Log.d(TAG, v.getContext().getResources().getResourceEntryName(v.getId()) + &quot; is GONE&quot;);</span>
                        }
                    } else {
<span class="nc bnc" id="L1299" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7196)) {</span>
<span class="nc" id="L1300">                            Log.d(TAG, v.getContext().getResources().getResourceEntryName(v.getId()) + &quot;.getVisibility() - &quot; + v.getVisibility());</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L1306">    }</span>

    /**
     * Converts screen dimension units from dp to pixels, based on algorithm defined in
     * http://developer.android.com/guide/practices/screens_support.html#dips-pels
     *
     * @param dp value in dp
     * @return value in pixels
     */
    public static int dpToPixels(Context context, float dp) {
        // Get the screen's density scale
<span class="nc" id="L1317">        final float scale = context.getResources().getDisplayMetrics().density;</span>
        // Convert the dps to pixels, based on density scale
<span class="nc bnc" id="L1319" title="All 48 branches missed.">        return (int) ((ListenerUtil.mutListener.listen(7211) ? ((ListenerUtil.mutListener.listen(7207) ? (dp % scale) : (ListenerUtil.mutListener.listen(7206) ? (dp / scale) : (ListenerUtil.mutListener.listen(7205) ? (dp - scale) : (ListenerUtil.mutListener.listen(7204) ? (dp + scale) : (dp * scale))))) % 0.5f) : (ListenerUtil.mutListener.listen(7210) ? ((ListenerUtil.mutListener.listen(7207) ? (dp % scale) : (ListenerUtil.mutListener.listen(7206) ? (dp / scale) : (ListenerUtil.mutListener.listen(7205) ? (dp - scale) : (ListenerUtil.mutListener.listen(7204) ? (dp + scale) : (dp * scale))))) / 0.5f) : (ListenerUtil.mutListener.listen(7209) ? ((ListenerUtil.mutListener.listen(7207) ? (dp % scale) : (ListenerUtil.mutListener.listen(7206) ? (dp / scale) : (ListenerUtil.mutListener.listen(7205) ? (dp - scale) : (ListenerUtil.mutListener.listen(7204) ? (dp + scale) : (dp * scale))))) * 0.5f) : (ListenerUtil.mutListener.listen(7208) ? ((ListenerUtil.mutListener.listen(7207) ? (dp % scale) : (ListenerUtil.mutListener.listen(7206) ? (dp / scale) : (ListenerUtil.mutListener.listen(7205) ? (dp - scale) : (ListenerUtil.mutListener.listen(7204) ? (dp + scale) : (dp * scale))))) - 0.5f) : ((ListenerUtil.mutListener.listen(7207) ? (dp % scale) : (ListenerUtil.mutListener.listen(7206) ? (dp / scale) : (ListenerUtil.mutListener.listen(7205) ? (dp - scale) : (ListenerUtil.mutListener.listen(7204) ? (dp + scale) : (dp * scale))))) + 0.5f))))));</span>
    }

    /**
     * Sets the margins for a given view
     *
     * @param v View to set the margin for
     * @param l left margin, in pixels
     * @param t top margin, in pixels
     * @param r right margin, in pixels
     * @param b bottom margin, in pixels
     */
    public static void setMargins(View v, int l, int t, int r, int b) {
<span class="nc" id="L1332">        ViewGroup.MarginLayoutParams p = (ViewGroup.MarginLayoutParams) v.getLayoutParams();</span>
<span class="nc bnc" id="L1333" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7212)) {</span>
<span class="nc" id="L1334">            p.setMargins(l, t, r, b);</span>
        }
<span class="nc bnc" id="L1336" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7213)) {</span>
<span class="nc" id="L1337">            v.setLayoutParams(p);</span>
        }
<span class="nc" id="L1339">    }</span>

    /**
     * Formats a view so it is ignored for accessible access
     */
    public static void setAccessibilityIgnore(View view) {
<span class="nc bnc" id="L1345" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7214)) {</span>
<span class="nc" id="L1346">            view.setClickable(false);</span>
        }
<span class="nc bnc" id="L1348" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7215)) {</span>
<span class="nc" id="L1349">            view.setFocusable(false);</span>
        }
<span class="nc bnc" id="L1351" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7216)) {</span>
<span class="nc" id="L1352">            view.setContentDescription(&quot;&quot;);</span>
        }
<span class="nc bnc" id="L1354" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7223)) {</span>
<span class="nc bnc" id="L1355" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(7221) ? (Build.VERSION.SDK_INT &lt;= Build.VERSION_CODES.JELLY_BEAN) : (ListenerUtil.mutListener.listen(7220) ? (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.JELLY_BEAN) : (ListenerUtil.mutListener.listen(7219) ? (Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.JELLY_BEAN) : (ListenerUtil.mutListener.listen(7218) ? (Build.VERSION.SDK_INT != Build.VERSION_CODES.JELLY_BEAN) : (ListenerUtil.mutListener.listen(7217) ? (Build.VERSION.SDK_INT == Build.VERSION_CODES.JELLY_BEAN) : (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.JELLY_BEAN))))))) {</span>
<span class="nc bnc" id="L1356" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7222)) {</span>
<span class="nc" id="L1357">                    view.setImportantForAccessibility(View.IMPORTANT_FOR_ACCESSIBILITY_NO);</span>
                }
            }
        }
<span class="nc" id="L1361">    }</span>

    /**
     * Builds the list of Strings that should be shown for a given trip &quot;Bus Options&quot; menu,
     * provided the arguments for that trip
     *
     * @param c                 Context
     * @param isRouteFavorite   true if this route is a user favorite, false if it is not
     * @param hasUrl            true if the route provides a URL for schedule data, false if it does
     *                          not
     * @param isReminderVisible true if the reminder is currently visible for a trip, false if it
     *                          is
     *                          not
     * @param occupancy occupancy of this trip
     * @param occupancyState occupanceState of this trip
     * @return the list of Strings that should be shown for a given trip, provided the arguments for
     * that trip
     */
    public static List&lt;String&gt; buildTripOptions(Context c, boolean isRouteFavorite, boolean hasUrl, boolean isReminderVisible, boolean hasRouteFilter, Occupancy occupancy, OccupancyState occupancyState) {
<span class="nc" id="L1380">        ArrayList&lt;String&gt; list = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L1381" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7226)) {</span>
<span class="nc bnc" id="L1382" title="All 2 branches missed.">            if (!isRouteFavorite) {</span>
<span class="nc bnc" id="L1383" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7225)) {</span>
<span class="nc" id="L1384">                    list.add(c.getString(R.string.bus_options_menu_add_star));</span>
                }
            } else {
<span class="nc bnc" id="L1387" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7224)) {</span>
<span class="nc" id="L1388">                    list.add(c.getString(R.string.bus_options_menu_remove_star));</span>
                }
            }
        }
<span class="nc bnc" id="L1392" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7227)) {</span>
<span class="nc" id="L1393">            list.add(c.getString(R.string.bus_options_menu_show_route_on_map));</span>
        }
<span class="nc bnc" id="L1395" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7228)) {</span>
<span class="nc" id="L1396">            list.add(c.getString(R.string.bus_options_menu_show_trip_details));</span>
        }
<span class="nc bnc" id="L1398" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7231)) {</span>
<span class="nc bnc" id="L1399" title="All 2 branches missed.">            if (!isReminderVisible) {</span>
<span class="nc bnc" id="L1400" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7230)) {</span>
<span class="nc" id="L1401">                    list.add(c.getString(R.string.bus_options_menu_set_reminder));</span>
                }
            } else {
<span class="nc bnc" id="L1404" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7229)) {</span>
<span class="nc" id="L1405">                    list.add(c.getString(R.string.bus_options_menu_edit_reminder));</span>
                }
            }
        }
<span class="nc bnc" id="L1409" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7234)) {</span>
<span class="nc bnc" id="L1410" title="All 2 branches missed.">            if (!hasRouteFilter) {</span>
<span class="nc bnc" id="L1411" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7233)) {</span>
<span class="nc" id="L1412">                    list.add(c.getString(R.string.bus_options_menu_show_only_this_route));</span>
                }
            } else {
<span class="nc bnc" id="L1415" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7232)) {</span>
<span class="nc" id="L1416">                    list.add(c.getString(R.string.bus_options_menu_show_all_routes));</span>
                }
            }
        }
<span class="nc bnc" id="L1420" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7236)) {</span>
<span class="nc bnc" id="L1421" title="All 2 branches missed.">            if (hasUrl) {</span>
<span class="nc bnc" id="L1422" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7235)) {</span>
<span class="nc" id="L1423">                    list.add(c.getString(R.string.bus_options_menu_show_route_schedule));</span>
                }
            }
        }
<span class="nc bnc" id="L1427" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7237)) {</span>
<span class="nc" id="L1428">            list.add(c.getString(R.string.bus_options_menu_report_trip_problem));</span>
        }
<span class="nc bnc" id="L1430" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7241)) {</span>
<span class="nc bnc" id="L1431" title="All 2 branches missed.">            if (occupancy != null) {</span>
<span class="nc bnc" id="L1432" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7240)) {</span>
<span class="nc bnc" id="L1433" title="All 2 branches missed.">                    if (occupancyState == OccupancyState.HISTORICAL) {</span>
<span class="nc bnc" id="L1434" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7239)) {</span>
<span class="nc" id="L1435">                            list.add(c.getString(R.string.menu_title_about_historical_occupancy));</span>
                        }
                    } else {
<span class="nc bnc" id="L1438" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7238)) {</span>
<span class="nc" id="L1439">                            list.add(c.getString(R.string.menu_title_about_occupancy));</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L1445">        return list;</span>
    }

    /**
     * Builds the array of icons that should be shown for the trip &quot;Bus Options&quot; menu, given the
     * provided arguments for that trip
     *
     * @param isRouteFavorite   true if this route is a user favorite, false if it is not
     * @param hasUrl true if the route provides a URL for schedule data, false if it does
     *               not
     * @param occupancy occupancy of this trip
     * @return the array of icons that should be shown for a given trip
     */
    public static List&lt;Integer&gt; buildTripOptionsIcons(boolean isRouteFavorite, boolean hasUrl, Occupancy occupancy) {
<span class="nc" id="L1459">        ArrayList&lt;Integer&gt; list = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L1460" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7244)) {</span>
<span class="nc bnc" id="L1461" title="All 2 branches missed.">            if (!isRouteFavorite) {</span>
<span class="nc bnc" id="L1462" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7243)) {</span>
<span class="nc" id="L1463">                    list.add(R.drawable.focus_star_on);</span>
                }
            } else {
<span class="nc bnc" id="L1466" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7242)) {</span>
<span class="nc" id="L1467">                    list.add(R.drawable.focus_star_off);</span>
                }
            }
        }
<span class="nc bnc" id="L1471" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7245)) {</span>
<span class="nc" id="L1472">            list.add(R.drawable.ic_arrivals_styleb_action_map);</span>
        }
<span class="nc bnc" id="L1474" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7246)) {</span>
<span class="nc" id="L1475">            list.add(R.drawable.ic_trip_details);</span>
        }
<span class="nc bnc" id="L1477" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7247)) {</span>
<span class="nc" id="L1478">            list.add(R.drawable.ic_drawer_alarm);</span>
        }
<span class="nc bnc" id="L1480" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7248)) {</span>
<span class="nc" id="L1481">            list.add(R.drawable.ic_content_filter_list);</span>
        }
<span class="nc bnc" id="L1483" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7250)) {</span>
<span class="nc bnc" id="L1484" title="All 2 branches missed.">            if (hasUrl) {</span>
<span class="nc bnc" id="L1485" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7249)) {</span>
<span class="nc" id="L1486">                    list.add(R.drawable.ic_notification_event_note);</span>
                }
            }
        }
<span class="nc bnc" id="L1490" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7251)) {</span>
<span class="nc" id="L1491">            list.add(R.drawable.ic_alert_warning);</span>
        }
<span class="nc bnc" id="L1493" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7253)) {</span>
<span class="nc bnc" id="L1494" title="All 2 branches missed.">            if (occupancy != null) {</span>
<span class="nc bnc" id="L1495" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7252)) {</span>
<span class="nc" id="L1496">                    list.add(R.drawable.ic_occupancy);</span>
                }
            }
        }
<span class="nc" id="L1500">        return list;</span>
    }

    /**
     * Sets the line and fill colors for real-time indicator circles contained in the provided
     * realtime_indicator.xml layout.  There are several circles, so each needs to be set
     * individually.  The resource code for the color to be used should be provided.
     *
     * @param vg        realtime_indicator.xml layout
     * @param lineColor resource code color to be used as line color, or null to use the default
     *                  colors
     * @param fillColor resource code color to be used as fill color, or null to use the default
     *                  colors
     */
    public static void setRealtimeIndicatorColorByResourceCode(ViewGroup vg, Integer lineColor, Integer fillColor) {
<span class="nc" id="L1515">        Resources r = vg.getResources();</span>
<span class="nc bnc" id="L1516" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7254)) {</span>
<span class="nc" id="L1517">            setRealtimeIndicatorColor(vg, r.getColor(lineColor), r.getColor(fillColor));</span>
        }
<span class="nc" id="L1519">    }</span>

    /**
     * Sets the line and fill colors for real-time indicator circles contained in the provided
     * realtime_indicator.xml layout.  There are several circles, so each needs to be set
     * individually.  The integer representation of the color to be used should be provided.
     *
     * @param vg        realtime_indicator.xml layout
     * @param lineColor color to be used as line color, or null to use the default colors
     * @param fillColor color to be used as fill color, or null to use the default colors
     */
    public static void setRealtimeIndicatorColor(ViewGroup vg, Integer lineColor, Integer fillColor) {
<span class="nc bnc" id="L1531" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7267)) {</span>
            {
<span class="nc" id="L1533">                long _loopCounter81 = 0;</span>
<span class="nc bnc" id="L1534" title="All 22 branches missed.">                for (int i = 0; (ListenerUtil.mutListener.listen(7266) ? (i &gt;= vg.getChildCount()) : (ListenerUtil.mutListener.listen(7265) ? (i &lt;= vg.getChildCount()) : (ListenerUtil.mutListener.listen(7264) ? (i &gt; vg.getChildCount()) : (ListenerUtil.mutListener.listen(7263) ? (i != vg.getChildCount()) : (ListenerUtil.mutListener.listen(7262) ? (i == vg.getChildCount()) : (i &lt; vg.getChildCount())))))); i++) {</span>
<span class="nc" id="L1535">                    ListenerUtil.loopListener.listen(&quot;_loopCounter81&quot;, ++_loopCounter81);</span>
<span class="nc" id="L1536">                    View v = vg.getChildAt(i);</span>
<span class="nc bnc" id="L1537" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7261)) {</span>
<span class="nc bnc" id="L1538" title="All 2 branches missed.">                        if (v instanceof RealtimeIndicatorView) {</span>
<span class="nc bnc" id="L1539" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7257)) {</span>
<span class="nc bnc" id="L1540" title="All 2 branches missed.">                                if (lineColor != null) {</span>
<span class="nc bnc" id="L1541" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(7256)) {</span>
<span class="nc" id="L1542">                                        ((RealtimeIndicatorView) v).setLineColor(lineColor);</span>
                                    }
                                } else {
<span class="nc bnc" id="L1545" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(7255)) {</span>
                                        // Use default color
<span class="nc" id="L1547">                                        ((RealtimeIndicatorView) v).setLineColor(R.color.realtime_indicator_line);</span>
                                    }
                                }
                            }
<span class="nc bnc" id="L1551" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7260)) {</span>
<span class="nc bnc" id="L1552" title="All 2 branches missed.">                                if (fillColor != null) {</span>
<span class="nc bnc" id="L1553" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(7259)) {</span>
<span class="nc" id="L1554">                                        ((RealtimeIndicatorView) v).setFillColor(fillColor);</span>
                                    }
                                } else {
<span class="nc bnc" id="L1557" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(7258)) {</span>
                                        // Use default color
<span class="nc" id="L1559">                                        ((RealtimeIndicatorView) v).setLineColor(R.color.realtime_indicator_fill);</span>
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
<span class="nc" id="L1568">    }</span>

    /**
     * Creates a new Bitmap, with the black color of the source image changed to the given color.
     * The source Bitmap isn't modified.
     *
     * @param source the source Bitmap with a black background
     * @param color  the color to change the black color to
     * @return the resulting Bitmap that has the black changed to the color
     */
    public static Bitmap colorBitmap(Bitmap source, int color) {
<span class="nc" id="L1579">        int width = source.getWidth();</span>
<span class="nc" id="L1580">        int height = source.getHeight();</span>
<span class="nc bnc" id="L1581" title="All 8 branches missed.">        int[] pixels = new int[(ListenerUtil.mutListener.listen(7271) ? (width % height) : (ListenerUtil.mutListener.listen(7270) ? (width / height) : (ListenerUtil.mutListener.listen(7269) ? (width - height) : (ListenerUtil.mutListener.listen(7268) ? (width + height) : (width * height)))))];</span>
<span class="nc bnc" id="L1582" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7272)) {</span>
<span class="nc" id="L1583">            source.getPixels(pixels, 0, width, 0, 0, width, height);</span>
        }
<span class="nc bnc" id="L1585" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7279)) {</span>
            {
<span class="nc" id="L1587">                long _loopCounter82 = 0;</span>
<span class="nc bnc" id="L1588" title="All 22 branches missed.">                for (int x = 0; (ListenerUtil.mutListener.listen(7278) ? (x &gt;= pixels.length) : (ListenerUtil.mutListener.listen(7277) ? (x &lt;= pixels.length) : (ListenerUtil.mutListener.listen(7276) ? (x &gt; pixels.length) : (ListenerUtil.mutListener.listen(7275) ? (x != pixels.length) : (ListenerUtil.mutListener.listen(7274) ? (x == pixels.length) : (x &lt; pixels.length)))))); ++x) {</span>
<span class="nc" id="L1589">                    ListenerUtil.loopListener.listen(&quot;_loopCounter82&quot;, ++_loopCounter82);</span>
<span class="nc bnc" id="L1590" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7273)) {</span>
<span class="nc bnc" id="L1591" title="All 2 branches missed.">                        pixels[x] = (pixels[x] == Color.BLACK) ? color : pixels[x];</span>
                    }
                }
            }
        }
<span class="nc" id="L1596">        Bitmap out = Bitmap.createBitmap(width, height, source.getConfig());</span>
<span class="nc bnc" id="L1597" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7280)) {</span>
<span class="nc" id="L1598">            out.setPixels(pixels, 0, width, 0, 0, width, height);</span>
        }
<span class="nc" id="L1600">        return out;</span>
    }

    /**
     * Returns true if the provided touch event was within the provided view
     *
     * @return true if the provided touch event was within the provided view
     */
    public static boolean isTouchInView(View view, MotionEvent event) {
<span class="nc" id="L1609">        Rect rect = new Rect();</span>
<span class="nc bnc" id="L1610" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7281)) {</span>
<span class="nc" id="L1611">            view.getGlobalVisibleRect(rect);</span>
        }
<span class="nc" id="L1613">        return rect.contains((int) event.getRawX(), (int) event.getRawY());</span>
    }

    /**
     * Returns the current time for comparison against another current time.  For API levels &gt;=
     * Jelly Bean MR1 the SystemClock.getElapsedRealtimeNanos() method is used, and for API levels
     * &lt;
     * Jelly Bean MR1 System.currentTimeMillis() is used.
     *
     * @return the current time for comparison against another current time, in nanoseconds
     */
    public static long getCurrentTimeForComparison() {
<span class="nc bnc" id="L1625" title="All 22 branches missed.">        if ((ListenerUtil.mutListener.listen(7286) ? (Build.VERSION.SDK_INT &lt;= Build.VERSION_CODES.JELLY_BEAN_MR1) : (ListenerUtil.mutListener.listen(7285) ? (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.JELLY_BEAN_MR1) : (ListenerUtil.mutListener.listen(7284) ? (Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.JELLY_BEAN_MR1) : (ListenerUtil.mutListener.listen(7283) ? (Build.VERSION.SDK_INT != Build.VERSION_CODES.JELLY_BEAN_MR1) : (ListenerUtil.mutListener.listen(7282) ? (Build.VERSION.SDK_INT == Build.VERSION_CODES.JELLY_BEAN_MR1) : (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.JELLY_BEAN_MR1))))))) {</span>
            // Use elapsed real-time nanos, since its guaranteed monotonic
<span class="nc" id="L1627">            return SystemClock.elapsedRealtimeNanos();</span>
        } else {
<span class="nc" id="L1629">            return TimeUnit.MILLISECONDS.toNanos(System.currentTimeMillis());</span>
        }
    }

    /**
     * Open the soft keyboard
     */
    public static void openKeyboard(Context context) {
<span class="nc" id="L1637">        InputMethodManager inputMethodManager = (InputMethodManager) context.getSystemService(Context.INPUT_METHOD_SERVICE);</span>
<span class="nc bnc" id="L1638" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7287)) {</span>
<span class="nc" id="L1639">            inputMethodManager.toggleSoftInput(InputMethodManager.SHOW_FORCED, InputMethodManager.HIDE_NOT_ALWAYS);</span>
        }
<span class="nc" id="L1641">    }</span>

    /**
     * Closes the soft keyboard
     */
    public static void closeKeyboard(Context context, View v) {
<span class="nc" id="L1647">        InputMethodManager imm = (InputMethodManager) context.getSystemService(Context.INPUT_METHOD_SERVICE);</span>
<span class="nc bnc" id="L1648" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7288)) {</span>
<span class="nc" id="L1649">            imm.hideSoftInputFromWindow(v.getWindowToken(), 0);</span>
        }
<span class="nc" id="L1651">    }</span>

    /**
     * Returns a list of all situations (service alerts) that are specific to the stop, routes, and
     * agency for the provided arrivals-and-departures-for-stop response.  For route-specific alerts, this
     * involves looping through the routes and checking the references element to see if there are
     * any route-specific alerts, and adding them to the list to be shown above the list of
     * arrivals for a stop.  See #700.
     *
     * @param response response from arrivals-and-departures-for-stop API
     * @param filter   list of route_ids to retrieve service alerts for, or null to retrieve service
     *                 alerts for all routes. Note that this filter only affects alerts scoped to
     *                 routes - it does not affect alerts scoped to stops or agencies
     * @return a list of all situations (service alerts) that are specific to the stop, routes, and
     * agency. If a route filter list is provided, situations for all stops and agencies are included
     * in the returned list, but only situations scoped for route_ids in the provided filter list are
     * included in the returned list (i.e., situations specified for route_ids that aren't in the
     * filter list are excluded).
     */
    public static List&lt;ObaSituation&gt; getAllSituations(final ObaArrivalInfoResponse response, List&lt;String&gt; filter) {
<span class="nc" id="L1671">        List&lt;ObaSituation&gt; allSituations = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L1672" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7289)) {</span>
            // Add agency-wide and stop-specific alerts
<span class="nc" id="L1674">            allSituations.addAll(response.getSituations());</span>
        }
        // Add all existing Ids to a HashSet for O(1) retrieval (vs. list)
<span class="nc" id="L1677">        HashSet&lt;String&gt; allIds = new HashSet&lt;&gt;();</span>
<span class="nc bnc" id="L1678" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7291)) {</span>
            {
<span class="nc" id="L1680">                long _loopCounter83 = 0;</span>
<span class="nc bnc" id="L1681" title="All 2 branches missed.">                for (ObaSituation s : allSituations) {</span>
<span class="nc" id="L1682">                    ListenerUtil.loopListener.listen(&quot;_loopCounter83&quot;, ++_loopCounter83);</span>
<span class="nc bnc" id="L1683" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7290)) {</span>
<span class="nc" id="L1684">                        allIds.add(s.getId());</span>
                    }
<span class="nc" id="L1686">                }</span>
            }
        }
        // Do the same for filtered routes
<span class="nc" id="L1690">        HashSet&lt;String&gt; filterIds = new HashSet&lt;&gt;();</span>
<span class="nc bnc" id="L1691" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7295)) {</span>
<span class="nc bnc" id="L1692" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(7292) ? (filter != null || !filter.isEmpty()) : (filter != null &amp;&amp; !filter.isEmpty()))) {</span>
<span class="nc bnc" id="L1693" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7294)) {</span>
                    {
<span class="nc" id="L1695">                        long _loopCounter84 = 0;</span>
<span class="nc bnc" id="L1696" title="All 2 branches missed.">                        for (String routeId : filter) {</span>
<span class="nc" id="L1697">                            ListenerUtil.loopListener.listen(&quot;_loopCounter84&quot;, ++_loopCounter84);</span>
<span class="nc bnc" id="L1698" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7293)) {</span>
<span class="nc" id="L1699">                                filterIds.add(routeId);</span>
                            }
<span class="nc" id="L1701">                        }</span>
                    }
                }
            }
        }
        // it's situations in the returned list.
<span class="nc" id="L1707">        ObaArrivalInfo[] info = response.getArrivalInfo();</span>
<span class="nc bnc" id="L1708" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7302)) {</span>
            {
<span class="nc" id="L1710">                long _loopCounter86 = 0;</span>
<span class="nc bnc" id="L1711" title="All 2 branches missed.">                for (ObaArrivalInfo i : info) {</span>
<span class="nc" id="L1712">                    ListenerUtil.loopListener.listen(&quot;_loopCounter86&quot;, ++_loopCounter86);</span>
<span class="nc bnc" id="L1713" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7301)) {</span>
<span class="nc bnc" id="L1714" title="All 10 branches missed.">                        if ((ListenerUtil.mutListener.listen(7296) ? (filterIds.isEmpty() &amp;&amp; filterIds.contains(i.getRouteId())) : (filterIds.isEmpty() || filterIds.contains(i.getRouteId())))) {</span>
<span class="nc bnc" id="L1715" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7300)) {</span>
                                {
<span class="nc" id="L1717">                                    long _loopCounter85 = 0;</span>
<span class="nc bnc" id="L1718" title="All 2 branches missed.">                                    for (String situationId : i.getSituationIds()) {</span>
<span class="nc" id="L1719">                                        ListenerUtil.loopListener.listen(&quot;_loopCounter85&quot;, ++_loopCounter85);</span>
<span class="nc bnc" id="L1720" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(7299)) {</span>
<span class="nc bnc" id="L1721" title="All 2 branches missed.">                                            if (!allIds.contains(situationId)) {</span>
<span class="nc bnc" id="L1722" title="All 2 branches missed.">                                                if (!ListenerUtil.mutListener.listen(7297)) {</span>
<span class="nc" id="L1723">                                                    allIds.add(situationId);</span>
                                                }
<span class="nc bnc" id="L1725" title="All 2 branches missed.">                                                if (!ListenerUtil.mutListener.listen(7298)) {</span>
<span class="nc" id="L1726">                                                    allSituations.add(response.getSituation(situationId));</span>
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
<span class="nc" id="L1738">        return allSituations;</span>
    }

    /**
     * Returns true if the provided currentTime falls within the situation's (i.e., alert's) active
     * windows or if the situation does not provide an active window, and false if the currentTime
     * falls outside of the situation's active windows
     *
     * @param currentTime the time to compare to the situation's windows, in milliseconds between
     *                    the current time and midnight, January 1, 1970 UTC
     * @return true if the provided currentTime falls within the situation's (i.e., alert's) active
     * windows or if the situation does not provide an active window, and false if the currentTime
     * falls outside of the situation's active windows
     */
    public static boolean isActiveWindowForSituation(ObaSituation situation, long currentTime) {
<span class="nc bnc" id="L1753" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7303)) {</span>
<span class="nc bnc" id="L1754" title="All 2 branches missed.">            if (situation.getActiveWindows().length == 0) {</span>
                // We assume a situation is active if it doesn't contain any active window information
<span class="nc" id="L1756">                return true;</span>
            }
        }
        // Active window times are in seconds since epoch
<span class="nc" id="L1760">        long currentTimeSeconds = TimeUnit.MILLISECONDS.toSeconds(currentTime);</span>
<span class="nc" id="L1761">        boolean isActiveWindowForSituation = false;</span>
<span class="nc bnc" id="L1762" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7323)) {</span>
            {
<span class="nc" id="L1764">                long _loopCounter87 = 0;</span>
<span class="nc bnc" id="L1765" title="All 2 branches missed.">                for (ObaSituation.ActiveWindow activeWindow : situation.getActiveWindows()) {</span>
<span class="nc" id="L1766">                    ListenerUtil.loopListener.listen(&quot;_loopCounter87&quot;, ++_loopCounter87);</span>
<span class="nc" id="L1767">                    long from = activeWindow.getFrom();</span>
<span class="nc" id="L1768">                    long to = activeWindow.getTo();</span>
<span class="nc bnc" id="L1769" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7322)) {</span>
                        // 0 is a valid end time that means no end to the window - see #990
<span class="nc bnc" id="L1771" title="All 226 branches missed.">                        if ((ListenerUtil.mutListener.listen(7320) ? ((ListenerUtil.mutListener.listen(7308) ? (from &gt;= currentTimeSeconds) : (ListenerUtil.mutListener.listen(7307) ? (from &gt; currentTimeSeconds) : (ListenerUtil.mutListener.listen(7306) ? (from &lt; currentTimeSeconds) : (ListenerUtil.mutListener.listen(7305) ? (from != currentTimeSeconds) : (ListenerUtil.mutListener.listen(7304) ? (from == currentTimeSeconds) : (from &lt;= currentTimeSeconds)))))) || ((ListenerUtil.mutListener.listen(7319) ? ((ListenerUtil.mutListener.listen(7313) ? (to &gt;= 0) : (ListenerUtil.mutListener.listen(7312) ? (to &lt;= 0) : (ListenerUtil.mutListener.listen(7311) ? (to &gt; 0) : (ListenerUtil.mutListener.listen(7310) ? (to &lt; 0) : (ListenerUtil.mutListener.listen(7309) ? (to != 0) : (to == 0)))))) &amp;&amp; (ListenerUtil.mutListener.listen(7318) ? (currentTimeSeconds &gt;= to) : (ListenerUtil.mutListener.listen(7317) ? (currentTimeSeconds &gt; to) : (ListenerUtil.mutListener.listen(7316) ? (currentTimeSeconds &lt; to) : (ListenerUtil.mutListener.listen(7315) ? (currentTimeSeconds != to) : (ListenerUtil.mutListener.listen(7314) ? (currentTimeSeconds == to) : (currentTimeSeconds &lt;= to))))))) : ((ListenerUtil.mutListener.listen(7313) ? (to &gt;= 0) : (ListenerUtil.mutListener.listen(7312) ? (to &lt;= 0) : (ListenerUtil.mutListener.listen(7311) ? (to &gt; 0) : (ListenerUtil.mutListener.listen(7310) ? (to &lt; 0) : (ListenerUtil.mutListener.listen(7309) ? (to != 0) : (to == 0)))))) || (ListenerUtil.mutListener.listen(7318) ? (currentTimeSeconds &gt;= to) : (ListenerUtil.mutListener.listen(7317) ? (currentTimeSeconds &gt; to) : (ListenerUtil.mutListener.listen(7316) ? (currentTimeSeconds &lt; to) : (ListenerUtil.mutListener.listen(7315) ? (currentTimeSeconds != to) : (ListenerUtil.mutListener.listen(7314) ? (currentTimeSeconds == to) : (currentTimeSeconds &lt;= to)))))))))) : ((ListenerUtil.mutListener.listen(7308) ? (from &gt;= currentTimeSeconds) : (ListenerUtil.mutListener.listen(7307) ? (from &gt; currentTimeSeconds) : (ListenerUtil.mutListener.listen(7306) ? (from &lt; currentTimeSeconds) : (ListenerUtil.mutListener.listen(7305) ? (from != currentTimeSeconds) : (ListenerUtil.mutListener.listen(7304) ? (from == currentTimeSeconds) : (from &lt;= currentTimeSeconds)))))) &amp;&amp; ((ListenerUtil.mutListener.listen(7319) ? ((ListenerUtil.mutListener.listen(7313) ? (to &gt;= 0) : (ListenerUtil.mutListener.listen(7312) ? (to &lt;= 0) : (ListenerUtil.mutListener.listen(7311) ? (to &gt; 0) : (ListenerUtil.mutListener.listen(7310) ? (to &lt; 0) : (ListenerUtil.mutListener.listen(7309) ? (to != 0) : (to == 0)))))) &amp;&amp; (ListenerUtil.mutListener.listen(7318) ? (currentTimeSeconds &gt;= to) : (ListenerUtil.mutListener.listen(7317) ? (currentTimeSeconds &gt; to) : (ListenerUtil.mutListener.listen(7316) ? (currentTimeSeconds &lt; to) : (ListenerUtil.mutListener.listen(7315) ? (currentTimeSeconds != to) : (ListenerUtil.mutListener.listen(7314) ? (currentTimeSeconds == to) : (currentTimeSeconds &lt;= to))))))) : ((ListenerUtil.mutListener.listen(7313) ? (to &gt;= 0) : (ListenerUtil.mutListener.listen(7312) ? (to &lt;= 0) : (ListenerUtil.mutListener.listen(7311) ? (to &gt; 0) : (ListenerUtil.mutListener.listen(7310) ? (to &lt; 0) : (ListenerUtil.mutListener.listen(7309) ? (to != 0) : (to == 0)))))) || (ListenerUtil.mutListener.listen(7318) ? (currentTimeSeconds &gt;= to) : (ListenerUtil.mutListener.listen(7317) ? (currentTimeSeconds &gt; to) : (ListenerUtil.mutListener.listen(7316) ? (currentTimeSeconds &lt; to) : (ListenerUtil.mutListener.listen(7315) ? (currentTimeSeconds != to) : (ListenerUtil.mutListener.listen(7314) ? (currentTimeSeconds == to) : (currentTimeSeconds &lt;= to)))))))))))) {</span>
<span class="nc bnc" id="L1772" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7321)) {</span>
<span class="nc" id="L1773">                                isActiveWindowForSituation = true;</span>
                            }
                            break;
                        }
                    }
                }
            }
        }
<span class="nc" id="L1781">        return isActiveWindowForSituation;</span>
    }

    /**
     * Returns the time formatting as &quot;1:10pm&quot; to be displayed as an absolute time for an
     * arrival/departure
     *
     * @param time an arrival or departure time (e.g., from ArrivalInfo)
     * @return the time formatting as &quot;1:10pm&quot; to be displayed as an absolute time for an
     * arrival/departure
     */
    public static String formatTime(Context context, long time) {
<span class="nc" id="L1793">        return DateUtils.formatDateTime(context, time, DateUtils.FORMAT_SHOW_TIME | DateUtils.FORMAT_NO_NOON | DateUtils.FORMAT_NO_MIDNIGHT);</span>
    }

    /**
     * Set smaller text size if the route short name has more than 3 characters
     *
     * @param view Text view
     * @param routeShortName Route short name
     */
    public static void maybeShrinkRouteName(Context context, TextView view, String routeShortName) {
<span class="nc bnc" id="L1803" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7341)) {</span>
<span class="nc bnc" id="L1804" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(7328) ? (routeShortName.length() &gt;= 4) : (ListenerUtil.mutListener.listen(7327) ? (routeShortName.length() &lt;= 4) : (ListenerUtil.mutListener.listen(7326) ? (routeShortName.length() &gt; 4) : (ListenerUtil.mutListener.listen(7325) ? (routeShortName.length() != 4) : (ListenerUtil.mutListener.listen(7324) ? (routeShortName.length() == 4) : (routeShortName.length() &lt; 4))))))) {</span>
                // No-op if text is short enough to fit
<span class="nc" id="L1806">                return;</span>
<span class="nc bnc" id="L1807" title="All 22 branches missed.">            } else if ((ListenerUtil.mutListener.listen(7333) ? (routeShortName.length() &gt;= 4) : (ListenerUtil.mutListener.listen(7332) ? (routeShortName.length() &lt;= 4) : (ListenerUtil.mutListener.listen(7331) ? (routeShortName.length() &gt; 4) : (ListenerUtil.mutListener.listen(7330) ? (routeShortName.length() &lt; 4) : (ListenerUtil.mutListener.listen(7329) ? (routeShortName.length() != 4) : (routeShortName.length() == 4))))))) {</span>
<span class="nc bnc" id="L1808" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7340)) {</span>
<span class="nc" id="L1809">                    view.setTextSize(TypedValue.COMPLEX_UNIT_PX, context.getResources().getDimension(R.dimen.route_name_text_size_medium));</span>
                }
<span class="nc bnc" id="L1811" title="All 22 branches missed.">            } else if ((ListenerUtil.mutListener.listen(7338) ? (routeShortName.length() &gt;= 4) : (ListenerUtil.mutListener.listen(7337) ? (routeShortName.length() &lt;= 4) : (ListenerUtil.mutListener.listen(7336) ? (routeShortName.length() &lt; 4) : (ListenerUtil.mutListener.listen(7335) ? (routeShortName.length() != 4) : (ListenerUtil.mutListener.listen(7334) ? (routeShortName.length() == 4) : (routeShortName.length() &gt; 4))))))) {</span>
<span class="nc bnc" id="L1812" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7339)) {</span>
<span class="nc" id="L1813">                    view.setTextSize(TypedValue.COMPLEX_UNIT_PX, context.getResources().getDimension(R.dimen.route_name_text_size_small));</span>
                }
            }
        }
<span class="nc" id="L1817">    }</span>

    /**
     * Transforms a given opaque color into the same color but with the given alpha value
     *
     * @param solidColor hex color value that is completely opaque
     * @param alpha      Specify an alpha value. 0 means fully transparent, and 255 means fully
     *                   opaque.
     * @return the provided color with the given alpha value
     */
    public static int getTransparentColor(int solidColor, int alpha) {
<span class="nc" id="L1828">        int r = Color.red(solidColor);</span>
<span class="nc" id="L1829">        int g = Color.green(solidColor);</span>
<span class="nc" id="L1830">        int b = Color.blue(solidColor);</span>
<span class="nc" id="L1831">        return Color.argb(alpha, r, g, b);</span>
    }

    /**
     * Returns the location of the map center if it has been previously saved in the bundle, or
     * null if it wasn't saved in the bundle.
     *
     * @param b bundle to check for the map center
     * @return the location of the map center if it has been previously saved in the bundle, or null
     * if it wasn't saved in the bundle.
     */
    public static Location getMapCenter(Bundle b) {
<span class="nc bnc" id="L1843" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7342)) {</span>
<span class="nc bnc" id="L1844" title="All 2 branches missed.">            if (b == null) {</span>
<span class="nc" id="L1845">                return null;</span>
            }
        }
<span class="nc" id="L1848">        Location center = null;</span>
<span class="nc" id="L1849">        double lat = b.getDouble(MapParams.CENTER_LAT);</span>
<span class="nc" id="L1850">        double lon = b.getDouble(MapParams.CENTER_LON);</span>
<span class="nc bnc" id="L1851" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7355)) {</span>
<span class="nc bnc" id="L1852" title="All 90 branches missed.">            if ((ListenerUtil.mutListener.listen(7353) ? ((ListenerUtil.mutListener.listen(7347) ? (lat &gt;= 0.0) : (ListenerUtil.mutListener.listen(7346) ? (lat &lt;= 0.0) : (ListenerUtil.mutListener.listen(7345) ? (lat &gt; 0.0) : (ListenerUtil.mutListener.listen(7344) ? (lat &lt; 0.0) : (ListenerUtil.mutListener.listen(7343) ? (lat == 0.0) : (lat != 0.0)))))) || (ListenerUtil.mutListener.listen(7352) ? (lon &gt;= 0.0) : (ListenerUtil.mutListener.listen(7351) ? (lon &lt;= 0.0) : (ListenerUtil.mutListener.listen(7350) ? (lon &gt; 0.0) : (ListenerUtil.mutListener.listen(7349) ? (lon &lt; 0.0) : (ListenerUtil.mutListener.listen(7348) ? (lon == 0.0) : (lon != 0.0))))))) : ((ListenerUtil.mutListener.listen(7347) ? (lat &gt;= 0.0) : (ListenerUtil.mutListener.listen(7346) ? (lat &lt;= 0.0) : (ListenerUtil.mutListener.listen(7345) ? (lat &gt; 0.0) : (ListenerUtil.mutListener.listen(7344) ? (lat &lt; 0.0) : (ListenerUtil.mutListener.listen(7343) ? (lat == 0.0) : (lat != 0.0)))))) &amp;&amp; (ListenerUtil.mutListener.listen(7352) ? (lon &gt;= 0.0) : (ListenerUtil.mutListener.listen(7351) ? (lon &lt;= 0.0) : (ListenerUtil.mutListener.listen(7350) ? (lon &gt; 0.0) : (ListenerUtil.mutListener.listen(7349) ? (lon &lt; 0.0) : (ListenerUtil.mutListener.listen(7348) ? (lon == 0.0) : (lon != 0.0))))))))) {</span>
<span class="nc bnc" id="L1853" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7354)) {</span>
<span class="nc" id="L1854">                    center = LocationUtils.makeLocation(lat, lon);</span>
                }
            }
        }
<span class="nc" id="L1858">        return center;</span>
    }

    /**
     * Creates a JPEG image file with the current date/time as the name
     *
     * @param nameSuffix A string that will be added to the end of the file name, or null if
     *                   nothing
     *                   should be added
     * @return a JPEG image file with the current date/time as the name
     */
    public static File createImageFile(Context context, String nameSuffix) throws IOException {
        // Create an image file name
<span class="nc" id="L1871">        String timeStamp = new SimpleDateFormat(&quot;yyyyMMdd_HHmmss&quot;).format(new Date());</span>
<span class="nc" id="L1872">        StringBuilder imageFileName = new StringBuilder();</span>
<span class="nc bnc" id="L1873" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7356)) {</span>
<span class="nc" id="L1874">            imageFileName.append(&quot;JPEG_&quot;);</span>
        }
<span class="nc bnc" id="L1876" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7357)) {</span>
<span class="nc" id="L1877">            imageFileName.append(timeStamp);</span>
        }
<span class="nc bnc" id="L1879" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7358)) {</span>
<span class="nc" id="L1880">            imageFileName.append(&quot;_&quot;);</span>
        }
<span class="nc bnc" id="L1882" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7360)) {</span>
<span class="nc bnc" id="L1883" title="All 2 branches missed.">            if (nameSuffix != null) {</span>
<span class="nc bnc" id="L1884" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7359)) {</span>
<span class="nc" id="L1885">                    imageFileName.append(nameSuffix);</span>
                }
            }
        }
<span class="nc" id="L1889">        File storageDir = context.getExternalFilesDir(Environment.DIRECTORY_PICTURES);</span>
<span class="nc" id="L1890">        return File.createTempFile(imageFileName.toString(), /* prefix */</span>
        &quot;.jpg&quot;, /* suffix */
        storageDir);
    }

    /**
     * Decode a smaller sampled bitmap given a large bitmap.
     * Adapted from https://developer.android.com/training/displaying-bitmaps/load-bitmap.html and
     * http://stackoverflow.com/a/31720143/937715.
     *
     * @param pathName  path to the full size image file
     * @param reqWidth  desired width
     * @param reqHeight desired height
     * @return a smaller version of the image at pathName, given the desired width and height
     */
    public static Bitmap decodeSampledBitmapFromFile(String pathName, int reqWidth, int reqHeight) throws IOException {
        // First decode with inJustDecodeBounds=true to check dimensions
<span class="nc" id="L1907">        final BitmapFactory.Options options = new BitmapFactory.Options();</span>
<span class="nc bnc" id="L1908" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7361)) {</span>
<span class="nc" id="L1909">            options.inJustDecodeBounds = true;</span>
        }
<span class="nc bnc" id="L1911" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7362)) {</span>
<span class="nc" id="L1912">            BitmapFactory.decodeFile(pathName, options);</span>
        }
<span class="nc bnc" id="L1914" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7363)) {</span>
            // Calculate inSampleSize
<span class="nc" id="L1916">            options.inSampleSize = calculateInSampleSize(options, reqWidth, reqHeight);</span>
        }
<span class="nc bnc" id="L1918" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7364)) {</span>
            // Decode bitmap with inSampleSize set
<span class="nc" id="L1920">            options.inJustDecodeBounds = false;</span>
        }
<span class="nc" id="L1922">        Bitmap b = BitmapFactory.decodeFile(pathName, options);</span>
<span class="nc" id="L1923">        return rotateImageIfRequired(b, pathName);</span>
    }

    /**
     * Calculate an inSampleSize for use in a {@link BitmapFactory.Options} object when decoding
     * bitmaps using the decode* methods from {@link BitmapFactory}. This implementation calculates
     * the closest inSampleSize that will result in the final decoded bitmap having a width and
     * height equal to or larger than the requested width and height. This implementation does not
     * ensure a power of 2 is returned for inSampleSize which can be faster when decoding but
     * results in a larger bitmap which isn't as useful for caching purposes.
     *
     * From http://stackoverflow.com/a/31720143/937715.
     *
     * @param options   An options object with out* params already populated (run through a decode*
     *                  method with inJustDecodeBounds==true
     * @param reqWidth  The requested width of the resulting bitmap
     * @param reqHeight The requested height of the resulting bitmap
     * @return The value to be used for inSampleSize
     */
    private static int calculateInSampleSize(BitmapFactory.Options options, int reqWidth, int reqHeight) {
        // Raw height and width of image
<span class="nc" id="L1944">        final int height = options.outHeight;</span>
<span class="nc" id="L1945">        final int width = options.outWidth;</span>
<span class="nc" id="L1946">        int inSampleSize = 1;</span>
<span class="nc bnc" id="L1947" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7417)) {</span>
<span class="nc bnc" id="L1948" title="All 90 branches missed.">            if ((ListenerUtil.mutListener.listen(7375) ? ((ListenerUtil.mutListener.listen(7369) ? (height &gt;= reqHeight) : (ListenerUtil.mutListener.listen(7368) ? (height &lt;= reqHeight) : (ListenerUtil.mutListener.listen(7367) ? (height &lt; reqHeight) : (ListenerUtil.mutListener.listen(7366) ? (height != reqHeight) : (ListenerUtil.mutListener.listen(7365) ? (height == reqHeight) : (height &gt; reqHeight)))))) &amp;&amp; (ListenerUtil.mutListener.listen(7374) ? (width &gt;= reqWidth) : (ListenerUtil.mutListener.listen(7373) ? (width &lt;= reqWidth) : (ListenerUtil.mutListener.listen(7372) ? (width &lt; reqWidth) : (ListenerUtil.mutListener.listen(7371) ? (width != reqWidth) : (ListenerUtil.mutListener.listen(7370) ? (width == reqWidth) : (width &gt; reqWidth))))))) : ((ListenerUtil.mutListener.listen(7369) ? (height &gt;= reqHeight) : (ListenerUtil.mutListener.listen(7368) ? (height &lt;= reqHeight) : (ListenerUtil.mutListener.listen(7367) ? (height &lt; reqHeight) : (ListenerUtil.mutListener.listen(7366) ? (height != reqHeight) : (ListenerUtil.mutListener.listen(7365) ? (height == reqHeight) : (height &gt; reqHeight)))))) || (ListenerUtil.mutListener.listen(7374) ? (width &gt;= reqWidth) : (ListenerUtil.mutListener.listen(7373) ? (width &lt;= reqWidth) : (ListenerUtil.mutListener.listen(7372) ? (width &lt; reqWidth) : (ListenerUtil.mutListener.listen(7371) ? (width != reqWidth) : (ListenerUtil.mutListener.listen(7370) ? (width == reqWidth) : (width &gt; reqWidth))))))))) {</span>
                // Calculate ratios of height and width to requested height and width
<span class="nc bnc" id="L1950" title="All 8 branches missed.">                final int heightRatio = Math.round((ListenerUtil.mutListener.listen(7379) ? ((float) height % (float) reqHeight) : (ListenerUtil.mutListener.listen(7378) ? ((float) height * (float) reqHeight) : (ListenerUtil.mutListener.listen(7377) ? ((float) height - (float) reqHeight) : (ListenerUtil.mutListener.listen(7376) ? ((float) height + (float) reqHeight) : ((float) height / (float) reqHeight))))));</span>
<span class="nc bnc" id="L1951" title="All 8 branches missed.">                final int widthRatio = Math.round((ListenerUtil.mutListener.listen(7383) ? ((float) width % (float) reqWidth) : (ListenerUtil.mutListener.listen(7382) ? ((float) width * (float) reqWidth) : (ListenerUtil.mutListener.listen(7381) ? ((float) width - (float) reqWidth) : (ListenerUtil.mutListener.listen(7380) ? ((float) width + (float) reqWidth) : ((float) width / (float) reqWidth))))));</span>
<span class="nc bnc" id="L1952" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7389)) {</span>
                    // with both dimensions larger than or equal to the requested height and width.
<span class="nc bnc" id="L1954" title="All 22 branches missed.">                    inSampleSize = (ListenerUtil.mutListener.listen(7388) ? (heightRatio &gt;= widthRatio) : (ListenerUtil.mutListener.listen(7387) ? (heightRatio &lt;= widthRatio) : (ListenerUtil.mutListener.listen(7386) ? (heightRatio &gt; widthRatio) : (ListenerUtil.mutListener.listen(7385) ? (heightRatio != widthRatio) : (ListenerUtil.mutListener.listen(7384) ? (heightRatio == widthRatio) : (heightRatio &lt; widthRatio)))))) ? heightRatio : widthRatio;</span>
                }
<span class="nc bnc" id="L1956" title="All 8 branches missed.">                final float totalPixels = (ListenerUtil.mutListener.listen(7393) ? (width % height) : (ListenerUtil.mutListener.listen(7392) ? (width / height) : (ListenerUtil.mutListener.listen(7391) ? (width - height) : (ListenerUtil.mutListener.listen(7390) ? (width + height) : (width * height)))));</span>
                // Anything more than 2x the requested pixels we'll sample down further
<span class="nc bnc" id="L1958" title="All 48 branches missed.">                final float totalReqPixelsCap = (ListenerUtil.mutListener.listen(7401) ? ((ListenerUtil.mutListener.listen(7397) ? (reqWidth % reqHeight) : (ListenerUtil.mutListener.listen(7396) ? (reqWidth / reqHeight) : (ListenerUtil.mutListener.listen(7395) ? (reqWidth - reqHeight) : (ListenerUtil.mutListener.listen(7394) ? (reqWidth + reqHeight) : (reqWidth * reqHeight))))) % 2) : (ListenerUtil.mutListener.listen(7400) ? ((ListenerUtil.mutListener.listen(7397) ? (reqWidth % reqHeight) : (ListenerUtil.mutListener.listen(7396) ? (reqWidth / reqHeight) : (ListenerUtil.mutListener.listen(7395) ? (reqWidth - reqHeight) : (ListenerUtil.mutListener.listen(7394) ? (reqWidth + reqHeight) : (reqWidth * reqHeight))))) / 2) : (ListenerUtil.mutListener.listen(7399) ? ((ListenerUtil.mutListener.listen(7397) ? (reqWidth % reqHeight) : (ListenerUtil.mutListener.listen(7396) ? (reqWidth / reqHeight) : (ListenerUtil.mutListener.listen(7395) ? (reqWidth - reqHeight) : (ListenerUtil.mutListener.listen(7394) ? (reqWidth + reqHeight) : (reqWidth * reqHeight))))) - 2) : (ListenerUtil.mutListener.listen(7398) ? ((ListenerUtil.mutListener.listen(7397) ? (reqWidth % reqHeight) : (ListenerUtil.mutListener.listen(7396) ? (reqWidth / reqHeight) : (ListenerUtil.mutListener.listen(7395) ? (reqWidth - reqHeight) : (ListenerUtil.mutListener.listen(7394) ? (reqWidth + reqHeight) : (reqWidth * reqHeight))))) + 2) : ((ListenerUtil.mutListener.listen(7397) ? (reqWidth % reqHeight) : (ListenerUtil.mutListener.listen(7396) ? (reqWidth / reqHeight) : (ListenerUtil.mutListener.listen(7395) ? (reqWidth - reqHeight) : (ListenerUtil.mutListener.listen(7394) ? (reqWidth + reqHeight) : (reqWidth * reqHeight))))) * 2)))));</span>
<span class="nc bnc" id="L1959" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7416)) {</span>
                    {
<span class="nc" id="L1961">                        long _loopCounter88 = 0;</span>
<span class="nc bnc" id="L1962" title="All 310 branches missed.">                        while ((ListenerUtil.mutListener.listen(7415) ? ((ListenerUtil.mutListener.listen(7410) ? (totalPixels % ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (ListenerUtil.mutListener.listen(7409) ? (totalPixels * ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (ListenerUtil.mutListener.listen(7408) ? (totalPixels - ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (ListenerUtil.mutListener.listen(7407) ? (totalPixels + ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (totalPixels / ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))))))) &gt;= totalReqPixelsCap) : (ListenerUtil.mutListener.listen(7414) ? ((ListenerUtil.mutListener.listen(7410) ? (totalPixels % ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (ListenerUtil.mutListener.listen(7409) ? (totalPixels * ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (ListenerUtil.mutListener.listen(7408) ? (totalPixels - ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (ListenerUtil.mutListener.listen(7407) ? (totalPixels + ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (totalPixels / ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))))))) &lt;= totalReqPixelsCap) : (ListenerUtil.mutListener.listen(7413) ? ((ListenerUtil.mutListener.listen(7410) ? (totalPixels % ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (ListenerUtil.mutListener.listen(7409) ? (totalPixels * ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (ListenerUtil.mutListener.listen(7408) ? (totalPixels - ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (ListenerUtil.mutListener.listen(7407) ? (totalPixels + ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (totalPixels / ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))))))) &lt; totalReqPixelsCap) : (ListenerUtil.mutListener.listen(7412) ? ((ListenerUtil.mutListener.listen(7410) ? (totalPixels % ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (ListenerUtil.mutListener.listen(7409) ? (totalPixels * ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (ListenerUtil.mutListener.listen(7408) ? (totalPixels - ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (ListenerUtil.mutListener.listen(7407) ? (totalPixels + ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (totalPixels / ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))))))) != totalReqPixelsCap) : (ListenerUtil.mutListener.listen(7411) ? ((ListenerUtil.mutListener.listen(7410) ? (totalPixels % ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (ListenerUtil.mutListener.listen(7409) ? (totalPixels * ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (ListenerUtil.mutListener.listen(7408) ? (totalPixels - ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (ListenerUtil.mutListener.listen(7407) ? (totalPixels + ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (totalPixels / ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))))))) == totalReqPixelsCap) : ((ListenerUtil.mutListener.listen(7410) ? (totalPixels % ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (ListenerUtil.mutListener.listen(7409) ? (totalPixels * ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (ListenerUtil.mutListener.listen(7408) ? (totalPixels - ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (ListenerUtil.mutListener.listen(7407) ? (totalPixels + ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))) : (totalPixels / ((ListenerUtil.mutListener.listen(7406) ? (inSampleSize % inSampleSize) : (ListenerUtil.mutListener.listen(7405) ? (inSampleSize / inSampleSize) : (ListenerUtil.mutListener.listen(7404) ? (inSampleSize - inSampleSize) : (ListenerUtil.mutListener.listen(7403) ? (inSampleSize + inSampleSize) : (inSampleSize * inSampleSize))))))))))) &gt; totalReqPixelsCap))))))) {</span>
<span class="nc" id="L1963">                            ListenerUtil.loopListener.listen(&quot;_loopCounter88&quot;, ++_loopCounter88);</span>
<span class="nc bnc" id="L1964" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7402)) {</span>
<span class="nc" id="L1965">                                inSampleSize++;</span>
                            }
                        }
                    }
                }
            }
        }
<span class="nc" id="L1972">        return inSampleSize;</span>
    }

    /**
     * Rotate an image if required.
     *
     * @param img       The image bitmap
     * @param imagePath Path to image
     * @return The resulted Bitmap after manipulation
     */
    private static Bitmap rotateImageIfRequired(Bitmap img, String imagePath) throws IOException {
<span class="nc" id="L1983">        ExifInterface ei = new ExifInterface(imagePath);</span>
<span class="nc" id="L1984">        int orientation = ei.getAttributeInt(ExifInterface.TAG_ORIENTATION, ExifInterface.ORIENTATION_NORMAL);</span>
<span class="nc bnc" id="L1985" title="All 4 branches missed.">        switch(orientation) {</span>
            case ExifInterface.ORIENTATION_ROTATE_90:
<span class="nc" id="L1987">                return rotateImage(img, 90);</span>
            case ExifInterface.ORIENTATION_ROTATE_180:
<span class="nc" id="L1989">                return rotateImage(img, 180);</span>
            case ExifInterface.ORIENTATION_ROTATE_270:
<span class="nc" id="L1991">                return rotateImage(img, 270);</span>
            default:
<span class="nc" id="L1993">                return img;</span>
        }
    }

    /**
     * Rotate the given bitmap
     *
     * @param img    image to rotate
     * @param degree number of degrees to rotate, from 0-360
     * @return the provided bitmap rotated by the given number of degrees
     */
    private static Bitmap rotateImage(Bitmap img, int degree) {
<span class="nc" id="L2005">        Matrix matrix = new Matrix();</span>
<span class="nc bnc" id="L2006" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7418)) {</span>
<span class="nc" id="L2007">            matrix.postRotate(degree);</span>
        }
<span class="nc" id="L2009">        Bitmap rotatedImg = Bitmap.createBitmap(img, 0, 0, img.getWidth(), img.getHeight(), matrix, true);</span>
<span class="nc bnc" id="L2010" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7419)) {</span>
<span class="nc" id="L2011">            img.recycle();</span>
        }
<span class="nc" id="L2013">        return rotatedImg;</span>
    }

    /**
     * Launches the fare payment app for the currently selected region if the payment app is
     * installed, otherwise directs the user to the Google Play store listing to download it.  If
     * a region has a fare payment app warning, it will show the warning before checking if the app
     * is installed, unless the user has opted out of the warning.
     * If the current region is null (i.e., if a custom API URL is entered), then no-op.
     * @param activity activity to launch the fare payment app or Google Play store from
     */
    public static void launchPayMyFareApp(@NonNull Activity activity) {
<span class="nc" id="L2025">        ObaRegion region = Application.get().getCurrentRegion();</span>
<span class="nc bnc" id="L2026" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7420)) {</span>
<span class="nc bnc" id="L2027" title="All 2 branches missed.">            if (region == null) {</span>
                // If a custom API URL is set (i.e., no region), then no op
<span class="nc" id="L2029">                return;</span>
            }
        }
<span class="nc bnc" id="L2032" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7426)) {</span>
<span class="nc bnc" id="L2033" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(7421) ? (!TextUtils.isEmpty(region.getPaymentWarningTitle()) &amp;&amp; !TextUtils.isEmpty(region.getPaymentWarningBody())) : (!TextUtils.isEmpty(region.getPaymentWarningTitle()) || !TextUtils.isEmpty(region.getPaymentWarningBody())))) {</span>
<span class="nc bnc" id="L2034" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7425)) {</span>
                    // Region has a warning for using the payment app
<span class="nc bnc" id="L2036" title="All 2 branches missed.">                    if (!Application.getPrefs().getBoolean(activity.getString(R.string.preference_key_never_show_payment_warning_dialog), false)) {</span>
<span class="nc bnc" id="L2037" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7424)) {</span>
                            // User hasn't opted out of warning dialog yet - show the dialog
<span class="nc" id="L2039">                            showPaymentWarningDialog(activity, region);</span>
                        }
                    } else {
<span class="nc bnc" id="L2042" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7423)) {</span>
                            // User opted out of warning - start the Intent
<span class="nc" id="L2044">                            startPaymentIntent(activity, region);</span>
                        }
                    }
                }
            } else {
<span class="nc bnc" id="L2049" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7422)) {</span>
                    // No payment warning for this region - start the Intent
<span class="nc" id="L2051">                    startPaymentIntent(activity, region);</span>
                }
            }
        }
<span class="nc" id="L2055">    }</span>

    /**
     * Launches the payment app for the provided region if it's already installed, and if not
     * directs the user to the listing in Google Play where it can be downloaded
     * @param activity Activity to use to launch the Intent
     * @param region region to launch a payment Intent for
     */
    private static void startPaymentIntent(@NonNull Activity activity, @NonNull ObaRegion region) {
<span class="nc" id="L2064">        PackageManager manager = activity.getPackageManager();</span>
<span class="nc" id="L2065">        Intent intent = manager.getLaunchIntentForPackage(region.getPaymentAndroidAppId());</span>
<span class="nc bnc" id="L2066" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7434)) {</span>
<span class="nc bnc" id="L2067" title="All 2 branches missed.">            if (intent != null) {</span>
<span class="nc bnc" id="L2068" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7431)) {</span>
                    // Launch installed app
<span class="nc" id="L2070">                    intent.addCategory(Intent.CATEGORY_LAUNCHER);</span>
                }
<span class="nc bnc" id="L2072" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7432)) {</span>
<span class="nc" id="L2073">                    activity.startActivity(intent);</span>
                }
<span class="nc bnc" id="L2075" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7433)) {</span>
<span class="nc" id="L2076">                    ObaAnalytics.reportUiEvent(FirebaseAnalytics.getInstance(activity), Application.get().getString(R.string.analytics_label_button_fare_payment), Application.get().getString(R.string.analytics_label_open_app));</span>
                }
            } else {
<span class="nc bnc" id="L2079" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7427)) {</span>
                    // Go to Play Store listing to download app
<span class="nc" id="L2081">                    intent = new Intent(Intent.ACTION_VIEW);</span>
                }
<span class="nc bnc" id="L2083" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7428)) {</span>
<span class="nc" id="L2084">                    intent.setData(Uri.parse(Application.get().getString(R.string.google_play_listing_prefix, region.getPaymentAndroidAppId())));</span>
                }
<span class="nc bnc" id="L2086" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7429)) {</span>
<span class="nc" id="L2087">                    activity.startActivity(intent);</span>
                }
<span class="nc bnc" id="L2089" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7430)) {</span>
<span class="nc" id="L2090">                    ObaAnalytics.reportUiEvent(FirebaseAnalytics.getInstance(activity), Application.get().getString(R.string.analytics_label_button_fare_payment), Application.get().getString(R.string.analytics_label_download_app));</span>
                }
            }
        }
<span class="nc" id="L2094">    }</span>

    /**
     * Shows the payment warning to the user for the provided region if the user hasn't already
     * opted out of the warning, and then calls the method to create the correct payment Intent.
     * If the user has opted out of the warning, just call the method to create the payment Intent
     * @param activity Activity to use to launch the Intent
     * @param region region to launch a payment Intent for
     */
    private static void showPaymentWarningDialog(@NonNull Activity activity, @NonNull ObaRegion region) {
<span class="nc" id="L2104">        View view = activity.getLayoutInflater().inflate(R.layout.payment_warning_dialog, null);</span>
<span class="nc" id="L2105">        CheckBox neverShowDialog = view.findViewById(R.id.payment_warning_never_ask_again);</span>
<span class="nc" id="L2106">        TextView warningBody = view.findViewById(R.id.payment_warning_body);</span>
<span class="nc bnc" id="L2107" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7435)) {</span>
<span class="nc" id="L2108">            neverShowDialog.setOnCheckedChangeListener((compoundButton, isChecked) -&gt; {</span>
                // Save the preference
<span class="nc" id="L2110">                PreferenceUtils.saveBoolean(activity.getString(R.string.preference_key_never_show_payment_warning_dialog), isChecked);</span>
<span class="nc" id="L2111">            });</span>
        }
<span class="nc bnc" id="L2113" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7436)) {</span>
<span class="nc" id="L2114">            warningBody.setText(region.getPaymentWarningBody());</span>
        }
<span class="nc" id="L2116">        Drawable icon = activity.getResources().getDrawable(android.R.drawable.ic_dialog_alert);</span>
<span class="nc bnc" id="L2117" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7437)) {</span>
<span class="nc" id="L2118">            DrawableCompat.setTint(icon, activity.getResources().getColor(R.color.alert_icon_error));</span>
        }
<span class="nc" id="L2120">        androidx.appcompat.app.AlertDialog.Builder builder = new androidx.appcompat.app.AlertDialog.Builder(activity).setTitle(region.getPaymentWarningTitle()).setIcon(icon).setCancelable(false).setView(view).setPositiveButton(R.string.ok, (dialog, which) -&gt; startPaymentIntent(activity, region));</span>
<span class="nc bnc" id="L2121" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7438)) {</span>
<span class="nc" id="L2122">            builder.create().show();</span>
        }
<span class="nc" id="L2124">    }</span>

    /**
     * Launches the HOPR bikeshare app for Tampa if the app is installed, otherwise directs the user
     * to the Google Play store listing to download it.
     *
     * @param context context to launch the fare payment app or Google Play store from
     */
    public static void launchTampaHoprApp(@NonNull Context context) {
<span class="nc" id="L2133">        PackageManager manager = context.getPackageManager();</span>
<span class="nc" id="L2134">        Intent intent = manager.getLaunchIntentForPackage(context.getString(R.string.hopr_android_app_id));</span>
<span class="nc bnc" id="L2135" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7446)) {</span>
<span class="nc bnc" id="L2136" title="All 2 branches missed.">            if (intent != null) {</span>
<span class="nc bnc" id="L2137" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7443)) {</span>
                    // Launch installed app
<span class="nc" id="L2139">                    intent.addCategory(Intent.CATEGORY_LAUNCHER);</span>
                }
<span class="nc bnc" id="L2141" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7444)) {</span>
<span class="nc" id="L2142">                    context.startActivity(intent);</span>
                }
<span class="nc bnc" id="L2144" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7445)) {</span>
<span class="nc" id="L2145">                    ObaAnalytics.reportUiEvent(FirebaseAnalytics.getInstance(context), Application.get().getString(R.string.analytics_label_button_bike_share), Application.get().getString(R.string.analytics_label_open_app));</span>
                }
            } else {
<span class="nc bnc" id="L2148" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7439)) {</span>
                    // Go to Play Store listing to download app
<span class="nc" id="L2150">                    intent = new Intent(Intent.ACTION_VIEW);</span>
                }
<span class="nc bnc" id="L2152" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7440)) {</span>
<span class="nc" id="L2153">                    intent.setData(Uri.parse(Application.get().getString(R.string.google_play_listing_prefix, context.getString(R.string.hopr_android_app_id))));</span>
                }
<span class="nc bnc" id="L2155" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7441)) {</span>
<span class="nc" id="L2156">                    context.startActivity(intent);</span>
                }
<span class="nc bnc" id="L2158" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7442)) {</span>
<span class="nc" id="L2159">                    ObaAnalytics.reportUiEvent(FirebaseAnalytics.getInstance(context), Application.get().getString(R.string.analytics_label_button_bike_share), Application.get().getString(R.string.analytics_label_download_app));</span>
                }
            }
        }
<span class="nc" id="L2163">    }</span>

    /**
     * Sets the visibility and colors of the silhouettes in the provided occupancy.xml viewgroup
     *  @param v         occupancy.xml layout viewgroup containing the silhouettes
     * @param occupancy the occupancy value to use to set the silhouette visibility
     * @param occupancyState the state of the occupancy to use to set the silhouette color
     */
    public static void setOccupancyVisibilityAndColor(ViewGroup v, Occupancy occupancy, OccupancyState occupancyState) {
<span class="nc" id="L2172">        ImageView silhouette1 = v.findViewById(R.id.silhouette1);</span>
<span class="nc bnc" id="L2173" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7447)) {</span>
<span class="nc" id="L2174">            silhouette1.setVisibility(View.INVISIBLE);</span>
        }
<span class="nc" id="L2176">        ImageView silhouette2 = v.findViewById(R.id.silhouette2);</span>
<span class="nc bnc" id="L2177" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7448)) {</span>
<span class="nc" id="L2178">            silhouette2.setVisibility(View.INVISIBLE);</span>
        }
<span class="nc" id="L2180">        ImageView silhouette3 = v.findViewById(R.id.silhouette3);</span>
<span class="nc bnc" id="L2181" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7449)) {</span>
<span class="nc" id="L2182">            silhouette3.setVisibility(View.INVISIBLE);</span>
        }
<span class="nc bnc" id="L2184" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7452)) {</span>
            // Hide the entire view group if occupancy is null
<span class="nc bnc" id="L2186" title="All 2 branches missed.">            if (occupancy == null) {</span>
<span class="nc bnc" id="L2187" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7451)) {</span>
<span class="nc" id="L2188">                    v.setVisibility(View.GONE);</span>
                }
<span class="nc" id="L2190">                return;</span>
            } else {
<span class="nc bnc" id="L2192" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7450)) {</span>
<span class="nc" id="L2193">                    v.setVisibility(View.VISIBLE);</span>
                }
            }
        }
<span class="nc" id="L2197">        int silhouetteColor = Application.get().getResources().getColor(R.color.stop_info_occupancy);</span>
<span class="nc" id="L2198">        int backgroundColor = Application.get().getResources().getColor(R.color.stop_info_occupancy_background);</span>
<span class="nc bnc" id="L2199" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7457)) {</span>
<span class="nc bnc" id="L2200" title="All 2 branches missed.">            if (occupancyState == OccupancyState.HISTORICAL) {</span>
                // Set the alpha for historical occupancy to 60%
<span class="nc" id="L2202">                float alpha = 0.6f;</span>
<span class="nc bnc" id="L2203" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7453)) {</span>
<span class="nc" id="L2204">                    v.setAlpha(alpha);</span>
                }
<span class="nc bnc" id="L2206" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7454)) {</span>
<span class="nc" id="L2207">                    silhouette1.setAlpha(alpha);</span>
                }
<span class="nc bnc" id="L2209" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7455)) {</span>
<span class="nc" id="L2210">                    silhouette2.setAlpha(alpha);</span>
                }
<span class="nc bnc" id="L2212" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7456)) {</span>
<span class="nc" id="L2213">                    silhouette3.setAlpha(alpha);</span>
                }
            }
        }
<span class="nc bnc" id="L2217" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7462)) {</span>
            // Below switch continues into following cases to minimize number of setVisibility() calls
<span class="nc bnc" id="L2219" title="All 5 branches missed.">            switch(occupancy) {</span>
                case NOT_ACCEPTING_PASSENGERS:
                // 3 icons
                case FULL:
                // 3 icons
                case CRUSHED_STANDING_ROOM_ONLY:
<span class="nc bnc" id="L2225" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7458)) {</span>
                        // 3 icons
<span class="nc" id="L2227">                        silhouette3.setVisibility(View.VISIBLE);</span>
                    }
                case STANDING_ROOM_ONLY:
<span class="nc bnc" id="L2230" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7459)) {</span>
                        // 2 icons
<span class="nc" id="L2232">                        silhouette2.setVisibility(View.VISIBLE);</span>
                    }
                case FEW_SEATS_AVAILABLE:
<span class="nc bnc" id="L2235" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7460)) {</span>
                        // 2 icons
<span class="nc" id="L2237">                        silhouette2.setVisibility(View.VISIBLE);</span>
                    }
                case MANY_SEATS_AVAILABLE:
<span class="nc bnc" id="L2240" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7461)) {</span>
                        // 1 icon
<span class="nc" id="L2242">                        silhouette1.setVisibility(View.VISIBLE);</span>
                    }
                case EMPTY:
            }
        }
<span class="nc bnc" id="L2247" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7463)) {</span>
            // Set silhouette colors
<span class="nc" id="L2249">            ImageViewCompat.setImageTintList(silhouette1, ColorStateList.valueOf(silhouetteColor));</span>
        }
<span class="nc bnc" id="L2251" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7464)) {</span>
<span class="nc" id="L2252">            ImageViewCompat.setImageTintList(silhouette2, ColorStateList.valueOf(silhouetteColor));</span>
        }
<span class="nc bnc" id="L2254" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7465)) {</span>
<span class="nc" id="L2255">            ImageViewCompat.setImageTintList(silhouette3, ColorStateList.valueOf(silhouetteColor));</span>
        }
<span class="nc bnc" id="L2257" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7466)) {</span>
            // Set background color
<span class="nc" id="L2259">            v.setBackgroundResource(R.drawable.occupancy_background);</span>
        }
<span class="nc" id="L2261">        GradientDrawable d = (GradientDrawable) v.getBackground();</span>
<span class="nc bnc" id="L2262" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7467)) {</span>
<span class="nc" id="L2263">            d.setColor(backgroundColor);</span>
        }
<span class="nc" id="L2265">    }</span>

    /**
     * Sets the content description of the occupancy view group based on the provided occupancy
     *
     * @param v              occupancy.xml layout viewgroup containing the silhouettes
     * @param occupancy      the occupancy value to use to set the content description
     * @param occupancyState the state of the occupancy
     */
    public static void setOccupancyContentDescription(ViewGroup v, Occupancy occupancy, OccupancyState occupancyState) {
<span class="nc bnc" id="L2275" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7469)) {</span>
            // Hide the entire view group if occupancy is null
<span class="nc bnc" id="L2277" title="All 2 branches missed.">            if (occupancy == null) {</span>
<span class="nc bnc" id="L2278" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7468)) {</span>
<span class="nc" id="L2279">                    v.setContentDescription(&quot;&quot;);</span>
                }
<span class="nc" id="L2281">                return;</span>
            }
        }
<span class="nc" id="L2284">        int stringId = R.string.historically_full;</span>
<span class="nc bnc" id="L2285" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7490)) {</span>
            // Below switch continues into following cases to minimize lines of code
<span class="nc bnc" id="L2287" title="All 6 branches missed.">            switch(occupancy) {</span>
                case NOT_ACCEPTING_PASSENGERS:
                // &quot;Full&quot;
                case FULL:
                // &quot;Full&quot;
                case CRUSHED_STANDING_ROOM_ONLY:
<span class="nc bnc" id="L2293" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7473)) {</span>
                        // &quot;Full&quot;
<span class="nc bnc" id="L2295" title="All 2 branches missed.">                        if (occupancyState == OccupancyState.HISTORICAL) {</span>
<span class="nc bnc" id="L2296" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7472)) {</span>
<span class="nc" id="L2297">                                stringId = R.string.historically_full;</span>
                            }
<span class="nc bnc" id="L2299" title="All 2 branches missed.">                        } else if (occupancyState == OccupancyState.REALTIME) {</span>
<span class="nc bnc" id="L2300" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7471)) {</span>
<span class="nc" id="L2301">                                stringId = R.string.realtime_full;</span>
                            }
<span class="nc bnc" id="L2303" title="All 2 branches missed.">                        } else if (occupancyState == OccupancyState.PREDICTED) {</span>
<span class="nc bnc" id="L2304" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7470)) {</span>
<span class="nc" id="L2305">                                stringId = R.string.predicted_full;</span>
                            }
                        }
                    }
                    break;
                case STANDING_ROOM_ONLY:
<span class="nc bnc" id="L2311" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7477)) {</span>
                        // &quot;Standing room&quot;
<span class="nc bnc" id="L2313" title="All 2 branches missed.">                        if (occupancyState == OccupancyState.HISTORICAL) {</span>
<span class="nc bnc" id="L2314" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7476)) {</span>
<span class="nc" id="L2315">                                stringId = R.string.historically_standing_room;</span>
                            }
<span class="nc bnc" id="L2317" title="All 2 branches missed.">                        } else if (occupancyState == OccupancyState.REALTIME) {</span>
<span class="nc bnc" id="L2318" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7475)) {</span>
<span class="nc" id="L2319">                                stringId = R.string.realtime_standing_room;</span>
                            }
<span class="nc bnc" id="L2321" title="All 2 branches missed.">                        } else if (occupancyState == OccupancyState.PREDICTED) {</span>
<span class="nc bnc" id="L2322" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7474)) {</span>
<span class="nc" id="L2323">                                stringId = R.string.predicted_standing_room;</span>
                            }
                        }
                    }
                    break;
                case FEW_SEATS_AVAILABLE:
<span class="nc bnc" id="L2329" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7481)) {</span>
                        // &quot;Few seats available&quot;
<span class="nc bnc" id="L2331" title="All 2 branches missed.">                        if (occupancyState == OccupancyState.HISTORICAL) {</span>
<span class="nc bnc" id="L2332" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7480)) {</span>
<span class="nc" id="L2333">                                stringId = R.string.historically_few_seats_available;</span>
                            }
<span class="nc bnc" id="L2335" title="All 2 branches missed.">                        } else if (occupancyState == OccupancyState.REALTIME) {</span>
<span class="nc bnc" id="L2336" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7479)) {</span>
<span class="nc" id="L2337">                                stringId = R.string.realtime_few_seats_available;</span>
                            }
<span class="nc bnc" id="L2339" title="All 2 branches missed.">                        } else if (occupancyState == OccupancyState.PREDICTED) {</span>
<span class="nc bnc" id="L2340" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7478)) {</span>
<span class="nc" id="L2341">                                stringId = R.string.predicted_few_seats_available;</span>
                            }
                        }
                    }
                    break;
                case MANY_SEATS_AVAILABLE:
<span class="nc bnc" id="L2347" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7485)) {</span>
                        // &quot;Many seats available&quot;
<span class="nc bnc" id="L2349" title="All 2 branches missed.">                        if (occupancyState == OccupancyState.HISTORICAL) {</span>
<span class="nc bnc" id="L2350" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7484)) {</span>
<span class="nc" id="L2351">                                stringId = R.string.historically_many_seats_available;</span>
                            }
<span class="nc bnc" id="L2353" title="All 2 branches missed.">                        } else if (occupancyState == OccupancyState.REALTIME) {</span>
<span class="nc bnc" id="L2354" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7483)) {</span>
<span class="nc" id="L2355">                                stringId = R.string.realtime_many_seats_available;</span>
                            }
<span class="nc bnc" id="L2357" title="All 2 branches missed.">                        } else if (occupancyState == OccupancyState.PREDICTED) {</span>
<span class="nc bnc" id="L2358" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7482)) {</span>
<span class="nc" id="L2359">                                stringId = R.string.predicted_many_seats_available;</span>
                            }
                        }
                    }
                    break;
                case EMPTY:
<span class="nc bnc" id="L2365" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7489)) {</span>
                        // &quot;Empty&quot;
<span class="nc bnc" id="L2367" title="All 2 branches missed.">                        if (occupancyState == OccupancyState.HISTORICAL) {</span>
<span class="nc bnc" id="L2368" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7488)) {</span>
<span class="nc" id="L2369">                                stringId = R.string.historically_empty;</span>
                            }
<span class="nc bnc" id="L2371" title="All 2 branches missed.">                        } else if (occupancyState == OccupancyState.REALTIME) {</span>
<span class="nc bnc" id="L2372" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7487)) {</span>
<span class="nc" id="L2373">                                stringId = R.string.realtime_empty;</span>
                            }
<span class="nc bnc" id="L2375" title="All 2 branches missed.">                        } else if (occupancyState == OccupancyState.PREDICTED) {</span>
<span class="nc bnc" id="L2376" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7486)) {</span>
<span class="nc" id="L2377">                                stringId = R.string.predicted_empty;</span>
                            }
                        }
                    }
                    break;
            }
        }
<span class="nc bnc" id="L2384" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7491)) {</span>
<span class="nc" id="L2385">            v.setContentDescription(Application.get().getString(stringId));</span>
        }
<span class="nc" id="L2387">    }</span>

    /**
     * Asks the user to whitelist the application for energy restrictions (e.g., running in
     * the background). See https://developer.android.com/training/monitoring-device-state/doze-standby#support_for_other_use_cases
     *
     * @param activity
     */
    public static void openBatteryIgnoreIntent(Activity activity) {
<span class="nc" id="L2396">        Intent intent = new Intent();</span>
<span class="nc bnc" id="L2397" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7492)) {</span>
<span class="nc" id="L2398">            intent.setAction(Settings.ACTION_REQUEST_IGNORE_BATTERY_OPTIMIZATIONS);</span>
        }
<span class="nc bnc" id="L2400" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7493)) {</span>
<span class="nc" id="L2401">            intent.setData(Uri.parse(&quot;package:&quot; + activity.getPackageName()));</span>
        }
<span class="nc bnc" id="L2403" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7494)) {</span>
<span class="nc" id="L2404">            activity.startActivity(intent);</span>
        }
<span class="nc" id="L2406">    }</span>

    public static void setAppTheme(String themeValue) {
<span class="nc bnc" id="L2409" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7496)) {</span>
<span class="nc bnc" id="L2410" title="All 2 branches missed.">            if (themeValue.equalsIgnoreCase(Application.get().getString(R.string.preferences_app_theme_option_system_default))) {</span>
<span class="nc bnc" id="L2411" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7495)) {</span>
<span class="nc" id="L2412">                    AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_FOLLOW_SYSTEM);</span>
                }
            }
        }
<span class="nc bnc" id="L2416" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7498)) {</span>
<span class="nc bnc" id="L2417" title="All 2 branches missed.">            if (themeValue.equalsIgnoreCase(Application.get().getString(R.string.preferences_app_theme_option_dark))) {</span>
<span class="nc bnc" id="L2418" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7497)) {</span>
<span class="nc" id="L2419">                    AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_YES);</span>
                }
            }
        }
<span class="nc bnc" id="L2423" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7500)) {</span>
<span class="nc bnc" id="L2424" title="All 2 branches missed.">            if (themeValue.equalsIgnoreCase(Application.get().getString(R.string.preferences_app_theme_option_light))) {</span>
<span class="nc bnc" id="L2425" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7499)) {</span>
<span class="nc" id="L2426">                    AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_NO);</span>
                }
            }
        }
<span class="nc" id="L2430">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span>Generated by the Android Gradle plugin 8.2.0</div></body></html>