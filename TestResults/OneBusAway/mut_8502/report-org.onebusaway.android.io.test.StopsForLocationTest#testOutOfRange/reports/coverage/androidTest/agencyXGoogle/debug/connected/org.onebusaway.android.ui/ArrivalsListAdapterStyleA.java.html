<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ArrivalsListAdapterStyleA.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">agencyXGoogleDebug</a> &gt; <a href="index.source.html" class="el_package">org.onebusaway.android.ui</a> &gt; <span class="el_source">ArrivalsListAdapterStyleA.java</span></div><h1>ArrivalsListAdapterStyleA.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2012 Paul Watts (paulcwatts@gmail.com)
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.onebusaway.android.ui;

import android.content.ContentValues;
import android.content.Context;
import android.graphics.Paint;
import android.graphics.drawable.Drawable;
import android.graphics.drawable.GradientDrawable;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ImageView;
import android.widget.TextView;
import androidx.core.graphics.drawable.DrawableCompat;
import org.onebusaway.android.R;
import org.onebusaway.android.io.elements.ObaArrivalInfo;
import org.onebusaway.android.io.elements.OccupancyState;
import org.onebusaway.android.io.elements.Status;
import org.onebusaway.android.provider.ObaContract;
import org.onebusaway.android.util.ArrivalInfoUtils;
import org.onebusaway.android.util.UIUtils;
import java.util.ArrayList;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

/**
 * Original style of arrivals for OBA Android
 */
public class ArrivalsListAdapterStyleA extends ArrivalsListAdapterBase&lt;ArrivalInfo&gt; {

    public ArrivalsListAdapterStyleA(Context context) {
<span class="nc" id="L44">        super(context, R.layout.arrivals_list_item);</span>
<span class="nc" id="L45">    }</span>

    /**
     * Sets the data to be used with the adapter
     *
     * @param routesFilter routeIds to filter for
     * @param currentTime  current time in milliseconds
     */
    public void setData(ObaArrivalInfo[] arrivals, ArrayList&lt;String&gt; routesFilter, long currentTime) {
<span class="nc bnc" id="L54" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1348)) {</span>
<span class="nc bnc" id="L55" title="All 2 branches missed.">            if (arrivals != null) {</span>
<span class="nc" id="L56">                ArrayList&lt;ArrivalInfo&gt; list = ArrivalInfoUtils.convertObaArrivalInfo(getContext(), arrivals, routesFilter, currentTime, false);</span>
<span class="nc bnc" id="L57" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1347)) {</span>
<span class="nc" id="L58">                    setData(list);</span>
                }
<span class="nc" id="L60">            } else {</span>
<span class="nc bnc" id="L61" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1346)) {</span>
<span class="nc" id="L62">                    setData(null);</span>
                }
            }
        }
<span class="nc" id="L66">    }</span>

    @Override
    protected void initView(View view, ArrivalInfo stopInfo) {
<span class="nc" id="L70">        final Context context = getContext();</span>
<span class="nc" id="L71">        final ObaArrivalInfo arrivalInfo = stopInfo.getInfo();</span>
<span class="nc" id="L72">        TextView route = (TextView) view.findViewById(R.id.route);</span>
<span class="nc" id="L73">        TextView destination = (TextView) view.findViewById(R.id.destination);</span>
<span class="nc" id="L74">        TextView time = (TextView) view.findViewById(R.id.time);</span>
<span class="nc" id="L75">        TextView status = (TextView) view.findViewById(R.id.status);</span>
<span class="nc" id="L76">        TextView etaView = (TextView) view.findViewById(R.id.eta);</span>
<span class="nc" id="L77">        TextView minView = (TextView) view.findViewById(R.id.eta_min);</span>
<span class="nc" id="L78">        ViewGroup realtimeView = (ViewGroup) view.findViewById(R.id.eta_realtime_indicator);</span>
<span class="nc" id="L79">        ViewGroup occupancyView = view.findViewById(R.id.occupancy);</span>
<span class="nc" id="L80">        ImageView moreView = (ImageView) view.findViewById(R.id.more_horizontal);</span>
<span class="nc bnc" id="L81" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1349)) {</span>
<span class="nc" id="L82">            moreView.setColorFilter(context.getResources().getColor(R.color.switch_thumb_normal_material_dark));</span>
        }
<span class="nc" id="L84">        ImageView starView = (ImageView) view.findViewById(R.id.route_favorite);</span>
<span class="nc bnc" id="L85" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1350)) {</span>
<span class="nc" id="L86">            starView.setColorFilter(context.getResources().getColor(R.color.navdrawer_icon_tint));</span>
        }
<span class="nc bnc" id="L88" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1351)) {</span>
<span class="nc bnc" id="L89" title="All 2 branches missed.">            starView.setImageResource(stopInfo.isRouteAndHeadsignFavorite() ? R.drawable.focus_star_on : R.drawable.focus_star_off);</span>
        }
<span class="nc bnc" id="L91" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1357)) {</span>
            // CANCELED trips
<span class="nc bnc" id="L93" title="All 2 branches missed.">            if (Status.CANCELED.equals(stopInfo.getStatus())) {</span>
<span class="nc bnc" id="L94" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1352)) {</span>
                    // Strike through the text fields
<span class="nc" id="L96">                    route.setPaintFlags(Paint.STRIKE_THRU_TEXT_FLAG);</span>
                }
<span class="nc bnc" id="L98" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1353)) {</span>
<span class="nc" id="L99">                    destination.setPaintFlags(Paint.STRIKE_THRU_TEXT_FLAG);</span>
                }
<span class="nc bnc" id="L101" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1354)) {</span>
<span class="nc" id="L102">                    time.setPaintFlags(Paint.STRIKE_THRU_TEXT_FLAG);</span>
                }
<span class="nc bnc" id="L104" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1355)) {</span>
<span class="nc" id="L105">                    etaView.setPaintFlags(Paint.STRIKE_THRU_TEXT_FLAG);</span>
                }
<span class="nc bnc" id="L107" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1356)) {</span>
<span class="nc" id="L108">                    minView.setPaintFlags(Paint.STRIKE_THRU_TEXT_FLAG);</span>
                }
            }
        }
<span class="nc" id="L112">        String shortName = arrivalInfo.getShortName();</span>
<span class="nc bnc" id="L113" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1358)) {</span>
<span class="nc" id="L114">            route.setText(shortName.trim());</span>
        }
<span class="nc bnc" id="L116" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1359)) {</span>
<span class="nc" id="L117">            UIUtils.maybeShrinkRouteName(getContext(), route, shortName.trim());</span>
        }
<span class="nc bnc" id="L119" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1360)) {</span>
<span class="nc" id="L120">            destination.setText(UIUtils.formatDisplayText(arrivalInfo.getHeadsign()));</span>
        }
<span class="nc bnc" id="L122" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1361)) {</span>
<span class="nc" id="L123">            status.setText(stopInfo.getStatusText());</span>
        }
<span class="nc" id="L125">        long eta = stopInfo.getEta();</span>
<span class="nc bnc" id="L126" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1371)) {</span>
<span class="nc bnc" id="L127" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(1366) ? (eta &gt;= 0) : (ListenerUtil.mutListener.listen(1365) ? (eta &lt;= 0) : (ListenerUtil.mutListener.listen(1364) ? (eta &gt; 0) : (ListenerUtil.mutListener.listen(1363) ? (eta &lt; 0) : (ListenerUtil.mutListener.listen(1362) ? (eta != 0) : (eta == 0))))))) {</span>
<span class="nc bnc" id="L128" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1369)) {</span>
<span class="nc" id="L129">                    etaView.setText(R.string.stop_info_eta_now);</span>
                }
<span class="nc bnc" id="L131" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1370)) {</span>
<span class="nc" id="L132">                    minView.setVisibility(View.GONE);</span>
                }
            } else {
<span class="nc bnc" id="L135" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1367)) {</span>
<span class="nc" id="L136">                    etaView.setText(String.valueOf(eta));</span>
                }
<span class="nc bnc" id="L138" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1368)) {</span>
<span class="nc" id="L139">                    minView.setVisibility(View.VISIBLE);</span>
                }
            }
        }
<span class="nc bnc" id="L143" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1372)) {</span>
<span class="nc" id="L144">            status.setBackgroundResource(R.drawable.round_corners_style_b_status);</span>
        }
<span class="nc" id="L146">        GradientDrawable d = (GradientDrawable) status.getBackground();</span>
<span class="nc" id="L147">        Integer colorCode = stopInfo.getColor();</span>
<span class="nc" id="L148">        int color = context.getResources().getColor(colorCode);</span>
<span class="nc bnc" id="L149" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1376)) {</span>
<span class="nc bnc" id="L150" title="All 2 branches missed.">            if (stopInfo.getPredicted()) {</span>
<span class="nc bnc" id="L151" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1374)) {</span>
                    // Show real-time indicator
<span class="nc" id="L153">                    UIUtils.setRealtimeIndicatorColorByResourceCode(realtimeView, colorCode, android.R.color.transparent);</span>
                }
<span class="nc bnc" id="L155" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1375)) {</span>
<span class="nc" id="L156">                    realtimeView.setVisibility(View.VISIBLE);</span>
                }
            } else {
<span class="nc bnc" id="L159" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1373)) {</span>
<span class="nc" id="L160">                    realtimeView.setVisibility(View.INVISIBLE);</span>
                }
            }
        }
<span class="nc bnc" id="L164" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1377)) {</span>
<span class="nc" id="L165">            etaView.setTextColor(color);</span>
        }
<span class="nc bnc" id="L167" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1378)) {</span>
<span class="nc" id="L168">            minView.setTextColor(color);</span>
        }
<span class="nc bnc" id="L170" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1379)) {</span>
<span class="nc" id="L171">            d.setColor(color);</span>
        }
        // Set padding on status view
<span class="nc" id="L174">        int pSides = UIUtils.dpToPixels(context, 5);</span>
<span class="nc" id="L175">        int pTopBottom = UIUtils.dpToPixels(context, 2);</span>
<span class="nc bnc" id="L176" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1380)) {</span>
<span class="nc" id="L177">            status.setPadding(pSides, pTopBottom, pSides, pTopBottom);</span>
        }
<span class="nc bnc" id="L179" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1381)) {</span>
<span class="nc" id="L180">            time.setText(stopInfo.getTimeText());</span>
        }
<span class="nc bnc" id="L182" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1386)) {</span>
            // Occupancy
<span class="nc bnc" id="L184" title="All 2 branches missed.">            if (stopInfo.getPredictedOccupancy() != null) {</span>
<span class="nc bnc" id="L185" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1384)) {</span>
                    // Predicted occupancy data
<span class="nc" id="L187">                    UIUtils.setOccupancyVisibilityAndColor(occupancyView, stopInfo.getPredictedOccupancy(), OccupancyState.PREDICTED);</span>
                }
<span class="nc bnc" id="L189" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1385)) {</span>
<span class="nc" id="L190">                    UIUtils.setOccupancyContentDescription(occupancyView, stopInfo.getPredictedOccupancy(), OccupancyState.PREDICTED);</span>
                }
            } else {
<span class="nc bnc" id="L193" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1382)) {</span>
                    // Historical occupancy data
<span class="nc" id="L195">                    UIUtils.setOccupancyVisibilityAndColor(occupancyView, stopInfo.getHistoricalOccupancy(), OccupancyState.HISTORICAL);</span>
                }
<span class="nc bnc" id="L197" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1383)) {</span>
<span class="nc" id="L198">                    UIUtils.setOccupancyContentDescription(occupancyView, stopInfo.getHistoricalOccupancy(), OccupancyState.HISTORICAL);</span>
                }
            }
        }
<span class="nc" id="L202">        ContentValues values = null;</span>
<span class="nc bnc" id="L203" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1388)) {</span>
<span class="nc bnc" id="L204" title="All 2 branches missed.">            if (mTripsForStop != null) {</span>
<span class="nc bnc" id="L205" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1387)) {</span>
<span class="nc" id="L206">                    values = mTripsForStop.getValues(arrivalInfo.getTripId());</span>
                }
            }
        }
<span class="nc bnc" id="L210" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(1402)) {</span>
<span class="nc bnc" id="L211" title="All 2 branches missed.">            if (values != null) {</span>
<span class="nc" id="L212">                String reminderName = values.getAsString(ObaContract.Trips.NAME);</span>
<span class="nc" id="L213">                TextView reminder = (TextView) view.findViewById(R.id.reminder);</span>
<span class="nc bnc" id="L214" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1396)) {</span>
<span class="nc bnc" id="L215" title="All 22 branches missed.">                    if ((ListenerUtil.mutListener.listen(1394) ? (reminderName.length() &gt;= 0) : (ListenerUtil.mutListener.listen(1393) ? (reminderName.length() &lt;= 0) : (ListenerUtil.mutListener.listen(1392) ? (reminderName.length() &gt; 0) : (ListenerUtil.mutListener.listen(1391) ? (reminderName.length() &lt; 0) : (ListenerUtil.mutListener.listen(1390) ? (reminderName.length() != 0) : (reminderName.length() == 0))))))) {</span>
<span class="nc bnc" id="L216" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(1395)) {</span>
<span class="nc" id="L217">                            reminderName = context.getString(R.string.trip_info_noname);</span>
                        }
                    }
                }
<span class="nc bnc" id="L221" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1397)) {</span>
<span class="nc" id="L222">                    reminder.setText(reminderName);</span>
                }
<span class="nc" id="L224">                Drawable d2 = reminder.getCompoundDrawables()[0];</span>
<span class="nc bnc" id="L225" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1398)) {</span>
<span class="nc" id="L226">                    d2 = DrawableCompat.wrap(d2);</span>
                }
<span class="nc bnc" id="L228" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1399)) {</span>
<span class="nc" id="L229">                    DrawableCompat.setTint(d2.mutate(), view.getResources().getColor(R.color.button_material_dark));</span>
                }
<span class="nc bnc" id="L231" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1400)) {</span>
<span class="nc" id="L232">                    reminder.setCompoundDrawables(d2, null, null, null);</span>
                }
<span class="nc bnc" id="L234" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1401)) {</span>
<span class="nc" id="L235">                    reminder.setVisibility(View.VISIBLE);</span>
                }
<span class="nc" id="L237">            } else {</span>
                // this view.
<span class="nc" id="L239">                View reminder = view.findViewById(R.id.reminder);</span>
<span class="nc bnc" id="L240" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(1389)) {</span>
<span class="nc" id="L241">                    reminder.setVisibility(View.GONE);</span>
                }
            }
        }
<span class="nc" id="L245">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span>Generated by the Android Gradle plugin 8.2.0</div></body></html>