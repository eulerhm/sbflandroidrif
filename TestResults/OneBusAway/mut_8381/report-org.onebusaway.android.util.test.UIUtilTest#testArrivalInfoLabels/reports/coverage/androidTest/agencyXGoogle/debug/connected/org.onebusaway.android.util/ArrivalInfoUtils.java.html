<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ArrivalInfoUtils.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">agencyXGoogleDebug</a> &gt; <a href="index.source.html" class="el_package">org.onebusaway.android.util</a> &gt; <span class="el_source">ArrivalInfoUtils.java</span></div><h1>ArrivalInfoUtils.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2016 University of South Florida (sjbarbeau@gmail.com)
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.onebusaway.android.util;

import android.content.Context;
import android.content.res.Resources;
import org.onebusaway.android.R;
import org.onebusaway.android.app.Application;
import org.onebusaway.android.io.elements.ObaArrivalInfo;
import org.onebusaway.android.ui.ArrivalInfo;
import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

<span class="nc" id="L29">public class ArrivalInfoUtils {</span>

<span class="fc" id="L31">    static final class InfoComparator implements Comparator&lt;ArrivalInfo&gt; {</span>

        public int compare(ArrivalInfo lhs, ArrivalInfo rhs) {
<span class="pc bpc" id="L34" title="4 of 8 branches missed.">            return (int) ((ListenerUtil.mutListener.listen(7561) ? (lhs.getEta() % rhs.getEta()) : (ListenerUtil.mutListener.listen(7560) ? (lhs.getEta() / rhs.getEta()) : (ListenerUtil.mutListener.listen(7559) ? (lhs.getEta() * rhs.getEta()) : (ListenerUtil.mutListener.listen(7558) ? (lhs.getEta() + rhs.getEta()) : (lhs.getEta() - rhs.getEta()))))));</span>
        }
    }

    /**
     * Converts the ObaArrivalInfo array received from the server to an ArrayList for the adapter
     *
     * @param context
     * @param arrivalInfo
     * @param filter                               routeIds to filter for
     * @param ms                                   current time in milliseconds
     * @param includeArrivalDepartureInStatusLabel true if the arrival/departure label should be
     *                                             included in the status label, false if it should
     *                                             not
     * @return ArrayList of arrival info to be used with the adapter
     */
    public static ArrayList&lt;ArrivalInfo&gt; convertObaArrivalInfo(Context context, ObaArrivalInfo[] arrivalInfo, ArrayList&lt;String&gt; filter, long ms, boolean includeArrivalDepartureInStatusLabel) {
<span class="fc" id="L51">        final int len = arrivalInfo.length;</span>
<span class="fc" id="L52">        ArrayList&lt;ArrivalInfo&gt; result = new ArrayList&lt;ArrivalInfo&gt;(len);</span>
<span class="pc bpc" id="L53" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7575)) {</span>
<span class="pc bpc" id="L54" title="48 of 50 branches missed.">            if ((ListenerUtil.mutListener.listen(7567) ? (filter != null || (ListenerUtil.mutListener.listen(7566) ? (filter.size() &gt;= 0) : (ListenerUtil.mutListener.listen(7565) ? (filter.size() &lt;= 0) : (ListenerUtil.mutListener.listen(7564) ? (filter.size() &lt; 0) : (ListenerUtil.mutListener.listen(7563) ? (filter.size() != 0) : (ListenerUtil.mutListener.listen(7562) ? (filter.size() == 0) : (filter.size() &gt; 0))))))) : (filter != null &amp;&amp; (ListenerUtil.mutListener.listen(7566) ? (filter.size() &gt;= 0) : (ListenerUtil.mutListener.listen(7565) ? (filter.size() &lt;= 0) : (ListenerUtil.mutListener.listen(7564) ? (filter.size() &lt; 0) : (ListenerUtil.mutListener.listen(7563) ? (filter.size() != 0) : (ListenerUtil.mutListener.listen(7562) ? (filter.size() == 0) : (filter.size() &gt; 0))))))))) {</span>
<span class="nc bnc" id="L55" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7574)) {</span>
                    {
<span class="nc" id="L57">                        long _loopCounter90 = 0;</span>
                        // Only add routes that haven't been filtered out
<span class="nc bnc" id="L59" title="All 2 branches missed.">                        for (ObaArrivalInfo arrival : arrivalInfo) {</span>
<span class="nc" id="L60">                            ListenerUtil.loopListener.listen(&quot;_loopCounter90&quot;, ++_loopCounter90);</span>
<span class="nc bnc" id="L61" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7573)) {</span>
<span class="nc bnc" id="L62" title="All 2 branches missed.">                                if (filter.contains(arrival.getRouteId())) {</span>
<span class="nc" id="L63">                                    ArrivalInfo info = new ArrivalInfo(context, arrival, ms, includeArrivalDepartureInStatusLabel);</span>
<span class="nc bnc" id="L64" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(7572)) {</span>
<span class="nc bnc" id="L65" title="All 2 branches missed.">                                        if (shouldAddEta(info)) {</span>
<span class="nc bnc" id="L66" title="All 2 branches missed.">                                            if (!ListenerUtil.mutListener.listen(7571)) {</span>
<span class="nc" id="L67">                                                result.add(info);</span>
                                            }
                                        }
                                    }
                                }
                            }
                        }
<span class="nc" id="L74">                    }</span>
                }
            } else {
<span class="pc bpc" id="L77" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7570)) {</span>
                    {
<span class="fc" id="L79">                        long _loopCounter89 = 0;</span>
                        // Add arrivals for all routes
<span class="fc bfc" id="L81" title="All 2 branches covered.">                        for (ObaArrivalInfo obaArrivalInfo : arrivalInfo) {</span>
<span class="fc" id="L82">                            ListenerUtil.loopListener.listen(&quot;_loopCounter89&quot;, ++_loopCounter89);</span>
<span class="fc" id="L83">                            ArrivalInfo info = new ArrivalInfo(context, obaArrivalInfo, ms, includeArrivalDepartureInStatusLabel);</span>
<span class="pc bpc" id="L84" title="1 of 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7569)) {</span>
<span class="pc bpc" id="L85" title="1 of 2 branches missed.">                                if (shouldAddEta(info)) {</span>
<span class="pc bpc" id="L86" title="1 of 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(7568)) {</span>
<span class="fc" id="L87">                                        result.add(info);</span>
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
<span class="pc bpc" id="L96" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7576)) {</span>
            // Sort by ETA
<span class="fc" id="L98">            Collections.sort(result, new InfoComparator());</span>
        }
<span class="fc" id="L100">        return result;</span>
    }

    /**
     * Returns true if this ETA should be added based on the user preference for adding negative
     * arrival times, and false if it should not
     *
     * @param info info that includes the ETA to be evaluated
     * @return true if this ETA should be added based on the user preference for adding negative
     * arrival times, and false if it should not
     */
    private static boolean shouldAddEta(ArrivalInfo info) {
<span class="fc" id="L112">        boolean showNegativeArrivals = Application.getPrefs().getBoolean(Application.get().getResources().getString(R.string.preference_key_show_negative_arrivals), true);</span>
<span class="pc bpc" id="L113" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7583)) {</span>
<span class="pc bpc" id="L114" title="15 of 22 branches missed.">            if ((ListenerUtil.mutListener.listen(7581) ? (info.getEta() &lt;= 0) : (ListenerUtil.mutListener.listen(7580) ? (info.getEta() &gt; 0) : (ListenerUtil.mutListener.listen(7579) ? (info.getEta() &lt; 0) : (ListenerUtil.mutListener.listen(7578) ? (info.getEta() != 0) : (ListenerUtil.mutListener.listen(7577) ? (info.getEta() == 0) : (info.getEta() &gt;= 0))))))) {</span>
                // Always add positive ETAs
<span class="fc" id="L116">                return true;</span>
            } else {
<span class="pc bpc" id="L118" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7582)) {</span>
                    // Only add negative ETAs based on setting
<span class="pc bpc" id="L120" title="1 of 2 branches missed.">                    if (showNegativeArrivals) {</span>
<span class="fc" id="L121">                        return true;</span>
                    }
                }
            }
        }
<span class="nc" id="L126">        return false;</span>
    }

    /**
     * Returns the index in the provided infoList for the first non-negative arrival ETA in the
     * list, or -1 if no non-negative ETAs exist in the list
     *
     * @param infoList list to search for non-negative arrival times, ordered by relative ETA from
     *                 negative infinity to positive infinity
     * @return the index in the provided infoList for the first non-negative arrival ETA in the
     * list, or -1 if no non-negative ETAs exist in the list
     */
    public static int findFirstNonNegativeArrival(ArrayList&lt;ArrivalInfo&gt; infoList) {
<span class="nc bnc" id="L139" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7595)) {</span>
            {
<span class="nc" id="L141">                long _loopCounter91 = 0;</span>
<span class="nc bnc" id="L142" title="All 22 branches missed.">                for (int i = 0; (ListenerUtil.mutListener.listen(7594) ? (i &gt;= infoList.size()) : (ListenerUtil.mutListener.listen(7593) ? (i &lt;= infoList.size()) : (ListenerUtil.mutListener.listen(7592) ? (i &gt; infoList.size()) : (ListenerUtil.mutListener.listen(7591) ? (i != infoList.size()) : (ListenerUtil.mutListener.listen(7590) ? (i == infoList.size()) : (i &lt; infoList.size())))))); i++) {</span>
<span class="nc" id="L143">                    ListenerUtil.loopListener.listen(&quot;_loopCounter91&quot;, ++_loopCounter91);</span>
<span class="nc" id="L144">                    ArrivalInfo info = infoList.get(i);</span>
<span class="nc bnc" id="L145" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7589)) {</span>
<span class="nc bnc" id="L146" title="All 22 branches missed.">                        if ((ListenerUtil.mutListener.listen(7588) ? (info.getEta() &lt;= 0) : (ListenerUtil.mutListener.listen(7587) ? (info.getEta() &gt; 0) : (ListenerUtil.mutListener.listen(7586) ? (info.getEta() &lt; 0) : (ListenerUtil.mutListener.listen(7585) ? (info.getEta() != 0) : (ListenerUtil.mutListener.listen(7584) ? (info.getEta() == 0) : (info.getEta() &gt;= 0))))))) {</span>
<span class="nc" id="L147">                            return i;</span>
                        }
                    }
                }
            }
        }
        // We didn't find any non-negative ETAs
<span class="nc" id="L154">        return -1;</span>
    }

    /**
     * Returns the indexes in the provided infoList for the preferred route/headsign combinations
     * to be prioritized for displayed in the header, or null if no non-negative ETAs exist in the
     * list.  If no route/headsign combinations are favorited, the indexes returned may simply be
     * the indexes of the first (and second, if it exists) non-negative arrival times.
     *
     * @param infoList list to search for non-negative arrival times, ordered by relative ETA from
     *                 negative infinity to positive infinity
     * @return the indexes in the provided infoList for the preferred route/headsign combinations
     * to be prioritized for displayed in the header, or null if no non-negative ETAs exist in the
     * list
     */
    public static ArrayList&lt;Integer&gt; findPreferredArrivalIndexes(ArrayList&lt;ArrivalInfo&gt; infoList) {
        // Start by getting the index of the first non-negative arrival time
<span class="nc" id="L171">        int firstIndex = findFirstNonNegativeArrival(infoList);</span>
<span class="nc bnc" id="L172" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7601)) {</span>
<span class="nc bnc" id="L173" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(7600) ? (firstIndex &gt;= -1) : (ListenerUtil.mutListener.listen(7599) ? (firstIndex &lt;= -1) : (ListenerUtil.mutListener.listen(7598) ? (firstIndex &gt; -1) : (ListenerUtil.mutListener.listen(7597) ? (firstIndex &lt; -1) : (ListenerUtil.mutListener.listen(7596) ? (firstIndex != -1) : (firstIndex == -1))))))) {</span>
<span class="nc" id="L174">                return null;</span>
            }
        }
        // Find any favorites
<span class="nc" id="L178">        ArrayList&lt;Integer&gt; preferredIndexes = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L179" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7609)) {</span>
            {
<span class="nc" id="L181">                long _loopCounter92 = 0;</span>
<span class="nc bnc" id="L182" title="All 22 branches missed.">                for (int i = firstIndex; (ListenerUtil.mutListener.listen(7608) ? (i &gt;= infoList.size()) : (ListenerUtil.mutListener.listen(7607) ? (i &lt;= infoList.size()) : (ListenerUtil.mutListener.listen(7606) ? (i &gt; infoList.size()) : (ListenerUtil.mutListener.listen(7605) ? (i != infoList.size()) : (ListenerUtil.mutListener.listen(7604) ? (i == infoList.size()) : (i &lt; infoList.size())))))); i++) {</span>
<span class="nc" id="L183">                    ListenerUtil.loopListener.listen(&quot;_loopCounter92&quot;, ++_loopCounter92);</span>
<span class="nc" id="L184">                    ArrivalInfo info = infoList.get(i);</span>
<span class="nc bnc" id="L185" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7603)) {</span>
<span class="nc bnc" id="L186" title="All 2 branches missed.">                        if (info.isRouteAndHeadsignFavorite()) {</span>
<span class="nc bnc" id="L187" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7602)) {</span>
<span class="nc" id="L188">                                preferredIndexes.add(i);</span>
                            }
                        }
                    }
                }
            }
        }
<span class="nc bnc" id="L195" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7615)) {</span>
            // If we have at least two favorites, that's enough to fill the header - return them
<span class="nc bnc" id="L197" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(7614) ? (preferredIndexes.size() &lt;= 2) : (ListenerUtil.mutListener.listen(7613) ? (preferredIndexes.size() &gt; 2) : (ListenerUtil.mutListener.listen(7612) ? (preferredIndexes.size() &lt; 2) : (ListenerUtil.mutListener.listen(7611) ? (preferredIndexes.size() != 2) : (ListenerUtil.mutListener.listen(7610) ? (preferredIndexes.size() == 2) : (preferredIndexes.size() &gt;= 2))))))) {</span>
<span class="nc" id="L198">                return preferredIndexes;</span>
            }
        }
<span class="nc bnc" id="L201" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7628)) {</span>
            // If we have one favorite, and the index is different from the firstIndex, then add the firstIndex and return
<span class="nc bnc" id="L203" title="All 90 branches missed.">            if ((ListenerUtil.mutListener.listen(7626) ? ((ListenerUtil.mutListener.listen(7620) ? (preferredIndexes.size() &gt;= 1) : (ListenerUtil.mutListener.listen(7619) ? (preferredIndexes.size() &lt;= 1) : (ListenerUtil.mutListener.listen(7618) ? (preferredIndexes.size() &gt; 1) : (ListenerUtil.mutListener.listen(7617) ? (preferredIndexes.size() &lt; 1) : (ListenerUtil.mutListener.listen(7616) ? (preferredIndexes.size() != 1) : (preferredIndexes.size() == 1)))))) || (ListenerUtil.mutListener.listen(7625) ? (preferredIndexes.get(0) &gt;= firstIndex) : (ListenerUtil.mutListener.listen(7624) ? (preferredIndexes.get(0) &lt;= firstIndex) : (ListenerUtil.mutListener.listen(7623) ? (preferredIndexes.get(0) &gt; firstIndex) : (ListenerUtil.mutListener.listen(7622) ? (preferredIndexes.get(0) &lt; firstIndex) : (ListenerUtil.mutListener.listen(7621) ? (preferredIndexes.get(0) == firstIndex) : (preferredIndexes.get(0) != firstIndex))))))) : ((ListenerUtil.mutListener.listen(7620) ? (preferredIndexes.size() &gt;= 1) : (ListenerUtil.mutListener.listen(7619) ? (preferredIndexes.size() &lt;= 1) : (ListenerUtil.mutListener.listen(7618) ? (preferredIndexes.size() &gt; 1) : (ListenerUtil.mutListener.listen(7617) ? (preferredIndexes.size() &lt; 1) : (ListenerUtil.mutListener.listen(7616) ? (preferredIndexes.size() != 1) : (preferredIndexes.size() == 1)))))) &amp;&amp; (ListenerUtil.mutListener.listen(7625) ? (preferredIndexes.get(0) &gt;= firstIndex) : (ListenerUtil.mutListener.listen(7624) ? (preferredIndexes.get(0) &lt;= firstIndex) : (ListenerUtil.mutListener.listen(7623) ? (preferredIndexes.get(0) &gt; firstIndex) : (ListenerUtil.mutListener.listen(7622) ? (preferredIndexes.get(0) &lt; firstIndex) : (ListenerUtil.mutListener.listen(7621) ? (preferredIndexes.get(0) == firstIndex) : (preferredIndexes.get(0) != firstIndex))))))))) {</span>
<span class="nc bnc" id="L204" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7627)) {</span>
<span class="nc" id="L205">                    preferredIndexes.add(firstIndex);</span>
                }
            }
        }
<span class="nc bnc" id="L209" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7646)) {</span>
            // If we have no preferred indexes (i.e., starred route/headsigns) at this point, then add the firstIndex
<span class="nc bnc" id="L211" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(7633) ? (preferredIndexes.size() &gt;= 0) : (ListenerUtil.mutListener.listen(7632) ? (preferredIndexes.size() &lt;= 0) : (ListenerUtil.mutListener.listen(7631) ? (preferredIndexes.size() &gt; 0) : (ListenerUtil.mutListener.listen(7630) ? (preferredIndexes.size() &lt; 0) : (ListenerUtil.mutListener.listen(7629) ? (preferredIndexes.size() != 0) : (preferredIndexes.size() == 0))))))) {</span>
<span class="nc bnc" id="L212" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7634)) {</span>
<span class="nc" id="L213">                    preferredIndexes.add(firstIndex);</span>
                }
                // If there is another non-negative arrival time, then add it too
<span class="nc bnc" id="L216" title="All 8 branches missed.">                int secondIndex = (ListenerUtil.mutListener.listen(7638) ? (firstIndex % 1) : (ListenerUtil.mutListener.listen(7637) ? (firstIndex / 1) : (ListenerUtil.mutListener.listen(7636) ? (firstIndex * 1) : (ListenerUtil.mutListener.listen(7635) ? (firstIndex - 1) : (firstIndex + 1)))));</span>
<span class="nc bnc" id="L217" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7645)) {</span>
<span class="nc bnc" id="L218" title="All 22 branches missed.">                    if ((ListenerUtil.mutListener.listen(7643) ? (secondIndex &gt;= infoList.size()) : (ListenerUtil.mutListener.listen(7642) ? (secondIndex &lt;= infoList.size()) : (ListenerUtil.mutListener.listen(7641) ? (secondIndex &gt; infoList.size()) : (ListenerUtil.mutListener.listen(7640) ? (secondIndex != infoList.size()) : (ListenerUtil.mutListener.listen(7639) ? (secondIndex == infoList.size()) : (secondIndex &lt; infoList.size()))))))) {</span>
<span class="nc bnc" id="L219" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7644)) {</span>
<span class="nc" id="L220">                            preferredIndexes.add(secondIndex);</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L226">        return preferredIndexes;</span>
    }

    /**
     * Returns the status color to be used, depending on whether the vehicle is running early,
     * late,
     * ontime,
     * or if we don't have real-time info (i.e., scheduled)
     *
     * @param scheduled the scheduled time, in minutes past unix epoch
     * @param predicted the predicted time, in minutes past unix epoch
     * @return the status color to be used, depending on whether the vehicle is running early, late,
     * ontime,
     * or if we don't have real-time info (i.e., scheduled)
     */
    public static int computeColor(final long scheduled, final long predicted) {
<span class="pc bpc" id="L242" title="16 of 22 branches missed.">        if ((ListenerUtil.mutListener.listen(7651) ? (predicted &gt;= 0) : (ListenerUtil.mutListener.listen(7650) ? (predicted &lt;= 0) : (ListenerUtil.mutListener.listen(7649) ? (predicted &gt; 0) : (ListenerUtil.mutListener.listen(7648) ? (predicted &lt; 0) : (ListenerUtil.mutListener.listen(7647) ? (predicted == 0) : (predicted != 0))))))) {</span>
<span class="pc bpc" id="L243" title="4 of 8 branches missed.">            return computeColorFromDeviation((ListenerUtil.mutListener.listen(7655) ? (predicted % scheduled) : (ListenerUtil.mutListener.listen(7654) ? (predicted / scheduled) : (ListenerUtil.mutListener.listen(7653) ? (predicted * scheduled) : (ListenerUtil.mutListener.listen(7652) ? (predicted + scheduled) : (predicted - scheduled))))));</span>
        } else {
            // Use scheduled color
<span class="nc" id="L246">            return R.color.stop_info_scheduled_time;</span>
        }
    }

    /**
     * Returns the status color to be used, depending on whether the vehicle is running early,
     * late,
     * ontime,
     * or if we don't have real-time info (i.e., scheduled)
     *
     * @param delay the deviation from the scheduled time, in minutes - positive means bus is
     *              running late,
     *              negative means early
     * @return the status color to be used, depending on whether the vehicle is running early, late,
     * ontime,
     * or if we don't have real-time info (i.e., scheduled)
     */
    public static int computeColorFromDeviation(final long delay) {
        // Bus is arriving
<span class="pc bpc" id="L265" title="15 of 22 branches missed.">        if ((ListenerUtil.mutListener.listen(7660) ? (delay &gt;= 0) : (ListenerUtil.mutListener.listen(7659) ? (delay &lt;= 0) : (ListenerUtil.mutListener.listen(7658) ? (delay &lt; 0) : (ListenerUtil.mutListener.listen(7657) ? (delay != 0) : (ListenerUtil.mutListener.listen(7656) ? (delay == 0) : (delay &gt; 0))))))) {</span>
            // Arriving delayed
<span class="fc" id="L267">            return R.color.stop_info_delayed;</span>
<span class="pc bpc" id="L268" title="15 of 22 branches missed.">        } else if ((ListenerUtil.mutListener.listen(7665) ? (delay &gt;= 0) : (ListenerUtil.mutListener.listen(7664) ? (delay &lt;= 0) : (ListenerUtil.mutListener.listen(7663) ? (delay &gt; 0) : (ListenerUtil.mutListener.listen(7662) ? (delay != 0) : (ListenerUtil.mutListener.listen(7661) ? (delay == 0) : (delay &lt; 0))))))) {</span>
            // Arriving early
<span class="fc" id="L270">            return R.color.stop_info_early;</span>
        } else {
            // Arriving on time
<span class="fc" id="L273">            return R.color.stop_info_ontime;</span>
        }
    }

    /**
     * Computes the arrival status label from the delay (i.e., schedule deviation), where positive
     * means the bus is running late and negative means the bus is running ahead of schedule
     *
     * @param delay schedule deviation, in minutes, for this vehicle where positive
     *              means the bus is running late and negative means the bus is running ahead of
     *              schedule
     * @return the arrival status label based on the deviation
     */
    public static String computeArrivalLabelFromDelay(Resources res, long delay) {
<span class="pc bpc" id="L287" title="15 of 22 branches missed.">        if ((ListenerUtil.mutListener.listen(7670) ? (delay &gt;= 0) : (ListenerUtil.mutListener.listen(7669) ? (delay &lt;= 0) : (ListenerUtil.mutListener.listen(7668) ? (delay &lt; 0) : (ListenerUtil.mutListener.listen(7667) ? (delay != 0) : (ListenerUtil.mutListener.listen(7666) ? (delay == 0) : (delay &gt; 0))))))) {</span>
            // Arriving delayed
<span class="fc" id="L289">            return res.getQuantityString(R.plurals.stop_info_arrive_delayed, (int) delay, delay);</span>
<span class="pc bpc" id="L290" title="15 of 22 branches missed.">        } else if ((ListenerUtil.mutListener.listen(7675) ? (delay &gt;= 0) : (ListenerUtil.mutListener.listen(7674) ? (delay &lt;= 0) : (ListenerUtil.mutListener.listen(7673) ? (delay &gt; 0) : (ListenerUtil.mutListener.listen(7672) ? (delay != 0) : (ListenerUtil.mutListener.listen(7671) ? (delay == 0) : (delay &lt; 0))))))) {</span>
<span class="pc bpc" id="L291" title="1 of 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7676)) {</span>
                // Arriving early
<span class="fc" id="L293">                delay = -delay;</span>
            }
<span class="fc" id="L295">            return res.getQuantityString(R.plurals.stop_info_arrive_early, (int) delay, delay);</span>
        } else {
            // Arriving on time
<span class="fc" id="L298">            return res.getString(R.string.stop_info_ontime);</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span>Generated by the Android Gradle plugin 8.2.0</div></body></html>