<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>LocationUtils.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">agencyXGoogleDebug</a> &gt; <a href="index.source.html" class="el_package">org.onebusaway.android.util</a> &gt; <span class="el_source">LocationUtils.java</span></div><h1>LocationUtils.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2014 University of South Florida (sjbarbeau@gmail.com)
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.onebusaway.android.util;

import android.content.Context;
import android.location.Address;
import android.location.Geocoder;
import android.location.Location;
import android.location.LocationManager;
import android.os.Build;
import android.os.Bundle;
import android.os.SystemClock;
import android.provider.Settings;
import android.text.TextUtils;
import android.util.Log;
import com.google.android.gms.common.ConnectionResult;
import com.google.android.gms.common.api.GoogleApiClient;
import com.google.android.gms.location.LocationServices;
import org.onebusaway.android.BuildConfig;
import org.onebusaway.android.R;
import org.onebusaway.android.app.Application;
import org.onebusaway.android.directions.util.CustomAddress;
import org.onebusaway.android.io.elements.ObaRegion;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;
import java.util.concurrent.TimeUnit;
import edu.usf.cutr.pelias.AutocompleteRequest;
import edu.usf.cutr.pelias.PeliasRequest;
import edu.usf.cutr.pelias.PeliasResponse;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

/**
 * Utilities to help obtain and process location data
 *
 * @author barbeau
 */
<span class="nc" id="L52">public class LocationUtils {</span>

    public static final String TAG = &quot;LocationUtil&quot;;

    public static final int DEFAULT_SEARCH_RADIUS = 40000;

    private static final float FUZZY_EQUALS_THRESHOLD = 15.0f;

    // 50 meters
    public static final float ACC_THRESHOLD = 50f;

    // 10 minutes
<span class="fc" id="L64">    public static final long TIME_THRESHOLD = TimeUnit.MINUTES.toMillis(10);</span>

    private static final int GEOCODER_MAX_RESULTS = 5;

    // in meters
    private static final int GEOCODING_MAX_ERROR = 100;

    public static Location getDefaultSearchCenter() {
<span class="nc" id="L72">        ObaRegion region = Application.get().getCurrentRegion();</span>
<span class="nc bnc" id="L73" title="All 2 branches missed.">        if (region != null) {</span>
<span class="nc" id="L74">            double[] results = new double[4];</span>
<span class="nc bnc" id="L75" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7703)) {</span>
<span class="nc" id="L76">                RegionUtils.getRegionSpan(region, results);</span>
            }
<span class="nc" id="L78">            return LocationUtils.makeLocation(results[2], results[3]);</span>
        } else {
<span class="nc" id="L80">            return null;</span>
        }
    }

    /**
     * Compares Location A to Location B - prefers a non-null location that is more recent.  Does
     * NOT take estimated accuracy into account.
     * @param a first location to compare
     * @param b second location to compare
     * @return true if Location a is &quot;better&quot; than b, or false if b is &quot;better&quot; than a
     */
    public static boolean compareLocationsByTime(Location a, Location b) {
<span class="pc bpc" id="L92" title="95 of 106 branches missed.">        return ((ListenerUtil.mutListener.listen(7710) ? (a != null || ((ListenerUtil.mutListener.listen(7709) ? (b == null &amp;&amp; (ListenerUtil.mutListener.listen(7708) ? (a.getTime() &gt;= b.getTime()) : (ListenerUtil.mutListener.listen(7707) ? (a.getTime() &lt;= b.getTime()) : (ListenerUtil.mutListener.listen(7706) ? (a.getTime() &lt; b.getTime()) : (ListenerUtil.mutListener.listen(7705) ? (a.getTime() != b.getTime()) : (ListenerUtil.mutListener.listen(7704) ? (a.getTime() == b.getTime()) : (a.getTime() &gt; b.getTime()))))))) : (b == null || (ListenerUtil.mutListener.listen(7708) ? (a.getTime() &gt;= b.getTime()) : (ListenerUtil.mutListener.listen(7707) ? (a.getTime() &lt;= b.getTime()) : (ListenerUtil.mutListener.listen(7706) ? (a.getTime() &lt; b.getTime()) : (ListenerUtil.mutListener.listen(7705) ? (a.getTime() != b.getTime()) : (ListenerUtil.mutListener.listen(7704) ? (a.getTime() == b.getTime()) : (a.getTime() &gt; b.getTime())))))))))) : (a != null &amp;&amp; ((ListenerUtil.mutListener.listen(7709) ? (b == null &amp;&amp; (ListenerUtil.mutListener.listen(7708) ? (a.getTime() &gt;= b.getTime()) : (ListenerUtil.mutListener.listen(7707) ? (a.getTime() &lt;= b.getTime()) : (ListenerUtil.mutListener.listen(7706) ? (a.getTime() &lt; b.getTime()) : (ListenerUtil.mutListener.listen(7705) ? (a.getTime() != b.getTime()) : (ListenerUtil.mutListener.listen(7704) ? (a.getTime() == b.getTime()) : (a.getTime() &gt; b.getTime()))))))) : (b == null || (ListenerUtil.mutListener.listen(7708) ? (a.getTime() &gt;= b.getTime()) : (ListenerUtil.mutListener.listen(7707) ? (a.getTime() &lt;= b.getTime()) : (ListenerUtil.mutListener.listen(7706) ? (a.getTime() &lt; b.getTime()) : (ListenerUtil.mutListener.listen(7705) ? (a.getTime() != b.getTime()) : (ListenerUtil.mutListener.listen(7704) ? (a.getTime() == b.getTime()) : (a.getTime() &gt; b.getTime()))))))))))));</span>
    }

    /**
     * Compares Location A to Location B, considering timestamps and accuracy of locations.
     * Typically
     * this is used to compare a new location delivered by a LocationListener (Location A) to
     * a previously saved location (Location B).
     *
     * @param a location to compare
     * @param b location to compare against
     * @return true if Location a is &quot;better&quot; than b, or false if b is &quot;better&quot; than a
     */
    public static boolean compareLocations(Location a, Location b) {
<span class="pc bpc" id="L106" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7711)) {</span>
<span class="fc bfc" id="L107" title="All 2 branches covered.">            if (a == null) {</span>
                // New location isn't valid, return false
<span class="fc" id="L109">                return false;</span>
            }
        }
<span class="pc bpc" id="L112" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7712)) {</span>
            // If the new location is the first location, save it
<span class="fc bfc" id="L114" title="All 2 branches covered.">            if (b == null) {</span>
<span class="fc" id="L115">                return true;</span>
            }
        }
<span class="pc bpc" id="L118" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7723)) {</span>
            // save the new location, even if the accuracy for new location is worse
<span class="pc bpc" id="L120" title="132 of 146 branches missed.">            if ((ListenerUtil.mutListener.listen(7722) ? ((ListenerUtil.mutListener.listen(7721) ? ((ListenerUtil.mutListener.listen(7716) ? (System.currentTimeMillis() % b.getTime()) : (ListenerUtil.mutListener.listen(7715) ? (System.currentTimeMillis() / b.getTime()) : (ListenerUtil.mutListener.listen(7714) ? (System.currentTimeMillis() * b.getTime()) : (ListenerUtil.mutListener.listen(7713) ? (System.currentTimeMillis() + b.getTime()) : (System.currentTimeMillis() - b.getTime()))))) &gt;= TIME_THRESHOLD) : (ListenerUtil.mutListener.listen(7720) ? ((ListenerUtil.mutListener.listen(7716) ? (System.currentTimeMillis() % b.getTime()) : (ListenerUtil.mutListener.listen(7715) ? (System.currentTimeMillis() / b.getTime()) : (ListenerUtil.mutListener.listen(7714) ? (System.currentTimeMillis() * b.getTime()) : (ListenerUtil.mutListener.listen(7713) ? (System.currentTimeMillis() + b.getTime()) : (System.currentTimeMillis() - b.getTime()))))) &lt;= TIME_THRESHOLD) : (ListenerUtil.mutListener.listen(7719) ? ((ListenerUtil.mutListener.listen(7716) ? (System.currentTimeMillis() % b.getTime()) : (ListenerUtil.mutListener.listen(7715) ? (System.currentTimeMillis() / b.getTime()) : (ListenerUtil.mutListener.listen(7714) ? (System.currentTimeMillis() * b.getTime()) : (ListenerUtil.mutListener.listen(7713) ? (System.currentTimeMillis() + b.getTime()) : (System.currentTimeMillis() - b.getTime()))))) &lt; TIME_THRESHOLD) : (ListenerUtil.mutListener.listen(7718) ? ((ListenerUtil.mutListener.listen(7716) ? (System.currentTimeMillis() % b.getTime()) : (ListenerUtil.mutListener.listen(7715) ? (System.currentTimeMillis() / b.getTime()) : (ListenerUtil.mutListener.listen(7714) ? (System.currentTimeMillis() * b.getTime()) : (ListenerUtil.mutListener.listen(7713) ? (System.currentTimeMillis() + b.getTime()) : (System.currentTimeMillis() - b.getTime()))))) != TIME_THRESHOLD) : (ListenerUtil.mutListener.listen(7717) ? ((ListenerUtil.mutListener.listen(7716) ? (System.currentTimeMillis() % b.getTime()) : (ListenerUtil.mutListener.listen(7715) ? (System.currentTimeMillis() / b.getTime()) : (ListenerUtil.mutListener.listen(7714) ? (System.currentTimeMillis() * b.getTime()) : (ListenerUtil.mutListener.listen(7713) ? (System.currentTimeMillis() + b.getTime()) : (System.currentTimeMillis() - b.getTime()))))) == TIME_THRESHOLD) : ((ListenerUtil.mutListener.listen(7716) ? (System.currentTimeMillis() % b.getTime()) : (ListenerUtil.mutListener.listen(7715) ? (System.currentTimeMillis() / b.getTime()) : (ListenerUtil.mutListener.listen(7714) ? (System.currentTimeMillis() * b.getTime()) : (ListenerUtil.mutListener.listen(7713) ? (System.currentTimeMillis() + b.getTime()) : (System.currentTimeMillis() - b.getTime()))))) &gt; TIME_THRESHOLD)))))) || compareLocationsByTime(a, b)) : ((ListenerUtil.mutListener.listen(7721) ? ((ListenerUtil.mutListener.listen(7716) ? (System.currentTimeMillis() % b.getTime()) : (ListenerUtil.mutListener.listen(7715) ? (System.currentTimeMillis() / b.getTime()) : (ListenerUtil.mutListener.listen(7714) ? (System.currentTimeMillis() * b.getTime()) : (ListenerUtil.mutListener.listen(7713) ? (System.currentTimeMillis() + b.getTime()) : (System.currentTimeMillis() - b.getTime()))))) &gt;= TIME_THRESHOLD) : (ListenerUtil.mutListener.listen(7720) ? ((ListenerUtil.mutListener.listen(7716) ? (System.currentTimeMillis() % b.getTime()) : (ListenerUtil.mutListener.listen(7715) ? (System.currentTimeMillis() / b.getTime()) : (ListenerUtil.mutListener.listen(7714) ? (System.currentTimeMillis() * b.getTime()) : (ListenerUtil.mutListener.listen(7713) ? (System.currentTimeMillis() + b.getTime()) : (System.currentTimeMillis() - b.getTime()))))) &lt;= TIME_THRESHOLD) : (ListenerUtil.mutListener.listen(7719) ? ((ListenerUtil.mutListener.listen(7716) ? (System.currentTimeMillis() % b.getTime()) : (ListenerUtil.mutListener.listen(7715) ? (System.currentTimeMillis() / b.getTime()) : (ListenerUtil.mutListener.listen(7714) ? (System.currentTimeMillis() * b.getTime()) : (ListenerUtil.mutListener.listen(7713) ? (System.currentTimeMillis() + b.getTime()) : (System.currentTimeMillis() - b.getTime()))))) &lt; TIME_THRESHOLD) : (ListenerUtil.mutListener.listen(7718) ? ((ListenerUtil.mutListener.listen(7716) ? (System.currentTimeMillis() % b.getTime()) : (ListenerUtil.mutListener.listen(7715) ? (System.currentTimeMillis() / b.getTime()) : (ListenerUtil.mutListener.listen(7714) ? (System.currentTimeMillis() * b.getTime()) : (ListenerUtil.mutListener.listen(7713) ? (System.currentTimeMillis() + b.getTime()) : (System.currentTimeMillis() - b.getTime()))))) != TIME_THRESHOLD) : (ListenerUtil.mutListener.listen(7717) ? ((ListenerUtil.mutListener.listen(7716) ? (System.currentTimeMillis() % b.getTime()) : (ListenerUtil.mutListener.listen(7715) ? (System.currentTimeMillis() / b.getTime()) : (ListenerUtil.mutListener.listen(7714) ? (System.currentTimeMillis() * b.getTime()) : (ListenerUtil.mutListener.listen(7713) ? (System.currentTimeMillis() + b.getTime()) : (System.currentTimeMillis() - b.getTime()))))) == TIME_THRESHOLD) : ((ListenerUtil.mutListener.listen(7716) ? (System.currentTimeMillis() % b.getTime()) : (ListenerUtil.mutListener.listen(7715) ? (System.currentTimeMillis() / b.getTime()) : (ListenerUtil.mutListener.listen(7714) ? (System.currentTimeMillis() * b.getTime()) : (ListenerUtil.mutListener.listen(7713) ? (System.currentTimeMillis() + b.getTime()) : (System.currentTimeMillis() - b.getTime()))))) &gt; TIME_THRESHOLD)))))) &amp;&amp; compareLocationsByTime(a, b)))) {</span>
<span class="fc" id="L121">                return true;</span>
            }
        }
<span class="pc bpc" id="L124" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7730)) {</span>
            // If the new location has an accuracy better than ACC_THRESHOLD and is newer than the last location, save it
<span class="pc bpc" id="L126" title="40 of 50 branches missed.">            if ((ListenerUtil.mutListener.listen(7729) ? ((ListenerUtil.mutListener.listen(7728) ? (a.getAccuracy() &gt;= ACC_THRESHOLD) : (ListenerUtil.mutListener.listen(7727) ? (a.getAccuracy() &lt;= ACC_THRESHOLD) : (ListenerUtil.mutListener.listen(7726) ? (a.getAccuracy() &gt; ACC_THRESHOLD) : (ListenerUtil.mutListener.listen(7725) ? (a.getAccuracy() != ACC_THRESHOLD) : (ListenerUtil.mutListener.listen(7724) ? (a.getAccuracy() == ACC_THRESHOLD) : (a.getAccuracy() &lt; ACC_THRESHOLD)))))) || compareLocationsByTime(a, b)) : ((ListenerUtil.mutListener.listen(7728) ? (a.getAccuracy() &gt;= ACC_THRESHOLD) : (ListenerUtil.mutListener.listen(7727) ? (a.getAccuracy() &lt;= ACC_THRESHOLD) : (ListenerUtil.mutListener.listen(7726) ? (a.getAccuracy() &gt; ACC_THRESHOLD) : (ListenerUtil.mutListener.listen(7725) ? (a.getAccuracy() != ACC_THRESHOLD) : (ListenerUtil.mutListener.listen(7724) ? (a.getAccuracy() == ACC_THRESHOLD) : (a.getAccuracy() &lt; ACC_THRESHOLD)))))) &amp;&amp; compareLocationsByTime(a, b)))) {</span>
<span class="fc" id="L127">                return true;</span>
            }
        }
        // If we get this far, A isn't better than B
<span class="fc" id="L131">        return false;</span>
    }

    /**
     * Check if two locations are the exact same by comparing their timestamp, lat &amp; lng.
     * @param a First location
     * @param b Second location
     * @return true if same, false otherwise.
     */
    public static boolean isDuplicate(Location a, Location b) {
<span class="nc bnc" id="L141" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7731)) {</span>
<span class="nc bnc" id="L142" title="All 2 branches missed.">            if (a.getTime() != b.getTime())</span>
<span class="nc" id="L143">                return false;</span>
        }
<span class="nc bnc" id="L145" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7732)) {</span>
<span class="nc bnc" id="L146" title="All 2 branches missed.">            if (a.getLatitude() != b.getLatitude())</span>
<span class="nc" id="L147">                return false;</span>
        }
<span class="nc bnc" id="L149" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7733)) {</span>
<span class="nc bnc" id="L150" title="All 2 branches missed.">            if (a.getLongitude() != b.getLongitude())</span>
<span class="nc" id="L151">                return false;</span>
        }
<span class="nc" id="L153">        return true;</span>
    }

    /**
     * Converts a latitude/longitude to a Location.
     *
     * @param lat The latitude.
     * @param lon The longitude.
     * @return A Location representing this latitude/longitude.
     */
    public static Location makeLocation(double lat, double lon) {
<span class="nc" id="L164">        Location l = new Location(&quot;&quot;);</span>
<span class="nc bnc" id="L165" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7734)) {</span>
<span class="nc" id="L166">            l.setLatitude(lat);</span>
        }
<span class="nc bnc" id="L168" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7735)) {</span>
<span class="nc" id="L169">            l.setLongitude(lon);</span>
        }
<span class="nc" id="L171">        return l;</span>
    }

    /**
     * Returns true if the locations are approximately equal (i.e., within a certain distance
     * threshold)
     *
     * @param a first location
     * @param b second location
     * @return true if the locations are approximately equal, false if they are not
     */
    public static boolean fuzzyEquals(Location a, Location b) {
<span class="nc bnc" id="L183" title="All 22 branches missed.">        return (ListenerUtil.mutListener.listen(7740) ? (a.distanceTo(b) &gt;= FUZZY_EQUALS_THRESHOLD) : (ListenerUtil.mutListener.listen(7739) ? (a.distanceTo(b) &gt; FUZZY_EQUALS_THRESHOLD) : (ListenerUtil.mutListener.listen(7738) ? (a.distanceTo(b) &lt; FUZZY_EQUALS_THRESHOLD) : (ListenerUtil.mutListener.listen(7737) ? (a.distanceTo(b) != FUZZY_EQUALS_THRESHOLD) : (ListenerUtil.mutListener.listen(7736) ? (a.distanceTo(b) == FUZZY_EQUALS_THRESHOLD) : (a.distanceTo(b) &lt;= FUZZY_EQUALS_THRESHOLD))))));</span>
    }

    /**
     * Returns true if the user has enabled location services on their device, false if they have
     * not
     *
     * from http://stackoverflow.com/a/22980843/937715
     *
     * @return true if the user has enabled location services on their device, false if they have
     * not
     */
    public static boolean isLocationEnabled(Context context) {
<span class="nc bnc" id="L196" title="All 2 branches missed.">        return getLocationMode(context) != Settings.Secure.LOCATION_MODE_OFF;</span>
    }

    /**
     * This method is used to get Integer representation of location mode
     *
     * @param context
     * @return location mode for passed context
     */
    public static int getLocationMode(Context context) {
<span class="nc" id="L206">        int locationMode = Settings.Secure.LOCATION_MODE_OFF;</span>
        String locationProviders;
<span class="nc bnc" id="L208" title="All 22 branches missed.">        if ((ListenerUtil.mutListener.listen(7745) ? (Build.VERSION.SDK_INT &lt;= Build.VERSION_CODES.KITKAT) : (ListenerUtil.mutListener.listen(7744) ? (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.KITKAT) : (ListenerUtil.mutListener.listen(7743) ? (Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.KITKAT) : (ListenerUtil.mutListener.listen(7742) ? (Build.VERSION.SDK_INT != Build.VERSION_CODES.KITKAT) : (ListenerUtil.mutListener.listen(7741) ? (Build.VERSION.SDK_INT == Build.VERSION_CODES.KITKAT) : (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.KITKAT))))))) {</span>
            try {
<span class="nc bnc" id="L210" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7751)) {</span>
<span class="nc" id="L211">                    locationMode = Settings.Secure.getInt(context.getContentResolver(), Settings.Secure.LOCATION_MODE);</span>
                }
<span class="nc" id="L213">            } catch (Settings.SettingNotFoundException e) {</span>
<span class="nc bnc" id="L214" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7750)) {</span>
<span class="nc" id="L215">                    e.printStackTrace();</span>
                }
<span class="nc" id="L217">            }</span>
        } else {
<span class="nc" id="L219">            locationProviders = Settings.Secure.getString(context.getContentResolver(), Settings.Secure.LOCATION_PROVIDERS_ALLOWED);</span>
<span class="nc bnc" id="L220" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7749)) {</span>
<span class="nc bnc" id="L221" title="All 2 branches missed.">                if (TextUtils.isEmpty(locationProviders)) {</span>
<span class="nc bnc" id="L222" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7748)) {</span>
<span class="nc" id="L223">                        locationMode = Settings.Secure.LOCATION_MODE_OFF;</span>
                    }
<span class="nc bnc" id="L225" title="All 2 branches missed.">                } else if (locationProviders.contains(LocationManager.GPS_PROVIDER)) {</span>
<span class="nc bnc" id="L226" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7747)) {</span>
<span class="nc" id="L227">                        locationMode = Settings.Secure.LOCATION_MODE_HIGH_ACCURACY;</span>
                    }
<span class="nc bnc" id="L229" title="All 2 branches missed.">                } else if (locationProviders.contains(LocationManager.NETWORK_PROVIDER)) {</span>
<span class="nc bnc" id="L230" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7746)) {</span>
<span class="nc" id="L231">                        locationMode = Settings.Secure.LOCATION_MODE_BATTERY_SAVING;</span>
                    }
                }
            }
        }
<span class="nc" id="L236">        return locationMode;</span>
    }

    /**
     * Returns the human-readable details of a Location (provider, lat/long, accuracy, timestamp)
     *
     * @return the details of a Location (provider, lat/long, accuracy, timestamp) in a string
     */
    public static String printLocationDetails(Location loc) {
<span class="nc bnc" id="L245" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7752)) {</span>
<span class="nc bnc" id="L246" title="All 2 branches missed.">            if (loc == null) {</span>
<span class="nc" id="L247">                return &quot;&quot;;</span>
            }
        }
        long timeDiff;
        double timeDiffSec;
<span class="nc bnc" id="L252" title="All 22 branches missed.">        if ((ListenerUtil.mutListener.listen(7757) ? (Build.VERSION.SDK_INT &lt;= Build.VERSION_CODES.JELLY_BEAN_MR1) : (ListenerUtil.mutListener.listen(7756) ? (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.JELLY_BEAN_MR1) : (ListenerUtil.mutListener.listen(7755) ? (Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.JELLY_BEAN_MR1) : (ListenerUtil.mutListener.listen(7754) ? (Build.VERSION.SDK_INT != Build.VERSION_CODES.JELLY_BEAN_MR1) : (ListenerUtil.mutListener.listen(7753) ? (Build.VERSION.SDK_INT == Build.VERSION_CODES.JELLY_BEAN_MR1) : (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.JELLY_BEAN_MR1))))))) {</span>
<span class="nc bnc" id="L253" title="All 8 branches missed.">            timeDiff = (ListenerUtil.mutListener.listen(7769) ? (SystemClock.elapsedRealtimeNanos() % loc.getElapsedRealtimeNanos()) : (ListenerUtil.mutListener.listen(7768) ? (SystemClock.elapsedRealtimeNanos() / loc.getElapsedRealtimeNanos()) : (ListenerUtil.mutListener.listen(7767) ? (SystemClock.elapsedRealtimeNanos() * loc.getElapsedRealtimeNanos()) : (ListenerUtil.mutListener.listen(7766) ? (SystemClock.elapsedRealtimeNanos() + loc.getElapsedRealtimeNanos()) : (SystemClock.elapsedRealtimeNanos() - loc.getElapsedRealtimeNanos())))));</span>
            // Convert to seconds
<span class="nc bnc" id="L255" title="All 8 branches missed.">            timeDiffSec = (ListenerUtil.mutListener.listen(7773) ? (timeDiff % 1E9) : (ListenerUtil.mutListener.listen(7772) ? (timeDiff * 1E9) : (ListenerUtil.mutListener.listen(7771) ? (timeDiff - 1E9) : (ListenerUtil.mutListener.listen(7770) ? (timeDiff + 1E9) : (timeDiff / 1E9)))));</span>
        } else {
<span class="nc bnc" id="L257" title="All 8 branches missed.">            timeDiff = (ListenerUtil.mutListener.listen(7761) ? (System.currentTimeMillis() % loc.getTime()) : (ListenerUtil.mutListener.listen(7760) ? (System.currentTimeMillis() / loc.getTime()) : (ListenerUtil.mutListener.listen(7759) ? (System.currentTimeMillis() * loc.getTime()) : (ListenerUtil.mutListener.listen(7758) ? (System.currentTimeMillis() + loc.getTime()) : (System.currentTimeMillis() - loc.getTime())))));</span>
<span class="nc bnc" id="L258" title="All 8 branches missed.">            timeDiffSec = (ListenerUtil.mutListener.listen(7765) ? (timeDiff % 1E3) : (ListenerUtil.mutListener.listen(7764) ? (timeDiff * 1E3) : (ListenerUtil.mutListener.listen(7763) ? (timeDiff - 1E3) : (ListenerUtil.mutListener.listen(7762) ? (timeDiff + 1E3) : (timeDiff / 1E3)))));</span>
        }
<span class="nc" id="L260">        StringBuilder sb = new StringBuilder();</span>
<span class="nc bnc" id="L261" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7774)) {</span>
<span class="nc" id="L262">            sb.append(loc.getProvider());</span>
        }
<span class="nc bnc" id="L264" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7775)) {</span>
<span class="nc" id="L265">            sb.append(' ');</span>
        }
<span class="nc bnc" id="L267" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7776)) {</span>
<span class="nc" id="L268">            sb.append(loc.getLatitude());</span>
        }
<span class="nc bnc" id="L270" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7777)) {</span>
<span class="nc" id="L271">            sb.append(',');</span>
        }
<span class="nc bnc" id="L273" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7778)) {</span>
<span class="nc" id="L274">            sb.append(loc.getLongitude());</span>
        }
<span class="nc bnc" id="L276" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7781)) {</span>
<span class="nc bnc" id="L277" title="All 2 branches missed.">            if (loc.hasAccuracy()) {</span>
<span class="nc bnc" id="L278" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7779)) {</span>
<span class="nc" id="L279">                    sb.append(' ');</span>
                }
<span class="nc bnc" id="L281" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7780)) {</span>
<span class="nc" id="L282">                    sb.append(loc.getAccuracy());</span>
                }
            }
        }
<span class="nc bnc" id="L286" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7782)) {</span>
<span class="nc" id="L287">            sb.append(&quot;, &quot;);</span>
        }
<span class="nc bnc" id="L289" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7783)) {</span>
<span class="nc" id="L290">            sb.append(String.format(&quot;%.0f&quot;, timeDiffSec) + &quot; second(s) ago&quot;);</span>
        }
<span class="nc" id="L292">        return sb.toString();</span>
    }

    /**
     * Returns a new GoogleApiClient which includes LocationServicesCallbacks
     */
    public static GoogleApiClient getGoogleApiClientWithCallbacks(Context context) {
<span class="fc" id="L299">        LocationServicesCallback locCallback = new LocationServicesCallback();</span>
<span class="fc" id="L300">        return new GoogleApiClient.Builder(context).addApi(LocationServices.API).addConnectionCallbacks(locCallback).addOnConnectionFailedListener(locCallback).build();</span>
    }

    /**
     * Class to handle Google Play Location Services callbacks
     */
<span class="fc" id="L306">    public static class LocationServicesCallback implements GoogleApiClient.ConnectionCallbacks, GoogleApiClient.OnConnectionFailedListener {</span>

        private static final String TAG = &quot;LocationServicesCallbck&quot;;

        @Override
        public void onConnected(Bundle bundle) {
<span class="nc bnc" id="L312" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7784)) {</span>
<span class="nc" id="L313">                Log.d(TAG, &quot;GoogleApiClient.onConnected&quot;);</span>
            }
<span class="nc" id="L315">        }</span>

        @Override
        public void onConnectionSuspended(int i) {
<span class="nc bnc" id="L319" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7785)) {</span>
<span class="nc" id="L320">                Log.d(TAG, &quot;GoogleApiClient.onConnectionSuspended&quot;);</span>
            }
<span class="nc" id="L322">        }</span>

        @Override
        public void onConnectionFailed(ConnectionResult connectionResult) {
<span class="nc bnc" id="L326" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7786)) {</span>
<span class="nc" id="L327">                Log.d(TAG, &quot;GoogleApiClient.onConnectionFailed&quot;);</span>
            }
<span class="nc" id="L329">        }</span>
    }

    public static List&lt;CustomAddress&gt; processGooglePlacesGeocoding(Context context, ObaRegion region, String... reqs) {
<span class="nc" id="L333">        return processGeocoding(context, region, false, reqs);</span>
    }

    public static List&lt;CustomAddress&gt; processGeocoding(Context context, ObaRegion region, boolean geocodingForMarker, String... reqs) {
<span class="nc" id="L337">        ArrayList&lt;CustomAddress&gt; addressesReturn = new ArrayList&lt;CustomAddress&gt;();</span>
<span class="nc" id="L338">        String address = reqs[0];</span>
<span class="nc bnc" id="L339" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7788)) {</span>
<span class="nc bnc" id="L340" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(7787) ? (address == null &amp;&amp; address.equalsIgnoreCase(&quot;&quot;)) : (address == null || address.equalsIgnoreCase(&quot;&quot;)))) {</span>
<span class="nc" id="L341">                return null;</span>
            }
        }
<span class="nc" id="L344">        double latitude = 0, longitude = 0;</span>
<span class="nc" id="L345">        boolean latLngSet = false;</span>
        try {
<span class="nc bnc" id="L347" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7798)) {</span>
<span class="nc bnc" id="L348" title="All 22 branches missed.">                if ((ListenerUtil.mutListener.listen(7794) ? (reqs.length &lt;= 3) : (ListenerUtil.mutListener.listen(7793) ? (reqs.length &gt; 3) : (ListenerUtil.mutListener.listen(7792) ? (reqs.length &lt; 3) : (ListenerUtil.mutListener.listen(7791) ? (reqs.length != 3) : (ListenerUtil.mutListener.listen(7790) ? (reqs.length == 3) : (reqs.length &gt;= 3))))))) {</span>
<span class="nc bnc" id="L349" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7795)) {</span>
<span class="nc" id="L350">                        latitude = Double.parseDouble(reqs[1]);</span>
                    }
<span class="nc bnc" id="L352" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7796)) {</span>
<span class="nc" id="L353">                        longitude = Double.parseDouble(reqs[2]);</span>
                    }
<span class="nc bnc" id="L355" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7797)) {</span>
<span class="nc" id="L356">                        latLngSet = true;</span>
                    }
                }
            }
<span class="nc" id="L360">        } catch (Exception e) {</span>
<span class="nc bnc" id="L361" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7789)) {</span>
<span class="nc" id="L362">                Log.e(TAG, &quot;Geocoding without reference latitude/longitude&quot;);</span>
            }
<span class="nc" id="L364">        }</span>
<span class="nc bnc" id="L365" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7804)) {</span>
<span class="nc bnc" id="L366" title="All 2 branches missed.">            if (address.equalsIgnoreCase(context.getString(R.string.tripplanner_current_location))) {</span>
<span class="nc bnc" id="L367" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7803)) {</span>
<span class="nc bnc" id="L368" title="All 2 branches missed.">                    if (latLngSet) {</span>
<span class="nc" id="L369">                        CustomAddress addressReturn = new CustomAddress(context.getResources().getConfiguration().locale);</span>
<span class="nc bnc" id="L370" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7799)) {</span>
<span class="nc" id="L371">                            addressReturn.setLatitude(latitude);</span>
                        }
<span class="nc bnc" id="L373" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7800)) {</span>
<span class="nc" id="L374">                            addressReturn.setLongitude(longitude);</span>
                        }
<span class="nc bnc" id="L376" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7801)) {</span>
<span class="nc" id="L377">                            addressReturn.setAddressLine(addressReturn.getMaxAddressLineIndex() + 1, context.getString(R.string.tripplanner_current_location));</span>
                        }
<span class="nc bnc" id="L379" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7802)) {</span>
<span class="nc" id="L380">                            addressesReturn.add(addressReturn);</span>
                        }
<span class="nc" id="L382">                        return addressesReturn;</span>
                    }
                }
<span class="nc" id="L385">                return null;</span>
            }
        }
<span class="nc" id="L388">        List&lt;CustomAddress&gt; addresses = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L389">        Geocoder gc = new Geocoder(context);</span>
        try {
            List&lt;Address&gt; androidTypeAddresses;
<span class="nc bnc" id="L392" title="All 2 branches missed.">            if (region != null) {</span>
<span class="nc" id="L393">                double[] regionSpan = new double[4];</span>
<span class="nc bnc" id="L394" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7806)) {</span>
<span class="nc" id="L395">                    RegionUtils.getRegionSpan(region, regionSpan);</span>
                }
<span class="nc bnc" id="L397" title="All 48 branches missed.">                double minLat = (ListenerUtil.mutListener.listen(7814) ? (regionSpan[2] % ((ListenerUtil.mutListener.listen(7810) ? (regionSpan[0] % 2) : (ListenerUtil.mutListener.listen(7809) ? (regionSpan[0] * 2) : (ListenerUtil.mutListener.listen(7808) ? (regionSpan[0] - 2) : (ListenerUtil.mutListener.listen(7807) ? (regionSpan[0] + 2) : (regionSpan[0] / 2))))))) : (ListenerUtil.mutListener.listen(7813) ? (regionSpan[2] / ((ListenerUtil.mutListener.listen(7810) ? (regionSpan[0] % 2) : (ListenerUtil.mutListener.listen(7809) ? (regionSpan[0] * 2) : (ListenerUtil.mutListener.listen(7808) ? (regionSpan[0] - 2) : (ListenerUtil.mutListener.listen(7807) ? (regionSpan[0] + 2) : (regionSpan[0] / 2))))))) : (ListenerUtil.mutListener.listen(7812) ? (regionSpan[2] * ((ListenerUtil.mutListener.listen(7810) ? (regionSpan[0] % 2) : (ListenerUtil.mutListener.listen(7809) ? (regionSpan[0] * 2) : (ListenerUtil.mutListener.listen(7808) ? (regionSpan[0] - 2) : (ListenerUtil.mutListener.listen(7807) ? (regionSpan[0] + 2) : (regionSpan[0] / 2))))))) : (ListenerUtil.mutListener.listen(7811) ? (regionSpan[2] + ((ListenerUtil.mutListener.listen(7810) ? (regionSpan[0] % 2) : (ListenerUtil.mutListener.listen(7809) ? (regionSpan[0] * 2) : (ListenerUtil.mutListener.listen(7808) ? (regionSpan[0] - 2) : (ListenerUtil.mutListener.listen(7807) ? (regionSpan[0] + 2) : (regionSpan[0] / 2))))))) : (regionSpan[2] - ((ListenerUtil.mutListener.listen(7810) ? (regionSpan[0] % 2) : (ListenerUtil.mutListener.listen(7809) ? (regionSpan[0] * 2) : (ListenerUtil.mutListener.listen(7808) ? (regionSpan[0] - 2) : (ListenerUtil.mutListener.listen(7807) ? (regionSpan[0] + 2) : (regionSpan[0] / 2)))))))))));</span>
<span class="nc bnc" id="L398" title="All 48 branches missed.">                double minLon = (ListenerUtil.mutListener.listen(7822) ? (regionSpan[3] % ((ListenerUtil.mutListener.listen(7818) ? (regionSpan[1] % 2) : (ListenerUtil.mutListener.listen(7817) ? (regionSpan[1] * 2) : (ListenerUtil.mutListener.listen(7816) ? (regionSpan[1] - 2) : (ListenerUtil.mutListener.listen(7815) ? (regionSpan[1] + 2) : (regionSpan[1] / 2))))))) : (ListenerUtil.mutListener.listen(7821) ? (regionSpan[3] / ((ListenerUtil.mutListener.listen(7818) ? (regionSpan[1] % 2) : (ListenerUtil.mutListener.listen(7817) ? (regionSpan[1] * 2) : (ListenerUtil.mutListener.listen(7816) ? (regionSpan[1] - 2) : (ListenerUtil.mutListener.listen(7815) ? (regionSpan[1] + 2) : (regionSpan[1] / 2))))))) : (ListenerUtil.mutListener.listen(7820) ? (regionSpan[3] * ((ListenerUtil.mutListener.listen(7818) ? (regionSpan[1] % 2) : (ListenerUtil.mutListener.listen(7817) ? (regionSpan[1] * 2) : (ListenerUtil.mutListener.listen(7816) ? (regionSpan[1] - 2) : (ListenerUtil.mutListener.listen(7815) ? (regionSpan[1] + 2) : (regionSpan[1] / 2))))))) : (ListenerUtil.mutListener.listen(7819) ? (regionSpan[3] + ((ListenerUtil.mutListener.listen(7818) ? (regionSpan[1] % 2) : (ListenerUtil.mutListener.listen(7817) ? (regionSpan[1] * 2) : (ListenerUtil.mutListener.listen(7816) ? (regionSpan[1] - 2) : (ListenerUtil.mutListener.listen(7815) ? (regionSpan[1] + 2) : (regionSpan[1] / 2))))))) : (regionSpan[3] - ((ListenerUtil.mutListener.listen(7818) ? (regionSpan[1] % 2) : (ListenerUtil.mutListener.listen(7817) ? (regionSpan[1] * 2) : (ListenerUtil.mutListener.listen(7816) ? (regionSpan[1] - 2) : (ListenerUtil.mutListener.listen(7815) ? (regionSpan[1] + 2) : (regionSpan[1] / 2)))))))))));</span>
<span class="nc bnc" id="L399" title="All 48 branches missed.">                double maxLat = (ListenerUtil.mutListener.listen(7830) ? (regionSpan[2] % ((ListenerUtil.mutListener.listen(7826) ? (regionSpan[0] % 2) : (ListenerUtil.mutListener.listen(7825) ? (regionSpan[0] * 2) : (ListenerUtil.mutListener.listen(7824) ? (regionSpan[0] - 2) : (ListenerUtil.mutListener.listen(7823) ? (regionSpan[0] + 2) : (regionSpan[0] / 2))))))) : (ListenerUtil.mutListener.listen(7829) ? (regionSpan[2] / ((ListenerUtil.mutListener.listen(7826) ? (regionSpan[0] % 2) : (ListenerUtil.mutListener.listen(7825) ? (regionSpan[0] * 2) : (ListenerUtil.mutListener.listen(7824) ? (regionSpan[0] - 2) : (ListenerUtil.mutListener.listen(7823) ? (regionSpan[0] + 2) : (regionSpan[0] / 2))))))) : (ListenerUtil.mutListener.listen(7828) ? (regionSpan[2] * ((ListenerUtil.mutListener.listen(7826) ? (regionSpan[0] % 2) : (ListenerUtil.mutListener.listen(7825) ? (regionSpan[0] * 2) : (ListenerUtil.mutListener.listen(7824) ? (regionSpan[0] - 2) : (ListenerUtil.mutListener.listen(7823) ? (regionSpan[0] + 2) : (regionSpan[0] / 2))))))) : (ListenerUtil.mutListener.listen(7827) ? (regionSpan[2] - ((ListenerUtil.mutListener.listen(7826) ? (regionSpan[0] % 2) : (ListenerUtil.mutListener.listen(7825) ? (regionSpan[0] * 2) : (ListenerUtil.mutListener.listen(7824) ? (regionSpan[0] - 2) : (ListenerUtil.mutListener.listen(7823) ? (regionSpan[0] + 2) : (regionSpan[0] / 2))))))) : (regionSpan[2] + ((ListenerUtil.mutListener.listen(7826) ? (regionSpan[0] % 2) : (ListenerUtil.mutListener.listen(7825) ? (regionSpan[0] * 2) : (ListenerUtil.mutListener.listen(7824) ? (regionSpan[0] - 2) : (ListenerUtil.mutListener.listen(7823) ? (regionSpan[0] + 2) : (regionSpan[0] / 2)))))))))));</span>
<span class="nc bnc" id="L400" title="All 48 branches missed.">                double maxLon = (ListenerUtil.mutListener.listen(7838) ? (regionSpan[3] % ((ListenerUtil.mutListener.listen(7834) ? (regionSpan[1] % 2) : (ListenerUtil.mutListener.listen(7833) ? (regionSpan[1] * 2) : (ListenerUtil.mutListener.listen(7832) ? (regionSpan[1] - 2) : (ListenerUtil.mutListener.listen(7831) ? (regionSpan[1] + 2) : (regionSpan[1] / 2))))))) : (ListenerUtil.mutListener.listen(7837) ? (regionSpan[3] / ((ListenerUtil.mutListener.listen(7834) ? (regionSpan[1] % 2) : (ListenerUtil.mutListener.listen(7833) ? (regionSpan[1] * 2) : (ListenerUtil.mutListener.listen(7832) ? (regionSpan[1] - 2) : (ListenerUtil.mutListener.listen(7831) ? (regionSpan[1] + 2) : (regionSpan[1] / 2))))))) : (ListenerUtil.mutListener.listen(7836) ? (regionSpan[3] * ((ListenerUtil.mutListener.listen(7834) ? (regionSpan[1] % 2) : (ListenerUtil.mutListener.listen(7833) ? (regionSpan[1] * 2) : (ListenerUtil.mutListener.listen(7832) ? (regionSpan[1] - 2) : (ListenerUtil.mutListener.listen(7831) ? (regionSpan[1] + 2) : (regionSpan[1] / 2))))))) : (ListenerUtil.mutListener.listen(7835) ? (regionSpan[3] - ((ListenerUtil.mutListener.listen(7834) ? (regionSpan[1] % 2) : (ListenerUtil.mutListener.listen(7833) ? (regionSpan[1] * 2) : (ListenerUtil.mutListener.listen(7832) ? (regionSpan[1] - 2) : (ListenerUtil.mutListener.listen(7831) ? (regionSpan[1] + 2) : (regionSpan[1] / 2))))))) : (regionSpan[3] + ((ListenerUtil.mutListener.listen(7834) ? (regionSpan[1] % 2) : (ListenerUtil.mutListener.listen(7833) ? (regionSpan[1] * 2) : (ListenerUtil.mutListener.listen(7832) ? (regionSpan[1] - 2) : (ListenerUtil.mutListener.listen(7831) ? (regionSpan[1] + 2) : (regionSpan[1] / 2)))))))))));</span>
<span class="nc" id="L401">                androidTypeAddresses = gc.getFromLocationName(address, GEOCODER_MAX_RESULTS, minLat, minLon, maxLat, maxLon);</span>
<span class="nc" id="L402">            } else {</span>
<span class="nc" id="L403">                androidTypeAddresses = gc.getFromLocationName(address, GEOCODER_MAX_RESULTS);</span>
            }
<span class="nc bnc" id="L405" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7840)) {</span>
                {
<span class="nc" id="L407">                    long _loopCounter94 = 0;</span>
<span class="nc bnc" id="L408" title="All 2 branches missed.">                    for (Address androidTypeAddress : androidTypeAddresses) {</span>
<span class="nc" id="L409">                        ListenerUtil.loopListener.listen(&quot;_loopCounter94&quot;, ++_loopCounter94);</span>
<span class="nc bnc" id="L410" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7839)) {</span>
<span class="nc" id="L411">                            addresses.add(new CustomAddress(androidTypeAddress));</span>
                        }
<span class="nc" id="L413">                    }</span>
                }
            }
<span class="nc" id="L416">        } catch (IOException e) {</span>
<span class="nc bnc" id="L417" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7805)) {</span>
<span class="nc" id="L418">                e.printStackTrace();</span>
            }
<span class="nc" id="L420">        }</span>
<span class="nc bnc" id="L421" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7841)) {</span>
<span class="nc" id="L422">            addresses = filterAddressesBBox(region, addresses);</span>
        }
<span class="nc" id="L424">        boolean resultsCloseEnough = true;</span>
<span class="nc bnc" id="L425" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7853)) {</span>
<span class="nc bnc" id="L426" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(7842) ? (geocodingForMarker || latLngSet) : (geocodingForMarker &amp;&amp; latLngSet))) {</span>
<span class="nc" id="L427">                float[] results = new float[1];</span>
<span class="nc bnc" id="L428" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7843)) {</span>
<span class="nc" id="L429">                    resultsCloseEnough = false;</span>
                }
<span class="nc bnc" id="L431" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7852)) {</span>
                    {
<span class="nc" id="L433">                        long _loopCounter95 = 0;</span>
<span class="nc bnc" id="L434" title="All 2 branches missed.">                        for (CustomAddress addressToCheck : addresses) {</span>
<span class="nc" id="L435">                            ListenerUtil.loopListener.listen(&quot;_loopCounter95&quot;, ++_loopCounter95);</span>
<span class="nc bnc" id="L436" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7844)) {</span>
<span class="nc" id="L437">                                Location.distanceBetween(latitude, longitude, addressToCheck.getLatitude(), addressToCheck.getLongitude(), results);</span>
                            }
<span class="nc bnc" id="L439" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7851)) {</span>
<span class="nc bnc" id="L440" title="All 22 branches missed.">                                if ((ListenerUtil.mutListener.listen(7849) ? (results[0] &gt;= GEOCODING_MAX_ERROR) : (ListenerUtil.mutListener.listen(7848) ? (results[0] &lt;= GEOCODING_MAX_ERROR) : (ListenerUtil.mutListener.listen(7847) ? (results[0] &gt; GEOCODING_MAX_ERROR) : (ListenerUtil.mutListener.listen(7846) ? (results[0] != GEOCODING_MAX_ERROR) : (ListenerUtil.mutListener.listen(7845) ? (results[0] == GEOCODING_MAX_ERROR) : (results[0] &lt; GEOCODING_MAX_ERROR))))))) {</span>
<span class="nc bnc" id="L441" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(7850)) {</span>
<span class="nc" id="L442">                                        resultsCloseEnough = true;</span>
                                    }
                                    break;
                                }
                            }
<span class="nc" id="L447">                        }</span>
                    }
                }
            }
        }
<span class="nc bnc" id="L452" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7859)) {</span>
<span class="nc bnc" id="L453" title="All 26 branches missed.">            if ((ListenerUtil.mutListener.listen(7855) ? ((ListenerUtil.mutListener.listen(7854) ? ((addresses == null) &amp;&amp; addresses.isEmpty()) : ((addresses == null) || addresses.isEmpty())) &amp;&amp; !resultsCloseEnough) : ((ListenerUtil.mutListener.listen(7854) ? ((addresses == null) &amp;&amp; addresses.isEmpty()) : ((addresses == null) || addresses.isEmpty())) || !resultsCloseEnough))) {</span>
<span class="nc bnc" id="L454" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7857)) {</span>
<span class="nc bnc" id="L455" title="All 2 branches missed.">                    if (addresses == null) {</span>
<span class="nc bnc" id="L456" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7856)) {</span>
<span class="nc" id="L457">                            addresses = new ArrayList&lt;CustomAddress&gt;();</span>
                        }
                    }
                }
<span class="nc bnc" id="L461" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7858)) {</span>
<span class="nc" id="L462">                    Log.e(TAG, &quot;Geocoder did not find enough addresses: &quot; + addresses);</span>
                }
            }
        }
<span class="nc bnc" id="L466" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7860)) {</span>
<span class="nc" id="L467">            addresses = filterAddressesBBox(region, addresses);</span>
        }
<span class="nc bnc" id="L469" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7876)) {</span>
<span class="nc bnc" id="L470" title="All 58 branches missed.">            if ((ListenerUtil.mutListener.listen(7863) ? ((ListenerUtil.mutListener.listen(7862) ? ((ListenerUtil.mutListener.listen(7861) ? (geocodingForMarker || latLngSet) : (geocodingForMarker &amp;&amp; latLngSet)) || addresses != null) : ((ListenerUtil.mutListener.listen(7861) ? (geocodingForMarker || latLngSet) : (geocodingForMarker &amp;&amp; latLngSet)) &amp;&amp; addresses != null)) || !addresses.isEmpty()) : ((ListenerUtil.mutListener.listen(7862) ? ((ListenerUtil.mutListener.listen(7861) ? (geocodingForMarker || latLngSet) : (geocodingForMarker &amp;&amp; latLngSet)) || addresses != null) : ((ListenerUtil.mutListener.listen(7861) ? (geocodingForMarker || latLngSet) : (geocodingForMarker &amp;&amp; latLngSet)) &amp;&amp; addresses != null)) &amp;&amp; !addresses.isEmpty()))) {</span>
<span class="nc" id="L471">                float[] results = new float[1];</span>
<span class="nc" id="L472">                float minDistanceToOriginalLatLon = Float.MAX_VALUE;</span>
<span class="nc" id="L473">                CustomAddress closestAddress = addresses.get(0);</span>
<span class="nc bnc" id="L474" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7874)) {</span>
                    {
<span class="nc" id="L476">                        long _loopCounter96 = 0;</span>
<span class="nc bnc" id="L477" title="All 2 branches missed.">                        for (CustomAddress addressToCheck : addresses) {</span>
<span class="nc" id="L478">                            ListenerUtil.loopListener.listen(&quot;_loopCounter96&quot;, ++_loopCounter96);</span>
<span class="nc bnc" id="L479" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7865)) {</span>
<span class="nc" id="L480">                                Location.distanceBetween(latitude, longitude, addressToCheck.getLatitude(), addressToCheck.getLongitude(), results);</span>
                            }
<span class="nc bnc" id="L482" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7873)) {</span>
<span class="nc bnc" id="L483" title="All 22 branches missed.">                                if ((ListenerUtil.mutListener.listen(7870) ? (results[0] &gt;= minDistanceToOriginalLatLon) : (ListenerUtil.mutListener.listen(7869) ? (results[0] &lt;= minDistanceToOriginalLatLon) : (ListenerUtil.mutListener.listen(7868) ? (results[0] &gt; minDistanceToOriginalLatLon) : (ListenerUtil.mutListener.listen(7867) ? (results[0] != minDistanceToOriginalLatLon) : (ListenerUtil.mutListener.listen(7866) ? (results[0] == minDistanceToOriginalLatLon) : (results[0] &lt; minDistanceToOriginalLatLon))))))) {</span>
<span class="nc bnc" id="L484" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(7871)) {</span>
<span class="nc" id="L485">                                        closestAddress = addressToCheck;</span>
                                    }
<span class="nc bnc" id="L487" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(7872)) {</span>
<span class="nc" id="L488">                                        minDistanceToOriginalLatLon = results[0];</span>
                                    }
                                }
                            }
<span class="nc" id="L492">                        }</span>
                    }
                }
<span class="nc bnc" id="L495" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7875)) {</span>
<span class="nc" id="L496">                    addressesReturn.add(closestAddress);</span>
                }
<span class="nc" id="L498">            } else {</span>
<span class="nc bnc" id="L499" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7864)) {</span>
<span class="nc" id="L500">                    addressesReturn.addAll(addresses);</span>
                }
            }
        }
<span class="nc" id="L504">        return addressesReturn;</span>
    }

    public static List&lt;CustomAddress&gt; processPeliasGeocoding(Context context, ObaRegion region, String... reqs) {
<span class="nc" id="L508">        return processPeliasGeocoding(context, region, false, reqs);</span>
    }

    public static List&lt;CustomAddress&gt; processPeliasGeocoding(Context context, ObaRegion region, boolean geocodingForMarker, String... reqs) {
<span class="nc" id="L512">        ArrayList&lt;CustomAddress&gt; addressesReturn = new ArrayList&lt;CustomAddress&gt;();</span>
<span class="nc" id="L513">        String address = reqs[0];</span>
<span class="nc bnc" id="L514" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7878)) {</span>
<span class="nc bnc" id="L515" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(7877) ? (address == null &amp;&amp; address.equalsIgnoreCase(&quot;&quot;)) : (address == null || address.equalsIgnoreCase(&quot;&quot;)))) {</span>
<span class="nc" id="L516">                return null;</span>
            }
        }
<span class="nc" id="L519">        double latitude = 0, longitude = 0;</span>
<span class="nc" id="L520">        boolean latLngSet = false;</span>
        try {
<span class="nc bnc" id="L522" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7888)) {</span>
<span class="nc bnc" id="L523" title="All 22 branches missed.">                if ((ListenerUtil.mutListener.listen(7884) ? (reqs.length &lt;= 3) : (ListenerUtil.mutListener.listen(7883) ? (reqs.length &gt; 3) : (ListenerUtil.mutListener.listen(7882) ? (reqs.length &lt; 3) : (ListenerUtil.mutListener.listen(7881) ? (reqs.length != 3) : (ListenerUtil.mutListener.listen(7880) ? (reqs.length == 3) : (reqs.length &gt;= 3))))))) {</span>
<span class="nc bnc" id="L524" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7885)) {</span>
<span class="nc" id="L525">                        latitude = Double.parseDouble(reqs[1]);</span>
                    }
<span class="nc bnc" id="L527" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7886)) {</span>
<span class="nc" id="L528">                        longitude = Double.parseDouble(reqs[2]);</span>
                    }
<span class="nc bnc" id="L530" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7887)) {</span>
<span class="nc" id="L531">                        latLngSet = true;</span>
                    }
                }
            }
<span class="nc" id="L535">        } catch (Exception e) {</span>
<span class="nc bnc" id="L536" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7879)) {</span>
<span class="nc" id="L537">                Log.e(TAG, &quot;Geocoding without reference latitude/longitude&quot;);</span>
            }
<span class="nc" id="L539">        }</span>
<span class="nc bnc" id="L540" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7894)) {</span>
<span class="nc bnc" id="L541" title="All 2 branches missed.">            if (address.equalsIgnoreCase(context.getString(R.string.tripplanner_current_location))) {</span>
<span class="nc bnc" id="L542" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7893)) {</span>
<span class="nc bnc" id="L543" title="All 2 branches missed.">                    if (latLngSet) {</span>
<span class="nc" id="L544">                        CustomAddress addressReturn = new CustomAddress(context.getResources().getConfiguration().locale);</span>
<span class="nc bnc" id="L545" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7889)) {</span>
<span class="nc" id="L546">                            addressReturn.setLatitude(latitude);</span>
                        }
<span class="nc bnc" id="L548" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7890)) {</span>
<span class="nc" id="L549">                            addressReturn.setLongitude(longitude);</span>
                        }
<span class="nc bnc" id="L551" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7891)) {</span>
<span class="nc" id="L552">                            addressReturn.setAddressLine(addressReturn.getMaxAddressLineIndex() + 1, context.getString(R.string.tripplanner_current_location));</span>
                        }
<span class="nc bnc" id="L554" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7892)) {</span>
<span class="nc" id="L555">                            addressesReturn.add(addressReturn);</span>
                        }
<span class="nc" id="L557">                        return addressesReturn;</span>
                    }
                }
<span class="nc" id="L560">                return null;</span>
            }
        }
<span class="nc" id="L563">        List&lt;CustomAddress&gt; addresses = new ArrayList&lt;&gt;();</span>
        try {
<span class="nc" id="L565">            String apiKey = BuildConfig.PELIAS_API_KEY;</span>
<span class="nc" id="L566">            PeliasRequest.Builder requestBuilder = new AutocompleteRequest.Builder(apiKey, address).setApiEndpoint(Application.get().getString(R.string.pelias_api_url));</span>
<span class="nc bnc" id="L567" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7930)) {</span>
<span class="nc bnc" id="L568" title="All 2 branches missed.">                if (region != null) {</span>
<span class="nc" id="L569">                    double[] regionSpan = new double[4];</span>
<span class="nc bnc" id="L570" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7896)) {</span>
<span class="nc" id="L571">                        RegionUtils.getRegionSpan(region, regionSpan);</span>
                    }
<span class="nc bnc" id="L573" title="All 48 branches missed.">                    double minLat = (ListenerUtil.mutListener.listen(7904) ? (regionSpan[2] % ((ListenerUtil.mutListener.listen(7900) ? (regionSpan[0] % 2) : (ListenerUtil.mutListener.listen(7899) ? (regionSpan[0] * 2) : (ListenerUtil.mutListener.listen(7898) ? (regionSpan[0] - 2) : (ListenerUtil.mutListener.listen(7897) ? (regionSpan[0] + 2) : (regionSpan[0] / 2))))))) : (ListenerUtil.mutListener.listen(7903) ? (regionSpan[2] / ((ListenerUtil.mutListener.listen(7900) ? (regionSpan[0] % 2) : (ListenerUtil.mutListener.listen(7899) ? (regionSpan[0] * 2) : (ListenerUtil.mutListener.listen(7898) ? (regionSpan[0] - 2) : (ListenerUtil.mutListener.listen(7897) ? (regionSpan[0] + 2) : (regionSpan[0] / 2))))))) : (ListenerUtil.mutListener.listen(7902) ? (regionSpan[2] * ((ListenerUtil.mutListener.listen(7900) ? (regionSpan[0] % 2) : (ListenerUtil.mutListener.listen(7899) ? (regionSpan[0] * 2) : (ListenerUtil.mutListener.listen(7898) ? (regionSpan[0] - 2) : (ListenerUtil.mutListener.listen(7897) ? (regionSpan[0] + 2) : (regionSpan[0] / 2))))))) : (ListenerUtil.mutListener.listen(7901) ? (regionSpan[2] + ((ListenerUtil.mutListener.listen(7900) ? (regionSpan[0] % 2) : (ListenerUtil.mutListener.listen(7899) ? (regionSpan[0] * 2) : (ListenerUtil.mutListener.listen(7898) ? (regionSpan[0] - 2) : (ListenerUtil.mutListener.listen(7897) ? (regionSpan[0] + 2) : (regionSpan[0] / 2))))))) : (regionSpan[2] - ((ListenerUtil.mutListener.listen(7900) ? (regionSpan[0] % 2) : (ListenerUtil.mutListener.listen(7899) ? (regionSpan[0] * 2) : (ListenerUtil.mutListener.listen(7898) ? (regionSpan[0] - 2) : (ListenerUtil.mutListener.listen(7897) ? (regionSpan[0] + 2) : (regionSpan[0] / 2)))))))))));</span>
<span class="nc bnc" id="L574" title="All 48 branches missed.">                    double minLon = (ListenerUtil.mutListener.listen(7912) ? (regionSpan[3] % ((ListenerUtil.mutListener.listen(7908) ? (regionSpan[1] % 2) : (ListenerUtil.mutListener.listen(7907) ? (regionSpan[1] * 2) : (ListenerUtil.mutListener.listen(7906) ? (regionSpan[1] - 2) : (ListenerUtil.mutListener.listen(7905) ? (regionSpan[1] + 2) : (regionSpan[1] / 2))))))) : (ListenerUtil.mutListener.listen(7911) ? (regionSpan[3] / ((ListenerUtil.mutListener.listen(7908) ? (regionSpan[1] % 2) : (ListenerUtil.mutListener.listen(7907) ? (regionSpan[1] * 2) : (ListenerUtil.mutListener.listen(7906) ? (regionSpan[1] - 2) : (ListenerUtil.mutListener.listen(7905) ? (regionSpan[1] + 2) : (regionSpan[1] / 2))))))) : (ListenerUtil.mutListener.listen(7910) ? (regionSpan[3] * ((ListenerUtil.mutListener.listen(7908) ? (regionSpan[1] % 2) : (ListenerUtil.mutListener.listen(7907) ? (regionSpan[1] * 2) : (ListenerUtil.mutListener.listen(7906) ? (regionSpan[1] - 2) : (ListenerUtil.mutListener.listen(7905) ? (regionSpan[1] + 2) : (regionSpan[1] / 2))))))) : (ListenerUtil.mutListener.listen(7909) ? (regionSpan[3] + ((ListenerUtil.mutListener.listen(7908) ? (regionSpan[1] % 2) : (ListenerUtil.mutListener.listen(7907) ? (regionSpan[1] * 2) : (ListenerUtil.mutListener.listen(7906) ? (regionSpan[1] - 2) : (ListenerUtil.mutListener.listen(7905) ? (regionSpan[1] + 2) : (regionSpan[1] / 2))))))) : (regionSpan[3] - ((ListenerUtil.mutListener.listen(7908) ? (regionSpan[1] % 2) : (ListenerUtil.mutListener.listen(7907) ? (regionSpan[1] * 2) : (ListenerUtil.mutListener.listen(7906) ? (regionSpan[1] - 2) : (ListenerUtil.mutListener.listen(7905) ? (regionSpan[1] + 2) : (regionSpan[1] / 2)))))))))));</span>
<span class="nc bnc" id="L575" title="All 48 branches missed.">                    double maxLat = (ListenerUtil.mutListener.listen(7920) ? (regionSpan[2] % ((ListenerUtil.mutListener.listen(7916) ? (regionSpan[0] % 2) : (ListenerUtil.mutListener.listen(7915) ? (regionSpan[0] * 2) : (ListenerUtil.mutListener.listen(7914) ? (regionSpan[0] - 2) : (ListenerUtil.mutListener.listen(7913) ? (regionSpan[0] + 2) : (regionSpan[0] / 2))))))) : (ListenerUtil.mutListener.listen(7919) ? (regionSpan[2] / ((ListenerUtil.mutListener.listen(7916) ? (regionSpan[0] % 2) : (ListenerUtil.mutListener.listen(7915) ? (regionSpan[0] * 2) : (ListenerUtil.mutListener.listen(7914) ? (regionSpan[0] - 2) : (ListenerUtil.mutListener.listen(7913) ? (regionSpan[0] + 2) : (regionSpan[0] / 2))))))) : (ListenerUtil.mutListener.listen(7918) ? (regionSpan[2] * ((ListenerUtil.mutListener.listen(7916) ? (regionSpan[0] % 2) : (ListenerUtil.mutListener.listen(7915) ? (regionSpan[0] * 2) : (ListenerUtil.mutListener.listen(7914) ? (regionSpan[0] - 2) : (ListenerUtil.mutListener.listen(7913) ? (regionSpan[0] + 2) : (regionSpan[0] / 2))))))) : (ListenerUtil.mutListener.listen(7917) ? (regionSpan[2] - ((ListenerUtil.mutListener.listen(7916) ? (regionSpan[0] % 2) : (ListenerUtil.mutListener.listen(7915) ? (regionSpan[0] * 2) : (ListenerUtil.mutListener.listen(7914) ? (regionSpan[0] - 2) : (ListenerUtil.mutListener.listen(7913) ? (regionSpan[0] + 2) : (regionSpan[0] / 2))))))) : (regionSpan[2] + ((ListenerUtil.mutListener.listen(7916) ? (regionSpan[0] % 2) : (ListenerUtil.mutListener.listen(7915) ? (regionSpan[0] * 2) : (ListenerUtil.mutListener.listen(7914) ? (regionSpan[0] - 2) : (ListenerUtil.mutListener.listen(7913) ? (regionSpan[0] + 2) : (regionSpan[0] / 2)))))))))));</span>
<span class="nc bnc" id="L576" title="All 48 branches missed.">                    double maxLon = (ListenerUtil.mutListener.listen(7928) ? (regionSpan[3] % ((ListenerUtil.mutListener.listen(7924) ? (regionSpan[1] % 2) : (ListenerUtil.mutListener.listen(7923) ? (regionSpan[1] * 2) : (ListenerUtil.mutListener.listen(7922) ? (regionSpan[1] - 2) : (ListenerUtil.mutListener.listen(7921) ? (regionSpan[1] + 2) : (regionSpan[1] / 2))))))) : (ListenerUtil.mutListener.listen(7927) ? (regionSpan[3] / ((ListenerUtil.mutListener.listen(7924) ? (regionSpan[1] % 2) : (ListenerUtil.mutListener.listen(7923) ? (regionSpan[1] * 2) : (ListenerUtil.mutListener.listen(7922) ? (regionSpan[1] - 2) : (ListenerUtil.mutListener.listen(7921) ? (regionSpan[1] + 2) : (regionSpan[1] / 2))))))) : (ListenerUtil.mutListener.listen(7926) ? (regionSpan[3] * ((ListenerUtil.mutListener.listen(7924) ? (regionSpan[1] % 2) : (ListenerUtil.mutListener.listen(7923) ? (regionSpan[1] * 2) : (ListenerUtil.mutListener.listen(7922) ? (regionSpan[1] - 2) : (ListenerUtil.mutListener.listen(7921) ? (regionSpan[1] + 2) : (regionSpan[1] / 2))))))) : (ListenerUtil.mutListener.listen(7925) ? (regionSpan[3] - ((ListenerUtil.mutListener.listen(7924) ? (regionSpan[1] % 2) : (ListenerUtil.mutListener.listen(7923) ? (regionSpan[1] * 2) : (ListenerUtil.mutListener.listen(7922) ? (regionSpan[1] - 2) : (ListenerUtil.mutListener.listen(7921) ? (regionSpan[1] + 2) : (regionSpan[1] / 2))))))) : (regionSpan[3] + ((ListenerUtil.mutListener.listen(7924) ? (regionSpan[1] % 2) : (ListenerUtil.mutListener.listen(7923) ? (regionSpan[1] * 2) : (ListenerUtil.mutListener.listen(7922) ? (regionSpan[1] - 2) : (ListenerUtil.mutListener.listen(7921) ? (regionSpan[1] + 2) : (regionSpan[1] / 2)))))))))));</span>
<span class="nc bnc" id="L577" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(7929)) {</span>
<span class="nc" id="L578">                        requestBuilder.setBoundaryRect(minLat, minLon, maxLat, maxLon);</span>
                    }
                }
            }
<span class="nc bnc" id="L582" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7931)) {</span>
                // Includes categories so we know if it's transit-related
<span class="nc" id="L584">                requestBuilder.setCategories(&quot;&quot;);</span>
            }
            // Call the Pelias API
<span class="nc" id="L587">            PeliasResponse response = requestBuilder.build().call();</span>
<span class="nc bnc" id="L588" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7933)) {</span>
                {
<span class="nc" id="L590">                    long _loopCounter97 = 0;</span>
<span class="nc bnc" id="L591" title="All 2 branches missed.">                    for (org.geojson.Feature feature : response.getFeatures()) {</span>
<span class="nc" id="L592">                        ListenerUtil.loopListener.listen(&quot;_loopCounter97&quot;, ++_loopCounter97);</span>
<span class="nc bnc" id="L593" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7932)) {</span>
<span class="nc" id="L594">                            addresses.add(new CustomAddress(feature));</span>
                        }
                    }
                }
            }
<span class="nc" id="L599">        } catch (IOException e) {</span>
<span class="nc bnc" id="L600" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(7895)) {</span>
<span class="nc" id="L601">                Log.e(TAG, e.toString());</span>
            }
<span class="nc" id="L603">        }</span>
<span class="nc bnc" id="L604" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7934)) {</span>
<span class="nc" id="L605">            addresses = filterAddressesBBox(region, addresses);</span>
        }
<span class="nc" id="L607">        boolean resultsCloseEnough = true;</span>
<span class="nc bnc" id="L608" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7946)) {</span>
<span class="nc bnc" id="L609" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(7935) ? (geocodingForMarker || latLngSet) : (geocodingForMarker &amp;&amp; latLngSet))) {</span>
<span class="nc" id="L610">                float[] results = new float[1];</span>
<span class="nc bnc" id="L611" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7936)) {</span>
<span class="nc" id="L612">                    resultsCloseEnough = false;</span>
                }
<span class="nc bnc" id="L614" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7945)) {</span>
                    {
<span class="nc" id="L616">                        long _loopCounter98 = 0;</span>
<span class="nc bnc" id="L617" title="All 2 branches missed.">                        for (CustomAddress addressToCheck : addresses) {</span>
<span class="nc" id="L618">                            ListenerUtil.loopListener.listen(&quot;_loopCounter98&quot;, ++_loopCounter98);</span>
<span class="nc bnc" id="L619" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7937)) {</span>
<span class="nc" id="L620">                                Location.distanceBetween(latitude, longitude, addressToCheck.getLatitude(), addressToCheck.getLongitude(), results);</span>
                            }
<span class="nc bnc" id="L622" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7944)) {</span>
<span class="nc bnc" id="L623" title="All 22 branches missed.">                                if ((ListenerUtil.mutListener.listen(7942) ? (results[0] &gt;= GEOCODING_MAX_ERROR) : (ListenerUtil.mutListener.listen(7941) ? (results[0] &lt;= GEOCODING_MAX_ERROR) : (ListenerUtil.mutListener.listen(7940) ? (results[0] &gt; GEOCODING_MAX_ERROR) : (ListenerUtil.mutListener.listen(7939) ? (results[0] != GEOCODING_MAX_ERROR) : (ListenerUtil.mutListener.listen(7938) ? (results[0] == GEOCODING_MAX_ERROR) : (results[0] &lt; GEOCODING_MAX_ERROR))))))) {</span>
<span class="nc bnc" id="L624" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(7943)) {</span>
<span class="nc" id="L625">                                        resultsCloseEnough = true;</span>
                                    }
                                    break;
                                }
                            }
<span class="nc" id="L630">                        }</span>
                    }
                }
            }
        }
<span class="nc bnc" id="L635" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7952)) {</span>
<span class="nc bnc" id="L636" title="All 26 branches missed.">            if ((ListenerUtil.mutListener.listen(7948) ? ((ListenerUtil.mutListener.listen(7947) ? ((addresses == null) &amp;&amp; addresses.isEmpty()) : ((addresses == null) || addresses.isEmpty())) &amp;&amp; !resultsCloseEnough) : ((ListenerUtil.mutListener.listen(7947) ? ((addresses == null) &amp;&amp; addresses.isEmpty()) : ((addresses == null) || addresses.isEmpty())) || !resultsCloseEnough))) {</span>
<span class="nc bnc" id="L637" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7950)) {</span>
<span class="nc bnc" id="L638" title="All 2 branches missed.">                    if (addresses == null) {</span>
<span class="nc bnc" id="L639" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(7949)) {</span>
<span class="nc" id="L640">                            addresses = new ArrayList&lt;CustomAddress&gt;();</span>
                        }
                    }
                }
<span class="nc bnc" id="L644" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7951)) {</span>
<span class="nc" id="L645">                    Log.e(TAG, &quot;Geocoder did not find enough addresses: &quot; + addresses);</span>
                }
            }
        }
<span class="nc bnc" id="L649" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7953)) {</span>
<span class="nc" id="L650">            addresses = filterAddressesBBox(region, addresses);</span>
        }
<span class="nc bnc" id="L652" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7969)) {</span>
<span class="nc bnc" id="L653" title="All 58 branches missed.">            if ((ListenerUtil.mutListener.listen(7956) ? ((ListenerUtil.mutListener.listen(7955) ? ((ListenerUtil.mutListener.listen(7954) ? (geocodingForMarker || latLngSet) : (geocodingForMarker &amp;&amp; latLngSet)) || addresses != null) : ((ListenerUtil.mutListener.listen(7954) ? (geocodingForMarker || latLngSet) : (geocodingForMarker &amp;&amp; latLngSet)) &amp;&amp; addresses != null)) || !addresses.isEmpty()) : ((ListenerUtil.mutListener.listen(7955) ? ((ListenerUtil.mutListener.listen(7954) ? (geocodingForMarker || latLngSet) : (geocodingForMarker &amp;&amp; latLngSet)) || addresses != null) : ((ListenerUtil.mutListener.listen(7954) ? (geocodingForMarker || latLngSet) : (geocodingForMarker &amp;&amp; latLngSet)) &amp;&amp; addresses != null)) &amp;&amp; !addresses.isEmpty()))) {</span>
<span class="nc" id="L654">                float[] results = new float[1];</span>
<span class="nc" id="L655">                float minDistanceToOriginalLatLon = Float.MAX_VALUE;</span>
<span class="nc" id="L656">                CustomAddress closestAddress = addresses.get(0);</span>
<span class="nc bnc" id="L657" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7967)) {</span>
                    {
<span class="nc" id="L659">                        long _loopCounter99 = 0;</span>
<span class="nc bnc" id="L660" title="All 2 branches missed.">                        for (CustomAddress addressToCheck : addresses) {</span>
<span class="nc" id="L661">                            ListenerUtil.loopListener.listen(&quot;_loopCounter99&quot;, ++_loopCounter99);</span>
<span class="nc bnc" id="L662" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7958)) {</span>
<span class="nc" id="L663">                                Location.distanceBetween(latitude, longitude, addressToCheck.getLatitude(), addressToCheck.getLongitude(), results);</span>
                            }
<span class="nc bnc" id="L665" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7966)) {</span>
<span class="nc bnc" id="L666" title="All 22 branches missed.">                                if ((ListenerUtil.mutListener.listen(7963) ? (results[0] &gt;= minDistanceToOriginalLatLon) : (ListenerUtil.mutListener.listen(7962) ? (results[0] &lt;= minDistanceToOriginalLatLon) : (ListenerUtil.mutListener.listen(7961) ? (results[0] &gt; minDistanceToOriginalLatLon) : (ListenerUtil.mutListener.listen(7960) ? (results[0] != minDistanceToOriginalLatLon) : (ListenerUtil.mutListener.listen(7959) ? (results[0] == minDistanceToOriginalLatLon) : (results[0] &lt; minDistanceToOriginalLatLon))))))) {</span>
<span class="nc bnc" id="L667" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(7964)) {</span>
<span class="nc" id="L668">                                        closestAddress = addressToCheck;</span>
                                    }
<span class="nc bnc" id="L670" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(7965)) {</span>
<span class="nc" id="L671">                                        minDistanceToOriginalLatLon = results[0];</span>
                                    }
                                }
                            }
<span class="nc" id="L675">                        }</span>
                    }
                }
<span class="nc bnc" id="L678" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7968)) {</span>
<span class="nc" id="L679">                    addressesReturn.add(closestAddress);</span>
                }
<span class="nc" id="L681">            } else {</span>
<span class="nc bnc" id="L682" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7957)) {</span>
<span class="nc" id="L683">                    addressesReturn.addAll(addresses);</span>
                }
            }
        }
<span class="nc" id="L687">        return addressesReturn;</span>
    }

    /**
     * Filters the addresses obtained in geocoding process, removing the
     * results outside server limits.
     *
     * @param addresses list of addresses to filter
     * @return a new list filtered
     */
    private static List&lt;CustomAddress&gt; filterAddressesBBox(ObaRegion region, List&lt;CustomAddress&gt; addresses) {
<span class="nc bnc" id="L698" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(7977)) {</span>
<span class="nc bnc" id="L699" title="All 26 branches missed.">            if ((ListenerUtil.mutListener.listen(7971) ? ((!((ListenerUtil.mutListener.listen(7970) ? (addresses == null &amp;&amp; addresses.isEmpty()) : (addresses == null || addresses.isEmpty())))) || region != null) : ((!((ListenerUtil.mutListener.listen(7970) ? (addresses == null &amp;&amp; addresses.isEmpty()) : (addresses == null || addresses.isEmpty())))) &amp;&amp; region != null))) {</span>
<span class="nc bnc" id="L700" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(7976)) {</span>
                    {
<span class="nc" id="L702">                        long _loopCounter100 = 0;</span>
<span class="nc bnc" id="L703" title="All 2 branches missed.">                        for (Iterator&lt;CustomAddress&gt; it = addresses.iterator(); it.hasNext(); ) {</span>
<span class="nc" id="L704">                            ListenerUtil.loopListener.listen(&quot;_loopCounter100&quot;, ++_loopCounter100);</span>
<span class="nc" id="L705">                            CustomAddress address = it.next();</span>
<span class="nc" id="L706">                            Location loc = new Location(&quot;&quot;);</span>
<span class="nc bnc" id="L707" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7972)) {</span>
<span class="nc" id="L708">                                loc.setLatitude(address.getLatitude());</span>
                            }
<span class="nc bnc" id="L710" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7973)) {</span>
<span class="nc" id="L711">                                loc.setLongitude(address.getLongitude());</span>
                            }
<span class="nc bnc" id="L713" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(7975)) {</span>
<span class="nc bnc" id="L714" title="All 2 branches missed.">                                if (!RegionUtils.isLocationWithinRegion(loc, region)) {</span>
<span class="nc bnc" id="L715" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(7974)) {</span>
<span class="nc" id="L716">                                        it.remove();</span>
                                    }
                                }
                            }
<span class="nc" id="L720">                        }</span>
                    }
                }
            }
        }
<span class="nc" id="L725">        return addresses;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span>Generated by the Android Gradle plugin 8.2.0</div></body></html>