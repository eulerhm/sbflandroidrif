<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>TripResultsFragment.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">agencyXGoogleDebug</a> &gt; <a href="index.source.html" class="el_package">org.onebusaway.android.ui</a> &gt; <span class="el_source">TripResultsFragment.java</span></div><h1>TripResultsFragment.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2012-2013 Paul Watts (paulcwatts@gmail.com)
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.onebusaway.android.ui;

import com.google.android.material.tabs.TabLayout;
import org.onebusaway.android.R;
import org.onebusaway.android.app.Application;
import org.onebusaway.android.directions.model.Direction;
import org.onebusaway.android.directions.realtime.RealtimeService;
import org.onebusaway.android.directions.util.ConversionUtils;
import org.onebusaway.android.directions.util.DirectionExpandableListAdapter;
import org.onebusaway.android.directions.util.DirectionsGenerator;
import org.onebusaway.android.directions.util.OTPConstants;
import org.onebusaway.android.map.MapParams;
import org.onebusaway.android.map.googlemapsv2.BaseMapFragment;
import org.opentripplanner.api.model.Itinerary;
import android.app.NotificationChannel;
import android.app.NotificationManager;
import android.content.Context;
import android.content.Intent;
import android.graphics.PorterDuff;
import android.graphics.drawable.Drawable;
import android.os.Build;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.MenuItem;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ExpandableListView;
import android.widget.LinearLayout;
import android.widget.ListView;
import android.widget.TextView;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.List;
import java.util.Locale;
import androidx.annotation.DrawableRes;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

<span class="nc" id="L56">public class TripResultsFragment extends Fragment {</span>

    private static final String TAG = &quot;TripResultsFragment&quot;;

    private static final int LIST_TAB_POSITION = 0;

    private static final int MAP_TAB_POSITION = 1;

    private View mDirectionsFrame;

    private BaseMapFragment mMapFragment;

    private ExpandableListView mDirectionsListView;

    private View mMapFragmentFrame;

<span class="nc" id="L72">    private boolean mShowingMap = false;</span>

<span class="nc" id="L74">    private RoutingOptionPicker[] mOptions = new RoutingOptionPicker[3];</span>

    private Listener mListener;

<span class="nc" id="L78">    private Bundle mMapBundle = new Bundle();</span>

    /**
     * This listener is a helper for the parent activity to handle the sliding panel,
     * which interacts with sliding views (i.e., list view and map view) in subtle ways.
     */
    public interface Listener {

        /**
         * Called when the result views have been created
         *
         * @param containerView the view which contains the directions list and the map
         * @param listView the directions list view
         * @param mapView the map frame
         */
        void onResultViewCreated(View containerView, ListView listView, View mapView);
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
<span class="nc bnc" id="L98" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2167)) {</span>
<span class="nc" id="L99">            super.onCreate(savedInstanceState);</span>
        }
<span class="nc" id="L101">        final View view = inflater.inflate(R.layout.fragment_trip_plan_results, container, false);</span>
<span class="nc bnc" id="L102" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2168)) {</span>
<span class="nc" id="L103">            mDirectionsFrame = view.findViewById(R.id.directionsFrame);</span>
        }
<span class="nc bnc" id="L105" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2169)) {</span>
<span class="nc" id="L106">            mDirectionsListView = (ExpandableListView) view.findViewById(R.id.directionsListView);</span>
        }
<span class="nc bnc" id="L108" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2170)) {</span>
<span class="nc" id="L109">            mMapFragmentFrame = view.findViewById(R.id.mapFragment);</span>
        }
<span class="nc bnc" id="L111" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2171)) {</span>
<span class="nc" id="L112">            mOptions[0] = new RoutingOptionPicker(view, R.id.option1LinearLayout, R.id.option1Title, R.id.option1Duration, R.id.option1Interval);</span>
        }
<span class="nc bnc" id="L114" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2172)) {</span>
<span class="nc" id="L115">            mOptions[1] = new RoutingOptionPicker(view, R.id.option2LinearLayout, R.id.option2Title, R.id.option2Duration, R.id.option2Interval);</span>
        }
<span class="nc bnc" id="L117" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2173)) {</span>
<span class="nc" id="L118">            mOptions[2] = new RoutingOptionPicker(view, R.id.option3LinearLayout, R.id.option3Title, R.id.option3Duration, R.id.option3Interval);</span>
        }
        // defaults to 0
<span class="nc" id="L121">        int rank = getArguments().getInt(OTPConstants.SELECTED_ITINERARY);</span>
<span class="nc bnc" id="L122" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2174)) {</span>
<span class="nc" id="L123">            mShowingMap = getArguments().getBoolean(OTPConstants.SHOW_MAP);</span>
        }
<span class="nc bnc" id="L125" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2175)) {</span>
<span class="nc" id="L126">            initInfoAndMap(rank);</span>
        }
<span class="nc" id="L128">        TabLayout tabLayout = (TabLayout) view.findViewById(R.id.tab_layout_switch_view);</span>
<span class="nc bnc" id="L129" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2177)) {</span>
<span class="nc" id="L130">            tabLayout.setOnTabSelectedListener(new TabLayout.OnTabSelectedListener() {</span>

                @Override
                public void onTabSelected(TabLayout.Tab tab) {
<span class="nc bnc" id="L134" title="All 2 branches missed.">                    boolean show = (tab.getPosition() == MAP_TAB_POSITION);</span>
<span class="nc bnc" id="L135" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2176)) {</span>
<span class="nc" id="L136">                        showMap(show);</span>
                    }
<span class="nc" id="L138">                }</span>

                @Override
                public void onTabUnselected(TabLayout.Tab tab) {
<span class="nc" id="L142">                }</span>

                @Override
                public void onTabReselected(TabLayout.Tab tab) {
<span class="nc" id="L146">                }</span>
            });
        }
<span class="nc bnc" id="L149" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2178)) {</span>
<span class="nc" id="L150">            setTabDrawable(tabLayout.getTabAt(LIST_TAB_POSITION), R.drawable.ic_list);</span>
        }
<span class="nc bnc" id="L152" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2179)) {</span>
<span class="nc" id="L153">            setTabDrawable(tabLayout.getTabAt(MAP_TAB_POSITION), R.drawable.ic_arrivals_styleb_action_map);</span>
        }
<span class="nc bnc" id="L155" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2181)) {</span>
<span class="nc bnc" id="L156" title="All 2 branches missed.">            if (mShowingMap) {</span>
<span class="nc bnc" id="L157" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2180)) {</span>
<span class="nc" id="L158">                    tabLayout.getTabAt(MAP_TAB_POSITION).select();</span>
                }
            }
        }
<span class="nc bnc" id="L162" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2183)) {</span>
<span class="nc bnc" id="L163" title="All 2 branches missed.">            if (mListener != null) {</span>
<span class="nc bnc" id="L164" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2182)) {</span>
<span class="nc" id="L165">                    mListener.onResultViewCreated(mDirectionsFrame, mDirectionsListView, mMapFragmentFrame);</span>
                }
            }
        }
<span class="nc" id="L169">        return view;</span>
    }

    @Override
    public void onDestroy() {
<span class="nc bnc" id="L174" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2184)) {</span>
<span class="nc" id="L175">            super.onDestroy();</span>
        }
<span class="nc" id="L177">    }</span>

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
<span class="nc bnc" id="L181" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2186)) {</span>
<span class="nc bnc" id="L182" title="All 2 branches missed.">            if (item.getItemId() == android.R.id.home) {</span>
<span class="nc bnc" id="L183" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2185)) {</span>
<span class="nc" id="L184">                    NavHelp.goUp(getActivity());</span>
                }
<span class="nc" id="L186">                return true;</span>
            }
        }
<span class="nc bnc" id="L189" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2188)) {</span>
<span class="nc bnc" id="L190" title="All 2 branches missed.">            if (item.getItemId() == R.id.show_on_map) {</span>
<span class="nc bnc" id="L191" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2187)) {</span>
<span class="nc" id="L192">                    showMap(true);</span>
                }
            }
        }
<span class="nc bnc" id="L196" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2190)) {</span>
<span class="nc bnc" id="L197" title="All 2 branches missed.">            if (item.getItemId() == R.id.list) {</span>
<span class="nc bnc" id="L198" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2189)) {</span>
<span class="nc" id="L199">                    showMap(false);</span>
                }
            }
        }
<span class="nc" id="L203">        return false;</span>
    }

    /**
     * Set the listener for this fragment.
     *
     * @param listener the new listener
     */
    public void setListener(Listener listener) {
<span class="nc bnc" id="L212" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2191)) {</span>
<span class="nc" id="L213">            mListener = listener;</span>
        }
<span class="nc" id="L215">    }</span>

    /**
     * Get whether map is showing.
     *
     * @return true if map is showing, false otherwise
     */
    public boolean isMapShowing() {
<span class="nc" id="L223">        return mShowingMap;</span>
    }

    private void setTabDrawable(TabLayout.Tab tab, @DrawableRes int res) {
<span class="nc" id="L227">        View view = tab.getCustomView();</span>
<span class="nc" id="L228">        TextView tv = ((TextView) view.findViewById(android.R.id.text1));</span>
<span class="nc" id="L229">        Drawable drawable = getResources().getDrawable(res);</span>
<span class="nc" id="L230">        int dp = (int) getResources().getDimension(R.dimen.trip_results_icon_size);</span>
<span class="nc bnc" id="L231" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2192)) {</span>
<span class="nc" id="L232">            drawable.setBounds(0, 0, dp, dp);</span>
        }
<span class="nc bnc" id="L234" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2193)) {</span>
<span class="nc" id="L235">            drawable.setColorFilter(getResources().getColor(R.color.trip_option_icon_tint), PorterDuff.Mode.SRC_IN);</span>
        }
<span class="nc bnc" id="L237" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2194)) {</span>
<span class="nc" id="L238">            tv.setCompoundDrawables(drawable, null, null, null);</span>
        }
<span class="nc" id="L240">    }</span>

    private void initMap(int trip) {
<span class="nc" id="L243">        Itinerary itinerary = getItineraries().get(trip);</span>
<span class="nc bnc" id="L244" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2195)) {</span>
<span class="nc" id="L245">            mMapBundle.putString(MapParams.MODE, MapParams.MODE_DIRECTIONS);</span>
        }
<span class="nc bnc" id="L247" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2196)) {</span>
<span class="nc" id="L248">            mMapBundle.putSerializable(MapParams.ITINERARY, itinerary);</span>
        }
<span class="nc" id="L250">        Intent intent = new Intent().putExtras(mMapBundle);</span>
<span class="nc bnc" id="L251" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2197)) {</span>
<span class="nc" id="L252">            getActivity().setIntent(intent);</span>
        }
<span class="nc" id="L254">        FragmentManager fm = getChildFragmentManager();</span>
<span class="nc bnc" id="L255" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2203)) {</span>
<span class="nc bnc" id="L256" title="All 2 branches missed.">            if (mMapFragment == null) {</span>
<span class="nc bnc" id="L257" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2198)) {</span>
                    // First check to see if an instance of BaseMapFragment already exists
<span class="nc" id="L259">                    mMapFragment = (BaseMapFragment) fm.findFragmentByTag(BaseMapFragment.TAG);</span>
                }
<span class="nc bnc" id="L261" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2202)) {</span>
<span class="nc bnc" id="L262" title="All 2 branches missed.">                    if (mMapFragment == null) {</span>
<span class="nc bnc" id="L263" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2199)) {</span>
                            // No existing fragment was found, so create a new one
<span class="nc" id="L265">                            Log.d(TAG, &quot;Creating new BaseMapFragment&quot;);</span>
                        }
<span class="nc bnc" id="L267" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2200)) {</span>
<span class="nc" id="L268">                            mMapFragment = BaseMapFragment.newInstance();</span>
                        }
<span class="nc bnc" id="L270" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2201)) {</span>
<span class="nc" id="L271">                            fm.beginTransaction().add(R.id.mapFragment, mMapFragment, BaseMapFragment.TAG).commit();</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L277">    }</span>

    private void showMap(boolean show) {
<span class="nc bnc" id="L280" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2204)) {</span>
<span class="nc" id="L281">            mShowingMap = show;</span>
        }
<span class="nc bnc" id="L283" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2208)) {</span>
<span class="nc bnc" id="L284" title="All 2 branches missed.">            if (show) {</span>
<span class="nc bnc" id="L285" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2206)) {</span>
<span class="nc" id="L286">                    mMapFragmentFrame.bringToFront();</span>
                }
<span class="nc bnc" id="L288" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2207)) {</span>
<span class="nc" id="L289">                    mMapFragment.setMapMode(MapParams.MODE_DIRECTIONS, mMapBundle);</span>
                }
            } else {
<span class="nc bnc" id="L292" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(2205)) {</span>
<span class="nc" id="L293">                    mDirectionsListView.bringToFront();</span>
                }
            }
        }
<span class="nc bnc" id="L297" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2209)) {</span>
<span class="nc" id="L298">            getArguments().putBoolean(OTPConstants.SHOW_MAP, mShowingMap);</span>
        }
<span class="nc" id="L300">    }</span>

    private void initInfoAndMap(int trip) {
<span class="nc bnc" id="L303" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2210)) {</span>
<span class="nc" id="L304">            initMap(trip);</span>
        }
<span class="nc bnc" id="L306" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2217)) {</span>
            {
<span class="nc" id="L308">                long _loopCounter26 = 0;</span>
<span class="nc bnc" id="L309" title="All 22 branches missed.">                for (int i = 0; (ListenerUtil.mutListener.listen(2216) ? (i &gt;= mOptions.length) : (ListenerUtil.mutListener.listen(2215) ? (i &lt;= mOptions.length) : (ListenerUtil.mutListener.listen(2214) ? (i &gt; mOptions.length) : (ListenerUtil.mutListener.listen(2213) ? (i != mOptions.length) : (ListenerUtil.mutListener.listen(2212) ? (i == mOptions.length) : (i &lt; mOptions.length)))))); i++) {</span>
<span class="nc" id="L310">                    ListenerUtil.loopListener.listen(&quot;_loopCounter26&quot;, ++_loopCounter26);</span>
<span class="nc bnc" id="L311" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2211)) {</span>
<span class="nc" id="L312">                        mOptions[i].setItinerary(i);</span>
                    }
                }
            }
        }
<span class="nc bnc" id="L317" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2218)) {</span>
<span class="nc" id="L318">            mOptions[trip].select();</span>
        }
<span class="nc bnc" id="L320" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2219)) {</span>
<span class="nc" id="L321">            showMap(mShowingMap);</span>
        }
<span class="nc" id="L323">    }</span>

    public void displayNewResults() {
<span class="nc" id="L326">        int rank = getArguments().getInt(OTPConstants.SELECTED_ITINERARY);</span>
<span class="nc bnc" id="L327" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2220)) {</span>
<span class="nc" id="L328">            showMap(mShowingMap);</span>
        }
<span class="nc bnc" id="L330" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2221)) {</span>
<span class="nc" id="L331">            initInfoAndMap(rank);</span>
        }
<span class="nc" id="L333">    }</span>

    private String toDateFmt(long ms) {
<span class="nc" id="L336">        Date d = new Date(ms);</span>
<span class="nc" id="L337">        String s = new SimpleDateFormat(OTPConstants.TRIP_RESULTS_TIME_STRING_FORMAT_SUMMARY, Locale.getDefault()).format(d);</span>
<span class="nc" id="L338">        return s.substring(0, 6).toLowerCase();</span>
    }

    private String formatTimeString(String ms, double durationSec) {
<span class="nc" id="L342">        long start = Long.parseLong(ms);</span>
<span class="nc" id="L343">        String fromString = toDateFmt(start);</span>
<span class="nc bnc" id="L344" title="All 8 branches missed.">        String toString = toDateFmt((ListenerUtil.mutListener.listen(2225) ? (start % (long) durationSec) : (ListenerUtil.mutListener.listen(2224) ? (start / (long) durationSec) : (ListenerUtil.mutListener.listen(2223) ? (start * (long) durationSec) : (ListenerUtil.mutListener.listen(2222) ? (start - (long) durationSec) : (start + (long) durationSec))))));</span>
<span class="nc" id="L345">        return fromString + &quot; - &quot; + toString;</span>
    }

    private List&lt;Itinerary&gt; getItineraries() {
<span class="nc" id="L349">        return (List&lt;Itinerary&gt;) getArguments().getSerializable(OTPConstants.ITINERARIES);</span>
    }

    private class RoutingOptionPicker {

        LinearLayout linearLayout;

        TextView titleView;

        TextView durationView;

        TextView intervalView;

        Itinerary itinerary;

        int rank;

<span class="nc" id="L366">        RoutingOptionPicker(View view, int linearLayout, int titleView, int durationView, int intervalView) {</span>
<span class="nc bnc" id="L367" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2226)) {</span>
<span class="nc" id="L368">                this.linearLayout = (LinearLayout) view.findViewById(linearLayout);</span>
            }
<span class="nc bnc" id="L370" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2227)) {</span>
<span class="nc" id="L371">                this.titleView = (TextView) view.findViewById(titleView);</span>
            }
<span class="nc bnc" id="L373" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2228)) {</span>
<span class="nc" id="L374">                this.durationView = (TextView) view.findViewById(durationView);</span>
            }
<span class="nc bnc" id="L376" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2229)) {</span>
<span class="nc" id="L377">                this.intervalView = (TextView) view.findViewById(intervalView);</span>
            }
<span class="nc bnc" id="L379" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2231)) {</span>
<span class="nc" id="L380">                this.linearLayout.setOnClickListener(new View.OnClickListener() {</span>

                    @Override
                    public void onClick(View v) {
<span class="nc bnc" id="L384" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2230)) {</span>
<span class="nc" id="L385">                            RoutingOptionPicker.this.select();</span>
                        }
<span class="nc" id="L387">                    }</span>
                });
            }
<span class="nc" id="L390">        }</span>

        void select() {
<span class="nc bnc" id="L393" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2233)) {</span>
                {
<span class="nc" id="L395">                    long _loopCounter27 = 0;</span>
<span class="nc bnc" id="L396" title="All 2 branches missed.">                    for (RoutingOptionPicker picker : mOptions) {</span>
<span class="nc" id="L397">                        ListenerUtil.loopListener.listen(&quot;_loopCounter27&quot;, ++_loopCounter27);</span>
<span class="nc bnc" id="L398" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(2232)) {</span>
<span class="nc" id="L399">                            picker.linearLayout.setBackgroundColor(getResources().getColor(R.color.trip_option_background));</span>
                        }
                    }
                }
            }
<span class="nc bnc" id="L404" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2234)) {</span>
<span class="nc" id="L405">                linearLayout.setBackgroundResource(R.drawable.trip_option_selected_item);</span>
            }
<span class="nc bnc" id="L407" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2235)) {</span>
<span class="nc" id="L408">                getArguments().putInt(OTPConstants.SELECTED_ITINERARY, rank);</span>
            }
<span class="nc bnc" id="L410" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2236)) {</span>
<span class="nc" id="L411">                updateInfo();</span>
            }
<span class="nc bnc" id="L413" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2237)) {</span>
<span class="nc" id="L414">                updateMap();</span>
            }
<span class="nc" id="L416">        }</span>

        void setItinerary(int rank) {
<span class="nc" id="L419">            List&lt;Itinerary&gt; trips = getItineraries();</span>
<span class="nc bnc" id="L420" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2245)) {</span>
<span class="nc bnc" id="L421" title="All 22 branches missed.">                if ((ListenerUtil.mutListener.listen(2242) ? (rank &lt;= trips.size()) : (ListenerUtil.mutListener.listen(2241) ? (rank &gt; trips.size()) : (ListenerUtil.mutListener.listen(2240) ? (rank &lt; trips.size()) : (ListenerUtil.mutListener.listen(2239) ? (rank != trips.size()) : (ListenerUtil.mutListener.listen(2238) ? (rank == trips.size()) : (rank &gt;= trips.size()))))))) {</span>
<span class="nc bnc" id="L422" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2243)) {</span>
<span class="nc" id="L423">                        this.itinerary = null;</span>
                    }
<span class="nc bnc" id="L425" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2244)) {</span>
<span class="nc" id="L426">                        linearLayout.setVisibility(View.GONE);</span>
                    }
<span class="nc" id="L428">                    return;</span>
                }
            }
<span class="nc bnc" id="L431" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2246)) {</span>
<span class="nc" id="L432">                this.itinerary = trips.get(rank);</span>
            }
<span class="nc bnc" id="L434" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2247)) {</span>
<span class="nc" id="L435">                this.rank = rank;</span>
            }
<span class="nc" id="L437">            String title = new DirectionsGenerator(itinerary.legs, getContext()).getItineraryTitle();</span>
<span class="nc" id="L438">            String duration = ConversionUtils.getFormattedDurationTextNoSeconds(itinerary.duration, false, getContext());</span>
<span class="nc bnc" id="L439" title="All 8 branches missed.">            String interval = formatTimeString(itinerary.startTime, (ListenerUtil.mutListener.listen(2251) ? (itinerary.duration % 1000) : (ListenerUtil.mutListener.listen(2250) ? (itinerary.duration / 1000) : (ListenerUtil.mutListener.listen(2249) ? (itinerary.duration - 1000) : (ListenerUtil.mutListener.listen(2248) ? (itinerary.duration + 1000) : (itinerary.duration * 1000))))));</span>
<span class="nc bnc" id="L440" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2252)) {</span>
<span class="nc" id="L441">                titleView.setText(title);</span>
            }
<span class="nc bnc" id="L443" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2253)) {</span>
<span class="nc" id="L444">                durationView.setText(duration);</span>
            }
<span class="nc bnc" id="L446" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2254)) {</span>
<span class="nc" id="L447">                intervalView.setText(interval);</span>
            }
<span class="nc" id="L449">        }</span>

        void updateInfo() {
<span class="nc" id="L452">            DirectionsGenerator gen = new DirectionsGenerator(itinerary.legs, getActivity().getApplicationContext());</span>
<span class="nc" id="L453">            List&lt;Direction&gt; directions = gen.getDirections();</span>
<span class="nc" id="L454">            Direction[] direction_data = directions.toArray(new Direction[directions.size()]);</span>
<span class="nc" id="L455">            DirectionExpandableListAdapter adapter = new DirectionExpandableListAdapter(getActivity(), R.layout.list_direction_item, R.layout.list_subdirection_item, direction_data);</span>
<span class="nc bnc" id="L456" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2255)) {</span>
<span class="nc" id="L457">                mDirectionsListView.setAdapter(adapter);</span>
            }
<span class="nc bnc" id="L459" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2256)) {</span>
<span class="nc" id="L460">                mDirectionsListView.setGroupIndicator(null);</span>
            }
<span class="nc" id="L462">            Context context = Application.get().getApplicationContext();</span>
<span class="nc bnc" id="L463" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2266)) {</span>
<span class="nc bnc" id="L464" title="All 22 branches missed.">                if ((ListenerUtil.mutListener.listen(2261) ? (Build.VERSION.SDK_INT &lt;= Build.VERSION_CODES.O) : (ListenerUtil.mutListener.listen(2260) ? (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.O) : (ListenerUtil.mutListener.listen(2259) ? (Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.O) : (ListenerUtil.mutListener.listen(2258) ? (Build.VERSION.SDK_INT != Build.VERSION_CODES.O) : (ListenerUtil.mutListener.listen(2257) ? (Build.VERSION.SDK_INT == Build.VERSION_CODES.O) : (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O))))))) {</span>
<span class="nc" id="L465">                    NotificationManager manager = (NotificationManager) context.getSystemService(Context.NOTIFICATION_SERVICE);</span>
<span class="nc" id="L466">                    NotificationChannel channel = manager.getNotificationChannel(Application.CHANNEL_TRIP_PLAN_UPDATES_ID);</span>
<span class="nc bnc" id="L467" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2265)) {</span>
<span class="nc bnc" id="L468" title="All 2 branches missed.">                        if (channel.getImportance() != NotificationManager.IMPORTANCE_NONE) {</span>
<span class="nc bnc" id="L469" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2264)) {</span>
<span class="nc" id="L470">                                RealtimeService.start(getActivity(), getArguments());</span>
                            }
                        }
                    }
<span class="nc" id="L474">                } else {</span>
<span class="nc bnc" id="L475" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2263)) {</span>
<span class="nc bnc" id="L476" title="All 2 branches missed.">                        if (Application.getPrefs().getBoolean(getString(R.string.preference_key_trip_plan_notifications), true)) {</span>
<span class="nc bnc" id="L477" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2262)) {</span>
<span class="nc" id="L478">                                RealtimeService.start(getActivity(), getArguments());</span>
                            }
                        }
                    }
                }
            }
<span class="nc" id="L484">        }</span>

        void updateMap() {
<span class="nc bnc" id="L487" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2267)) {</span>
<span class="nc" id="L488">                mMapBundle.putSerializable(MapParams.ITINERARY, itinerary);</span>
            }
<span class="nc bnc" id="L490" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2268)) {</span>
<span class="nc" id="L491">                mMapFragment.setMapMode(MapParams.MODE_DIRECTIONS, mMapBundle);</span>
            }
<span class="nc" id="L493">        }</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span>Generated by the Android Gradle plugin 8.2.0</div></body></html>