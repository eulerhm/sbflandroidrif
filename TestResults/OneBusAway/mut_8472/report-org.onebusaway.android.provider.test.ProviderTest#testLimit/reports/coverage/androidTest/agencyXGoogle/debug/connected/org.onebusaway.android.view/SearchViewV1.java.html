<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SearchViewV1.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">agencyXGoogleDebug</a> &gt; <a href="index.source.html" class="el_package">org.onebusaway.android.view</a> &gt; <span class="el_source">SearchViewV1.java</span></div><h1>SearchViewV1.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2010 The Android Open Source Project
 * Copyright (C) 2011 Paul Watts (paulcwatts@gmail.com)
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.onebusaway.android.view;

import org.onebusaway.android.R;
import android.content.Context;
import android.text.Editable;
import android.text.TextUtils;
import android.text.TextWatcher;
import android.util.AttributeSet;
import android.view.KeyEvent;
import android.view.LayoutInflater;
import android.view.View;
import android.widget.EditText;
import android.widget.LinearLayout;
import android.widget.TextView;
import android.widget.TextView.OnEditorActionListener;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

/**
 * Very basic version of a search box, lightly copied/inspired by
 * the Honeycomb SearchView.
 *
 * @author paulw
 * @deprecated
 */
public class SearchViewV1 extends LinearLayout {

    private OnQueryTextListener mOnQueryChangeListener;

    private OnFocusChangeListener mOnQueryTextFocusChangeListener;

    private View mSearchButton;

    private EditText mQueryTextView;

    private CharSequence mQueryHint;

    private CharSequence mOldQueryText;

    /**
     * Callbacks for changes to the query text.
     */
    public interface OnQueryTextListener {

        /**
         * Called when the user submits the query. This could be due to a key press on the
         * keyboard or due to pressing a submit button.
         * The listener can override the standard behavior by returning true
         * to indicate that it has handled the submit request. Otherwise return false to
         * let the SearchView handle the submission by launching any associated intent.
         *
         * @param query the query text that is to be submitted
         * @return true if the query has been handled by the listener, false to let the
         * SearchView perform the default action.
         */
        boolean onQueryTextSubmit(String query);

        /**
         * Called when the query text is changed by the user.
         *
         * @param newText the new content of the query text field.
         * @return false if the SearchView should perform the default action of showing any
         * suggestions if available, true if the action was handled by the listener.
         */
        boolean onQueryTextChange(String newText);
    }

    public SearchViewV1(Context context) {
<span class="nc" id="L84">        this(context, null);</span>
<span class="nc" id="L85">    }</span>

    public SearchViewV1(Context context, AttributeSet attrs) {
<span class="nc" id="L88">        super(context, attrs);</span>
<span class="nc" id="L89">        LayoutInflater inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);</span>
<span class="nc bnc" id="L90" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10723)) {</span>
<span class="nc" id="L91">            inflater.inflate(R.layout.search_box, this, true);</span>
        }
<span class="nc bnc" id="L93" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10724)) {</span>
<span class="nc" id="L94">            mSearchButton = findViewById(R.id.search_button);</span>
        }
<span class="nc bnc" id="L96" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10725)) {</span>
<span class="nc" id="L97">            mQueryTextView = (EditText) findViewById(R.id.search_text);</span>
        }
<span class="nc bnc" id="L99" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10726)) {</span>
<span class="nc" id="L100">            mSearchButton.setOnClickListener(mOnClickListener);</span>
        }
<span class="nc bnc" id="L102" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10727)) {</span>
<span class="nc" id="L103">            mQueryTextView.setOnClickListener(mOnClickListener);</span>
        }
<span class="nc bnc" id="L105" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10728)) {</span>
<span class="nc" id="L106">            mQueryTextView.addTextChangedListener(mTextWatcher);</span>
        }
<span class="nc bnc" id="L108" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10729)) {</span>
<span class="nc" id="L109">            mQueryTextView.setOnEditorActionListener(mOnEditorActionListener);</span>
        }
<span class="nc bnc" id="L111" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10732)) {</span>
            // Inform any listener of focus changes
<span class="nc" id="L113">            mQueryTextView.setOnFocusChangeListener(new OnFocusChangeListener() {</span>

                public void onFocusChange(View v, boolean hasFocus) {
<span class="nc bnc" id="L116" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(10731)) {</span>
<span class="nc bnc" id="L117" title="All 2 branches missed.">                        if (mOnQueryTextFocusChangeListener != null) {</span>
<span class="nc bnc" id="L118" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(10730)) {</span>
<span class="nc" id="L119">                                mOnQueryTextFocusChangeListener.onFocusChange(SearchViewV1.this, hasFocus);</span>
                            }
                        }
                    }
<span class="nc" id="L123">                }</span>
            });
        }
<span class="nc" id="L126">    }</span>

    /**
     * Sets a listener for user actions within the SearchView.
     *
     * @param listener the listener object that receives callbacks when the user performs
     *                 actions in the SearchView such as clicking on buttons or typing a query.
     */
    public void setOnQueryTextListener(OnQueryTextListener listener) {
<span class="nc bnc" id="L135" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10733)) {</span>
<span class="nc" id="L136">            mOnQueryChangeListener = listener;</span>
        }
<span class="nc" id="L138">    }</span>

    /**
     * Sets a listener to inform when the focus of the query text field changes.
     *
     * @param listener the listener to inform of focus changes.
     */
    public void setOnQueryTextFocusChangeListener(OnFocusChangeListener listener) {
<span class="nc bnc" id="L146" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10734)) {</span>
<span class="nc" id="L147">            mOnQueryTextFocusChangeListener = listener;</span>
        }
<span class="nc" id="L149">    }</span>

    /**
     * Returns the query string currently in the text field.
     *
     * @return the query string
     */
    public CharSequence getQuery() {
<span class="nc" id="L157">        return mQueryTextView.getText();</span>
    }

    /**
     * Sets a query string in the text field and optionally submits the query as well.
     *
     * @param query  the query string. This replaces any query text already present in the
     *               text field.
     * @param submit whether to submit the query right now or only update the contents of
     *               text field.
     */
    public void setQuery(CharSequence query, boolean submit) {
<span class="nc bnc" id="L169" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10735)) {</span>
<span class="nc" id="L170">            mQueryTextView.setText(query);</span>
        }
<span class="nc bnc" id="L172" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10737)) {</span>
<span class="nc bnc" id="L173" title="All 2 branches missed.">            if (query != null) {</span>
<span class="nc bnc" id="L174" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10736)) {</span>
<span class="nc" id="L175">                    mQueryTextView.setSelection(query.length());</span>
                }
            }
        }
<span class="nc bnc" id="L179" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10740)) {</span>
            // If the query is not empty and submit is requested, submit the query
<span class="nc bnc" id="L181" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(10738) ? (submit || !TextUtils.isEmpty(query)) : (submit &amp;&amp; !TextUtils.isEmpty(query)))) {</span>
<span class="nc bnc" id="L182" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10739)) {</span>
<span class="nc" id="L183">                    onSubmitQuery();</span>
                }
            }
        }
<span class="nc" id="L187">    }</span>

    /**
     * Sets the hint text to display in the query text field. This overrides any hint specified
     * in the SearchableInfo.
     *
     * @param hint the hint text to display
     * @attr ref android.R.styleable#SearchView_queryHint
     */
    public void setQueryHint(CharSequence hint) {
<span class="nc bnc" id="L197" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10741)) {</span>
<span class="nc" id="L198">            mQueryHint = hint;</span>
        }
<span class="nc bnc" id="L200" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10742)) {</span>
<span class="nc" id="L201">            updateQueryHint();</span>
        }
<span class="nc" id="L203">    }</span>

    /**
     * Callback to watch the text field for empty/non-empty
     */
<span class="nc" id="L208">    private TextWatcher mTextWatcher = new TextWatcher() {</span>

        public void beforeTextChanged(CharSequence s, int start, int before, int after) {
<span class="nc" id="L211">        }</span>

        public void onTextChanged(CharSequence s, int start, int before, int after) {
<span class="nc bnc" id="L214" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10743)) {</span>
<span class="nc" id="L215">                SearchViewV1.this.onTextChanged(s);</span>
            }
<span class="nc" id="L217">        }</span>

        public void afterTextChanged(Editable s) {
<span class="nc" id="L220">        }</span>
    };

<span class="nc" id="L223">    private final OnEditorActionListener mOnEditorActionListener = new OnEditorActionListener() {</span>

        /**
         * Called when the input method default action key is pressed.
         */
        public boolean onEditorAction(TextView v, int actionId, KeyEvent event) {
<span class="nc bnc" id="L229" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10744)) {</span>
<span class="nc" id="L230">                onSubmitQuery();</span>
            }
<span class="nc" id="L232">            return true;</span>
        }
    };

    private void onTextChanged(CharSequence newText) {
<span class="nc bnc" id="L237" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10747)) {</span>
            /*
        boolean hasText = !TextUtils.isEmpty(text);
        if (isSubmitButtonEnabled()) {
            updateSubmitButton(hasText);
        }
        updateVoiceButton(!hasText);
        updateCloseButton();
        updateSubmitArea();
        */
<span class="nc bnc" id="L247" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(10745) ? (mOnQueryChangeListener != null || !TextUtils.equals(newText, mOldQueryText)) : (mOnQueryChangeListener != null &amp;&amp; !TextUtils.equals(newText, mOldQueryText)))) {</span>
<span class="nc bnc" id="L248" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10746)) {</span>
<span class="nc" id="L249">                    mOnQueryChangeListener.onQueryTextChange(newText.toString());</span>
                }
            }
        }
<span class="nc bnc" id="L253" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10748)) {</span>
<span class="nc" id="L254">            mOldQueryText = newText.toString();</span>
        }
<span class="nc" id="L256">    }</span>

    private void onSubmitQuery() {
<span class="nc" id="L259">        CharSequence query = mQueryTextView.getText();</span>
<span class="nc bnc" id="L260" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10757)) {</span>
<span class="nc bnc" id="L261" title="All 50 branches missed.">            if ((ListenerUtil.mutListener.listen(10754) ? (query != null || (ListenerUtil.mutListener.listen(10753) ? (TextUtils.getTrimmedLength(query) &gt;= 0) : (ListenerUtil.mutListener.listen(10752) ? (TextUtils.getTrimmedLength(query) &lt;= 0) : (ListenerUtil.mutListener.listen(10751) ? (TextUtils.getTrimmedLength(query) &lt; 0) : (ListenerUtil.mutListener.listen(10750) ? (TextUtils.getTrimmedLength(query) != 0) : (ListenerUtil.mutListener.listen(10749) ? (TextUtils.getTrimmedLength(query) == 0) : (TextUtils.getTrimmedLength(query) &gt; 0))))))) : (query != null &amp;&amp; (ListenerUtil.mutListener.listen(10753) ? (TextUtils.getTrimmedLength(query) &gt;= 0) : (ListenerUtil.mutListener.listen(10752) ? (TextUtils.getTrimmedLength(query) &lt;= 0) : (ListenerUtil.mutListener.listen(10751) ? (TextUtils.getTrimmedLength(query) &lt; 0) : (ListenerUtil.mutListener.listen(10750) ? (TextUtils.getTrimmedLength(query) != 0) : (ListenerUtil.mutListener.listen(10749) ? (TextUtils.getTrimmedLength(query) == 0) : (TextUtils.getTrimmedLength(query) &gt; 0))))))))) {</span>
<span class="nc bnc" id="L262" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10756)) {</span>
<span class="nc bnc" id="L263" title="All 10 branches missed.">                    if ((ListenerUtil.mutListener.listen(10755) ? (mOnQueryChangeListener == null &amp;&amp; !mOnQueryChangeListener.onQueryTextSubmit(query.toString())) : (mOnQueryChangeListener == null || !mOnQueryChangeListener.onQueryTextSubmit(query.toString())))) {</span>
                    }
                }
            }
        }
<span class="nc" id="L268">    }</span>

<span class="nc" id="L270">    private final OnClickListener mOnClickListener = new OnClickListener() {</span>

        public void onClick(View v) {
<span class="nc" id="L273">        }</span>
    };

    private CharSequence getDecoratedHint(CharSequence hintText) {
<span class="nc" id="L277">        return hintText;</span>
    }

    private void updateQueryHint() {
<span class="nc bnc" id="L281" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10760)) {</span>
<span class="nc bnc" id="L282" title="All 2 branches missed.">            if (mQueryHint != null) {</span>
<span class="nc bnc" id="L283" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10759)) {</span>
<span class="nc" id="L284">                    mQueryTextView.setHint(getDecoratedHint(mQueryHint));</span>
                }
            } else /*else if (mSearchable != null) {
            CharSequence hint = null;
            int hintId = mSearchable.getHintId();
            if (hintId != 0) {
                hint = getContext().getString(hintId);
            }
            if (hint != null) {
                mQueryTextView.setHint(getDecoratedHint(hint));
            }
        } */
            {
<span class="nc bnc" id="L297" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10758)) {</span>
<span class="nc" id="L298">                    mQueryTextView.setHint(getDecoratedHint(&quot;&quot;));</span>
                }
            }
        }
<span class="nc" id="L302">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span>Generated by the Android Gradle plugin 8.2.0</div></body></html>