<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ObaShapeElement.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">agencyXGoogleDebug</a> &gt; <a href="index.source.html" class="el_package">org.onebusaway.android.io.elements</a> &gt; <span class="el_source">ObaShapeElement.java</span></div><h1>ObaShapeElement.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2010 Paul Watts (paulcwatts@gmail.com)
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.onebusaway.android.io.elements;

import org.onebusaway.android.util.LocationUtils;
import android.location.Location;
import java.util.ArrayList;
import java.util.List;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

public final class ObaShapeElement implements ObaShape {

<span class="nc" id="L26">    public static final ObaShapeElement EMPTY_OBJECT = new ObaShapeElement();</span>

<span class="nc" id="L28">    public static final ObaShapeElement[] EMPTY_ARRAY = new ObaShapeElement[] {};</span>

    private final String points;

    private final int length;

    private final String levels;

<span class="nc" id="L36">    private ObaShapeElement() {</span>
<span class="nc" id="L37">        points = &quot;&quot;;</span>
<span class="nc" id="L38">        length = 0;</span>
<span class="nc" id="L39">        levels = &quot;&quot;;</span>
<span class="nc" id="L40">    }</span>

    @Override
    public int getLength() {
<span class="nc" id="L44">        return length;</span>
    }

    @Override
    public String getRawLevels() {
<span class="nc" id="L49">        return levels;</span>
    }

    @Override
    public List&lt;Integer&gt; getLevels() {
<span class="nc" id="L54">        return decodeLevels(levels, length);</span>
    }

    @Override
    public List&lt;Location&gt; getPoints() {
<span class="nc" id="L59">        return decodeLine(points, length);</span>
    }

    @Override
    public String getRawPoints() {
<span class="nc" id="L64">        return points;</span>
    }

    // INJECTED FAULT: IF-CC
    public static List&lt;Location&gt; decodeLine(String encoded, int numPoints) {
<span class="nc bnc" id="L69" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(8280)) {</span>
<span class="nc bnc" id="L70" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(8279) ? (numPoints &lt;= 0) : (ListenerUtil.mutListener.listen(8278) ? (numPoints &gt; 0) : (ListenerUtil.mutListener.listen(8277) ? (numPoints &lt; 0) : (ListenerUtil.mutListener.listen(8276) ? (numPoints != 0) : (ListenerUtil.mutListener.listen(8275) ? (numPoints == 0) : (numPoints &gt;= 0))))))) {</span>
<span class="nc" id="L71">                throw new IllegalArgumentException(&quot;numPoints must be &gt;= 0&quot;);</span>
            }
        }
<span class="nc" id="L74">        ArrayList&lt;Location&gt; array = new ArrayList&lt;Location&gt;(numPoints);</span>
<span class="nc" id="L75">        final int len = encoded.length();</span>
<span class="nc" id="L76">        int i = 0;</span>
<span class="nc" id="L77">        int lat = 0, lon = 0;</span>
<span class="nc bnc" id="L78" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(8333)) {</span>
            {
<span class="nc" id="L80">                long _loopCounter109 = 0;</span>
<span class="nc bnc" id="L81" title="All 22 branches missed.">                while ((ListenerUtil.mutListener.listen(8332) ? (i &gt;= len) : (ListenerUtil.mutListener.listen(8331) ? (i &lt;= len) : (ListenerUtil.mutListener.listen(8330) ? (i &gt; len) : (ListenerUtil.mutListener.listen(8329) ? (i != len) : (ListenerUtil.mutListener.listen(8328) ? (i == len) : (i &lt; len))))))) {</span>
<span class="nc" id="L82">                    ListenerUtil.loopListener.listen(&quot;_loopCounter109&quot;, ++_loopCounter109);</span>
<span class="nc" id="L83">                    int shift = 0;</span>
<span class="nc" id="L84">                    int result = 0;</span>
                    int a, b;
                    {
<span class="nc" id="L87">                        long _loopCounter107 = 0;</span>
                        do {
<span class="nc" id="L89">                            ListenerUtil.loopListener.listen(&quot;_loopCounter107&quot;, ++_loopCounter107);</span>
<span class="nc" id="L90">                            a = encoded.charAt(i);</span>
<span class="nc bnc" id="L91" title="All 8 branches missed.">                            b = (ListenerUtil.mutListener.listen(8284) ? (a % 63) : (ListenerUtil.mutListener.listen(8283) ? (a / 63) : (ListenerUtil.mutListener.listen(8282) ? (a * 63) : (ListenerUtil.mutListener.listen(8281) ? (a + 63) : (a - 63)))));</span>
<span class="nc bnc" id="L92" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(8285)) {</span>
<span class="nc" id="L93">                                result |= (b &amp; 0x1f) &lt;&lt; shift;</span>
                            }
<span class="nc bnc" id="L95" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(8286)) {</span>
<span class="nc" id="L96">                                shift += 5;</span>
                            }
<span class="nc bnc" id="L98" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(8287)) {</span>
<span class="nc" id="L99">                                ++i;</span>
                            }
<span class="nc bnc" id="L101" title="All 22 branches missed.">                        } while ((ListenerUtil.mutListener.listen(8292) ? (b &lt;= 0x20) : (ListenerUtil.mutListener.listen(8291) ? (b &gt; 0x20) : (ListenerUtil.mutListener.listen(8290) ? (b &lt; 0x20) : (ListenerUtil.mutListener.listen(8289) ? (b != 0x20) : (ListenerUtil.mutListener.listen(8288) ? (b == 0x20) : (b &gt;= 0x20)))))));</span>
                    }
<span class="nc bnc" id="L103" title="All 22 branches missed.">                    final int dlat = ((ListenerUtil.mutListener.listen(8297) ? ((result &amp; 1) &gt;= 1) : (ListenerUtil.mutListener.listen(8296) ? ((result &amp; 1) &lt;= 1) : (ListenerUtil.mutListener.listen(8295) ? ((result &amp; 1) &gt; 1) : (ListenerUtil.mutListener.listen(8294) ? ((result &amp; 1) &lt; 1) : (ListenerUtil.mutListener.listen(8293) ? ((result &amp; 1) != 1) : ((result &amp; 1) == 1)))))) ? ~(result &gt;&gt; 1) : (result &gt;&gt; 1));</span>
<span class="nc bnc" id="L104" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(8298)) {</span>
<span class="nc" id="L105">                        lat += dlat;</span>
                    }
<span class="nc bnc" id="L107" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(8299)) {</span>
<span class="nc" id="L108">                        shift = 0;</span>
                    }
<span class="nc bnc" id="L110" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(8300)) {</span>
<span class="nc" id="L111">                        result = 0;</span>
                    }
                    {
<span class="nc" id="L114">                        long _loopCounter108 = 0;</span>
                        do {
<span class="nc" id="L116">                            ListenerUtil.loopListener.listen(&quot;_loopCounter108&quot;, ++_loopCounter108);</span>
<span class="nc" id="L117">                            a = encoded.charAt(i);</span>
<span class="nc bnc" id="L118" title="All 8 branches missed.">                            b = (ListenerUtil.mutListener.listen(8304) ? (a % 63) : (ListenerUtil.mutListener.listen(8303) ? (a / 63) : (ListenerUtil.mutListener.listen(8302) ? (a * 63) : (ListenerUtil.mutListener.listen(8301) ? (a + 63) : (a - 63)))));</span>
<span class="nc bnc" id="L119" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(8305)) {</span>
<span class="nc" id="L120">                                result |= (b &amp; 0x1f) &lt;&lt; shift;</span>
                            }
<span class="nc bnc" id="L122" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(8306)) {</span>
<span class="nc" id="L123">                                shift += 5;</span>
                            }
<span class="nc bnc" id="L125" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(8307)) {</span>
<span class="nc" id="L126">                                ++i;</span>
                            }
<span class="nc bnc" id="L128" title="All 22 branches missed.">                        } while ((ListenerUtil.mutListener.listen(8312) ? (b &lt;= 0x20) : (ListenerUtil.mutListener.listen(8311) ? (b &gt; 0x20) : (ListenerUtil.mutListener.listen(8310) ? (b &lt; 0x20) : (ListenerUtil.mutListener.listen(8309) ? (b != 0x20) : (ListenerUtil.mutListener.listen(8308) ? (b == 0x20) : (b &gt;= 0x20)))))));</span>
                    }
<span class="nc bnc" id="L130" title="All 22 branches missed.">                    final int dlon = ((ListenerUtil.mutListener.listen(8317) ? ((result &amp; 1) &gt;= 1) : (ListenerUtil.mutListener.listen(8316) ? ((result &amp; 1) &lt;= 1) : (ListenerUtil.mutListener.listen(8315) ? ((result &amp; 1) &gt; 1) : (ListenerUtil.mutListener.listen(8314) ? ((result &amp; 1) &lt; 1) : (ListenerUtil.mutListener.listen(8313) ? ((result &amp; 1) != 1) : ((result &amp; 1) == 1)))))) ? ~(result &gt;&gt; 1) : (result &gt;&gt; 1));</span>
<span class="nc bnc" id="L131" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(8318)) {</span>
<span class="nc" id="L132">                        lon += dlon;</span>
                    }
<span class="nc bnc" id="L134" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(8327)) {</span>
                        // The polyline encodes in degrees * 1E5, we need decimal degrees
<span class="nc bnc" id="L136" title="All 16 branches missed.">                        array.add(LocationUtils.makeLocation((ListenerUtil.mutListener.listen(8322) ? (lat % 1E5) : (ListenerUtil.mutListener.listen(8321) ? (lat * 1E5) : (ListenerUtil.mutListener.listen(8320) ? (lat - 1E5) : (ListenerUtil.mutListener.listen(8319) ? (lat + 1E5) : (lat / 1E5))))), (ListenerUtil.mutListener.listen(8326) ? (lon % 1E5) : (ListenerUtil.mutListener.listen(8325) ? (lon * 1E5) : (ListenerUtil.mutListener.listen(8324) ? (lon - 1E5) : (ListenerUtil.mutListener.listen(8323) ? (lon + 1E5) : (lon / 1E5)))))));</span>
                    }
<span class="nc" id="L138">                }</span>
            }
        }
<span class="nc" id="L141">        return array;</span>
    }

    /**
     * Decodes encoded levels according to:
     * http://code.google.com/apis/maps/documentation/polylinealgorithm.html
     *
     * @param encoded   The encoded string.
     * @param numPoints The number of points. This is purely used as a hint
     *                  to allocate memory; the function will always return the
     *                  number
     *                  of points that are contained in the encoded string.
     * @return A list of levels from the encoded string.
     */
    public static List&lt;Integer&gt; decodeLevels(String encoded, int numPoints) {
<span class="nc bnc" id="L156" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(8339)) {</span>
<span class="nc bnc" id="L157" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(8338) ? (numPoints &gt;= 0) : (ListenerUtil.mutListener.listen(8337) ? (numPoints &lt;= 0) : (ListenerUtil.mutListener.listen(8336) ? (numPoints &gt; 0) : (ListenerUtil.mutListener.listen(8335) ? (numPoints != 0) : (ListenerUtil.mutListener.listen(8334) ? (numPoints == 0) : (numPoints &lt; 0))))))) {</span>
<span class="nc" id="L158">                throw new IllegalArgumentException(&quot;numPoints must be &gt;= 0&quot;);</span>
            }
        }
<span class="nc" id="L161">        ArrayList&lt;Integer&gt; array = new ArrayList&lt;Integer&gt;(numPoints);</span>
<span class="nc" id="L162">        final int len = encoded.length();</span>
<span class="nc" id="L163">        int i = 0;</span>
<span class="nc bnc" id="L164" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(8358)) {</span>
            {
<span class="nc" id="L166">                long _loopCounter111 = 0;</span>
<span class="nc bnc" id="L167" title="All 22 branches missed.">                while ((ListenerUtil.mutListener.listen(8357) ? (i &gt;= len) : (ListenerUtil.mutListener.listen(8356) ? (i &lt;= len) : (ListenerUtil.mutListener.listen(8355) ? (i &gt; len) : (ListenerUtil.mutListener.listen(8354) ? (i != len) : (ListenerUtil.mutListener.listen(8353) ? (i == len) : (i &lt; len))))))) {</span>
<span class="nc" id="L168">                    ListenerUtil.loopListener.listen(&quot;_loopCounter111&quot;, ++_loopCounter111);</span>
<span class="nc" id="L169">                    int shift = 0;</span>
<span class="nc" id="L170">                    int result = 0;</span>
                    int a, b;
                    {
<span class="nc" id="L173">                        long _loopCounter110 = 0;</span>
                        do {
<span class="nc" id="L175">                            ListenerUtil.loopListener.listen(&quot;_loopCounter110&quot;, ++_loopCounter110);</span>
<span class="nc" id="L176">                            a = encoded.charAt(i);</span>
<span class="nc bnc" id="L177" title="All 8 branches missed.">                            b = (ListenerUtil.mutListener.listen(8343) ? (a % 63) : (ListenerUtil.mutListener.listen(8342) ? (a / 63) : (ListenerUtil.mutListener.listen(8341) ? (a * 63) : (ListenerUtil.mutListener.listen(8340) ? (a + 63) : (a - 63)))));</span>
<span class="nc bnc" id="L178" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(8344)) {</span>
<span class="nc" id="L179">                                result |= (b &amp; 0x1f) &lt;&lt; shift;</span>
                            }
<span class="nc bnc" id="L181" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(8345)) {</span>
<span class="nc" id="L182">                                shift += 5;</span>
                            }
<span class="nc bnc" id="L184" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(8346)) {</span>
<span class="nc" id="L185">                                ++i;</span>
                            }
<span class="nc bnc" id="L187" title="All 22 branches missed.">                        } while ((ListenerUtil.mutListener.listen(8351) ? (b &lt;= 0x20) : (ListenerUtil.mutListener.listen(8350) ? (b &gt; 0x20) : (ListenerUtil.mutListener.listen(8349) ? (b &lt; 0x20) : (ListenerUtil.mutListener.listen(8348) ? (b != 0x20) : (ListenerUtil.mutListener.listen(8347) ? (b == 0x20) : (b &gt;= 0x20)))))));</span>
                    }
<span class="nc bnc" id="L189" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(8352)) {</span>
<span class="nc" id="L190">                        array.add(result);</span>
                    }
<span class="nc" id="L192">                }</span>
            }
        }
<span class="nc" id="L195">        return array;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span>Generated by the Android Gradle plugin 8.2.0</div></body></html>