<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>InfrastructureIssueActivity.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">agencyXGoogleDebug</a> &gt; <a href="index.source.html" class="el_package">org.onebusaway.android.report.ui</a> &gt; <span class="el_source">InfrastructureIssueActivity.java</span></div><h1>InfrastructureIssueActivity.java</h1><pre class="source lang-java linenums">/*
* Copyright (C) 2014-2015 University of South Florida (sjbarbeau@gmail.com)
*
* Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*      http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
package org.onebusaway.android.report.ui;

import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.location.Address;
import android.location.Geocoder;
import android.location.Location;
import android.os.Bundle;
import android.view.KeyEvent;
import android.view.LayoutInflater;
import android.view.MenuItem;
import android.view.View;
import android.view.Window;
import android.view.inputmethod.EditorInfo;
import android.widget.AdapterView;
import android.widget.EditText;
import android.widget.FrameLayout;
import android.widget.ImageView;
import android.widget.LinearLayout;
import android.widget.RelativeLayout;
import android.widget.Spinner;
import android.widget.TextView;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import org.onebusaway.android.R;
import org.onebusaway.android.app.Application;
import org.onebusaway.android.io.elements.ObaArrivalInfo;
import org.onebusaway.android.io.elements.ObaRoute;
import org.onebusaway.android.io.elements.ObaStop;
import org.onebusaway.android.io.elements.ObaStopElement;
import org.onebusaway.android.map.MapParams;
import org.onebusaway.android.map.googlemapsv2.BaseMapFragment;
import org.onebusaway.android.report.connection.GeocoderTask;
import org.onebusaway.android.report.connection.ServiceListTask;
import org.onebusaway.android.report.constants.ReportConstants;
import org.onebusaway.android.report.ui.adapter.EntrySpinnerAdapter;
import org.onebusaway.android.report.ui.adapter.SectionItem;
import org.onebusaway.android.report.ui.adapter.ServiceSpinnerItem;
import org.onebusaway.android.report.ui.adapter.SpinnerItem;
import org.onebusaway.android.report.ui.dialog.ReportSuccessDialog;
import org.onebusaway.android.report.ui.util.IssueLocationHelper;
import org.onebusaway.android.report.ui.util.ServiceUtils;
import org.onebusaway.android.util.LocationUtils;
import org.onebusaway.android.util.PreferenceUtils;
import org.onebusaway.android.util.ShowcaseViewUtils;
import org.opentripplanner.routing.bike_rental.BikeRentalStation;
import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.TreeMap;
import edu.usf.cutr.open311client.Open311;
import edu.usf.cutr.open311client.Open311Manager;
import edu.usf.cutr.open311client.models.Service;
import edu.usf.cutr.open311client.models.ServiceListRequest;
import edu.usf.cutr.open311client.models.ServiceListResponse;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

<span class="nc" id="L76">public class InfrastructureIssueActivity extends BaseReportActivity implements BaseMapFragment.OnFocusChangedListener, ServiceListTask.Callback, ReportProblemFragmentCallback, IssueLocationHelper.Callback, SimpleArrivalListFragment.Callback, GeocoderTask.Callback {</span>

    private static final int REQUEST_CODE = 0;

    private static final String SHOW_STOP_MARKER = &quot;.showMarker&quot;;

    private static final String SELECTED_SERVICE = &quot;.selectedService&quot;;

    private static final String SELECTED_SERVICE_TYPE = &quot;.selectedServiceType&quot;;

    private static final String RESTORED_SERVICE = &quot;.restoredService&quot;;

    private static final String SHOW_CATEGORIES = &quot;.showCategories&quot;;

    private static final String SHOW_INFO = &quot;.showInfo&quot;;

    private static final String HEURISTIC_MATCH = &quot;.isHeuristicMatch&quot;;

    private static final String ARRIVAL_LIST = &quot;.arrivalList&quot;;

    private static final String TRIP_INFO = &quot;.tripInfo&quot;;

    private static final String AGENCY_NAME = &quot;.agencyName&quot;;

    private static final String BLOCK_ID = &quot;.blockId&quot;;

    private static final String ACTION_BAR_TITLE = &quot;.actionBarTitle&quot;;

    private static final String TUTORIAL_COUNTER = &quot;tutorial_counter&quot;;

    /**
     * UI Elements
     */
    private EditText mAddressEditText;

    private Spinner mServicesSpinner;

    private RelativeLayout mBusStopHeader;

    // Map Fragment
    private BaseMapFragment mMapFragment;

    // Services spinner container
    private FrameLayout mServicesSpinnerFrameLayout;

    // Location helper for tracking the issue location
    private IssueLocationHelper mIssueLocationHelper;

    /**
     * Open311 client
     */
    private Open311 mOpen311;

    /**
     * Store the transit service type if there is no bus stop selected
     * Then, when a user selects a bus stop, find the transit service by type and show
     */
    private String mTransitServiceIssueTypeWithoutStop;

    /**
     * Selected transit service object
     */
    private Service mSelectedTransitService;

    /**
     * Select this issue type when the activity starts
     * If a user selects &quot;report stop or trip problem&quot; from the main activity, set the default
     * value to this variable
     */
    private String mDefaultIssueType;

    /**
     * True if the transit services were matched heuristically, and false if they were not
     */
    private boolean mIsAllTransitHeuristicMatch;

    /**
     * Restore this issue on rotation
     */
    private String mRestoredServiceName;

    /**
     * Selected arrival information for trip problem reporting
     */
    private ObaArrivalInfo mArrivalInfo;

    /**
     * Block ID for the trip in mArrivalInfo
     */
    private String mBlockId;

    /**
     * Agency name for trip problem reporting
     */
    private String mAgencyName;

    /**
     * For rotation changes:
     * Save instance state vars
     * Restores old selected categories and marker position
     */
<span class="nc" id="L177">    private boolean mShowCategories = false;</span>

<span class="nc" id="L179">    private boolean mShowStopMarker = false;</span>

<span class="nc" id="L181">    private boolean mShowArrivalListFragment = false;</span>

    /**
     * Starts the InfrastructureIssueActivity.
     *
     * startActivityForResult was used to close the calling activity. This used in BaseReportActivity
     * to close it when a user submits an issue.
     *
     * @param activity The parent activity.
     * @param intent   The Intent containing focusId, lat, lon of the map
     */
    public static void start(Activity activity, Intent intent) {
<span class="nc bnc" id="L193" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11654)) {</span>
<span class="nc" id="L194">            activity.startActivityForResult(makeIntent(activity, intent), REQUEST_CODE);</span>
        }
<span class="nc" id="L196">    }</span>

    /**
     * Starts the InfrastructureIssueActivity with a given open311 service category selected
     *
     * startActivityForResult was used to close the calling activity. This used in BaseReportActivity
     * to close it when a user submits an issue.
     *
     * @param activity The parent activity.
     * @param intent   The Intent containing focusId, lat, lon of the map
     */
    public static void startWithService(Activity activity, Intent intent, String serviceKeyword) {
<span class="nc bnc" id="L208" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11655)) {</span>
<span class="nc" id="L209">            intent = makeIntent(activity, intent);</span>
        }
<span class="nc bnc" id="L211" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11656)) {</span>
<span class="nc" id="L212">            intent.putExtra(SELECTED_SERVICE, serviceKeyword);</span>
        }
<span class="nc bnc" id="L214" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11657)) {</span>
<span class="nc" id="L215">            activity.startActivityForResult(intent, REQUEST_CODE);</span>
        }
<span class="nc" id="L217">    }</span>

    /**
     * Starts the InfrastructureIssueActivity with a given open311 service category selected
     *
     * @param context The context of the parent activity.
     * @param intent   The Intent containing focusId, lat, lon of the map
     */
    public static void startWithService(Context context, Intent intent, String serviceKeyword) {
<span class="nc bnc" id="L226" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11658)) {</span>
<span class="nc" id="L227">            intent = makeIntent(context, intent);</span>
        }
<span class="nc bnc" id="L229" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11659)) {</span>
<span class="nc" id="L230">            intent.putExtra(SELECTED_SERVICE, serviceKeyword);</span>
        }
<span class="nc bnc" id="L232" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11660)) {</span>
<span class="nc" id="L233">            context.startActivity(intent);</span>
        }
<span class="nc" id="L235">    }</span>

    /**
     * Starts the InfrastructureIssueActivity with a given open311 service category selected
     *
     * startActivityForResult was used to close the calling activity. This used in BaseReportActivity
     * to close it when a user submits an issue.
     *
     * @param activity       The parent activity.
     * @param intent         The Intent containing focusId, lat, lon of the map
     * @param obaArrivalInfo Arrival info for trip problems
     * @param agencyName     Name of the agency that operates the service
     * @param blockId        Block ID for the trip in obaArrivalInfo
     */
    public static void startWithService(Activity activity, Intent intent, String serviceKeyword, ObaArrivalInfo obaArrivalInfo, String agencyName, String blockId) {
<span class="nc bnc" id="L250" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11661)) {</span>
<span class="nc" id="L251">            intent = makeIntent(activity, intent);</span>
        }
<span class="nc bnc" id="L253" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11662)) {</span>
            // Put trip issue specific data
<span class="nc" id="L255">            intent.putExtra(SELECTED_SERVICE, serviceKeyword);</span>
        }
<span class="nc bnc" id="L257" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11663)) {</span>
<span class="nc" id="L258">            intent.putExtra(TRIP_INFO, obaArrivalInfo);</span>
        }
<span class="nc bnc" id="L260" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11664)) {</span>
<span class="nc" id="L261">            intent.putExtra(AGENCY_NAME, agencyName);</span>
        }
<span class="nc bnc" id="L263" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11665)) {</span>
<span class="nc" id="L264">            intent.putExtra(BLOCK_ID, blockId);</span>
        }
<span class="nc bnc" id="L266" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11666)) {</span>
<span class="nc" id="L267">            activity.startActivityForResult(intent, REQUEST_CODE);</span>
        }
<span class="nc" id="L269">    }</span>

    /**
     * Returns an intent that will start the MapActivity with a particular stop
     * focused with the center of the map at a particular point.
     *
     * @param context The context of the activity.
     * @param intent  The Intent containing focusId, lat, lon of the map
     */
    public static Intent makeIntent(Context context, Intent intent) {
<span class="nc" id="L279">        Intent myIntent = new Intent(context, InfrastructureIssueActivity.class);</span>
<span class="nc bnc" id="L280" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11667)) {</span>
<span class="nc" id="L281">            myIntent.putExtra(MapParams.STOP_ID, intent.getStringExtra(MapParams.STOP_ID));</span>
        }
<span class="nc bnc" id="L283" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11668)) {</span>
<span class="nc" id="L284">            myIntent.putExtra(MapParams.STOP_NAME, intent.getStringExtra(MapParams.STOP_NAME));</span>
        }
<span class="nc bnc" id="L286" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11669)) {</span>
<span class="nc" id="L287">            myIntent.putExtra(MapParams.STOP_CODE, intent.getStringExtra(MapParams.STOP_CODE));</span>
        }
<span class="nc bnc" id="L289" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11670)) {</span>
<span class="nc" id="L290">            myIntent.putExtra(MapParams.CENTER_LAT, intent.getDoubleExtra(MapParams.CENTER_LAT, 0));</span>
        }
<span class="nc bnc" id="L292" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11671)) {</span>
<span class="nc" id="L293">            myIntent.putExtra(MapParams.CENTER_LON, intent.getDoubleExtra(MapParams.CENTER_LON, 0));</span>
        }
<span class="nc" id="L295">        return myIntent;</span>
    }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
<span class="nc bnc" id="L300" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11672)) {</span>
<span class="nc" id="L301">            supportRequestWindowFeature(Window.FEATURE_INDETERMINATE_PROGRESS);</span>
        }
<span class="nc bnc" id="L303" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11673)) {</span>
<span class="nc" id="L304">            super.onCreate(savedInstanceState);</span>
        }
<span class="nc bnc" id="L306" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11674)) {</span>
<span class="nc" id="L307">            setContentView(R.layout.infrastructure_issue);</span>
        }
<span class="nc bnc" id="L309" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11675)) {</span>
<span class="nc" id="L310">            setUpOpen311();</span>
        }
<span class="nc bnc" id="L312" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11676)) {</span>
<span class="nc" id="L313">            setUpProgressBar();</span>
        }
<span class="nc bnc" id="L315" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11677)) {</span>
<span class="nc" id="L316">            setupMapFragment(savedInstanceState);</span>
        }
<span class="nc bnc" id="L318" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11678)) {</span>
<span class="nc" id="L319">            setupLocationHelper(savedInstanceState);</span>
        }
<span class="nc bnc" id="L321" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11679)) {</span>
<span class="nc" id="L322">            setupViews();</span>
        }
<span class="nc bnc" id="L324" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11680)) {</span>
<span class="nc" id="L325">            setupIntentData(savedInstanceState);</span>
        }
<span class="nc bnc" id="L327" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11681)) {</span>
<span class="nc" id="L328">            setupIconColors();</span>
        }
<span class="nc bnc" id="L330" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11682)) {</span>
<span class="nc" id="L331">            initLocation();</span>
        }
<span class="nc bnc" id="L333" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11683)) {</span>
<span class="nc" id="L334">            setActionBarTitle(savedInstanceState);</span>
        }
<span class="nc" id="L336">    }</span>

    /**
     * Set the intent parameters when the activity starts
     * @param savedInstanceState
     */
    private void setupIntentData(Bundle savedInstanceState) {
<span class="nc bnc" id="L343" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11692)) {</span>
<span class="nc bnc" id="L344" title="All 2 branches missed.">            if (savedInstanceState == null) {</span>
<span class="nc" id="L345">                double lat = getIntent().getDoubleExtra(MapParams.CENTER_LAT, 0);</span>
<span class="nc" id="L346">                double lon = getIntent().getDoubleExtra(MapParams.CENTER_LON, 0);</span>
                // Set the focus to the current stop
<span class="nc" id="L348">                String stopId = getIntent().getStringExtra(MapParams.STOP_ID);</span>
<span class="nc" id="L349">                String stopName = getIntent().getStringExtra(MapParams.STOP_NAME);</span>
<span class="nc" id="L350">                String stopCode = getIntent().getStringExtra(MapParams.STOP_CODE);</span>
<span class="nc bnc" id="L351" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11687)) {</span>
<span class="nc bnc" id="L352" title="All 2 branches missed.">                    if (stopId != null) {</span>
<span class="nc bnc" id="L353" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11684)) {</span>
<span class="nc" id="L354">                            mIssueLocationHelper.setObaStop(new ObaStopElement(stopId, lat, lon, stopName, stopCode));</span>
                        }
<span class="nc bnc" id="L356" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11685)) {</span>
<span class="nc" id="L357">                            showBusStopHeader(stopName);</span>
                        }
<span class="nc bnc" id="L359" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11686)) {</span>
<span class="nc" id="L360">                            mShowStopMarker = true;</span>
                        }
                    }
                }
<span class="nc bnc" id="L364" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11688)) {</span>
<span class="nc" id="L365">                    mArrivalInfo = (ObaArrivalInfo) getIntent().getSerializableExtra(TRIP_INFO);</span>
                }
<span class="nc bnc" id="L367" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11689)) {</span>
<span class="nc" id="L368">                    mAgencyName = getIntent().getStringExtra(AGENCY_NAME);</span>
                }
<span class="nc bnc" id="L370" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11690)) {</span>
<span class="nc" id="L371">                    mBlockId = getIntent().getStringExtra(BLOCK_ID);</span>
                }
<span class="nc bnc" id="L373" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11691)) {</span>
<span class="nc" id="L374">                    mDefaultIssueType = getIntent().getStringExtra(SELECTED_SERVICE);</span>
                }
            }
        }
<span class="nc" id="L378">    }</span>

    @Override
    protected void onPause() {
<span class="nc bnc" id="L382" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11693)) {</span>
<span class="nc" id="L383">            ShowcaseViewUtils.hideShowcaseView();</span>
        }
<span class="nc bnc" id="L385" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11694)) {</span>
<span class="nc" id="L386">            super.onPause();</span>
        }
<span class="nc" id="L388">    }</span>

    @Override
    protected void onSaveInstanceState(Bundle outState) {
<span class="nc bnc" id="L392" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11695)) {</span>
<span class="nc" id="L393">            super.onSaveInstanceState(outState);</span>
        }
<span class="nc bnc" id="L395" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11696)) {</span>
<span class="nc" id="L396">            outState.putFloat(MapParams.ZOOM, mMapFragment.getMapView().getZoomLevelAsFloat());</span>
        }
<span class="nc" id="L398">        ObaStop obaStop = mIssueLocationHelper.getObaStop();</span>
<span class="nc bnc" id="L399" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11702)) {</span>
<span class="nc bnc" id="L400" title="All 2 branches missed.">            if (obaStop != null) {</span>
<span class="nc" id="L401">                String stopId = obaStop.getId();</span>
<span class="nc bnc" id="L402" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11697)) {</span>
<span class="nc" id="L403">                    getIntent().putExtra(MapParams.STOP_ID, stopId);</span>
                }
<span class="nc bnc" id="L405" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11698)) {</span>
<span class="nc" id="L406">                    outState.putString(MapParams.STOP_ID, stopId);</span>
                }
<span class="nc bnc" id="L408" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11699)) {</span>
<span class="nc" id="L409">                    outState.putString(MapParams.STOP_NAME, obaStop.getName());</span>
                }
<span class="nc bnc" id="L411" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11700)) {</span>
<span class="nc" id="L412">                    outState.putString(MapParams.STOP_CODE, obaStop.getStopCode());</span>
                }
<span class="nc bnc" id="L414" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11701)) {</span>
<span class="nc" id="L415">                    outState.putBoolean(SHOW_STOP_MARKER, true);</span>
                }
            }
        }
<span class="nc bnc" id="L419" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11703)) {</span>
<span class="nc" id="L420">            outState.putDouble(MapParams.CENTER_LAT, mIssueLocationHelper.getIssueLocation().getLatitude());</span>
        }
<span class="nc bnc" id="L422" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11704)) {</span>
<span class="nc" id="L423">            outState.putDouble(MapParams.CENTER_LON, mIssueLocationHelper.getIssueLocation().getLongitude());</span>
        }
<span class="nc" id="L425">        SpinnerItem spinnerItem = (SpinnerItem) mServicesSpinner.getSelectedItem();</span>
<span class="nc bnc" id="L426" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11711)) {</span>
<span class="nc bnc" id="L427" title="All 90 branches missed.">            if ((ListenerUtil.mutListener.listen(11708) ? (spinnerItem != null || ((ListenerUtil.mutListener.listen(11707) ? ((ListenerUtil.mutListener.listen(11705) ? (!spinnerItem.isHint() || !spinnerItem.isSection()) : (!spinnerItem.isHint() &amp;&amp; !spinnerItem.isSection())) &amp;&amp; ((ListenerUtil.mutListener.listen(11706) ? (spinnerItem.isHint() || mServicesSpinnerFrameLayout.getVisibility() == View.VISIBLE) : (spinnerItem.isHint() &amp;&amp; mServicesSpinnerFrameLayout.getVisibility() == View.VISIBLE)))) : ((ListenerUtil.mutListener.listen(11705) ? (!spinnerItem.isHint() || !spinnerItem.isSection()) : (!spinnerItem.isHint() &amp;&amp; !spinnerItem.isSection())) || ((ListenerUtil.mutListener.listen(11706) ? (spinnerItem.isHint() || mServicesSpinnerFrameLayout.getVisibility() == View.VISIBLE) : (spinnerItem.isHint() &amp;&amp; mServicesSpinnerFrameLayout.getVisibility() == View.VISIBLE))))))) : (spinnerItem != null &amp;&amp; ((ListenerUtil.mutListener.listen(11707) ? ((ListenerUtil.mutListener.listen(11705) ? (!spinnerItem.isHint() || !spinnerItem.isSection()) : (!spinnerItem.isHint() &amp;&amp; !spinnerItem.isSection())) &amp;&amp; ((ListenerUtil.mutListener.listen(11706) ? (spinnerItem.isHint() || mServicesSpinnerFrameLayout.getVisibility() == View.VISIBLE) : (spinnerItem.isHint() &amp;&amp; mServicesSpinnerFrameLayout.getVisibility() == View.VISIBLE)))) : ((ListenerUtil.mutListener.listen(11705) ? (!spinnerItem.isHint() || !spinnerItem.isSection()) : (!spinnerItem.isHint() &amp;&amp; !spinnerItem.isSection())) || ((ListenerUtil.mutListener.listen(11706) ? (spinnerItem.isHint() || mServicesSpinnerFrameLayout.getVisibility() == View.VISIBLE) : (spinnerItem.isHint() &amp;&amp; mServicesSpinnerFrameLayout.getVisibility() == View.VISIBLE))))))))) {</span>
<span class="nc" id="L428">                Service service = ((ServiceSpinnerItem) spinnerItem).getService();</span>
<span class="nc bnc" id="L429" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11709)) {</span>
<span class="nc" id="L430">                    outState.putString(RESTORED_SERVICE, service.getService_name());</span>
                }
<span class="nc bnc" id="L432" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11710)) {</span>
<span class="nc" id="L433">                    outState.putBoolean(SHOW_CATEGORIES, true);</span>
                }
            }
        }
<span class="nc bnc" id="L437" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11713)) {</span>
<span class="nc bnc" id="L438" title="All 2 branches missed.">            if (isInfoVisible()) {</span>
<span class="nc" id="L439">                String infoText = ((TextView) mInfoHeader.findViewById(R.id.ri_info_text)).getText().toString();</span>
<span class="nc bnc" id="L440" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11712)) {</span>
<span class="nc" id="L441">                    outState.putString(SHOW_INFO, infoText);</span>
                }
            }
        }
<span class="nc bnc" id="L445" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11714)) {</span>
<span class="nc" id="L446">            outState.putBoolean(ARRIVAL_LIST, mShowArrivalListFragment);</span>
        }
<span class="nc bnc" id="L448" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11715)) {</span>
<span class="nc" id="L449">            outState.putBoolean(HEURISTIC_MATCH, mIsAllTransitHeuristicMatch);</span>
        }
<span class="nc bnc" id="L451" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11716)) {</span>
<span class="nc" id="L452">            outState.putString(AGENCY_NAME, mAgencyName);</span>
        }
<span class="nc bnc" id="L454" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11717)) {</span>
<span class="nc" id="L455">            outState.putString(BLOCK_ID, mBlockId);</span>
        }
<span class="nc bnc" id="L457" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11718)) {</span>
<span class="nc" id="L458">            outState.putString(SELECTED_SERVICE_TYPE, mTransitServiceIssueTypeWithoutStop);</span>
        }
<span class="nc bnc" id="L460" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11719)) {</span>
<span class="nc" id="L461">            outState.putString(ACTION_BAR_TITLE, getTitle().toString());</span>
        }
<span class="nc" id="L463">    }</span>

    @Override
    protected void onRestoreInstanceState(Bundle savedInstanceState) {
<span class="nc bnc" id="L467" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11720)) {</span>
<span class="nc" id="L468">            super.onRestoreInstanceState(savedInstanceState);</span>
        }
<span class="nc bnc" id="L470" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11736)) {</span>
<span class="nc bnc" id="L471" title="All 2 branches missed.">            if (savedInstanceState != null) {</span>
<span class="nc bnc" id="L472" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11721)) {</span>
<span class="nc" id="L473">                    mShowCategories = savedInstanceState.getBoolean(SHOW_CATEGORIES, false);</span>
                }
<span class="nc bnc" id="L475" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11722)) {</span>
<span class="nc" id="L476">                    mShowStopMarker = savedInstanceState.getBoolean(SHOW_STOP_MARKER, false);</span>
                }
<span class="nc bnc" id="L478" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11723)) {</span>
<span class="nc" id="L479">                    mShowArrivalListFragment = savedInstanceState.getBoolean(ARRIVAL_LIST, false);</span>
                }
<span class="nc bnc" id="L481" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11724)) {</span>
<span class="nc" id="L482">                    mRestoredServiceName = savedInstanceState.getString(RESTORED_SERVICE);</span>
                }
<span class="nc bnc" id="L484" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11725)) {</span>
<span class="nc" id="L485">                    mAgencyName = savedInstanceState.getString(AGENCY_NAME);</span>
                }
<span class="nc bnc" id="L487" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11726)) {</span>
<span class="nc" id="L488">                    mBlockId = savedInstanceState.getString(BLOCK_ID);</span>
                }
<span class="nc bnc" id="L490" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11727)) {</span>
<span class="nc" id="L491">                    mTransitServiceIssueTypeWithoutStop = savedInstanceState.getString(SELECTED_SERVICE_TYPE);</span>
                }
<span class="nc bnc" id="L493" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11728)) {</span>
<span class="nc" id="L494">                    mIsAllTransitHeuristicMatch = savedInstanceState.getBoolean(HEURISTIC_MATCH);</span>
                }
<span class="nc" id="L496">                String bundleStopId = savedInstanceState.getString(MapParams.STOP_ID);</span>
<span class="nc" id="L497">                String stopName = savedInstanceState.getString(MapParams.STOP_NAME);</span>
<span class="nc" id="L498">                String stopCode = savedInstanceState.getString(MapParams.STOP_CODE);</span>
<span class="nc bnc" id="L499" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11730)) {</span>
<span class="nc bnc" id="L500" title="All 2 branches missed.">                    if (bundleStopId != null) {</span>
<span class="nc" id="L501">                        double lat = savedInstanceState.getDouble(MapParams.CENTER_LAT, 0);</span>
<span class="nc" id="L502">                        double lon = savedInstanceState.getDouble(MapParams.CENTER_LON, 0);</span>
<span class="nc" id="L503">                        Location location = LocationUtils.makeLocation(lat, lon);</span>
<span class="nc bnc" id="L504" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11729)) {</span>
<span class="nc" id="L505">                            mIssueLocationHelper.updateMarkerPosition(location, new ObaStopElement(bundleStopId, lat, lon, stopName, stopCode));</span>
                        }
                    }
                }
<span class="nc" id="L509">                String infoText = savedInstanceState.getString(SHOW_INFO);</span>
<span class="nc bnc" id="L510" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11732)) {</span>
<span class="nc bnc" id="L511" title="All 2 branches missed.">                    if (infoText != null) {</span>
<span class="nc bnc" id="L512" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11731)) {</span>
<span class="nc" id="L513">                            addInfoText(infoText);</span>
                        }
                    }
                }
<span class="nc bnc" id="L517" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11735)) {</span>
<span class="nc bnc" id="L518" title="All 2 branches missed.">                    if (mShowArrivalListFragment) {</span>
<span class="nc bnc" id="L519" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11733)) {</span>
<span class="nc" id="L520">                            removeTripProblemFragment();</span>
                        }
<span class="nc bnc" id="L522" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11734)) {</span>
<span class="nc" id="L523">                            showArrivalListFragment(mIssueLocationHelper.getObaStop());</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L529">    }</span>

    /**
     * Set default open311 client
     */
    private void setUpOpen311() {
<span class="nc bnc" id="L535" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11737)) {</span>
<span class="nc" id="L536">            mOpen311 = Open311Manager.getDefaultOpen311();</span>
        }
<span class="nc" id="L538">    }</span>

    /**
     * Setting up the BaseMapFragment
     * BaseMapFragment was used to implement a map.
     */
    private void setupMapFragment(Bundle bundle) {
<span class="nc" id="L545">        FragmentManager fm = getSupportFragmentManager();</span>
<span class="nc" id="L546">        Fragment fragment = fm.findFragmentByTag(BaseMapFragment.TAG);</span>
<span class="nc bnc" id="L547" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11740)) {</span>
<span class="nc bnc" id="L548" title="All 2 branches missed.">            if (fragment != null) {</span>
<span class="nc bnc" id="L549" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11738)) {</span>
<span class="nc" id="L550">                    mMapFragment = (BaseMapFragment) fragment;</span>
                }
<span class="nc bnc" id="L552" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11739)) {</span>
<span class="nc" id="L553">                    mMapFragment.setOnFocusChangeListener(this);</span>
                }
            }
        }
<span class="nc bnc" id="L557" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11745)) {</span>
<span class="nc bnc" id="L558" title="All 2 branches missed.">            if (mMapFragment == null) {</span>
<span class="nc bnc" id="L559" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11741)) {</span>
<span class="nc" id="L560">                    mMapFragment = new BaseMapFragment();</span>
                }
<span class="nc bnc" id="L562" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11742)) {</span>
<span class="nc" id="L563">                    mMapFragment.setArguments(bundle);</span>
                }
<span class="nc bnc" id="L565" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11743)) {</span>
                    // Register listener for map focus callbacks
<span class="nc" id="L567">                    mMapFragment.setOnFocusChangeListener(this);</span>
                }
<span class="nc bnc" id="L569" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11744)) {</span>
<span class="nc" id="L570">                    fm.beginTransaction().add(R.id.ri_frame_map_view, mMapFragment, BaseMapFragment.TAG).commit();</span>
                }
            }
        }
<span class="nc bnc" id="L574" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11746)) {</span>
<span class="nc" id="L575">            fm.beginTransaction().show(mMapFragment).commit();</span>
        }
<span class="nc" id="L577">    }</span>

    /**
     * Setting up the location helper
     * IssueLocationHelper helps tracking the issue location and issue stop
     */
    private void setupLocationHelper(Bundle savedInstanceState) {
        double lat;
        double lon;
<span class="nc bnc" id="L586" title="All 2 branches missed.">        if (savedInstanceState == null) {</span>
<span class="nc" id="L587">            lat = getIntent().getDoubleExtra(MapParams.CENTER_LAT, 0);</span>
<span class="nc" id="L588">            lon = getIntent().getDoubleExtra(MapParams.CENTER_LON, 0);</span>
        } else {
<span class="nc" id="L590">            lat = savedInstanceState.getDouble(MapParams.CENTER_LAT, 0);</span>
<span class="nc" id="L591">            lon = savedInstanceState.getDouble(MapParams.CENTER_LON, 0);</span>
        }
<span class="nc" id="L593">        Location mapCenterLocation = LocationUtils.makeLocation(lat, lon);</span>
<span class="nc bnc" id="L594" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11747)) {</span>
<span class="nc" id="L595">            mIssueLocationHelper = new IssueLocationHelper(mapCenterLocation, this);</span>
        }
<span class="nc bnc" id="L597" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11748)) {</span>
            // Set map center location
<span class="nc" id="L599">            mMapFragment.setMapCenter(mapCenterLocation, true, false);</span>
        }
<span class="nc" id="L601">    }</span>

    /**
     * Initialize UI components
     */
    private void setupViews() {
<span class="nc bnc" id="L607" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11750)) {</span>
<span class="nc bnc" id="L608" title="All 2 branches missed.">            if (getSupportActionBar() != null) {</span>
<span class="nc bnc" id="L609" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11749)) {</span>
<span class="nc" id="L610">                    getSupportActionBar().setDisplayHomeAsUpEnabled(true);</span>
                }
            }
        }
<span class="nc bnc" id="L614" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11751)) {</span>
<span class="nc" id="L615">            mServicesSpinnerFrameLayout = (FrameLayout) findViewById(R.id.ri_spinnerView);</span>
        }
<span class="nc bnc" id="L617" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11752)) {</span>
<span class="nc" id="L618">            mAddressEditText = (EditText) findViewById(R.id.ri_address_editText);</span>
        }
<span class="nc bnc" id="L620" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11755)) {</span>
<span class="nc" id="L621">            mAddressEditText.setOnEditorActionListener(new TextView.OnEditorActionListener() {</span>

                @Override
                public boolean onEditorAction(TextView v, int actionId, KeyEvent event) {
<span class="nc bnc" id="L625" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11754)) {</span>
<span class="nc bnc" id="L626" title="All 2 branches missed.">                        if (actionId == EditorInfo.IME_ACTION_SEARCH) {</span>
<span class="nc bnc" id="L627" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11753)) {</span>
<span class="nc" id="L628">                                searchAddress();</span>
                            }
<span class="nc" id="L630">                            return true;</span>
                        }
                    }
<span class="nc" id="L633">                    return false;</span>
                }
            });
        }
<span class="nc" id="L637">        CustomScrollView mainScrollView = (CustomScrollView) findViewById(R.id.ri_scrollView);</span>
<span class="nc bnc" id="L638" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11756)) {</span>
<span class="nc" id="L639">            mainScrollView.addInterceptScrollView(findViewById(R.id.ri_frame_map_view));</span>
        }
<span class="nc bnc" id="L641" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11757)) {</span>
<span class="nc" id="L642">            mServicesSpinner = (Spinner) findViewById(R.id.ri_spinnerServices);</span>
        }
<span class="nc bnc" id="L644" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11764)) {</span>
<span class="nc" id="L645">            mServicesSpinner.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {</span>

                @Override
                public void onItemSelected(AdapterView&lt;?&gt; parentView, View selectedItemView, int position, long id) {
<span class="nc bnc" id="L649" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11759)) {</span>
<span class="nc bnc" id="L650" title="All 2 branches missed.">                        if (mShowCategories) {</span>
<span class="nc bnc" id="L651" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11758)) {</span>
<span class="nc" id="L652">                                mShowCategories = false;</span>
                            }
<span class="nc" id="L654">                            return;</span>
                        }
                    }
<span class="nc" id="L657">                    SpinnerItem spinnerItem = (SpinnerItem) mServicesSpinner.getSelectedItem();</span>
<span class="nc bnc" id="L658" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11763)) {</span>
<span class="nc bnc" id="L659" title="All 10 branches missed.">                        if ((ListenerUtil.mutListener.listen(11760) ? (!spinnerItem.isHint() || !spinnerItem.isSection()) : (!spinnerItem.isHint() &amp;&amp; !spinnerItem.isSection()))) {</span>
<span class="nc" id="L660">                            Service service = ((ServiceSpinnerItem) spinnerItem).getService();</span>
<span class="nc bnc" id="L661" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11762)) {</span>
<span class="nc" id="L662">                                onSpinnerItemSelected(service);</span>
                            }
<span class="nc bnc" id="L664" title="All 2 branches missed.">                        } else if (spinnerItem.isHint()) {</span>
<span class="nc bnc" id="L665" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11761)) {</span>
<span class="nc" id="L666">                                clearReportingFragments(false);</span>
                            }
                        }
                    }
<span class="nc" id="L670">                }</span>

                @Override
                public void onNothingSelected(AdapterView&lt;?&gt; parentView) {
<span class="nc" id="L674">                }</span>
            });
        }
<span class="nc bnc" id="L677" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11765)) {</span>
<span class="nc" id="L678">            mBusStopHeader = (RelativeLayout) findViewById(R.id.bus_stop_header);</span>
        }
<span class="nc" id="L680">    }</span>

    private void setActionBarTitle(Bundle savedInstanceState) {
<span class="nc bnc" id="L683" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11768)) {</span>
<span class="nc bnc" id="L684" title="All 2 branches missed.">            if (savedInstanceState == null) {</span>
<span class="nc bnc" id="L685" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11767)) {</span>
<span class="nc" id="L686">                    setActionBarTitle(mDefaultIssueType);</span>
                }
            } else {
<span class="nc bnc" id="L689" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11766)) {</span>
<span class="nc" id="L690">                    setTitle(savedInstanceState.getString(ACTION_BAR_TITLE));</span>
                }
            }
        }
<span class="nc" id="L694">    }</span>

    /**
     * Set action bar title by issue type
     *
     * @param issueType could be stop, trip, dynamic_stop or dynamic_trip
     */
    private void setActionBarTitle(String issueType) {
<span class="nc bnc" id="L702" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11772)) {</span>
<span class="nc bnc" id="L703" title="All 2 branches missed.">            if (ServiceUtils.isTransitStopServiceByType(issueType)) {</span>
<span class="nc bnc" id="L704" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11771)) {</span>
<span class="nc" id="L705">                    setTitle(getString(R.string.rt_stop_problem_title));</span>
                }
<span class="nc bnc" id="L707" title="All 2 branches missed.">            } else if (ServiceUtils.isTransitTripServiceByType(issueType)) {</span>
<span class="nc bnc" id="L708" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11770)) {</span>
<span class="nc" id="L709">                    setTitle(getString(R.string.rt_arrival_problem_title));</span>
                }
            } else {
<span class="nc bnc" id="L712" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11769)) {</span>
<span class="nc" id="L713">                    setTitle(getString(R.string.rt_infrastructure_problem_title));</span>
                }
            }
        }
<span class="nc" id="L717">    }</span>

    private void setupIconColors() {
<span class="nc bnc" id="L720" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11773)) {</span>
<span class="nc" id="L721">            ((ImageView) findViewById(R.id.ri_ic_location)).setColorFilter(getResources().getColor(R.color.material_gray));</span>
        }
<span class="nc bnc" id="L723" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11774)) {</span>
<span class="nc" id="L724">            ((ImageView) findViewById(R.id.ri_ic_category)).setColorFilter(getResources().getColor(R.color.material_gray));</span>
        }
<span class="nc bnc" id="L726" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11775)) {</span>
<span class="nc" id="L727">            ((ImageView) findViewById(R.id.ri_header_location)).setColorFilter(getResources().getColor(android.R.color.white));</span>
        }
<span class="nc" id="L729">    }</span>

    /**
     * Show the current location on the map
     */
    private void initLocation() {
<span class="nc bnc" id="L735" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11776)) {</span>
<span class="nc" id="L736">            syncAddress(mIssueLocationHelper.getIssueLocation());</span>
        }
<span class="nc" id="L738">    }</span>

    private void onSpinnerItemSelected(Service service) {
<span class="nc bnc" id="L741" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11777)) {</span>
            // Set static issue type to null
<span class="nc" id="L743">            mTransitServiceIssueTypeWithoutStop = null;</span>
        }
<span class="nc bnc" id="L745" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11778)) {</span>
<span class="nc" id="L746">            mSelectedTransitService = null;</span>
        }
<span class="nc bnc" id="L748" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11785)) {</span>
<span class="nc bnc" id="L749" title="All 26 branches missed.">            if ((ListenerUtil.mutListener.listen(11780) ? (service.getService_code() != null || !((ListenerUtil.mutListener.listen(11779) ? (service.getType() != null || service.getType().contains(ReportConstants.DYNAMIC_SERVICE)) : (service.getType() != null &amp;&amp; service.getType().contains(ReportConstants.DYNAMIC_SERVICE))))) : (service.getService_code() != null &amp;&amp; !((ListenerUtil.mutListener.listen(11779) ? (service.getType() != null || service.getType().contains(ReportConstants.DYNAMIC_SERVICE)) : (service.getType() != null &amp;&amp; service.getType().contains(ReportConstants.DYNAMIC_SERVICE))))))) {</span>
<span class="nc bnc" id="L750" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11784)) {</span>
<span class="nc" id="L751">                    showOpen311Reporting(service);</span>
                }
<span class="nc bnc" id="L753" title="All 2 branches missed.">            } else if (!ReportConstants.DEFAULT_SERVICE.equalsIgnoreCase(service.getType())) {</span>
<span class="nc bnc" id="L754" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11781)) {</span>
<span class="nc" id="L755">                    mSelectedTransitService = service;</span>
                }
<span class="nc bnc" id="L757" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11782)) {</span>
                    // Remove the info text for select category
<span class="nc" id="L759">                    removeInfoText();</span>
                }
<span class="nc bnc" id="L761" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11783)) {</span>
<span class="nc" id="L762">                    showTransitService(service.getType());</span>
                }
            }
        }
<span class="nc bnc" id="L766" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11786)) {</span>
            // Set action bar title based on the selected issue
<span class="nc" id="L768">            setActionBarTitle(service.getType());</span>
        }
<span class="nc" id="L770">    }</span>

    /**
     * Places a marker into the map from given Location
     *
     * @param location position for marker
     */
    private void updateMarkerPosition(Location location) {
<span class="nc" id="L778">        int markerId = mMapFragment.addMarker(location, null);</span>
<span class="nc bnc" id="L779" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11787)) {</span>
<span class="nc" id="L780">            mIssueLocationHelper.handleMarkerUpdate(markerId);</span>
        }
<span class="nc" id="L782">    }</span>

    /**
     * Called when the issue location changes
     * Retrieves Open311 services from current address
     *
     * @param location current issue location
     */
    private void syncAddress(Location location) {
<span class="nc bnc" id="L791" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11788)) {</span>
<span class="nc" id="L792">            syncAddressString(location);</span>
        }
<span class="nc bnc" id="L794" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11789)) {</span>
<span class="nc" id="L795">            showProgress(Boolean.TRUE);</span>
        }
<span class="nc" id="L797">        ServiceListRequest slr = new ServiceListRequest(location.getLatitude(), location.getLongitude());</span>
<span class="nc" id="L798">        List&lt;Open311&gt; open311List = Open311Manager.getAllOpen311();</span>
<span class="nc" id="L799">        ServiceListTask serviceListTask = new ServiceListTask(slr, open311List, this);</span>
<span class="nc bnc" id="L800" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11790)) {</span>
<span class="nc" id="L801">            serviceListTask.execute();</span>
        }
<span class="nc" id="L803">    }</span>

    /**
     * Search address string from mAddressEditText
     */
    private void searchAddress() {
<span class="nc bnc" id="L809" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11791)) {</span>
<span class="nc" id="L810">            showProgress(Boolean.TRUE);</span>
        }
<span class="nc" id="L812">        String addressString = mAddressEditText.getText().toString();</span>
<span class="nc" id="L813">        Location location = getLocationByAddress(addressString);</span>
<span class="nc bnc" id="L814" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11795)) {</span>
<span class="nc bnc" id="L815" title="All 2 branches missed.">            if (location != null) {</span>
<span class="nc bnc" id="L816" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11793)) {</span>
<span class="nc" id="L817">                    mMapFragment.setMapCenter(location, true, true);</span>
                }
<span class="nc bnc" id="L819" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11794)) {</span>
<span class="nc" id="L820">                    syncAddress(location);</span>
                }
            } else {
<span class="nc" id="L823">                String message = getResources().getString(R.string.ri_address_not_found);</span>
<span class="nc bnc" id="L824" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11792)) {</span>
<span class="nc" id="L825">                    createToastMessage(message);</span>
                }
            }
        }
<span class="nc bnc" id="L829" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11796)) {</span>
<span class="nc" id="L830">            showProgress(Boolean.FALSE);</span>
        }
<span class="nc" id="L832">    }</span>

    /**
     * Calculates the address of a given location
     *
     * @param location takes location object
     */
    private void syncAddressString(Location location) {
<span class="nc" id="L840">        GeocoderTask gct = new GeocoderTask(this, location, this);</span>
<span class="nc bnc" id="L841" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11797)) {</span>
<span class="nc" id="L842">            gct.execute();</span>
        }
<span class="nc" id="L844">    }</span>

    /**
     * Converts plain address string to Location object
     *
     * @param addressString takes address string
     * @return Location of given address String
     */
    public Location getLocationByAddress(String addressString) {
<span class="nc" id="L853">        Geocoder coder = new Geocoder(this);</span>
        List&lt;Address&gt; addressList;
        Location location;
        try {
<span class="nc" id="L857">            addressList = coder.getFromLocationName(addressString, 3);</span>
<span class="nc bnc" id="L858" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11800)) {</span>
<span class="nc bnc" id="L859" title="All 10 branches missed.">                if ((ListenerUtil.mutListener.listen(11799) ? (addressList == null &amp;&amp; addressList.size() == 0) : (addressList == null || addressList.size() == 0))) {</span>
<span class="nc" id="L860">                    return null;</span>
                }
            }
<span class="nc" id="L863">            Address address = addressList.get(0);</span>
<span class="nc" id="L864">            location = new Location(&quot;&quot;);</span>
<span class="nc bnc" id="L865" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11801)) {</span>
<span class="nc" id="L866">                location.setLatitude(address.getLatitude());</span>
            }
<span class="nc bnc" id="L868" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11802)) {</span>
<span class="nc" id="L869">                location.setLongitude(address.getLongitude());</span>
            }
<span class="nc" id="L871">            return location;</span>
<span class="nc" id="L872">        } catch (IOException e) {</span>
<span class="nc bnc" id="L873" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11798)) {</span>
<span class="nc" id="L874">                e.printStackTrace();</span>
            }
        }
<span class="nc" id="L877">        return null;</span>
    }

    @Override
    public void onClearMarker(int markerId) {
<span class="nc bnc" id="L882" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11803)) {</span>
<span class="nc" id="L883">            mMapFragment.removeMarker(markerId);</span>
        }
<span class="nc" id="L885">    }</span>

    /**
     * Called by the BaseMapFragment when a stop obtains focus, or no stops have focus
     *
     * @param stop   the ObaStop that obtained focus, or null if no stop is in focus
     * @param routes a HashMap of all route display names that serve this stop - key is routeId
     */
    @Override
    public void onFocusChanged(ObaStop stop, HashMap&lt;String, ObaRoute&gt; routes, Location location) {
<span class="nc bnc" id="L895" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11804)) {</span>
<span class="nc" id="L896">            mIssueLocationHelper.updateMarkerPosition(location, stop);</span>
        }
<span class="nc bnc" id="L898" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11808)) {</span>
            // Don't call syncAddress if you are restoring the instance
<span class="nc bnc" id="L900" title="All 2 branches missed.">            if (mShowStopMarker) {</span>
<span class="nc bnc" id="L901" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11806)) {</span>
<span class="nc bnc" id="L902" title="All 2 branches missed.">                    if (stop != null) {</span>
<span class="nc bnc" id="L903" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11805)) {</span>
                            // Show bus stop name on the header
<span class="nc" id="L905">                            showBusStopHeader(stop.getName());</span>
                        }
                    }
                }
<span class="nc bnc" id="L909" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11807)) {</span>
<span class="nc" id="L910">                    mShowStopMarker = false;</span>
                }
<span class="nc" id="L912">                return;</span>
            }
        }
<span class="nc bnc" id="L915" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11809)) {</span>
            // Clear all reporting fragments
<span class="nc" id="L917">            clearReportingFragments();</span>
        }
<span class="nc bnc" id="L919" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11820)) {</span>
<span class="nc bnc" id="L920" title="All 2 branches missed.">            if (stop != null) {</span>
<span class="nc bnc" id="L921" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11812)) {</span>
                    // Clear manually added markers
<span class="nc" id="L923">                    mIssueLocationHelper.clearMarkers();</span>
                }
<span class="nc bnc" id="L925" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11813)) {</span>
                    // Show bus stop name on the header
<span class="nc" id="L927">                    showBusStopHeader(stop.getName());</span>
                }
<span class="nc bnc" id="L929" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11814)) {</span>
<span class="nc" id="L930">                    showServicesSpinner();</span>
                }
<span class="nc bnc" id="L932" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11818)) {</span>
<span class="nc bnc" id="L933" title="All 2 branches missed.">                    if (mTransitServiceIssueTypeWithoutStop != null) {</span>
<span class="nc bnc" id="L934" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11816)) {</span>
<span class="nc" id="L935">                            showTransitService(mTransitServiceIssueTypeWithoutStop);</span>
                        }
<span class="nc bnc" id="L937" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11817)) {</span>
<span class="nc" id="L938">                            syncAddressString(location);</span>
                        }
                    } else {
<span class="nc bnc" id="L941" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11815)) {</span>
<span class="nc" id="L942">                            syncAddress(stop.getLocation());</span>
                        }
                    }
                }
<span class="nc bnc" id="L946" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11819)) {</span>
                    // Clear static issue type
<span class="nc" id="L948">                    mTransitServiceIssueTypeWithoutStop = null;</span>
                }
<span class="nc bnc" id="L950" title="All 2 branches missed.">            } else if (location != null) {</span>
<span class="nc bnc" id="L951" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11810)) {</span>
<span class="nc" id="L952">                    hideBusStopHeader();</span>
                }
<span class="nc bnc" id="L954" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11811)) {</span>
<span class="nc" id="L955">                    syncAddress(location);</span>
                }
            }
        }
<span class="nc bnc" id="L959" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11821)) {</span>
            // Set action bar title based on the selected issue
<span class="nc" id="L961">            setActionBarTitle(&quot;&quot;);</span>
        }
<span class="nc" id="L963">    }</span>

    @Override
    public void onFocusChanged(BikeRentalStation bikeRentalStation) {
<span class="nc" id="L967">    }</span>

    @Override
    public void onReportSent() {
<span class="nc bnc" id="L971" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11822)) {</span>
<span class="nc" id="L972">            (new ReportSuccessDialog()).show(getSupportFragmentManager(), ReportSuccessDialog.TAG);</span>
        }
<span class="nc" id="L974">    }</span>

    @Override
    public void onBackPressed() {
<span class="nc bnc" id="L978" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11823)) {</span>
<span class="nc" id="L979">            super.onBackPressed();</span>
        }
<span class="nc bnc" id="L981" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11824)) {</span>
            // If a fragment closes via back button, show 'Choose a Problem' category
<span class="nc" id="L983">            mServicesSpinner.setSelection(0);</span>
        }
<span class="nc" id="L985">    }</span>

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
<span class="nc bnc" id="L989" title="All 2 branches missed.">        switch(item.getItemId()) {</span>
            case android.R.id.home:
<span class="nc bnc" id="L991" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11825)) {</span>
<span class="nc" id="L992">                    finishActivityWithResult();</span>
                }
<span class="nc" id="L994">                return true;</span>
            default:
<span class="nc" id="L996">                return super.onOptionsItemSelected(item);</span>
        }
    }

    /**
     * Called by the ServicesTask when Open311 endpoint returns ServiceList
     *
     * @param services ServiceListResponse
     * @param open311  returns active open311
     */
    @Override
    public void onServicesTaskCompleted(ServiceListResponse services, Open311 open311) {
<span class="nc bnc" id="L1008" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11826)) {</span>
            // Close progress
<span class="nc" id="L1010">            showProgress(Boolean.FALSE);</span>
        }
<span class="nc bnc" id="L1012" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11827)) {</span>
            // Set main open311
<span class="nc" id="L1014">            this.mOpen311 = open311;</span>
        }
<span class="nc bnc" id="L1016" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11828)) {</span>
<span class="nc" id="L1017">            prepareServiceList(services);</span>
        }
<span class="nc" id="L1019">    }</span>

    /**
     * Called when geocoder converts the location to an address string
     *
     * @param address the address string from given location
     */
    @Override
    public void onGeocoderTaskCompleted(String address) {
<span class="nc bnc" id="L1028" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11829)) {</span>
<span class="nc" id="L1029">            mAddressEditText.setText(address);</span>
        }
<span class="nc" id="L1031">    }</span>

    /**
     * Prepares the service lists and shows as categories in the screen
     * Adds static service categories (stop and trip problems) if they are
     * not specified by open311 endpoint
     */
    private void prepareServiceList(ServiceListResponse services) {
        // Create the service list
<span class="nc" id="L1040">        List&lt;Service&gt; serviceList = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L1041" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11836)) {</span>
            // Add services to list if service response is successful
<span class="nc bnc" id="L1043" title="All 26 branches missed.">            if ((ListenerUtil.mutListener.listen(11831) ? ((ListenerUtil.mutListener.listen(11830) ? (services != null || services.isSuccess()) : (services != null &amp;&amp; services.isSuccess())) || Open311Manager.isAreaManagedByOpen311(services.getServiceList())) : ((ListenerUtil.mutListener.listen(11830) ? (services != null || services.isSuccess()) : (services != null &amp;&amp; services.isSuccess())) &amp;&amp; Open311Manager.isAreaManagedByOpen311(services.getServiceList())))) {</span>
<span class="nc bnc" id="L1044" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11835)) {</span>
                    {
<span class="nc" id="L1046">                        long _loopCounter162 = 0;</span>
<span class="nc bnc" id="L1047" title="All 2 branches missed.">                        for (Service s : services.getServiceList()) {</span>
<span class="nc" id="L1048">                            ListenerUtil.loopListener.listen(&quot;_loopCounter162&quot;, ++_loopCounter162);</span>
<span class="nc bnc" id="L1049" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11834)) {</span>
<span class="nc bnc" id="L1050" title="All 10 branches missed.">                                if ((ListenerUtil.mutListener.listen(11832) ? (s.getService_name() != null || s.getService_code() != null) : (s.getService_name() != null &amp;&amp; s.getService_code() != null))) {</span>
<span class="nc bnc" id="L1051" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11833)) {</span>
<span class="nc" id="L1052">                                        serviceList.add(s);</span>
                                    }
                                }
                            }
<span class="nc" id="L1056">                        }</span>
                    }
                }
            }
        }
<span class="nc bnc" id="L1061" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11844)) {</span>
<span class="nc bnc" id="L1062" title="All 2 branches missed.">            if (mShowStopMarker) {</span>
<span class="nc bnc" id="L1063" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11842)) {</span>
<span class="nc" id="L1064">                    mMapFragment.setFocusStop(mIssueLocationHelper.getObaStop(), new ArrayList&lt;ObaRoute&gt;());</span>
                }
<span class="nc bnc" id="L1066" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11843)) {</span>
<span class="nc" id="L1067">                    showServicesSpinner();</span>
                }
<span class="nc bnc" id="L1069" title="All 2 branches missed.">            } else if (Open311Manager.isAreaManagedByOpen311(serviceList)) {</span>
<span class="nc bnc" id="L1070" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11840)) {</span>
                    // Set marker on the map if there are open311 services
<span class="nc" id="L1072">                    updateMarkerPosition(mIssueLocationHelper.getIssueLocation());</span>
                }
<span class="nc bnc" id="L1074" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11841)) {</span>
<span class="nc" id="L1075">                    showServicesSpinner();</span>
                }
            } else {
<span class="nc bnc" id="L1078" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11839)) {</span>
                    // then hide the categories
<span class="nc bnc" id="L1080" title="All 2 branches missed.">                    if (mIssueLocationHelper.getObaStop() == null) {</span>
<span class="nc bnc" id="L1081" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11837)) {</span>
<span class="nc" id="L1082">                            hideServicesSpinner();</span>
                        }
<span class="nc bnc" id="L1084" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11838)) {</span>
                            // Show information to the user if there is no error on location
<span class="nc" id="L1086">                            addInfoText(getString(R.string.report_dialog_stop_header));</span>
                        }
                    }
                }
            }
        }
<span class="nc bnc" id="L1092" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11845)) {</span>
            // Mark the services that are transit-related
<span class="nc" id="L1094">            mIsAllTransitHeuristicMatch = ServiceUtils.markTransitServices(getApplicationContext(), serviceList);</span>
        }
        /**
         * Map the group names with service list
         */
<span class="nc" id="L1099">        Map&lt;String, List&lt;Service&gt;&gt; serviceListMap = new TreeMap&lt;&gt;();</span>
<span class="nc bnc" id="L1100" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11851)) {</span>
            {
<span class="nc" id="L1102">                long _loopCounter163 = 0;</span>
<span class="nc bnc" id="L1103" title="All 2 branches missed.">                for (Service s : serviceList) {</span>
<span class="nc" id="L1104">                    ListenerUtil.loopListener.listen(&quot;_loopCounter163&quot;, ++_loopCounter163);</span>
<span class="nc bnc" id="L1105" title="All 2 branches missed.">                    String groupName = s.getGroup() == null ? getString(R.string.ri_others) : s.getGroup();</span>
<span class="nc" id="L1106">                    List&lt;Service&gt; mappedList = serviceListMap.get(groupName);</span>
<span class="nc bnc" id="L1107" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11850)) {</span>
<span class="nc bnc" id="L1108" title="All 2 branches missed.">                        if (mappedList != null) {</span>
<span class="nc bnc" id="L1109" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11849)) {</span>
<span class="nc" id="L1110">                                mappedList.add(s);</span>
                            }
                        } else {
<span class="nc bnc" id="L1113" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11846)) {</span>
<span class="nc" id="L1114">                                mappedList = new ArrayList&lt;&gt;();</span>
                            }
<span class="nc bnc" id="L1116" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11847)) {</span>
<span class="nc" id="L1117">                                mappedList.add(s);</span>
                            }
<span class="nc bnc" id="L1119" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11848)) {</span>
<span class="nc" id="L1120">                                serviceListMap.put(groupName, mappedList);</span>
                            }
                        }
                    }
<span class="nc" id="L1124">                }</span>
            }
        }
        /**
         * Create Ordered Spinner items
         */
<span class="nc" id="L1130">        ArrayList&lt;SpinnerItem&gt; spinnerItems = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L1131">        ServiceSpinnerItem hintServiceSpinnerItem = new ServiceSpinnerItem(new Service(getString(R.string.ri_service_default), ReportConstants.DEFAULT_SERVICE));</span>
<span class="nc bnc" id="L1132" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11852)) {</span>
<span class="nc" id="L1133">            hintServiceSpinnerItem.setHint(true);</span>
        }
<span class="nc bnc" id="L1135" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11853)) {</span>
<span class="nc" id="L1136">            spinnerItems.add(hintServiceSpinnerItem);</span>
        }
<span class="nc bnc" id="L1138" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11857)) {</span>
            // Create Transit categories first
<span class="nc bnc" id="L1140" title="All 2 branches missed.">            if (serviceListMap.get(ReportConstants.ISSUE_GROUP_TRANSIT) != null) {</span>
<span class="nc bnc" id="L1141" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11854)) {</span>
<span class="nc" id="L1142">                    spinnerItems.add(new SectionItem(ReportConstants.ISSUE_GROUP_TRANSIT));</span>
                }
<span class="nc bnc" id="L1144" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11856)) {</span>
                    {
<span class="nc" id="L1146">                        long _loopCounter164 = 0;</span>
<span class="nc bnc" id="L1147" title="All 2 branches missed.">                        for (Service s : serviceListMap.get(ReportConstants.ISSUE_GROUP_TRANSIT)) {</span>
<span class="nc" id="L1148">                            ListenerUtil.loopListener.listen(&quot;_loopCounter164&quot;, ++_loopCounter164);</span>
<span class="nc bnc" id="L1149" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11855)) {</span>
<span class="nc" id="L1150">                                spinnerItems.add(new ServiceSpinnerItem(s));</span>
                            }
<span class="nc" id="L1152">                        }</span>
                    }
                }
            }
        }
<span class="nc bnc" id="L1157" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11862)) {</span>
            {
<span class="nc" id="L1159">                long _loopCounter166 = 0;</span>
                // Create the rest of the categories
<span class="nc bnc" id="L1161" title="All 2 branches missed.">                for (String key : serviceListMap.keySet()) {</span>
<span class="nc" id="L1162">                    ListenerUtil.loopListener.listen(&quot;_loopCounter166&quot;, ++_loopCounter166);</span>
<span class="nc bnc" id="L1163" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11858)) {</span>
                        // Skip if it is transit category
<span class="nc bnc" id="L1165" title="All 2 branches missed.">                        if (ReportConstants.ISSUE_GROUP_TRANSIT.equals(key)) {</span>
<span class="nc" id="L1166">                            continue;</span>
                        }
                    }
<span class="nc bnc" id="L1169" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11859)) {</span>
<span class="nc" id="L1170">                        spinnerItems.add(new SectionItem(key));</span>
                    }
<span class="nc bnc" id="L1172" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11861)) {</span>
                        {
<span class="nc" id="L1174">                            long _loopCounter165 = 0;</span>
<span class="nc bnc" id="L1175" title="All 2 branches missed.">                            for (Service s : serviceListMap.get(key)) {</span>
<span class="nc" id="L1176">                                ListenerUtil.loopListener.listen(&quot;_loopCounter165&quot;, ++_loopCounter165);</span>
<span class="nc bnc" id="L1177" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11860)) {</span>
<span class="nc" id="L1178">                                    spinnerItems.add(new ServiceSpinnerItem(s));</span>
                                }
<span class="nc" id="L1180">                            }</span>
                        }
                    }
<span class="nc" id="L1183">                }</span>
            }
        }
<span class="nc" id="L1186">        EntrySpinnerAdapter adapter = new EntrySpinnerAdapter(this, spinnerItems);</span>
<span class="nc bnc" id="L1187" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11863)) {</span>
<span class="nc" id="L1188">            mServicesSpinner.setAdapter(adapter);</span>
        }
<span class="nc bnc" id="L1190" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11866)) {</span>
<span class="nc bnc" id="L1191" title="All 2 branches missed.">            if (mDefaultIssueType != null) {</span>
<span class="nc bnc" id="L1192" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11865)) {</span>
                    // Select an default issue category programmatically
<span class="nc" id="L1194">                    selectDefaultTransitCategory(spinnerItems);</span>
                }
<span class="nc bnc" id="L1196" title="All 2 branches missed.">            } else if (mRestoredServiceName != null) {</span>
<span class="nc bnc" id="L1197" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11864)) {</span>
<span class="nc" id="L1198">                    restoreSelection(spinnerItems);</span>
                }
            }
        }
<span class="nc" id="L1202">    }</span>

    /**
     * Programmatically select a issue category on rotation
     *
     * @param spinnerItems the issue services loaded into the services spinner
     */
    private void restoreSelection(ArrayList&lt;SpinnerItem&gt; spinnerItems) {
<span class="nc bnc" id="L1210" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11878)) {</span>
            {
<span class="nc" id="L1212">                long _loopCounter167 = 0;</span>
<span class="nc bnc" id="L1213" title="All 22 branches missed.">                for (int i = 0; (ListenerUtil.mutListener.listen(11877) ? (i &gt;= spinnerItems.size()) : (ListenerUtil.mutListener.listen(11876) ? (i &lt;= spinnerItems.size()) : (ListenerUtil.mutListener.listen(11875) ? (i &gt; spinnerItems.size()) : (ListenerUtil.mutListener.listen(11874) ? (i != spinnerItems.size()) : (ListenerUtil.mutListener.listen(11873) ? (i == spinnerItems.size()) : (i &lt; spinnerItems.size())))))); i++) {</span>
<span class="nc" id="L1214">                    ListenerUtil.loopListener.listen(&quot;_loopCounter167&quot;, ++_loopCounter167);</span>
<span class="nc" id="L1215">                    SpinnerItem item = spinnerItems.get(i);</span>
<span class="nc bnc" id="L1216" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11872)) {</span>
<span class="nc bnc" id="L1217" title="All 2 branches missed.">                        if (item instanceof ServiceSpinnerItem) {</span>
<span class="nc" id="L1218">                            Service service = ((ServiceSpinnerItem) item).getService();</span>
<span class="nc bnc" id="L1219" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11871)) {</span>
<span class="nc bnc" id="L1220" title="All 2 branches missed.">                                if (service.getService_name().equals(mRestoredServiceName)) {</span>
<span class="nc bnc" id="L1221" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11867)) {</span>
<span class="nc" id="L1222">                                        mServicesSpinner.setSelection(i, true);</span>
                                    }
<span class="nc bnc" id="L1224" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11868)) {</span>
<span class="nc" id="L1225">                                        mRestoredServiceName = null;</span>
                                    }
<span class="nc bnc" id="L1227" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11870)) {</span>
<span class="nc bnc" id="L1228" title="All 2 branches missed.">                                        if (ServiceUtils.isTransitServiceByType(service.getType())) {</span>
<span class="nc bnc" id="L1229" title="All 2 branches missed.">                                            if (!ListenerUtil.mutListener.listen(11869)) {</span>
<span class="nc" id="L1230">                                                mSelectedTransitService = service;</span>
                                            }
                                        }
                                    }
                                    break;
                                }
                            }
                        }
                    }
                }
            }
        }
<span class="nc" id="L1242">    }</span>

    /**
     * Programmatically select a default issue category from the spinner
     *
     * @param spinnerItems the issue services loaded into the services spinner
     */
    private void selectDefaultTransitCategory(ArrayList&lt;SpinnerItem&gt; spinnerItems) {
<span class="nc" id="L1250">        int selectPosition = -1;</span>
<span class="nc" id="L1251">        Service selectedService = null;</span>
<span class="nc bnc" id="L1252" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11897)) {</span>
            {
<span class="nc" id="L1254">                long _loopCounter168 = 0;</span>
<span class="nc bnc" id="L1255" title="All 22 branches missed.">                for (int i = 0; (ListenerUtil.mutListener.listen(11896) ? (i &gt;= spinnerItems.size()) : (ListenerUtil.mutListener.listen(11895) ? (i &lt;= spinnerItems.size()) : (ListenerUtil.mutListener.listen(11894) ? (i &gt; spinnerItems.size()) : (ListenerUtil.mutListener.listen(11893) ? (i != spinnerItems.size()) : (ListenerUtil.mutListener.listen(11892) ? (i == spinnerItems.size()) : (i &lt; spinnerItems.size())))))); i++) {</span>
<span class="nc" id="L1256">                    ListenerUtil.loopListener.listen(&quot;_loopCounter168&quot;, ++_loopCounter168);</span>
<span class="nc" id="L1257">                    SpinnerItem item = spinnerItems.get(i);</span>
<span class="nc bnc" id="L1258" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11891)) {</span>
<span class="nc bnc" id="L1259" title="All 2 branches missed.">                        if (item instanceof ServiceSpinnerItem) {</span>
<span class="nc" id="L1260">                            Service service = ((ServiceSpinnerItem) item).getService();</span>
<span class="nc" id="L1261">                            boolean transitServiceFound = false;</span>
<span class="nc bnc" id="L1262" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11884)) {</span>
<span class="nc bnc" id="L1263" title="All 26 branches missed.">                                if ((ListenerUtil.mutListener.listen(11880) ? ((ListenerUtil.mutListener.listen(11879) ? (getString(R.string.ri_selected_service_stop).equals(mDefaultIssueType) || ServiceUtils.isTransitStopServiceByType(service.getType())) : (getString(R.string.ri_selected_service_stop).equals(mDefaultIssueType) &amp;&amp; ServiceUtils.isTransitStopServiceByType(service.getType()))) || !mIsAllTransitHeuristicMatch) : ((ListenerUtil.mutListener.listen(11879) ? (getString(R.string.ri_selected_service_stop).equals(mDefaultIssueType) || ServiceUtils.isTransitStopServiceByType(service.getType())) : (getString(R.string.ri_selected_service_stop).equals(mDefaultIssueType) &amp;&amp; ServiceUtils.isTransitStopServiceByType(service.getType()))) &amp;&amp; !mIsAllTransitHeuristicMatch))) {</span>
<span class="nc bnc" id="L1264" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11883)) {</span>
                                        // We have an explicit (not heuristic-based) match for stop problem
<span class="nc" id="L1266">                                        transitServiceFound = true;</span>
                                    }
<span class="nc bnc" id="L1268" title="All 10 branches missed.">                                } else if ((ListenerUtil.mutListener.listen(11881) ? (getString(R.string.ri_selected_service_trip).equals(mDefaultIssueType) || ServiceUtils.isTransitTripServiceByType(service.getType())) : (getString(R.string.ri_selected_service_trip).equals(mDefaultIssueType) &amp;&amp; ServiceUtils.isTransitTripServiceByType(service.getType())))) {</span>
<span class="nc bnc" id="L1269" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11882)) {</span>
<span class="nc" id="L1270">                                        transitServiceFound = true;</span>
                                    }
                                }
                            }
<span class="nc bnc" id="L1274" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11890)) {</span>
<span class="nc bnc" id="L1275" title="All 2 branches missed.">                                if (transitServiceFound) {</span>
<span class="nc bnc" id="L1276" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11885)) {</span>
<span class="nc" id="L1277">                                        selectPosition = i;</span>
                                    }
<span class="nc bnc" id="L1279" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11886)) {</span>
<span class="nc" id="L1280">                                        selectedService = service;</span>
                                    }
<span class="nc bnc" id="L1282" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11889)) {</span>
                                        // If transit service selected and no bus stop selected remove markers
<span class="nc bnc" id="L1284" title="All 10 branches missed.">                                        if ((ListenerUtil.mutListener.listen(11887) ? (ServiceUtils.isTransitServiceByType(service.getType()) || mIssueLocationHelper.getObaStop() == null) : (ServiceUtils.isTransitServiceByType(service.getType()) &amp;&amp; mIssueLocationHelper.getObaStop() == null))) {</span>
<span class="nc bnc" id="L1285" title="All 2 branches missed.">                                            if (!ListenerUtil.mutListener.listen(11888)) {</span>
<span class="nc" id="L1286">                                                mIssueLocationHelper.clearMarkers();</span>
                                            }
                                        }
                                    }
                                    break;
                                }
                            }
                        }
                    }
                }
            }
        }
<span class="nc bnc" id="L1298" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11901)) {</span>
            // If is a stop problem type, an all transit heuristic-based match, and no bus stop selected remove markers
<span class="nc bnc" id="L1300" title="All 26 branches missed.">            if ((ListenerUtil.mutListener.listen(11899) ? ((ListenerUtil.mutListener.listen(11898) ? (getString(R.string.ri_selected_service_stop).equals(mDefaultIssueType) || mIsAllTransitHeuristicMatch) : (getString(R.string.ri_selected_service_stop).equals(mDefaultIssueType) &amp;&amp; mIsAllTransitHeuristicMatch)) || mIssueLocationHelper.getObaStop() == null) : ((ListenerUtil.mutListener.listen(11898) ? (getString(R.string.ri_selected_service_stop).equals(mDefaultIssueType) || mIsAllTransitHeuristicMatch) : (getString(R.string.ri_selected_service_stop).equals(mDefaultIssueType) &amp;&amp; mIsAllTransitHeuristicMatch)) &amp;&amp; mIssueLocationHelper.getObaStop() == null))) {</span>
<span class="nc bnc" id="L1301" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11900)) {</span>
<span class="nc" id="L1302">                    mIssueLocationHelper.clearMarkers();</span>
                }
            }
        }
<span class="nc bnc" id="L1306" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11902)) {</span>
            // Set mDefaultIssueType = null to prevent auto selections
<span class="nc" id="L1308">            mDefaultIssueType = null;</span>
        }
        // Give the user a break from tutorials - allow at least one interaction without a tutorial
<span class="nc" id="L1311">        int counter = Application.getPrefs().getInt(TUTORIAL_COUNTER, 0);</span>
<span class="nc bnc" id="L1312" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11903)) {</span>
<span class="nc" id="L1313">            counter++;</span>
        }
<span class="nc bnc" id="L1315" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11904)) {</span>
<span class="nc" id="L1316">            PreferenceUtils.saveInt(TUTORIAL_COUNTER, counter);</span>
        }
<span class="nc bnc" id="L1318" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11925)) {</span>
            // Set selected category if it is in the spinner items list
<span class="nc bnc" id="L1320" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(11909) ? (selectPosition &gt;= -1) : (ListenerUtil.mutListener.listen(11908) ? (selectPosition &lt;= -1) : (ListenerUtil.mutListener.listen(11907) ? (selectPosition &gt; -1) : (ListenerUtil.mutListener.listen(11906) ? (selectPosition &lt; -1) : (ListenerUtil.mutListener.listen(11905) ? (selectPosition == -1) : (selectPosition != -1))))))) {</span>
<span class="nc bnc" id="L1321" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11910)) {</span>
<span class="nc" id="L1322">                    showServicesSpinner();</span>
                }
<span class="nc bnc" id="L1324" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11911)) {</span>
<span class="nc" id="L1325">                    mServicesSpinner.setSelection(selectPosition, true);</span>
                }
<span class="nc bnc" id="L1327" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11924)) {</span>
                    // Show tutorial if this geographic area supports Open311 services
<span class="nc bnc" id="L1329" title="All 298 branches missed.">                    if ((ListenerUtil.mutListener.listen(11922) ? ((ListenerUtil.mutListener.listen(11921) ? ((ListenerUtil.mutListener.listen(11920) ? ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) &gt;= 0) : (ListenerUtil.mutListener.listen(11919) ? ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) &lt;= 0) : (ListenerUtil.mutListener.listen(11918) ? ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) &gt; 0) : (ListenerUtil.mutListener.listen(11917) ? ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) &lt; 0) : (ListenerUtil.mutListener.listen(11916) ? ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) != 0) : ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) == 0)))))) || selectedService != null) : ((ListenerUtil.mutListener.listen(11920) ? ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) &gt;= 0) : (ListenerUtil.mutListener.listen(11919) ? ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) &lt;= 0) : (ListenerUtil.mutListener.listen(11918) ? ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) &gt; 0) : (ListenerUtil.mutListener.listen(11917) ? ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) &lt; 0) : (ListenerUtil.mutListener.listen(11916) ? ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) != 0) : ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) == 0)))))) &amp;&amp; selectedService != null)) || ServiceUtils.isTransitOpen311ServiceByType(selectedService.getType())) : ((ListenerUtil.mutListener.listen(11921) ? ((ListenerUtil.mutListener.listen(11920) ? ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) &gt;= 0) : (ListenerUtil.mutListener.listen(11919) ? ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) &lt;= 0) : (ListenerUtil.mutListener.listen(11918) ? ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) &gt; 0) : (ListenerUtil.mutListener.listen(11917) ? ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) &lt; 0) : (ListenerUtil.mutListener.listen(11916) ? ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) != 0) : ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) == 0)))))) || selectedService != null) : ((ListenerUtil.mutListener.listen(11920) ? ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) &gt;= 0) : (ListenerUtil.mutListener.listen(11919) ? ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) &lt;= 0) : (ListenerUtil.mutListener.listen(11918) ? ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) &gt; 0) : (ListenerUtil.mutListener.listen(11917) ? ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) &lt; 0) : (ListenerUtil.mutListener.listen(11916) ? ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) != 0) : ((ListenerUtil.mutListener.listen(11915) ? (counter / 2) : (ListenerUtil.mutListener.listen(11914) ? (counter * 2) : (ListenerUtil.mutListener.listen(11913) ? (counter - 2) : (ListenerUtil.mutListener.listen(11912) ? (counter + 2) : (counter % 2))))) == 0)))))) &amp;&amp; selectedService != null)) &amp;&amp; ServiceUtils.isTransitOpen311ServiceByType(selectedService.getType())))) {</span>
<span class="nc bnc" id="L1330" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11923)) {</span>
<span class="nc" id="L1331">                            ShowcaseViewUtils.showTutorial(ShowcaseViewUtils.TUTORIAL_SEND_FEEDBACK_OPEN311_CATEGORIES, this, null, false);</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L1337">    }</span>

    private void hideServicesSpinner() {
<span class="nc bnc" id="L1340" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11926)) {</span>
<span class="nc" id="L1341">            mServicesSpinnerFrameLayout.setVisibility(View.GONE);</span>
        }
<span class="nc" id="L1343">    }</span>

    private void showServicesSpinner() {
<span class="nc bnc" id="L1346" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11927)) {</span>
<span class="nc" id="L1347">            mServicesSpinnerFrameLayout.setVisibility(View.VISIBLE);</span>
        }
<span class="nc" id="L1349">    }</span>

    /**
     * Disables open311 reporting if there is no category for region
     * Show static services
     */
    public void showTransitService(String issueType) {
<span class="nc bnc" id="L1356" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11928)) {</span>
<span class="nc" id="L1357">            clearReportingFragments();</span>
        }
<span class="nc" id="L1359">        ObaStop obaStop = mIssueLocationHelper.getObaStop();</span>
<span class="nc bnc" id="L1360" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11940)) {</span>
<span class="nc bnc" id="L1361" title="All 2 branches missed.">            if (obaStop != null) {</span>
<span class="nc bnc" id="L1362" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11939)) {</span>
<span class="nc bnc" id="L1363" title="All 2 branches missed.">                    if (ReportConstants.STATIC_TRANSIT_SERVICE_STOP.equals(issueType)) {</span>
<span class="nc bnc" id="L1364" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11938)) {</span>
<span class="nc" id="L1365">                            showStopProblemFragment(obaStop);</span>
                        }
<span class="nc bnc" id="L1367" title="All 2 branches missed.">                    } else if (ReportConstants.STATIC_TRANSIT_SERVICE_TRIP.equals(issueType)) {</span>
<span class="nc bnc" id="L1368" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11937)) {</span>
<span class="nc" id="L1369">                            showTripProblemFragment(obaStop);</span>
                        }
<span class="nc bnc" id="L1371" title="All 2 branches missed.">                    } else if (ReportConstants.DYNAMIC_TRANSIT_SERVICE_STOP.equals(issueType)) {</span>
<span class="nc bnc" id="L1372" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11936)) {</span>
<span class="nc" id="L1373">                            showOpen311Reporting(mSelectedTransitService);</span>
                        }
<span class="nc bnc" id="L1375" title="All 2 branches missed.">                    } else if (ReportConstants.DYNAMIC_TRANSIT_SERVICE_TRIP.equals(issueType)) {</span>
<span class="nc bnc" id="L1376" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11935)) {</span>
<span class="nc bnc" id="L1377" title="All 2 branches missed.">                            if (mArrivalInfo != null) {</span>
<span class="nc bnc" id="L1378" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11933)) {</span>
<span class="nc" id="L1379">                                    showOpen311Reporting(mSelectedTransitService, mArrivalInfo);</span>
                                }
<span class="nc bnc" id="L1381" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11934)) {</span>
<span class="nc" id="L1382">                                    mArrivalInfo = null;</span>
                                }
                            } else {
<span class="nc bnc" id="L1385" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11932)) {</span>
<span class="nc" id="L1386">                                    showTripProblemFragment(obaStop);</span>
                                }
                            }
                        }
                    }
                }
            } else {
<span class="nc bnc" id="L1393" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11929)) {</span>
<span class="nc" id="L1394">                    addInfoText(getString(R.string.report_dialog_stop_header));</span>
                }
<span class="nc bnc" id="L1396" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11930)) {</span>
<span class="nc" id="L1397">                    mTransitServiceIssueTypeWithoutStop = issueType;</span>
                }
<span class="nc bnc" id="L1399" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11931)) {</span>
<span class="nc" id="L1400">                    mIssueLocationHelper.clearMarkers();</span>
                }
            }
        }
<span class="nc" id="L1404">    }</span>

    private void showOpen311Reporting(Service service) {
<span class="nc bnc" id="L1407" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11941)) {</span>
<span class="nc" id="L1408">            clearReportingFragments();</span>
        }
<span class="nc bnc" id="L1410" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11942)) {</span>
<span class="nc" id="L1411">            showOpen311ProblemFragment(service);</span>
        }
<span class="nc bnc" id="L1413" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11943)) {</span>
<span class="nc" id="L1414">            updateMarkerPosition(mIssueLocationHelper.getIssueLocation());</span>
        }
<span class="nc" id="L1416">    }</span>

    private void showOpen311Reporting(Service service, ObaArrivalInfo obaArrivalInfo) {
<span class="nc bnc" id="L1419" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11944)) {</span>
<span class="nc" id="L1420">            clearReportingFragments();</span>
        }
<span class="nc bnc" id="L1422" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11945)) {</span>
<span class="nc" id="L1423">            showOpen311ProblemFragment(service, obaArrivalInfo);</span>
        }
<span class="nc bnc" id="L1425" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11946)) {</span>
<span class="nc" id="L1426">            updateMarkerPosition(mIssueLocationHelper.getIssueLocation());</span>
        }
<span class="nc" id="L1428">    }</span>

    private void clearReportingFragments() {
<span class="nc bnc" id="L1431" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11947)) {</span>
<span class="nc" id="L1432">            clearReportingFragments(true);</span>
        }
<span class="nc" id="L1434">    }</span>

    private void clearReportingFragments(boolean removeInfo) {
<span class="nc bnc" id="L1437" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11949)) {</span>
<span class="nc bnc" id="L1438" title="All 2 branches missed.">            if (removeInfo) {</span>
<span class="nc bnc" id="L1439" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11948)) {</span>
<span class="nc" id="L1440">                    removeInfoText();</span>
                }
            }
        }
<span class="nc bnc" id="L1444" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11950)) {</span>
<span class="nc" id="L1445">            removeOpen311ProblemFragment();</span>
        }
<span class="nc bnc" id="L1447" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11951)) {</span>
<span class="nc" id="L1448">            removeStopProblemFragment();</span>
        }
<span class="nc bnc" id="L1450" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11952)) {</span>
<span class="nc" id="L1451">            removeTripProblemFragment();</span>
        }
<span class="nc" id="L1453">    }</span>

    private void showStopProblemFragment(ObaStop obaStop) {
<span class="nc bnc" id="L1456" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11953)) {</span>
<span class="nc" id="L1457">            ReportStopProblemFragment.show(this, obaStop, R.id.ri_report_stop_problem);</span>
        }
<span class="nc" id="L1459">    }</span>

    private void showTripProblemFragment(ObaStop obaStop) {
<span class="nc bnc" id="L1462" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11957)) {</span>
<span class="nc bnc" id="L1463" title="All 2 branches missed.">            if (mArrivalInfo == null) {</span>
<span class="nc bnc" id="L1464" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11956)) {</span>
<span class="nc" id="L1465">                    showArrivalListFragment(obaStop);</span>
                }
            } else {
<span class="nc bnc" id="L1468" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11954)) {</span>
                    // Show default trip problem issue reporting
<span class="nc" id="L1470">                    ReportTripProblemFragment.show(this, mArrivalInfo, R.id.ri_report_stop_problem);</span>
                }
<span class="nc bnc" id="L1472" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11955)) {</span>
<span class="nc" id="L1473">                    mArrivalInfo = null;</span>
                }
            }
        }
<span class="nc" id="L1477">    }</span>

    private void showArrivalListFragment(ObaStop obaStop) {
<span class="nc" id="L1480">        LayoutInflater layoutInflater = LayoutInflater.from(this);</span>
<span class="nc" id="L1481">        View v = layoutInflater.inflate(R.layout.arrivals_list_header, null);</span>
<span class="nc bnc" id="L1482" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11958)) {</span>
<span class="nc" id="L1483">            v.setVisibility(View.GONE);</span>
        }
<span class="nc bnc" id="L1485" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11959)) {</span>
<span class="nc" id="L1486">            mShowArrivalListFragment = true;</span>
        }
<span class="nc bnc" id="L1488" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11960)) {</span>
<span class="nc" id="L1489">            SimpleArrivalListFragment.show(this, R.id.ri_report_stop_problem, obaStop, this);</span>
        }
<span class="nc" id="L1491">    }</span>

    @Override
    public void onArrivalItemClicked(ObaArrivalInfo obaArrivalInfo, String agencyName, String blockId) {
<span class="nc bnc" id="L1495" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11961)) {</span>
<span class="nc" id="L1496">            mShowArrivalListFragment = false;</span>
        }
<span class="nc bnc" id="L1498" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11962)) {</span>
<span class="nc" id="L1499">            mAgencyName = agencyName;</span>
        }
<span class="nc bnc" id="L1501" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11963)) {</span>
<span class="nc" id="L1502">            mBlockId = blockId;</span>
        }
<span class="nc bnc" id="L1504" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11964)) {</span>
<span class="nc" id="L1505">            removeFragmentByTag(SimpleArrivalListFragment.TAG);</span>
        }
<span class="nc bnc" id="L1507" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11968)) {</span>
<span class="nc bnc" id="L1508" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(11965) ? (mSelectedTransitService != null || ReportConstants.DYNAMIC_TRANSIT_SERVICE_TRIP.equals(mSelectedTransitService.getType())) : (mSelectedTransitService != null &amp;&amp; ReportConstants.DYNAMIC_TRANSIT_SERVICE_TRIP.equals(mSelectedTransitService.getType())))) {</span>
<span class="nc bnc" id="L1509" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11967)) {</span>
                    // Show open311 defined issue reporting service
<span class="nc" id="L1511">                    showOpen311ProblemFragment(mSelectedTransitService, obaArrivalInfo);</span>
                }
            } else {
<span class="nc bnc" id="L1514" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11966)) {</span>
                    // Show default trip problem issue reporting
<span class="nc" id="L1516">                    ReportTripProblemFragment.show(this, obaArrivalInfo, R.id.ri_report_stop_problem);</span>
                }
            }
        }
<span class="nc" id="L1520">    }</span>

    private void showBusStopHeader(String text) {
<span class="nc bnc" id="L1523" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11969)) {</span>
            // First remove info text
<span class="nc" id="L1525">            removeInfoText();</span>
        }
<span class="nc bnc" id="L1527" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11970)) {</span>
<span class="nc" id="L1528">            ((TextView) findViewById(R.id.ri_bus_stop_text)).setText(text);</span>
        }
<span class="nc bnc" id="L1530" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11972)) {</span>
<span class="nc bnc" id="L1531" title="All 2 branches missed.">            if (mBusStopHeader.getVisibility() != View.VISIBLE) {</span>
<span class="nc bnc" id="L1532" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11971)) {</span>
<span class="nc" id="L1533">                    mBusStopHeader.setVisibility(View.VISIBLE);</span>
                }
            }
        }
<span class="nc" id="L1537">    }</span>

    public void hideBusStopHeader() {
<span class="nc bnc" id="L1540" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11973)) {</span>
<span class="nc" id="L1541">            findViewById(R.id.bus_stop_header).setVisibility(View.GONE);</span>
        }
<span class="nc" id="L1543">    }</span>

    private void showOpen311ProblemFragment(Service service) {
<span class="nc bnc" id="L1546" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11974)) {</span>
<span class="nc" id="L1547">            Open311ProblemFragment.show(this, R.id.ri_report_stop_problem, mOpen311, service);</span>
        }
<span class="nc" id="L1549">    }</span>

    private void showOpen311ProblemFragment(Service service, ObaArrivalInfo obaArrivalInfo) {
<span class="nc bnc" id="L1552" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11975)) {</span>
<span class="nc" id="L1553">            Open311ProblemFragment.show(this, R.id.ri_report_stop_problem, mOpen311, service, obaArrivalInfo, mAgencyName, mBlockId);</span>
        }
<span class="nc" id="L1555">    }</span>

    public void removeOpen311ProblemFragment() {
<span class="nc bnc" id="L1558" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11976)) {</span>
<span class="nc" id="L1559">            removeFragmentByTag(Open311ProblemFragment.TAG);</span>
        }
<span class="nc" id="L1561">    }</span>

    private void removeStopProblemFragment() {
<span class="nc bnc" id="L1564" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11977)) {</span>
<span class="nc" id="L1565">            removeFragmentByTag(ReportStopProblemFragment.TAG);</span>
        }
<span class="nc" id="L1567">    }</span>

    private void removeTripProblemFragment() {
<span class="nc bnc" id="L1570" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11978)) {</span>
<span class="nc" id="L1571">            mShowArrivalListFragment = false;</span>
        }
<span class="nc bnc" id="L1573" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11979)) {</span>
<span class="nc" id="L1574">            removeFragmentByTag(ReportTripProblemFragment.TAG);</span>
        }
<span class="nc bnc" id="L1576" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11980)) {</span>
<span class="nc" id="L1577">            removeFragmentByTag(SimpleArrivalListFragment.TAG);</span>
        }
<span class="nc bnc" id="L1579" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11981)) {</span>
<span class="nc" id="L1580">            ((LinearLayout) findViewById(R.id.ri_report_stop_problem)).removeAllViews();</span>
        }
<span class="nc" id="L1582">    }</span>

    public IssueLocationHelper getIssueLocationHelper() {
<span class="nc" id="L1585">        return mIssueLocationHelper;</span>
    }

    public String getCurrentAddress() {
<span class="nc" id="L1589">        return mAddressEditText.getText().toString();</span>
    }

    public void finishActivityWithResult() {
<span class="nc" id="L1593">        Intent returnIntent = new Intent();</span>
<span class="nc bnc" id="L1594" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11982)) {</span>
<span class="nc" id="L1595">            returnIntent.putExtra(BaseReportActivity.CLOSE_REQUEST, true);</span>
        }
<span class="nc bnc" id="L1597" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11983)) {</span>
<span class="nc" id="L1598">            setResult(RESULT_OK, returnIntent);</span>
        }
<span class="nc bnc" id="L1600" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11984)) {</span>
<span class="nc" id="L1601">            finish();</span>
        }
<span class="nc" id="L1603">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span>Generated by the Android Gradle plugin 8.2.0</div></body></html>