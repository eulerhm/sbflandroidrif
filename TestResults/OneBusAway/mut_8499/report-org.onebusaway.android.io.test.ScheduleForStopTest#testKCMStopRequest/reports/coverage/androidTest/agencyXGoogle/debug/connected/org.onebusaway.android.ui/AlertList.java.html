<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AlertList.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">agencyXGoogleDebug</a> &gt; <a href="index.source.html" class="el_package">org.onebusaway.android.ui</a> &gt; <span class="el_source">AlertList.java</span></div><h1>AlertList.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2012 Paul Watts (paulcwatts@gmail.com)
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.onebusaway.android.ui;

import org.onebusaway.android.R;
import org.onebusaway.android.app.Application;
import org.onebusaway.android.util.ArrayAdapter;
import org.onebusaway.android.util.UIUtils;
import android.content.Context;
import android.content.res.Resources;
import android.graphics.drawable.Drawable;
import android.os.Build;
import android.text.style.ClickableSpan;
import android.view.View;
import android.widget.ListView;
import android.widget.TextView;
import java.util.Collection;
import androidx.core.content.ContextCompat;
import androidx.core.graphics.drawable.DrawableCompat;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

class AlertList {

    interface Alert {

        public static final int TYPE_ERROR = 1;

        public static final int TYPE_WARNING = 2;

        public static final int TYPE_INFO = 3;

        public static final int TYPE_SHOW_HIDDEN_ALERTS = 4;

        // and you can see more..
        public static final int FLAG_HASMORE = 0x1;

        String getId();

        int getType();

        int getFlags();

        CharSequence getString();

        void onClick();
    }

    // 
    private static class Adapter extends ArrayAdapter&lt;Alert&gt; {

        public Adapter(Context context) {
<span class="nc" id="L65">            super(context, R.layout.alert_item);</span>
<span class="nc" id="L66">        }</span>

        /**
         * Initialize the views - if the alert is a service alert that should be shown, populate
         * that text.  If its a response error (i.e., couldn't update from server), show that.
         * If it's an alert showing that some alerts are filtered, show that.
         */
        @Override
        protected void initView(View view, final Alert alert) {
<span class="nc" id="L75">            TextView alertView = (TextView) view.findViewById(android.R.id.text1);</span>
<span class="nc" id="L76">            View filterGroupView = view.findViewById(R.id.filter_alert_group);</span>
<span class="nc" id="L77">            TextView filterTextView = (TextView) view.findViewById(R.id.filter_alert_text);</span>
<span class="nc" id="L78">            TextView showAllView = (TextView) view.findViewById(R.id.show_all_alerts);</span>
<span class="nc bnc" id="L79" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(4704)) {</span>
<span class="nc" id="L80">                alertView.setText(alert.getString());</span>
            }
<span class="nc bnc" id="L82" title="All 22 branches missed.">            boolean clickable = (ListenerUtil.mutListener.listen(4709) ? ((alert.getFlags() &amp; Alert.FLAG_HASMORE) &gt;= Alert.FLAG_HASMORE) : (ListenerUtil.mutListener.listen(4708) ? ((alert.getFlags() &amp; Alert.FLAG_HASMORE) &lt;= Alert.FLAG_HASMORE) : (ListenerUtil.mutListener.listen(4707) ? ((alert.getFlags() &amp; Alert.FLAG_HASMORE) &gt; Alert.FLAG_HASMORE) : (ListenerUtil.mutListener.listen(4706) ? ((alert.getFlags() &amp; Alert.FLAG_HASMORE) &lt; Alert.FLAG_HASMORE) : (ListenerUtil.mutListener.listen(4705) ? ((alert.getFlags() &amp; Alert.FLAG_HASMORE) != Alert.FLAG_HASMORE) : ((alert.getFlags() &amp; Alert.FLAG_HASMORE) == Alert.FLAG_HASMORE))))));</span>
<span class="nc" id="L83">            int type = alert.getType();</span>
<span class="nc" id="L84">            Resources r = Application.get().getResources();</span>
<span class="nc" id="L85">            int bg = R.color.alert_text_background_info;</span>
<span class="nc" id="L86">            int arrowColor = R.color.alert_text_color_info;</span>
<span class="nc" id="L87">            int alertColor = R.color.alert_icon_info;</span>
<span class="nc" id="L88">            int resourceIdAlert = 0;</span>
<span class="nc bnc" id="L89" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(4729)) {</span>
<span class="nc bnc" id="L90" title="All 4 branches missed.">                switch(type) {</span>
                    case Alert.TYPE_ERROR:
<span class="nc bnc" id="L92" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4710)) {</span>
<span class="nc" id="L93">                            bg = R.color.alert_text_background_error;</span>
                        }
<span class="nc bnc" id="L95" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4711)) {</span>
<span class="nc" id="L96">                            arrowColor = R.color.alert_text_color_error;</span>
                        }
<span class="nc bnc" id="L98" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4712)) {</span>
<span class="nc" id="L99">                            resourceIdAlert = R.drawable.ic_alert_warning;</span>
                        }
<span class="nc bnc" id="L101" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4713)) {</span>
<span class="nc" id="L102">                            alertColor = R.color.alert_icon_error;</span>
                        }
<span class="nc bnc" id="L104" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4714)) {</span>
<span class="nc" id="L105">                            alertView.setVisibility(View.VISIBLE);</span>
                        }
<span class="nc bnc" id="L107" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4715)) {</span>
<span class="nc" id="L108">                            filterGroupView.setVisibility(View.GONE);</span>
                        }
                        break;
                    case Alert.TYPE_WARNING:
<span class="nc bnc" id="L112" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4716)) {</span>
<span class="nc" id="L113">                            bg = R.color.alert_text_background_warning;</span>
                        }
<span class="nc bnc" id="L115" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4717)) {</span>
<span class="nc" id="L116">                            arrowColor = R.color.alert_text_color_warning;</span>
                        }
<span class="nc bnc" id="L118" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4718)) {</span>
<span class="nc" id="L119">                            resourceIdAlert = R.drawable.ic_alert_warning;</span>
                        }
<span class="nc bnc" id="L121" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4719)) {</span>
<span class="nc" id="L122">                            alertColor = R.color.alert_icon_warning;</span>
                        }
<span class="nc bnc" id="L124" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4720)) {</span>
<span class="nc" id="L125">                            alertView.setVisibility(View.VISIBLE);</span>
                        }
<span class="nc bnc" id="L127" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4721)) {</span>
<span class="nc" id="L128">                            filterGroupView.setVisibility(View.GONE);</span>
                        }
                        break;
                    case Alert.TYPE_SHOW_HIDDEN_ALERTS:
<span class="nc bnc" id="L132" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4722)) {</span>
<span class="nc" id="L133">                            alertView.setVisibility(View.GONE);</span>
                        }
<span class="nc bnc" id="L135" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4723)) {</span>
<span class="nc" id="L136">                            filterGroupView.setVisibility(View.VISIBLE);</span>
                        }
<span class="nc bnc" id="L138" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4724)) {</span>
<span class="nc" id="L139">                            filterTextView.setText(alert.getString());</span>
                        }
                        break;
                    case Alert.TYPE_INFO:
                    default:
<span class="nc bnc" id="L144" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4725)) {</span>
<span class="nc" id="L145">                            bg = R.color.alert_text_background_info;</span>
                        }
<span class="nc bnc" id="L147" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4726)) {</span>
<span class="nc" id="L148">                            arrowColor = R.color.alert_text_color_info;</span>
                        }
<span class="nc bnc" id="L150" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4727)) {</span>
<span class="nc" id="L151">                            alertView.setVisibility(View.VISIBLE);</span>
                        }
<span class="nc bnc" id="L153" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(4728)) {</span>
<span class="nc" id="L154">                            filterGroupView.setVisibility(View.GONE);</span>
                        }
                        break;
                }
            }
<span class="nc bnc" id="L159" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(4730)) {</span>
                // Set text color to same as arrow color
<span class="nc" id="L161">                alertView.setTextColor(r.getColor(arrowColor));</span>
            }
            Drawable dWarning;
<span class="nc" id="L164">            Drawable wdWarning = null;</span>
<span class="nc bnc" id="L165" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(4735) ? (resourceIdAlert &gt;= 0) : (ListenerUtil.mutListener.listen(4734) ? (resourceIdAlert &lt;= 0) : (ListenerUtil.mutListener.listen(4733) ? (resourceIdAlert &gt; 0) : (ListenerUtil.mutListener.listen(4732) ? (resourceIdAlert &lt; 0) : (ListenerUtil.mutListener.listen(4731) ? (resourceIdAlert == 0) : (resourceIdAlert != 0))))))) {</span>
<span class="nc" id="L166">                dWarning = ContextCompat.getDrawable(Application.get().getApplicationContext(), resourceIdAlert);</span>
<span class="nc bnc" id="L167" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4736)) {</span>
<span class="nc" id="L168">                    wdWarning = DrawableCompat.wrap(dWarning);</span>
                }
<span class="nc bnc" id="L170" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4737)) {</span>
<span class="nc" id="L171">                    wdWarning = wdWarning.mutate();</span>
                }
<span class="nc bnc" id="L173" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4738)) {</span>
                    // Tint the icon
<span class="nc" id="L175">                    DrawableCompat.setTint(wdWarning, r.getColor(alertColor));</span>
                }
            }
            Drawable dArrow;
<span class="nc" id="L179">            Drawable wdArrow = null;</span>
<span class="nc bnc" id="L180" title="All 2 branches missed.">            int resourceIdArrow = clickable ? R.drawable.ic_navigation_chevron_right : 0;</span>
<span class="nc bnc" id="L181" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(4743) ? (resourceIdArrow &gt;= 0) : (ListenerUtil.mutListener.listen(4742) ? (resourceIdArrow &lt;= 0) : (ListenerUtil.mutListener.listen(4741) ? (resourceIdArrow &gt; 0) : (ListenerUtil.mutListener.listen(4740) ? (resourceIdArrow &lt; 0) : (ListenerUtil.mutListener.listen(4739) ? (resourceIdArrow == 0) : (resourceIdArrow != 0))))))) {</span>
<span class="nc" id="L182">                dArrow = ContextCompat.getDrawable(Application.get().getApplicationContext(), resourceIdArrow);</span>
<span class="nc bnc" id="L183" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4744)) {</span>
<span class="nc" id="L184">                    wdArrow = DrawableCompat.wrap(dArrow);</span>
                }
<span class="nc bnc" id="L186" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4745)) {</span>
<span class="nc" id="L187">                    wdArrow = wdArrow.mutate();</span>
                }
<span class="nc bnc" id="L189" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4746)) {</span>
                    // Tint the icon
<span class="nc" id="L191">                    DrawableCompat.setTint(wdArrow, r.getColor(arrowColor));</span>
                }
            }
<span class="nc bnc" id="L194" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(4747)) {</span>
<span class="nc" id="L195">                alertView.setCompoundDrawablesWithIntrinsicBounds(wdWarning, null, wdArrow, null);</span>
            }
<span class="nc bnc" id="L197" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(4748)) {</span>
                // Set the background color
<span class="nc" id="L199">                view.setBackgroundResource(bg);</span>
            }
            // reset the onclick listener because we could be reusing this view.
<span class="nc" id="L202">            View.OnClickListener listener = new View.OnClickListener() {</span>

                @Override
                public void onClick(View v) {
<span class="nc bnc" id="L206" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4749)) {</span>
<span class="nc" id="L207">                        alert.onClick();</span>
                    }
<span class="nc" id="L209">                }</span>
            };
<span class="nc bnc" id="L211" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(4750)) {</span>
<span class="nc" id="L212">                view.setOnClickListener(listener);</span>
            }
<span class="nc bnc" id="L214" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(4751)) {</span>
                // Remove any previous clickable spans - we're recycling views between fragments for efficiency
<span class="nc" id="L216">                UIUtils.removeAllClickableSpans(showAllView);</span>
            }
<span class="nc" id="L218">            ClickableSpan showAllClick = new ClickableSpan() {</span>

                public void onClick(View v) {
<span class="nc bnc" id="L221" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(4752)) {</span>
<span class="nc" id="L222">                        alert.onClick();</span>
                    }
<span class="nc" id="L224">                }</span>
            };
<span class="nc bnc" id="L226" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(4753)) {</span>
<span class="nc" id="L227">                UIUtils.setClickableSpan(showAllView, showAllClick);</span>
            }
<span class="nc" id="L229">        }</span>
    }

    private Adapter mAdapter;

    private boolean mIsAlertHidden;

    private int mHiddenAlertCount;

    // 
    private ListView mView;

<span class="nc" id="L241">    AlertList(Context context) {</span>
<span class="nc bnc" id="L242" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4754)) {</span>
<span class="nc" id="L243">            mAdapter = new Adapter(context);</span>
        }
<span class="nc" id="L245">    }</span>

    void initView(View view) {
<span class="nc bnc" id="L248" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4755)) {</span>
<span class="nc" id="L249">            mView = (ListView) view;</span>
        }
<span class="nc bnc" id="L251" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4756)) {</span>
<span class="nc" id="L252">            mView.setAdapter(mAdapter);</span>
        }
<span class="nc" id="L254">    }</span>

    // 
    void add(Alert alert) {
<span class="nc bnc" id="L258" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4757)) {</span>
<span class="nc" id="L259">            mAdapter.add(alert);</span>
        }
<span class="nc" id="L261">    }</span>

    void addAll(Collection&lt;? extends Alert&gt; alerts) {
<span class="nc bnc" id="L264" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4766)) {</span>
<span class="nc bnc" id="L265" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(4762) ? (Build.VERSION.SDK_INT &lt;= Build.VERSION_CODES.HONEYCOMB) : (ListenerUtil.mutListener.listen(4761) ? (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.HONEYCOMB) : (ListenerUtil.mutListener.listen(4760) ? (Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.HONEYCOMB) : (ListenerUtil.mutListener.listen(4759) ? (Build.VERSION.SDK_INT != Build.VERSION_CODES.HONEYCOMB) : (ListenerUtil.mutListener.listen(4758) ? (Build.VERSION.SDK_INT == Build.VERSION_CODES.HONEYCOMB) : (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.HONEYCOMB))))))) {</span>
<span class="nc bnc" id="L266" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4765)) {</span>
<span class="nc" id="L267">                    mAdapter.addAll(alerts);</span>
                }
            } else {
<span class="nc bnc" id="L270" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(4764)) {</span>
                    {
<span class="nc" id="L272">                        long _loopCounter34 = 0;</span>
<span class="nc bnc" id="L273" title="All 2 branches missed.">                        for (Alert a : alerts) {</span>
<span class="nc" id="L274">                            ListenerUtil.loopListener.listen(&quot;_loopCounter34&quot;, ++_loopCounter34);</span>
<span class="nc bnc" id="L275" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(4763)) {</span>
<span class="nc" id="L276">                                mAdapter.add(a);</span>
                            }
<span class="nc" id="L278">                        }</span>
                    }
                }
            }
        }
<span class="nc" id="L283">    }</span>

    void insert(Alert alert, int index) {
<span class="nc bnc" id="L286" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4767)) {</span>
<span class="nc" id="L287">            mAdapter.insert(alert, index);</span>
        }
<span class="nc" id="L289">    }</span>

    int getPosition(Alert alert) {
<span class="nc" id="L292">        return mAdapter.getPosition(alert);</span>
    }

    void remove(Alert alert) {
<span class="nc bnc" id="L296" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4768)) {</span>
<span class="nc" id="L297">            mAdapter.remove(alert);</span>
        }
<span class="nc" id="L299">    }</span>

    int getCount() {
<span class="nc" id="L302">        return mAdapter.getCount();</span>
    }

    Alert getItem(int position) {
<span class="nc" id="L306">        return mAdapter.getItem(position);</span>
    }

    /**
     * Returns true if some alerts have previously been hidden that would otherwise
     * appear in this list, false if all alerts are visible
     *
     * @return true if some alerts have previously been hidden that would otherwise
     * appear in this list, false if all alerts are visible
     */
    public boolean isAlertHidden() {
<span class="nc" id="L317">        return mIsAlertHidden;</span>
    }

    /**
     * Set to true if there are some alerts that have been previously hidden that would
     * otherwise appear in this list, , false if all alerts are visible
     *
     * @param alertHidden true if there are some alerts that have been previously hidden that would
     *                    otherwise appear in this list, false if all alerts are visible
     */
    public void setAlertHidden(boolean alertHidden) {
<span class="nc bnc" id="L328" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4769)) {</span>
<span class="nc" id="L329">            mIsAlertHidden = alertHidden;</span>
        }
<span class="nc" id="L331">    }</span>

    /**
     * Returns the number of active alerts hidden that would otherwise appear in this list
     *
     * @return the number of active alerts hidden that would otherwise appear in this list
     */
    public int getHiddenAlertCount() {
<span class="nc" id="L339">        return mHiddenAlertCount;</span>
    }

    /**
     * Sets the number of active alerts hidden that would otherwise appear in this list
     *
     * @param hiddenAlertCount the number of active alerts hidden that would otherwise appear in
     *                         this list
     */
    public void setHiddenAlertCount(int hiddenAlertCount) {
<span class="nc bnc" id="L349" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(4770)) {</span>
<span class="nc" id="L350">            mHiddenAlertCount = hiddenAlertCount;</span>
        }
<span class="nc" id="L352">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span>Generated by the Android Gradle plugin 8.2.0</div></body></html>