<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>HelpDialog.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">AnkiDroid</a> &gt; <a href="index.source.html" class="el_package">com.ichi2.anki.dialogs</a> &gt; <span class="el_source">HelpDialog.java</span></div><h1>HelpDialog.java</h1><pre class="source lang-java linenums">/*
 *  Copyright (c) 2020 David Allison &lt;davidallisongithub@gmail.com&gt;
 *
 *  This program is free software; you can redistribute it and/or modify it under
 *  the terms of the GNU General Public License as published by the Free Software
 *  Foundation; either version 3 of the License, or (at your option) any later
 *  version.
 *
 *  This program is distributed in the hope that it will be useful, but WITHOUT ANY
 *  WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
 *  PARTICULAR PURPOSE. See the GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License along with
 *  this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.
 */
package com.ichi2.anki.dialogs;

import android.content.Context;
import android.net.Uri;
import android.os.Parcel;
import android.os.Parcelable;
import com.ichi2.anki.AnkiActivity;
import com.ichi2.anki.AnkiDroidApp;
import com.ichi2.anki.R;
import com.ichi2.anki.dialogs.RecursivePictureMenu.Item;
import com.ichi2.anki.dialogs.RecursivePictureMenu.ItemHeader;
import com.ichi2.utils.IntentUtil;
import java.io.Serializable;
import java.util.ArrayList;
import java.util.Arrays;
import androidx.annotation.DrawableRes;
import androidx.annotation.StringRes;
import androidx.fragment.app.DialogFragment;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

<span class="nc" id="L36">public class HelpDialog {</span>

    private static void openManual(AnkiActivity ankiActivity) {
<span class="nc bnc" id="L39" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(757)) {</span>
<span class="nc" id="L40">            ankiActivity.openUrl(Uri.parse(AnkiDroidApp.getManualUrl()));</span>
        }
<span class="nc" id="L42">    }</span>

    private static void openFeedback(AnkiActivity ankiActivity) {
<span class="nc bnc" id="L45" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(758)) {</span>
<span class="nc" id="L46">            ankiActivity.openUrl(Uri.parse(AnkiDroidApp.getFeedbackUrl()));</span>
        }
<span class="nc" id="L48">    }</span>

    public static DialogFragment createInstance(Context context) {
<span class="nc" id="L51">        RateAppItem rateAppItem = new RateAppItem(R.string.help_item_support_rate_ankidroid, R.drawable.ic_star_black_24);</span>
<span class="nc" id="L52">        Item[] allItems = { new ItemHeader(R.string.help_title_using_ankidroid, R.drawable.ic_manual_black_24dp, new FunctionItem(R.string.help_item_ankidroid_manual, R.drawable.ic_manual_black_24dp, HelpDialog::openManual), new LinkItem(R.string.help_item_anki_manual, R.drawable.ic_manual_black_24dp, R.string.link_anki_manual), new LinkItem(R.string.help_item_ankidroid_faq, R.drawable.ic_help_black_24dp, R.string.link_ankidroid_faq)), new ItemHeader(R.string.help_title_get_help, R.drawable.ic_help_black_24dp, new LinkItem(R.string.help_item_mailing_list, R.drawable.ic_email_black_24dp, R.string.link_forum), new FunctionItem(R.string.help_item_report_bug, R.drawable.ic_bug_report_black_24dp, HelpDialog::openFeedback)), new ItemHeader(R.string.help_title_support_ankidroid, R.drawable.ic_heart_black_24dp, new LinkItem(R.string.help_item_support_opencollective_donate, R.drawable.ic_donate_black_24dp, R.string.link_opencollective_donate), new LinkItem(R.string.multimedia_editor_trans_translate, R.drawable.ic_language_black_24dp, R.string.link_translation), new LinkItem(R.string.help_item_support_develop_ankidroid, R.drawable.ic_build_black_24, R.string.link_ankidroid_development_guide), rateAppItem, new LinkItem(R.string.help_item_support_other_ankidroid, R.drawable.ic_help_black_24dp, R.string.link_contribution), new FunctionItem(R.string.send_feedback, R.drawable.ic_email_black_24dp, HelpDialog::openFeedback)), new ItemHeader(R.string.help_title_community, R.drawable.ic_people_black_24dp, new LinkItem(R.string.help_item_anki_forums, R.drawable.ic_forum_black_24dp, R.string.link_anki_forum), new LinkItem(R.string.help_item_reddit, R.drawable.ic_mail_outline_black_24dp, R.string.link_reddit), new LinkItem(R.string.help_item_mailing_list, R.drawable.ic_email_black_24dp, R.string.link_forum), new LinkItem(R.string.help_item_discord, R.drawable.ic_message_black_24dp, R.string.link_discord), new LinkItem(R.string.help_item_facebook, R.drawable.ic_link_black_24dp, R.string.link_facebook), new LinkItem(R.string.help_item_twitter, R.drawable.ic_link_black_24dp, R.string.link_twitter)) };</span>
<span class="nc" id="L53">        ArrayList&lt;Item&gt; itemList = new ArrayList&lt;&gt;(Arrays.asList(allItems));</span>
<span class="nc bnc" id="L54" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(760)) {</span>
<span class="nc bnc" id="L55" title="All 2 branches missed.">            if (!IntentUtil.canOpenIntent(context, AnkiDroidApp.getMarketIntent(context))) {</span>
<span class="nc bnc" id="L56" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(759)) {</span>
<span class="nc" id="L57">                    RecursivePictureMenu.removeFrom(itemList, rateAppItem);</span>
                }
            }
        }
<span class="nc" id="L61">        return RecursivePictureMenu.createInstance(itemList, R.string.help);</span>
    }

    public static class RateAppItem extends Item implements Parcelable {

        public RateAppItem(@StringRes int titleRes, @DrawableRes int iconRes) {
<span class="nc" id="L67">            super(titleRes, iconRes);</span>
<span class="nc" id="L68">        }</span>

        @Override
        public void execute(AnkiActivity activity) {
<span class="nc bnc" id="L72" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(761)) {</span>
<span class="nc" id="L73">                IntentUtil.tryOpenIntent(activity, AnkiDroidApp.getMarketIntent(activity));</span>
            }
<span class="nc" id="L75">        }</span>

        @Override
        public void remove(Item toRemove) {
<span class="nc" id="L79">        }</span>

        protected RateAppItem(Parcel in) {
<span class="nc" id="L82">            super(in);</span>
<span class="nc" id="L83">        }</span>

        @SuppressWarnings(&quot;unused&quot;)
<span class="nc" id="L86">        public static final Parcelable.Creator&lt;RateAppItem&gt; CREATOR = new Parcelable.Creator&lt;RateAppItem&gt;() {</span>

            @Override
            public RateAppItem createFromParcel(Parcel in) {
<span class="nc" id="L90">                return new RateAppItem(in);</span>
            }

            @Override
            public RateAppItem[] newArray(int size) {
<span class="nc" id="L95">                return new RateAppItem[size];</span>
            }
        };
    }

    public static class LinkItem extends Item implements Parcelable {

        @StringRes
        private final int mUrlLocationRes;

        public LinkItem(@StringRes int titleRes, @DrawableRes int iconRes, @StringRes int urlLocation) {
<span class="nc" id="L106">            super(titleRes, iconRes);</span>
<span class="nc" id="L107">            this.mUrlLocationRes = urlLocation;</span>
<span class="nc" id="L108">        }</span>

        @Override
        public void execute(AnkiActivity activity) {
<span class="nc bnc" id="L112" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(762)) {</span>
<span class="nc" id="L113">                activity.openUrl(getUrl(activity));</span>
            }
<span class="nc" id="L115">        }</span>

        protected Uri getUrl(Context ctx) {
<span class="nc" id="L118">            return Uri.parse(ctx.getString(mUrlLocationRes));</span>
        }

        protected LinkItem(Parcel in) {
<span class="nc" id="L122">            super(in);</span>
<span class="nc" id="L123">            mUrlLocationRes = in.readInt();</span>
<span class="nc" id="L124">        }</span>

        @Override
        public void remove(Item toRemove) {
<span class="nc" id="L128">        }</span>

        @Override
        public void writeToParcel(Parcel dest, int flags) {
<span class="nc bnc" id="L132" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(763)) {</span>
<span class="nc" id="L133">                super.writeToParcel(dest, flags);</span>
            }
<span class="nc bnc" id="L135" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(764)) {</span>
<span class="nc" id="L136">                dest.writeInt(mUrlLocationRes);</span>
            }
<span class="nc" id="L138">        }</span>

        @SuppressWarnings(&quot;unused&quot;)
<span class="nc" id="L141">        public static final Parcelable.Creator&lt;LinkItem&gt; CREATOR = new Parcelable.Creator&lt;LinkItem&gt;() {</span>

            @Override
            public LinkItem createFromParcel(Parcel in) {
<span class="nc" id="L145">                return new LinkItem(in);</span>
            }

            @Override
            public LinkItem[] newArray(int size) {
<span class="nc" id="L150">                return new LinkItem[size];</span>
            }
        };
    }

    public static class FunctionItem extends Item implements Parcelable {

        private final ActivityConsumer mFunc;

        public FunctionItem(@StringRes int titleRes, @DrawableRes int iconRes, ActivityConsumer func) {
<span class="nc" id="L160">            super(titleRes, iconRes);</span>
<span class="nc" id="L161">            this.mFunc = func;</span>
<span class="nc" id="L162">        }</span>

        @Override
        public void execute(AnkiActivity activity) {
<span class="nc bnc" id="L166" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(765)) {</span>
<span class="nc" id="L167">                mFunc.consume(activity);</span>
            }
<span class="nc" id="L169">        }</span>

        protected FunctionItem(Parcel in) {
<span class="nc" id="L172">            super(in);</span>
<span class="nc" id="L173">            mFunc = (ActivityConsumer) in.readSerializable();</span>
<span class="nc" id="L174">        }</span>

        @Override
        public void remove(Item toRemove) {
<span class="nc" id="L178">        }</span>

        @Override
        public void writeToParcel(Parcel dest, int flags) {
<span class="nc bnc" id="L182" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(766)) {</span>
<span class="nc" id="L183">                super.writeToParcel(dest, flags);</span>
            }
<span class="nc bnc" id="L185" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(767)) {</span>
<span class="nc" id="L186">                dest.writeSerializable(mFunc);</span>
            }
<span class="nc" id="L188">        }</span>

        @SuppressWarnings(&quot;unused&quot;)
<span class="nc" id="L191">        public static final Parcelable.Creator&lt;FunctionItem&gt; CREATOR = new Parcelable.Creator&lt;FunctionItem&gt;() {</span>

            @Override
            public FunctionItem createFromParcel(Parcel in) {
<span class="nc" id="L195">                return new FunctionItem(in);</span>
            }

            @Override
            public FunctionItem[] newArray(int size) {
<span class="nc" id="L200">                return new FunctionItem[size];</span>
            }
        };

        @FunctionalInterface
        public interface ActivityConsumer extends Serializable {

            void consume(AnkiActivity activity);
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>