<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Reviewer.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">AnkiDroid</a> &gt; <a href="index.source.html" class="el_package">com.ichi2.anki</a> &gt; <span class="el_source">Reviewer.java</span></div><h1>Reviewer.java</h1><pre class="source lang-java linenums">/**
 * *************************************************************************************
 *  Copyright (c) 2011 Kostas Spyropoulos &lt;inigo.aldana@gmail.com&gt;                       *
 *  Copyright (c) 2014 Bruno Romero de Azevedo &lt;brunodea@inf.ufsm.br&gt;                    *
 *                                                                                       *
 *  This program is free software; you can redistribute it and/or modify it under        *
 *  the terms of the GNU General Public License as published by the Free Software        *
 *  Foundation; either version 3 of the License, or (at your option) any later           *
 *  version.                                                                             *
 *                                                                                       *
 *  This program is distributed in the hope that it will be useful, but WITHOUT ANY      *
 *  WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A      *
 *  PARTICULAR PURPOSE. See the GNU General Public License for more details.             *
 *                                                                                       *
 *  You should have received a copy of the GNU General Public License along with         *
 *  this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.                           *
 * **************************************************************************************
 */
package com.ichi2.anki;

import android.Manifest;
import android.animation.Animator;
import android.animation.AnimatorListenerAdapter;
import android.annotation.SuppressLint;
import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.content.pm.PackageManager;
import android.content.res.ColorStateList;
import android.graphics.drawable.Drawable;
import android.os.Build;
import android.os.Bundle;
import android.os.Handler;
import android.os.Message;
import android.text.SpannableString;
import android.text.style.UnderlineSpan;
import android.util.Pair;
import android.view.KeyEvent;
import android.view.Menu;
import android.view.MenuItem;
import android.view.SubMenu;
import android.view.View;
import android.view.ViewGroup;
import android.webkit.WebView;
import android.webkit.JavascriptInterface;
import android.widget.FrameLayout;
import android.widget.LinearLayout;
import android.widget.TextView;
import androidx.annotation.CheckResult;
import androidx.annotation.DrawableRes;
import androidx.annotation.IdRes;
import androidx.annotation.MenuRes;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.annotation.VisibleForTesting;
import androidx.appcompat.view.menu.MenuBuilder;
import androidx.appcompat.app.ActionBar;
import androidx.core.app.ActivityCompat;
import androidx.core.content.ContextCompat;
import androidx.core.view.ActionProvider;
import androidx.core.view.MenuItemCompat;
import androidx.vectordrawable.graphics.drawable.VectorDrawableCompat;
import com.ichi2.anki.cardviewer.CardAppearance;
import com.ichi2.anki.dialogs.ConfirmationDialog;
import com.ichi2.anki.multimediacard.AudioView;
import com.ichi2.anki.dialogs.RescheduleDialog;
import com.ichi2.anki.reviewer.PeripheralKeymap;
import com.ichi2.anki.reviewer.ReviewerUi;
import com.ichi2.anki.workarounds.FirefoxSnackbarWorkaround;
import com.ichi2.anki.reviewer.ActionButtons;
import com.ichi2.async.CollectionTask;
import com.ichi2.async.TaskListener;
import com.ichi2.async.TaskManager;
import com.ichi2.compat.CompatHelper;
import com.ichi2.libanki.Card;
import com.ichi2.libanki.Collection;
import com.ichi2.libanki.Collection.DismissType;
import com.ichi2.libanki.Consts;
import com.ichi2.libanki.Decks;
import com.ichi2.libanki.Utils;
import com.ichi2.libanki.sched.Counts;
import com.ichi2.themes.Themes;
import com.ichi2.utils.AndroidUiUtils;
import com.ichi2.utils.FunctionalInterfaces.Consumer;
import com.ichi2.utils.PairWithBoolean;
import com.ichi2.utils.Permissions;
import com.ichi2.widget.WidgetStatus;
import java.lang.ref.WeakReference;
import java.util.Collections;
import timber.log.Timber;
import static com.ichi2.anki.reviewer.CardMarker.*;
import static com.ichi2.anki.cardviewer.ViewerCommand.COMMAND_NOTHING;
import static com.ichi2.anim.ActivityTransitionAnimation.Direction.*;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

<span class="nc" id="L96">public class Reviewer extends AbstractFlashcardViewer {</span>

<span class="nc" id="L98">    private boolean mHasDrawerSwipeConflicts = false;</span>

<span class="nc" id="L100">    private boolean mShowWhiteboard = true;</span>

<span class="nc" id="L102">    private boolean mPrefFullscreenReview = false;</span>

    private static final int ADD_NOTE = 12;

    private static final int REQUEST_AUDIO_PERMISSION = 0;

    private LinearLayout colorPalette;

    // Card counts
    private SpannableString newCount;

    private SpannableString lrnCount;

    private SpannableString revCount;

    private TextView mTextBarNew;

    private TextView mTextBarLearn;

    private TextView mTextBarReview;

    private boolean mPrefHideDueCount;

    // ETA
    private int eta;

    private boolean mPrefShowETA;

    // Preferences from the collection
    private boolean mShowRemainingCardCount;

<span class="nc" id="L133">    private final ActionButtons mActionButtons = new ActionButtons(this);</span>

<span class="nc" id="L135">    private final ScheduleCollectionTaskListener mRescheduleCardHandler = new ScheduleCollectionTaskListener() {</span>

        protected int getToastResourceId() {
<span class="nc" id="L138">            return R.plurals.reschedule_cards_dialog_acknowledge;</span>
        }
    };

<span class="nc" id="L142">    private final ScheduleCollectionTaskListener mResetProgressCardHandler = new ScheduleCollectionTaskListener() {</span>

        protected int getToastResourceId() {
<span class="nc" id="L145">            return R.plurals.reset_cards_dialog_acknowledge;</span>
        }
    };

<span class="nc" id="L149">    @VisibleForTesting</span>
    protected final PeripheralKeymap mProcessor = new PeripheralKeymap(this, this);

    /**
     * We need to listen for and handle reschedules / resets very similarly
     */
<span class="nc" id="L155">    abstract class ScheduleCollectionTaskListener extends NextCardHandler&lt;PairWithBoolean&lt;Card[]&gt;&gt; {</span>

        protected abstract int getToastResourceId();

        @Override
        public void onPostExecute(PairWithBoolean&lt;Card[]&gt; result) {
<span class="nc bnc" id="L161" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10961)) {</span>
<span class="nc" id="L162">                super.onPostExecute(result);</span>
            }
<span class="nc bnc" id="L164" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10962)) {</span>
<span class="nc" id="L165">                invalidateOptionsMenu();</span>
            }
<span class="nc" id="L167">            int cardCount = result.other.length;</span>
<span class="nc bnc" id="L168" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(10963)) {</span>
<span class="nc" id="L169">                UIUtils.showThemedToast(Reviewer.this, getResources().getQuantityString(getToastResourceId(), cardCount, cardCount), true);</span>
            }
<span class="nc" id="L171">        }</span>
    }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
<span class="nc bnc" id="L176" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10964)) {</span>
<span class="nc bnc" id="L177" title="All 2 branches missed.">            if (showedActivityFailedScreen(savedInstanceState)) {</span>
<span class="nc" id="L178">                return;</span>
            }
        }
<span class="nc bnc" id="L181" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10965)) {</span>
<span class="nc" id="L182">            Timber.d(&quot;onCreate()&quot;);</span>
        }
<span class="nc bnc" id="L184" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10966)) {</span>
<span class="nc" id="L185">            super.onCreate(savedInstanceState);</span>
        }
<span class="nc bnc" id="L187" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10969)) {</span>
<span class="nc bnc" id="L188" title="All 2 branches missed.">            if (FirefoxSnackbarWorkaround.handledLaunchFromWebBrowser(getIntent(), this)) {</span>
<span class="nc bnc" id="L189" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10967)) {</span>
<span class="nc" id="L190">                    this.setResult(RESULT_CANCELED);</span>
                }
<span class="nc bnc" id="L192" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10968)) {</span>
<span class="nc" id="L193">                    finishWithAnimation(RIGHT);</span>
                }
<span class="nc" id="L195">                return;</span>
            }
        }
<span class="nc bnc" id="L198" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10972)) {</span>
<span class="nc bnc" id="L199" title="All 2 branches missed.">            if (Intent.ACTION_VIEW.equals(getIntent().getAction())) {</span>
<span class="nc bnc" id="L200" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10970)) {</span>
<span class="nc" id="L201">                    Timber.d(&quot;onCreate() :: received Intent with action = %s&quot;, getIntent().getAction());</span>
                }
<span class="nc bnc" id="L203" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10971)) {</span>
<span class="nc" id="L204">                    selectDeckFromExtra();</span>
                }
            }
        }
<span class="nc bnc" id="L208" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10973)) {</span>
<span class="nc" id="L209">            colorPalette = findViewById(R.id.whiteboard_pen_color);</span>
        }
<span class="nc bnc" id="L211" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10974)) {</span>
<span class="nc" id="L212">            startLoadingCollection();</span>
        }
<span class="nc" id="L214">    }</span>

    @Override
    protected int getFlagToDisplay() {
<span class="nc" id="L218">        int actualValue = super.getFlagToDisplay();</span>
<span class="nc bnc" id="L219" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10980)) {</span>
<span class="nc bnc" id="L220" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(10979) ? (actualValue &gt;= FLAG_NONE) : (ListenerUtil.mutListener.listen(10978) ? (actualValue &lt;= FLAG_NONE) : (ListenerUtil.mutListener.listen(10977) ? (actualValue &gt; FLAG_NONE) : (ListenerUtil.mutListener.listen(10976) ? (actualValue &lt; FLAG_NONE) : (ListenerUtil.mutListener.listen(10975) ? (actualValue != FLAG_NONE) : (actualValue == FLAG_NONE))))))) {</span>
<span class="nc" id="L221">                return FLAG_NONE;</span>
            }
        }
<span class="nc" id="L224">        Boolean isShownInActionBar = mActionButtons.isShownInActionBar(ActionButtons.RES_FLAG);</span>
<span class="nc bnc" id="L225" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10982)) {</span>
<span class="nc bnc" id="L226" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(10981) ? (isShownInActionBar != null || isShownInActionBar) : (isShownInActionBar != null &amp;&amp; isShownInActionBar))) {</span>
<span class="nc" id="L227">                return FLAG_NONE;</span>
            }
        }
<span class="nc" id="L230">        return actualValue;</span>
    }

    @Override
    protected WebView createWebView() {
<span class="nc" id="L235">        WebView ret = super.createWebView();</span>
<span class="nc bnc" id="L236" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10984)) {</span>
<span class="nc bnc" id="L237" title="All 2 branches missed.">            if (AndroidUiUtils.isRunningOnTv(this)) {</span>
<span class="nc bnc" id="L238" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10983)) {</span>
<span class="nc" id="L239">                    ret.setFocusable(false);</span>
                }
            }
        }
<span class="nc" id="L243">        return ret;</span>
    }

    @Override
    protected boolean shouldDisplayMark() {
<span class="nc" id="L248">        boolean markValue = super.shouldDisplayMark();</span>
<span class="nc bnc" id="L249" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10985)) {</span>
<span class="nc bnc" id="L250" title="All 2 branches missed.">            if (!markValue) {</span>
<span class="nc" id="L251">                return false;</span>
            }
        }
<span class="nc" id="L254">        Boolean isShownInActionBar = mActionButtons.isShownInActionBar(ActionButtons.RES_MARK);</span>
        // Otherwise, if it's in the action bar, don't show it again.
<span class="nc bnc" id="L256" title="All 10 branches missed.">        return (ListenerUtil.mutListener.listen(10986) ? (isShownInActionBar == null &amp;&amp; !isShownInActionBar) : (isShownInActionBar == null || !isShownInActionBar));</span>
    }

    private void selectDeckFromExtra() {
<span class="nc" id="L260">        Bundle extras = getIntent().getExtras();</span>
<span class="nc" id="L261">        long did = Long.MIN_VALUE;</span>
<span class="nc bnc" id="L262" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10988)) {</span>
<span class="nc bnc" id="L263" title="All 2 branches missed.">            if (extras != null) {</span>
<span class="nc bnc" id="L264" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10987)) {</span>
<span class="nc" id="L265">                    did = extras.getLong(&quot;deckId&quot;, Long.MIN_VALUE);</span>
                }
            }
        }
<span class="nc bnc" id="L269" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10994)) {</span>
<span class="nc bnc" id="L270" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(10993) ? (did &gt;= Long.MIN_VALUE) : (ListenerUtil.mutListener.listen(10992) ? (did &lt;= Long.MIN_VALUE) : (ListenerUtil.mutListener.listen(10991) ? (did &gt; Long.MIN_VALUE) : (ListenerUtil.mutListener.listen(10990) ? (did &lt; Long.MIN_VALUE) : (ListenerUtil.mutListener.listen(10989) ? (did != Long.MIN_VALUE) : (did == Long.MIN_VALUE))))))) {</span>
                // deckId is not set, load default
<span class="nc" id="L272">                return;</span>
            }
        }
<span class="nc bnc" id="L275" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10995)) {</span>
<span class="nc" id="L276">            Timber.d(&quot;selectDeckFromExtra() with deckId = %d&quot;, did);</span>
        }
<span class="nc bnc" id="L278" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10997)) {</span>
            // Clear the undo history when selecting a new deck
<span class="nc bnc" id="L280" title="All 2 branches missed.">            if (getCol().getDecks().selected() != did) {</span>
<span class="nc bnc" id="L281" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(10996)) {</span>
<span class="nc" id="L282">                    getCol().clearUndo();</span>
                }
            }
        }
<span class="nc bnc" id="L286" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10998)) {</span>
            // Select the deck
<span class="nc" id="L288">            getCol().getDecks().select(did);</span>
        }
<span class="nc bnc" id="L290" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(10999)) {</span>
            // Reset the schedule so that we get the counts for the currently selected deck
<span class="nc" id="L292">            getCol().getSched().deferReset();</span>
        }
<span class="nc" id="L294">    }</span>

    @Override
    protected void setTitle() {
        String title;
<span class="nc bnc" id="L299" title="All 2 branches missed.">        if (colIsOpen()) {</span>
<span class="nc" id="L300">            title = Decks.basename(getCol().getDecks().current().getString(&quot;name&quot;));</span>
        } else {
<span class="nc bnc" id="L302" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11000)) {</span>
<span class="nc" id="L303">                Timber.e(&quot;Could not set title in reviewer because collection closed&quot;);</span>
            }
<span class="nc" id="L305">            title = &quot;&quot;;</span>
        }
<span class="nc bnc" id="L307" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11001)) {</span>
<span class="nc" id="L308">            getSupportActionBar().setTitle(title);</span>
        }
<span class="nc bnc" id="L310" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11002)) {</span>
<span class="nc" id="L311">            super.setTitle(title);</span>
        }
<span class="nc bnc" id="L313" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11003)) {</span>
<span class="nc" id="L314">            getSupportActionBar().setSubtitle(&quot;&quot;);</span>
        }
<span class="nc" id="L316">    }</span>

    @Override
    protected int getContentViewAttr(int fullscreenMode) {
<span class="nc bnc" id="L320" title="All 3 branches missed.">        switch(fullscreenMode) {</span>
            case 1:
<span class="nc" id="L322">                return R.layout.reviewer_fullscreen;</span>
            case 2:
<span class="nc" id="L324">                return R.layout.reviewer_fullscreen_noanswers;</span>
            default:
<span class="nc" id="L326">                return R.layout.reviewer;</span>
        }
    }

    @Override
    protected void onCollectionLoaded(Collection col) {
<span class="nc bnc" id="L332" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11004)) {</span>
<span class="nc" id="L333">            super.onCollectionLoaded(col);</span>
        }
<span class="nc bnc" id="L335" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11005)) {</span>
<span class="nc" id="L336">            mPrefWhiteboard = MetaDB.getWhiteboardState(this, getParentDid());</span>
        }
<span class="nc bnc" id="L338" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11008)) {</span>
<span class="nc bnc" id="L339" title="All 2 branches missed.">            if (mPrefWhiteboard) {</span>
                // DEFECT: Slight inefficiency here, as we set the database using these methods
<span class="nc" id="L341">                boolean whiteboardVisibility = MetaDB.getWhiteboardVisibility(this, getParentDid());</span>
<span class="nc bnc" id="L342" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11006)) {</span>
<span class="nc" id="L343">                    setWhiteboardEnabledState(true);</span>
                }
<span class="nc bnc" id="L345" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11007)) {</span>
<span class="nc" id="L346">                    setWhiteboardVisibility(whiteboardVisibility);</span>
                }
            }
        }
<span class="nc bnc" id="L350" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11009)) {</span>
            // Reset schedule in case card was previously loaded
<span class="nc" id="L352">            col.getSched().deferReset();</span>
        }
<span class="nc bnc" id="L354" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11010)) {</span>
<span class="nc" id="L355">            getCol().startTimebox();</span>
        }
<span class="nc bnc" id="L357" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11011)) {</span>
<span class="nc" id="L358">            TaskManager.launchCollectionTask(new CollectionTask.GetCard(), mAnswerCardHandler(false));</span>
        }
<span class="nc bnc" id="L360" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11012)) {</span>
<span class="nc" id="L361">            disableDrawerSwipeOnConflicts();</span>
        }
<span class="nc bnc" id="L363" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11013)) {</span>
            // Add a weak reference to current activity so that scheduler can talk to to Activity
<span class="nc" id="L365">            mSched.setContext(new WeakReference&lt;&gt;(this));</span>
        }
<span class="nc bnc" id="L367" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11015)) {</span>
            // Set full screen/immersive mode if needed
<span class="nc bnc" id="L369" title="All 2 branches missed.">            if (mPrefFullscreenReview) {</span>
<span class="nc bnc" id="L370" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11014)) {</span>
<span class="nc" id="L371">                    setFullScreen(this);</span>
                }
            }
        }
<span class="nc" id="L375">    }</span>

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
<span class="nc bnc" id="L379" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11016)) {</span>
<span class="nc bnc" id="L380" title="All 2 branches missed.">            if (getDrawerToggle().onOptionsItemSelected(item)) {</span>
<span class="nc" id="L381">                return true;</span>
            }
        }
<span class="nc" id="L384">        int itemId = item.getItemId();</span>
<span class="nc bnc" id="L385" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11081)) {</span>
<span class="nc bnc" id="L386" title="All 2 branches missed.">            if (itemId == android.R.id.home) {</span>
<span class="nc bnc" id="L387" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11079)) {</span>
<span class="nc" id="L388">                    Timber.i(&quot;Reviewer:: Home button pressed&quot;);</span>
                }
<span class="nc bnc" id="L390" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11080)) {</span>
<span class="nc" id="L391">                    closeReviewer(RESULT_OK, true);</span>
                }
<span class="nc bnc" id="L393" title="All 2 branches missed.">            } else if (itemId == R.id.action_undo) {</span>
<span class="nc bnc" id="L394" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11073)) {</span>
<span class="nc" id="L395">                    Timber.i(&quot;Reviewer:: Undo button pressed&quot;);</span>
                }
<span class="nc bnc" id="L397" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11078)) {</span>
<span class="nc bnc" id="L398" title="All 26 branches missed.">                    if ((ListenerUtil.mutListener.listen(11075) ? ((ListenerUtil.mutListener.listen(11074) ? (mShowWhiteboard || mWhiteboard != null) : (mShowWhiteboard &amp;&amp; mWhiteboard != null)) || !mWhiteboard.undoEmpty()) : ((ListenerUtil.mutListener.listen(11074) ? (mShowWhiteboard || mWhiteboard != null) : (mShowWhiteboard &amp;&amp; mWhiteboard != null)) &amp;&amp; !mWhiteboard.undoEmpty()))) {</span>
<span class="nc bnc" id="L399" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11077)) {</span>
<span class="nc" id="L400">                            mWhiteboard.undo();</span>
                        }
                    } else {
<span class="nc bnc" id="L403" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11076)) {</span>
<span class="nc" id="L404">                            undo();</span>
                        }
                    }
                }
<span class="nc bnc" id="L408" title="All 2 branches missed.">            } else if (itemId == R.id.action_reset_card_progress) {</span>
<span class="nc bnc" id="L409" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11071)) {</span>
<span class="nc" id="L410">                    Timber.i(&quot;Reviewer:: Reset progress button pressed&quot;);</span>
                }
<span class="nc bnc" id="L412" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11072)) {</span>
<span class="nc" id="L413">                    showResetCardDialog();</span>
                }
<span class="nc bnc" id="L415" title="All 2 branches missed.">            } else if (itemId == R.id.action_mark_card) {</span>
<span class="nc bnc" id="L416" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11069)) {</span>
<span class="nc" id="L417">                    Timber.i(&quot;Reviewer:: Mark button pressed&quot;);</span>
                }
<span class="nc bnc" id="L419" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11070)) {</span>
<span class="nc" id="L420">                    onMark(mCurrentCard);</span>
                }
<span class="nc bnc" id="L422" title="All 2 branches missed.">            } else if (itemId == R.id.action_replay) {</span>
<span class="nc bnc" id="L423" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11067)) {</span>
<span class="nc" id="L424">                    Timber.i(&quot;Reviewer:: Replay audio button pressed (from menu)&quot;);</span>
                }
<span class="nc bnc" id="L426" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11068)) {</span>
<span class="nc" id="L427">                    playSounds(true);</span>
                }
<span class="nc bnc" id="L429" title="All 2 branches missed.">            } else if (itemId == R.id.action_toggle_mic_tool_bar) {</span>
<span class="nc bnc" id="L430" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11065)) {</span>
<span class="nc" id="L431">                    Timber.i(&quot;Reviewer:: Record mic&quot;);</span>
                }
<span class="nc bnc" id="L433" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11066)) {</span>
                    // Check permission to record and request if not granted
<span class="nc" id="L435">                    openOrToggleMicToolbar();</span>
                }
<span class="nc bnc" id="L437" title="All 2 branches missed.">            } else if (itemId == R.id.action_tag) {</span>
<span class="nc bnc" id="L438" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11063)) {</span>
<span class="nc" id="L439">                    Timber.i(&quot;Reviewer:: Tag button pressed&quot;);</span>
                }
<span class="nc bnc" id="L441" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11064)) {</span>
<span class="nc" id="L442">                    showTagsDialog();</span>
                }
<span class="nc bnc" id="L444" title="All 2 branches missed.">            } else if (itemId == R.id.action_edit) {</span>
<span class="nc bnc" id="L445" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11061)) {</span>
<span class="nc" id="L446">                    Timber.i(&quot;Reviewer:: Edit note button pressed&quot;);</span>
                }
<span class="nc bnc" id="L448" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11062)) {</span>
<span class="nc" id="L449">                    editCard();</span>
                }
<span class="nc" id="L451">                return true;</span>
<span class="nc bnc" id="L452" title="All 2 branches missed.">            } else if (itemId == R.id.action_bury) {</span>
<span class="nc bnc" id="L453" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11057)) {</span>
<span class="nc" id="L454">                    Timber.i(&quot;Reviewer:: Bury button pressed&quot;);</span>
                }
<span class="nc bnc" id="L456" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11060)) {</span>
<span class="nc bnc" id="L457" title="All 2 branches missed.">                    if (!MenuItemCompat.getActionProvider(item).hasSubMenu()) {</span>
<span class="nc bnc" id="L458" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11058)) {</span>
<span class="nc" id="L459">                            Timber.d(&quot;Bury card due to no submenu&quot;);</span>
                        }
<span class="nc bnc" id="L461" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11059)) {</span>
<span class="nc" id="L462">                            dismiss(DismissType.BURY_CARD);</span>
                        }
                    }
                }
<span class="nc bnc" id="L466" title="All 2 branches missed.">            } else if (itemId == R.id.action_suspend) {</span>
<span class="nc bnc" id="L467" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11053)) {</span>
<span class="nc" id="L468">                    Timber.i(&quot;Reviewer:: Suspend button pressed&quot;);</span>
                }
<span class="nc bnc" id="L470" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11056)) {</span>
<span class="nc bnc" id="L471" title="All 2 branches missed.">                    if (!MenuItemCompat.getActionProvider(item).hasSubMenu()) {</span>
<span class="nc bnc" id="L472" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11054)) {</span>
<span class="nc" id="L473">                            Timber.d(&quot;Suspend card due to no submenu&quot;);</span>
                        }
<span class="nc bnc" id="L475" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11055)) {</span>
<span class="nc" id="L476">                            dismiss(DismissType.SUSPEND_CARD);</span>
                        }
                    }
                }
<span class="nc bnc" id="L480" title="All 2 branches missed.">            } else if (itemId == R.id.action_delete) {</span>
<span class="nc bnc" id="L481" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11051)) {</span>
<span class="nc" id="L482">                    Timber.i(&quot;Reviewer:: Delete note button pressed&quot;);</span>
                }
<span class="nc bnc" id="L484" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11052)) {</span>
<span class="nc" id="L485">                    showDeleteNoteDialog();</span>
                }
<span class="nc bnc" id="L487" title="All 2 branches missed.">            } else if (itemId == R.id.action_change_whiteboard_pen_color) {</span>
<span class="nc bnc" id="L488" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11047)) {</span>
<span class="nc" id="L489">                    Timber.i(&quot;Reviewer:: Pen Color button pressed&quot;);</span>
                }
<span class="nc bnc" id="L491" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11050)) {</span>
<span class="nc bnc" id="L492" title="All 2 branches missed.">                    if (colorPalette.getVisibility() == View.GONE) {</span>
<span class="nc bnc" id="L493" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11049)) {</span>
<span class="nc" id="L494">                            colorPalette.setVisibility(View.VISIBLE);</span>
                        }
                    } else {
<span class="nc bnc" id="L497" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11048)) {</span>
<span class="nc" id="L498">                            colorPalette.setVisibility(View.GONE);</span>
                        }
                    }
                }
<span class="nc bnc" id="L502" title="All 2 branches missed.">            } else if (itemId == R.id.action_save_whiteboard) {</span>
<span class="nc bnc" id="L503" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11043)) {</span>
<span class="nc" id="L504">                    Timber.i(&quot;Reviewer:: Save whiteboard button pressed&quot;);</span>
                }
<span class="nc bnc" id="L506" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11046)) {</span>
<span class="nc bnc" id="L507" title="All 2 branches missed.">                    if (mWhiteboard != null) {</span>
                        try {
<span class="nc" id="L509">                            String savedWhiteboardFileName = mWhiteboard.saveWhiteboard(getCol().getTime());</span>
<span class="nc bnc" id="L510" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11045)) {</span>
<span class="nc" id="L511">                                UIUtils.showThemedToast(Reviewer.this, getString(R.string.white_board_image_saved, savedWhiteboardFileName), true);</span>
                            }
<span class="nc" id="L513">                        } catch (Exception e) {</span>
<span class="nc bnc" id="L514" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11044)) {</span>
<span class="nc" id="L515">                                UIUtils.showThemedToast(Reviewer.this, getString(R.string.white_board_image_save_failed, e.getLocalizedMessage()), true);</span>
                            }
<span class="nc" id="L517">                        }</span>
                    }
                }
<span class="nc bnc" id="L520" title="All 2 branches missed.">            } else if (itemId == R.id.action_clear_whiteboard) {</span>
<span class="nc bnc" id="L521" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11040)) {</span>
<span class="nc" id="L522">                    Timber.i(&quot;Reviewer:: Clear whiteboard button pressed&quot;);</span>
                }
<span class="nc bnc" id="L524" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11042)) {</span>
<span class="nc bnc" id="L525" title="All 2 branches missed.">                    if (mWhiteboard != null) {</span>
<span class="nc bnc" id="L526" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11041)) {</span>
<span class="nc" id="L527">                            mWhiteboard.clear();</span>
                        }
                    }
                }
<span class="nc bnc" id="L531" title="All 2 branches missed.">            } else if (itemId == R.id.action_hide_whiteboard) {</span>
<span class="nc bnc" id="L532" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11037)) {</span>
                    // toggle whiteboard visibility
<span class="nc bnc" id="L534" title="All 2 branches missed.">                    Timber.i(&quot;Reviewer:: Whiteboard visibility set to %b&quot;, !mShowWhiteboard);</span>
                }
<span class="nc bnc" id="L536" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11038)) {</span>
<span class="nc bnc" id="L537" title="All 2 branches missed.">                    setWhiteboardVisibility(!mShowWhiteboard);</span>
                }
<span class="nc bnc" id="L539" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11039)) {</span>
<span class="nc" id="L540">                    refreshActionBar();</span>
                }
<span class="nc bnc" id="L542" title="All 2 branches missed.">            } else if (itemId == R.id.action_toggle_whiteboard) {</span>
<span class="nc bnc" id="L543" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11036)) {</span>
<span class="nc" id="L544">                    toggleWhiteboard();</span>
                }
<span class="nc bnc" id="L546" title="All 2 branches missed.">            } else if (itemId == R.id.action_search_dictionary) {</span>
<span class="nc bnc" id="L547" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11034)) {</span>
<span class="nc" id="L548">                    Timber.i(&quot;Reviewer:: Search dictionary button pressed&quot;);</span>
                }
<span class="nc bnc" id="L550" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11035)) {</span>
<span class="nc" id="L551">                    lookUpOrSelectText();</span>
                }
<span class="nc bnc" id="L553" title="All 2 branches missed.">            } else if (itemId == R.id.action_open_deck_options) {</span>
<span class="nc" id="L554">                Intent i = new Intent(this, DeckOptions.class);</span>
<span class="nc bnc" id="L555" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11033)) {</span>
<span class="nc" id="L556">                    startActivityForResultWithAnimation(i, DECK_OPTIONS, FADE);</span>
                }
<span class="nc bnc" id="L558" title="All 2 branches missed.">            } else if (itemId == R.id.action_select_tts) {</span>
<span class="nc bnc" id="L559" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11031)) {</span>
<span class="nc" id="L560">                    Timber.i(&quot;Reviewer:: Select TTS button pressed&quot;);</span>
                }
<span class="nc bnc" id="L562" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11032)) {</span>
<span class="nc" id="L563">                    showSelectTtsDialogue();</span>
                }
<span class="nc bnc" id="L565" title="All 2 branches missed.">            } else if (itemId == R.id.action_add_note_reviewer) {</span>
<span class="nc bnc" id="L566" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11029)) {</span>
<span class="nc" id="L567">                    Timber.i(&quot;Reviewer:: Add note button pressed&quot;);</span>
                }
<span class="nc bnc" id="L569" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11030)) {</span>
<span class="nc" id="L570">                    addNote();</span>
                }
<span class="nc bnc" id="L572" title="All 2 branches missed.">            } else if (itemId == R.id.action_flag_zero) {</span>
<span class="nc bnc" id="L573" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11027)) {</span>
<span class="nc" id="L574">                    Timber.i(&quot;Reviewer:: No flag&quot;);</span>
                }
<span class="nc bnc" id="L576" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11028)) {</span>
<span class="nc" id="L577">                    onFlag(mCurrentCard, FLAG_NONE);</span>
                }
<span class="nc bnc" id="L579" title="All 2 branches missed.">            } else if (itemId == R.id.action_flag_one) {</span>
<span class="nc bnc" id="L580" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11025)) {</span>
<span class="nc" id="L581">                    Timber.i(&quot;Reviewer:: Flag one&quot;);</span>
                }
<span class="nc bnc" id="L583" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11026)) {</span>
<span class="nc" id="L584">                    onFlag(mCurrentCard, FLAG_RED);</span>
                }
<span class="nc bnc" id="L586" title="All 2 branches missed.">            } else if (itemId == R.id.action_flag_two) {</span>
<span class="nc bnc" id="L587" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11023)) {</span>
<span class="nc" id="L588">                    Timber.i(&quot;Reviewer:: Flag two&quot;);</span>
                }
<span class="nc bnc" id="L590" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11024)) {</span>
<span class="nc" id="L591">                    onFlag(mCurrentCard, FLAG_ORANGE);</span>
                }
<span class="nc bnc" id="L593" title="All 2 branches missed.">            } else if (itemId == R.id.action_flag_three) {</span>
<span class="nc bnc" id="L594" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11021)) {</span>
<span class="nc" id="L595">                    Timber.i(&quot;Reviewer:: Flag three&quot;);</span>
                }
<span class="nc bnc" id="L597" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11022)) {</span>
<span class="nc" id="L598">                    onFlag(mCurrentCard, FLAG_GREEN);</span>
                }
<span class="nc bnc" id="L600" title="All 2 branches missed.">            } else if (itemId == R.id.action_flag_four) {</span>
<span class="nc bnc" id="L601" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11019)) {</span>
<span class="nc" id="L602">                    Timber.i(&quot;Reviewer:: Flag four&quot;);</span>
                }
<span class="nc bnc" id="L604" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11020)) {</span>
<span class="nc" id="L605">                    onFlag(mCurrentCard, FLAG_BLUE);</span>
                }
<span class="nc bnc" id="L607" title="All 2 branches missed.">            } else if (itemId == R.id.action_card_info) {</span>
<span class="nc bnc" id="L608" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11017)) {</span>
<span class="nc" id="L609">                    Timber.i(&quot;Card Viewer:: Card Info&quot;);</span>
                }
<span class="nc bnc" id="L611" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11018)) {</span>
<span class="nc" id="L612">                    openCardInfo();</span>
                }
            } else {
<span class="nc" id="L615">                return super.onOptionsItemSelected(item);</span>
            }
        }
<span class="nc" id="L618">        return true;</span>
    }

    @Override
    protected void toggleWhiteboard() {
<span class="nc bnc" id="L623" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11082)) {</span>
<span class="nc bnc" id="L624" title="All 2 branches missed.">            mPrefWhiteboard = !mPrefWhiteboard;</span>
        }
<span class="nc bnc" id="L626" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11083)) {</span>
<span class="nc" id="L627">            Timber.i(&quot;Reviewer:: Whiteboard enabled state set to %b&quot;, mPrefWhiteboard);</span>
        }
<span class="nc bnc" id="L629" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11084)) {</span>
            // on the enabled status
<span class="nc" id="L631">            setWhiteboardEnabledState(mPrefWhiteboard);</span>
        }
<span class="nc bnc" id="L633" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11085)) {</span>
<span class="nc" id="L634">            setWhiteboardVisibility(mPrefWhiteboard);</span>
        }
<span class="nc bnc" id="L636" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11087)) {</span>
<span class="nc bnc" id="L637" title="All 2 branches missed.">            if (!mPrefWhiteboard) {</span>
<span class="nc bnc" id="L638" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11086)) {</span>
<span class="nc" id="L639">                    colorPalette.setVisibility(View.GONE);</span>
                }
            }
        }
<span class="nc bnc" id="L643" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11088)) {</span>
<span class="nc" id="L644">            refreshActionBar();</span>
        }
<span class="nc" id="L646">    }</span>

    @Override
    protected void replayVoice() {
<span class="nc bnc" id="L650" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11089)) {</span>
<span class="nc bnc" id="L651" title="All 2 branches missed.">            if (!openMicToolbar()) {</span>
<span class="nc" id="L652">                return;</span>
            }
        }
<span class="nc bnc" id="L655" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11090)) {</span>
<span class="nc" id="L656">            mMicToolBar.togglePlay();</span>
        }
<span class="nc" id="L658">    }</span>

    @Override
    protected void recordVoice() {
<span class="nc bnc" id="L662" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11091)) {</span>
<span class="nc bnc" id="L663" title="All 2 branches missed.">            if (!openMicToolbar()) {</span>
<span class="nc" id="L664">                return;</span>
            }
        }
<span class="nc bnc" id="L667" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11092)) {</span>
<span class="nc" id="L668">            mMicToolBar.toggleRecord();</span>
        }
<span class="nc" id="L670">    }</span>

    /**
     * @return Whether the mic toolbar is usable
     */
    @SuppressWarnings(&quot;BooleanMethodIsAlwaysInverted&quot;)
    private boolean openMicToolbar() {
<span class="nc bnc" id="L677" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11095)) {</span>
<span class="nc bnc" id="L678" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(11093) ? (mMicToolBar == null &amp;&amp; mMicToolBar.getVisibility() != View.VISIBLE) : (mMicToolBar == null || mMicToolBar.getVisibility() != View.VISIBLE))) {</span>
<span class="nc bnc" id="L679" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11094)) {</span>
<span class="nc" id="L680">                    openOrToggleMicToolbar();</span>
                }
            }
        }
<span class="nc bnc" id="L684" title="All 2 branches missed.">        return mMicToolBar != null;</span>
    }

    protected void openOrToggleMicToolbar() {
<span class="nc bnc" id="L688" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11098)) {</span>
<span class="nc bnc" id="L689" title="All 2 branches missed.">            if (!Permissions.canRecordAudio(this)) {</span>
<span class="nc bnc" id="L690" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11097)) {</span>
<span class="nc" id="L691">                    ActivityCompat.requestPermissions(this, new String[] { Manifest.permission.RECORD_AUDIO }, REQUEST_AUDIO_PERMISSION);</span>
                }
            } else {
<span class="nc bnc" id="L694" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11096)) {</span>
<span class="nc" id="L695">                    toggleMicToolBar();</span>
                }
            }
        }
<span class="nc" id="L699">    }</span>

    private void toggleMicToolBar() {
<span class="nc bnc" id="L702" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11109)) {</span>
<span class="nc bnc" id="L703" title="All 2 branches missed.">            if (mMicToolBar != null) {</span>
<span class="nc bnc" id="L704" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11108)) {</span>
                    // It exists swap visibility status
<span class="nc bnc" id="L706" title="All 2 branches missed.">                    if (mMicToolBar.getVisibility() != View.VISIBLE) {</span>
<span class="nc bnc" id="L707" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11107)) {</span>
<span class="nc" id="L708">                            mMicToolBar.setVisibility(View.VISIBLE);</span>
                        }
                    } else {
<span class="nc bnc" id="L711" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11106)) {</span>
<span class="nc" id="L712">                            mMicToolBar.setVisibility(View.GONE);</span>
                        }
                    }
                }
            } else {
<span class="nc bnc" id="L717" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11099)) {</span>
                    // Record mic tool bar does not exist yet
<span class="nc" id="L719">                    mTempAudioPath = AudioView.generateTempAudioFile(this);</span>
                }
<span class="nc bnc" id="L721" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11100)) {</span>
<span class="nc bnc" id="L722" title="All 2 branches missed.">                    if (mTempAudioPath == null) {</span>
<span class="nc" id="L723">                        return;</span>
                    }
                }
<span class="nc bnc" id="L726" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11101)) {</span>
<span class="nc" id="L727">                    mMicToolBar = AudioView.createRecorderInstance(this, R.drawable.av_play, R.drawable.av_pause, R.drawable.av_stop, R.drawable.av_rec, R.drawable.av_rec_stop, mTempAudioPath);</span>
                }
<span class="nc bnc" id="L729" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11103)) {</span>
<span class="nc bnc" id="L730" title="All 2 branches missed.">                    if (mMicToolBar == null) {</span>
<span class="nc bnc" id="L731" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11102)) {</span>
<span class="nc" id="L732">                            mTempAudioPath = null;</span>
                        }
<span class="nc" id="L734">                        return;</span>
                    }
                }
<span class="nc" id="L737">                FrameLayout.LayoutParams lp2 = new FrameLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.MATCH_PARENT);</span>
<span class="nc bnc" id="L738" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11104)) {</span>
<span class="nc" id="L739">                    mMicToolBar.setLayoutParams(lp2);</span>
                }
<span class="nc" id="L741">                LinearLayout micToolBarLayer = findViewById(R.id.mic_tool_bar_layer);</span>
<span class="nc bnc" id="L742" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11105)) {</span>
<span class="nc" id="L743">                    micToolBarLayer.addView(mMicToolBar);</span>
                }
            }
        }
<span class="nc" id="L747">    }</span>

    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {
<span class="nc bnc" id="L750" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11123)) {</span>
<span class="nc bnc" id="L751" title="All 186 branches missed.">            if ((ListenerUtil.mutListener.listen(11121) ? ((ListenerUtil.mutListener.listen(11120) ? (((ListenerUtil.mutListener.listen(11114) ? (requestCode &gt;= REQUEST_AUDIO_PERMISSION) : (ListenerUtil.mutListener.listen(11113) ? (requestCode &lt;= REQUEST_AUDIO_PERMISSION) : (ListenerUtil.mutListener.listen(11112) ? (requestCode &gt; REQUEST_AUDIO_PERMISSION) : (ListenerUtil.mutListener.listen(11111) ? (requestCode &lt; REQUEST_AUDIO_PERMISSION) : (ListenerUtil.mutListener.listen(11110) ? (requestCode != REQUEST_AUDIO_PERMISSION) : (requestCode == REQUEST_AUDIO_PERMISSION))))))) || ((ListenerUtil.mutListener.listen(11119) ? (permissions.length &lt;= 1) : (ListenerUtil.mutListener.listen(11118) ? (permissions.length &gt; 1) : (ListenerUtil.mutListener.listen(11117) ? (permissions.length &lt; 1) : (ListenerUtil.mutListener.listen(11116) ? (permissions.length != 1) : (ListenerUtil.mutListener.listen(11115) ? (permissions.length == 1) : (permissions.length &gt;= 1)))))))) : (((ListenerUtil.mutListener.listen(11114) ? (requestCode &gt;= REQUEST_AUDIO_PERMISSION) : (ListenerUtil.mutListener.listen(11113) ? (requestCode &lt;= REQUEST_AUDIO_PERMISSION) : (ListenerUtil.mutListener.listen(11112) ? (requestCode &gt; REQUEST_AUDIO_PERMISSION) : (ListenerUtil.mutListener.listen(11111) ? (requestCode &lt; REQUEST_AUDIO_PERMISSION) : (ListenerUtil.mutListener.listen(11110) ? (requestCode != REQUEST_AUDIO_PERMISSION) : (requestCode == REQUEST_AUDIO_PERMISSION))))))) &amp;&amp; ((ListenerUtil.mutListener.listen(11119) ? (permissions.length &lt;= 1) : (ListenerUtil.mutListener.listen(11118) ? (permissions.length &gt; 1) : (ListenerUtil.mutListener.listen(11117) ? (permissions.length &lt; 1) : (ListenerUtil.mutListener.listen(11116) ? (permissions.length != 1) : (ListenerUtil.mutListener.listen(11115) ? (permissions.length == 1) : (permissions.length &gt;= 1))))))))) || (grantResults[0] == PackageManager.PERMISSION_GRANTED)) : ((ListenerUtil.mutListener.listen(11120) ? (((ListenerUtil.mutListener.listen(11114) ? (requestCode &gt;= REQUEST_AUDIO_PERMISSION) : (ListenerUtil.mutListener.listen(11113) ? (requestCode &lt;= REQUEST_AUDIO_PERMISSION) : (ListenerUtil.mutListener.listen(11112) ? (requestCode &gt; REQUEST_AUDIO_PERMISSION) : (ListenerUtil.mutListener.listen(11111) ? (requestCode &lt; REQUEST_AUDIO_PERMISSION) : (ListenerUtil.mutListener.listen(11110) ? (requestCode != REQUEST_AUDIO_PERMISSION) : (requestCode == REQUEST_AUDIO_PERMISSION))))))) || ((ListenerUtil.mutListener.listen(11119) ? (permissions.length &lt;= 1) : (ListenerUtil.mutListener.listen(11118) ? (permissions.length &gt; 1) : (ListenerUtil.mutListener.listen(11117) ? (permissions.length &lt; 1) : (ListenerUtil.mutListener.listen(11116) ? (permissions.length != 1) : (ListenerUtil.mutListener.listen(11115) ? (permissions.length == 1) : (permissions.length &gt;= 1)))))))) : (((ListenerUtil.mutListener.listen(11114) ? (requestCode &gt;= REQUEST_AUDIO_PERMISSION) : (ListenerUtil.mutListener.listen(11113) ? (requestCode &lt;= REQUEST_AUDIO_PERMISSION) : (ListenerUtil.mutListener.listen(11112) ? (requestCode &gt; REQUEST_AUDIO_PERMISSION) : (ListenerUtil.mutListener.listen(11111) ? (requestCode &lt; REQUEST_AUDIO_PERMISSION) : (ListenerUtil.mutListener.listen(11110) ? (requestCode != REQUEST_AUDIO_PERMISSION) : (requestCode == REQUEST_AUDIO_PERMISSION))))))) &amp;&amp; ((ListenerUtil.mutListener.listen(11119) ? (permissions.length &lt;= 1) : (ListenerUtil.mutListener.listen(11118) ? (permissions.length &gt; 1) : (ListenerUtil.mutListener.listen(11117) ? (permissions.length &lt; 1) : (ListenerUtil.mutListener.listen(11116) ? (permissions.length != 1) : (ListenerUtil.mutListener.listen(11115) ? (permissions.length == 1) : (permissions.length &gt;= 1))))))))) &amp;&amp; (grantResults[0] == PackageManager.PERMISSION_GRANTED)))) {</span>
<span class="nc bnc" id="L752" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11122)) {</span>
                    // Get get audio record permission, so we can create the record tool bar
<span class="nc" id="L754">                    toggleMicToolBar();</span>
                }
            }
        }
<span class="nc" id="L758">    }</span>

    private void showRescheduleCardDialog() {
<span class="nc" id="L761">        Consumer&lt;Integer&gt; runnable = days -&gt; TaskManager.launchCollectionTask(new CollectionTask.RescheduleCards(Collections.singletonList(mCurrentCard.getId()), days), mRescheduleCardHandler);</span>
<span class="nc" id="L762">        RescheduleDialog dialog = RescheduleDialog.rescheduleSingleCard(getResources(), mCurrentCard, runnable);</span>
<span class="nc bnc" id="L763" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11124)) {</span>
<span class="nc" id="L764">            showDialogFragment(dialog);</span>
        }
<span class="nc" id="L766">    }</span>

    private void showResetCardDialog() {
<span class="nc bnc" id="L769" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11125)) {</span>
            // Show confirmation dialog before resetting card progress
<span class="nc" id="L771">            Timber.i(&quot;showResetCardDialog() Reset progress button pressed&quot;);</span>
        }
        // Show confirmation dialog before resetting card progress
<span class="nc" id="L774">        ConfirmationDialog dialog = new ConfirmationDialog();</span>
<span class="nc" id="L775">        String title = getResources().getString(R.string.reset_card_dialog_title);</span>
<span class="nc" id="L776">        String message = getResources().getString(R.string.reset_card_dialog_message);</span>
<span class="nc bnc" id="L777" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11126)) {</span>
<span class="nc" id="L778">            dialog.setArgs(title, message);</span>
        }
<span class="nc" id="L780">        Runnable confirm = () -&gt; {</span>
<span class="nc" id="L781">            Timber.i(&quot;NoteEditor:: ResetProgress button pressed&quot;);</span>
<span class="nc" id="L782">            TaskManager.launchCollectionTask(new CollectionTask.ResetCards(Collections.singletonList(mCurrentCard.getId())), mResetProgressCardHandler);</span>
<span class="nc" id="L783">        };</span>
<span class="nc bnc" id="L784" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11127)) {</span>
<span class="nc" id="L785">            dialog.setConfirm(confirm);</span>
        }
<span class="nc bnc" id="L787" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11128)) {</span>
<span class="nc" id="L788">            showDialogFragment(dialog);</span>
        }
<span class="nc" id="L790">    }</span>

    private void addNote() {
<span class="nc" id="L793">        Intent intent = new Intent(this, NoteEditor.class);</span>
<span class="nc bnc" id="L794" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11129)) {</span>
<span class="nc" id="L795">            intent.putExtra(NoteEditor.EXTRA_CALLER, NoteEditor.CALLER_REVIEWER_ADD);</span>
        }
<span class="nc bnc" id="L797" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11130)) {</span>
<span class="nc" id="L798">            startActivityForResultWithAnimation(intent, ADD_NOTE, LEFT);</span>
        }
<span class="nc" id="L800">    }</span>

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
<span class="nc bnc" id="L804" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11131)) {</span>
            // NOTE: This is called every time a new question is shown via invalidate options menu
<span class="nc" id="L806">            getMenuInflater().inflate(R.menu.reviewer, menu);</span>
        }
<span class="nc bnc" id="L808" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11132)) {</span>
<span class="nc" id="L809">            displayIconsOnTv(menu);</span>
        }
<span class="nc bnc" id="L811" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11133)) {</span>
<span class="nc" id="L812">            mActionButtons.setCustomButtonsStatus(menu);</span>
        }
<span class="nc bnc" id="L814" title="All 2 branches missed.">        int alpha = (getControlBlocked() != ReviewerUi.ControlBlock.SLOW) ? Themes.ALPHA_ICON_ENABLED_LIGHT : Themes.ALPHA_ICON_DISABLED_LIGHT;</span>
<span class="nc" id="L815">        MenuItem markCardIcon = menu.findItem(R.id.action_mark_card);</span>
<span class="nc bnc" id="L816" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11137)) {</span>
<span class="nc bnc" id="L817" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(11134) ? (mCurrentCard != null || mCurrentCard.note().hasTag(&quot;marked&quot;)) : (mCurrentCard != null &amp;&amp; mCurrentCard.note().hasTag(&quot;marked&quot;)))) {</span>
<span class="nc bnc" id="L818" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11136)) {</span>
<span class="nc" id="L819">                    markCardIcon.setTitle(R.string.menu_unmark_note).setIcon(R.drawable.ic_star_white_24dp);</span>
                }
            } else {
<span class="nc bnc" id="L822" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11135)) {</span>
<span class="nc" id="L823">                    markCardIcon.setTitle(R.string.menu_mark_note).setIcon(R.drawable.ic_star_outline_white_24dp);</span>
                }
            }
        }
<span class="nc bnc" id="L827" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11138)) {</span>
<span class="nc" id="L828">            markCardIcon.getIcon().mutate().setAlpha(alpha);</span>
        }
        // 1643 - currently null on a TV
        @Nullable
<span class="nc" id="L832">        MenuItem flag_icon = menu.findItem(R.id.action_flag);</span>
<span class="nc bnc" id="L833" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11147)) {</span>
<span class="nc bnc" id="L834" title="All 2 branches missed.">            if (flag_icon != null) {</span>
<span class="nc bnc" id="L835" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11145)) {</span>
<span class="nc bnc" id="L836" title="All 2 branches missed.">                    if (mCurrentCard != null) {</span>
<span class="nc bnc" id="L837" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11144)) {</span>
<span class="nc bnc" id="L838" title="All 5 branches missed.">                            switch(mCurrentCard.userFlag()) {</span>
                                case 1:
<span class="nc bnc" id="L840" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11139)) {</span>
<span class="nc" id="L841">                                        flag_icon.setIcon(R.drawable.ic_flag_red);</span>
                                    }
                                    break;
                                case 2:
<span class="nc bnc" id="L845" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11140)) {</span>
<span class="nc" id="L846">                                        flag_icon.setIcon(R.drawable.ic_flag_orange);</span>
                                    }
                                    break;
                                case 3:
<span class="nc bnc" id="L850" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11141)) {</span>
<span class="nc" id="L851">                                        flag_icon.setIcon(R.drawable.ic_flag_green);</span>
                                    }
                                    break;
                                case 4:
<span class="nc bnc" id="L855" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11142)) {</span>
<span class="nc" id="L856">                                        flag_icon.setIcon(R.drawable.ic_flag_blue);</span>
                                    }
                                    break;
                                default:
<span class="nc bnc" id="L860" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(11143)) {</span>
<span class="nc" id="L861">                                        flag_icon.setIcon(R.drawable.ic_flag_transparent);</span>
                                    }
                                    break;
                            }
                        }
                    }
                }
<span class="nc bnc" id="L868" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11146)) {</span>
<span class="nc" id="L869">                    flag_icon.getIcon().mutate().setAlpha(alpha);</span>
                }
            }
        }
        // Undo button
        @DrawableRes
        int undoIconId;
        boolean undoEnabled;
<span class="nc bnc" id="L877" title="All 26 branches missed.">        if ((ListenerUtil.mutListener.listen(11149) ? ((ListenerUtil.mutListener.listen(11148) ? (mShowWhiteboard || mWhiteboard != null) : (mShowWhiteboard &amp;&amp; mWhiteboard != null)) || mWhiteboard.isUndoModeActive()) : ((ListenerUtil.mutListener.listen(11148) ? (mShowWhiteboard || mWhiteboard != null) : (mShowWhiteboard &amp;&amp; mWhiteboard != null)) &amp;&amp; mWhiteboard.isUndoModeActive()))) {</span>
            // Whiteboard is here and strokes have been added at some point
<span class="nc" id="L879">            undoIconId = R.drawable.ic_eraser_variant_white_24dp;</span>
<span class="nc bnc" id="L880" title="All 2 branches missed.">            undoEnabled = !mWhiteboard.undoEmpty();</span>
        } else {
            // mWhiteboard != null` if no stroke had ever been made
<span class="nc" id="L883">            undoIconId = R.drawable.ic_undo_white_24dp;</span>
<span class="nc bnc" id="L884" title="All 10 branches missed.">            undoEnabled = ((ListenerUtil.mutListener.listen(11150) ? (colIsOpen() || getCol().undoAvailable()) : (colIsOpen() &amp;&amp; getCol().undoAvailable())));</span>
        }
<span class="nc bnc" id="L886" title="All 10 branches missed.">        int alpha_undo = ((ListenerUtil.mutListener.listen(11151) ? (undoEnabled || getControlBlocked() != ReviewerUi.ControlBlock.SLOW) : (undoEnabled &amp;&amp; getControlBlocked() != ReviewerUi.ControlBlock.SLOW))) ? Themes.ALPHA_ICON_ENABLED_LIGHT : Themes.ALPHA_ICON_DISABLED_LIGHT;</span>
<span class="nc" id="L887">        MenuItem undoIcon = menu.findItem(R.id.action_undo);</span>
<span class="nc bnc" id="L888" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11152)) {</span>
<span class="nc" id="L889">            undoIcon.setIcon(undoIconId);</span>
        }
<span class="nc bnc" id="L891" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11153)) {</span>
<span class="nc" id="L892">            undoIcon.setEnabled(undoEnabled).getIcon().mutate().setAlpha(alpha_undo);</span>
        }
<span class="nc bnc" id="L894" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11155)) {</span>
<span class="nc bnc" id="L895" title="All 2 branches missed.">            if (colIsOpen()) {</span>
<span class="nc bnc" id="L896" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11154)) {</span>
                    // Required mostly because there are tests where `col` is null
<span class="nc" id="L898">                    undoIcon.setTitle(getResources().getString(R.string.studyoptions_congrats_undo, getCol().undoName(getResources())));</span>
                }
            }
        }
<span class="nc" id="L902">        MenuItem toggle_whiteboard_icon = menu.findItem(R.id.action_toggle_whiteboard);</span>
<span class="nc" id="L903">        MenuItem hide_whiteboard_icon = menu.findItem(R.id.action_hide_whiteboard);</span>
<span class="nc" id="L904">        MenuItem change_pen_color_icon = menu.findItem(R.id.action_change_whiteboard_pen_color);</span>
<span class="nc bnc" id="L905" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11180)) {</span>
            // White board button
<span class="nc bnc" id="L907" title="All 2 branches missed.">            if (mPrefWhiteboard) {</span>
<span class="nc bnc" id="L908" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11157)) {</span>
                    // Configure the whiteboard related items in the action bar
<span class="nc" id="L910">                    toggle_whiteboard_icon.setTitle(R.string.disable_whiteboard);</span>
                }
<span class="nc bnc" id="L912" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11158)) {</span>
                    // Always allow &quot;Disable Whiteboard&quot;, even if &quot;Enable Whiteboard&quot; is disabled
<span class="nc" id="L914">                    toggle_whiteboard_icon.setVisible(true);</span>
                }
<span class="nc bnc" id="L916" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11160)) {</span>
<span class="nc bnc" id="L917" title="All 2 branches missed.">                    if (!mActionButtons.getStatus().hideWhiteboardIsDisabled()) {</span>
<span class="nc bnc" id="L918" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11159)) {</span>
<span class="nc" id="L919">                            hide_whiteboard_icon.setVisible(true);</span>
                        }
                    }
                }
<span class="nc bnc" id="L923" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11162)) {</span>
<span class="nc bnc" id="L924" title="All 2 branches missed.">                    if (!mActionButtons.getStatus().clearWhiteboardIsDisabled()) {</span>
<span class="nc bnc" id="L925" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11161)) {</span>
<span class="nc" id="L926">                            menu.findItem(R.id.action_clear_whiteboard).setVisible(true);</span>
                        }
                    }
                }
<span class="nc bnc" id="L930" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11164)) {</span>
<span class="nc bnc" id="L931" title="All 2 branches missed.">                    if (!mActionButtons.getStatus().saveWhiteboardIsDisabled()) {</span>
<span class="nc bnc" id="L932" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11163)) {</span>
<span class="nc" id="L933">                            menu.findItem(R.id.action_save_whiteboard).setVisible(true);</span>
                        }
                    }
                }
<span class="nc bnc" id="L937" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11166)) {</span>
<span class="nc bnc" id="L938" title="All 2 branches missed.">                    if (!mActionButtons.getStatus().whiteboardPenColorIsDisabled()) {</span>
<span class="nc bnc" id="L939" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11165)) {</span>
<span class="nc" id="L940">                            change_pen_color_icon.setVisible(true);</span>
                        }
                    }
                }
<span class="nc" id="L944">                Drawable whiteboardIcon = ContextCompat.getDrawable(this, R.drawable.ic_gesture_white_24dp).mutate();</span>
<span class="nc" id="L945">                Drawable whiteboardColorPaletteIcon = VectorDrawableCompat.create(getResources(), R.drawable.ic_color_lens_white_24dp, null).mutate();</span>
<span class="nc bnc" id="L946" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11179)) {</span>
<span class="nc bnc" id="L947" title="All 2 branches missed.">                    if (mShowWhiteboard) {</span>
<span class="nc bnc" id="L948" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11174)) {</span>
<span class="nc" id="L949">                            whiteboardIcon.setAlpha(Themes.ALPHA_ICON_ENABLED_LIGHT);</span>
                        }
<span class="nc bnc" id="L951" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11175)) {</span>
<span class="nc" id="L952">                            hide_whiteboard_icon.setIcon(whiteboardIcon);</span>
                        }
<span class="nc bnc" id="L954" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11176)) {</span>
<span class="nc" id="L955">                            hide_whiteboard_icon.setTitle(R.string.hide_whiteboard);</span>
                        }
<span class="nc bnc" id="L957" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11177)) {</span>
<span class="nc" id="L958">                            whiteboardColorPaletteIcon.setAlpha(Themes.ALPHA_ICON_ENABLED_LIGHT);</span>
                        }
<span class="nc bnc" id="L960" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11178)) {</span>
<span class="nc" id="L961">                            change_pen_color_icon.setIcon(whiteboardColorPaletteIcon);</span>
                        }
                    } else {
<span class="nc bnc" id="L964" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11167)) {</span>
<span class="nc" id="L965">                            whiteboardIcon.setAlpha(Themes.ALPHA_ICON_DISABLED_LIGHT);</span>
                        }
<span class="nc bnc" id="L967" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11168)) {</span>
<span class="nc" id="L968">                            hide_whiteboard_icon.setIcon(whiteboardIcon);</span>
                        }
<span class="nc bnc" id="L970" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11169)) {</span>
<span class="nc" id="L971">                            hide_whiteboard_icon.setTitle(R.string.show_whiteboard);</span>
                        }
<span class="nc bnc" id="L973" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11170)) {</span>
<span class="nc" id="L974">                            whiteboardColorPaletteIcon.setAlpha(Themes.ALPHA_ICON_DISABLED_LIGHT);</span>
                        }
<span class="nc bnc" id="L976" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11171)) {</span>
<span class="nc" id="L977">                            change_pen_color_icon.setEnabled(false);</span>
                        }
<span class="nc bnc" id="L979" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11172)) {</span>
<span class="nc" id="L980">                            change_pen_color_icon.setIcon(whiteboardColorPaletteIcon);</span>
                        }
<span class="nc bnc" id="L982" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11173)) {</span>
<span class="nc" id="L983">                            colorPalette.setVisibility(View.GONE);</span>
                        }
                    }
                }
<span class="nc" id="L987">            } else {</span>
<span class="nc bnc" id="L988" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11156)) {</span>
<span class="nc" id="L989">                    toggle_whiteboard_icon.setTitle(R.string.enable_whiteboard);</span>
                }
            }
        }
<span class="nc bnc" id="L993" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11183)) {</span>
<span class="nc bnc" id="L994" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(11181) ? (colIsOpen() || getCol().getDecks().isDyn(getParentDid())) : (colIsOpen() &amp;&amp; getCol().getDecks().isDyn(getParentDid())))) {</span>
<span class="nc bnc" id="L995" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11182)) {</span>
<span class="nc" id="L996">                    menu.findItem(R.id.action_open_deck_options).setVisible(false);</span>
                }
            }
        }
<span class="nc bnc" id="L1000" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11186)) {</span>
<span class="nc bnc" id="L1001" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(11184) ? (mSpeakText || !mActionButtons.getStatus().selectTtsIsDisabled()) : (mSpeakText &amp;&amp; !mActionButtons.getStatus().selectTtsIsDisabled()))) {</span>
<span class="nc bnc" id="L1002" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11185)) {</span>
<span class="nc" id="L1003">                    menu.findItem(R.id.action_select_tts).setVisible(true);</span>
                }
            }
        }
        // Setup bury / suspend providers
<span class="nc" id="L1008">        MenuItem suspend_icon = menu.findItem(R.id.action_suspend);</span>
<span class="nc" id="L1009">        MenuItem bury_icon = menu.findItem(R.id.action_bury);</span>
<span class="nc bnc" id="L1010" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11187)) {</span>
<span class="nc" id="L1011">            setupSubMenu(menu, R.id.action_suspend, new SuspendProvider(this));</span>
        }
<span class="nc bnc" id="L1013" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11188)) {</span>
<span class="nc" id="L1014">            setupSubMenu(menu, R.id.action_bury, new BuryProvider(this));</span>
        }
<span class="nc bnc" id="L1016" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11193)) {</span>
<span class="nc bnc" id="L1017" title="All 2 branches missed.">            if (suspendNoteAvailable()) {</span>
<span class="nc bnc" id="L1018" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11191)) {</span>
<span class="nc" id="L1019">                    suspend_icon.setIcon(R.drawable.ic_action_suspend_dropdown);</span>
                }
<span class="nc bnc" id="L1021" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11192)) {</span>
<span class="nc" id="L1022">                    suspend_icon.setTitle(R.string.menu_suspend);</span>
                }
            } else {
<span class="nc bnc" id="L1025" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11189)) {</span>
<span class="nc" id="L1026">                    suspend_icon.setIcon(R.drawable.ic_action_suspend);</span>
                }
<span class="nc bnc" id="L1028" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11190)) {</span>
<span class="nc" id="L1029">                    suspend_icon.setTitle(R.string.menu_suspend_card);</span>
                }
            }
        }
<span class="nc bnc" id="L1033" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11198)) {</span>
<span class="nc bnc" id="L1034" title="All 2 branches missed.">            if (buryNoteAvailable()) {</span>
<span class="nc bnc" id="L1035" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11196)) {</span>
<span class="nc" id="L1036">                    bury_icon.setIcon(R.drawable.ic_flip_to_back_white_24px_dropdown);</span>
                }
<span class="nc bnc" id="L1038" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11197)) {</span>
<span class="nc" id="L1039">                    bury_icon.setTitle(R.string.menu_bury);</span>
                }
            } else {
<span class="nc bnc" id="L1042" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11194)) {</span>
<span class="nc" id="L1043">                    bury_icon.setIcon(R.drawable.ic_flip_to_back_white_24dp);</span>
                }
<span class="nc bnc" id="L1045" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11195)) {</span>
<span class="nc" id="L1046">                    bury_icon.setTitle(R.string.menu_bury_card);</span>
                }
            }
        }
<span class="nc bnc" id="L1050" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11199)) {</span>
<span class="nc bnc" id="L1051" title="All 2 branches missed.">            alpha = (getControlBlocked() != ReviewerUi.ControlBlock.SLOW) ? Themes.ALPHA_ICON_ENABLED_LIGHT : Themes.ALPHA_ICON_DISABLED_LIGHT;</span>
        }
<span class="nc bnc" id="L1053" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11200)) {</span>
<span class="nc" id="L1054">            bury_icon.getIcon().mutate().setAlpha(alpha);</span>
        }
<span class="nc bnc" id="L1056" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11201)) {</span>
<span class="nc" id="L1057">            suspend_icon.getIcon().mutate().setAlpha(alpha);</span>
        }
<span class="nc bnc" id="L1059" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11202)) {</span>
<span class="nc" id="L1060">            setupSubMenu(menu, R.id.action_schedule, new ScheduleProvider(this));</span>
        }
<span class="nc" id="L1062">        return super.onCreateOptionsMenu(menu);</span>
    }

    // setOptionalIconsVisible
    @SuppressLint(&quot;RestrictedApi&quot;)
    private void displayIconsOnTv(Menu menu) {
<span class="nc bnc" id="L1068" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11203)) {</span>
<span class="nc bnc" id="L1069" title="All 2 branches missed.">            if (!AndroidUiUtils.isRunningOnTv(this)) {</span>
<span class="nc" id="L1070">                return;</span>
            }
        }
        try {
<span class="nc bnc" id="L1074" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11206)) {</span>
<span class="nc bnc" id="L1075" title="All 2 branches missed.">                if (menu instanceof MenuBuilder) {</span>
<span class="nc" id="L1076">                    MenuBuilder m = (MenuBuilder) menu;</span>
<span class="nc bnc" id="L1077" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11205)) {</span>
<span class="nc" id="L1078">                        m.setOptionalIconsVisible(true);</span>
                    }
                }
            }
<span class="nc bnc" id="L1082" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11221)) {</span>
<span class="nc bnc" id="L1083" title="All 22 branches missed.">                if ((ListenerUtil.mutListener.listen(11211) ? (Build.VERSION.SDK_INT &lt;= Build.VERSION_CODES.O) : (ListenerUtil.mutListener.listen(11210) ? (Build.VERSION.SDK_INT &gt; Build.VERSION_CODES.O) : (ListenerUtil.mutListener.listen(11209) ? (Build.VERSION.SDK_INT &lt; Build.VERSION_CODES.O) : (ListenerUtil.mutListener.listen(11208) ? (Build.VERSION.SDK_INT != Build.VERSION_CODES.O) : (ListenerUtil.mutListener.listen(11207) ? (Build.VERSION.SDK_INT == Build.VERSION_CODES.O) : (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O))))))) {</span>
<span class="nc bnc" id="L1084" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11220)) {</span>
                        {
<span class="nc" id="L1086">                            long _loopCounter185 = 0;</span>
<span class="nc bnc" id="L1087" title="All 22 branches missed.">                            for (int i = 0; (ListenerUtil.mutListener.listen(11219) ? (i &gt;= menu.size()) : (ListenerUtil.mutListener.listen(11218) ? (i &lt;= menu.size()) : (ListenerUtil.mutListener.listen(11217) ? (i &gt; menu.size()) : (ListenerUtil.mutListener.listen(11216) ? (i != menu.size()) : (ListenerUtil.mutListener.listen(11215) ? (i == menu.size()) : (i &lt; menu.size())))))); i++) {</span>
<span class="nc" id="L1088">                                ListenerUtil.loopListener.listen(&quot;_loopCounter185&quot;, ++_loopCounter185);</span>
<span class="nc" id="L1089">                                MenuItem m = menu.getItem(i);</span>
<span class="nc bnc" id="L1090" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11213)) {</span>
<span class="nc bnc" id="L1091" title="All 10 branches missed.">                                    if ((ListenerUtil.mutListener.listen(11212) ? (m == null &amp;&amp; isFlagResource(m.getItemId())) : (m == null || isFlagResource(m.getItemId())))) {</span>
<span class="nc" id="L1092">                                        continue;</span>
                                    }
                                }
<span class="nc" id="L1095">                                int color = Themes.getColorFromAttr(this, R.attr.navDrawerItemColor);</span>
<span class="nc bnc" id="L1096" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11214)) {</span>
<span class="nc" id="L1097">                                    MenuItemCompat.setIconTintList(m, ColorStateList.valueOf(color));</span>
                                }
                            }
                        }
                    }
                }
            }
<span class="nc" id="L1104">        } catch (Exception | Error e) {</span>
<span class="nc bnc" id="L1105" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11204)) {</span>
<span class="nc" id="L1106">                Timber.w(e, &quot;Failed to display icons&quot;);</span>
            }
<span class="nc" id="L1108">        }</span>
<span class="nc" id="L1109">    }</span>

    private boolean isFlagResource(int itemId) {
<span class="nc bnc" id="L1112" title="All 58 branches missed.">        return (ListenerUtil.mutListener.listen(11224) ? ((ListenerUtil.mutListener.listen(11223) ? ((ListenerUtil.mutListener.listen(11222) ? (itemId == R.id.action_flag_four &amp;&amp; itemId == R.id.action_flag_three) : (itemId == R.id.action_flag_four || itemId == R.id.action_flag_three)) &amp;&amp; itemId == R.id.action_flag_two) : ((ListenerUtil.mutListener.listen(11222) ? (itemId == R.id.action_flag_four &amp;&amp; itemId == R.id.action_flag_three) : (itemId == R.id.action_flag_four || itemId == R.id.action_flag_three)) || itemId == R.id.action_flag_two)) &amp;&amp; itemId == R.id.action_flag_one) : ((ListenerUtil.mutListener.listen(11223) ? ((ListenerUtil.mutListener.listen(11222) ? (itemId == R.id.action_flag_four &amp;&amp; itemId == R.id.action_flag_three) : (itemId == R.id.action_flag_four || itemId == R.id.action_flag_three)) &amp;&amp; itemId == R.id.action_flag_two) : ((ListenerUtil.mutListener.listen(11222) ? (itemId == R.id.action_flag_four &amp;&amp; itemId == R.id.action_flag_three) : (itemId == R.id.action_flag_four || itemId == R.id.action_flag_three)) || itemId == R.id.action_flag_two)) || itemId == R.id.action_flag_one));</span>
    }

    @Override
    public boolean onKeyDown(int keyCode, KeyEvent event) {
<span class="nc bnc" id="L1117" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11226)) {</span>
<span class="nc bnc" id="L1118" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(11225) ? (mProcessor.onKeyDown(keyCode, event) &amp;&amp; super.onKeyDown(keyCode, event)) : (mProcessor.onKeyDown(keyCode, event) || super.onKeyDown(keyCode, event)))) {</span>
<span class="nc" id="L1119">                return true;</span>
            }
        }
<span class="nc bnc" id="L1122" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11227)) {</span>
<span class="nc bnc" id="L1123" title="All 2 branches missed.">            if (!AndroidUiUtils.isRunningOnTv(this)) {</span>
<span class="nc" id="L1124">                return false;</span>
            }
        }
<span class="nc bnc" id="L1127" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11229)) {</span>
            // Process DPAD Up/Down to focus the TV Controls
<span class="nc bnc" id="L1129" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(11228) ? (keyCode != KeyEvent.KEYCODE_DPAD_DOWN || keyCode != KeyEvent.KEYCODE_DPAD_UP) : (keyCode != KeyEvent.KEYCODE_DPAD_DOWN &amp;&amp; keyCode != KeyEvent.KEYCODE_DPAD_UP))) {</span>
<span class="nc" id="L1130">                return false;</span>
            }
        }
<span class="nc bnc" id="L1133" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11230)) {</span>
            // HACK: This shouldn't be required, as the navigation should handle this.
<span class="nc bnc" id="L1135" title="All 2 branches missed.">            if (isDrawerOpen()) {</span>
<span class="nc" id="L1136">                return false;</span>
            }
        }
<span class="nc bnc" id="L1139" title="All 2 branches missed.">        View view = keyCode == KeyEvent.KEYCODE_DPAD_UP ? findViewById(R.id.tv_nav_view) : findViewById(R.id.answer_options_layout);</span>
<span class="nc bnc" id="L1140" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11231)) {</span>
            // I couldn't get either to work
<span class="nc bnc" id="L1142" title="All 2 branches missed.">            if (view == null) {</span>
<span class="nc" id="L1143">                return false;</span>
            }
        }
<span class="nc bnc" id="L1146" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11232)) {</span>
<span class="nc" id="L1147">            view.requestFocus();</span>
        }
<span class="nc" id="L1149">        return true;</span>
    }

    @Override
    public boolean onKeyUp(int keyCode, KeyEvent event) {
<span class="nc bnc" id="L1154" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11233)) {</span>
<span class="nc bnc" id="L1155" title="All 2 branches missed.">            if (answerFieldIsFocused()) {</span>
<span class="nc" id="L1156">                return super.onKeyUp(keyCode, event);</span>
            }
        }
<span class="nc bnc" id="L1159" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11234)) {</span>
<span class="nc bnc" id="L1160" title="All 2 branches missed.">            if (mProcessor.onKeyUp(keyCode, event)) {</span>
<span class="nc" id="L1161">                return true;</span>
            }
        }
<span class="nc" id="L1164">        return super.onKeyUp(keyCode, event);</span>
    }

    private &lt;T extends ActionProvider &amp; SubMenuProvider&gt; void setupSubMenu(Menu menu, @IdRes int parentMenu, T subMenuProvider) {
<span class="nc bnc" id="L1168" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11236)) {</span>
<span class="nc bnc" id="L1169" title="All 2 branches missed.">            if (!AndroidUiUtils.isRunningOnTv(this)) {</span>
<span class="nc bnc" id="L1170" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11235)) {</span>
<span class="nc" id="L1171">                    MenuItemCompat.setActionProvider(menu.findItem(parentMenu), subMenuProvider);</span>
                }
<span class="nc" id="L1173">                return;</span>
            }
        }
<span class="nc bnc" id="L1176" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11237)) {</span>
            // Don't do anything if the menu is hidden (bury for example)
<span class="nc bnc" id="L1178" title="All 2 branches missed.">            if (!subMenuProvider.hasSubMenu()) {</span>
<span class="nc" id="L1179">                return;</span>
            }
        }
<span class="nc bnc" id="L1182" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11238)) {</span>
            // 7227 - If we're running on a TV, then we can't show submenus until AOSP is fixed
<span class="nc" id="L1184">            menu.removeItem(parentMenu);</span>
        }
<span class="nc" id="L1186">        int count = menu.size();</span>
<span class="nc bnc" id="L1187" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11239)) {</span>
            // move the menu to the bottom of the page
<span class="nc" id="L1189">            getMenuInflater().inflate(subMenuProvider.getSubMenu(), menu);</span>
        }
<span class="nc bnc" id="L1191" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11254)) {</span>
            {
<span class="nc" id="L1193">                long _loopCounter186 = 0;</span>
<span class="nc bnc" id="L1194" title="All 70 branches missed.">                for (int i = 0; (ListenerUtil.mutListener.listen(11253) ? (i &gt;= (ListenerUtil.mutListener.listen(11248) ? (menu.size() % count) : (ListenerUtil.mutListener.listen(11247) ? (menu.size() / count) : (ListenerUtil.mutListener.listen(11246) ? (menu.size() * count) : (ListenerUtil.mutListener.listen(11245) ? (menu.size() + count) : (menu.size() - count)))))) : (ListenerUtil.mutListener.listen(11252) ? (i &lt;= (ListenerUtil.mutListener.listen(11248) ? (menu.size() % count) : (ListenerUtil.mutListener.listen(11247) ? (menu.size() / count) : (ListenerUtil.mutListener.listen(11246) ? (menu.size() * count) : (ListenerUtil.mutListener.listen(11245) ? (menu.size() + count) : (menu.size() - count)))))) : (ListenerUtil.mutListener.listen(11251) ? (i &gt; (ListenerUtil.mutListener.listen(11248) ? (menu.size() % count) : (ListenerUtil.mutListener.listen(11247) ? (menu.size() / count) : (ListenerUtil.mutListener.listen(11246) ? (menu.size() * count) : (ListenerUtil.mutListener.listen(11245) ? (menu.size() + count) : (menu.size() - count)))))) : (ListenerUtil.mutListener.listen(11250) ? (i != (ListenerUtil.mutListener.listen(11248) ? (menu.size() % count) : (ListenerUtil.mutListener.listen(11247) ? (menu.size() / count) : (ListenerUtil.mutListener.listen(11246) ? (menu.size() * count) : (ListenerUtil.mutListener.listen(11245) ? (menu.size() + count) : (menu.size() - count)))))) : (ListenerUtil.mutListener.listen(11249) ? (i == (ListenerUtil.mutListener.listen(11248) ? (menu.size() % count) : (ListenerUtil.mutListener.listen(11247) ? (menu.size() / count) : (ListenerUtil.mutListener.listen(11246) ? (menu.size() * count) : (ListenerUtil.mutListener.listen(11245) ? (menu.size() + count) : (menu.size() - count)))))) : (i &lt; (ListenerUtil.mutListener.listen(11248) ? (menu.size() % count) : (ListenerUtil.mutListener.listen(11247) ? (menu.size() / count) : (ListenerUtil.mutListener.listen(11246) ? (menu.size() * count) : (ListenerUtil.mutListener.listen(11245) ? (menu.size() + count) : (menu.size() - count))))))))))); i++) {</span>
<span class="nc" id="L1195">                    ListenerUtil.loopListener.listen(&quot;_loopCounter186&quot;, ++_loopCounter186);</span>
<span class="nc bnc" id="L1196" title="All 8 branches missed.">                    MenuItem item = menu.getItem((ListenerUtil.mutListener.listen(11243) ? (count % i) : (ListenerUtil.mutListener.listen(11242) ? (count / i) : (ListenerUtil.mutListener.listen(11241) ? (count * i) : (ListenerUtil.mutListener.listen(11240) ? (count - i) : (count + i))))));</span>
<span class="nc bnc" id="L1197" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11244)) {</span>
<span class="nc" id="L1198">                        item.setOnMenuItemClickListener(subMenuProvider);</span>
                    }
                }
            }
        }
<span class="nc" id="L1203">    }</span>

    @Override
    protected boolean canAccessScheduler() {
<span class="nc" id="L1207">        return true;</span>
    }

    @Override
    protected void performReload() {
<span class="nc bnc" id="L1212" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11255)) {</span>
<span class="nc" id="L1213">            getCol().getSched().deferReset();</span>
        }
<span class="nc bnc" id="L1215" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11256)) {</span>
<span class="nc" id="L1216">            TaskManager.launchCollectionTask(new CollectionTask.GetCard(), mAnswerCardHandler(false));</span>
        }
<span class="nc" id="L1218">    }</span>

    @Override
    protected void displayAnswerBottomBar() {
<span class="nc bnc" id="L1222" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11257)) {</span>
<span class="nc" id="L1223">            super.displayAnswerBottomBar();</span>
        }
        int buttonCount;
        try {
<span class="nc" id="L1227">            buttonCount = mSched.answerButtons(mCurrentCard);</span>
<span class="nc" id="L1228">        } catch (RuntimeException e) {</span>
<span class="nc bnc" id="L1229" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11258)) {</span>
<span class="nc" id="L1230">                AnkiDroidApp.sendExceptionReport(e, &quot;AbstractReviewer-showEaseButtons&quot;);</span>
            }
<span class="nc bnc" id="L1232" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11259)) {</span>
<span class="nc" id="L1233">                closeReviewer(DeckPicker.RESULT_DB_ERROR, true);</span>
            }
<span class="nc" id="L1235">            return;</span>
<span class="nc" id="L1236">        }</span>
        // (which libanki expects ease to be 2 and 3) can either be hard, good, or easy - depending on num buttons shown
        int[] backgroundIds;
<span class="nc bnc" id="L1239" title="All 2 branches missed.">        if (animationEnabled()) {</span>
<span class="nc" id="L1240">            backgroundIds = new int[] { R.attr.againButtonRippleRef, R.attr.hardButtonRippleRef, R.attr.goodButtonRippleRef, R.attr.easyButtonRippleRef };</span>
        } else {
<span class="nc" id="L1242">            backgroundIds = new int[] { R.attr.againButtonRef, R.attr.hardButtonRef, R.attr.goodButtonRef, R.attr.easyButtonRef };</span>
        }
<span class="nc" id="L1244">        final int[] background = Themes.getResFromAttr(this, backgroundIds);</span>
<span class="nc" id="L1245">        final int[] textColor = Themes.getColorFromAttr(this, new int[] { R.attr.againButtonTextColor, R.attr.hardButtonTextColor, R.attr.goodButtonTextColor, R.attr.easyButtonTextColor });</span>
<span class="nc bnc" id="L1246" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11260)) {</span>
<span class="nc" id="L1247">            mEase1Layout.setVisibility(View.VISIBLE);</span>
        }
<span class="nc bnc" id="L1249" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11261)) {</span>
<span class="nc" id="L1250">            mEase1Layout.setBackgroundResource(background[0]);</span>
        }
<span class="nc bnc" id="L1252" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11262)) {</span>
<span class="nc" id="L1253">            mEase4Layout.setBackgroundResource(background[3]);</span>
        }
<span class="nc bnc" id="L1255" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11294)) {</span>
<span class="nc bnc" id="L1256" title="All 3 branches missed.">            switch(buttonCount) {</span>
                case 2:
<span class="nc bnc" id="L1258" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11263)) {</span>
                        // Ease 2 is &quot;good&quot;
<span class="nc" id="L1260">                        mEase2Layout.setVisibility(View.VISIBLE);</span>
                    }
<span class="nc bnc" id="L1262" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11264)) {</span>
<span class="nc" id="L1263">                        mEase2Layout.setBackgroundResource(background[2]);</span>
                    }
<span class="nc bnc" id="L1265" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11265)) {</span>
<span class="nc" id="L1266">                        mEase2.setText(R.string.ease_button_good);</span>
                    }
<span class="nc bnc" id="L1268" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11266)) {</span>
<span class="nc" id="L1269">                        mEase2.setTextColor(textColor[2]);</span>
                    }
<span class="nc bnc" id="L1271" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11267)) {</span>
<span class="nc" id="L1272">                        mNext2.setTextColor(textColor[2]);</span>
                    }
<span class="nc bnc" id="L1274" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11268)) {</span>
<span class="nc" id="L1275">                        mEase2Layout.requestFocus();</span>
                    }
                    break;
                case 3:
<span class="nc bnc" id="L1279" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11269)) {</span>
                        // Ease 2 is good
<span class="nc" id="L1281">                        mEase2Layout.setVisibility(View.VISIBLE);</span>
                    }
<span class="nc bnc" id="L1283" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11270)) {</span>
<span class="nc" id="L1284">                        mEase2Layout.setBackgroundResource(background[2]);</span>
                    }
<span class="nc bnc" id="L1286" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11271)) {</span>
<span class="nc" id="L1287">                        mEase2.setText(R.string.ease_button_good);</span>
                    }
<span class="nc bnc" id="L1289" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11272)) {</span>
<span class="nc" id="L1290">                        mEase2.setTextColor(textColor[2]);</span>
                    }
<span class="nc bnc" id="L1292" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11273)) {</span>
<span class="nc" id="L1293">                        mNext2.setTextColor(textColor[2]);</span>
                    }
<span class="nc bnc" id="L1295" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11274)) {</span>
                        // Ease 3 is easy
<span class="nc" id="L1297">                        mEase3Layout.setVisibility(View.VISIBLE);</span>
                    }
<span class="nc bnc" id="L1299" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11275)) {</span>
<span class="nc" id="L1300">                        mEase3Layout.setBackgroundResource(background[3]);</span>
                    }
<span class="nc bnc" id="L1302" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11276)) {</span>
<span class="nc" id="L1303">                        mEase3.setText(R.string.ease_button_easy);</span>
                    }
<span class="nc bnc" id="L1305" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11277)) {</span>
<span class="nc" id="L1306">                        mEase3.setTextColor(textColor[3]);</span>
                    }
<span class="nc bnc" id="L1308" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11278)) {</span>
<span class="nc" id="L1309">                        mNext3.setTextColor(textColor[3]);</span>
                    }
<span class="nc bnc" id="L1311" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11279)) {</span>
<span class="nc" id="L1312">                        mEase2Layout.requestFocus();</span>
                    }
                    break;
                default:
<span class="nc bnc" id="L1316" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11280)) {</span>
<span class="nc" id="L1317">                        mEase2Layout.setVisibility(View.VISIBLE);</span>
                    }
<span class="nc bnc" id="L1319" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11281)) {</span>
                        // Ease 2 is &quot;hard&quot;
<span class="nc" id="L1321">                        mEase2Layout.setVisibility(View.VISIBLE);</span>
                    }
<span class="nc bnc" id="L1323" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11282)) {</span>
<span class="nc" id="L1324">                        mEase2Layout.setBackgroundResource(background[1]);</span>
                    }
<span class="nc bnc" id="L1326" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11283)) {</span>
<span class="nc" id="L1327">                        mEase2.setText(R.string.ease_button_hard);</span>
                    }
<span class="nc bnc" id="L1329" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11284)) {</span>
<span class="nc" id="L1330">                        mEase2.setTextColor(textColor[1]);</span>
                    }
<span class="nc bnc" id="L1332" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11285)) {</span>
<span class="nc" id="L1333">                        mNext2.setTextColor(textColor[1]);</span>
                    }
<span class="nc bnc" id="L1335" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11286)) {</span>
<span class="nc" id="L1336">                        mEase2Layout.requestFocus();</span>
                    }
<span class="nc bnc" id="L1338" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11287)) {</span>
                        // Ease 3 is good
<span class="nc" id="L1340">                        mEase3Layout.setVisibility(View.VISIBLE);</span>
                    }
<span class="nc bnc" id="L1342" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11288)) {</span>
<span class="nc" id="L1343">                        mEase3Layout.setBackgroundResource(background[2]);</span>
                    }
<span class="nc bnc" id="L1345" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11289)) {</span>
<span class="nc" id="L1346">                        mEase3.setText(R.string.ease_button_good);</span>
                    }
<span class="nc bnc" id="L1348" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11290)) {</span>
<span class="nc" id="L1349">                        mEase3.setTextColor(textColor[2]);</span>
                    }
<span class="nc bnc" id="L1351" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11291)) {</span>
<span class="nc" id="L1352">                        mNext3.setTextColor(textColor[2]);</span>
                    }
<span class="nc bnc" id="L1354" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11292)) {</span>
<span class="nc" id="L1355">                        mEase4Layout.setVisibility(View.VISIBLE);</span>
                    }
<span class="nc bnc" id="L1357" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11293)) {</span>
<span class="nc" id="L1358">                        mEase3Layout.requestFocus();</span>
                    }
                    break;
            }
        }
<span class="nc bnc" id="L1363" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11311)) {</span>
            // Show next review time
<span class="nc bnc" id="L1365" title="All 2 branches missed.">            if (shouldShowNextReviewTime()) {</span>
<span class="nc bnc" id="L1366" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11295)) {</span>
<span class="nc" id="L1367">                    mNext1.setText(mSched.nextIvlStr(this, mCurrentCard, Consts.BUTTON_ONE));</span>
                }
<span class="nc bnc" id="L1369" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11296)) {</span>
<span class="nc" id="L1370">                    mNext2.setText(mSched.nextIvlStr(this, mCurrentCard, Consts.BUTTON_TWO));</span>
                }
<span class="nc bnc" id="L1372" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11303)) {</span>
<span class="nc bnc" id="L1373" title="All 22 branches missed.">                    if ((ListenerUtil.mutListener.listen(11301) ? (buttonCount &gt;= 2) : (ListenerUtil.mutListener.listen(11300) ? (buttonCount &lt;= 2) : (ListenerUtil.mutListener.listen(11299) ? (buttonCount &lt; 2) : (ListenerUtil.mutListener.listen(11298) ? (buttonCount != 2) : (ListenerUtil.mutListener.listen(11297) ? (buttonCount == 2) : (buttonCount &gt; 2))))))) {</span>
<span class="nc bnc" id="L1374" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11302)) {</span>
<span class="nc" id="L1375">                            mNext3.setText(mSched.nextIvlStr(this, mCurrentCard, Consts.BUTTON_THREE));</span>
                        }
                    }
                }
<span class="nc bnc" id="L1379" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11310)) {</span>
<span class="nc bnc" id="L1380" title="All 22 branches missed.">                    if ((ListenerUtil.mutListener.listen(11308) ? (buttonCount &gt;= 3) : (ListenerUtil.mutListener.listen(11307) ? (buttonCount &lt;= 3) : (ListenerUtil.mutListener.listen(11306) ? (buttonCount &lt; 3) : (ListenerUtil.mutListener.listen(11305) ? (buttonCount != 3) : (ListenerUtil.mutListener.listen(11304) ? (buttonCount == 3) : (buttonCount &gt; 3))))))) {</span>
<span class="nc bnc" id="L1381" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11309)) {</span>
<span class="nc" id="L1382">                            mNext4.setText(mSched.nextIvlStr(this, mCurrentCard, Consts.BUTTON_FOUR));</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L1388">    }</span>

    @Override
    protected SharedPreferences restorePreferences() {
<span class="nc" id="L1392">        SharedPreferences preferences = super.restorePreferences();</span>
<span class="nc bnc" id="L1393" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11312)) {</span>
<span class="nc" id="L1394">            mPrefHideDueCount = preferences.getBoolean(&quot;hideDueCount&quot;, false);</span>
        }
<span class="nc bnc" id="L1396" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11313)) {</span>
<span class="nc" id="L1397">            mPrefShowETA = preferences.getBoolean(&quot;showETA&quot;, true);</span>
        }
<span class="nc bnc" id="L1399" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11314)) {</span>
<span class="nc" id="L1400">            this.mProcessor.setup();</span>
        }
<span class="nc bnc" id="L1402" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11320)) {</span>
<span class="nc bnc" id="L1403" title="All 22 branches missed.">            mPrefFullscreenReview = (ListenerUtil.mutListener.listen(11319) ? (Integer.parseInt(preferences.getString(&quot;fullscreenMode&quot;, &quot;0&quot;)) &gt;= 0) : (ListenerUtil.mutListener.listen(11318) ? (Integer.parseInt(preferences.getString(&quot;fullscreenMode&quot;, &quot;0&quot;)) &lt;= 0) : (ListenerUtil.mutListener.listen(11317) ? (Integer.parseInt(preferences.getString(&quot;fullscreenMode&quot;, &quot;0&quot;)) &lt; 0) : (ListenerUtil.mutListener.listen(11316) ? (Integer.parseInt(preferences.getString(&quot;fullscreenMode&quot;, &quot;0&quot;)) != 0) : (ListenerUtil.mutListener.listen(11315) ? (Integer.parseInt(preferences.getString(&quot;fullscreenMode&quot;, &quot;0&quot;)) == 0) : (Integer.parseInt(preferences.getString(&quot;fullscreenMode&quot;, &quot;0&quot;)) &gt; 0))))));</span>
        }
<span class="nc bnc" id="L1405" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11321)) {</span>
<span class="nc" id="L1406">            mActionButtons.setup(preferences);</span>
        }
<span class="nc" id="L1408">        return preferences;</span>
    }

    @Override
    protected void updateActionBar() {
<span class="nc bnc" id="L1413" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11322)) {</span>
<span class="nc" id="L1414">            super.updateActionBar();</span>
        }
<span class="nc bnc" id="L1416" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11323)) {</span>
<span class="nc" id="L1417">            updateScreenCounts();</span>
        }
<span class="nc" id="L1419">    }</span>

    protected void updateScreenCounts() {
<span class="nc bnc" id="L1422" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11324)) {</span>
<span class="nc bnc" id="L1423" title="All 2 branches missed.">            if (mCurrentCard == null)</span>
<span class="nc" id="L1424">                return;</span>
        }
<span class="nc bnc" id="L1426" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11325)) {</span>
<span class="nc" id="L1427">            super.updateActionBar();</span>
        }
<span class="nc" id="L1429">        ActionBar actionBar = getSupportActionBar();</span>
<span class="nc" id="L1430">        Counts counts = mSched.counts(mCurrentCard);</span>
<span class="nc bnc" id="L1431" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11333)) {</span>
<span class="nc bnc" id="L1432" title="All 2 branches missed.">            if (actionBar != null) {</span>
<span class="nc bnc" id="L1433" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11332)) {</span>
<span class="nc bnc" id="L1434" title="All 2 branches missed.">                    if (mPrefShowETA) {</span>
<span class="nc bnc" id="L1435" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11326)) {</span>
<span class="nc" id="L1436">                            eta = mSched.eta(counts, false);</span>
                        }
<span class="nc bnc" id="L1438" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11331)) {</span>
<span class="nc bnc" id="L1439" title="All 8 branches missed.">                            actionBar.setSubtitle(Utils.remainingTime(AnkiDroidApp.getInstance(), (ListenerUtil.mutListener.listen(11330) ? (eta % 60) : (ListenerUtil.mutListener.listen(11329) ? (eta / 60) : (ListenerUtil.mutListener.listen(11328) ? (eta - 60) : (ListenerUtil.mutListener.listen(11327) ? (eta + 60) : (eta * 60)))))));</span>
                        }
                    }
                }
            }
        }
<span class="nc bnc" id="L1445" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11334)) {</span>
<span class="nc" id="L1446">            newCount = new SpannableString(String.valueOf(counts.getNew()));</span>
        }
<span class="nc bnc" id="L1448" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11335)) {</span>
<span class="nc" id="L1449">            lrnCount = new SpannableString(String.valueOf(counts.getLrn()));</span>
        }
<span class="nc bnc" id="L1451" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11336)) {</span>
<span class="nc" id="L1452">            revCount = new SpannableString(String.valueOf(counts.getRev()));</span>
        }
<span class="nc bnc" id="L1454" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11338)) {</span>
<span class="nc bnc" id="L1455" title="All 2 branches missed.">            if (mPrefHideDueCount) {</span>
<span class="nc bnc" id="L1456" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11337)) {</span>
<span class="nc" id="L1457">                    revCount = new SpannableString(&quot;???&quot;);</span>
                }
            }
        }
<span class="nc bnc" id="L1461" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11343)) {</span>
<span class="nc bnc" id="L1462" title="All 4 branches missed.">            switch(mSched.countIdx(mCurrentCard)) {</span>
                case NEW:
<span class="nc bnc" id="L1464" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11339)) {</span>
<span class="nc" id="L1465">                        newCount.setSpan(new UnderlineSpan(), 0, newCount.length(), 0);</span>
                    }
                    break;
                case LRN:
<span class="nc bnc" id="L1469" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11340)) {</span>
<span class="nc" id="L1470">                        lrnCount.setSpan(new UnderlineSpan(), 0, lrnCount.length(), 0);</span>
                    }
                    break;
                case REV:
<span class="nc bnc" id="L1474" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11341)) {</span>
<span class="nc" id="L1475">                        revCount.setSpan(new UnderlineSpan(), 0, revCount.length(), 0);</span>
                    }
                    break;
                default:
<span class="nc bnc" id="L1479" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11342)) {</span>
<span class="nc" id="L1480">                        Timber.w(&quot;Unknown card type %s&quot;, mSched.countIdx(mCurrentCard));</span>
                    }
                    break;
            }
        }
<span class="nc bnc" id="L1485" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11344)) {</span>
<span class="nc" id="L1486">            mTextBarNew.setText(newCount);</span>
        }
<span class="nc bnc" id="L1488" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11345)) {</span>
<span class="nc" id="L1489">            mTextBarLearn.setText(lrnCount);</span>
        }
<span class="nc bnc" id="L1491" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11346)) {</span>
<span class="nc" id="L1492">            mTextBarReview.setText(revCount);</span>
        }
<span class="nc" id="L1494">    }</span>

    @Override
    public void fillFlashcard() {
<span class="nc bnc" id="L1498" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11347)) {</span>
<span class="nc" id="L1499">            super.fillFlashcard();</span>
        }
<span class="nc bnc" id="L1501" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11351)) {</span>
<span class="nc bnc" id="L1502" title="All 26 branches missed.">            if ((ListenerUtil.mutListener.listen(11349) ? ((ListenerUtil.mutListener.listen(11348) ? (!sDisplayAnswer || mShowWhiteboard) : (!sDisplayAnswer &amp;&amp; mShowWhiteboard)) || mWhiteboard != null) : ((ListenerUtil.mutListener.listen(11348) ? (!sDisplayAnswer || mShowWhiteboard) : (!sDisplayAnswer &amp;&amp; mShowWhiteboard)) &amp;&amp; mWhiteboard != null))) {</span>
<span class="nc bnc" id="L1503" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11350)) {</span>
<span class="nc" id="L1504">                    mWhiteboard.clear();</span>
                }
            }
        }
<span class="nc" id="L1508">    }</span>

    @Override
    public void displayCardQuestion() {
<span class="nc bnc" id="L1512" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11352)) {</span>
            // show timer, if activated in the deck's preferences
<span class="nc" id="L1514">            initTimer();</span>
        }
<span class="nc bnc" id="L1516" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11353)) {</span>
<span class="nc" id="L1517">            super.displayCardQuestion();</span>
        }
<span class="nc" id="L1519">    }</span>

    @Override
    protected void initLayout() {
<span class="nc bnc" id="L1523" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11354)) {</span>
<span class="nc" id="L1524">            mTextBarNew = findViewById(R.id.new_number);</span>
        }
<span class="nc bnc" id="L1526" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11355)) {</span>
<span class="nc" id="L1527">            mTextBarLearn = findViewById(R.id.learn_number);</span>
        }
<span class="nc bnc" id="L1529" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11356)) {</span>
<span class="nc" id="L1530">            mTextBarReview = findViewById(R.id.review_number);</span>
        }
<span class="nc bnc" id="L1532" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11357)) {</span>
<span class="nc" id="L1533">            super.initLayout();</span>
        }
<span class="nc bnc" id="L1535" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11361)) {</span>
<span class="nc bnc" id="L1536" title="All 2 branches missed.">            if (!mShowRemainingCardCount) {</span>
<span class="nc bnc" id="L1537" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11358)) {</span>
<span class="nc" id="L1538">                    mTextBarNew.setVisibility(View.GONE);</span>
                }
<span class="nc bnc" id="L1540" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11359)) {</span>
<span class="nc" id="L1541">                    mTextBarLearn.setVisibility(View.GONE);</span>
                }
<span class="nc bnc" id="L1543" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11360)) {</span>
<span class="nc" id="L1544">                    mTextBarReview.setVisibility(View.GONE);</span>
                }
            }
        }
<span class="nc" id="L1548">    }</span>

    @Override
    protected void switchTopBarVisibility(int visible) {
<span class="nc bnc" id="L1552" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11362)) {</span>
<span class="nc" id="L1553">            super.switchTopBarVisibility(visible);</span>
        }
<span class="nc bnc" id="L1555" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11366)) {</span>
<span class="nc bnc" id="L1556" title="All 2 branches missed.">            if (mShowRemainingCardCount) {</span>
<span class="nc bnc" id="L1557" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11363)) {</span>
<span class="nc" id="L1558">                    mTextBarNew.setVisibility(visible);</span>
                }
<span class="nc bnc" id="L1560" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11364)) {</span>
<span class="nc" id="L1561">                    mTextBarLearn.setVisibility(visible);</span>
                }
<span class="nc bnc" id="L1563" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11365)) {</span>
<span class="nc" id="L1564">                    mTextBarReview.setVisibility(visible);</span>
                }
            }
        }
<span class="nc" id="L1568">    }</span>

    @Override
    protected void onStop() {
<span class="nc bnc" id="L1572" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11367)) {</span>
<span class="nc" id="L1573">            super.onStop();</span>
        }
<span class="nc bnc" id="L1575" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11371)) {</span>
<span class="nc bnc" id="L1576" title="All 26 branches missed.">            if ((ListenerUtil.mutListener.listen(11369) ? ((ListenerUtil.mutListener.listen(11368) ? (!isFinishing() || colIsOpen()) : (!isFinishing() &amp;&amp; colIsOpen())) || mSched != null) : ((ListenerUtil.mutListener.listen(11368) ? (!isFinishing() || colIsOpen()) : (!isFinishing() &amp;&amp; colIsOpen())) &amp;&amp; mSched != null))) {</span>
<span class="nc bnc" id="L1577" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11370)) {</span>
<span class="nc" id="L1578">                    WidgetStatus.update(this);</span>
                }
            }
        }
<span class="nc bnc" id="L1582" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11372)) {</span>
<span class="nc" id="L1583">            UIUtils.saveCollectionInBackground();</span>
        }
<span class="nc" id="L1585">    }</span>

    @Override
    protected void initControls() {
<span class="nc bnc" id="L1589" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11373)) {</span>
<span class="nc" id="L1590">            super.initControls();</span>
        }
<span class="nc bnc" id="L1592" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11375)) {</span>
<span class="nc bnc" id="L1593" title="All 2 branches missed.">            if (mPrefWhiteboard) {</span>
<span class="nc bnc" id="L1594" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11374)) {</span>
<span class="nc" id="L1595">                    setWhiteboardVisibility(mShowWhiteboard);</span>
                }
            }
        }
<span class="nc bnc" id="L1599" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11379)) {</span>
<span class="nc bnc" id="L1600" title="All 2 branches missed.">            if (mShowRemainingCardCount) {</span>
<span class="nc bnc" id="L1601" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11376)) {</span>
<span class="nc" id="L1602">                    mTextBarNew.setVisibility(View.VISIBLE);</span>
                }
<span class="nc bnc" id="L1604" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11377)) {</span>
<span class="nc" id="L1605">                    mTextBarLearn.setVisibility(View.VISIBLE);</span>
                }
<span class="nc bnc" id="L1607" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11378)) {</span>
<span class="nc" id="L1608">                    mTextBarReview.setVisibility(View.VISIBLE);</span>
                }
            }
        }
<span class="nc" id="L1612">    }</span>

    protected void restoreCollectionPreferences() {
<span class="nc bnc" id="L1615" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11380)) {</span>
<span class="nc" id="L1616">            super.restoreCollectionPreferences();</span>
        }
<span class="nc bnc" id="L1618" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11381)) {</span>
<span class="nc" id="L1619">            mShowRemainingCardCount = getCol().getConf().getBoolean(&quot;dueCounts&quot;);</span>
        }
<span class="nc" id="L1621">    }</span>

    @Override
    protected boolean onSingleTap() {
<span class="nc bnc" id="L1625" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11384)) {</span>
<span class="nc bnc" id="L1626" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(11382) ? (mPrefFullscreenReview || isImmersiveSystemUiVisible(this)) : (mPrefFullscreenReview &amp;&amp; isImmersiveSystemUiVisible(this)))) {</span>
<span class="nc bnc" id="L1627" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11383)) {</span>
<span class="nc" id="L1628">                    delayedHide(INITIAL_HIDE_DELAY);</span>
                }
<span class="nc" id="L1630">                return true;</span>
            }
        }
<span class="nc" id="L1633">        return false;</span>
    }

    @Override
    protected void onFling() {
<span class="nc bnc" id="L1638" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11387)) {</span>
<span class="nc bnc" id="L1639" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(11385) ? (mPrefFullscreenReview || isImmersiveSystemUiVisible(this)) : (mPrefFullscreenReview &amp;&amp; isImmersiveSystemUiVisible(this)))) {</span>
<span class="nc bnc" id="L1640" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11386)) {</span>
<span class="nc" id="L1641">                    delayedHide(INITIAL_HIDE_DELAY);</span>
                }
            }
        }
<span class="nc" id="L1645">    }</span>

<span class="nc" id="L1647">    protected final Handler mFullScreenHandler = new Handler() {</span>

        @Override
        public void handleMessage(Message msg) {
<span class="nc bnc" id="L1651" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11389)) {</span>
<span class="nc bnc" id="L1652" title="All 2 branches missed.">                if (mPrefFullscreenReview) {</span>
<span class="nc bnc" id="L1653" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11388)) {</span>
<span class="nc" id="L1654">                        setFullScreen(Reviewer.this);</span>
                    }
                }
            }
<span class="nc" id="L1658">        }</span>
    };

    protected void delayedHide(int delayMillis) {
<span class="nc bnc" id="L1662" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11390)) {</span>
<span class="nc" id="L1663">            Timber.d(&quot;Fullscreen delayed hide in %dms&quot;, delayMillis);</span>
        }
<span class="nc bnc" id="L1665" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11391)) {</span>
<span class="nc" id="L1666">            mFullScreenHandler.removeMessages(0);</span>
        }
<span class="nc bnc" id="L1668" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11392)) {</span>
<span class="nc" id="L1669">            mFullScreenHandler.sendEmptyMessageDelayed(0, delayMillis);</span>
        }
<span class="nc" id="L1671">    }</span>

    private void setWhiteboardEnabledState(boolean state) {
<span class="nc bnc" id="L1674" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11393)) {</span>
<span class="nc" id="L1675">            mPrefWhiteboard = state;</span>
        }
<span class="nc bnc" id="L1677" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11394)) {</span>
<span class="nc" id="L1678">            MetaDB.storeWhiteboardState(this, getParentDid(), state);</span>
        }
<span class="nc bnc" id="L1680" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11397)) {</span>
<span class="nc bnc" id="L1681" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(11395) ? (state || mWhiteboard == null) : (state &amp;&amp; mWhiteboard == null))) {</span>
<span class="nc bnc" id="L1682" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11396)) {</span>
<span class="nc" id="L1683">                    createWhiteboard();</span>
                }
            }
        }
<span class="nc" id="L1687">    }</span>

    private static final int FULLSCREEN_ALL_GONE = 2;

    private void setFullScreen(final AbstractFlashcardViewer a) {
<span class="nc bnc" id="L1692" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11398)) {</span>
            // Set appropriate flags to enable Sticky Immersive mode.
<span class="nc" id="L1694">            a.getWindow().getDecorView().setSystemUiVisibility(View.SYSTEM_UI_FLAG_LAYOUT_STABLE | // | View.SYSTEM_UI_FLAG_LAYOUT_HIDE_NAVIGATION // temporarily disabled due to #5245</span>
            View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN | View.SYSTEM_UI_FLAG_HIDE_NAVIGATION | View.SYSTEM_UI_FLAG_FULLSCREEN | View.SYSTEM_UI_FLAG_LOW_PROFILE | View.SYSTEM_UI_FLAG_IMMERSIVE);
        }
        // Show / hide the Action bar together with the status bar
<span class="nc" id="L1698">        SharedPreferences prefs = AnkiDroidApp.getSharedPrefs(a);</span>
<span class="nc" id="L1699">        final int fullscreenMode = Integer.parseInt(prefs.getString(&quot;fullscreenMode&quot;, &quot;0&quot;));</span>
<span class="nc bnc" id="L1700" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11399)) {</span>
<span class="nc" id="L1701">            a.getWindow().setStatusBarColor(Themes.getColorFromAttr(a, R.attr.colorPrimaryDark));</span>
        }
<span class="nc" id="L1703">        View decorView = a.getWindow().getDecorView();</span>
<span class="nc bnc" id="L1704" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11400)) {</span>
<span class="nc" id="L1705">            decorView.setOnSystemUiVisibilityChangeListener(flags -&gt; {</span>
<span class="nc" id="L1706">                final View toolbar = a.findViewById(R.id.toolbar);</span>
<span class="nc" id="L1707">                final View answerButtons = a.findViewById(R.id.answer_options_layout);</span>
<span class="nc" id="L1708">                final View topbar = a.findViewById(R.id.top_bar);</span>
<span class="nc bnc" id="L1709" title="All 6 branches missed.">                if (toolbar == null || topbar == null || answerButtons == null) {</span>
<span class="nc" id="L1710">                    return;</span>
                }
                // LOW_PROFILE, HIDE_NAVIGATION, or FULLSCREEN flags are set.
<span class="nc bnc" id="L1713" title="All 2 branches missed.">                boolean visible = (flags &amp; View.SYSTEM_UI_FLAG_HIDE_NAVIGATION) == 0;</span>
<span class="nc" id="L1714">                Timber.d(&quot;System UI visibility change. Visible: %b&quot;, visible);</span>
<span class="nc bnc" id="L1715" title="All 2 branches missed.">                if (visible) {</span>
<span class="nc" id="L1716">                    showViewWithAnimation(toolbar);</span>
<span class="nc bnc" id="L1717" title="All 2 branches missed.">                    if (fullscreenMode &gt;= FULLSCREEN_ALL_GONE) {</span>
<span class="nc" id="L1718">                        showViewWithAnimation(topbar);</span>
<span class="nc" id="L1719">                        showViewWithAnimation(answerButtons);</span>
                    }
                } else {
<span class="nc" id="L1722">                    hideViewWithAnimation(toolbar);</span>
<span class="nc bnc" id="L1723" title="All 2 branches missed.">                    if (fullscreenMode &gt;= FULLSCREEN_ALL_GONE) {</span>
<span class="nc" id="L1724">                        hideViewWithAnimation(topbar);</span>
<span class="nc" id="L1725">                        hideViewWithAnimation(answerButtons);</span>
                    }
                }
<span class="nc" id="L1728">            });</span>
        }
<span class="nc" id="L1730">    }</span>

    private static final int ANIMATION_DURATION = 200;

    private static final float TRANSPARENCY = 0.90f;

    private void showViewWithAnimation(final View view) {
<span class="nc bnc" id="L1737" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11401)) {</span>
<span class="nc" id="L1738">            view.setAlpha(0.0f);</span>
        }
<span class="nc bnc" id="L1740" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11402)) {</span>
<span class="nc" id="L1741">            view.setVisibility(View.VISIBLE);</span>
        }
<span class="nc bnc" id="L1743" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11403)) {</span>
<span class="nc" id="L1744">            view.animate().alpha(TRANSPARENCY).setDuration(ANIMATION_DURATION).setListener(null);</span>
        }
<span class="nc" id="L1746">    }</span>

    private void hideViewWithAnimation(final View view) {
<span class="nc bnc" id="L1749" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11405)) {</span>
<span class="nc" id="L1750">            view.animate().alpha(0f).setDuration(ANIMATION_DURATION).setListener(new AnimatorListenerAdapter() {</span>

                @Override
                public void onAnimationEnd(Animator animation) {
<span class="nc bnc" id="L1754" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11404)) {</span>
<span class="nc" id="L1755">                        view.setVisibility(View.GONE);</span>
                    }
<span class="nc" id="L1757">                }</span>
            });
        }
<span class="nc" id="L1760">    }</span>

    private boolean isImmersiveSystemUiVisible(AnkiActivity activity) {
<span class="nc bnc" id="L1763" title="All 2 branches missed.">        return (activity.getWindow().getDecorView().getSystemUiVisibility() &amp; View.SYSTEM_UI_FLAG_HIDE_NAVIGATION) == 0;</span>
    }

    private void createWhiteboard() {
<span class="nc" id="L1767">        SharedPreferences sharedPrefs = AnkiDroidApp.getSharedPrefs(this);</span>
<span class="nc bnc" id="L1768" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11406)) {</span>
<span class="nc" id="L1769">            mWhiteboard = new Whiteboard(this, isInNightMode());</span>
        }
<span class="nc" id="L1771">        FrameLayout.LayoutParams lp2 = new FrameLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.MATCH_PARENT);</span>
<span class="nc bnc" id="L1772" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11407)) {</span>
<span class="nc" id="L1773">            mWhiteboard.setLayoutParams(lp2);</span>
        }
<span class="nc" id="L1775">        FrameLayout fl = findViewById(R.id.whiteboard);</span>
<span class="nc bnc" id="L1776" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11408)) {</span>
<span class="nc" id="L1777">            fl.addView(mWhiteboard);</span>
        }
        // This is how all other whiteboard settings are
<span class="nc" id="L1780">        Integer whiteboardPenColor = MetaDB.getWhiteboardPenColor(this, getParentDid()).fromPreferences(sharedPrefs);</span>
<span class="nc bnc" id="L1781" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11410)) {</span>
<span class="nc bnc" id="L1782" title="All 2 branches missed.">            if (whiteboardPenColor != null) {</span>
<span class="nc bnc" id="L1783" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11409)) {</span>
<span class="nc" id="L1784">                    mWhiteboard.setPenColor(whiteboardPenColor);</span>
                }
            }
        }
<span class="nc bnc" id="L1788" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11411)) {</span>
<span class="nc bnc" id="L1789" title="All 2 branches missed.">            mWhiteboard.setOnPaintColorChangeListener(color -&gt; MetaDB.storeWhiteboardPenColor(this, getParentDid(), !CardAppearance.isInNightMode(sharedPrefs), color));</span>
        }
<span class="nc bnc" id="L1791" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11412)) {</span>
<span class="nc" id="L1792">            mWhiteboard.setOnTouchListener((v, event) -&gt; {</span>
                // If the whiteboard is currently drawing, and triggers the system UI to show, we want to continue drawing.
<span class="nc bnc" id="L1794" title="All 8 branches missed.">                if (!mWhiteboard.isCurrentlyDrawing() &amp;&amp; (!mShowWhiteboard || (mPrefFullscreenReview &amp;&amp; isImmersiveSystemUiVisible(Reviewer.this)))) {</span>
                    // Bypass whiteboard listener when it's hidden or fullscreen immersive mode is temporarily suspended
<span class="nc" id="L1796">                    v.performClick();</span>
<span class="nc" id="L1797">                    return getGestureDetector().onTouchEvent(event);</span>
                }
<span class="nc" id="L1799">                return mWhiteboard.handleTouchEvent(event);</span>
            });
        }
<span class="nc bnc" id="L1802" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11413)) {</span>
<span class="nc" id="L1803">            mWhiteboard.setEnabled(true);</span>
        }
<span class="nc" id="L1805">    }</span>

    // Show or hide the whiteboard
    private void setWhiteboardVisibility(boolean state) {
<span class="nc bnc" id="L1809" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11414)) {</span>
<span class="nc" id="L1810">            mShowWhiteboard = state;</span>
        }
<span class="nc bnc" id="L1812" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11415)) {</span>
<span class="nc" id="L1813">            MetaDB.storeWhiteboardVisibility(this, getParentDid(), state);</span>
        }
<span class="nc bnc" id="L1815" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11421)) {</span>
<span class="nc bnc" id="L1816" title="All 2 branches missed.">            if (state) {</span>
<span class="nc bnc" id="L1817" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11419)) {</span>
<span class="nc" id="L1818">                    mWhiteboard.setVisibility(View.VISIBLE);</span>
                }
<span class="nc bnc" id="L1820" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11420)) {</span>
<span class="nc" id="L1821">                    disableDrawerSwipe();</span>
                }
            } else {
<span class="nc bnc" id="L1824" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11416)) {</span>
<span class="nc" id="L1825">                    mWhiteboard.setVisibility(View.GONE);</span>
                }
<span class="nc bnc" id="L1827" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11418)) {</span>
<span class="nc bnc" id="L1828" title="All 2 branches missed.">                    if (!mHasDrawerSwipeConflicts) {</span>
<span class="nc bnc" id="L1829" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11417)) {</span>
<span class="nc" id="L1830">                            enableDrawerSwipe();</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L1836">    }</span>

    private void disableDrawerSwipeOnConflicts() {
<span class="nc" id="L1839">        SharedPreferences preferences = AnkiDroidApp.getSharedPrefs(getBaseContext());</span>
<span class="nc" id="L1840">        boolean gesturesEnabled = AnkiDroidApp.initiateGestures(preferences);</span>
<span class="nc bnc" id="L1841" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11442)) {</span>
<span class="nc bnc" id="L1842" title="All 2 branches missed.">            if (gesturesEnabled) {</span>
<span class="nc" id="L1843">                int gestureSwipeUp = Integer.parseInt(preferences.getString(&quot;gestureSwipeUp&quot;, &quot;9&quot;));</span>
<span class="nc" id="L1844">                int gestureSwipeDown = Integer.parseInt(preferences.getString(&quot;gestureSwipeDown&quot;, &quot;0&quot;));</span>
<span class="nc" id="L1845">                int gestureSwipeRight = Integer.parseInt(preferences.getString(&quot;gestureSwipeRight&quot;, &quot;17&quot;));</span>
<span class="nc bnc" id="L1846" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11441)) {</span>
<span class="nc bnc" id="L1847" title="All 226 branches missed.">                    if ((ListenerUtil.mutListener.listen(11438) ? ((ListenerUtil.mutListener.listen(11432) ? ((ListenerUtil.mutListener.listen(11426) ? (gestureSwipeUp &gt;= COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11425) ? (gestureSwipeUp &lt;= COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11424) ? (gestureSwipeUp &gt; COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11423) ? (gestureSwipeUp &lt; COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11422) ? (gestureSwipeUp == COMMAND_NOTHING) : (gestureSwipeUp != COMMAND_NOTHING)))))) &amp;&amp; (ListenerUtil.mutListener.listen(11431) ? (gestureSwipeDown &gt;= COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11430) ? (gestureSwipeDown &lt;= COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11429) ? (gestureSwipeDown &gt; COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11428) ? (gestureSwipeDown &lt; COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11427) ? (gestureSwipeDown == COMMAND_NOTHING) : (gestureSwipeDown != COMMAND_NOTHING))))))) : ((ListenerUtil.mutListener.listen(11426) ? (gestureSwipeUp &gt;= COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11425) ? (gestureSwipeUp &lt;= COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11424) ? (gestureSwipeUp &gt; COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11423) ? (gestureSwipeUp &lt; COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11422) ? (gestureSwipeUp == COMMAND_NOTHING) : (gestureSwipeUp != COMMAND_NOTHING)))))) || (ListenerUtil.mutListener.listen(11431) ? (gestureSwipeDown &gt;= COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11430) ? (gestureSwipeDown &lt;= COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11429) ? (gestureSwipeDown &gt; COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11428) ? (gestureSwipeDown &lt; COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11427) ? (gestureSwipeDown == COMMAND_NOTHING) : (gestureSwipeDown != COMMAND_NOTHING)))))))) &amp;&amp; (ListenerUtil.mutListener.listen(11437) ? (gestureSwipeRight &gt;= COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11436) ? (gestureSwipeRight &lt;= COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11435) ? (gestureSwipeRight &gt; COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11434) ? (gestureSwipeRight &lt; COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11433) ? (gestureSwipeRight == COMMAND_NOTHING) : (gestureSwipeRight != COMMAND_NOTHING))))))) : ((ListenerUtil.mutListener.listen(11432) ? ((ListenerUtil.mutListener.listen(11426) ? (gestureSwipeUp &gt;= COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11425) ? (gestureSwipeUp &lt;= COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11424) ? (gestureSwipeUp &gt; COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11423) ? (gestureSwipeUp &lt; COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11422) ? (gestureSwipeUp == COMMAND_NOTHING) : (gestureSwipeUp != COMMAND_NOTHING)))))) &amp;&amp; (ListenerUtil.mutListener.listen(11431) ? (gestureSwipeDown &gt;= COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11430) ? (gestureSwipeDown &lt;= COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11429) ? (gestureSwipeDown &gt; COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11428) ? (gestureSwipeDown &lt; COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11427) ? (gestureSwipeDown == COMMAND_NOTHING) : (gestureSwipeDown != COMMAND_NOTHING))))))) : ((ListenerUtil.mutListener.listen(11426) ? (gestureSwipeUp &gt;= COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11425) ? (gestureSwipeUp &lt;= COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11424) ? (gestureSwipeUp &gt; COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11423) ? (gestureSwipeUp &lt; COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11422) ? (gestureSwipeUp == COMMAND_NOTHING) : (gestureSwipeUp != COMMAND_NOTHING)))))) || (ListenerUtil.mutListener.listen(11431) ? (gestureSwipeDown &gt;= COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11430) ? (gestureSwipeDown &lt;= COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11429) ? (gestureSwipeDown &gt; COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11428) ? (gestureSwipeDown &lt; COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11427) ? (gestureSwipeDown == COMMAND_NOTHING) : (gestureSwipeDown != COMMAND_NOTHING)))))))) || (ListenerUtil.mutListener.listen(11437) ? (gestureSwipeRight &gt;= COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11436) ? (gestureSwipeRight &lt;= COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11435) ? (gestureSwipeRight &gt; COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11434) ? (gestureSwipeRight &lt; COMMAND_NOTHING) : (ListenerUtil.mutListener.listen(11433) ? (gestureSwipeRight == COMMAND_NOTHING) : (gestureSwipeRight != COMMAND_NOTHING))))))))) {</span>
<span class="nc bnc" id="L1848" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11439)) {</span>
<span class="nc" id="L1849">                            mHasDrawerSwipeConflicts = true;</span>
                        }
<span class="nc bnc" id="L1851" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11440)) {</span>
<span class="nc" id="L1852">                            super.disableDrawerSwipe();</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L1858">    }</span>

    @Override
    protected Long getCurrentCardId() {
<span class="nc" id="L1862">        return mCurrentCard.getId();</span>
    }

    @Override
    public void onWindowFocusChanged(boolean hasFocus) {
<span class="nc bnc" id="L1867" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11443)) {</span>
<span class="nc" id="L1868">            super.onWindowFocusChanged(hasFocus);</span>
        }
<span class="nc bnc" id="L1870" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11446)) {</span>
            // Restore full screen once we regain focus
<span class="nc bnc" id="L1872" title="All 2 branches missed.">            if (hasFocus) {</span>
<span class="nc bnc" id="L1873" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11445)) {</span>
<span class="nc" id="L1874">                    delayedHide(INITIAL_HIDE_DELAY);</span>
                }
            } else {
<span class="nc bnc" id="L1877" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11444)) {</span>
<span class="nc" id="L1878">                    mFullScreenHandler.removeMessages(0);</span>
                }
            }
        }
<span class="nc" id="L1882">    }</span>

    /**
     * Whether or not dismiss note is available for current card and specified DismissType
     * @return true if there is another card of same note that could be dismissed
     */
    private boolean suspendNoteAvailable() {
<span class="nc bnc" id="L1889" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11448)) {</span>
<span class="nc bnc" id="L1890" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(11447) ? (mCurrentCard == null &amp;&amp; isControlBlocked()) : (mCurrentCard == null || isControlBlocked()))) {</span>
<span class="nc" id="L1891">                return false;</span>
            }
        }
        // whether there exists a sibling not buried.
<span class="nc bnc" id="L1895" title="All 2 branches missed.">        return getCol().getDb().queryScalar(&quot;select 1 from cards where nid = ? and id != ? and queue != &quot; + Consts.QUEUE_TYPE_SUSPENDED + &quot; limit 1&quot;, mCurrentCard.getNid(), mCurrentCard.getId()) == 1;</span>
    }

    private boolean buryNoteAvailable() {
<span class="nc bnc" id="L1899" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11450)) {</span>
<span class="nc bnc" id="L1900" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(11449) ? (mCurrentCard == null &amp;&amp; isControlBlocked()) : (mCurrentCard == null || isControlBlocked()))) {</span>
<span class="nc" id="L1901">                return false;</span>
            }
        }
        // Whether there exists a sibling which is neither susbended nor buried
<span class="nc bnc" id="L1905" title="All 2 branches missed.">        return getCol().getDb().queryScalar(&quot;select 1 from cards where nid = ? and id != ? and queue &gt;=  &quot; + Consts.QUEUE_TYPE_NEW + &quot; limit 1&quot;, mCurrentCard.getNid(), mCurrentCard.getId()) == 1;</span>
    }

    @VisibleForTesting(otherwise = VisibleForTesting.NONE)
    @CheckResult
    Whiteboard getWhiteboard() {
<span class="nc" id="L1911">        return mWhiteboard;</span>
    }

    /**
     * Inner class which implements the submenu for the Suspend button
     */
    class SuspendProvider extends ActionProvider implements SubMenuProvider {

<span class="nc" id="L1919">        public SuspendProvider(Context context) {</span>
<span class="nc" id="L1920">            super(context);</span>
<span class="nc" id="L1921">        }</span>

        @Override
        public View onCreateActionView() {
            // Just return null for a simple dropdown menu
<span class="nc" id="L1926">            return null;</span>
        }

        @Override
        public int getSubMenu() {
<span class="nc" id="L1931">            return R.menu.reviewer_suspend;</span>
        }

        @Override
        public boolean hasSubMenu() {
<span class="nc" id="L1936">            return suspendNoteAvailable();</span>
        }

        @Override
        public void onPrepareSubMenu(SubMenu subMenu) {
<span class="nc bnc" id="L1941" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11451)) {</span>
<span class="nc" id="L1942">                subMenu.clear();</span>
            }
<span class="nc bnc" id="L1944" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11452)) {</span>
<span class="nc" id="L1945">                getMenuInflater().inflate(getSubMenu(), subMenu);</span>
            }
<span class="nc bnc" id="L1947" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11459)) {</span>
                {
<span class="nc" id="L1949">                    long _loopCounter187 = 0;</span>
<span class="nc bnc" id="L1950" title="All 22 branches missed.">                    for (int i = 0; (ListenerUtil.mutListener.listen(11458) ? (i &gt;= subMenu.size()) : (ListenerUtil.mutListener.listen(11457) ? (i &lt;= subMenu.size()) : (ListenerUtil.mutListener.listen(11456) ? (i &gt; subMenu.size()) : (ListenerUtil.mutListener.listen(11455) ? (i != subMenu.size()) : (ListenerUtil.mutListener.listen(11454) ? (i == subMenu.size()) : (i &lt; subMenu.size())))))); i++) {</span>
<span class="nc" id="L1951">                        ListenerUtil.loopListener.listen(&quot;_loopCounter187&quot;, ++_loopCounter187);</span>
<span class="nc bnc" id="L1952" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11453)) {</span>
<span class="nc" id="L1953">                            subMenu.getItem(i).setOnMenuItemClickListener(this);</span>
                        }
                    }
                }
            }
<span class="nc" id="L1958">        }</span>

        @Override
        public boolean onMenuItemClick(MenuItem item) {
<span class="nc" id="L1962">            int itemId = item.getItemId();</span>
<span class="nc bnc" id="L1963" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11462)) {</span>
<span class="nc bnc" id="L1964" title="All 2 branches missed.">                if (itemId == R.id.action_suspend_card) {</span>
<span class="nc bnc" id="L1965" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11461)) {</span>
<span class="nc" id="L1966">                        dismiss(DismissType.SUSPEND_CARD);</span>
                    }
<span class="nc" id="L1968">                    return true;</span>
<span class="nc bnc" id="L1969" title="All 2 branches missed.">                } else if (itemId == R.id.action_suspend_note) {</span>
<span class="nc bnc" id="L1970" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11460)) {</span>
<span class="nc" id="L1971">                        dismiss(DismissType.SUSPEND_NOTE);</span>
                    }
<span class="nc" id="L1973">                    return true;</span>
                }
            }
<span class="nc" id="L1976">            return false;</span>
        }
    }

    /**
     * Inner class which implements the submenu for the Bury button
     */
    class BuryProvider extends ActionProvider implements SubMenuProvider {

<span class="nc" id="L1985">        public BuryProvider(Context context) {</span>
<span class="nc" id="L1986">            super(context);</span>
<span class="nc" id="L1987">        }</span>

        @Override
        public View onCreateActionView() {
            // Just return null for a simple dropdown menu
<span class="nc" id="L1992">            return null;</span>
        }

        @Override
        public int getSubMenu() {
<span class="nc" id="L1997">            return R.menu.reviewer_bury;</span>
        }

        @Override
        public boolean hasSubMenu() {
<span class="nc" id="L2002">            return buryNoteAvailable();</span>
        }

        @Override
        public void onPrepareSubMenu(SubMenu subMenu) {
<span class="nc bnc" id="L2007" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11463)) {</span>
<span class="nc" id="L2008">                subMenu.clear();</span>
            }
<span class="nc bnc" id="L2010" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11464)) {</span>
<span class="nc" id="L2011">                getMenuInflater().inflate(getSubMenu(), subMenu);</span>
            }
<span class="nc bnc" id="L2013" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11471)) {</span>
                {
<span class="nc" id="L2015">                    long _loopCounter188 = 0;</span>
<span class="nc bnc" id="L2016" title="All 22 branches missed.">                    for (int i = 0; (ListenerUtil.mutListener.listen(11470) ? (i &gt;= subMenu.size()) : (ListenerUtil.mutListener.listen(11469) ? (i &lt;= subMenu.size()) : (ListenerUtil.mutListener.listen(11468) ? (i &gt; subMenu.size()) : (ListenerUtil.mutListener.listen(11467) ? (i != subMenu.size()) : (ListenerUtil.mutListener.listen(11466) ? (i == subMenu.size()) : (i &lt; subMenu.size())))))); i++) {</span>
<span class="nc" id="L2017">                        ListenerUtil.loopListener.listen(&quot;_loopCounter188&quot;, ++_loopCounter188);</span>
<span class="nc bnc" id="L2018" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11465)) {</span>
<span class="nc" id="L2019">                            subMenu.getItem(i).setOnMenuItemClickListener(this);</span>
                        }
                    }
                }
            }
<span class="nc" id="L2024">        }</span>

        @Override
        public boolean onMenuItemClick(MenuItem item) {
<span class="nc" id="L2028">            int itemId = item.getItemId();</span>
<span class="nc bnc" id="L2029" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11474)) {</span>
<span class="nc bnc" id="L2030" title="All 2 branches missed.">                if (itemId == R.id.action_bury_card) {</span>
<span class="nc bnc" id="L2031" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11473)) {</span>
<span class="nc" id="L2032">                        dismiss(DismissType.BURY_CARD);</span>
                    }
<span class="nc" id="L2034">                    return true;</span>
<span class="nc bnc" id="L2035" title="All 2 branches missed.">                } else if (itemId == R.id.action_bury_note) {</span>
<span class="nc bnc" id="L2036" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11472)) {</span>
<span class="nc" id="L2037">                        dismiss(DismissType.BURY_NOTE);</span>
                    }
<span class="nc" id="L2039">                    return true;</span>
                }
            }
<span class="nc" id="L2042">            return false;</span>
        }
    }

    /**
     * Inner class which implements the submenu for the Schedule button
     */
    class ScheduleProvider extends ActionProvider implements SubMenuProvider {

<span class="nc" id="L2051">        public ScheduleProvider(Context context) {</span>
<span class="nc" id="L2052">            super(context);</span>
<span class="nc" id="L2053">        }</span>

        @Override
        public View onCreateActionView() {
            // Just return null for a simple dropdown menu
<span class="nc" id="L2058">            return null;</span>
        }

        @Override
        public boolean hasSubMenu() {
<span class="nc" id="L2063">            return true;</span>
        }

        @Override
        public void onPrepareSubMenu(SubMenu subMenu) {
<span class="nc bnc" id="L2068" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11475)) {</span>
<span class="nc" id="L2069">                subMenu.clear();</span>
            }
<span class="nc bnc" id="L2071" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11476)) {</span>
<span class="nc" id="L2072">                getMenuInflater().inflate(getSubMenu(), subMenu);</span>
            }
<span class="nc bnc" id="L2074" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11483)) {</span>
                {
<span class="nc" id="L2076">                    long _loopCounter189 = 0;</span>
<span class="nc bnc" id="L2077" title="All 22 branches missed.">                    for (int i = 0; (ListenerUtil.mutListener.listen(11482) ? (i &gt;= subMenu.size()) : (ListenerUtil.mutListener.listen(11481) ? (i &lt;= subMenu.size()) : (ListenerUtil.mutListener.listen(11480) ? (i &gt; subMenu.size()) : (ListenerUtil.mutListener.listen(11479) ? (i != subMenu.size()) : (ListenerUtil.mutListener.listen(11478) ? (i == subMenu.size()) : (i &lt; subMenu.size())))))); i++) {</span>
<span class="nc" id="L2078">                        ListenerUtil.loopListener.listen(&quot;_loopCounter189&quot;, ++_loopCounter189);</span>
<span class="nc bnc" id="L2079" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11477)) {</span>
<span class="nc" id="L2080">                            subMenu.getItem(i).setOnMenuItemClickListener(this);</span>
                        }
                    }
                }
            }
<span class="nc" id="L2085">        }</span>

        @Override
        public boolean onMenuItemClick(MenuItem item) {
<span class="nc" id="L2089">            int itemId = item.getItemId();</span>
<span class="nc bnc" id="L2090" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11486)) {</span>
<span class="nc bnc" id="L2091" title="All 2 branches missed.">                if (itemId == R.id.action_reschedule_card) {</span>
<span class="nc bnc" id="L2092" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11485)) {</span>
<span class="nc" id="L2093">                        showRescheduleCardDialog();</span>
                    }
<span class="nc" id="L2095">                    return true;</span>
<span class="nc bnc" id="L2096" title="All 2 branches missed.">                } else if (itemId == R.id.action_reset_card_progress) {</span>
<span class="nc bnc" id="L2097" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11484)) {</span>
<span class="nc" id="L2098">                        showResetCardDialog();</span>
                    }
<span class="nc" id="L2100">                    return true;</span>
                }
            }
<span class="nc" id="L2103">            return false;</span>
        }

        @Override
        public int getSubMenu() {
<span class="nc" id="L2108">            return R.menu.reviewer_schedule;</span>
        }
    }

    private interface SubMenuProvider extends MenuItem.OnMenuItemClickListener {

        @MenuRes
        int getSubMenu();

        boolean hasSubMenu();
    }

    public ReviewerJavaScriptFunction javaScriptFunction() {
<span class="nc" id="L2121">        return new ReviewerJavaScriptFunction();</span>
    }

<span class="nc" id="L2124">    public class ReviewerJavaScriptFunction extends JavaScriptFunction {</span>

        @JavascriptInterface
        @Override
        public String ankiGetNewCardCount() {
<span class="nc" id="L2129">            return newCount.toString();</span>
        }

        @JavascriptInterface
        @Override
        public String ankiGetLrnCardCount() {
<span class="nc" id="L2135">            return lrnCount.toString();</span>
        }

        @JavascriptInterface
        @Override
        public String ankiGetRevCardCount() {
<span class="nc" id="L2141">            return revCount.toString();</span>
        }

        @JavascriptInterface
        @Override
        public int ankiGetETA() {
<span class="nc" id="L2147">            return eta;</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>