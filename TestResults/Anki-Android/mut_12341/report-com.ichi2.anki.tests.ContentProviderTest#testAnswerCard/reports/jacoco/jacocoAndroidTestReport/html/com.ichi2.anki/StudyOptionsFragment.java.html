<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>StudyOptionsFragment.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">AnkiDroid</a> &gt; <a href="index.source.html" class="el_package">com.ichi2.anki</a> &gt; <span class="el_source">StudyOptionsFragment.java</span></div><h1>StudyOptionsFragment.java</h1><pre class="source lang-java linenums">/**
 * *************************************************************************************
 *  This program is free software; you can redistribute it and/or modify it under        *
 *  the terms of the GNU General Public License as published by the Free Software        *
 *  Foundation; either version 3 of the License, or (at your option) any later           *
 *  version.                                                                             *
 *                                                                                       *
 *  This program is distributed in the hope that it will be useful, but WITHOUT ANY      *
 *  WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A      *
 *  PARTICULAR PURPOSE. See the GNU General Public License for more details.             *
 *                                                                                       *
 *  You should have received a copy of the GNU General Public License along with         *
 *  this program. If not, see &lt;http://www.gnu.org/licenses/&gt;.                            *
 * **************************************************************************************
 */
package com.ichi2.anki;

import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.content.res.Resources;
import android.os.Bundle;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.annotation.VisibleForTesting;
import androidx.core.text.HtmlCompat;
import androidx.fragment.app.Fragment;
import androidx.appcompat.widget.Toolbar;
import android.text.Spanned;
import android.text.method.LinkMovementMethod;
import android.view.LayoutInflater;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Button;
import android.widget.TextView;
import com.afollestad.materialdialogs.MaterialDialog;
import com.ichi2.anim.ActivityTransitionAnimation;
import com.ichi2.anki.dialogs.CustomStudyDialog;
import com.ichi2.async.CollectionTask;
import com.ichi2.async.TaskListener;
import com.ichi2.async.TaskManager;
import com.ichi2.compat.CompatHelper;
import com.ichi2.libanki.Card;
import com.ichi2.libanki.Collection;
import com.ichi2.libanki.Consts;
import com.ichi2.libanki.Decks;
import com.ichi2.libanki.Utils;
import com.ichi2.libanki.Deck;
import com.ichi2.themes.StyledProgressDialog;
import com.ichi2.utils.BooleanGetter;
import com.ichi2.utils.HtmlUtils;
import timber.log.Timber;
import static com.ichi2.anim.ActivityTransitionAnimation.Direction.*;
import static com.ichi2.libanki.Consts.DECK_DYN;
import static com.ichi2.libanki.Consts.DECK_STD;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

<span class="nc" id="L60">public class StudyOptionsFragment extends Fragment implements Toolbar.OnMenuItemClickListener {</span>

    /**
     * Available options performed by other activities
     */
    private static final int BROWSE_CARDS = 3;

    private static final int STATISTICS = 4;

    private static final int DECK_OPTIONS = 5;

    /**
     * Constants for selecting which content view to display
     */
    private static final int CONTENT_STUDY_OPTIONS = 0;

    private static final int CONTENT_CONGRATS = 1;

    private static final int CONTENT_EMPTY = 2;

    // Threshold at which the total number of new cards is truncated by libanki
    private static final int NEW_CARD_COUNT_TRUNCATE_THRESHOLD = 99999;

    /**
     * Preferences
     */
<span class="nc" id="L86">    private int mCurrentContentView = CONTENT_STUDY_OPTIONS;</span>

    /**
     * Alerts to inform the user about different situations
     */
    private MaterialDialog mProgressDialog;

    /**
     * Whether we are closing in order to go to the reviewer. If it's the case, UPDATE_VALUES_FROM_DECK should not be
     *     cancelled as the counts will be used in review.
     */
<span class="nc" id="L97">    private boolean mToReviewer = false;</span>

    /**
     * UI elements for &quot;Study Options&quot; view
     */
    @Nullable
    private View mStudyOptionsView;

    private View mDeckInfoLayout;

    private Button mButtonStart;

    private TextView mTextDeckName;

    private TextView mTextDeckDescription;

    private TextView mTextTodayNew;

    private TextView mTextTodayLrn;

    private TextView mTextTodayRev;

    private TextView mTextNewTotal;

    private TextView mTextTotal;

    private TextView mTextETA;

    private TextView mTextCongratsMessage;

    private Toolbar mToolbar;

    // Flag to indicate if the fragment should load the deck options immediately after it loads
    private boolean mLoadWithDeckOptions;

    private boolean mFragmented;

<span class="nc" id="L134">    private Thread mFullNewCountThread = null;</span>

    private StudyOptionsListener mListener;

    /**
     * Callbacks for UI events
     */
<span class="nc" id="L141">    private final View.OnClickListener mButtonClickListener = v -&gt; {</span>
<span class="nc bnc" id="L142" title="All 2 branches missed.">        if (v.getId() == R.id.studyoptions_start) {</span>
<span class="nc" id="L143">            Timber.i(&quot;StudyOptionsFragment:: start study button pressed&quot;);</span>
<span class="nc bnc" id="L144" title="All 2 branches missed.">            if (mCurrentContentView != CONTENT_CONGRATS) {</span>
<span class="nc" id="L145">                openReviewer();</span>
            } else {
<span class="nc" id="L147">                showCustomStudyContextMenu();</span>
            }
        }
<span class="nc" id="L150">    };</span>

    public interface StudyOptionsListener {

        void onRequireDeckListUpdate();
    }

    @Override
    public void onAttach(@NonNull Context context) {
<span class="nc bnc" id="L159" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11744)) {</span>
<span class="nc" id="L160">            super.onAttach(context);</span>
        }
        try {
<span class="nc bnc" id="L163" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11745)) {</span>
<span class="nc" id="L164">                mListener = (StudyOptionsListener) context;</span>
            }
<span class="nc" id="L166">        } catch (ClassCastException e) {</span>
<span class="nc" id="L167">            throw new ClassCastException(context.toString() + &quot; must implement StudyOptionsListener&quot;);</span>
<span class="nc" id="L168">        }</span>
<span class="nc" id="L169">    }</span>

    private void openFilteredDeckOptions() {
<span class="nc bnc" id="L172" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11746)) {</span>
<span class="nc" id="L173">            openFilteredDeckOptions(false);</span>
        }
<span class="nc" id="L175">    }</span>

    /**
     * Open the FilteredDeckOptions activity to allow the user to modify the parameters of the
     * filtered deck.
     * @param defaultConfig If true, signals to the FilteredDeckOptions activity that the filtered
     *                      deck has no options associated with it yet and should use a default
     *                      set of values.
     */
    private void openFilteredDeckOptions(boolean defaultConfig) {
<span class="nc" id="L185">        Intent i = new Intent(getActivity(), FilteredDeckOptions.class);</span>
<span class="nc bnc" id="L186" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11747)) {</span>
<span class="nc" id="L187">            i.putExtra(&quot;defaultConfig&quot;, defaultConfig);</span>
        }
<span class="nc bnc" id="L189" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11748)) {</span>
<span class="nc" id="L190">            getActivity().startActivityForResult(i, DECK_OPTIONS);</span>
        }
<span class="nc bnc" id="L192" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11749)) {</span>
<span class="nc" id="L193">            ActivityTransitionAnimation.slide(getActivity(), FADE);</span>
        }
<span class="nc" id="L195">    }</span>

    /**
     * Get a new instance of the fragment.
     * @param withDeckOptions If true, the fragment will load a new activity on top of itself
     *                        which shows the current deck's options. Set to true when programmatically
     *                        opening a new filtered deck for the first time.
     */
    public static StudyOptionsFragment newInstance(boolean withDeckOptions) {
<span class="nc" id="L204">        StudyOptionsFragment f = new StudyOptionsFragment();</span>
<span class="nc" id="L205">        Bundle args = new Bundle();</span>
<span class="nc bnc" id="L206" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11750)) {</span>
<span class="nc" id="L207">            args.putBoolean(&quot;withDeckOptions&quot;, withDeckOptions);</span>
        }
<span class="nc bnc" id="L209" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11751)) {</span>
<span class="nc" id="L210">            f.setArguments(args);</span>
        }
<span class="nc" id="L212">        return f;</span>
    }

    @Override
    public void onCreate(@Nullable Bundle savedInstanceState) {
<span class="nc bnc" id="L217" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11752)) {</span>
<span class="nc" id="L218">            super.onCreate(savedInstanceState);</span>
        }
<span class="nc bnc" id="L220" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11755)) {</span>
            // If we're being restored, don't launch deck options again.
<span class="nc bnc" id="L222" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(11753) ? (savedInstanceState == null || getArguments() != null) : (savedInstanceState == null &amp;&amp; getArguments() != null))) {</span>
<span class="nc bnc" id="L223" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11754)) {</span>
<span class="nc" id="L224">                    mLoadWithDeckOptions = getArguments().getBoolean(&quot;withDeckOptions&quot;);</span>
                }
            }
        }
<span class="nc" id="L228">    }</span>

    @Override
    public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
<span class="nc bnc" id="L232" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11756)) {</span>
<span class="nc bnc" id="L233" title="All 2 branches missed.">            if (container == null) {</span>
                // Currently in a layout without a container, so no reason to create our view.
<span class="nc" id="L235">                return null;</span>
            }
        }
<span class="nc" id="L238">        View studyOptionsView = inflater.inflate(R.layout.studyoptions_fragment, container, false);</span>
<span class="nc bnc" id="L239" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11757)) {</span>
<span class="nc" id="L240">            mStudyOptionsView = studyOptionsView;</span>
        }
<span class="nc bnc" id="L242" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11758)) {</span>
<span class="nc bnc" id="L243" title="All 2 branches missed.">            mFragmented = getActivity().getClass() != StudyOptionsActivity.class;</span>
        }
<span class="nc bnc" id="L245" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11759)) {</span>
<span class="nc" id="L246">            initAllContentViews(studyOptionsView);</span>
        }
<span class="nc bnc" id="L248" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11760)) {</span>
<span class="nc" id="L249">            mToolbar = studyOptionsView.findViewById(R.id.studyOptionsToolbar);</span>
        }
<span class="nc bnc" id="L251" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11761)) {</span>
<span class="nc" id="L252">            mToolbar.inflateMenu(R.menu.study_options_fragment);</span>
        }
<span class="nc bnc" id="L254" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11763)) {</span>
<span class="nc bnc" id="L255" title="All 2 branches missed.">            if (mToolbar != null) {</span>
<span class="nc bnc" id="L256" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11762)) {</span>
<span class="nc" id="L257">                    configureToolbar();</span>
                }
            }
        }
<span class="nc bnc" id="L261" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11764)) {</span>
<span class="nc" id="L262">            refreshInterface(true);</span>
        }
<span class="nc" id="L264">        return studyOptionsView;</span>
    }

    @Override
    public void onDestroy() {
<span class="nc bnc" id="L269" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11765)) {</span>
<span class="nc" id="L270">            super.onDestroy();</span>
        }
<span class="nc bnc" id="L272" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11767)) {</span>
<span class="nc bnc" id="L273" title="All 2 branches missed.">            if (mFullNewCountThread != null) {</span>
<span class="nc bnc" id="L274" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11766)) {</span>
<span class="nc" id="L275">                    mFullNewCountThread.interrupt();</span>
                }
            }
        }
<span class="nc bnc" id="L279" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11768)) {</span>
<span class="nc" id="L280">            Timber.d(&quot;onDestroy()&quot;);</span>
        }
<span class="nc" id="L282">    }</span>

    @Override
    public void onResume() {
<span class="nc bnc" id="L286" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11769)) {</span>
<span class="nc" id="L287">            super.onResume();</span>
        }
<span class="nc bnc" id="L289" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11770)) {</span>
<span class="nc" id="L290">            Timber.d(&quot;onResume()&quot;);</span>
        }
<span class="nc bnc" id="L292" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11771)) {</span>
<span class="nc" id="L293">            refreshInterface(true);</span>
        }
<span class="nc" id="L295">    }</span>

    private void closeStudyOptions(int result) {
<span class="nc" id="L298">        Activity a = getActivity();</span>
<span class="nc bnc" id="L299" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11777)) {</span>
<span class="nc bnc" id="L300" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(11772) ? (!mFragmented || a != null) : (!mFragmented &amp;&amp; a != null))) {</span>
<span class="nc bnc" id="L301" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11774)) {</span>
<span class="nc" id="L302">                    a.setResult(result);</span>
                }
<span class="nc bnc" id="L304" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11775)) {</span>
<span class="nc" id="L305">                    a.finish();</span>
                }
<span class="nc bnc" id="L307" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11776)) {</span>
<span class="nc" id="L308">                    ActivityTransitionAnimation.slide(a, RIGHT);</span>
                }
<span class="nc bnc" id="L310" title="All 2 branches missed.">            } else if (a == null) {</span>
<span class="nc bnc" id="L311" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11773)) {</span>
                    // which is particularly relevant when using AsyncTasks.
<span class="nc" id="L313">                    Timber.e(&quot;closeStudyOptions() failed due to getActivity() returning null&quot;);</span>
                }
            }
        }
<span class="nc" id="L317">    }</span>

    private void openReviewer() {
<span class="nc" id="L320">        Intent reviewer = new Intent(getActivity(), Reviewer.class);</span>
<span class="nc bnc" id="L321" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11783)) {</span>
<span class="nc bnc" id="L322" title="All 2 branches missed.">            if (mFragmented) {</span>
<span class="nc bnc" id="L323" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11781)) {</span>
<span class="nc" id="L324">                    mToReviewer = true;</span>
                }
<span class="nc bnc" id="L326" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11782)) {</span>
<span class="nc" id="L327">                    getActivity().startActivityForResult(reviewer, AnkiActivity.REQUEST_REVIEW);</span>
                }
            } else {
<span class="nc bnc" id="L330" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11778)) {</span>
                    // Go to DeckPicker after studying when not tablet
<span class="nc" id="L332">                    reviewer.setFlags(Intent.FLAG_ACTIVITY_FORWARD_RESULT);</span>
                }
<span class="nc bnc" id="L334" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11779)) {</span>
<span class="nc" id="L335">                    startActivity(reviewer);</span>
                }
<span class="nc bnc" id="L337" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11780)) {</span>
<span class="nc" id="L338">                    getActivity().finish();</span>
                }
            }
        }
<span class="nc bnc" id="L342" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11784)) {</span>
<span class="nc" id="L343">            animateLeft();</span>
        }
<span class="nc" id="L345">    }</span>

    private void animateLeft() {
<span class="nc bnc" id="L348" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11785)) {</span>
<span class="nc" id="L349">            ActivityTransitionAnimation.slide(getActivity(), LEFT);</span>
        }
<span class="nc" id="L351">    }</span>

    private void initAllContentViews(@NonNull View studyOptionsView) {
<span class="nc bnc" id="L354" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11787)) {</span>
<span class="nc bnc" id="L355" title="All 2 branches missed.">            if (mFragmented) {</span>
<span class="nc bnc" id="L356" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11786)) {</span>
<span class="nc" id="L357">                    studyOptionsView.findViewById(R.id.studyoptions_gradient).setVisibility(View.VISIBLE);</span>
                }
            }
        }
<span class="nc bnc" id="L361" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11788)) {</span>
<span class="nc" id="L362">            mDeckInfoLayout = studyOptionsView.findViewById(R.id.studyoptions_deckinformation);</span>
        }
<span class="nc bnc" id="L364" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11789)) {</span>
<span class="nc" id="L365">            mTextDeckName = studyOptionsView.findViewById(R.id.studyoptions_deck_name);</span>
        }
<span class="nc bnc" id="L367" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11790)) {</span>
<span class="nc" id="L368">            mTextDeckDescription = studyOptionsView.findViewById(R.id.studyoptions_deck_description);</span>
        }
<span class="nc bnc" id="L370" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11791)) {</span>
            // make links clickable
<span class="nc" id="L372">            mTextDeckDescription.setMovementMethod(LinkMovementMethod.getInstance());</span>
        }
<span class="nc bnc" id="L374" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11792)) {</span>
<span class="nc" id="L375">            mButtonStart = studyOptionsView.findViewById(R.id.studyoptions_start);</span>
        }
<span class="nc bnc" id="L377" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11793)) {</span>
<span class="nc" id="L378">            mTextCongratsMessage = studyOptionsView.findViewById(R.id.studyoptions_congrats_message);</span>
        }
<span class="nc bnc" id="L380" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11794)) {</span>
            // Code common to both fragmented and non-fragmented view
<span class="nc" id="L382">            mTextTodayNew = studyOptionsView.findViewById(R.id.studyoptions_new);</span>
        }
<span class="nc bnc" id="L384" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11795)) {</span>
<span class="nc" id="L385">            mTextTodayLrn = studyOptionsView.findViewById(R.id.studyoptions_lrn);</span>
        }
<span class="nc bnc" id="L387" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11796)) {</span>
<span class="nc" id="L388">            mTextTodayRev = studyOptionsView.findViewById(R.id.studyoptions_rev);</span>
        }
<span class="nc bnc" id="L390" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11797)) {</span>
<span class="nc" id="L391">            mTextNewTotal = studyOptionsView.findViewById(R.id.studyoptions_total_new);</span>
        }
<span class="nc bnc" id="L393" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11798)) {</span>
<span class="nc" id="L394">            mTextTotal = studyOptionsView.findViewById(R.id.studyoptions_total);</span>
        }
<span class="nc bnc" id="L396" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11799)) {</span>
<span class="nc" id="L397">            mTextETA = studyOptionsView.findViewById(R.id.studyoptions_eta);</span>
        }
<span class="nc bnc" id="L399" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11800)) {</span>
<span class="nc" id="L400">            mButtonStart.setOnClickListener(mButtonClickListener);</span>
        }
<span class="nc" id="L402">    }</span>

    /**
     * Show the context menu for the custom study options
     */
    private void showCustomStudyContextMenu() {
<span class="nc" id="L408">        CustomStudyDialog d = CustomStudyDialog.newInstance(CustomStudyDialog.CONTEXT_MENU_STANDARD, getCol().getDecks().selected());</span>
<span class="nc bnc" id="L409" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11801)) {</span>
<span class="nc" id="L410">            ((AnkiActivity) getActivity()).showDialogFragment(d);</span>
        }
<span class="nc" id="L412">    }</span>

    void setFragmentContentView(View newView) {
<span class="nc" id="L415">        ViewGroup parent = (ViewGroup) this.getView();</span>
<span class="nc bnc" id="L416" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11802)) {</span>
<span class="nc" id="L417">            parent.removeAllViews();</span>
        }
<span class="nc bnc" id="L419" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11803)) {</span>
<span class="nc" id="L420">            parent.addView(newView);</span>
        }
<span class="nc" id="L422">    }</span>

<span class="nc" id="L424">    private final TaskListener&lt;Card, BooleanGetter&gt; undoListener = new TaskListener&lt;Card, BooleanGetter&gt;() {</span>

        @Override
        public void onPreExecute() {
<span class="nc" id="L428">        }</span>

        @Override
        public void onPostExecute(BooleanGetter v) {
<span class="nc bnc" id="L432" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11804)) {</span>
<span class="nc" id="L433">                openReviewer();</span>
            }
<span class="nc" id="L435">        }</span>
    };

    @Override
    public boolean onMenuItemClick(MenuItem item) {
<span class="nc" id="L440">        int itemId = item.getItemId();</span>
<span class="nc bnc" id="L441" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11827)) {</span>
<span class="nc bnc" id="L442" title="All 2 branches missed.">            if (itemId == R.id.action_undo) {</span>
<span class="nc bnc" id="L443" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11825)) {</span>
<span class="nc" id="L444">                    Timber.i(&quot;StudyOptionsFragment:: Undo button pressed&quot;);</span>
                }
<span class="nc bnc" id="L446" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11826)) {</span>
<span class="nc" id="L447">                    TaskManager.launchCollectionTask(new CollectionTask.Undo(), undoListener);</span>
                }
<span class="nc" id="L449">                return true;</span>
<span class="nc bnc" id="L450" title="All 2 branches missed.">            } else if (itemId == R.id.action_deck_or_study_options) {</span>
<span class="nc bnc" id="L451" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11820)) {</span>
<span class="nc" id="L452">                    Timber.i(&quot;StudyOptionsFragment:: Deck or study options button pressed&quot;);</span>
                }
<span class="nc bnc" id="L454" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11824)) {</span>
<span class="nc bnc" id="L455" title="All 2 branches missed.">                    if (getCol().getDecks().isDyn(getCol().getDecks().selected())) {</span>
<span class="nc bnc" id="L456" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11823)) {</span>
<span class="nc" id="L457">                            openFilteredDeckOptions();</span>
                        }
                    } else {
<span class="nc" id="L460">                        Intent i = new Intent(getActivity(), DeckOptions.class);</span>
<span class="nc bnc" id="L461" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11821)) {</span>
<span class="nc" id="L462">                            getActivity().startActivityForResult(i, DECK_OPTIONS);</span>
                        }
<span class="nc bnc" id="L464" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11822)) {</span>
<span class="nc" id="L465">                            ActivityTransitionAnimation.slide(getActivity(), FADE);</span>
                        }
                    }
                }
<span class="nc" id="L469">                return true;</span>
<span class="nc bnc" id="L470" title="All 2 branches missed.">            } else if (itemId == R.id.action_custom_study) {</span>
<span class="nc bnc" id="L471" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11818)) {</span>
<span class="nc" id="L472">                    Timber.i(&quot;StudyOptionsFragment:: custom study button pressed&quot;);</span>
                }
<span class="nc bnc" id="L474" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11819)) {</span>
<span class="nc" id="L475">                    showCustomStudyContextMenu();</span>
                }
<span class="nc" id="L477">                return true;</span>
<span class="nc bnc" id="L478" title="All 2 branches missed.">            } else if (itemId == R.id.action_unbury) {</span>
<span class="nc bnc" id="L479" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11814)) {</span>
<span class="nc" id="L480">                    Timber.i(&quot;StudyOptionsFragment:: unbury button pressed&quot;);</span>
                }
<span class="nc bnc" id="L482" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11815)) {</span>
<span class="nc" id="L483">                    getCol().getSched().unburyCardsForDeck();</span>
                }
<span class="nc bnc" id="L485" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11816)) {</span>
<span class="nc" id="L486">                    refreshInterfaceAndDecklist(true);</span>
                }
<span class="nc bnc" id="L488" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11817)) {</span>
<span class="nc" id="L489">                    item.setVisible(false);</span>
                }
<span class="nc" id="L491">                return true;</span>
<span class="nc bnc" id="L492" title="All 2 branches missed.">            } else if (itemId == R.id.action_rebuild) {</span>
<span class="nc bnc" id="L493" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11811)) {</span>
<span class="nc" id="L494">                    Timber.i(&quot;StudyOptionsFragment:: rebuild cram deck button pressed&quot;);</span>
                }
<span class="nc bnc" id="L496" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11812)) {</span>
<span class="nc" id="L497">                    mProgressDialog = StyledProgressDialog.show(getActivity(), &quot;&quot;, getResources().getString(R.string.rebuild_filtered_deck), true);</span>
                }
<span class="nc bnc" id="L499" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11813)) {</span>
<span class="nc" id="L500">                    TaskManager.launchCollectionTask(new CollectionTask.RebuildCram(), getCollectionTaskListener(true));</span>
                }
<span class="nc" id="L502">                return true;</span>
<span class="nc bnc" id="L503" title="All 2 branches missed.">            } else if (itemId == R.id.action_empty) {</span>
<span class="nc bnc" id="L504" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11808)) {</span>
<span class="nc" id="L505">                    Timber.i(&quot;StudyOptionsFragment:: empty cram deck button pressed&quot;);</span>
                }
<span class="nc bnc" id="L507" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11809)) {</span>
<span class="nc" id="L508">                    mProgressDialog = StyledProgressDialog.show(getActivity(), &quot;&quot;, getResources().getString(R.string.empty_filtered_deck), false);</span>
                }
<span class="nc bnc" id="L510" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11810)) {</span>
<span class="nc" id="L511">                    TaskManager.launchCollectionTask(new CollectionTask.EmptyCram(), getCollectionTaskListener(true));</span>
                }
<span class="nc" id="L513">                return true;</span>
<span class="nc bnc" id="L514" title="All 2 branches missed.">            } else if (itemId == R.id.action_rename) {</span>
<span class="nc bnc" id="L515" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11807)) {</span>
<span class="nc" id="L516">                    ((DeckPicker) getActivity()).renameDeckDialog(getCol().getDecks().selected());</span>
                }
<span class="nc" id="L518">                return true;</span>
<span class="nc bnc" id="L519" title="All 2 branches missed.">            } else if (itemId == R.id.action_delete) {</span>
<span class="nc bnc" id="L520" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11806)) {</span>
<span class="nc" id="L521">                    ((DeckPicker) getActivity()).confirmDeckDeletion(getCol().getDecks().selected());</span>
                }
<span class="nc" id="L523">                return true;</span>
<span class="nc bnc" id="L524" title="All 2 branches missed.">            } else if (itemId == R.id.action_export) {</span>
<span class="nc bnc" id="L525" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11805)) {</span>
<span class="nc" id="L526">                    ((DeckPicker) getActivity()).exportDeck(getCol().getDecks().selected());</span>
                }
<span class="nc" id="L528">                return true;</span>
            }
        }
<span class="nc" id="L531">        return false;</span>
    }

    public void configureToolbar() {
<span class="nc bnc" id="L535" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11828)) {</span>
<span class="nc" id="L536">            configureToolbarInternal(true);</span>
        }
<span class="nc" id="L538">    }</span>

    // caused by sync on startup where this might be running then have the collection close
    private void configureToolbarInternal(boolean recur) {
        try {
<span class="nc bnc" id="L543" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11837)) {</span>
<span class="nc" id="L544">                mToolbar.setOnMenuItemClickListener(this);</span>
            }
<span class="nc" id="L546">            Menu menu = mToolbar.getMenu();</span>
<span class="nc bnc" id="L547" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11846)) {</span>
                // Switch on or off rebuild/empty/custom study depending on whether or not filtered deck
<span class="nc bnc" id="L549" title="All 2 branches missed.">                if (getCol().getDecks().isDyn(getCol().getDecks().selected())) {</span>
<span class="nc bnc" id="L550" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11842)) {</span>
<span class="nc" id="L551">                        menu.findItem(R.id.action_rebuild).setVisible(true);</span>
                    }
<span class="nc bnc" id="L553" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11843)) {</span>
<span class="nc" id="L554">                        menu.findItem(R.id.action_empty).setVisible(true);</span>
                    }
<span class="nc bnc" id="L556" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11844)) {</span>
<span class="nc" id="L557">                        menu.findItem(R.id.action_custom_study).setVisible(false);</span>
                    }
<span class="nc bnc" id="L559" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11845)) {</span>
<span class="nc" id="L560">                        menu.findItem(R.id.action_deck_or_study_options).setTitle(R.string.menu__study_options);</span>
                    }
                } else {
<span class="nc bnc" id="L563" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11838)) {</span>
<span class="nc" id="L564">                        menu.findItem(R.id.action_rebuild).setVisible(false);</span>
                    }
<span class="nc bnc" id="L566" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11839)) {</span>
<span class="nc" id="L567">                        menu.findItem(R.id.action_empty).setVisible(false);</span>
                    }
<span class="nc bnc" id="L569" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11840)) {</span>
<span class="nc" id="L570">                        menu.findItem(R.id.action_custom_study).setVisible(true);</span>
                    }
<span class="nc bnc" id="L572" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11841)) {</span>
<span class="nc" id="L573">                        menu.findItem(R.id.action_deck_or_study_options).setTitle(R.string.menu__deck_options);</span>
                    }
                }
            }
<span class="nc bnc" id="L577" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11853)) {</span>
                // Don't show custom study icon if congrats shown
<span class="nc bnc" id="L579" title="All 22 branches missed.">                if ((ListenerUtil.mutListener.listen(11851) ? (mCurrentContentView &gt;= CONTENT_CONGRATS) : (ListenerUtil.mutListener.listen(11850) ? (mCurrentContentView &lt;= CONTENT_CONGRATS) : (ListenerUtil.mutListener.listen(11849) ? (mCurrentContentView &gt; CONTENT_CONGRATS) : (ListenerUtil.mutListener.listen(11848) ? (mCurrentContentView &lt; CONTENT_CONGRATS) : (ListenerUtil.mutListener.listen(11847) ? (mCurrentContentView != CONTENT_CONGRATS) : (mCurrentContentView == CONTENT_CONGRATS))))))) {</span>
<span class="nc bnc" id="L580" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11852)) {</span>
<span class="nc" id="L581">                        menu.findItem(R.id.action_custom_study).setVisible(false);</span>
                    }
                }
            }
<span class="nc bnc" id="L585" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11860)) {</span>
                // Switch on rename / delete / export if tablet layout
<span class="nc bnc" id="L587" title="All 2 branches missed.">                if (mFragmented) {</span>
<span class="nc bnc" id="L588" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11857)) {</span>
<span class="nc" id="L589">                        menu.findItem(R.id.action_rename).setVisible(true);</span>
                    }
<span class="nc bnc" id="L591" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11858)) {</span>
<span class="nc" id="L592">                        menu.findItem(R.id.action_delete).setVisible(true);</span>
                    }
<span class="nc bnc" id="L594" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11859)) {</span>
<span class="nc" id="L595">                        menu.findItem(R.id.action_export).setVisible(true);</span>
                    }
                } else {
<span class="nc bnc" id="L598" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11854)) {</span>
<span class="nc" id="L599">                        menu.findItem(R.id.action_rename).setVisible(false);</span>
                    }
<span class="nc bnc" id="L601" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11855)) {</span>
<span class="nc" id="L602">                        menu.findItem(R.id.action_delete).setVisible(false);</span>
                    }
<span class="nc bnc" id="L604" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11856)) {</span>
<span class="nc" id="L605">                        menu.findItem(R.id.action_export).setVisible(false);</span>
                    }
                }
            }
<span class="nc bnc" id="L609" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11861)) {</span>
                // Switch on or off unbury depending on if there are cards to unbury
<span class="nc" id="L611">                menu.findItem(R.id.action_unbury).setVisible(getCol().getSched().haveBuried());</span>
            }
<span class="nc bnc" id="L613" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11865)) {</span>
                // Switch on or off undo depending on whether undo is available
<span class="nc bnc" id="L615" title="All 2 branches missed.">                if (!getCol().undoAvailable()) {</span>
<span class="nc bnc" id="L616" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11864)) {</span>
<span class="nc" id="L617">                        menu.findItem(R.id.action_undo).setVisible(false);</span>
                    }
                } else {
<span class="nc bnc" id="L620" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11862)) {</span>
<span class="nc" id="L621">                        menu.findItem(R.id.action_undo).setVisible(true);</span>
                    }
<span class="nc" id="L623">                    Resources res = AnkiDroidApp.getAppResources();</span>
<span class="nc bnc" id="L624" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11863)) {</span>
<span class="nc" id="L625">                        menu.findItem(R.id.action_undo).setTitle(res.getString(R.string.studyoptions_congrats_undo, getCol().undoName(res)));</span>
                    }
                }
            }
<span class="nc bnc" id="L629" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11868)) {</span>
                // Set the back button listener
<span class="nc bnc" id="L631" title="All 2 branches missed.">                if (!mFragmented) {</span>
<span class="nc bnc" id="L632" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11866)) {</span>
<span class="nc" id="L633">                        mToolbar.setNavigationIcon(R.drawable.ic_arrow_back_white_24dp);</span>
                    }
<span class="nc bnc" id="L635" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11867)) {</span>
<span class="nc" id="L636">                        mToolbar.setNavigationOnClickListener(v -&gt; ((AnkiActivity) getActivity()).finishWithAnimation(RIGHT));</span>
                    }
                }
            }
<span class="nc" id="L640">        } catch (IllegalStateException e) {</span>
<span class="nc bnc" id="L641" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(11836)) {</span>
<span class="nc bnc" id="L642" title="All 2 branches missed.">                if (!CollectionHelper.getInstance().colIsOpen()) {</span>
<span class="nc bnc" id="L643" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11835)) {</span>
<span class="nc bnc" id="L644" title="All 2 branches missed.">                        if (recur) {</span>
<span class="nc bnc" id="L645" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11830)) {</span>
<span class="nc" id="L646">                                Timber.i(e, &quot;Database closed while working. Probably auto-sync. Will re-try after sleep.&quot;);</span>
                            }
                            try {
<span class="nc bnc" id="L649" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11833)) {</span>
<span class="nc" id="L650">                                    Thread.sleep(1000);</span>
                                }
<span class="nc" id="L652">                            } catch (InterruptedException ex) {</span>
<span class="nc bnc" id="L653" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11831)) {</span>
<span class="nc" id="L654">                                    Timber.i(ex, &quot;Thread interrupted while waiting to retry. Likely unimportant.&quot;);</span>
                                }
<span class="nc bnc" id="L656" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11832)) {</span>
<span class="nc" id="L657">                                    Thread.currentThread().interrupt();</span>
                                }
<span class="nc" id="L659">                            }</span>
<span class="nc bnc" id="L660" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11834)) {</span>
<span class="nc" id="L661">                                configureToolbarInternal(false);</span>
                            }
                        } else {
<span class="nc bnc" id="L664" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(11829)) {</span>
<span class="nc" id="L665">                                Timber.w(e, &quot;Database closed while working. No re-tries left.&quot;);</span>
                            }
                        }
                    }
                }
            }
<span class="nc" id="L671">        }</span>
<span class="nc" id="L672">    }</span>

    @Override
    public void onActivityResult(int requestCode, int resultCode, Intent intent) {
<span class="nc bnc" id="L676" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11869)) {</span>
<span class="nc" id="L677">            super.onActivityResult(requestCode, resultCode, intent);</span>
        }
<span class="nc bnc" id="L679" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11870)) {</span>
<span class="nc" id="L680">            Timber.d(&quot;onActivityResult (requestCode = %d, resultCode = %d)&quot;, requestCode, resultCode);</span>
        }
<span class="nc bnc" id="L682" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11871)) {</span>
            // rebuild action bar
<span class="nc" id="L684">            configureToolbar();</span>
        }
<span class="nc bnc" id="L686" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11884)) {</span>
            // boot back to deck picker if there was an error
<span class="nc bnc" id="L688" title="All 90 branches missed.">            if ((ListenerUtil.mutListener.listen(11882) ? ((ListenerUtil.mutListener.listen(11876) ? (resultCode &gt;= DeckPicker.RESULT_DB_ERROR) : (ListenerUtil.mutListener.listen(11875) ? (resultCode &lt;= DeckPicker.RESULT_DB_ERROR) : (ListenerUtil.mutListener.listen(11874) ? (resultCode &gt; DeckPicker.RESULT_DB_ERROR) : (ListenerUtil.mutListener.listen(11873) ? (resultCode &lt; DeckPicker.RESULT_DB_ERROR) : (ListenerUtil.mutListener.listen(11872) ? (resultCode != DeckPicker.RESULT_DB_ERROR) : (resultCode == DeckPicker.RESULT_DB_ERROR)))))) &amp;&amp; (ListenerUtil.mutListener.listen(11881) ? (resultCode &gt;= DeckPicker.RESULT_MEDIA_EJECTED) : (ListenerUtil.mutListener.listen(11880) ? (resultCode &lt;= DeckPicker.RESULT_MEDIA_EJECTED) : (ListenerUtil.mutListener.listen(11879) ? (resultCode &gt; DeckPicker.RESULT_MEDIA_EJECTED) : (ListenerUtil.mutListener.listen(11878) ? (resultCode &lt; DeckPicker.RESULT_MEDIA_EJECTED) : (ListenerUtil.mutListener.listen(11877) ? (resultCode != DeckPicker.RESULT_MEDIA_EJECTED) : (resultCode == DeckPicker.RESULT_MEDIA_EJECTED))))))) : ((ListenerUtil.mutListener.listen(11876) ? (resultCode &gt;= DeckPicker.RESULT_DB_ERROR) : (ListenerUtil.mutListener.listen(11875) ? (resultCode &lt;= DeckPicker.RESULT_DB_ERROR) : (ListenerUtil.mutListener.listen(11874) ? (resultCode &gt; DeckPicker.RESULT_DB_ERROR) : (ListenerUtil.mutListener.listen(11873) ? (resultCode &lt; DeckPicker.RESULT_DB_ERROR) : (ListenerUtil.mutListener.listen(11872) ? (resultCode != DeckPicker.RESULT_DB_ERROR) : (resultCode == DeckPicker.RESULT_DB_ERROR)))))) || (ListenerUtil.mutListener.listen(11881) ? (resultCode &gt;= DeckPicker.RESULT_MEDIA_EJECTED) : (ListenerUtil.mutListener.listen(11880) ? (resultCode &lt;= DeckPicker.RESULT_MEDIA_EJECTED) : (ListenerUtil.mutListener.listen(11879) ? (resultCode &gt; DeckPicker.RESULT_MEDIA_EJECTED) : (ListenerUtil.mutListener.listen(11878) ? (resultCode &lt; DeckPicker.RESULT_MEDIA_EJECTED) : (ListenerUtil.mutListener.listen(11877) ? (resultCode != DeckPicker.RESULT_MEDIA_EJECTED) : (resultCode == DeckPicker.RESULT_MEDIA_EJECTED))))))))) {</span>
<span class="nc bnc" id="L689" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11883)) {</span>
<span class="nc" id="L690">                    closeStudyOptions(resultCode);</span>
                }
<span class="nc" id="L692">                return;</span>
            }
        }
<span class="nc bnc" id="L695" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11898)) {</span>
            // perform some special actions depending on which activity we're returning from
<span class="nc bnc" id="L697" title="All 90 branches missed.">            if ((ListenerUtil.mutListener.listen(11895) ? ((ListenerUtil.mutListener.listen(11889) ? (requestCode &gt;= STATISTICS) : (ListenerUtil.mutListener.listen(11888) ? (requestCode &lt;= STATISTICS) : (ListenerUtil.mutListener.listen(11887) ? (requestCode &gt; STATISTICS) : (ListenerUtil.mutListener.listen(11886) ? (requestCode &lt; STATISTICS) : (ListenerUtil.mutListener.listen(11885) ? (requestCode != STATISTICS) : (requestCode == STATISTICS)))))) &amp;&amp; (ListenerUtil.mutListener.listen(11894) ? (requestCode &gt;= BROWSE_CARDS) : (ListenerUtil.mutListener.listen(11893) ? (requestCode &lt;= BROWSE_CARDS) : (ListenerUtil.mutListener.listen(11892) ? (requestCode &gt; BROWSE_CARDS) : (ListenerUtil.mutListener.listen(11891) ? (requestCode &lt; BROWSE_CARDS) : (ListenerUtil.mutListener.listen(11890) ? (requestCode != BROWSE_CARDS) : (requestCode == BROWSE_CARDS))))))) : ((ListenerUtil.mutListener.listen(11889) ? (requestCode &gt;= STATISTICS) : (ListenerUtil.mutListener.listen(11888) ? (requestCode &lt;= STATISTICS) : (ListenerUtil.mutListener.listen(11887) ? (requestCode &gt; STATISTICS) : (ListenerUtil.mutListener.listen(11886) ? (requestCode &lt; STATISTICS) : (ListenerUtil.mutListener.listen(11885) ? (requestCode != STATISTICS) : (requestCode == STATISTICS)))))) || (ListenerUtil.mutListener.listen(11894) ? (requestCode &gt;= BROWSE_CARDS) : (ListenerUtil.mutListener.listen(11893) ? (requestCode &lt;= BROWSE_CARDS) : (ListenerUtil.mutListener.listen(11892) ? (requestCode &gt; BROWSE_CARDS) : (ListenerUtil.mutListener.listen(11891) ? (requestCode &lt; BROWSE_CARDS) : (ListenerUtil.mutListener.listen(11890) ? (requestCode != BROWSE_CARDS) : (requestCode == BROWSE_CARDS))))))))) {</span>
<span class="nc bnc" id="L698" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11897)) {</span>
                    // which can change the selected deck
<span class="nc bnc" id="L700" title="All 2 branches missed.">                    if (intent.hasExtra(&quot;originalDeck&quot;)) {</span>
<span class="nc bnc" id="L701" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11896)) {</span>
<span class="nc" id="L702">                            getCol().getDecks().select(intent.getLongExtra(&quot;originalDeck&quot;, 0L));</span>
                        }
                    }
                }
            }
        }
<span class="nc bnc" id="L708" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11945)) {</span>
<span class="nc bnc" id="L709" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(11903) ? (requestCode &gt;= DECK_OPTIONS) : (ListenerUtil.mutListener.listen(11902) ? (requestCode &lt;= DECK_OPTIONS) : (ListenerUtil.mutListener.listen(11901) ? (requestCode &gt; DECK_OPTIONS) : (ListenerUtil.mutListener.listen(11900) ? (requestCode &lt; DECK_OPTIONS) : (ListenerUtil.mutListener.listen(11899) ? (requestCode != DECK_OPTIONS) : (requestCode == DECK_OPTIONS))))))) {</span>
<span class="nc bnc" id="L710" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11944)) {</span>
<span class="nc bnc" id="L711" title="All 2 branches missed.">                    if (mLoadWithDeckOptions) {</span>
<span class="nc bnc" id="L712" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11938)) {</span>
<span class="nc" id="L713">                            mLoadWithDeckOptions = false;</span>
                        }
<span class="nc" id="L715">                        Deck deck = getCol().getDecks().current();</span>
<span class="nc bnc" id="L716" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11941)) {</span>
<span class="nc bnc" id="L717" title="All 10 branches missed.">                            if ((ListenerUtil.mutListener.listen(11939) ? (deck.getInt(&quot;dyn&quot;) == DECK_DYN || deck.has(&quot;empty&quot;)) : (deck.getInt(&quot;dyn&quot;) == DECK_DYN &amp;&amp; deck.has(&quot;empty&quot;)))) {</span>
<span class="nc bnc" id="L718" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11940)) {</span>
<span class="nc" id="L719">                                    deck.remove(&quot;empty&quot;);</span>
                                }
                            }
                        }
<span class="nc bnc" id="L723" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11942)) {</span>
<span class="nc" id="L724">                            mProgressDialog = StyledProgressDialog.show(getActivity(), &quot;&quot;, getResources().getString(R.string.rebuild_filtered_deck), true);</span>
                        }
<span class="nc bnc" id="L726" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11943)) {</span>
<span class="nc" id="L727">                            TaskManager.launchCollectionTask(new CollectionTask.RebuildCram(), getCollectionTaskListener(true));</span>
                        }
<span class="nc" id="L729">                    } else {</span>
<span class="nc bnc" id="L730" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11936)) {</span>
<span class="nc" id="L731">                            TaskManager.waitToFinish();</span>
                        }
<span class="nc bnc" id="L733" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11937)) {</span>
<span class="nc" id="L734">                            refreshInterface(true);</span>
                        }
                    }
                }
<span class="nc bnc" id="L738" title="All 22 branches missed.">            } else if ((ListenerUtil.mutListener.listen(11908) ? (requestCode &gt;= AnkiActivity.REQUEST_REVIEW) : (ListenerUtil.mutListener.listen(11907) ? (requestCode &lt;= AnkiActivity.REQUEST_REVIEW) : (ListenerUtil.mutListener.listen(11906) ? (requestCode &gt; AnkiActivity.REQUEST_REVIEW) : (ListenerUtil.mutListener.listen(11905) ? (requestCode &lt; AnkiActivity.REQUEST_REVIEW) : (ListenerUtil.mutListener.listen(11904) ? (requestCode != AnkiActivity.REQUEST_REVIEW) : (requestCode == AnkiActivity.REQUEST_REVIEW))))))) {</span>
<span class="nc bnc" id="L739" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11935)) {</span>
<span class="nc bnc" id="L740" title="All 22 branches missed.">                    if ((ListenerUtil.mutListener.listen(11926) ? (resultCode &gt;= Reviewer.RESULT_NO_MORE_CARDS) : (ListenerUtil.mutListener.listen(11925) ? (resultCode &lt;= Reviewer.RESULT_NO_MORE_CARDS) : (ListenerUtil.mutListener.listen(11924) ? (resultCode &gt; Reviewer.RESULT_NO_MORE_CARDS) : (ListenerUtil.mutListener.listen(11923) ? (resultCode &lt; Reviewer.RESULT_NO_MORE_CARDS) : (ListenerUtil.mutListener.listen(11922) ? (resultCode != Reviewer.RESULT_NO_MORE_CARDS) : (resultCode == Reviewer.RESULT_NO_MORE_CARDS))))))) {</span>
<span class="nc bnc" id="L741" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11934)) {</span>
                            // If no more cards getting returned while counts &gt; 0 (due to learn ahead limit) then show a snackbar
<span class="nc bnc" id="L743" title="All 50 branches missed.">                            if ((ListenerUtil.mutListener.listen(11932) ? ((ListenerUtil.mutListener.listen(11931) ? (getCol().getSched().count() &gt;= 0) : (ListenerUtil.mutListener.listen(11930) ? (getCol().getSched().count() &lt;= 0) : (ListenerUtil.mutListener.listen(11929) ? (getCol().getSched().count() &lt; 0) : (ListenerUtil.mutListener.listen(11928) ? (getCol().getSched().count() != 0) : (ListenerUtil.mutListener.listen(11927) ? (getCol().getSched().count() == 0) : (getCol().getSched().count() &gt; 0)))))) || mStudyOptionsView != null) : ((ListenerUtil.mutListener.listen(11931) ? (getCol().getSched().count() &gt;= 0) : (ListenerUtil.mutListener.listen(11930) ? (getCol().getSched().count() &lt;= 0) : (ListenerUtil.mutListener.listen(11929) ? (getCol().getSched().count() &lt; 0) : (ListenerUtil.mutListener.listen(11928) ? (getCol().getSched().count() != 0) : (ListenerUtil.mutListener.listen(11927) ? (getCol().getSched().count() == 0) : (getCol().getSched().count() &gt; 0)))))) &amp;&amp; mStudyOptionsView != null))) {</span>
<span class="nc" id="L744">                                View rootLayout = mStudyOptionsView.findViewById(R.id.studyoptions_main);</span>
<span class="nc bnc" id="L745" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11933)) {</span>
<span class="nc" id="L746">                                    UIUtils.showSnackbar(getActivity(), R.string.studyoptions_no_cards_due, false, 0, null, rootLayout);</span>
                                }
<span class="nc" id="L748">                            }</span>
                        }
                    }
                }
<span class="nc bnc" id="L752" title="All 90 branches missed.">            } else if ((ListenerUtil.mutListener.listen(11919) ? ((ListenerUtil.mutListener.listen(11913) ? (requestCode &gt;= STATISTICS) : (ListenerUtil.mutListener.listen(11912) ? (requestCode &lt;= STATISTICS) : (ListenerUtil.mutListener.listen(11911) ? (requestCode &gt; STATISTICS) : (ListenerUtil.mutListener.listen(11910) ? (requestCode &lt; STATISTICS) : (ListenerUtil.mutListener.listen(11909) ? (requestCode != STATISTICS) : (requestCode == STATISTICS)))))) || (ListenerUtil.mutListener.listen(11918) ? (mCurrentContentView &gt;= CONTENT_CONGRATS) : (ListenerUtil.mutListener.listen(11917) ? (mCurrentContentView &lt;= CONTENT_CONGRATS) : (ListenerUtil.mutListener.listen(11916) ? (mCurrentContentView &gt; CONTENT_CONGRATS) : (ListenerUtil.mutListener.listen(11915) ? (mCurrentContentView &lt; CONTENT_CONGRATS) : (ListenerUtil.mutListener.listen(11914) ? (mCurrentContentView != CONTENT_CONGRATS) : (mCurrentContentView == CONTENT_CONGRATS))))))) : ((ListenerUtil.mutListener.listen(11913) ? (requestCode &gt;= STATISTICS) : (ListenerUtil.mutListener.listen(11912) ? (requestCode &lt;= STATISTICS) : (ListenerUtil.mutListener.listen(11911) ? (requestCode &gt; STATISTICS) : (ListenerUtil.mutListener.listen(11910) ? (requestCode &lt; STATISTICS) : (ListenerUtil.mutListener.listen(11909) ? (requestCode != STATISTICS) : (requestCode == STATISTICS)))))) &amp;&amp; (ListenerUtil.mutListener.listen(11918) ? (mCurrentContentView &gt;= CONTENT_CONGRATS) : (ListenerUtil.mutListener.listen(11917) ? (mCurrentContentView &lt;= CONTENT_CONGRATS) : (ListenerUtil.mutListener.listen(11916) ? (mCurrentContentView &gt; CONTENT_CONGRATS) : (ListenerUtil.mutListener.listen(11915) ? (mCurrentContentView &lt; CONTENT_CONGRATS) : (ListenerUtil.mutListener.listen(11914) ? (mCurrentContentView != CONTENT_CONGRATS) : (mCurrentContentView == CONTENT_CONGRATS))))))))) {</span>
<span class="nc bnc" id="L753" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11920)) {</span>
<span class="nc" id="L754">                    mCurrentContentView = CONTENT_STUDY_OPTIONS;</span>
                }
<span class="nc bnc" id="L756" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11921)) {</span>
<span class="nc" id="L757">                    setFragmentContentView(mStudyOptionsView);</span>
                }
            }
        }
<span class="nc" id="L761">    }</span>

    private void dismissProgressDialog() {
<span class="nc bnc" id="L764" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11948)) {</span>
<span class="nc bnc" id="L765" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(11946) ? (mStudyOptionsView != null || mStudyOptionsView.findViewById(R.id.progress_bar) != null) : (mStudyOptionsView != null &amp;&amp; mStudyOptionsView.findViewById(R.id.progress_bar) != null))) {</span>
<span class="nc bnc" id="L766" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11947)) {</span>
<span class="nc" id="L767">                    mStudyOptionsView.findViewById(R.id.progress_bar).setVisibility(View.GONE);</span>
                }
            }
        }
<span class="nc bnc" id="L771" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11952)) {</span>
            // for rebuilding cram decks
<span class="nc bnc" id="L773" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(11949) ? (mProgressDialog != null || mProgressDialog.isShowing()) : (mProgressDialog != null &amp;&amp; mProgressDialog.isShowing()))) {</span>
                try {
<span class="nc bnc" id="L775" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11951)) {</span>
<span class="nc" id="L776">                        mProgressDialog.dismiss();</span>
                    }
<span class="nc" id="L778">                } catch (Exception e) {</span>
<span class="nc bnc" id="L779" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(11950)) {</span>
<span class="nc" id="L780">                        Timber.e(&quot;onPostExecute - Dialog dismiss Exception = %s&quot;, e.getMessage());</span>
                    }
<span class="nc" id="L782">                }</span>
            }
        }
<span class="nc" id="L785">    }</span>

    private void refreshInterfaceAndDecklist(boolean resetSched) {
<span class="nc bnc" id="L788" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11953)) {</span>
<span class="nc" id="L789">            refreshInterface(resetSched, true);</span>
        }
<span class="nc" id="L791">    }</span>

    protected void refreshInterface() {
<span class="nc bnc" id="L794" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11954)) {</span>
<span class="nc" id="L795">            refreshInterface(false, false);</span>
        }
<span class="nc" id="L797">    }</span>

    protected void refreshInterface(boolean resetSched) {
<span class="nc bnc" id="L800" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11955)) {</span>
<span class="nc" id="L801">            refreshInterface(resetSched, false);</span>
        }
<span class="nc" id="L803">    }</span>

    /**
     * Rebuild the fragment's interface to reflect the status of the currently selected deck.
     *
     * @param resetSched    Indicates whether to rebuild the queues as well. Set to true for any
     *                      task that modifies queues (e.g., unbury or empty filtered deck).
     * @param resetDecklist Indicates whether to call back to the parent activity in order to
     *                      also refresh the deck list.
     */
    protected void refreshInterface(boolean resetSched, boolean resetDecklist) {
<span class="nc bnc" id="L814" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11956)) {</span>
<span class="nc" id="L815">            Timber.d(&quot;Refreshing StudyOptionsFragment&quot;);</span>
        }
<span class="nc bnc" id="L817" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11957)) {</span>
<span class="nc" id="L818">            TaskManager.cancelAllTasks(CollectionTask.UpdateValuesFromDeck.class);</span>
        }
<span class="nc bnc" id="L820" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(11958)) {</span>
            // Load the deck counts for the deck from Collection asynchronously
<span class="nc" id="L822">            TaskManager.launchCollectionTask(new CollectionTask.UpdateValuesFromDeck(resetSched), getCollectionTaskListener(resetDecklist));</span>
        }
<span class="nc" id="L824">    }</span>

    /**
     * Returns a listener that rebuilds the interface after execute.
     *
     * @param refreshDecklist If true, the listener notifies the parent activity to update its deck list
     *                        to reflect the latest values.
     */
    private TaskListener&lt;Void, int[]&gt; getCollectionTaskListener(final boolean refreshDecklist) {
<span class="nc" id="L833">        return new TaskListener&lt;Void, int[]&gt;() {</span>

            @Override
            public void onPreExecute() {
<span class="nc" id="L837">            }</span>

            @Override
            public void onPostExecute(int[] obj) {
<span class="nc bnc" id="L841" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(11959)) {</span>
<span class="nc" id="L842">                    dismissProgressDialog();</span>
                }
<span class="nc bnc" id="L844" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(12071)) {</span>
<span class="nc bnc" id="L845" title="All 2 branches missed.">                    if (obj != null) {</span>
                        // Get the return values back from the AsyncTask
<span class="nc" id="L847">                        int newCards = obj[0];</span>
<span class="nc" id="L848">                        int lrnCards = obj[1];</span>
<span class="nc" id="L849">                        int revCards = obj[2];</span>
<span class="nc" id="L850">                        int totalNew = obj[3];</span>
<span class="nc" id="L851">                        int totalCards = obj[4];</span>
<span class="nc" id="L852">                        int eta = obj[5];</span>
<span class="nc bnc" id="L853" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11961)) {</span>
                            // Don't do anything if the fragment is no longer attached to it's Activity or col has been closed
<span class="nc bnc" id="L855" title="All 2 branches missed.">                            if (getActivity() == null) {</span>
<span class="nc bnc" id="L856" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11960)) {</span>
<span class="nc" id="L857">                                    Timber.e(&quot;StudyOptionsFragment.mRefreshFragmentListener :: can't refresh&quot;);</span>
                                }
<span class="nc" id="L859">                                return;</span>
                            }
                        }
<span class="nc bnc" id="L862" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11963)) {</span>
                            // #5506 If we have no view, short circuit all UI logic
<span class="nc bnc" id="L864" title="All 2 branches missed.">                            if (mStudyOptionsView == null) {</span>
<span class="nc bnc" id="L865" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11962)) {</span>
<span class="nc" id="L866">                                    tryOpenCramDeckOptions();</span>
                                }
<span class="nc" id="L868">                                return;</span>
                            }
                        }
<span class="nc bnc" id="L871" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11964)) {</span>
                            // Reinitialize controls incase changed to filtered deck
<span class="nc" id="L873">                            initAllContentViews(mStudyOptionsView);</span>
                        }
                        // Set the deck name
<span class="nc" id="L876">                        Deck deck = getCol().getDecks().current();</span>
                        // Main deck name
<span class="nc" id="L878">                        String fullName = deck.getString(&quot;name&quot;);</span>
<span class="nc" id="L879">                        String[] name = Decks.path(fullName);</span>
<span class="nc" id="L880">                        StringBuilder nameBuilder = new StringBuilder();</span>
<span class="nc bnc" id="L881" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11971)) {</span>
<span class="nc bnc" id="L882" title="All 22 branches missed.">                            if ((ListenerUtil.mutListener.listen(11969) ? (name.length &gt;= 0) : (ListenerUtil.mutListener.listen(11968) ? (name.length &lt;= 0) : (ListenerUtil.mutListener.listen(11967) ? (name.length &lt; 0) : (ListenerUtil.mutListener.listen(11966) ? (name.length != 0) : (ListenerUtil.mutListener.listen(11965) ? (name.length == 0) : (name.length &gt; 0))))))) {</span>
<span class="nc bnc" id="L883" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11970)) {</span>
<span class="nc" id="L884">                                    nameBuilder.append(name[0]);</span>
                                }
                            }
                        }
<span class="nc bnc" id="L888" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11978)) {</span>
<span class="nc bnc" id="L889" title="All 22 branches missed.">                            if ((ListenerUtil.mutListener.listen(11976) ? (name.length &gt;= 1) : (ListenerUtil.mutListener.listen(11975) ? (name.length &lt;= 1) : (ListenerUtil.mutListener.listen(11974) ? (name.length &lt; 1) : (ListenerUtil.mutListener.listen(11973) ? (name.length != 1) : (ListenerUtil.mutListener.listen(11972) ? (name.length == 1) : (name.length &gt; 1))))))) {</span>
<span class="nc bnc" id="L890" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11977)) {</span>
<span class="nc" id="L891">                                    nameBuilder.append(&quot;\n&quot;).append(name[1]);</span>
                                }
                            }
                        }
<span class="nc bnc" id="L895" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11985)) {</span>
<span class="nc bnc" id="L896" title="All 22 branches missed.">                            if ((ListenerUtil.mutListener.listen(11983) ? (name.length &gt;= 3) : (ListenerUtil.mutListener.listen(11982) ? (name.length &lt;= 3) : (ListenerUtil.mutListener.listen(11981) ? (name.length &lt; 3) : (ListenerUtil.mutListener.listen(11980) ? (name.length != 3) : (ListenerUtil.mutListener.listen(11979) ? (name.length == 3) : (name.length &gt; 3))))))) {</span>
<span class="nc bnc" id="L897" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11984)) {</span>
<span class="nc" id="L898">                                    nameBuilder.append(&quot;...&quot;);</span>
                                }
                            }
                        }
<span class="nc bnc" id="L902" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11996)) {</span>
<span class="nc bnc" id="L903" title="All 22 branches missed.">                            if ((ListenerUtil.mutListener.listen(11990) ? (name.length &gt;= 2) : (ListenerUtil.mutListener.listen(11989) ? (name.length &lt;= 2) : (ListenerUtil.mutListener.listen(11988) ? (name.length &lt; 2) : (ListenerUtil.mutListener.listen(11987) ? (name.length != 2) : (ListenerUtil.mutListener.listen(11986) ? (name.length == 2) : (name.length &gt; 2))))))) {</span>
<span class="nc bnc" id="L904" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(11995)) {</span>
<span class="nc bnc" id="L905" title="All 8 branches missed.">                                    nameBuilder.append(&quot;\n&quot;).append(name[(ListenerUtil.mutListener.listen(11994) ? (name.length % 1) : (ListenerUtil.mutListener.listen(11993) ? (name.length / 1) : (ListenerUtil.mutListener.listen(11992) ? (name.length * 1) : (ListenerUtil.mutListener.listen(11991) ? (name.length + 1) : (name.length - 1)))))]);</span>
                                }
                            }
                        }
<span class="nc bnc" id="L909" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11997)) {</span>
<span class="nc" id="L910">                            mTextDeckName.setText(nameBuilder.toString());</span>
                        }
<span class="nc bnc" id="L912" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(11998)) {</span>
<span class="nc bnc" id="L913" title="All 2 branches missed.">                            if (tryOpenCramDeckOptions()) {</span>
<span class="nc" id="L914">                                return;</span>
                            }
                        }
                        // Switch between the empty view, the ordinary view, and the &quot;congratulations&quot; view
<span class="nc bnc" id="L918" title="All 2 branches missed.">                        boolean isDynamic = deck.optInt(&quot;dyn&quot;, DECK_STD) == DECK_DYN;</span>
<span class="nc bnc" id="L919" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(12036)) {</span>
<span class="nc bnc" id="L920" title="All 50 branches missed.">                            if ((ListenerUtil.mutListener.listen(12004) ? ((ListenerUtil.mutListener.listen(12003) ? (totalCards &gt;= 0) : (ListenerUtil.mutListener.listen(12002) ? (totalCards &lt;= 0) : (ListenerUtil.mutListener.listen(12001) ? (totalCards &gt; 0) : (ListenerUtil.mutListener.listen(12000) ? (totalCards &lt; 0) : (ListenerUtil.mutListener.listen(11999) ? (totalCards != 0) : (totalCards == 0)))))) || !isDynamic) : ((ListenerUtil.mutListener.listen(12003) ? (totalCards &gt;= 0) : (ListenerUtil.mutListener.listen(12002) ? (totalCards &lt;= 0) : (ListenerUtil.mutListener.listen(12001) ? (totalCards &gt; 0) : (ListenerUtil.mutListener.listen(12000) ? (totalCards &lt; 0) : (ListenerUtil.mutListener.listen(11999) ? (totalCards != 0) : (totalCards == 0)))))) &amp;&amp; !isDynamic))) {</span>
<span class="nc bnc" id="L921" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12031)) {</span>
<span class="nc" id="L922">                                    mCurrentContentView = CONTENT_EMPTY;</span>
                                }
<span class="nc bnc" id="L924" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12032)) {</span>
<span class="nc" id="L925">                                    mDeckInfoLayout.setVisibility(View.VISIBLE);</span>
                                }
<span class="nc bnc" id="L927" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12033)) {</span>
<span class="nc" id="L928">                                    mTextCongratsMessage.setVisibility(View.VISIBLE);</span>
                                }
<span class="nc bnc" id="L930" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12034)) {</span>
<span class="nc" id="L931">                                    mTextCongratsMessage.setText(R.string.studyoptions_empty);</span>
                                }
<span class="nc bnc" id="L933" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12035)) {</span>
<span class="nc" id="L934">                                    mButtonStart.setVisibility(View.GONE);</span>
                                }
<span class="nc bnc" id="L936" title="All 310 branches missed.">                            } else if ((ListenerUtil.mutListener.listen(12017) ? ((ListenerUtil.mutListener.listen(12012) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) % revCards) : (ListenerUtil.mutListener.listen(12011) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) / revCards) : (ListenerUtil.mutListener.listen(12010) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) * revCards) : (ListenerUtil.mutListener.listen(12009) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) - revCards) : ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) + revCards))))) &gt;= 0) : (ListenerUtil.mutListener.listen(12016) ? ((ListenerUtil.mutListener.listen(12012) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) % revCards) : (ListenerUtil.mutListener.listen(12011) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) / revCards) : (ListenerUtil.mutListener.listen(12010) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) * revCards) : (ListenerUtil.mutListener.listen(12009) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) - revCards) : ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) + revCards))))) &lt;= 0) : (ListenerUtil.mutListener.listen(12015) ? ((ListenerUtil.mutListener.listen(12012) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) % revCards) : (ListenerUtil.mutListener.listen(12011) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) / revCards) : (ListenerUtil.mutListener.listen(12010) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) * revCards) : (ListenerUtil.mutListener.listen(12009) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) - revCards) : ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) + revCards))))) &gt; 0) : (ListenerUtil.mutListener.listen(12014) ? ((ListenerUtil.mutListener.listen(12012) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) % revCards) : (ListenerUtil.mutListener.listen(12011) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) / revCards) : (ListenerUtil.mutListener.listen(12010) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) * revCards) : (ListenerUtil.mutListener.listen(12009) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) - revCards) : ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) + revCards))))) &lt; 0) : (ListenerUtil.mutListener.listen(12013) ? ((ListenerUtil.mutListener.listen(12012) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) % revCards) : (ListenerUtil.mutListener.listen(12011) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) / revCards) : (ListenerUtil.mutListener.listen(12010) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) * revCards) : (ListenerUtil.mutListener.listen(12009) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) - revCards) : ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) + revCards))))) != 0) : ((ListenerUtil.mutListener.listen(12012) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) % revCards) : (ListenerUtil.mutListener.listen(12011) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) / revCards) : (ListenerUtil.mutListener.listen(12010) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) * revCards) : (ListenerUtil.mutListener.listen(12009) ? ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) - revCards) : ((ListenerUtil.mutListener.listen(12008) ? (newCards % lrnCards) : (ListenerUtil.mutListener.listen(12007) ? (newCards / lrnCards) : (ListenerUtil.mutListener.listen(12006) ? (newCards * lrnCards) : (ListenerUtil.mutListener.listen(12005) ? (newCards - lrnCards) : (newCards + lrnCards))))) + revCards))))) == 0))))))) {</span>
<span class="nc bnc" id="L937" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12023)) {</span>
<span class="nc" id="L938">                                    mCurrentContentView = CONTENT_CONGRATS;</span>
                                }
<span class="nc bnc" id="L940" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12028)) {</span>
<span class="nc bnc" id="L941" title="All 2 branches missed.">                                    if (!isDynamic) {</span>
<span class="nc bnc" id="L942" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(12025)) {</span>
<span class="nc" id="L943">                                            mDeckInfoLayout.setVisibility(View.GONE);</span>
                                        }
<span class="nc bnc" id="L945" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(12026)) {</span>
<span class="nc" id="L946">                                            mButtonStart.setVisibility(View.VISIBLE);</span>
                                        }
<span class="nc bnc" id="L948" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(12027)) {</span>
<span class="nc" id="L949">                                            mButtonStart.setText(R.string.custom_study);</span>
                                        }
                                    } else {
<span class="nc bnc" id="L952" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(12024)) {</span>
<span class="nc" id="L953">                                            mButtonStart.setVisibility(View.GONE);</span>
                                        }
                                    }
                                }
<span class="nc bnc" id="L957" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12029)) {</span>
<span class="nc" id="L958">                                    mTextCongratsMessage.setVisibility(View.VISIBLE);</span>
                                }
<span class="nc bnc" id="L960" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12030)) {</span>
<span class="nc" id="L961">                                    mTextCongratsMessage.setText(getCol().getSched().finishedMsg(getActivity()));</span>
                                }
                            } else {
<span class="nc bnc" id="L964" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12018)) {</span>
<span class="nc" id="L965">                                    mCurrentContentView = CONTENT_STUDY_OPTIONS;</span>
                                }
<span class="nc bnc" id="L967" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12019)) {</span>
<span class="nc" id="L968">                                    mDeckInfoLayout.setVisibility(View.VISIBLE);</span>
                                }
<span class="nc bnc" id="L970" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12020)) {</span>
<span class="nc" id="L971">                                    mTextCongratsMessage.setVisibility(View.GONE);</span>
                                }
<span class="nc bnc" id="L973" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12021)) {</span>
<span class="nc" id="L974">                                    mButtonStart.setVisibility(View.VISIBLE);</span>
                                }
<span class="nc bnc" id="L976" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12022)) {</span>
<span class="nc" id="L977">                                    mButtonStart.setText(R.string.studyoptions_start);</span>
                                }
                            }
                        }
                        // Set deck description
                        String desc;
<span class="nc bnc" id="L983" title="All 2 branches missed.">                        if (isDynamic) {</span>
<span class="nc" id="L984">                            desc = getResources().getString(R.string.dyn_deck_desc);</span>
                        } else {
<span class="nc" id="L986">                            desc = getCol().getDecks().getActualDescription();</span>
                        }
<span class="nc bnc" id="L988" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(12045)) {</span>
<span class="nc bnc" id="L989" title="All 22 branches missed.">                            if ((ListenerUtil.mutListener.listen(12041) ? (desc.length() &gt;= 0) : (ListenerUtil.mutListener.listen(12040) ? (desc.length() &lt;= 0) : (ListenerUtil.mutListener.listen(12039) ? (desc.length() &lt; 0) : (ListenerUtil.mutListener.listen(12038) ? (desc.length() != 0) : (ListenerUtil.mutListener.listen(12037) ? (desc.length() == 0) : (desc.length() &gt; 0))))))) {</span>
<span class="nc bnc" id="L990" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12043)) {</span>
<span class="nc" id="L991">                                    mTextDeckDescription.setText(formatDescription(desc));</span>
                                }
<span class="nc bnc" id="L993" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12044)) {</span>
<span class="nc" id="L994">                                    mTextDeckDescription.setVisibility(View.VISIBLE);</span>
                                }
                            } else {
<span class="nc bnc" id="L997" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12042)) {</span>
<span class="nc" id="L998">                                    mTextDeckDescription.setVisibility(View.GONE);</span>
                                }
                            }
                        }
<span class="nc bnc" id="L1002" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(12046)) {</span>
                            // Set new/learn/review card counts
<span class="nc" id="L1004">                            mTextTodayNew.setText(String.valueOf(newCards));</span>
                        }
<span class="nc bnc" id="L1006" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(12047)) {</span>
<span class="nc" id="L1007">                            mTextTodayLrn.setText(String.valueOf(lrnCards));</span>
                        }
<span class="nc bnc" id="L1009" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(12048)) {</span>
<span class="nc" id="L1010">                            mTextTodayRev.setText(String.valueOf(revCards));</span>
                        }
<span class="nc bnc" id="L1012" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(12060)) {</span>
                            // Set the total number of new cards in deck
<span class="nc bnc" id="L1014" title="All 22 branches missed.">                            if ((ListenerUtil.mutListener.listen(12053) ? (totalNew &gt;= NEW_CARD_COUNT_TRUNCATE_THRESHOLD) : (ListenerUtil.mutListener.listen(12052) ? (totalNew &lt;= NEW_CARD_COUNT_TRUNCATE_THRESHOLD) : (ListenerUtil.mutListener.listen(12051) ? (totalNew &gt; NEW_CARD_COUNT_TRUNCATE_THRESHOLD) : (ListenerUtil.mutListener.listen(12050) ? (totalNew != NEW_CARD_COUNT_TRUNCATE_THRESHOLD) : (ListenerUtil.mutListener.listen(12049) ? (totalNew == NEW_CARD_COUNT_TRUNCATE_THRESHOLD) : (totalNew &lt; NEW_CARD_COUNT_TRUNCATE_THRESHOLD))))))) {</span>
<span class="nc bnc" id="L1015" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12059)) {</span>
                                    // if it hasn't been truncated by libanki then just set it usually
<span class="nc" id="L1017">                                    mTextNewTotal.setText(String.valueOf(totalNew));</span>
                                }
                            } else {
<span class="nc bnc" id="L1020" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12054)) {</span>
                                    // if truncated then make a thread to allow full count to load
<span class="nc" id="L1022">                                    mTextNewTotal.setText(&quot;&gt;1000&quot;);</span>
                                }
<span class="nc bnc" id="L1024" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12056)) {</span>
<span class="nc bnc" id="L1025" title="All 2 branches missed.">                                    if (mFullNewCountThread != null) {</span>
<span class="nc bnc" id="L1026" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(12055)) {</span>
                                            // a thread was previously made -- interrupt it
<span class="nc" id="L1028">                                            mFullNewCountThread.interrupt();</span>
                                        }
                                    }
                                }
<span class="nc bnc" id="L1032" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12057)) {</span>
<span class="nc" id="L1033">                                    mFullNewCountThread = new Thread(() -&gt; {</span>
<span class="nc" id="L1034">                                        Collection collection = getCol();</span>
                                        // TODO: refactor code to not rewrite this query, add to Sched.totalNewForCurrentDeck()
<span class="nc" id="L1036">                                        String query = &quot;SELECT count(*) FROM cards WHERE did IN &quot; + Utils.ids2str(collection.getDecks().active()) + &quot; AND queue = &quot; + Consts.QUEUE_TYPE_NEW;</span>
<span class="nc" id="L1037">                                        final int fullNewCount = collection.getDb().queryScalar(query);</span>
<span class="nc bnc" id="L1038" title="All 2 branches missed.">                                        if (fullNewCount &gt; 0) {</span>
<span class="nc" id="L1039">                                            Runnable setNewTotalText = () -&gt; mTextNewTotal.setText(String.valueOf(fullNewCount));</span>
<span class="nc bnc" id="L1040" title="All 2 branches missed.">                                            if (!Thread.currentThread().isInterrupted()) {</span>
<span class="nc" id="L1041">                                                mTextNewTotal.post(setNewTotalText);</span>
                                            }
                                        }
<span class="nc" id="L1044">                                    });</span>
                                }
<span class="nc bnc" id="L1046" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12058)) {</span>
<span class="nc" id="L1047">                                    mFullNewCountThread.start();</span>
                                }
                            }
                        }
<span class="nc bnc" id="L1051" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(12061)) {</span>
                            // Set total number of cards
<span class="nc" id="L1053">                            mTextTotal.setText(String.valueOf(totalCards));</span>
                        }
<span class="nc bnc" id="L1055" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(12069)) {</span>
                            // Set estimated time remaining
<span class="nc bnc" id="L1057" title="All 22 branches missed.">                            if ((ListenerUtil.mutListener.listen(12066) ? (eta &gt;= -1) : (ListenerUtil.mutListener.listen(12065) ? (eta &lt;= -1) : (ListenerUtil.mutListener.listen(12064) ? (eta &gt; -1) : (ListenerUtil.mutListener.listen(12063) ? (eta &lt; -1) : (ListenerUtil.mutListener.listen(12062) ? (eta == -1) : (eta != -1))))))) {</span>
<span class="nc bnc" id="L1058" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12068)) {</span>
<span class="nc" id="L1059">                                    mTextETA.setText(Integer.toString(eta));</span>
                                }
                            } else {
<span class="nc bnc" id="L1062" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(12067)) {</span>
<span class="nc" id="L1063">                                    mTextETA.setText(&quot;-&quot;);</span>
                                }
                            }
                        }
<span class="nc bnc" id="L1067" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(12070)) {</span>
                            // Rebuild the options menu
<span class="nc" id="L1069">                            configureToolbar();</span>
                        }
                    }
                }
<span class="nc bnc" id="L1073" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(12074)) {</span>
                    // If in fragmented mode, refresh the deck list
<span class="nc bnc" id="L1075" title="All 10 branches missed.">                    if ((ListenerUtil.mutListener.listen(12072) ? (mFragmented || refreshDecklist) : (mFragmented &amp;&amp; refreshDecklist))) {</span>
<span class="nc bnc" id="L1076" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(12073)) {</span>
<span class="nc" id="L1077">                            mListener.onRequireDeckListUpdate();</span>
                        }
                    }
                }
<span class="nc" id="L1081">            }</span>
        };
    }

    /**
     * Open cram deck option if deck is opened for the first time
     * @return Whether we opened the deck options
     */
    private boolean tryOpenCramDeckOptions() {
<span class="nc bnc" id="L1090" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(12075)) {</span>
<span class="nc bnc" id="L1091" title="All 2 branches missed.">            if (!mLoadWithDeckOptions) {</span>
<span class="nc" id="L1092">                return false;</span>
            }
        }
<span class="nc bnc" id="L1095" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(12076)) {</span>
<span class="nc" id="L1096">            openFilteredDeckOptions(true);</span>
        }
<span class="nc bnc" id="L1098" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(12077)) {</span>
<span class="nc" id="L1099">            mLoadWithDeckOptions = false;</span>
        }
<span class="nc" id="L1101">        return true;</span>
    }

    @VisibleForTesting()
    static Spanned formatDescription(String desc) {
        // Since we don't currently execute the JS/CSS, it's not worth displaying.
<span class="nc" id="L1107">        String withStrippedTags = Utils.stripHTMLScriptAndStyleTags(desc);</span>
        // #5188 - fromHtml displays newlines as &quot; &quot;
<span class="nc" id="L1109">        String withFixedNewlines = HtmlUtils.convertNewlinesToHtml(withStrippedTags);</span>
<span class="nc" id="L1110">        return HtmlCompat.fromHtml(withFixedNewlines, HtmlCompat.FROM_HTML_MODE_LEGACY);</span>
    }

    private Collection getCol() {
<span class="nc" id="L1114">        return CollectionHelper.getInstance().getCol(getContext());</span>
    }

    @Override
    public void onPause() {
<span class="nc bnc" id="L1119" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(12078)) {</span>
<span class="nc" id="L1120">            super.onPause();</span>
        }
<span class="nc bnc" id="L1122" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(12080)) {</span>
<span class="nc bnc" id="L1123" title="All 2 branches missed.">            if (!mToReviewer) {</span>
<span class="nc bnc" id="L1124" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(12079)) {</span>
                    // deck) cancel counts.
<span class="nc" id="L1126">                    TaskManager.cancelAllTasks(CollectionTask.UpdateValuesFromDeck.class);</span>
                }
            }
        }
<span class="nc" id="L1130">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>