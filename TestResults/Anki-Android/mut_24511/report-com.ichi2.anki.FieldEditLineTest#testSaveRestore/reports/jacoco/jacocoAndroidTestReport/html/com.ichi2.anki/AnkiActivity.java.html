<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AnkiActivity.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">AnkiDroid</a> &gt; <a href="index.source.html" class="el_package">com.ichi2.anki</a> &gt; <span class="el_source">AnkiActivity.java</span></div><h1>AnkiActivity.java</h1><pre class="source lang-java linenums">package com.ichi2.anki;

import android.app.Activity;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.content.ActivityNotFoundException;
import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.graphics.BitmapFactory;
import android.graphics.Color;
import android.media.AudioManager;
import android.net.Uri;
import android.os.Bundle;
import androidx.annotation.Nullable;
import androidx.appcompat.widget.Toolbar;
import androidx.browser.customtabs.CustomTabColorSchemeParams;
import androidx.browser.customtabs.CustomTabsIntent;
import androidx.fragment.app.DialogFragment;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.fragment.app.FragmentTransaction;
import androidx.core.app.NotificationCompat;
import androidx.core.content.ContextCompat;
import androidx.appcompat.app.AppCompatActivity;

import android.util.Log;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.view.ViewGroup.LayoutParams;
import android.view.WindowManager;
import android.view.animation.Animation;
import android.widget.ProgressBar;
import com.ichi2.anim.ActivityTransitionAnimation;
import com.ichi2.anki.analytics.UsageAnalytics;
import com.ichi2.anki.dialogs.AsyncDialogFragment;
import com.ichi2.anki.dialogs.DialogHandler;
import com.ichi2.anki.dialogs.SimpleMessageDialog;
import com.ichi2.async.CollectionLoader;
import com.ichi2.compat.customtabs.CustomTabActivityHelper;
import com.ichi2.compat.customtabs.CustomTabsFallback;
import com.ichi2.compat.customtabs.CustomTabsHelper;
import com.ichi2.libanki.Collection;
import com.ichi2.themes.Themes;
import com.ichi2.utils.AdaptionUtil;
import com.ichi2.utils.AndroidUiUtils;
import timber.log.Timber;
import static com.ichi2.anim.ActivityTransitionAnimation.Direction.*;
import static com.ichi2.anim.ActivityTransitionAnimation.Direction;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

public class AnkiActivity extends AppCompatActivity implements SimpleMessageDialog.SimpleMessageDialogListener {

<span class="fc" id="L55">    public final int SIMPLE_NOTIFICATION_ID = 0;</span>

    public static final int REQUEST_REVIEW = 901;

    /**
     * The name of the parent class (Reviewer)
     */
    private final String mActivityName;

<span class="fc" id="L64">    private final DialogHandler mHandler = new DialogHandler(this);</span>

    // custom tabs
    private CustomTabActivityHelper mCustomTabActivityHelper;

    public AnkiActivity() {
<span class="fc" id="L70">        super();</span>
<span class="fc" id="L71">        this.mActivityName = getClass().getSimpleName();</span>
<span class="fc" id="L72">    }</span>

    @Override
    protected void onCreate(@Nullable Bundle savedInstanceState) {
<span class="pc bpc" id="L76" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5581)) {</span>
<span class="fc" id="L77">            Timber.i(&quot;AnkiActivity::onCreate - %s&quot;, mActivityName);</span>
        }
<span class="pc bpc" id="L79" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5582)) {</span>
            // The hardware buttons should control the music volume
<span class="fc" id="L81">            setVolumeControlStream(AudioManager.STREAM_MUSIC);</span>
        }
<span class="pc bpc" id="L83" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5583)) {</span>
            // Set the theme
<span class="fc" id="L85">            Themes.setTheme(this);</span>
        }
<span class="pc bpc" id="L87" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5584)) {</span>
<span class="fc" id="L88">            super.onCreate(savedInstanceState);</span>
        }
<span class="pc bpc" id="L90" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5586)) {</span>
            // Disable the notifications bar if running under the test monkey.
<span class="pc bpc" id="L92" title="1 of 2 branches missed.">            if (AdaptionUtil.isUserATestClient()) {</span>
<span class="nc bnc" id="L93" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5585)) {</span>
<span class="nc" id="L94">                    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);</span>
                }
            }
        }
<span class="pc bpc" id="L98" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5587)) {</span>
<span class="fc" id="L99">            mCustomTabActivityHelper = new CustomTabActivityHelper();</span>
        }
<span class="fc" id="L101">    }</span>

    @Override
    protected void attachBaseContext(Context base) {
<span class="pc bpc" id="L105" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5588)) {</span>
<span class="fc" id="L106">            super.attachBaseContext(AnkiDroidApp.updateContextWithLanguage(base));</span>
        }
<span class="fc" id="L108">    }</span>

    @Override
    protected void onStart() {
<span class="pc bpc" id="L112" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5589)) {</span>
<span class="fc" id="L113">            Timber.i(&quot;AnkiActivity::onStart - %s&quot;, mActivityName);</span>
        }
<span class="pc bpc" id="L115" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5590)) {</span>
<span class="fc" id="L116">            super.onStart();</span>
        }
<span class="pc bpc" id="L118" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5591)) {</span>
<span class="fc" id="L119">            mCustomTabActivityHelper.bindCustomTabsService(this);</span>
        }
<span class="fc" id="L121">    }</span>

    @Override
    protected void onStop() {
<span class="pc bpc" id="L125" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5592)) {</span>
<span class="fc" id="L126">            Timber.i(&quot;AnkiActivity::onStop - %s&quot;, mActivityName);</span>
        }
<span class="pc bpc" id="L128" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5593)) {</span>
<span class="fc" id="L129">            super.onStop();</span>
        }
<span class="pc bpc" id="L131" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5594)) {</span>
<span class="fc" id="L132">            mCustomTabActivityHelper.unbindCustomTabsService(this);</span>
        }
<span class="fc" id="L134">    }</span>

    @Override
    protected void onPause() {
<span class="pc bpc" id="L138" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5595)) {</span>
<span class="fc" id="L139">            Timber.i(&quot;AnkiActivity::onPause - %s&quot;, mActivityName);</span>
        }
<span class="pc bpc" id="L141" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5596)) {</span>
<span class="fc" id="L142">            super.onPause();</span>
        }
<span class="fc" id="L144">    }</span>

    @Override
    protected void onResume() {
<span class="pc bpc" id="L148" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5597)) {</span>
<span class="fc" id="L149">            Timber.i(&quot;AnkiActivity::onResume - %s&quot;, mActivityName);</span>
        }
<span class="pc bpc" id="L151" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5598)) {</span>
<span class="fc" id="L152">            super.onResume();</span>
        }
<span class="pc bpc" id="L154" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5599)) {</span>
<span class="fc" id="L155">            UsageAnalytics.sendAnalyticsScreenView(this);</span>
        }
<span class="pc bpc" id="L157" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5600)) {</span>
<span class="fc" id="L158">            ((NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE)).cancel(SIMPLE_NOTIFICATION_ID);</span>
        }
<span class="pc bpc" id="L160" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5601)) {</span>
            // Show any pending dialogs which were stored persistently
<span class="fc" id="L162">            mHandler.readMessage();</span>
        }
<span class="fc" id="L164">    }</span>

    @Override
    protected void onDestroy() {
<span class="pc bpc" id="L168" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5602)) {</span>
<span class="fc" id="L169">            Timber.i(&quot;AnkiActivity::onDestroy - %s&quot;, mActivityName);</span>
        }
<span class="pc bpc" id="L171" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5603)) {</span>
<span class="fc" id="L172">            super.onDestroy();</span>
        }
<span class="fc" id="L174">    }</span>

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
<span class="nc bnc" id="L178" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5606)) {</span>
<span class="nc bnc" id="L179" title="All 2 branches missed.">            if (item.getItemId() == android.R.id.home) {</span>
<span class="nc bnc" id="L180" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5604)) {</span>
<span class="nc" id="L181">                    Timber.i(&quot;Home button pressed&quot;);</span>
                }
<span class="nc bnc" id="L183" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5605)) {</span>
<span class="nc" id="L184">                    finishWithoutAnimation();</span>
                }
<span class="nc" id="L186">                return true;</span>
            }
        }
<span class="nc" id="L189">        return super.onOptionsItemSelected(item);</span>
    }

    // called when the CollectionLoader finishes... usually will be over-ridden
    protected void onCollectionLoaded(Collection col) {
<span class="pc bpc" id="L194" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5607)) {</span>
<span class="fc" id="L195">            hideProgressBar();</span>
        }
<span class="fc" id="L197">    }</span>

    public Collection getCol() {
<span class="fc" id="L200">        return CollectionHelper.getInstance().getCol(this);</span>
    }

    public boolean colIsOpen() {
<span class="fc" id="L204">        return CollectionHelper.getInstance().colIsOpen();</span>
    }

    public boolean animationDisabled() {
<span class="fc" id="L208">        SharedPreferences preferences = AnkiDroidApp.getSharedPrefs(this);</span>
<span class="fc" id="L209">        return preferences.getBoolean(&quot;safeDisplay&quot;, false);</span>
    }

    public boolean animationEnabled() {
<span class="pc bpc" id="L213" title="1 of 2 branches missed.">        return !animationDisabled();</span>
    }

    @Override
    public void setContentView(View view) {
<span class="nc bnc" id="L218" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5609)) {</span>
<span class="nc bnc" id="L219" title="All 2 branches missed.">            if (animationDisabled()) {</span>
<span class="nc bnc" id="L220" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5608)) {</span>
<span class="nc" id="L221">                    view.clearAnimation();</span>
                }
            }
        }
<span class="nc bnc" id="L225" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5610)) {</span>
<span class="nc" id="L226">            super.setContentView(view);</span>
        }
<span class="nc" id="L228">    }</span>

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
<span class="pc bpc" id="L232" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5618)) {</span>
            // We can't access the icons yet on a TV, so show them all in the menu
<span class="pc bpc" id="L234" title="1 of 2 branches missed.">            if (AndroidUiUtils.isRunningOnTv(this)) {</span>
<span class="nc bnc" id="L235" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5617)) {</span>
                    {
<span class="nc" id="L237">                        long _loopCounter105 = 0;</span>
<span class="nc bnc" id="L238" title="All 22 branches missed.">                        for (int i = 0; (ListenerUtil.mutListener.listen(5616) ? (i &gt;= menu.size()) : (ListenerUtil.mutListener.listen(5615) ? (i &lt;= menu.size()) : (ListenerUtil.mutListener.listen(5614) ? (i &gt; menu.size()) : (ListenerUtil.mutListener.listen(5613) ? (i != menu.size()) : (ListenerUtil.mutListener.listen(5612) ? (i == menu.size()) : (i &lt; menu.size())))))); i++) {</span>
<span class="nc" id="L239">                            ListenerUtil.loopListener.listen(&quot;_loopCounter105&quot;, ++_loopCounter105);</span>
<span class="nc bnc" id="L240" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(5611)) {</span>
<span class="nc" id="L241">                                menu.getItem(i).setShowAsAction(MenuItem.SHOW_AS_ACTION_NEVER);</span>
                            }
                        }
                    }
                }
            }
        }
<span class="fc" id="L248">        return super.onCreateOptionsMenu(menu);</span>
    }

    @Override
    public void setContentView(View view, LayoutParams params) {
<span class="nc bnc" id="L253" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5620)) {</span>
<span class="nc bnc" id="L254" title="All 2 branches missed.">            if (animationDisabled()) {</span>
<span class="nc bnc" id="L255" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5619)) {</span>
<span class="nc" id="L256">                    view.clearAnimation();</span>
                }
            }
        }
<span class="nc bnc" id="L260" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5621)) {</span>
<span class="nc" id="L261">            super.setContentView(view, params);</span>
        }
<span class="nc" id="L263">    }</span>

    @Override
    public void addContentView(View view, LayoutParams params) {
<span class="nc bnc" id="L267" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5623)) {</span>
<span class="nc bnc" id="L268" title="All 2 branches missed.">            if (animationDisabled()) {</span>
<span class="nc bnc" id="L269" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5622)) {</span>
<span class="nc" id="L270">                    view.clearAnimation();</span>
                }
            }
        }
<span class="nc bnc" id="L274" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5624)) {</span>
<span class="nc" id="L275">            super.addContentView(view, params);</span>
        }
<span class="nc" id="L277">    }</span>

    @Deprecated
    @Override
    public void startActivity(Intent intent) {
<span class="nc bnc" id="L282" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5625)) {</span>
<span class="nc" id="L283">            super.startActivity(intent);</span>
        }
<span class="nc" id="L285">    }</span>

    public void startActivityWithoutAnimation(Intent intent) {
<span class="nc bnc" id="L288" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5626)) {</span>
<span class="nc" id="L289">            disableIntentAnimation(intent);</span>
        }
<span class="nc bnc" id="L291" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5627)) {</span>
<span class="nc" id="L292">            super.startActivity(intent);</span>
        }
<span class="nc bnc" id="L294" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5628)) {</span>
<span class="nc" id="L295">            disableActivityAnimation();</span>
        }
<span class="nc" id="L297">    }</span>

    public void startActivityWithAnimation(Intent intent, Direction animation) {
<span class="nc bnc" id="L300" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5629)) {</span>
<span class="nc" id="L301">            enableIntentAnimation(intent);</span>
        }
<span class="nc bnc" id="L303" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5630)) {</span>
<span class="nc" id="L304">            super.startActivity(intent);</span>
        }
<span class="nc bnc" id="L306" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5631)) {</span>
<span class="nc" id="L307">            enableActivityAnimation(animation);</span>
        }
<span class="nc" id="L309">    }</span>

    @Deprecated
    @Override
    public void startActivityForResult(Intent intent, int requestCode) {
        try {
<span class="nc bnc" id="L315" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(5633)) {</span>
<span class="nc" id="L316">                super.startActivityForResult(intent, requestCode);</span>
            }
<span class="nc" id="L318">        } catch (ActivityNotFoundException e) {</span>
<span class="nc bnc" id="L319" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(5632)) {</span>
<span class="nc" id="L320">                UIUtils.showSimpleSnackbar(this, R.string.activity_start_failed, true);</span>
            }
<span class="nc" id="L322">        }</span>
<span class="nc" id="L323">    }</span>

    public void startActivityForResultWithoutAnimation(Intent intent, int requestCode) {
<span class="nc bnc" id="L326" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5634)) {</span>
<span class="nc" id="L327">            disableIntentAnimation(intent);</span>
        }
<span class="nc bnc" id="L329" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5635)) {</span>
<span class="nc" id="L330">            startActivityForResult(intent, requestCode);</span>
        }
<span class="nc bnc" id="L332" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5636)) {</span>
<span class="nc" id="L333">            disableActivityAnimation();</span>
        }
<span class="nc" id="L335">    }</span>

    public void startActivityForResultWithAnimation(Intent intent, int requestCode, Direction animation) {
<span class="nc bnc" id="L338" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5637)) {</span>
<span class="nc" id="L339">            enableIntentAnimation(intent);</span>
        }
<span class="nc bnc" id="L341" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5638)) {</span>
<span class="nc" id="L342">            startActivityForResult(intent, requestCode);</span>
        }
<span class="nc bnc" id="L344" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5639)) {</span>
<span class="nc" id="L345">            enableActivityAnimation(animation);</span>
        }
<span class="nc" id="L347">    }</span>

    @Deprecated
    @Override
    public void finish() {
<span class="pc bpc" id="L352" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5640)) {</span>
<span class="fc" id="L353">            super.finish();</span>
        }
<span class="fc" id="L355">    }</span>

    public void finishWithoutAnimation() {
<span class="nc bnc" id="L358" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5641)) {</span>
<span class="nc" id="L359">            Timber.i(&quot;finishWithoutAnimation&quot;);</span>
        }
<span class="nc bnc" id="L361" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5642)) {</span>
<span class="nc" id="L362">            super.finish();</span>
        }
<span class="nc bnc" id="L364" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5643)) {</span>
<span class="nc" id="L365">            disableActivityAnimation();</span>
        }
<span class="nc" id="L367">    }</span>

    public void finishWithAnimation(Direction animation) {
<span class="nc bnc" id="L370" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5644)) {</span>
<span class="nc" id="L371">            Timber.i(&quot;finishWithAnimation %s&quot;, animation);</span>
        }
<span class="nc bnc" id="L373" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5645)) {</span>
<span class="nc" id="L374">            super.finish();</span>
        }
<span class="nc bnc" id="L376" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5646)) {</span>
<span class="nc" id="L377">            enableActivityAnimation(animation);</span>
        }
<span class="nc" id="L379">    }</span>

    protected void disableViewAnimation(View view) {
<span class="nc bnc" id="L382" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5647)) {</span>
<span class="nc" id="L383">            view.clearAnimation();</span>
        }
<span class="nc" id="L385">    }</span>

    protected void enableViewAnimation(View view, Animation animation) {
<span class="nc bnc" id="L388" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5650)) {</span>
<span class="nc bnc" id="L389" title="All 2 branches missed.">            if (animationDisabled()) {</span>
<span class="nc bnc" id="L390" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5649)) {</span>
<span class="nc" id="L391">                    disableViewAnimation(view);</span>
                }
            } else {
<span class="nc bnc" id="L394" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5648)) {</span>
<span class="nc" id="L395">                    view.setAnimation(animation);</span>
                }
            }
        }
<span class="nc" id="L399">    }</span>

    /**
     * Finish Activity using FADE animation *
     */
    public static void finishActivityWithFade(Activity activity) {
<span class="nc bnc" id="L405" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5651)) {</span>
<span class="nc" id="L406">            activity.finish();</span>
        }
<span class="nc bnc" id="L408" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5652)) {</span>
<span class="nc" id="L409">            ActivityTransitionAnimation.slide(activity, UP);</span>
        }
<span class="nc" id="L411">    }</span>

    private void disableIntentAnimation(Intent intent) {
<span class="nc bnc" id="L414" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5653)) {</span>
<span class="nc" id="L415">            intent.addFlags(Intent.FLAG_ACTIVITY_NO_ANIMATION);</span>
        }
<span class="nc" id="L417">    }</span>

    private void disableActivityAnimation() {
<span class="nc bnc" id="L420" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5654)) {</span>
<span class="nc" id="L421">            ActivityTransitionAnimation.slide(this, NONE);</span>
        }
<span class="nc" id="L423">    }</span>

    private void enableIntentAnimation(Intent intent) {
<span class="nc bnc" id="L426" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5656)) {</span>
<span class="nc bnc" id="L427" title="All 2 branches missed.">            if (animationDisabled()) {</span>
<span class="nc bnc" id="L428" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5655)) {</span>
<span class="nc" id="L429">                    disableIntentAnimation(intent);</span>
                }
            }
        }
<span class="nc" id="L433">    }</span>

    private void enableActivityAnimation(Direction animation) {
<span class="nc bnc" id="L436" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5659)) {</span>
<span class="nc bnc" id="L437" title="All 2 branches missed.">            if (animationDisabled()) {</span>
<span class="nc bnc" id="L438" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5658)) {</span>
<span class="nc" id="L439">                    disableActivityAnimation();</span>
                }
            } else {
<span class="nc bnc" id="L442" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5657)) {</span>
<span class="nc" id="L443">                    ActivityTransitionAnimation.slide(this, animation);</span>
                }
            }
        }
<span class="nc" id="L447">    }</span>

    // Method for loading the collection which is inherited by all AnkiActivitys
    public void startLoadingCollection() {
<span class="pc bpc" id="L451" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5660)) {</span>
<span class="fc" id="L452">            Timber.d(&quot;AnkiActivity.startLoadingCollection()&quot;);</span>
        }
<span class="pc bpc" id="L454" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5663)) {</span>
<span class="pc bpc" id="L455" title="1 of 2 branches missed.">            if (colIsOpen()) {</span>
<span class="pc bpc" id="L456" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5661)) {</span>
<span class="fc" id="L457">                    Timber.d(&quot;Synchronously calling onCollectionLoaded&quot;);</span>
                }
<span class="pc bpc" id="L459" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5662)) {</span>
<span class="fc" id="L460">                    onCollectionLoaded(getCol());</span>
                }
<span class="fc" id="L462">                return;</span>
            }
        }
<span class="nc bnc" id="L465" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5664)) {</span>
            // Open collection asynchronously if it hasn't already been opened
<span class="nc" id="L467">            showProgressBar();</span>
        }
<span class="nc bnc" id="L469" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5665)) {</span>
<span class="nc" id="L470">            CollectionLoader.load(this, col -&gt; {</span>
<span class="nc bnc" id="L471" title="All 2 branches missed.">                if (col != null) {</span>
<span class="nc" id="L472">                    Timber.d(&quot;Asynchronously calling onCollectionLoaded&quot;);</span>
<span class="nc" id="L473">                    onCollectionLoaded(col);</span>
                } else {
<span class="nc" id="L475">                    Intent deckPicker = new Intent(this, DeckPicker.class);</span>
                    // don't currently do anything with this
<span class="nc" id="L477">                    deckPicker.putExtra(&quot;collectionLoadError&quot;, true);</span>
<span class="nc" id="L478">                    deckPicker.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_NEW_TASK);</span>
<span class="nc" id="L479">                    startActivityWithAnimation(deckPicker, LEFT);</span>
                }
<span class="nc" id="L481">            });</span>
        }
<span class="nc" id="L483">    }</span>

    public void showProgressBar() {
<span class="nc" id="L486">        ProgressBar progressBar = findViewById(R.id.progress_bar);</span>
<span class="nc bnc" id="L487" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5667)) {</span>
<span class="nc bnc" id="L488" title="All 2 branches missed.">            if (progressBar != null) {</span>
<span class="nc bnc" id="L489" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5666)) {</span>
<span class="nc" id="L490">                    progressBar.setVisibility(View.VISIBLE);</span>
                }
            }
        }
<span class="nc" id="L494">    }</span>

    public void hideProgressBar() {
<span class="fc" id="L497">        ProgressBar progressBar = findViewById(R.id.progress_bar);</span>
<span class="pc bpc" id="L498" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5669)) {</span>
<span class="pc bpc" id="L499" title="1 of 2 branches missed.">            if (progressBar != null) {</span>
<span class="pc bpc" id="L500" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5668)) {</span>
<span class="fc" id="L501">                    progressBar.setVisibility(View.GONE);</span>
                }
            }
        }
<span class="fc" id="L505">    }</span>

    protected void mayOpenUrl(Uri url) {
<span class="nc" id="L508">        boolean success = mCustomTabActivityHelper.mayLaunchUrl(url, null, null);</span>
<span class="nc bnc" id="L509" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5671)) {</span>
<span class="nc bnc" id="L510" title="All 2 branches missed.">            if (!success) {</span>
<span class="nc bnc" id="L511" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5670)) {</span>
<span class="nc" id="L512">                    Timber.w(&quot;Couldn't preload url: %s&quot;, url.toString());</span>
                }
            }
        }
<span class="nc" id="L516">    }</span>

    public void openUrl(Uri url) {
<span class="nc bnc" id="L519" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5673)) {</span>
            // display the toast
<span class="nc bnc" id="L521" title="All 2 branches missed.">            if (!AdaptionUtil.hasWebBrowser(this)) {</span>
<span class="nc bnc" id="L522" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5672)) {</span>
<span class="nc" id="L523">                    UIUtils.showThemedToast(this, getResources().getString(R.string.no_browser_notification) + url, false);</span>
                }
<span class="nc" id="L525">                return;</span>
            }
        }
<span class="nc" id="L528">        CustomTabActivityHelper helper = getCustomTabActivityHelper();</span>
<span class="nc" id="L529">        CustomTabsIntent.Builder builder = new CustomTabsIntent.Builder(helper.getSession());</span>
<span class="nc" id="L530">        CustomTabColorSchemeParams colorScheme = new CustomTabColorSchemeParams.Builder().setToolbarColor(ContextCompat.getColor(this, R.color.material_light_blue_500)).build();</span>
<span class="nc bnc" id="L531" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5674)) {</span>
<span class="nc" id="L532">            builder.setDefaultColorSchemeParams(colorScheme).setShowTitle(true);</span>
        }
<span class="nc bnc" id="L534" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5675)) {</span>
<span class="nc" id="L535">            builder.setStartAnimations(this, R.anim.slide_right_in, R.anim.slide_left_out);</span>
        }
<span class="nc bnc" id="L537" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5676)) {</span>
<span class="nc" id="L538">            builder.setExitAnimations(this, R.anim.slide_left_in, R.anim.slide_right_out);</span>
        }
<span class="nc bnc" id="L540" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5677)) {</span>
<span class="nc" id="L541">            builder.setCloseButtonIcon(BitmapFactory.decodeResource(this.getResources(), R.drawable.ic_arrow_back_white_24dp));</span>
        }
<span class="nc" id="L543">        CustomTabsIntent customTabsIntent = builder.build();</span>
<span class="nc bnc" id="L544" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5678)) {</span>
<span class="nc" id="L545">            CustomTabsHelper.addKeepAliveExtra(this, customTabsIntent.intent);</span>
        }
<span class="nc bnc" id="L547" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5679)) {</span>
<span class="nc" id="L548">            CustomTabActivityHelper.openCustomTab(this, customTabsIntent, url, new CustomTabsFallback());</span>
        }
<span class="nc" id="L550">    }</span>

    public CustomTabActivityHelper getCustomTabActivityHelper() {
<span class="nc" id="L553">        return mCustomTabActivityHelper;</span>
    }

    /**
     * Global method to show dialog fragment including adding it to back stack Note: DO NOT call this from an async
     * task! If you need to show a dialog from an async task, use showAsyncDialogFragment()
     *
     * @param newFragment  the DialogFragment you want to show
     */
    public void showDialogFragment(DialogFragment newFragment) {
<span class="nc bnc" id="L563" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5680)) {</span>
<span class="nc" id="L564">            showDialogFragment(this, newFragment);</span>
        }
<span class="nc" id="L566">    }</span>

    public static void showDialogFragment(AnkiActivity activity, DialogFragment newFragment) {
        // dialog, so make our own transaction and take care of that here.
<span class="nc" id="L570">        FragmentManager manager = activity.getSupportFragmentManager();</span>
<span class="nc" id="L571">        FragmentTransaction ft = manager.beginTransaction();</span>
<span class="nc" id="L572">        Fragment prev = manager.findFragmentByTag(&quot;dialog&quot;);</span>
<span class="nc bnc" id="L573" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5682)) {</span>
<span class="nc bnc" id="L574" title="All 2 branches missed.">            if (prev != null) {</span>
<span class="nc bnc" id="L575" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5681)) {</span>
<span class="nc" id="L576">                    ft.remove(prev);</span>
                }
            }
        }
<span class="nc bnc" id="L580" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5683)) {</span>
            // save transaction to the back stack
<span class="nc" id="L582">            ft.addToBackStack(&quot;dialog&quot;);</span>
        }
<span class="nc bnc" id="L584" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5684)) {</span>
<span class="nc" id="L585">            newFragment.show(ft, &quot;dialog&quot;);</span>
        }
<span class="nc bnc" id="L587" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5685)) {</span>
<span class="nc" id="L588">            manager.executePendingTransactions();</span>
        }
<span class="nc" id="L590">    }</span>

    /**
     * Calls {@link #showAsyncDialogFragment(AsyncDialogFragment, NotificationChannels.Channel)} internally, using the channel
     * {@link NotificationChannels.Channel#GENERAL}
     *
     * @param newFragment  the AsyncDialogFragment you want to show
     */
    public void showAsyncDialogFragment(AsyncDialogFragment newFragment) {
<span class="nc bnc" id="L599" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5686)) {</span>
<span class="nc" id="L600">            showAsyncDialogFragment(newFragment, NotificationChannels.Channel.GENERAL);</span>
        }
<span class="nc" id="L602">    }</span>

    /**
     * Global method to show a dialog fragment including adding it to back stack and handling the case where the dialog
     * is shown from an async task, by showing the message in the notification bar if the activity was stopped before the
     * AsyncTask completed
     *
     * @param newFragment  the AsyncDialogFragment you want to show
     * @param channel the NotificationChannels.Channel to use for the notification
     */
    public void showAsyncDialogFragment(AsyncDialogFragment newFragment, NotificationChannels.Channel channel) {
        try {
<span class="nc bnc" id="L614" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(5689)) {</span>
<span class="nc" id="L615">                showDialogFragment(newFragment);</span>
            }
<span class="nc" id="L617">        } catch (IllegalStateException e) {</span>
<span class="nc bnc" id="L618" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(5687)) {</span>
                // Store a persistent message to SharedPreferences instructing AnkiDroid to show dialog
<span class="nc" id="L620">                DialogHandler.storeMessage(newFragment.getDialogHandlerMessage());</span>
            }
            // Show a basic notification to the user in the notification bar in the meantime
<span class="nc" id="L623">            String title = newFragment.getNotificationTitle();</span>
<span class="nc" id="L624">            String message = newFragment.getNotificationMessage();</span>
<span class="nc bnc" id="L625" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(5688)) {</span>
<span class="nc" id="L626">                showSimpleNotification(title, message, channel);</span>
            }
<span class="nc" id="L628">        }</span>
<span class="nc" id="L629">    }</span>

    /**
     * Show a simple message dialog, dismissing the message without taking any further action when OK button is pressed.
     * If a DialogFragment cannot be shown due to the Activity being stopped then the message is shown in the
     * notification bar instead.
     *
     * @param message
     */
    protected void showSimpleMessageDialog(String message) {
<span class="nc bnc" id="L639" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5690)) {</span>
<span class="nc" id="L640">            showSimpleMessageDialog(message, false);</span>
        }
<span class="nc" id="L642">    }</span>

    protected void showSimpleMessageDialog(String title, String message) {
<span class="nc bnc" id="L645" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5691)) {</span>
<span class="nc" id="L646">            showSimpleMessageDialog(title, message, false);</span>
        }
<span class="nc" id="L648">    }</span>

    /**
     * Show a simple message dialog, dismissing the message without taking any further action when OK button is pressed.
     * If a DialogFragment cannot be shown due to the Activity being stopped then the message is shown in the
     * notification bar instead.
     *
     * @param message
     * @param reload flag which forces app to be restarted when true
     */
    protected void showSimpleMessageDialog(String message, boolean reload) {
<span class="nc" id="L659">        AsyncDialogFragment newFragment = SimpleMessageDialog.newInstance(message, reload);</span>
<span class="nc bnc" id="L660" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5692)) {</span>
<span class="nc" id="L661">            showAsyncDialogFragment(newFragment);</span>
        }
<span class="nc" id="L663">    }</span>

    protected void showSimpleMessageDialog(String title, @Nullable String message, boolean reload) {
<span class="nc" id="L666">        AsyncDialogFragment newFragment = SimpleMessageDialog.newInstance(title, message, reload);</span>
<span class="nc bnc" id="L667" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5693)) {</span>
<span class="nc" id="L668">            showAsyncDialogFragment(newFragment);</span>
        }
<span class="nc" id="L670">    }</span>

    public void showSimpleNotification(String title, String message, NotificationChannels.Channel channel) {
<span class="nc" id="L673">        SharedPreferences prefs = AnkiDroidApp.getSharedPrefs(this);</span>
<span class="nc bnc" id="L674" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5708)) {</span>
            // Show a notification unless all notifications have been totally disabled
<span class="nc bnc" id="L676" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(5698) ? (Integer.parseInt(prefs.getString(&quot;minimumCardsDueForNotification&quot;, &quot;0&quot;)) &gt;= Preferences.PENDING_NOTIFICATIONS_ONLY) : (ListenerUtil.mutListener.listen(5697) ? (Integer.parseInt(prefs.getString(&quot;minimumCardsDueForNotification&quot;, &quot;0&quot;)) &gt; Preferences.PENDING_NOTIFICATIONS_ONLY) : (ListenerUtil.mutListener.listen(5696) ? (Integer.parseInt(prefs.getString(&quot;minimumCardsDueForNotification&quot;, &quot;0&quot;)) &lt; Preferences.PENDING_NOTIFICATIONS_ONLY) : (ListenerUtil.mutListener.listen(5695) ? (Integer.parseInt(prefs.getString(&quot;minimumCardsDueForNotification&quot;, &quot;0&quot;)) != Preferences.PENDING_NOTIFICATIONS_ONLY) : (ListenerUtil.mutListener.listen(5694) ? (Integer.parseInt(prefs.getString(&quot;minimumCardsDueForNotification&quot;, &quot;0&quot;)) == Preferences.PENDING_NOTIFICATIONS_ONLY) : (Integer.parseInt(prefs.getString(&quot;minimumCardsDueForNotification&quot;, &quot;0&quot;)) &lt;= Preferences.PENDING_NOTIFICATIONS_ONLY))))))) {</span>
                // Use the title as the ticker unless the title is simply &quot;AnkiDroid&quot;
<span class="nc" id="L678">                String ticker = title;</span>
<span class="nc bnc" id="L679" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5700)) {</span>
<span class="nc bnc" id="L680" title="All 2 branches missed.">                    if (title.equals(getResources().getString(R.string.app_name))) {</span>
<span class="nc bnc" id="L681" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(5699)) {</span>
<span class="nc" id="L682">                            ticker = message;</span>
                        }
                    }
                }
                // Build basic notification
<span class="nc" id="L687">                NotificationCompat.Builder builder = new NotificationCompat.Builder(this, NotificationChannels.getId(channel)).setSmallIcon(R.drawable.ic_stat_notify).setContentTitle(title).setContentText(message).setColor(ContextCompat.getColor(this, R.color.material_light_blue_500)).setStyle(new NotificationCompat.BigTextStyle().bigText(message)).setVisibility(NotificationCompat.VISIBILITY_PUBLIC).setTicker(ticker);</span>
<span class="nc bnc" id="L688" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5702)) {</span>
                    // Enable vibrate and blink if set in preferences
<span class="nc bnc" id="L690" title="All 2 branches missed.">                    if (prefs.getBoolean(&quot;widgetVibrate&quot;, false)) {</span>
<span class="nc bnc" id="L691" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(5701)) {</span>
<span class="nc" id="L692">                            builder.setVibrate(new long[] { 1000, 1000, 1000 });</span>
                        }
                    }
                }
<span class="nc bnc" id="L696" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5704)) {</span>
<span class="nc bnc" id="L697" title="All 2 branches missed.">                    if (prefs.getBoolean(&quot;widgetBlink&quot;, false)) {</span>
<span class="nc bnc" id="L698" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(5703)) {</span>
<span class="nc" id="L699">                            builder.setLights(Color.BLUE, 1000, 1000);</span>
                        }
                    }
                }
                // Creates an explicit intent for an Activity in your app
<span class="nc" id="L704">                Intent resultIntent = new Intent(this, DeckPicker.class);</span>
<span class="nc bnc" id="L705" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5705)) {</span>
<span class="nc" id="L706">                    resultIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);</span>
                }
<span class="nc" id="L708">                PendingIntent resultPendingIntent = PendingIntent.getActivity(this, 0, resultIntent, PendingIntent.FLAG_UPDATE_CURRENT);</span>
<span class="nc bnc" id="L709" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5706)) {</span>
<span class="nc" id="L710">                    builder.setContentIntent(resultPendingIntent);</span>
                }
<span class="nc" id="L712">                NotificationManager notificationManager = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);</span>
<span class="nc bnc" id="L713" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5707)) {</span>
                    // mId allows you to update the notification later on.
<span class="nc" id="L715">                    notificationManager.notify(SIMPLE_NOTIFICATION_ID, builder.build());</span>
                }
            }
        }
<span class="nc" id="L719">    }</span>

    public DialogHandler getDialogHandler() {
<span class="nc" id="L722">        return mHandler;</span>
    }

    // Handle closing simple message dialog
    @Override
    public void dismissSimpleMessageDialog(boolean reload) {
<span class="nc bnc" id="L728" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5709)) {</span>
<span class="nc" id="L729">            dismissAllDialogFragments();</span>
        }
<span class="nc bnc" id="L731" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5712)) {</span>
<span class="nc bnc" id="L732" title="All 2 branches missed.">            if (reload) {</span>
<span class="nc" id="L733">                Intent deckPicker = new Intent(this, DeckPicker.class);</span>
<span class="nc bnc" id="L734" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5710)) {</span>
<span class="nc" id="L735">                    deckPicker.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_NEW_TASK);</span>
                }
<span class="nc bnc" id="L737" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5711)) {</span>
<span class="nc" id="L738">                    startActivityWithoutAnimation(deckPicker);</span>
                }
            }
        }
<span class="nc" id="L742">    }</span>

    // Dismiss whatever dialog is showing
    public void dismissAllDialogFragments() {
<span class="pc bpc" id="L746" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5713)) {</span>
<span class="fc" id="L747">            getSupportFragmentManager().popBackStack(&quot;dialog&quot;, FragmentManager.POP_BACK_STACK_INCLUSIVE);</span>
        }
<span class="fc" id="L749">    }</span>

    // Restart the activity
    public void restartActivity() {
<span class="nc bnc" id="L753" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5714)) {</span>
<span class="nc" id="L754">            Timber.i(&quot;AnkiActivity -- restartActivity()&quot;);</span>
        }
<span class="nc" id="L756">        Intent intent = new Intent();</span>
<span class="nc bnc" id="L757" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5715)) {</span>
<span class="nc" id="L758">            intent.setClass(this, this.getClass());</span>
        }
<span class="nc bnc" id="L760" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5716)) {</span>
<span class="nc" id="L761">            intent.putExtras(new Bundle());</span>
        }
<span class="nc bnc" id="L763" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5717)) {</span>
<span class="nc" id="L764">            this.startActivityWithoutAnimation(intent);</span>
        }
<span class="nc bnc" id="L766" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5718)) {</span>
<span class="nc" id="L767">            this.finishWithoutAnimation();</span>
        }
<span class="nc" id="L769">    }</span>

    protected void enableToolbar() {
<span class="nc" id="L772">        Toolbar toolbar = findViewById(R.id.toolbar);</span>
<span class="nc bnc" id="L773" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5720)) {</span>
<span class="nc bnc" id="L774" title="All 2 branches missed.">            if (toolbar != null) {</span>
<span class="nc bnc" id="L775" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5719)) {</span>
<span class="nc" id="L776">                    setSupportActionBar(toolbar);</span>
                }
            }
        }
<span class="nc" id="L780">    }</span>

    protected void enableToolbar(@Nullable View view) {
<span class="pc bpc" id="L783" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5722)) {</span>
<span class="pc bpc" id="L784" title="1 of 2 branches missed.">            if (view == null) {</span>
<span class="nc bnc" id="L785" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5721)) {</span>
<span class="nc" id="L786">                    Timber.w(&quot;Unable to enable toolbar - invalid view supplied&quot;);</span>
                }
<span class="nc" id="L788">                return;</span>
            }
        }
<span class="fc" id="L791">        Toolbar toolbar = view.findViewById(R.id.toolbar);</span>
<span class="pc bpc" id="L792" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5724)) {</span>
<span class="pc bpc" id="L793" title="1 of 2 branches missed.">            if (toolbar != null) {</span>
<span class="pc bpc" id="L794" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(5723)) {</span>
<span class="fc" id="L795">                    setSupportActionBar(toolbar);</span>
                }
            }
        }
<span class="fc" id="L799">    }</span>

    protected boolean showedActivityFailedScreen(Bundle savedInstanceState) {
<span class="pc bpc" id="L802" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5725)) {</span>
<span class="pc bpc" id="L803" title="1 of 2 branches missed.">            if (!AnkiDroidApp.isInitialized()) {</span>
<span class="fc" id="L804">                return false;</span>
            }
        }
<span class="nc bnc" id="L807" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5726)) {</span>
<span class="nc" id="L808">            Timber.w(&quot;Activity started with no application instance&quot;);</span>
        }
<span class="nc bnc" id="L810" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5727)) {</span>
<span class="nc" id="L811">            UIUtils.showThemedToast(this, getString(R.string.ankidroid_cannot_open_after_backup_try_again), false);</span>
        }
<span class="nc bnc" id="L813" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5728)) {</span>
            // Avoids a SuperNotCalledException
<span class="nc" id="L815">            super.onCreate(savedInstanceState);</span>
        }
<span class="nc bnc" id="L817" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5729)) {</span>
<span class="nc" id="L818">            finishActivityWithFade(this);</span>
        }
<span class="nc bnc" id="L820" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(5730)) {</span>
            // If we don't kill the process, the backup is not &quot;done&quot; and reopening the app show the same message.
<span class="nc" id="L822">            new Thread(() -&gt; {</span>
                // Same as the default value of LENGTH_LONG
                try {
<span class="nc" id="L825">                    Thread.sleep(3500);</span>
<span class="nc" id="L826">                } catch (InterruptedException e) {</span>
<span class="nc" id="L827">                    Timber.w(e);</span>
<span class="nc" id="L828">                }</span>
<span class="nc" id="L829">                android.os.Process.killProcess(android.os.Process.myPid());</span>
<span class="nc" id="L830">            }).start();</span>
        }
<span class="nc" id="L832">        return true;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>