<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SeekBarPreference.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">AnkiDroid</a> &gt; <a href="index.source.html" class="el_package">com.ichi2.ui</a> &gt; <span class="el_source">SeekBarPreference.java</span></div><h1>SeekBarPreference.java</h1><pre class="source lang-java linenums">/* The following code was written by Matthew Wiggins
 * and is released under the APACHE 2.0 license
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * adjusted by Norbert Nagold 2011 &lt;norbert.nagold@gmail.com&gt;
 */
package com.ichi2.ui;

import android.app.AlertDialog;
import android.content.Context;
import android.util.AttributeSet;
import android.view.Gravity;
import android.view.View;
import android.widget.LinearLayout;
import android.widget.SeekBar;
import android.widget.TextView;
import com.ichi2.anki.AnkiDroidApp;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

// TODO Tracked in https://github.com/ankidroid/Anki-Android/issues/5019
@SuppressWarnings(&quot;deprecation&quot;)
public class SeekBarPreference extends android.preference.DialogPreference implements SeekBar.OnSeekBarChangeListener {

    private static final String androidns = &quot;http://schemas.android.com/apk/res/android&quot;;

    private SeekBar mSeekBar;

    private TextView mValueText;

    private final Context mContext;

    private final String mSuffix;

    private final int mDefault;

    private final int mMax;

    private final int mMin;

    private final int mInterval;

<span class="nc" id="L43">    private int mValue = 0;</span>

    public SeekBarPreference(Context context, AttributeSet attrs) {
<span class="nc" id="L46">        super(context, attrs);</span>
<span class="nc" id="L47">        mContext = context;</span>
<span class="nc" id="L48">        mSuffix = attrs.getAttributeValue(androidns, &quot;text&quot;);</span>
<span class="nc" id="L49">        mDefault = attrs.getAttributeIntValue(androidns, &quot;defaultValue&quot;, 0);</span>
<span class="nc" id="L50">        mMax = attrs.getAttributeIntValue(androidns, &quot;max&quot;, 100);</span>
<span class="nc" id="L51">        mMin = attrs.getAttributeIntValue(AnkiDroidApp.XML_CUSTOM_NAMESPACE, &quot;min&quot;, 0);</span>
<span class="nc" id="L52">        mInterval = attrs.getAttributeIntValue(AnkiDroidApp.XML_CUSTOM_NAMESPACE, &quot;interval&quot;, 1);</span>
<span class="nc" id="L53">    }</span>

    @Override
    protected View onCreateDialogView() {
<span class="nc" id="L57">        LinearLayout layout = new LinearLayout(mContext);</span>
<span class="nc bnc" id="L58" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25131)) {</span>
<span class="nc" id="L59">            layout.setOrientation(LinearLayout.VERTICAL);</span>
        }
<span class="nc bnc" id="L61" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25132)) {</span>
<span class="nc" id="L62">            layout.setPadding(6, 6, 6, 6);</span>
        }
<span class="nc bnc" id="L64" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25133)) {</span>
<span class="nc" id="L65">            mValueText = new FixedTextView(mContext);</span>
        }
<span class="nc bnc" id="L67" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25134)) {</span>
<span class="nc" id="L68">            mValueText.setGravity(Gravity.CENTER_HORIZONTAL);</span>
        }
<span class="nc bnc" id="L70" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25135)) {</span>
<span class="nc" id="L71">            mValueText.setTextSize(32);</span>
        }
<span class="nc" id="L73">        LinearLayout.LayoutParams params = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.MATCH_PARENT, LinearLayout.LayoutParams.WRAP_CONTENT);</span>
<span class="nc bnc" id="L74" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25136)) {</span>
<span class="nc" id="L75">            layout.addView(mValueText, params);</span>
        }
<span class="nc bnc" id="L77" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25137)) {</span>
<span class="nc" id="L78">            mSeekBar = new SeekBar(mContext);</span>
        }
<span class="nc bnc" id="L80" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25138)) {</span>
<span class="nc" id="L81">            mSeekBar.setOnSeekBarChangeListener(this);</span>
        }
<span class="nc bnc" id="L83" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25139)) {</span>
<span class="nc" id="L84">            layout.addView(mSeekBar, new LinearLayout.LayoutParams(LinearLayout.LayoutParams.MATCH_PARENT, LinearLayout.LayoutParams.WRAP_CONTENT));</span>
        }
<span class="nc bnc" id="L86" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25141)) {</span>
<span class="nc bnc" id="L87" title="All 2 branches missed.">            if (shouldPersist()) {</span>
<span class="nc bnc" id="L88" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(25140)) {</span>
<span class="nc" id="L89">                    mValue = getPersistedInt(mDefault);</span>
                }
            }
        }
<span class="nc bnc" id="L93" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25150)) {</span>
<span class="nc bnc" id="L94" title="All 48 branches missed.">            mSeekBar.setMax((ListenerUtil.mutListener.listen(25149) ? (((ListenerUtil.mutListener.listen(25145) ? (mMax % mMin) : (ListenerUtil.mutListener.listen(25144) ? (mMax / mMin) : (ListenerUtil.mutListener.listen(25143) ? (mMax * mMin) : (ListenerUtil.mutListener.listen(25142) ? (mMax + mMin) : (mMax - mMin)))))) % mInterval) : (ListenerUtil.mutListener.listen(25148) ? (((ListenerUtil.mutListener.listen(25145) ? (mMax % mMin) : (ListenerUtil.mutListener.listen(25144) ? (mMax / mMin) : (ListenerUtil.mutListener.listen(25143) ? (mMax * mMin) : (ListenerUtil.mutListener.listen(25142) ? (mMax + mMin) : (mMax - mMin)))))) * mInterval) : (ListenerUtil.mutListener.listen(25147) ? (((ListenerUtil.mutListener.listen(25145) ? (mMax % mMin) : (ListenerUtil.mutListener.listen(25144) ? (mMax / mMin) : (ListenerUtil.mutListener.listen(25143) ? (mMax * mMin) : (ListenerUtil.mutListener.listen(25142) ? (mMax + mMin) : (mMax - mMin)))))) - mInterval) : (ListenerUtil.mutListener.listen(25146) ? (((ListenerUtil.mutListener.listen(25145) ? (mMax % mMin) : (ListenerUtil.mutListener.listen(25144) ? (mMax / mMin) : (ListenerUtil.mutListener.listen(25143) ? (mMax * mMin) : (ListenerUtil.mutListener.listen(25142) ? (mMax + mMin) : (mMax - mMin)))))) + mInterval) : (((ListenerUtil.mutListener.listen(25145) ? (mMax % mMin) : (ListenerUtil.mutListener.listen(25144) ? (mMax / mMin) : (ListenerUtil.mutListener.listen(25143) ? (mMax * mMin) : (ListenerUtil.mutListener.listen(25142) ? (mMax + mMin) : (mMax - mMin)))))) / mInterval))))));</span>
        }
<span class="nc bnc" id="L96" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25159)) {</span>
<span class="nc bnc" id="L97" title="All 48 branches missed.">            mSeekBar.setProgress((ListenerUtil.mutListener.listen(25158) ? (((ListenerUtil.mutListener.listen(25154) ? (mValue % mMin) : (ListenerUtil.mutListener.listen(25153) ? (mValue / mMin) : (ListenerUtil.mutListener.listen(25152) ? (mValue * mMin) : (ListenerUtil.mutListener.listen(25151) ? (mValue + mMin) : (mValue - mMin)))))) % mInterval) : (ListenerUtil.mutListener.listen(25157) ? (((ListenerUtil.mutListener.listen(25154) ? (mValue % mMin) : (ListenerUtil.mutListener.listen(25153) ? (mValue / mMin) : (ListenerUtil.mutListener.listen(25152) ? (mValue * mMin) : (ListenerUtil.mutListener.listen(25151) ? (mValue + mMin) : (mValue - mMin)))))) * mInterval) : (ListenerUtil.mutListener.listen(25156) ? (((ListenerUtil.mutListener.listen(25154) ? (mValue % mMin) : (ListenerUtil.mutListener.listen(25153) ? (mValue / mMin) : (ListenerUtil.mutListener.listen(25152) ? (mValue * mMin) : (ListenerUtil.mutListener.listen(25151) ? (mValue + mMin) : (mValue - mMin)))))) - mInterval) : (ListenerUtil.mutListener.listen(25155) ? (((ListenerUtil.mutListener.listen(25154) ? (mValue % mMin) : (ListenerUtil.mutListener.listen(25153) ? (mValue / mMin) : (ListenerUtil.mutListener.listen(25152) ? (mValue * mMin) : (ListenerUtil.mutListener.listen(25151) ? (mValue + mMin) : (mValue - mMin)))))) + mInterval) : (((ListenerUtil.mutListener.listen(25154) ? (mValue % mMin) : (ListenerUtil.mutListener.listen(25153) ? (mValue / mMin) : (ListenerUtil.mutListener.listen(25152) ? (mValue * mMin) : (ListenerUtil.mutListener.listen(25151) ? (mValue + mMin) : (mValue - mMin)))))) / mInterval))))));</span>
        }
<span class="nc" id="L99">        String t = String.valueOf(mValue);</span>
<span class="nc bnc" id="L100" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25160)) {</span>
<span class="nc bnc" id="L101" title="All 2 branches missed.">            mValueText.setText(mSuffix == null ? t : t + mSuffix);</span>
        }
<span class="nc" id="L103">        return layout;</span>
    }

    @Override
    protected void onBindDialogView(View v) {
<span class="nc bnc" id="L108" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25161)) {</span>
<span class="nc" id="L109">            super.onBindDialogView(v);</span>
        }
<span class="nc bnc" id="L111" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25170)) {</span>
<span class="nc bnc" id="L112" title="All 48 branches missed.">            mSeekBar.setMax((ListenerUtil.mutListener.listen(25169) ? (((ListenerUtil.mutListener.listen(25165) ? (mMax % mMin) : (ListenerUtil.mutListener.listen(25164) ? (mMax / mMin) : (ListenerUtil.mutListener.listen(25163) ? (mMax * mMin) : (ListenerUtil.mutListener.listen(25162) ? (mMax + mMin) : (mMax - mMin)))))) % mInterval) : (ListenerUtil.mutListener.listen(25168) ? (((ListenerUtil.mutListener.listen(25165) ? (mMax % mMin) : (ListenerUtil.mutListener.listen(25164) ? (mMax / mMin) : (ListenerUtil.mutListener.listen(25163) ? (mMax * mMin) : (ListenerUtil.mutListener.listen(25162) ? (mMax + mMin) : (mMax - mMin)))))) * mInterval) : (ListenerUtil.mutListener.listen(25167) ? (((ListenerUtil.mutListener.listen(25165) ? (mMax % mMin) : (ListenerUtil.mutListener.listen(25164) ? (mMax / mMin) : (ListenerUtil.mutListener.listen(25163) ? (mMax * mMin) : (ListenerUtil.mutListener.listen(25162) ? (mMax + mMin) : (mMax - mMin)))))) - mInterval) : (ListenerUtil.mutListener.listen(25166) ? (((ListenerUtil.mutListener.listen(25165) ? (mMax % mMin) : (ListenerUtil.mutListener.listen(25164) ? (mMax / mMin) : (ListenerUtil.mutListener.listen(25163) ? (mMax * mMin) : (ListenerUtil.mutListener.listen(25162) ? (mMax + mMin) : (mMax - mMin)))))) + mInterval) : (((ListenerUtil.mutListener.listen(25165) ? (mMax % mMin) : (ListenerUtil.mutListener.listen(25164) ? (mMax / mMin) : (ListenerUtil.mutListener.listen(25163) ? (mMax * mMin) : (ListenerUtil.mutListener.listen(25162) ? (mMax + mMin) : (mMax - mMin)))))) / mInterval))))));</span>
        }
<span class="nc bnc" id="L114" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25179)) {</span>
<span class="nc bnc" id="L115" title="All 48 branches missed.">            mSeekBar.setProgress((ListenerUtil.mutListener.listen(25178) ? (((ListenerUtil.mutListener.listen(25174) ? (mValue % mMin) : (ListenerUtil.mutListener.listen(25173) ? (mValue / mMin) : (ListenerUtil.mutListener.listen(25172) ? (mValue * mMin) : (ListenerUtil.mutListener.listen(25171) ? (mValue + mMin) : (mValue - mMin)))))) % mInterval) : (ListenerUtil.mutListener.listen(25177) ? (((ListenerUtil.mutListener.listen(25174) ? (mValue % mMin) : (ListenerUtil.mutListener.listen(25173) ? (mValue / mMin) : (ListenerUtil.mutListener.listen(25172) ? (mValue * mMin) : (ListenerUtil.mutListener.listen(25171) ? (mValue + mMin) : (mValue - mMin)))))) * mInterval) : (ListenerUtil.mutListener.listen(25176) ? (((ListenerUtil.mutListener.listen(25174) ? (mValue % mMin) : (ListenerUtil.mutListener.listen(25173) ? (mValue / mMin) : (ListenerUtil.mutListener.listen(25172) ? (mValue * mMin) : (ListenerUtil.mutListener.listen(25171) ? (mValue + mMin) : (mValue - mMin)))))) - mInterval) : (ListenerUtil.mutListener.listen(25175) ? (((ListenerUtil.mutListener.listen(25174) ? (mValue % mMin) : (ListenerUtil.mutListener.listen(25173) ? (mValue / mMin) : (ListenerUtil.mutListener.listen(25172) ? (mValue * mMin) : (ListenerUtil.mutListener.listen(25171) ? (mValue + mMin) : (mValue - mMin)))))) + mInterval) : (((ListenerUtil.mutListener.listen(25174) ? (mValue % mMin) : (ListenerUtil.mutListener.listen(25173) ? (mValue / mMin) : (ListenerUtil.mutListener.listen(25172) ? (mValue * mMin) : (ListenerUtil.mutListener.listen(25171) ? (mValue + mMin) : (mValue - mMin)))))) / mInterval))))));</span>
        }
<span class="nc" id="L117">    }</span>

    @Override
    protected void onSetInitialValue(boolean restore, Object defaultValue) {
<span class="nc bnc" id="L121" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25180)) {</span>
<span class="nc" id="L122">            super.onSetInitialValue(restore, defaultValue);</span>
        }
<span class="nc bnc" id="L124" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25181)) {</span>
<span class="nc" id="L125">            mValue = getPersistedInt(mDefault);</span>
        }
<span class="nc bnc" id="L127" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25184)) {</span>
<span class="nc bnc" id="L128" title="All 2 branches missed.">            if (restore) {</span>
<span class="nc bnc" id="L129" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(25183)) {</span>
<span class="nc bnc" id="L130" title="All 2 branches missed.">                    mValue = shouldPersist() ? getPersistedInt(mDefault) : 0;</span>
                }
            } else {
<span class="nc bnc" id="L133" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(25182)) {</span>
<span class="nc" id="L134">                    mValue = (Integer) defaultValue;</span>
                }
            }
        }
<span class="nc" id="L138">    }</span>

    public void onProgressChanged(SeekBar seek, int value, boolean fromTouch) {
<span class="nc bnc" id="L141" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25195)) {</span>
<span class="nc bnc" id="L142" title="All 2 branches missed.">            if (fromTouch) {</span>
<span class="nc bnc" id="L143" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(25193)) {</span>
<span class="nc bnc" id="L144" title="All 48 branches missed.">                    mValue = (ListenerUtil.mutListener.listen(25192) ? (((ListenerUtil.mutListener.listen(25188) ? (value % mInterval) : (ListenerUtil.mutListener.listen(25187) ? (value / mInterval) : (ListenerUtil.mutListener.listen(25186) ? (value - mInterval) : (ListenerUtil.mutListener.listen(25185) ? (value + mInterval) : (value * mInterval)))))) % mMin) : (ListenerUtil.mutListener.listen(25191) ? (((ListenerUtil.mutListener.listen(25188) ? (value % mInterval) : (ListenerUtil.mutListener.listen(25187) ? (value / mInterval) : (ListenerUtil.mutListener.listen(25186) ? (value - mInterval) : (ListenerUtil.mutListener.listen(25185) ? (value + mInterval) : (value * mInterval)))))) / mMin) : (ListenerUtil.mutListener.listen(25190) ? (((ListenerUtil.mutListener.listen(25188) ? (value % mInterval) : (ListenerUtil.mutListener.listen(25187) ? (value / mInterval) : (ListenerUtil.mutListener.listen(25186) ? (value - mInterval) : (ListenerUtil.mutListener.listen(25185) ? (value + mInterval) : (value * mInterval)))))) * mMin) : (ListenerUtil.mutListener.listen(25189) ? (((ListenerUtil.mutListener.listen(25188) ? (value % mInterval) : (ListenerUtil.mutListener.listen(25187) ? (value / mInterval) : (ListenerUtil.mutListener.listen(25186) ? (value - mInterval) : (ListenerUtil.mutListener.listen(25185) ? (value + mInterval) : (value * mInterval)))))) - mMin) : (((ListenerUtil.mutListener.listen(25188) ? (value % mInterval) : (ListenerUtil.mutListener.listen(25187) ? (value / mInterval) : (ListenerUtil.mutListener.listen(25186) ? (value - mInterval) : (ListenerUtil.mutListener.listen(25185) ? (value + mInterval) : (value * mInterval)))))) + mMin)))));</span>
                }
<span class="nc" id="L146">                String t = String.valueOf(mValue);</span>
<span class="nc bnc" id="L147" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(25194)) {</span>
<span class="nc bnc" id="L148" title="All 2 branches missed.">                    mValueText.setText(mSuffix == null ? t : t + mSuffix);</span>
                }
            }
        }
<span class="nc" id="L152">    }</span>

    public int getValue() {
<span class="nc bnc" id="L155" title="All 22 branches missed.">        if ((ListenerUtil.mutListener.listen(25200) ? (mValue &gt;= 0) : (ListenerUtil.mutListener.listen(25199) ? (mValue &lt;= 0) : (ListenerUtil.mutListener.listen(25198) ? (mValue &gt; 0) : (ListenerUtil.mutListener.listen(25197) ? (mValue &lt; 0) : (ListenerUtil.mutListener.listen(25196) ? (mValue != 0) : (mValue == 0))))))) {</span>
<span class="nc" id="L156">            return getPersistedInt(mDefault);</span>
        } else {
<span class="nc" id="L158">            return mValue;</span>
        }
    }

    public void setValue(int value) {
<span class="nc bnc" id="L163" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25201)) {</span>
<span class="nc" id="L164">            mValue = value;</span>
        }
<span class="nc bnc" id="L166" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25202)) {</span>
<span class="nc" id="L167">            persistInt(value);</span>
        }
<span class="nc" id="L169">    }</span>

    public void onStartTrackingTouch(SeekBar seek) {
<span class="nc" id="L172">    }</span>

    public void onStopTrackingTouch(SeekBar seek) {
<span class="nc bnc" id="L175" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25204)) {</span>
<span class="nc bnc" id="L176" title="All 2 branches missed.">            if (shouldPersist()) {</span>
<span class="nc bnc" id="L177" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(25203)) {</span>
<span class="nc" id="L178">                    persistInt(mValue);</span>
                }
            }
        }
<span class="nc bnc" id="L182" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25205)) {</span>
<span class="nc" id="L183">            callChangeListener(mValue);</span>
        }
<span class="nc bnc" id="L185" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25206)) {</span>
<span class="nc" id="L186">            this.getDialog().dismiss();</span>
        }
<span class="nc" id="L188">    }</span>

    @Override
    protected void onPrepareDialogBuilder(AlertDialog.Builder builder) {
<span class="nc bnc" id="L192" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25207)) {</span>
<span class="nc" id="L193">            super.onPrepareDialogBuilder(builder);</span>
        }
<span class="nc bnc" id="L195" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25208)) {</span>
<span class="nc" id="L196">            builder.setNegativeButton(null, null);</span>
        }
<span class="nc bnc" id="L198" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25209)) {</span>
<span class="nc" id="L199">            builder.setPositiveButton(null, null);</span>
        }
<span class="nc bnc" id="L201" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(25210)) {</span>
<span class="nc" id="L202">            builder.setTitle(null);</span>
        }
<span class="nc" id="L204">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>