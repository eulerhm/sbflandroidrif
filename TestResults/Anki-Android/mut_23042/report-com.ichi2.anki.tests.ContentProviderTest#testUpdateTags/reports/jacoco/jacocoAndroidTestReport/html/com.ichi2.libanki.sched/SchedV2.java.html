<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SchedV2.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">AnkiDroid</a> &gt; <a href="index.source.html" class="el_package">com.ichi2.libanki.sched</a> &gt; <span class="el_source">SchedV2.java</span></div><h1>SchedV2.java</h1><pre class="source lang-java linenums">/**
 * *************************************************************************************
 *  Copyright (c) 2011 Norbert Nagold &lt;norbert.nagold@gmail.com&gt;                         *
 *  Copyright (c) 2012 Kostas Spyropoulos &lt;inigo.aldana@gmail.com&gt;                       *
 *  Copyright (c) 2013 Houssam Salem &lt;houssam.salem.au@gmail.com&gt;                        *
 *  Copyright (c) 2018 Chris Williams &lt;chris@chrispwill.com&gt;                             *
 *                                                                                       *
 *  This program is free software; you can redistribute it and/or modify it under        *
 *  the terms of the GNU General private License as published by the Free Software       *
 *  Foundation; either version 3 of the License, or (at your option) any later           *
 *  version.                                                                             *
 *                                                                                       *
 *  This program is distributed in the hope that it will be useful, but WITHOUT ANY      *
 *  WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A      *
 *  PARTICULAR PURPOSE. See the GNU General private License for more details.            *
 *                                                                                       *
 *  You should have received a copy of the GNU General private License along with        *
 *  this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.                           *
 * **************************************************************************************
 */
package com.ichi2.libanki.sched;

import android.app.Activity;
import android.content.Context;
import android.database.Cursor;
import android.database.SQLException;
import android.database.sqlite.SQLiteConstraintException;
import android.graphics.Typeface;
import android.text.SpannableStringBuilder;
import android.text.TextUtils;
import android.text.style.StyleSpan;
import android.util.Pair;
import com.ichi2.anki.R;
import com.ichi2.async.CancelListener;
import com.ichi2.async.CollectionTask;
import com.ichi2.async.TaskManager;
import com.ichi2.libanki.Card;
import com.ichi2.libanki.Collection;
import com.ichi2.libanki.Consts;
import com.ichi2.libanki.Decks;
import com.ichi2.libanki.Note;
import com.ichi2.libanki.Utils;
import com.ichi2.libanki.Deck;
import com.ichi2.libanki.DeckConfig;
import com.ichi2.libanki.utils.Time;
import com.ichi2.utils.Assert;
import com.ichi2.utils.JSONArray;
import com.ichi2.utils.JSONException;
import com.ichi2.utils.JSONObject;
import com.ichi2.utils.SyncStatus;
import java.lang.ref.WeakReference;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Collections;
import java.util.HashMap;
import java.util.LinkedList;
import java.util.List;
import java.util.ListIterator;
import java.util.Locale;
import java.util.Random;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.annotation.VisibleForTesting;
import timber.log.Timber;
import static com.ichi2.libanki.Consts.CARD_TYPE_RELEARNING;
import static com.ichi2.libanki.Consts.DECK_DYN;
import static com.ichi2.libanki.Consts.DECK_STD;
import static com.ichi2.libanki.Consts.QUEUE_TYPE_DAY_LEARN_RELEARN;
import static com.ichi2.async.CancelListener.isCancelled;
import static com.ichi2.libanki.sched.AbstractSched.UnburyType.*;
import static com.ichi2.libanki.sched.Counts.Queue.*;
import static com.ichi2.libanki.sched.Counts.Queue;
import static com.ichi2.libanki.stats.Stats.SECONDS_PER_DAY;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

@SuppressWarnings({ &quot;PMD.ExcessiveClassLength&quot;, &quot;PMD.AvoidThrowingRawExceptionTypes&quot;, &quot;PMD.AvoidReassigningParameters&quot;, &quot;PMD.NPathComplexity&quot;, &quot;PMD.MethodNamingConventions&quot;, &quot;PMD.AvoidBranchingStatementAsLastInLoop&quot;, &quot;PMD.SwitchStmtsShouldHaveDefault&quot;, &quot;PMD.CollapsibleIfStatements&quot;, &quot;PMD.EmptyIfStmt&quot; })
public class SchedV2 extends AbstractSched {

    // Not in libanki
<span class="fc" id="L80">    private static final int[] FACTOR_ADDITION_VALUES = { -150, 0, 150 };</span>

    public static final int RESCHEDULE_FACTOR = Consts.STARTING_FACTOR;

    protected final int mQueueLimit;

    protected int mReportLimit;

    private final int mDynReportLimit;

    protected int mReps;

    protected boolean mHaveQueues;

    protected boolean mHaveCounts;

    @Nullable
    protected Integer mToday;

    public long mDayCutoff;

    private long mLrnCutoff;

    protected int mNewCount;

    protected int mLrnCount;

    protected int mRevCount;

    private int mNewCardModulus;

    // The content change, not the array
<span class="fc" id="L112">    @NonNull</span>
    protected final double[] mEtaCache = new double[] { -1, -1, -1, -1, -1, -1 };

    // Queues
<span class="fc" id="L116">    @NonNull</span>
    protected final SimpleCardQueue mNewQueue = new SimpleCardQueue(this);

<span class="fc" id="L119">    @NonNull</span>
    protected final LrnCardQueue mLrnQueue = new LrnCardQueue(this);

<span class="fc" id="L122">    @NonNull</span>
    protected final SimpleCardQueue mLrnDayQueue = new SimpleCardQueue(this);

<span class="fc" id="L125">    @NonNull</span>
    protected final SimpleCardQueue mRevQueue = new SimpleCardQueue(this);

<span class="fc" id="L128">    @NonNull</span>
    private LinkedList&lt;Long&gt; mNewDids = new LinkedList&lt;&gt;();

<span class="fc" id="L131">    @NonNull</span>
    protected LinkedList&lt;Long&gt; mLrnDids = new LinkedList&lt;&gt;();

    // Not in libanki
    @Nullable
    protected WeakReference&lt;Activity&gt; mContextReference;

    /**
     * The card currently being reviewed.
     *
     * Must not be returned during prefetching (as it is currently shown)
     */
    protected Card mCurrentCard;

    /**
     * The list of parent decks of the current card.
     * Cached for performance .
     *
     *        Null iff mNextCard is null.
     */
    @Nullable
    protected List&lt;Long&gt; mCurrentCardParentsDid;

    /**
     * card types: 0=new, 1=lrn, 2=rev, 3=relrn
     * queue types: 0=new, 1=(re)lrn, 2=rev, 3=day (re)lrn,
     *   4=preview, -1=suspended, -2=sibling buried, -3=manually buried
     * revlog types: 0=lrn, 1=rev, 2=relrn, 3=early review
     * positive revlog intervals are in days (rev), negative in seconds (lrn)
     * odue/odid store original due/did when cards moved to filtered deck
     */
    public SchedV2(@NonNull Collection col) {
<span class="fc" id="L163">        super();</span>
<span class="pc bpc" id="L164" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15622)) {</span>
<span class="fc" id="L165">            mCol = col;</span>
        }
<span class="fc" id="L167">        mQueueLimit = 50;</span>
<span class="pc bpc" id="L168" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15623)) {</span>
<span class="fc" id="L169">            mReportLimit = 99999;</span>
        }
<span class="fc" id="L171">        mDynReportLimit = 99999;</span>
<span class="pc bpc" id="L172" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15624)) {</span>
<span class="fc" id="L173">            mReps = 0;</span>
        }
<span class="pc bpc" id="L175" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15625)) {</span>
<span class="fc" id="L176">            mToday = null;</span>
        }
<span class="pc bpc" id="L178" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15626)) {</span>
<span class="fc" id="L179">            mHaveQueues = false;</span>
        }
<span class="pc bpc" id="L181" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15627)) {</span>
<span class="fc" id="L182">            mHaveCounts = false;</span>
        }
<span class="pc bpc" id="L184" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15628)) {</span>
<span class="fc" id="L185">            mLrnCutoff = 0;</span>
        }
<span class="pc bpc" id="L187" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15629)) {</span>
<span class="fc" id="L188">            _updateCutoff();</span>
        }
<span class="fc" id="L190">    }</span>

    /**
     * Pop the next card from the queue. null if finished.
     */
    @Nullable
    public Card getCard() {
<span class="pc bpc" id="L197" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15630)) {</span>
<span class="fc" id="L198">            _checkDay();</span>
        }
<span class="pc bpc" id="L200" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15632)) {</span>
<span class="pc bpc" id="L201" title="1 of 2 branches missed.">            if (!mHaveQueues) {</span>
<span class="pc bpc" id="L202" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15631)) {</span>
<span class="fc" id="L203">                    resetQueues(false);</span>
                }
            }
        }
        @Nullable
<span class="fc" id="L208">        Card card = _getCard();</span>
<span class="pc bpc" id="L209" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15636)) {</span>
<span class="pc bpc" id="L210" title="8 of 10 branches missed.">            if ((ListenerUtil.mutListener.listen(15633) ? (card == null || !mHaveCounts) : (card == null &amp;&amp; !mHaveCounts))) {</span>
<span class="nc bnc" id="L211" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15634)) {</span>
                    // sibling. So let's try to set counts and check again.
<span class="nc" id="L213">                    reset();</span>
                }
<span class="nc bnc" id="L215" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15635)) {</span>
<span class="nc" id="L216">                    card = _getCard();</span>
                }
            }
        }
<span class="pc bpc" id="L220" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15643)) {</span>
<span class="pc bpc" id="L221" title="1 of 2 branches missed.">            if (card != null) {</span>
<span class="pc bpc" id="L222" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15638)) {</span>
<span class="fc" id="L223">                    mCol.log(card);</span>
                }
<span class="pc bpc" id="L225" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15639)) {</span>
<span class="fc" id="L226">                    incrReps();</span>
                }
<span class="pc bpc" id="L228" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15640)) {</span>
                    // the reviewer.
<span class="fc" id="L230">                    decrementCounts(card);</span>
                }
<span class="pc bpc" id="L232" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15641)) {</span>
<span class="fc" id="L233">                    setCurrentCard(card);</span>
                }
<span class="pc bpc" id="L235" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15642)) {</span>
<span class="fc" id="L236">                    card.startTimer();</span>
                }
            } else {
<span class="nc bnc" id="L239" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15637)) {</span>
<span class="nc" id="L240">                    discardCurrentCard();</span>
                }
            }
        }
<span class="pc bpc" id="L244" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15645)) {</span>
<span class="pc bpc" id="L245" title="1 of 2 branches missed.">            if (!mHaveCounts) {</span>
<span class="pc bpc" id="L246" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15644)) {</span>
                    // Need to reset queues once counts are reset
<span class="fc" id="L248">                    TaskManager.launchCollectionTask(new CollectionTask.Reset());</span>
                }
            }
        }
<span class="fc" id="L252">        return card;</span>
    }

    /**
     * Ensures that reset is executed before the next card is selected
     */
    public void deferReset(@NonNull Card card) {
<span class="nc bnc" id="L259" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15646)) {</span>
<span class="nc" id="L260">            mHaveQueues = false;</span>
        }
<span class="nc bnc" id="L262" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15647)) {</span>
<span class="nc" id="L263">            mHaveCounts = false;</span>
        }
<span class="nc bnc" id="L265" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15648)) {</span>
<span class="nc" id="L266">            setCurrentCard(card);</span>
        }
<span class="nc" id="L268">    }</span>

    public void deferReset() {
<span class="pc bpc" id="L271" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15649)) {</span>
<span class="fc" id="L272">            mHaveQueues = false;</span>
        }
<span class="pc bpc" id="L274" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15650)) {</span>
<span class="fc" id="L275">            mHaveCounts = false;</span>
        }
<span class="pc bpc" id="L277" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15651)) {</span>
<span class="fc" id="L278">            discardCurrentCard();</span>
        }
<span class="fc" id="L280">    }</span>

    public void reset() {
<span class="pc bpc" id="L283" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15652)) {</span>
<span class="fc" id="L284">            _updateCutoff();</span>
        }
<span class="pc bpc" id="L286" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15653)) {</span>
<span class="fc" id="L287">            resetCounts(false);</span>
        }
<span class="pc bpc" id="L289" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15654)) {</span>
<span class="fc" id="L290">            resetQueues(false);</span>
        }
<span class="fc" id="L292">    }</span>

    @Override
    public void resetCounts(@NonNull CancelListener cancelListener) {
<span class="nc bnc" id="L296" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15655)) {</span>
<span class="nc" id="L297">            resetCounts(true);</span>
        }
<span class="nc" id="L299">    }</span>

    public void resetCounts(boolean checkCutoff) {
<span class="pc bpc" id="L302" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15656)) {</span>
<span class="fc" id="L303">            resetCounts(null, checkCutoff);</span>
        }
<span class="fc" id="L305">    }</span>

    public void resetCounts() {
<span class="nc bnc" id="L308" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15657)) {</span>
<span class="nc" id="L309">            resetCounts(null, true);</span>
        }
<span class="nc" id="L311">    }</span>

    /**
     * @param checkCutoff whether we should check cutoff before resetting
     */
    private void resetCounts(@Nullable CancelListener cancelListener, boolean checkCutoff) {
<span class="pc bpc" id="L317" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15659)) {</span>
<span class="pc bpc" id="L318" title="1 of 2 branches missed.">            if (checkCutoff) {</span>
<span class="nc bnc" id="L319" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15658)) {</span>
<span class="nc" id="L320">                    _updateCutoff();</span>
                }
            }
        }
<span class="pc bpc" id="L324" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15660)) {</span>
            // In theory it is useless, as anything that change counts should have set mHaveCounts to false
<span class="fc" id="L326">            mHaveCounts = false;</span>
        }
<span class="pc bpc" id="L328" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15661)) {</span>
<span class="fc" id="L329">            _resetLrnCount(cancelListener);</span>
        }
<span class="pc bpc" id="L331" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15663)) {</span>
<span class="pc bpc" id="L332" title="1 of 2 branches missed.">            if (isCancelled(cancelListener)) {</span>
<span class="nc bnc" id="L333" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15662)) {</span>
<span class="nc" id="L334">                    Timber.v(&quot;Cancel computing counts of deck %s&quot;, mCol.getDecks().current().getString(&quot;name&quot;));</span>
                }
<span class="nc" id="L336">                return;</span>
            }
        }
<span class="pc bpc" id="L339" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15664)) {</span>
<span class="fc" id="L340">            _resetRevCount(cancelListener);</span>
        }
<span class="pc bpc" id="L342" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15666)) {</span>
<span class="pc bpc" id="L343" title="1 of 2 branches missed.">            if (isCancelled(cancelListener)) {</span>
<span class="nc bnc" id="L344" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15665)) {</span>
<span class="nc" id="L345">                    Timber.v(&quot;Cancel computing counts of deck %s&quot;, mCol.getDecks().current().getString(&quot;name&quot;));</span>
                }
<span class="nc" id="L347">                return;</span>
            }
        }
<span class="pc bpc" id="L350" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15667)) {</span>
<span class="fc" id="L351">            _resetNewCount(cancelListener);</span>
        }
<span class="pc bpc" id="L353" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15669)) {</span>
<span class="pc bpc" id="L354" title="1 of 2 branches missed.">            if (isCancelled(cancelListener)) {</span>
<span class="nc bnc" id="L355" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15668)) {</span>
<span class="nc" id="L356">                    Timber.v(&quot;Cancel computing counts of deck %s&quot;, mCol.getDecks().current().getString(&quot;name&quot;));</span>
                }
<span class="nc" id="L358">                return;</span>
            }
        }
<span class="pc bpc" id="L361" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15670)) {</span>
<span class="fc" id="L362">            mHaveCounts = true;</span>
        }
<span class="fc" id="L364">    }</span>

    /**
     * @param checkCutoff whether we should check cutoff before resetting
     */
    private void resetQueues(boolean checkCutoff) {
<span class="pc bpc" id="L370" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15672)) {</span>
<span class="pc bpc" id="L371" title="1 of 2 branches missed.">            if (checkCutoff) {</span>
<span class="nc bnc" id="L372" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15671)) {</span>
<span class="nc" id="L373">                    _updateCutoff();</span>
                }
            }
        }
<span class="pc bpc" id="L377" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15673)) {</span>
<span class="fc" id="L378">            _resetLrnQueue();</span>
        }
<span class="pc bpc" id="L380" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15674)) {</span>
<span class="fc" id="L381">            _resetRevQueue();</span>
        }
<span class="pc bpc" id="L383" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15675)) {</span>
<span class="fc" id="L384">            _resetNewQueue();</span>
        }
<span class="pc bpc" id="L386" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15676)) {</span>
<span class="fc" id="L387">            mHaveQueues = true;</span>
        }
<span class="fc" id="L389">    }</span>

    /**
     * Does all actions required to answer the card. That is:
     * Change its interval, due value, queue, mod time, usn, number of step left (if in learning)
     * Put it in learning if required
     * Log the review.
     * Remove from filtered if required.
     * Remove the siblings for the queue for same day spacing
     * Bury siblings if required by the options
     * Overriden
     */
    public void answerCard(@NonNull Card card, @Consts.BUTTON_TYPE int ease) {
<span class="nc bnc" id="L402" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15677)) {</span>
<span class="nc" id="L403">            mCol.log();</span>
        }
<span class="nc bnc" id="L405" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15678)) {</span>
<span class="nc" id="L406">            discardCurrentCard();</span>
        }
<span class="nc bnc" id="L408" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15679)) {</span>
<span class="nc" id="L409">            mCol.markReview(card);</span>
        }
<span class="nc bnc" id="L411" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15680)) {</span>
<span class="nc" id="L412">            _burySiblings(card);</span>
        }
<span class="nc bnc" id="L414" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15681)) {</span>
<span class="nc" id="L415">            _answerCard(card, ease);</span>
        }
<span class="nc bnc" id="L417" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15682)) {</span>
<span class="nc" id="L418">            _updateStats(card, &quot;time&quot;, card.timeTaken());</span>
        }
<span class="nc bnc" id="L420" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15683)) {</span>
<span class="nc" id="L421">            card.setMod(getTime().intTime());</span>
        }
<span class="nc bnc" id="L423" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15684)) {</span>
<span class="nc" id="L424">            card.setUsn(mCol.usn());</span>
        }
<span class="nc bnc" id="L426" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15685)) {</span>
<span class="nc" id="L427">            card.flushSched();</span>
        }
<span class="nc" id="L429">    }</span>

    public void _answerCard(@NonNull Card card, @Consts.BUTTON_TYPE int ease) {
<span class="nc bnc" id="L432" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15687)) {</span>
<span class="nc bnc" id="L433" title="All 2 branches missed.">            if (_previewingCard(card)) {</span>
<span class="nc bnc" id="L434" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15686)) {</span>
<span class="nc" id="L435">                    _answerCardPreview(card, ease);</span>
                }
<span class="nc" id="L437">                return;</span>
            }
        }
<span class="nc bnc" id="L440" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15688)) {</span>
<span class="nc" id="L441">            card.incrReps();</span>
        }
<span class="nc bnc" id="L443" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15698)) {</span>
<span class="nc bnc" id="L444" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(15693) ? (card.getQueue() &gt;= Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(15692) ? (card.getQueue() &lt;= Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(15691) ? (card.getQueue() &gt; Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(15690) ? (card.getQueue() &lt; Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(15689) ? (card.getQueue() != Consts.QUEUE_TYPE_NEW) : (card.getQueue() == Consts.QUEUE_TYPE_NEW))))))) {</span>
<span class="nc bnc" id="L445" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15694)) {</span>
                    // came from the new queue, move to learning
<span class="nc" id="L447">                    card.setQueue(Consts.QUEUE_TYPE_LRN);</span>
                }
<span class="nc bnc" id="L449" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15695)) {</span>
<span class="nc" id="L450">                    card.setType(Consts.CARD_TYPE_LRN);</span>
                }
<span class="nc bnc" id="L452" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15696)) {</span>
                    // init reps to graduation
<span class="nc" id="L454">                    card.setLeft(_startingLeft(card));</span>
                }
<span class="nc bnc" id="L456" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15697)) {</span>
                    // update daily limit
<span class="nc" id="L458">                    _updateStats(card, &quot;new&quot;);</span>
                }
            }
        }
<span class="nc bnc" id="L462" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15718)) {</span>
<span class="nc bnc" id="L463" title="All 90 branches missed.">            if ((ListenerUtil.mutListener.listen(15709) ? ((ListenerUtil.mutListener.listen(15703) ? (card.getQueue() &gt;= Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(15702) ? (card.getQueue() &lt;= Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(15701) ? (card.getQueue() &gt; Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(15700) ? (card.getQueue() &lt; Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(15699) ? (card.getQueue() != Consts.QUEUE_TYPE_LRN) : (card.getQueue() == Consts.QUEUE_TYPE_LRN)))))) &amp;&amp; (ListenerUtil.mutListener.listen(15708) ? (card.getQueue() &gt;= Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(15707) ? (card.getQueue() &lt;= Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(15706) ? (card.getQueue() &gt; Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(15705) ? (card.getQueue() &lt; Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(15704) ? (card.getQueue() != Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (card.getQueue() == Consts.QUEUE_TYPE_DAY_LEARN_RELEARN))))))) : ((ListenerUtil.mutListener.listen(15703) ? (card.getQueue() &gt;= Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(15702) ? (card.getQueue() &lt;= Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(15701) ? (card.getQueue() &gt; Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(15700) ? (card.getQueue() &lt; Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(15699) ? (card.getQueue() != Consts.QUEUE_TYPE_LRN) : (card.getQueue() == Consts.QUEUE_TYPE_LRN)))))) || (ListenerUtil.mutListener.listen(15708) ? (card.getQueue() &gt;= Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(15707) ? (card.getQueue() &lt;= Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(15706) ? (card.getQueue() &gt; Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(15705) ? (card.getQueue() &lt; Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(15704) ? (card.getQueue() != Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (card.getQueue() == Consts.QUEUE_TYPE_DAY_LEARN_RELEARN))))))))) {</span>
<span class="nc bnc" id="L464" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15717)) {</span>
<span class="nc" id="L465">                    _answerLrnCard(card, ease);</span>
                }
<span class="nc bnc" id="L467" title="All 22 branches missed.">            } else if ((ListenerUtil.mutListener.listen(15714) ? (card.getQueue() &gt;= Consts.QUEUE_TYPE_REV) : (ListenerUtil.mutListener.listen(15713) ? (card.getQueue() &lt;= Consts.QUEUE_TYPE_REV) : (ListenerUtil.mutListener.listen(15712) ? (card.getQueue() &gt; Consts.QUEUE_TYPE_REV) : (ListenerUtil.mutListener.listen(15711) ? (card.getQueue() &lt; Consts.QUEUE_TYPE_REV) : (ListenerUtil.mutListener.listen(15710) ? (card.getQueue() != Consts.QUEUE_TYPE_REV) : (card.getQueue() == Consts.QUEUE_TYPE_REV))))))) {</span>
<span class="nc bnc" id="L468" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15715)) {</span>
<span class="nc" id="L469">                    _answerRevCard(card, ease);</span>
                }
<span class="nc bnc" id="L471" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15716)) {</span>
                    // Update daily limit
<span class="nc" id="L473">                    _updateStats(card, &quot;rev&quot;);</span>
                }
            } else {
<span class="nc" id="L476">                throw new RuntimeException(&quot;Invalid queue&quot;);</span>
            }
        }
<span class="nc bnc" id="L479" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15725)) {</span>
            // no longer applies
<span class="nc bnc" id="L481" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(15723) ? (card.getODue() &gt;= 0) : (ListenerUtil.mutListener.listen(15722) ? (card.getODue() &lt;= 0) : (ListenerUtil.mutListener.listen(15721) ? (card.getODue() &lt; 0) : (ListenerUtil.mutListener.listen(15720) ? (card.getODue() != 0) : (ListenerUtil.mutListener.listen(15719) ? (card.getODue() == 0) : (card.getODue() &gt; 0))))))) {</span>
<span class="nc bnc" id="L482" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15724)) {</span>
<span class="nc" id="L483">                    card.setODue(0);</span>
                }
            }
        }
<span class="nc" id="L487">    }</span>

    // code deletes the entries
    public void _answerCardPreview(@NonNull Card card, @Consts.BUTTON_TYPE int ease) {
<span class="nc bnc" id="L491" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15741)) {</span>
<span class="nc bnc" id="L492" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(15730) ? (ease &gt;= Consts.BUTTON_ONE) : (ListenerUtil.mutListener.listen(15729) ? (ease &lt;= Consts.BUTTON_ONE) : (ListenerUtil.mutListener.listen(15728) ? (ease &gt; Consts.BUTTON_ONE) : (ListenerUtil.mutListener.listen(15727) ? (ease &lt; Consts.BUTTON_ONE) : (ListenerUtil.mutListener.listen(15726) ? (ease != Consts.BUTTON_ONE) : (ease == Consts.BUTTON_ONE))))))) {</span>
<span class="nc bnc" id="L493" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15738)) {</span>
                    // Repeat after delay
<span class="nc" id="L495">                    card.setQueue(Consts.QUEUE_TYPE_PREVIEW);</span>
                }
<span class="nc bnc" id="L497" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15739)) {</span>
<span class="nc" id="L498">                    card.setDue(getTime().intTime() + _previewDelay(card));</span>
                }
<span class="nc bnc" id="L500" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15740)) {</span>
<span class="nc" id="L501">                    mLrnCount += 1;</span>
                }
<span class="nc bnc" id="L503" title="All 22 branches missed.">            } else if ((ListenerUtil.mutListener.listen(15735) ? (ease &gt;= Consts.BUTTON_TWO) : (ListenerUtil.mutListener.listen(15734) ? (ease &lt;= Consts.BUTTON_TWO) : (ListenerUtil.mutListener.listen(15733) ? (ease &gt; Consts.BUTTON_TWO) : (ListenerUtil.mutListener.listen(15732) ? (ease &lt; Consts.BUTTON_TWO) : (ListenerUtil.mutListener.listen(15731) ? (ease != Consts.BUTTON_TWO) : (ease == Consts.BUTTON_TWO))))))) {</span>
<span class="nc bnc" id="L504" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15736)) {</span>
                    // Restore original card state and remove from filtered deck
<span class="nc" id="L506">                    _restorePreviewCard(card);</span>
                }
<span class="nc bnc" id="L508" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15737)) {</span>
<span class="nc" id="L509">                    _removeFromFiltered(card);</span>
                }
            } else {
                // This is in place of the assert
<span class="nc" id="L513">                throw new RuntimeException(&quot;Invalid ease&quot;);</span>
            }
        }
<span class="nc" id="L516">    }</span>

    /**
     * new count, lrn count, rev count.
     */
    @NonNull
    public Counts counts() {
<span class="nc" id="L523">        return counts((CancelListener) null);</span>
    }

    @NonNull
    public Counts counts(@Nullable CancelListener cancelListener) {
<span class="nc bnc" id="L528" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15743)) {</span>
<span class="nc bnc" id="L529" title="All 2 branches missed.">            if (!mHaveCounts) {</span>
<span class="nc bnc" id="L530" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15742)) {</span>
<span class="nc" id="L531">                    resetCounts(cancelListener);</span>
                }
            }
        }
<span class="nc" id="L535">        return new Counts(mNewCount, mLrnCount, mRevCount);</span>
    }

    /**
     * Same as counts(), but also count `card`. In practice, we use it because `card` is in the reviewer and that is the
     * number we actually want.
     * Overridden: left / 1000 in V1
     */
    @NonNull
    public Counts counts(@NonNull Card card) {
<span class="nc" id="L545">        Counts counts = counts();</span>
<span class="nc" id="L546">        Queue idx = countIdx(card);</span>
<span class="nc bnc" id="L547" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15744)) {</span>
<span class="nc" id="L548">            counts.changeCount(idx, 1);</span>
        }
<span class="nc" id="L550">        return counts;</span>
    }

    /**
     * Return counts over next DAYS. Includes today.
     */
    public int dueForecast(int days) {
        // TODO:...
<span class="nc" id="L558">        return 0;</span>
    }

    /**
     * Which of the three numbers shown in reviewer/overview should the card be counted. 0:new, 1:rev, 2: any kind of learning.
     * Overidden: V1 does not have preview
     */
    public Queue countIdx(@NonNull Card card) {
<span class="nc bnc" id="L566" title="All 4 branches missed.">        switch(card.getQueue()) {</span>
            case Consts.QUEUE_TYPE_DAY_LEARN_RELEARN:
            case Consts.QUEUE_TYPE_LRN:
            case Consts.QUEUE_TYPE_PREVIEW:
<span class="nc" id="L570">                return LRN;</span>
            case Consts.QUEUE_TYPE_NEW:
<span class="nc" id="L572">                return NEW;</span>
            case Consts.QUEUE_TYPE_REV:
<span class="nc" id="L574">                return REV;</span>
            default:
<span class="nc" id="L576">                throw new RuntimeException(&quot;Index &quot; + card.getQueue() + &quot; does not exists.&quot;);</span>
        }
    }

    /**
     * Number of buttons to show in the reviewer for `card`.
     * Overridden
     */
    public int answerButtons(@NonNull Card card) {
<span class="nc" id="L585">        DeckConfig conf = _cardConf(card);</span>
<span class="nc bnc" id="L586" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15746)) {</span>
<span class="nc bnc" id="L587" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(15745) ? (card.isInDynamicDeck() || !conf.getBoolean(&quot;resched&quot;)) : (card.isInDynamicDeck() &amp;&amp; !conf.getBoolean(&quot;resched&quot;)))) {</span>
<span class="nc" id="L588">                return 2;</span>
            }
        }
<span class="nc" id="L591">        return 4;</span>
    }

    protected void _updateStats(@NonNull Card card, @NonNull String type) {
<span class="nc bnc" id="L595" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15747)) {</span>
<span class="nc" id="L596">            _updateStats(card, type, 1);</span>
        }
<span class="nc" id="L598">    }</span>

    public void _updateStats(@NonNull Card card, @NonNull String type, long cnt) {
<span class="nc" id="L601">        String key = type + &quot;Today&quot;;</span>
<span class="nc" id="L602">        long did = card.getDid();</span>
<span class="nc" id="L603">        List&lt;Deck&gt; list = mCol.getDecks().parents(did);</span>
<span class="nc bnc" id="L604" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15748)) {</span>
<span class="nc" id="L605">            list.add(mCol.getDecks().get(did));</span>
        }
<span class="nc bnc" id="L607" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15755)) {</span>
            {
<span class="nc" id="L609">                long _loopCounter299 = 0;</span>
<span class="nc bnc" id="L610" title="All 2 branches missed.">                for (Deck g : list) {</span>
<span class="nc" id="L611">                    ListenerUtil.loopListener.listen(&quot;_loopCounter299&quot;, ++_loopCounter299);</span>
<span class="nc" id="L612">                    JSONArray a = g.getJSONArray(key);</span>
<span class="nc bnc" id="L613" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15753)) {</span>
                        // add
<span class="nc bnc" id="L615" title="All 8 branches missed.">                        a.put(1, (ListenerUtil.mutListener.listen(15752) ? (a.getLong(1) % cnt) : (ListenerUtil.mutListener.listen(15751) ? (a.getLong(1) / cnt) : (ListenerUtil.mutListener.listen(15750) ? (a.getLong(1) * cnt) : (ListenerUtil.mutListener.listen(15749) ? (a.getLong(1) - cnt) : (a.getLong(1) + cnt))))));</span>
                    }
<span class="nc bnc" id="L617" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15754)) {</span>
<span class="nc" id="L618">                        mCol.getDecks().save(g);</span>
                    }
<span class="nc" id="L620">                }</span>
            }
        }
<span class="nc" id="L623">    }</span>

    public void extendLimits(int newc, int rev) {
<span class="nc" id="L626">        Deck cur = mCol.getDecks().current();</span>
<span class="nc" id="L627">        List&lt;Deck&gt; decks = mCol.getDecks().parents(cur.getLong(&quot;id&quot;));</span>
<span class="nc bnc" id="L628" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15756)) {</span>
<span class="nc" id="L629">            decks.add(cur);</span>
        }
<span class="nc bnc" id="L631" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15758)) {</span>
            {
<span class="nc" id="L633">                long _loopCounter300 = 0;</span>
<span class="nc bnc" id="L634" title="All 2 branches missed.">                for (long did : mCol.getDecks().children(cur.getLong(&quot;id&quot;)).values()) {</span>
<span class="nc" id="L635">                    ListenerUtil.loopListener.listen(&quot;_loopCounter300&quot;, ++_loopCounter300);</span>
<span class="nc bnc" id="L636" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15757)) {</span>
<span class="nc" id="L637">                        decks.add(mCol.getDecks().get(did));</span>
                    }
<span class="nc" id="L639">                }</span>
            }
        }
<span class="nc bnc" id="L642" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15771)) {</span>
            {
<span class="nc" id="L644">                long _loopCounter301 = 0;</span>
<span class="nc bnc" id="L645" title="All 2 branches missed.">                for (Deck g : decks) {</span>
<span class="nc" id="L646">                    ListenerUtil.loopListener.listen(&quot;_loopCounter301&quot;, ++_loopCounter301);</span>
                    // add
<span class="nc" id="L648">                    JSONArray today = g.getJSONArray(&quot;newToday&quot;);</span>
<span class="nc bnc" id="L649" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15763)) {</span>
<span class="nc bnc" id="L650" title="All 8 branches missed.">                        today.put(1, (ListenerUtil.mutListener.listen(15762) ? (today.getInt(1) % newc) : (ListenerUtil.mutListener.listen(15761) ? (today.getInt(1) / newc) : (ListenerUtil.mutListener.listen(15760) ? (today.getInt(1) * newc) : (ListenerUtil.mutListener.listen(15759) ? (today.getInt(1) + newc) : (today.getInt(1) - newc))))));</span>
                    }
<span class="nc bnc" id="L652" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15764)) {</span>
<span class="nc" id="L653">                        today = g.getJSONArray(&quot;revToday&quot;);</span>
                    }
<span class="nc bnc" id="L655" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15769)) {</span>
<span class="nc bnc" id="L656" title="All 8 branches missed.">                        today.put(1, (ListenerUtil.mutListener.listen(15768) ? (today.getInt(1) % rev) : (ListenerUtil.mutListener.listen(15767) ? (today.getInt(1) / rev) : (ListenerUtil.mutListener.listen(15766) ? (today.getInt(1) * rev) : (ListenerUtil.mutListener.listen(15765) ? (today.getInt(1) + rev) : (today.getInt(1) - rev))))));</span>
                    }
<span class="nc bnc" id="L658" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15770)) {</span>
<span class="nc" id="L659">                        mCol.getDecks().save(g);</span>
                    }
<span class="nc" id="L661">                }</span>
            }
        }
<span class="nc" id="L664">    }</span>

    protected int _walkingCount(@NonNull LimitMethod limFn, @NonNull CountMethod cntFn) {
<span class="nc" id="L667">        return _walkingCount(limFn, cntFn, null);</span>
    }

    /**
     * @param limFn Method sending a deck to the maximal number of card it can have. Normally into account both limits and cards seen today
     * @param cntFn Method sending a deck to the number of card it has got to see today.
     * @param cancelListener Whether the task is not useful anymore
     * @return -1 if it's cancelled. Sum of the results of cntFn, limited by limFn,
     */
    protected int _walkingCount(@NonNull LimitMethod limFn, @NonNull CountMethod cntFn, @Nullable CancelListener cancelListener) {
<span class="fc" id="L677">        int tot = 0;</span>
<span class="fc" id="L678">        HashMap&lt;Long, Integer&gt; pcounts = new HashMap&lt;&gt;(mCol.getDecks().count());</span>
<span class="pc bpc" id="L679" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15795)) {</span>
            {
<span class="fc" id="L681">                long _loopCounter304 = 0;</span>
                // for each of the active decks
<span class="fc bfc" id="L683" title="All 2 branches covered.">                for (long did : mCol.getDecks().active()) {</span>
<span class="fc" id="L684">                    ListenerUtil.loopListener.listen(&quot;_loopCounter304&quot;, ++_loopCounter304);</span>
<span class="pc bpc" id="L685" title="1 of 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15772)) {</span>
<span class="pc bpc" id="L686" title="1 of 2 branches missed.">                        if (isCancelled(cancelListener))</span>
<span class="nc" id="L687">                            return -1;</span>
                    }
                    // get the individual deck's limit
<span class="fc" id="L690">                    int lim = limFn.operation(mCol.getDecks().get(did));</span>
<span class="pc bpc" id="L691" title="1 of 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15778)) {</span>
<span class="pc bpc" id="L692" title="16 of 22 branches missed.">                        if ((ListenerUtil.mutListener.listen(15777) ? (lim &gt;= 0) : (ListenerUtil.mutListener.listen(15776) ? (lim &lt;= 0) : (ListenerUtil.mutListener.listen(15775) ? (lim &gt; 0) : (ListenerUtil.mutListener.listen(15774) ? (lim &lt; 0) : (ListenerUtil.mutListener.listen(15773) ? (lim != 0) : (lim == 0))))))) {</span>
<span class="nc" id="L693">                            continue;</span>
                        }
                    }
                    // check the parents
<span class="fc" id="L697">                    List&lt;Deck&gt; parents = mCol.getDecks().parents(did);</span>
<span class="pc bpc" id="L698" title="1 of 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15782)) {</span>
                        {
<span class="fc" id="L700">                            long _loopCounter302 = 0;</span>
<span class="pc bpc" id="L701" title="1 of 2 branches missed.">                            for (Deck p : parents) {</span>
<span class="nc" id="L702">                                ListenerUtil.loopListener.listen(&quot;_loopCounter302&quot;, ++_loopCounter302);</span>
                                // add if missing
<span class="nc" id="L704">                                long id = p.getLong(&quot;id&quot;);</span>
<span class="nc bnc" id="L705" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(15780)) {</span>
<span class="nc bnc" id="L706" title="All 2 branches missed.">                                    if (!pcounts.containsKey(id)) {</span>
<span class="nc bnc" id="L707" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(15779)) {</span>
<span class="nc" id="L708">                                            pcounts.put(id, limFn.operation(p));</span>
                                        }
                                    }
                                }
<span class="nc bnc" id="L712" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(15781)) {</span>
                                    // take minimum of child and parent
<span class="nc" id="L714">                                    lim = Math.min(pcounts.get(id), lim);</span>
                                }
<span class="nc" id="L716">                            }</span>
                        }
                    }
                    // see how many cards we actually have
<span class="fc" id="L720">                    int cnt = cntFn.operation(did, lim);</span>
<span class="pc bpc" id="L721" title="1 of 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15788)) {</span>
                        {
<span class="fc" id="L723">                            long _loopCounter303 = 0;</span>
                            // if non-zero, decrement from parents counts
<span class="pc bpc" id="L725" title="1 of 2 branches missed.">                            for (Deck p : parents) {</span>
<span class="nc" id="L726">                                ListenerUtil.loopListener.listen(&quot;_loopCounter303&quot;, ++_loopCounter303);</span>
<span class="nc" id="L727">                                long id = p.getLong(&quot;id&quot;);</span>
<span class="nc bnc" id="L728" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(15787)) {</span>
<span class="nc bnc" id="L729" title="All 8 branches missed.">                                    pcounts.put(id, (ListenerUtil.mutListener.listen(15786) ? (pcounts.get(id) % cnt) : (ListenerUtil.mutListener.listen(15785) ? (pcounts.get(id) / cnt) : (ListenerUtil.mutListener.listen(15784) ? (pcounts.get(id) * cnt) : (ListenerUtil.mutListener.listen(15783) ? (pcounts.get(id) + cnt) : (pcounts.get(id) - cnt))))));</span>
                                }
<span class="nc" id="L731">                            }</span>
                        }
                    }
<span class="pc bpc" id="L734" title="1 of 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15793)) {</span>
                        // we may also be a parent
<span class="pc bpc" id="L736" title="4 of 8 branches missed.">                        pcounts.put(did, (ListenerUtil.mutListener.listen(15792) ? (lim % cnt) : (ListenerUtil.mutListener.listen(15791) ? (lim / cnt) : (ListenerUtil.mutListener.listen(15790) ? (lim * cnt) : (ListenerUtil.mutListener.listen(15789) ? (lim + cnt) : (lim - cnt))))));</span>
                    }
<span class="pc bpc" id="L738" title="1 of 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15794)) {</span>
                        // and add to running total
<span class="fc" id="L740">                        tot += cnt;</span>
                    }
<span class="fc" id="L742">                }</span>
            }
        }
<span class="fc" id="L745">        return tot;</span>
    }

    /**
     * Returns [deckname, did, rev, lrn, new]
     *
     * Return nulls when deck task is cancelled.
     */
    @NonNull
    public List&lt;DeckDueTreeNode&gt; deckDueList() {
<span class="nc" id="L755">        return deckDueList(null);</span>
    }

    // Overridden
    @Nullable
    public List&lt;DeckDueTreeNode&gt; deckDueList(@Nullable CancelListener collectionTask) {
<span class="nc bnc" id="L761" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15796)) {</span>
<span class="nc" id="L762">            _checkDay();</span>
        }
<span class="nc bnc" id="L764" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15797)) {</span>
<span class="nc" id="L765">            mCol.getDecks().checkIntegrity();</span>
        }
<span class="nc" id="L767">        ArrayList&lt;Deck&gt; decks = mCol.getDecks().allSorted();</span>
<span class="nc" id="L768">        HashMap&lt;String, Integer[]&gt; lims = new HashMap&lt;&gt;(decks.size());</span>
<span class="nc" id="L769">        ArrayList&lt;DeckDueTreeNode&gt; deckNodes = new ArrayList&lt;&gt;(decks.size());</span>
<span class="nc" id="L770">        Decks.Node childMap = mCol.getDecks().childMap();</span>
<span class="nc bnc" id="L771" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15805)) {</span>
            {
<span class="nc" id="L773">                long _loopCounter305 = 0;</span>
<span class="nc bnc" id="L774" title="All 2 branches missed.">                for (Deck deck : decks) {</span>
<span class="nc" id="L775">                    ListenerUtil.loopListener.listen(&quot;_loopCounter305&quot;, ++_loopCounter305);</span>
<span class="nc bnc" id="L776" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15798)) {</span>
<span class="nc bnc" id="L777" title="All 2 branches missed.">                        if (isCancelled(collectionTask)) {</span>
<span class="nc" id="L778">                            return null;</span>
                        }
                    }
<span class="nc" id="L781">                    String deckName = deck.getString(&quot;name&quot;);</span>
<span class="nc" id="L782">                    String p = Decks.parent(deckName);</span>
                    // new
<span class="nc" id="L784">                    int nlim = _deckNewLimitSingle(deck, false);</span>
<span class="nc" id="L785">                    Integer plim = null;</span>
<span class="nc bnc" id="L786" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15802)) {</span>
<span class="nc bnc" id="L787" title="All 2 branches missed.">                        if (!TextUtils.isEmpty(p)) {</span>
<span class="nc" id="L788">                            Integer[] parentLims = lims.get(Decks.normalizeName(p));</span>
<span class="nc bnc" id="L789" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(15799)) {</span>
                                // 'temporary for diagnosis of bug #6383'
<span class="nc bnc" id="L791" title="All 2 branches missed.">                                Assert.that(parentLims != null, &quot;Deck %s is supposed to have parent %s. It has not be found.&quot;, deckName, p);</span>
                            }
<span class="nc bnc" id="L793" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(15800)) {</span>
<span class="nc" id="L794">                                nlim = Math.min(nlim, parentLims[0]);</span>
                            }
<span class="nc bnc" id="L796" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(15801)) {</span>
                                // reviews
<span class="nc" id="L798">                                plim = parentLims[1];</span>
                            }
                        }
                    }
<span class="nc" id="L802">                    int _new = _newForDeck(deck.getLong(&quot;id&quot;), nlim);</span>
                    // learning
<span class="nc" id="L804">                    int lrn = _lrnForDeck(deck.getLong(&quot;id&quot;));</span>
                    // reviews
<span class="nc" id="L806">                    int rlim = _deckRevLimitSingle(deck, plim, false);</span>
<span class="nc" id="L807">                    int rev = _revForDeck(deck.getLong(&quot;id&quot;), rlim, childMap);</span>
<span class="nc bnc" id="L808" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15803)) {</span>
                        // save to list
<span class="nc" id="L810">                        deckNodes.add(new DeckDueTreeNode(mCol, deck.getString(&quot;name&quot;), deck.getLong(&quot;id&quot;), rev, lrn, _new));</span>
                    }
<span class="nc bnc" id="L812" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15804)) {</span>
                        // add deck as a parent
<span class="nc" id="L814">                        lims.put(Decks.normalizeName(deck.getString(&quot;name&quot;)), new Integer[] { nlim, rlim });</span>
                    }
<span class="nc" id="L816">                }</span>
            }
        }
<span class="nc" id="L819">        return deckNodes;</span>
    }

    /**
     * Similar to deck due tree, but ignore the number of cards.
     *
     *     It may takes a lot of time to compute the number of card, it
     *     requires multiple database access by deck.  Ignoring this number
     *     lead to the creation of a tree more quickly.
     */
    @Override
    @NonNull
    public List&lt;DeckTreeNode&gt; quickDeckDueTree() {
<span class="nc" id="L832">        ArrayList&lt;Deck&gt; decks = mCol.getDecks().allSorted();</span>
        // Similar to deckDueList
<span class="nc" id="L834">        ArrayList&lt;DeckTreeNode&gt; data = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L835" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15807)) {</span>
            {
<span class="nc" id="L837">                long _loopCounter306 = 0;</span>
<span class="nc bnc" id="L838" title="All 2 branches missed.">                for (JSONObject deck : decks) {</span>
<span class="nc" id="L839">                    ListenerUtil.loopListener.listen(&quot;_loopCounter306&quot;, ++_loopCounter306);</span>
<span class="nc" id="L840">                    DeckTreeNode g = new DeckTreeNode(mCol, deck.getString(&quot;name&quot;), deck.getLong(&quot;id&quot;));</span>
<span class="nc bnc" id="L841" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15806)) {</span>
<span class="nc" id="L842">                        data.add(g);</span>
                    }
<span class="nc" id="L844">                }</span>
            }
        }
<span class="nc" id="L847">        return _groupChildren(data, false);</span>
    }

    @NonNull
    public List&lt;DeckDueTreeNode&gt; deckDueTree() {
<span class="nc" id="L852">        return deckDueTree(null);</span>
    }

    @Nullable
    public List&lt;DeckDueTreeNode&gt; deckDueTree(@Nullable CancelListener cancelListener) {
<span class="nc" id="L857">        List&lt;DeckDueTreeNode&gt; deckDueTree = deckDueList(cancelListener);</span>
<span class="nc bnc" id="L858" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15808)) {</span>
<span class="nc bnc" id="L859" title="All 2 branches missed.">            if (deckDueTree == null) {</span>
<span class="nc" id="L860">                return null;</span>
            }
        }
<span class="nc" id="L863">        return _groupChildren(deckDueTree, true);</span>
    }

    @NonNull
    private &lt;T extends AbstractDeckTreeNode&lt;T&gt;&gt; List&lt;T&gt; _groupChildren(@NonNull List&lt;T&gt; decks, boolean checkDone) {
<span class="nc bnc" id="L868" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15809)) {</span>
            // sort based on name's components
<span class="nc" id="L870">            Collections.sort(decks);</span>
        }
        // then run main function
<span class="nc" id="L873">        return _groupChildrenMain(decks, checkDone);</span>
    }

    @NonNull
    protected &lt;T extends AbstractDeckTreeNode&lt;T&gt;&gt; List&lt;T&gt; _groupChildrenMain(@NonNull List&lt;T&gt; decks, boolean checkDone) {
<span class="nc" id="L878">        return _groupChildrenMain(decks, 0, checkDone);</span>
    }

    /**
     *        @return the tree structure of all decks from @descandants, starting
     *        at specified depth.
     *
     *        @param descendants a list of decks of dept at least depth, having all
     *        the same first depth name elements, sorted in deck order.
     *        @param depth The depth of the tree we are creating
     *        @param checkDone whether the set of deck was checked. If
     *        false, we can't assume all decks have parents and that there
     *        is no duplicate. Instead, we'll ignore problems.
     */
    @NonNull
    protected &lt;T extends AbstractDeckTreeNode&lt;T&gt;&gt; List&lt;T&gt; _groupChildrenMain(@NonNull List&lt;T&gt; descendants, int depth, boolean checkDone) {
<span class="nc" id="L894">        List&lt;T&gt; children = new ArrayList&lt;&gt;();</span>
        // group and recurse
<span class="nc" id="L896">        ListIterator&lt;T&gt; it = descendants.listIterator();</span>
<span class="nc bnc" id="L897" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15836)) {</span>
            {
<span class="nc" id="L899">                long _loopCounter308 = 0;</span>
<span class="nc bnc" id="L900" title="All 2 branches missed.">                while (it.hasNext()) {</span>
<span class="nc" id="L901">                    ListenerUtil.loopListener.listen(&quot;_loopCounter308&quot;, ++_loopCounter308);</span>
<span class="nc" id="L902">                    T child = it.next();</span>
<span class="nc" id="L903">                    String head = child.getDeckNameComponent(depth);</span>
<span class="nc" id="L904">                    List&lt;T&gt; descendantsOfChild = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L905" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15817)) {</span>
                        /* Compose the &quot;children&quot; node list. The children is a
             * list of all the nodes that proceed the current one that
             * contain the same at depth `depth`, except for the
             * current one itself.  I.e., they are subdecks that stem
             * from this descendant.  This is our version of python's
             * itertools.groupby. */
<span class="nc bnc" id="L912" title="All 50 branches missed.">                        if ((ListenerUtil.mutListener.listen(15815) ? (!checkDone || (ListenerUtil.mutListener.listen(15814) ? (child.getDepth() &gt;= depth) : (ListenerUtil.mutListener.listen(15813) ? (child.getDepth() &lt;= depth) : (ListenerUtil.mutListener.listen(15812) ? (child.getDepth() &gt; depth) : (ListenerUtil.mutListener.listen(15811) ? (child.getDepth() &lt; depth) : (ListenerUtil.mutListener.listen(15810) ? (child.getDepth() == depth) : (child.getDepth() != depth))))))) : (!checkDone &amp;&amp; (ListenerUtil.mutListener.listen(15814) ? (child.getDepth() &gt;= depth) : (ListenerUtil.mutListener.listen(15813) ? (child.getDepth() &lt;= depth) : (ListenerUtil.mutListener.listen(15812) ? (child.getDepth() &gt; depth) : (ListenerUtil.mutListener.listen(15811) ? (child.getDepth() &lt; depth) : (ListenerUtil.mutListener.listen(15810) ? (child.getDepth() == depth) : (child.getDepth() != depth))))))))) {</span>
<span class="nc" id="L913">                            Deck deck = mCol.getDecks().get(child.getDid());</span>
<span class="nc bnc" id="L914" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(15816)) {</span>
<span class="nc" id="L915">                                Timber.d(&quot;Deck %s (%d)'s parent is missing. Ignoring for quick display.&quot;, deck.getString(&quot;name&quot;), child.getDid());</span>
                            }
                            continue;
                        }
                    }
<span class="nc bnc" id="L920" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15829)) {</span>
                        {
<span class="nc" id="L922">                            long _loopCounter307 = 0;</span>
<span class="nc bnc" id="L923" title="All 2 branches missed.">                            while (it.hasNext()) {</span>
<span class="nc" id="L924">                                ListenerUtil.loopListener.listen(&quot;_loopCounter307&quot;, ++_loopCounter307);</span>
<span class="nc" id="L925">                                T descendantOfChild = it.next();</span>
<span class="nc bnc" id="L926" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(15828)) {</span>
<span class="nc bnc" id="L927" title="All 2 branches missed.">                                    if (head.equals(descendantOfChild.getDeckNameComponent(depth))) {</span>
<span class="nc bnc" id="L928" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(15826)) {</span>
                                            // Same head - add to tail of current head.
<span class="nc bnc" id="L930" title="All 50 branches missed.">                                            if ((ListenerUtil.mutListener.listen(15824) ? (!checkDone || (ListenerUtil.mutListener.listen(15823) ? (descendantOfChild.getDepth() &gt;= depth) : (ListenerUtil.mutListener.listen(15822) ? (descendantOfChild.getDepth() &lt;= depth) : (ListenerUtil.mutListener.listen(15821) ? (descendantOfChild.getDepth() &gt; depth) : (ListenerUtil.mutListener.listen(15820) ? (descendantOfChild.getDepth() &lt; depth) : (ListenerUtil.mutListener.listen(15819) ? (descendantOfChild.getDepth() != depth) : (descendantOfChild.getDepth() == depth))))))) : (!checkDone &amp;&amp; (ListenerUtil.mutListener.listen(15823) ? (descendantOfChild.getDepth() &gt;= depth) : (ListenerUtil.mutListener.listen(15822) ? (descendantOfChild.getDepth() &lt;= depth) : (ListenerUtil.mutListener.listen(15821) ? (descendantOfChild.getDepth() &gt; depth) : (ListenerUtil.mutListener.listen(15820) ? (descendantOfChild.getDepth() &lt; depth) : (ListenerUtil.mutListener.listen(15819) ? (descendantOfChild.getDepth() != depth) : (descendantOfChild.getDepth() == depth))))))))) {</span>
<span class="nc" id="L931">                                                Deck deck = mCol.getDecks().get(descendantOfChild.getDid());</span>
<span class="nc bnc" id="L932" title="All 2 branches missed.">                                                if (!ListenerUtil.mutListener.listen(15825)) {</span>
<span class="nc" id="L933">                                                    Timber.d(&quot;Deck %s (%d)'s is a duplicate name. Ignoring for quick display.&quot;, deck.getString(&quot;name&quot;), descendantOfChild.getDid());</span>
                                                }
                                                continue;
                                            }
                                        }
<span class="nc bnc" id="L938" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(15827)) {</span>
<span class="nc" id="L939">                                            descendantsOfChild.add(descendantOfChild);</span>
                                        }
                                    } else {
<span class="nc bnc" id="L942" title="All 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(15818)) {</span>
                                            // head in the next iteration of the outer loop.
<span class="nc" id="L944">                                            it.previous();</span>
                                        }
                                        break;
                                    }
                                }
<span class="nc" id="L949">                            }</span>
                        }
                    }
                    // the children_sDescendant set contains direct children_sDescendant but not the children_sDescendant of children_sDescendant...
<span class="nc bnc" id="L953" title="All 8 branches missed.">                    List&lt;T&gt; childrenNode = _groupChildrenMain(descendantsOfChild, (ListenerUtil.mutListener.listen(15833) ? (depth % 1) : (ListenerUtil.mutListener.listen(15832) ? (depth / 1) : (ListenerUtil.mutListener.listen(15831) ? (depth * 1) : (ListenerUtil.mutListener.listen(15830) ? (depth - 1) : (depth + 1))))), checkDone);</span>
<span class="nc bnc" id="L954" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15834)) {</span>
<span class="nc" id="L955">                        child.setChildren(childrenNode, &quot;std&quot;.equals(getName()));</span>
                    }
<span class="nc bnc" id="L957" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15835)) {</span>
<span class="nc" id="L958">                        children.add(child);</span>
                    }
<span class="nc" id="L960">                }</span>
            }
        }
<span class="nc" id="L963">        return children;</span>
    }

    /**
     * Return the next due card, or null.
     * Overridden: V1 does not allow dayLearnFirst
     */
    @Nullable
    protected Card _getCard() {
        // learning card due?
        @Nullable
<span class="fc" id="L974">        Card c = _getLrnCard(false);</span>
<span class="pc bpc" id="L975" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15837)) {</span>
<span class="pc bpc" id="L976" title="1 of 2 branches missed.">            if (c != null) {</span>
<span class="nc" id="L977">                return c;</span>
            }
        }
<span class="pc bpc" id="L980" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15840)) {</span>
            // new first, or time for one?
<span class="pc bpc" id="L982" title="1 of 2 branches missed.">            if (_timeForNewCard()) {</span>
<span class="nc bnc" id="L983" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15838)) {</span>
<span class="nc" id="L984">                    c = _getNewCard();</span>
                }
<span class="nc bnc" id="L986" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15839)) {</span>
<span class="nc bnc" id="L987" title="All 2 branches missed.">                    if (c != null) {</span>
<span class="nc" id="L988">                        return c;</span>
                    }
                }
            }
        }
        // Day learning first and card due?
<span class="fc" id="L994">        boolean dayLearnFirst = mCol.getConf().optBoolean(&quot;dayLearnFirst&quot;, false);</span>
<span class="pc bpc" id="L995" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15843)) {</span>
<span class="pc bpc" id="L996" title="1 of 2 branches missed.">            if (dayLearnFirst) {</span>
<span class="nc bnc" id="L997" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15841)) {</span>
<span class="nc" id="L998">                    c = _getLrnDayCard();</span>
                }
<span class="nc bnc" id="L1000" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15842)) {</span>
<span class="nc bnc" id="L1001" title="All 2 branches missed.">                    if (c != null) {</span>
<span class="nc" id="L1002">                        return c;</span>
                    }
                }
            }
        }
<span class="pc bpc" id="L1007" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15844)) {</span>
            // Card due for review?
<span class="fc" id="L1009">            c = _getRevCard();</span>
        }
<span class="pc bpc" id="L1011" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15845)) {</span>
<span class="pc bpc" id="L1012" title="1 of 2 branches missed.">            if (c != null) {</span>
<span class="nc" id="L1013">                return c;</span>
            }
        }
<span class="pc bpc" id="L1016" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15848)) {</span>
            // day learning card due?
<span class="pc bpc" id="L1018" title="1 of 2 branches missed.">            if (!dayLearnFirst) {</span>
<span class="pc bpc" id="L1019" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15846)) {</span>
<span class="fc" id="L1020">                    c = _getLrnDayCard();</span>
                }
<span class="pc bpc" id="L1022" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15847)) {</span>
<span class="pc bpc" id="L1023" title="1 of 2 branches missed.">                    if (c != null) {</span>
<span class="nc" id="L1024">                        return c;</span>
                    }
                }
            }
        }
<span class="pc bpc" id="L1029" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15849)) {</span>
            // New cards left?
<span class="fc" id="L1031">            c = _getNewCard();</span>
        }
<span class="pc bpc" id="L1033" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15850)) {</span>
<span class="pc bpc" id="L1034" title="1 of 2 branches missed.">            if (c != null) {</span>
<span class="fc" id="L1035">                return c;</span>
            }
        }
        // collapse or finish
<span class="nc" id="L1039">        return _getLrnCard(true);</span>
    }

    /**
     * similar to _getCard but only fill the queues without taking the card.
     * Returns lists that may contain the next cards.
     */
    @NonNull
    protected CardQueue&lt;? extends Card.Cache&gt;[] _fillNextCard() {
<span class="nc bnc" id="L1048" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15851)) {</span>
            // learning card due?
<span class="nc bnc" id="L1050" title="All 2 branches missed.">            if (_preloadLrnCard(false)) {</span>
<span class="nc" id="L1051">                return new CardQueue&lt;?&gt;[] { mLrnQueue };</span>
            }
        }
<span class="nc bnc" id="L1054" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15853)) {</span>
            // new first, or time for one?
<span class="nc bnc" id="L1056" title="All 2 branches missed.">            if (_timeForNewCard()) {</span>
<span class="nc bnc" id="L1057" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15852)) {</span>
<span class="nc bnc" id="L1058" title="All 2 branches missed.">                    if (_fillNew()) {</span>
<span class="nc" id="L1059">                        return new CardQueue&lt;?&gt;[] { mLrnQueue, mNewQueue };</span>
                    }
                }
            }
        }
        // Day learning first and card due?
<span class="nc" id="L1065">        boolean dayLearnFirst = mCol.getConf().optBoolean(&quot;dayLearnFirst&quot;, false);</span>
<span class="nc bnc" id="L1066" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15855)) {</span>
<span class="nc bnc" id="L1067" title="All 2 branches missed.">            if (dayLearnFirst) {</span>
<span class="nc bnc" id="L1068" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15854)) {</span>
<span class="nc bnc" id="L1069" title="All 2 branches missed.">                    if (_fillLrnDay()) {</span>
<span class="nc" id="L1070">                        return new CardQueue&lt;?&gt;[] { mLrnQueue, mLrnDayQueue };</span>
                    }
                }
            }
        }
<span class="nc bnc" id="L1075" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15856)) {</span>
            // Card due for review?
<span class="nc bnc" id="L1077" title="All 2 branches missed.">            if (_fillRev()) {</span>
<span class="nc" id="L1078">                return new CardQueue&lt;?&gt;[] { mLrnQueue, mRevQueue };</span>
            }
        }
<span class="nc bnc" id="L1081" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15858)) {</span>
            // day learning card due?
<span class="nc bnc" id="L1083" title="All 2 branches missed.">            if (!dayLearnFirst) {</span>
<span class="nc bnc" id="L1084" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15857)) {</span>
<span class="nc bnc" id="L1085" title="All 2 branches missed.">                    if (_fillLrnDay()) {</span>
<span class="nc" id="L1086">                        return new CardQueue&lt;?&gt;[] { mLrnQueue, mLrnDayQueue };</span>
                    }
                }
            }
        }
<span class="nc bnc" id="L1091" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15859)) {</span>
            // New cards left?
<span class="nc bnc" id="L1093" title="All 2 branches missed.">            if (_fillNew()) {</span>
<span class="nc" id="L1094">                return new CardQueue&lt;?&gt;[] { mLrnQueue, mNewQueue };</span>
            }
        }
<span class="nc bnc" id="L1097" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15860)) {</span>
            // collapse or finish
<span class="nc bnc" id="L1099" title="All 2 branches missed.">            if (_preloadLrnCard(true)) {</span>
<span class="nc" id="L1100">                return new CardQueue&lt;?&gt;[] { mLrnQueue };</span>
            }
        }
<span class="nc" id="L1103">        return new CardQueue&lt;?&gt;[] {};</span>
    }

    /**
     * pre load the potential next card. It may loads many card because, depending on the time taken, the next card may
     * be a card in review or not.
     */
    public void preloadNextCard() {
<span class="nc bnc" id="L1111" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15861)) {</span>
<span class="nc" id="L1112">            _checkDay();</span>
        }
<span class="nc bnc" id="L1114" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15863)) {</span>
<span class="nc bnc" id="L1115" title="All 2 branches missed.">            if (!mHaveCounts) {</span>
<span class="nc bnc" id="L1116" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15862)) {</span>
<span class="nc" id="L1117">                    resetCounts(false);</span>
                }
            }
        }
<span class="nc bnc" id="L1121" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15865)) {</span>
<span class="nc bnc" id="L1122" title="All 2 branches missed.">            if (!mHaveQueues) {</span>
<span class="nc bnc" id="L1123" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15864)) {</span>
<span class="nc" id="L1124">                    resetQueues(false);</span>
                }
            }
        }
<span class="nc bnc" id="L1128" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15867)) {</span>
            {
<span class="nc" id="L1130">                long _loopCounter309 = 0;</span>
<span class="nc bnc" id="L1131" title="All 2 branches missed.">                for (CardQueue&lt;? extends Card.Cache&gt; caches : _fillNextCard()) {</span>
<span class="nc" id="L1132">                    ListenerUtil.loopListener.listen(&quot;_loopCounter309&quot;, ++_loopCounter309);</span>
<span class="nc bnc" id="L1133" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15866)) {</span>
<span class="nc" id="L1134">                        caches.loadFirstCard();</span>
                    }
                }
            }
        }
<span class="nc" id="L1139">    }</span>

    protected void _resetNewCount() {
<span class="nc bnc" id="L1142" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15868)) {</span>
<span class="nc" id="L1143">            _resetNewCount(null);</span>
        }
<span class="nc" id="L1145">    }</span>

    protected void _resetNewCount(@Nullable CancelListener cancelListener) {
<span class="pc bpc" id="L1148" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15869)) {</span>
<span class="fc" id="L1149">            mNewCount = _walkingCount(g -&gt; _deckNewLimitSingle(g, true), this::_cntFnNew, cancelListener);</span>
        }
<span class="fc" id="L1151">    }</span>

    // Used as an argument for _walkingCount() in _resetNewCount() above
    @SuppressWarnings(&quot;unused&quot;)
    protected int _cntFnNew(long did, int lim) {
<span class="fc" id="L1156">        return mCol.getDb().queryScalar(&quot;SELECT count() FROM (SELECT 1 FROM cards WHERE did = ? AND queue = &quot; + Consts.QUEUE_TYPE_NEW + &quot; AND id != ? LIMIT ?)&quot;, did, currentCardId(), lim);</span>
    }

    private void _resetNew() {
<span class="nc bnc" id="L1160" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15870)) {</span>
<span class="nc" id="L1161">            _resetNewCount();</span>
        }
<span class="nc bnc" id="L1163" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15871)) {</span>
<span class="nc" id="L1164">            _resetNewQueue();</span>
        }
<span class="nc" id="L1166">    }</span>

    private void _resetNewQueue() {
<span class="pc bpc" id="L1169" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15872)) {</span>
<span class="fc" id="L1170">            mNewDids = new LinkedList&lt;&gt;(mCol.getDecks().active());</span>
        }
<span class="pc bpc" id="L1172" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15873)) {</span>
<span class="fc" id="L1173">            mNewQueue.clear();</span>
        }
<span class="pc bpc" id="L1175" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15874)) {</span>
<span class="fc" id="L1176">            _updateNewCardRatio();</span>
        }
<span class="fc" id="L1178">    }</span>

    /**
     *        @return The id of the note currently in the reviewer. 0 if no
     *        such card.
     */
    protected long currentCardNid() {
<span class="fc" id="L1185">        Card currentCard = mCurrentCard;</span>
<span class="pc bpc" id="L1186" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15875)) {</span>
            /* mCurrentCard may be set to null when the reviewer gets closed. So we copy it to be sure to avoid
           NullPointerException */
<span class="pc bpc" id="L1189" title="1 of 2 branches missed.">            if (mCurrentCard == null) {</span>
                /* This method is used to determine whether two cards are siblings. Since 0 is not a valid nid, all cards
            will have a nid distinct from 0. As it is used in sql statement, it is not possible to just use a function
            areSiblings()*/
<span class="fc" id="L1193">                return 0;</span>
            }
        }
<span class="nc" id="L1196">        return currentCard.getNid();</span>
    }

    /**
     *        @return The id of the card currently in the reviewer. 0 if no
     *        such card.
     */
    protected long currentCardId() {
<span class="pc bpc" id="L1204" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15876)) {</span>
<span class="fc bfc" id="L1205" title="All 2 branches covered.">            if (mCurrentCard == null) {</span>
                /* This method is used to ensure that query don't return current card. Since 0 is not a valid nid, all cards
            will have a nid distinct from 0. As it is used in sql statement, it is not possible to just use a function
            areSiblings()*/
<span class="fc" id="L1209">                return 0;</span>
            }
        }
<span class="fc" id="L1212">        return mCurrentCard.getId();</span>
    }

    protected boolean _fillNew() {
<span class="fc" id="L1216">        return _fillNew(false);</span>
    }

    private boolean _fillNew(boolean allowSibling) {
<span class="pc bpc" id="L1220" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15877)) {</span>
<span class="pc bpc" id="L1221" title="1 of 2 branches missed.">            if (!mNewQueue.isEmpty()) {</span>
<span class="nc" id="L1222">                return true;</span>
            }
        }
<span class="pc bpc" id="L1225" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15884)) {</span>
<span class="pc bpc" id="L1226" title="48 of 50 branches missed.">            if ((ListenerUtil.mutListener.listen(15883) ? (mHaveCounts || (ListenerUtil.mutListener.listen(15882) ? (mNewCount &gt;= 0) : (ListenerUtil.mutListener.listen(15881) ? (mNewCount &lt;= 0) : (ListenerUtil.mutListener.listen(15880) ? (mNewCount &gt; 0) : (ListenerUtil.mutListener.listen(15879) ? (mNewCount &lt; 0) : (ListenerUtil.mutListener.listen(15878) ? (mNewCount != 0) : (mNewCount == 0))))))) : (mHaveCounts &amp;&amp; (ListenerUtil.mutListener.listen(15882) ? (mNewCount &gt;= 0) : (ListenerUtil.mutListener.listen(15881) ? (mNewCount &lt;= 0) : (ListenerUtil.mutListener.listen(15880) ? (mNewCount &gt; 0) : (ListenerUtil.mutListener.listen(15879) ? (mNewCount &lt; 0) : (ListenerUtil.mutListener.listen(15878) ? (mNewCount != 0) : (mNewCount == 0))))))))) {</span>
<span class="nc" id="L1227">                return false;</span>
            }
        }
<span class="pc bpc" id="L1230" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15896)) {</span>
            {
<span class="fc" id="L1232">                long _loopCounter311 = 0;</span>
<span class="pc bpc" id="L1233" title="1 of 2 branches missed.">                while (!mNewDids.isEmpty()) {</span>
<span class="fc" id="L1234">                    ListenerUtil.loopListener.listen(&quot;_loopCounter311&quot;, ++_loopCounter311);</span>
<span class="fc" id="L1235">                    long did = mNewDids.getFirst();</span>
<span class="fc" id="L1236">                    int lim = Math.min(mQueueLimit, _deckNewLimit(did, true));</span>
<span class="pc bpc" id="L1237" title="1 of 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15894)) {</span>
<span class="pc bpc" id="L1238" title="16 of 22 branches missed.">                        if ((ListenerUtil.mutListener.listen(15889) ? (lim &gt;= 0) : (ListenerUtil.mutListener.listen(15888) ? (lim &lt;= 0) : (ListenerUtil.mutListener.listen(15887) ? (lim &gt; 0) : (ListenerUtil.mutListener.listen(15886) ? (lim &lt; 0) : (ListenerUtil.mutListener.listen(15885) ? (lim == 0) : (lim != 0))))))) {</span>
<span class="pc bpc" id="L1239" title="1 of 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(15890)) {</span>
<span class="fc" id="L1240">                                mNewQueue.clear();</span>
                            }
<span class="pc bpc" id="L1242" title="1 of 2 branches missed.">                            String idName = (allowSibling) ? &quot;id&quot; : &quot;nid&quot;;</span>
<span class="pc bpc" id="L1243" title="1 of 2 branches missed.">                            long id = (allowSibling) ? currentCardId() : currentCardNid();</span>
<span class="pc bpc" id="L1244" title="1 of 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(15892)) {</span>
                                {
<span class="fc" id="L1246">                                    long _loopCounter310 = 0;</span>
                                    // fill the queue with the current did
<span class="fc bfc" id="L1248" title="All 2 branches covered.">                                    for (long cid : mCol.getDb().queryLongList(&quot;SELECT id FROM cards WHERE did = ? AND queue = &quot; + Consts.QUEUE_TYPE_NEW + &quot; AND &quot; + idName + &quot;!= ? ORDER BY due, ord LIMIT ?&quot;, did, id, lim)) {</span>
<span class="fc" id="L1249">                                        ListenerUtil.loopListener.listen(&quot;_loopCounter310&quot;, ++_loopCounter310);</span>
<span class="pc bpc" id="L1250" title="1 of 2 branches missed.">                                        if (!ListenerUtil.mutListener.listen(15891)) {</span>
<span class="fc" id="L1251">                                            mNewQueue.add(cid);</span>
                                        }
<span class="fc" id="L1253">                                    }</span>
                                }
                            }
<span class="pc bpc" id="L1256" title="1 of 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(15893)) {</span>
<span class="pc bpc" id="L1257" title="1 of 2 branches missed.">                                if (!mNewQueue.isEmpty()) {</span>
                                    // in _getNewCard().
<span class="fc" id="L1259">                                    return true;</span>
                                }
                            }
                        }
                    }
<span class="nc bnc" id="L1264" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15895)) {</span>
                        // nothing left in the deck; move to next
<span class="nc" id="L1266">                        mNewDids.remove();</span>
                    }
<span class="nc" id="L1268">                }</span>
            }
        }
<span class="nc bnc" id="L1271" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15904)) {</span>
<span class="nc bnc" id="L1272" title="All 50 branches missed.">            if ((ListenerUtil.mutListener.listen(15902) ? (mHaveCounts || (ListenerUtil.mutListener.listen(15901) ? (mNewCount &gt;= 0) : (ListenerUtil.mutListener.listen(15900) ? (mNewCount &lt;= 0) : (ListenerUtil.mutListener.listen(15899) ? (mNewCount &gt; 0) : (ListenerUtil.mutListener.listen(15898) ? (mNewCount &lt; 0) : (ListenerUtil.mutListener.listen(15897) ? (mNewCount == 0) : (mNewCount != 0))))))) : (mHaveCounts &amp;&amp; (ListenerUtil.mutListener.listen(15901) ? (mNewCount &gt;= 0) : (ListenerUtil.mutListener.listen(15900) ? (mNewCount &lt;= 0) : (ListenerUtil.mutListener.listen(15899) ? (mNewCount &gt; 0) : (ListenerUtil.mutListener.listen(15898) ? (mNewCount &lt; 0) : (ListenerUtil.mutListener.listen(15897) ? (mNewCount == 0) : (mNewCount != 0))))))))) {</span>
<span class="nc bnc" id="L1273" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15903)) {</span>
                    // removed from the queue but not buried
<span class="nc" id="L1275">                    _resetNew();</span>
                }
<span class="nc" id="L1277">                return _fillNew(true);</span>
            }
        }
<span class="nc" id="L1280">        return false;</span>
    }

    @Nullable
    protected Card _getNewCard() {
<span class="pc bpc" id="L1285" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15905)) {</span>
<span class="pc bpc" id="L1286" title="1 of 2 branches missed.">            if (_fillNew()) {</span>
                // mNewCount -= 1; see decrementCounts()
<span class="fc" id="L1288">                return mNewQueue.removeFirstCard();</span>
            }
        }
<span class="nc" id="L1291">        return null;</span>
    }

    private void _updateNewCardRatio() {
<span class="pc bpc" id="L1295" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15933)) {</span>
<span class="pc bpc" id="L1296" title="16 of 22 branches missed.">            if ((ListenerUtil.mutListener.listen(15910) ? (mCol.getConf().getInt(&quot;newSpread&quot;) &gt;= Consts.NEW_CARDS_DISTRIBUTE) : (ListenerUtil.mutListener.listen(15909) ? (mCol.getConf().getInt(&quot;newSpread&quot;) &lt;= Consts.NEW_CARDS_DISTRIBUTE) : (ListenerUtil.mutListener.listen(15908) ? (mCol.getConf().getInt(&quot;newSpread&quot;) &gt; Consts.NEW_CARDS_DISTRIBUTE) : (ListenerUtil.mutListener.listen(15907) ? (mCol.getConf().getInt(&quot;newSpread&quot;) &lt; Consts.NEW_CARDS_DISTRIBUTE) : (ListenerUtil.mutListener.listen(15906) ? (mCol.getConf().getInt(&quot;newSpread&quot;) != Consts.NEW_CARDS_DISTRIBUTE) : (mCol.getConf().getInt(&quot;newSpread&quot;) == Consts.NEW_CARDS_DISTRIBUTE))))))) {</span>
<span class="pc bpc" id="L1297" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15932)) {</span>
<span class="pc bpc" id="L1298" title="16 of 22 branches missed.">                    if ((ListenerUtil.mutListener.listen(15915) ? (mNewCount &gt;= 0) : (ListenerUtil.mutListener.listen(15914) ? (mNewCount &lt;= 0) : (ListenerUtil.mutListener.listen(15913) ? (mNewCount &gt; 0) : (ListenerUtil.mutListener.listen(15912) ? (mNewCount &lt; 0) : (ListenerUtil.mutListener.listen(15911) ? (mNewCount == 0) : (mNewCount != 0))))))) {</span>
<span class="nc bnc" id="L1299" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(15924)) {</span>
<span class="nc bnc" id="L1300" title="All 48 branches missed.">                            mNewCardModulus = (ListenerUtil.mutListener.listen(15923) ? (((ListenerUtil.mutListener.listen(15919) ? (mNewCount % mRevCount) : (ListenerUtil.mutListener.listen(15918) ? (mNewCount / mRevCount) : (ListenerUtil.mutListener.listen(15917) ? (mNewCount * mRevCount) : (ListenerUtil.mutListener.listen(15916) ? (mNewCount - mRevCount) : (mNewCount + mRevCount)))))) % mNewCount) : (ListenerUtil.mutListener.listen(15922) ? (((ListenerUtil.mutListener.listen(15919) ? (mNewCount % mRevCount) : (ListenerUtil.mutListener.listen(15918) ? (mNewCount / mRevCount) : (ListenerUtil.mutListener.listen(15917) ? (mNewCount * mRevCount) : (ListenerUtil.mutListener.listen(15916) ? (mNewCount - mRevCount) : (mNewCount + mRevCount)))))) * mNewCount) : (ListenerUtil.mutListener.listen(15921) ? (((ListenerUtil.mutListener.listen(15919) ? (mNewCount % mRevCount) : (ListenerUtil.mutListener.listen(15918) ? (mNewCount / mRevCount) : (ListenerUtil.mutListener.listen(15917) ? (mNewCount * mRevCount) : (ListenerUtil.mutListener.listen(15916) ? (mNewCount - mRevCount) : (mNewCount + mRevCount)))))) - mNewCount) : (ListenerUtil.mutListener.listen(15920) ? (((ListenerUtil.mutListener.listen(15919) ? (mNewCount % mRevCount) : (ListenerUtil.mutListener.listen(15918) ? (mNewCount / mRevCount) : (ListenerUtil.mutListener.listen(15917) ? (mNewCount * mRevCount) : (ListenerUtil.mutListener.listen(15916) ? (mNewCount - mRevCount) : (mNewCount + mRevCount)))))) + mNewCount) : (((ListenerUtil.mutListener.listen(15919) ? (mNewCount % mRevCount) : (ListenerUtil.mutListener.listen(15918) ? (mNewCount / mRevCount) : (ListenerUtil.mutListener.listen(15917) ? (mNewCount * mRevCount) : (ListenerUtil.mutListener.listen(15916) ? (mNewCount - mRevCount) : (mNewCount + mRevCount)))))) / mNewCount)))));</span>
                        }
<span class="nc bnc" id="L1302" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(15931)) {</span>
                            // if there are cards to review, ensure modulo &gt;= 2
<span class="nc bnc" id="L1304" title="All 22 branches missed.">                            if ((ListenerUtil.mutListener.listen(15929) ? (mRevCount &gt;= 0) : (ListenerUtil.mutListener.listen(15928) ? (mRevCount &lt;= 0) : (ListenerUtil.mutListener.listen(15927) ? (mRevCount &gt; 0) : (ListenerUtil.mutListener.listen(15926) ? (mRevCount &lt; 0) : (ListenerUtil.mutListener.listen(15925) ? (mRevCount == 0) : (mRevCount != 0))))))) {</span>
<span class="nc bnc" id="L1305" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(15930)) {</span>
<span class="nc" id="L1306">                                    mNewCardModulus = Math.max(2, mNewCardModulus);</span>
                                }
                            }
                        }
<span class="nc" id="L1310">                        return;</span>
                    }
                }
            }
        }
<span class="pc bpc" id="L1315" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15934)) {</span>
<span class="fc" id="L1316">            mNewCardModulus = 0;</span>
        }
<span class="fc" id="L1318">    }</span>

    /**
     * @return True if it's time to display a new card when distributing.
     */
    protected boolean _timeForNewCard() {
<span class="pc bpc" id="L1324" title="48 of 50 branches missed.">        if ((ListenerUtil.mutListener.listen(15940) ? (mHaveCounts || (ListenerUtil.mutListener.listen(15939) ? (mNewCount &gt;= 0) : (ListenerUtil.mutListener.listen(15938) ? (mNewCount &lt;= 0) : (ListenerUtil.mutListener.listen(15937) ? (mNewCount &gt; 0) : (ListenerUtil.mutListener.listen(15936) ? (mNewCount &lt; 0) : (ListenerUtil.mutListener.listen(15935) ? (mNewCount != 0) : (mNewCount == 0))))))) : (mHaveCounts &amp;&amp; (ListenerUtil.mutListener.listen(15939) ? (mNewCount &gt;= 0) : (ListenerUtil.mutListener.listen(15938) ? (mNewCount &lt;= 0) : (ListenerUtil.mutListener.listen(15937) ? (mNewCount &gt; 0) : (ListenerUtil.mutListener.listen(15936) ? (mNewCount &lt; 0) : (ListenerUtil.mutListener.listen(15935) ? (mNewCount != 0) : (mNewCount == 0))))))))) {</span>
<span class="nc" id="L1325">            return false;</span>
        }
        @Consts.NEW_CARD_ORDER
<span class="fc" id="L1328">        int spread = mCol.getConf().getInt(&quot;newSpread&quot;);</span>
<span class="pc bpc" id="L1329" title="16 of 22 branches missed.">        if ((ListenerUtil.mutListener.listen(15945) ? (spread &gt;= Consts.NEW_CARDS_LAST) : (ListenerUtil.mutListener.listen(15944) ? (spread &lt;= Consts.NEW_CARDS_LAST) : (ListenerUtil.mutListener.listen(15943) ? (spread &gt; Consts.NEW_CARDS_LAST) : (ListenerUtil.mutListener.listen(15942) ? (spread &lt; Consts.NEW_CARDS_LAST) : (ListenerUtil.mutListener.listen(15941) ? (spread != Consts.NEW_CARDS_LAST) : (spread == Consts.NEW_CARDS_LAST))))))) {</span>
<span class="nc" id="L1330">            return false;</span>
<span class="pc bpc" id="L1331" title="16 of 22 branches missed.">        } else if ((ListenerUtil.mutListener.listen(15950) ? (spread &gt;= Consts.NEW_CARDS_FIRST) : (ListenerUtil.mutListener.listen(15949) ? (spread &lt;= Consts.NEW_CARDS_FIRST) : (ListenerUtil.mutListener.listen(15948) ? (spread &gt; Consts.NEW_CARDS_FIRST) : (ListenerUtil.mutListener.listen(15947) ? (spread &lt; Consts.NEW_CARDS_FIRST) : (ListenerUtil.mutListener.listen(15946) ? (spread != Consts.NEW_CARDS_FIRST) : (spread == Consts.NEW_CARDS_FIRST))))))) {</span>
<span class="nc" id="L1332">            return true;</span>
<span class="pc bpc" id="L1333" title="16 of 22 branches missed.">        } else if ((ListenerUtil.mutListener.listen(15955) ? (mNewCardModulus &gt;= 0) : (ListenerUtil.mutListener.listen(15954) ? (mNewCardModulus &lt;= 0) : (ListenerUtil.mutListener.listen(15953) ? (mNewCardModulus &gt; 0) : (ListenerUtil.mutListener.listen(15952) ? (mNewCardModulus &lt; 0) : (ListenerUtil.mutListener.listen(15951) ? (mNewCardModulus == 0) : (mNewCardModulus != 0))))))) {</span>
            // random. This will occur only for the first card of review.
<span class="nc bnc" id="L1335" title="All 186 branches missed.">            return ((ListenerUtil.mutListener.listen(15970) ? ((ListenerUtil.mutListener.listen(15960) ? (mReps &gt;= 0) : (ListenerUtil.mutListener.listen(15959) ? (mReps &lt;= 0) : (ListenerUtil.mutListener.listen(15958) ? (mReps &gt; 0) : (ListenerUtil.mutListener.listen(15957) ? (mReps &lt; 0) : (ListenerUtil.mutListener.listen(15956) ? (mReps == 0) : (mReps != 0)))))) || ((ListenerUtil.mutListener.listen(15969) ? ((ListenerUtil.mutListener.listen(15964) ? (mReps / mNewCardModulus) : (ListenerUtil.mutListener.listen(15963) ? (mReps * mNewCardModulus) : (ListenerUtil.mutListener.listen(15962) ? (mReps - mNewCardModulus) : (ListenerUtil.mutListener.listen(15961) ? (mReps + mNewCardModulus) : (mReps % mNewCardModulus))))) &gt;= 0) : (ListenerUtil.mutListener.listen(15968) ? ((ListenerUtil.mutListener.listen(15964) ? (mReps / mNewCardModulus) : (ListenerUtil.mutListener.listen(15963) ? (mReps * mNewCardModulus) : (ListenerUtil.mutListener.listen(15962) ? (mReps - mNewCardModulus) : (ListenerUtil.mutListener.listen(15961) ? (mReps + mNewCardModulus) : (mReps % mNewCardModulus))))) &lt;= 0) : (ListenerUtil.mutListener.listen(15967) ? ((ListenerUtil.mutListener.listen(15964) ? (mReps / mNewCardModulus) : (ListenerUtil.mutListener.listen(15963) ? (mReps * mNewCardModulus) : (ListenerUtil.mutListener.listen(15962) ? (mReps - mNewCardModulus) : (ListenerUtil.mutListener.listen(15961) ? (mReps + mNewCardModulus) : (mReps % mNewCardModulus))))) &gt; 0) : (ListenerUtil.mutListener.listen(15966) ? ((ListenerUtil.mutListener.listen(15964) ? (mReps / mNewCardModulus) : (ListenerUtil.mutListener.listen(15963) ? (mReps * mNewCardModulus) : (ListenerUtil.mutListener.listen(15962) ? (mReps - mNewCardModulus) : (ListenerUtil.mutListener.listen(15961) ? (mReps + mNewCardModulus) : (mReps % mNewCardModulus))))) &lt; 0) : (ListenerUtil.mutListener.listen(15965) ? ((ListenerUtil.mutListener.listen(15964) ? (mReps / mNewCardModulus) : (ListenerUtil.mutListener.listen(15963) ? (mReps * mNewCardModulus) : (ListenerUtil.mutListener.listen(15962) ? (mReps - mNewCardModulus) : (ListenerUtil.mutListener.listen(15961) ? (mReps + mNewCardModulus) : (mReps % mNewCardModulus))))) != 0) : ((ListenerUtil.mutListener.listen(15964) ? (mReps / mNewCardModulus) : (ListenerUtil.mutListener.listen(15963) ? (mReps * mNewCardModulus) : (ListenerUtil.mutListener.listen(15962) ? (mReps - mNewCardModulus) : (ListenerUtil.mutListener.listen(15961) ? (mReps + mNewCardModulus) : (mReps % mNewCardModulus))))) == 0)))))))) : ((ListenerUtil.mutListener.listen(15960) ? (mReps &gt;= 0) : (ListenerUtil.mutListener.listen(15959) ? (mReps &lt;= 0) : (ListenerUtil.mutListener.listen(15958) ? (mReps &gt; 0) : (ListenerUtil.mutListener.listen(15957) ? (mReps &lt; 0) : (ListenerUtil.mutListener.listen(15956) ? (mReps == 0) : (mReps != 0)))))) &amp;&amp; ((ListenerUtil.mutListener.listen(15969) ? ((ListenerUtil.mutListener.listen(15964) ? (mReps / mNewCardModulus) : (ListenerUtil.mutListener.listen(15963) ? (mReps * mNewCardModulus) : (ListenerUtil.mutListener.listen(15962) ? (mReps - mNewCardModulus) : (ListenerUtil.mutListener.listen(15961) ? (mReps + mNewCardModulus) : (mReps % mNewCardModulus))))) &gt;= 0) : (ListenerUtil.mutListener.listen(15968) ? ((ListenerUtil.mutListener.listen(15964) ? (mReps / mNewCardModulus) : (ListenerUtil.mutListener.listen(15963) ? (mReps * mNewCardModulus) : (ListenerUtil.mutListener.listen(15962) ? (mReps - mNewCardModulus) : (ListenerUtil.mutListener.listen(15961) ? (mReps + mNewCardModulus) : (mReps % mNewCardModulus))))) &lt;= 0) : (ListenerUtil.mutListener.listen(15967) ? ((ListenerUtil.mutListener.listen(15964) ? (mReps / mNewCardModulus) : (ListenerUtil.mutListener.listen(15963) ? (mReps * mNewCardModulus) : (ListenerUtil.mutListener.listen(15962) ? (mReps - mNewCardModulus) : (ListenerUtil.mutListener.listen(15961) ? (mReps + mNewCardModulus) : (mReps % mNewCardModulus))))) &gt; 0) : (ListenerUtil.mutListener.listen(15966) ? ((ListenerUtil.mutListener.listen(15964) ? (mReps / mNewCardModulus) : (ListenerUtil.mutListener.listen(15963) ? (mReps * mNewCardModulus) : (ListenerUtil.mutListener.listen(15962) ? (mReps - mNewCardModulus) : (ListenerUtil.mutListener.listen(15961) ? (mReps + mNewCardModulus) : (mReps % mNewCardModulus))))) &lt; 0) : (ListenerUtil.mutListener.listen(15965) ? ((ListenerUtil.mutListener.listen(15964) ? (mReps / mNewCardModulus) : (ListenerUtil.mutListener.listen(15963) ? (mReps * mNewCardModulus) : (ListenerUtil.mutListener.listen(15962) ? (mReps - mNewCardModulus) : (ListenerUtil.mutListener.listen(15961) ? (mReps + mNewCardModulus) : (mReps % mNewCardModulus))))) != 0) : ((ListenerUtil.mutListener.listen(15964) ? (mReps / mNewCardModulus) : (ListenerUtil.mutListener.listen(15963) ? (mReps * mNewCardModulus) : (ListenerUtil.mutListener.listen(15962) ? (mReps - mNewCardModulus) : (ListenerUtil.mutListener.listen(15961) ? (mReps + mNewCardModulus) : (mReps % mNewCardModulus))))) == 0))))))))));</span>
        } else {
<span class="fc" id="L1337">            return false;</span>
        }
    }

    /**
     * @param considerCurrentCard Whether current card should be counted if it is in this deck
     */
    protected int _deckNewLimit(long did, boolean considerCurrentCard) {
<span class="fc" id="L1345">        return _deckNewLimit(did, null, considerCurrentCard);</span>
    }

    /**
     * @param considerCurrentCard Whether current card should be counted if it is in this deck
     */
    protected int _deckNewLimit(long did, LimitMethod fn, boolean considerCurrentCard) {
<span class="pc bpc" id="L1352" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15972)) {</span>
<span class="pc bpc" id="L1353" title="1 of 2 branches missed.">            if (fn == null) {</span>
<span class="pc bpc" id="L1354" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15971)) {</span>
<span class="fc" id="L1355">                    fn = (g -&gt; _deckNewLimitSingle(g, considerCurrentCard));</span>
                }
            }
        }
        @NonNull
<span class="fc" id="L1360">        List&lt;Deck&gt; decks = mCol.getDecks().parents(did);</span>
<span class="pc bpc" id="L1361" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15973)) {</span>
<span class="fc" id="L1362">            decks.add(mCol.getDecks().get(did));</span>
        }
<span class="fc" id="L1364">        int lim = -1;</span>
        // for the deck and each of its parents
<span class="fc" id="L1366">        int rem = 0;</span>
<span class="pc bpc" id="L1367" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15983)) {</span>
            {
<span class="fc" id="L1369">                long _loopCounter312 = 0;</span>
<span class="fc bfc" id="L1370" title="All 2 branches covered.">                for (Deck g : decks) {</span>
<span class="fc" id="L1371">                    ListenerUtil.loopListener.listen(&quot;_loopCounter312&quot;, ++_loopCounter312);</span>
<span class="pc bpc" id="L1372" title="1 of 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15974)) {</span>
<span class="fc" id="L1373">                        rem = fn.operation(g);</span>
                    }
<span class="pc bpc" id="L1375" title="1 of 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(15982)) {</span>
<span class="pc bpc" id="L1376" title="16 of 22 branches missed.">                        if ((ListenerUtil.mutListener.listen(15979) ? (lim &gt;= -1) : (ListenerUtil.mutListener.listen(15978) ? (lim &lt;= -1) : (ListenerUtil.mutListener.listen(15977) ? (lim &gt; -1) : (ListenerUtil.mutListener.listen(15976) ? (lim &lt; -1) : (ListenerUtil.mutListener.listen(15975) ? (lim != -1) : (lim == -1))))))) {</span>
<span class="pc bpc" id="L1377" title="1 of 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(15981)) {</span>
<span class="fc" id="L1378">                                lim = rem;</span>
                            }
                        } else {
<span class="nc bnc" id="L1381" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(15980)) {</span>
<span class="nc" id="L1382">                                lim = Math.min(rem, lim);</span>
                            }
                        }
                    }
<span class="fc" id="L1386">                }</span>
            }
        }
<span class="fc" id="L1389">        return lim;</span>
    }

    /**
     * New count for a single deck.
     */
    public int _newForDeck(long did, int lim) {
<span class="nc bnc" id="L1396" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15989)) {</span>
<span class="nc bnc" id="L1397" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(15988) ? (lim &gt;= 0) : (ListenerUtil.mutListener.listen(15987) ? (lim &lt;= 0) : (ListenerUtil.mutListener.listen(15986) ? (lim &gt; 0) : (ListenerUtil.mutListener.listen(15985) ? (lim &lt; 0) : (ListenerUtil.mutListener.listen(15984) ? (lim != 0) : (lim == 0))))))) {</span>
<span class="nc" id="L1398">                return 0;</span>
            }
        }
<span class="nc bnc" id="L1401" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15990)) {</span>
<span class="nc" id="L1402">            lim = Math.min(lim, mReportLimit);</span>
        }
<span class="nc" id="L1404">        return mCol.getDb().queryScalar(&quot;SELECT count() FROM (SELECT 1 FROM cards WHERE did = ? AND queue = &quot; + Consts.QUEUE_TYPE_NEW + &quot; LIMIT ?)&quot;, did, lim);</span>
    }

    /**
     * Maximal number of new card still to see today in deck g. It's computed as:
     * the number of new card to see by day according to the deck optinos
     * minus the number of new cards seen today in deck d or a descendant
     * plus the number of extra new cards to see today in deck d, a parent or a descendant.
     *
     * Limits of its ancestors are not applied.
     * @param considerCurrentCard whether the current card should be taken from the limit (if it belongs to this deck)
     */
    public int _deckNewLimitSingle(@NonNull Deck g, boolean considerCurrentCard) {
<span class="pc bpc" id="L1417" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15991)) {</span>
<span class="pc bpc" id="L1418" title="1 of 2 branches missed.">            if (g.getInt(&quot;dyn&quot;) == DECK_DYN) {</span>
<span class="nc" id="L1419">                return mDynReportLimit;</span>
            }
        }
<span class="fc" id="L1422">        long did = g.getLong(&quot;id&quot;);</span>
        @NonNull
<span class="fc" id="L1424">        DeckConfig c = mCol.getDecks().confForDid(did);</span>
<span class="pc bpc" id="L1425" title="4 of 8 branches missed.">        int lim = Math.max(0, (ListenerUtil.mutListener.listen(15995) ? (c.getJSONObject(&quot;new&quot;).getInt(&quot;perDay&quot;) % g.getJSONArray(&quot;newToday&quot;).getInt(1)) : (ListenerUtil.mutListener.listen(15994) ? (c.getJSONObject(&quot;new&quot;).getInt(&quot;perDay&quot;) / g.getJSONArray(&quot;newToday&quot;).getInt(1)) : (ListenerUtil.mutListener.listen(15993) ? (c.getJSONObject(&quot;new&quot;).getInt(&quot;perDay&quot;) * g.getJSONArray(&quot;newToday&quot;).getInt(1)) : (ListenerUtil.mutListener.listen(15992) ? (c.getJSONObject(&quot;new&quot;).getInt(&quot;perDay&quot;) + g.getJSONArray(&quot;newToday&quot;).getInt(1)) : (c.getJSONObject(&quot;new&quot;).getInt(&quot;perDay&quot;) - g.getJSONArray(&quot;newToday&quot;).getInt(1)))))));</span>
<span class="pc bpc" id="L1426" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(15998)) {</span>
            // So currentCard does not have to be taken into consideration in this method
<span class="pc bpc" id="L1428" title="6 of 10 branches missed.">            if ((ListenerUtil.mutListener.listen(15996) ? (considerCurrentCard || currentCardIsInQueueWithDeck(Consts.QUEUE_TYPE_NEW, did)) : (considerCurrentCard &amp;&amp; currentCardIsInQueueWithDeck(Consts.QUEUE_TYPE_NEW, did)))) {</span>
<span class="pc bpc" id="L1429" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(15997)) {</span>
<span class="fc" id="L1430">                    lim--;</span>
                }
            }
        }
<span class="fc" id="L1434">        return lim;</span>
    }

    public int totalNewForCurrentDeck() {
<span class="nc" id="L1438">        return mCol.getDb().queryScalar(&quot;SELECT count() FROM cards WHERE id IN (SELECT id FROM cards WHERE did IN &quot; + _deckLimit() + &quot; AND queue = &quot; + Consts.QUEUE_TYPE_NEW + &quot; LIMIT ?)&quot;, mReportLimit);</span>
    }

    private boolean _updateLrnCutoff(boolean force) {
<span class="fc" id="L1442">        long nextCutoff = getTime().intTime() + mCol.getConf().getInt(&quot;collapseTime&quot;);</span>
<span class="pc bpc" id="L1443" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16010)) {</span>
<span class="pc bpc" id="L1444" title="133 of 146 branches missed.">            if ((ListenerUtil.mutListener.listen(16008) ? ((ListenerUtil.mutListener.listen(16007) ? ((ListenerUtil.mutListener.listen(16002) ? (nextCutoff % mLrnCutoff) : (ListenerUtil.mutListener.listen(16001) ? (nextCutoff / mLrnCutoff) : (ListenerUtil.mutListener.listen(16000) ? (nextCutoff * mLrnCutoff) : (ListenerUtil.mutListener.listen(15999) ? (nextCutoff + mLrnCutoff) : (nextCutoff - mLrnCutoff))))) &gt;= 60) : (ListenerUtil.mutListener.listen(16006) ? ((ListenerUtil.mutListener.listen(16002) ? (nextCutoff % mLrnCutoff) : (ListenerUtil.mutListener.listen(16001) ? (nextCutoff / mLrnCutoff) : (ListenerUtil.mutListener.listen(16000) ? (nextCutoff * mLrnCutoff) : (ListenerUtil.mutListener.listen(15999) ? (nextCutoff + mLrnCutoff) : (nextCutoff - mLrnCutoff))))) &lt;= 60) : (ListenerUtil.mutListener.listen(16005) ? ((ListenerUtil.mutListener.listen(16002) ? (nextCutoff % mLrnCutoff) : (ListenerUtil.mutListener.listen(16001) ? (nextCutoff / mLrnCutoff) : (ListenerUtil.mutListener.listen(16000) ? (nextCutoff * mLrnCutoff) : (ListenerUtil.mutListener.listen(15999) ? (nextCutoff + mLrnCutoff) : (nextCutoff - mLrnCutoff))))) &lt; 60) : (ListenerUtil.mutListener.listen(16004) ? ((ListenerUtil.mutListener.listen(16002) ? (nextCutoff % mLrnCutoff) : (ListenerUtil.mutListener.listen(16001) ? (nextCutoff / mLrnCutoff) : (ListenerUtil.mutListener.listen(16000) ? (nextCutoff * mLrnCutoff) : (ListenerUtil.mutListener.listen(15999) ? (nextCutoff + mLrnCutoff) : (nextCutoff - mLrnCutoff))))) != 60) : (ListenerUtil.mutListener.listen(16003) ? ((ListenerUtil.mutListener.listen(16002) ? (nextCutoff % mLrnCutoff) : (ListenerUtil.mutListener.listen(16001) ? (nextCutoff / mLrnCutoff) : (ListenerUtil.mutListener.listen(16000) ? (nextCutoff * mLrnCutoff) : (ListenerUtil.mutListener.listen(15999) ? (nextCutoff + mLrnCutoff) : (nextCutoff - mLrnCutoff))))) == 60) : ((ListenerUtil.mutListener.listen(16002) ? (nextCutoff % mLrnCutoff) : (ListenerUtil.mutListener.listen(16001) ? (nextCutoff / mLrnCutoff) : (ListenerUtil.mutListener.listen(16000) ? (nextCutoff * mLrnCutoff) : (ListenerUtil.mutListener.listen(15999) ? (nextCutoff + mLrnCutoff) : (nextCutoff - mLrnCutoff))))) &gt; 60)))))) &amp;&amp; force) : ((ListenerUtil.mutListener.listen(16007) ? ((ListenerUtil.mutListener.listen(16002) ? (nextCutoff % mLrnCutoff) : (ListenerUtil.mutListener.listen(16001) ? (nextCutoff / mLrnCutoff) : (ListenerUtil.mutListener.listen(16000) ? (nextCutoff * mLrnCutoff) : (ListenerUtil.mutListener.listen(15999) ? (nextCutoff + mLrnCutoff) : (nextCutoff - mLrnCutoff))))) &gt;= 60) : (ListenerUtil.mutListener.listen(16006) ? ((ListenerUtil.mutListener.listen(16002) ? (nextCutoff % mLrnCutoff) : (ListenerUtil.mutListener.listen(16001) ? (nextCutoff / mLrnCutoff) : (ListenerUtil.mutListener.listen(16000) ? (nextCutoff * mLrnCutoff) : (ListenerUtil.mutListener.listen(15999) ? (nextCutoff + mLrnCutoff) : (nextCutoff - mLrnCutoff))))) &lt;= 60) : (ListenerUtil.mutListener.listen(16005) ? ((ListenerUtil.mutListener.listen(16002) ? (nextCutoff % mLrnCutoff) : (ListenerUtil.mutListener.listen(16001) ? (nextCutoff / mLrnCutoff) : (ListenerUtil.mutListener.listen(16000) ? (nextCutoff * mLrnCutoff) : (ListenerUtil.mutListener.listen(15999) ? (nextCutoff + mLrnCutoff) : (nextCutoff - mLrnCutoff))))) &lt; 60) : (ListenerUtil.mutListener.listen(16004) ? ((ListenerUtil.mutListener.listen(16002) ? (nextCutoff % mLrnCutoff) : (ListenerUtil.mutListener.listen(16001) ? (nextCutoff / mLrnCutoff) : (ListenerUtil.mutListener.listen(16000) ? (nextCutoff * mLrnCutoff) : (ListenerUtil.mutListener.listen(15999) ? (nextCutoff + mLrnCutoff) : (nextCutoff - mLrnCutoff))))) != 60) : (ListenerUtil.mutListener.listen(16003) ? ((ListenerUtil.mutListener.listen(16002) ? (nextCutoff % mLrnCutoff) : (ListenerUtil.mutListener.listen(16001) ? (nextCutoff / mLrnCutoff) : (ListenerUtil.mutListener.listen(16000) ? (nextCutoff * mLrnCutoff) : (ListenerUtil.mutListener.listen(15999) ? (nextCutoff + mLrnCutoff) : (nextCutoff - mLrnCutoff))))) == 60) : ((ListenerUtil.mutListener.listen(16002) ? (nextCutoff % mLrnCutoff) : (ListenerUtil.mutListener.listen(16001) ? (nextCutoff / mLrnCutoff) : (ListenerUtil.mutListener.listen(16000) ? (nextCutoff * mLrnCutoff) : (ListenerUtil.mutListener.listen(15999) ? (nextCutoff + mLrnCutoff) : (nextCutoff - mLrnCutoff))))) &gt; 60)))))) || force))) {</span>
<span class="pc bpc" id="L1445" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16009)) {</span>
<span class="fc" id="L1446">                    mLrnCutoff = nextCutoff;</span>
                }
<span class="fc" id="L1448">                return true;</span>
            }
        }
<span class="nc" id="L1451">        return false;</span>
    }

    private void _maybeResetLrn(boolean force) {
<span class="pc bpc" id="L1455" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16012)) {</span>
<span class="pc bpc" id="L1456" title="1 of 2 branches missed.">            if (_updateLrnCutoff(force)) {</span>
<span class="pc bpc" id="L1457" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16011)) {</span>
<span class="fc" id="L1458">                    _resetLrn();</span>
                }
            }
        }
<span class="fc" id="L1462">    }</span>

    // Overridden: V1 has less queues
    protected void _resetLrnCount() {
<span class="pc bpc" id="L1466" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16013)) {</span>
<span class="fc" id="L1467">            _resetLrnCount(null);</span>
        }
<span class="fc" id="L1469">    }</span>

    protected void _resetLrnCount(@Nullable CancelListener cancelListener) {
<span class="pc bpc" id="L1472" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16014)) {</span>
<span class="fc" id="L1473">            _updateLrnCutoff(true);</span>
        }
<span class="pc bpc" id="L1475" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16015)) {</span>
            // sub-day
<span class="fc" id="L1477">            mLrnCount = mCol.getDb().queryScalar(&quot;SELECT count() FROM cards WHERE did IN &quot; + _deckLimit() + &quot; AND queue = &quot; + Consts.QUEUE_TYPE_LRN + &quot; AND id != ? AND due &lt; ?&quot;, currentCardId(), mLrnCutoff);</span>
        }
<span class="pc bpc" id="L1479" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16016)) {</span>
<span class="pc bpc" id="L1480" title="1 of 2 branches missed.">            if (isCancelled(cancelListener))</span>
<span class="nc" id="L1481">                return;</span>
        }
<span class="pc bpc" id="L1483" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16017)) {</span>
            // day
<span class="fc" id="L1485">            mLrnCount += mCol.getDb().queryScalar(&quot;SELECT count() FROM cards WHERE did IN &quot; + _deckLimit() + &quot; AND queue = &quot; + Consts.QUEUE_TYPE_DAY_LEARN_RELEARN + &quot; AND due &lt;= ? AND id != ?&quot;, mToday, currentCardId());</span>
        }
<span class="pc bpc" id="L1487" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16018)) {</span>
<span class="pc bpc" id="L1488" title="1 of 2 branches missed.">            if (isCancelled(cancelListener))</span>
<span class="nc" id="L1489">                return;</span>
        }
<span class="pc bpc" id="L1491" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16019)) {</span>
            // previews
<span class="fc" id="L1493">            mLrnCount += mCol.getDb().queryScalar(&quot;SELECT count() FROM cards WHERE did IN &quot; + _deckLimit() + &quot; AND queue = &quot; + Consts.QUEUE_TYPE_PREVIEW + &quot; AND id != ? &quot;, currentCardId());</span>
        }
<span class="fc" id="L1495">    }</span>

    // Overriden: _updateLrnCutoff not called in V1
    protected void _resetLrn() {
<span class="pc bpc" id="L1499" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16020)) {</span>
<span class="fc" id="L1500">            _resetLrnCount();</span>
        }
<span class="pc bpc" id="L1502" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16021)) {</span>
<span class="fc" id="L1503">            _resetLrnQueue();</span>
        }
<span class="fc" id="L1505">    }</span>

    protected void _resetLrnQueue() {
<span class="pc bpc" id="L1508" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16022)) {</span>
<span class="fc" id="L1509">            mLrnQueue.clear();</span>
        }
<span class="pc bpc" id="L1511" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16023)) {</span>
<span class="fc" id="L1512">            mLrnDayQueue.clear();</span>
        }
<span class="pc bpc" id="L1514" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16024)) {</span>
<span class="fc" id="L1515">            mLrnDids = mCol.getDecks().active();</span>
        }
<span class="fc" id="L1517">    }</span>

    // Overridden: a single kind of queue in V1
    protected boolean _fillLrn() {
<span class="pc bpc" id="L1521" title="48 of 50 branches missed.">        if ((ListenerUtil.mutListener.listen(16030) ? (mHaveCounts || (ListenerUtil.mutListener.listen(16029) ? (mLrnCount &gt;= 0) : (ListenerUtil.mutListener.listen(16028) ? (mLrnCount &lt;= 0) : (ListenerUtil.mutListener.listen(16027) ? (mLrnCount &gt; 0) : (ListenerUtil.mutListener.listen(16026) ? (mLrnCount &lt; 0) : (ListenerUtil.mutListener.listen(16025) ? (mLrnCount != 0) : (mLrnCount == 0))))))) : (mHaveCounts &amp;&amp; (ListenerUtil.mutListener.listen(16029) ? (mLrnCount &gt;= 0) : (ListenerUtil.mutListener.listen(16028) ? (mLrnCount &lt;= 0) : (ListenerUtil.mutListener.listen(16027) ? (mLrnCount &gt; 0) : (ListenerUtil.mutListener.listen(16026) ? (mLrnCount &lt; 0) : (ListenerUtil.mutListener.listen(16025) ? (mLrnCount != 0) : (mLrnCount == 0))))))))) {</span>
<span class="nc" id="L1522">            return false;</span>
        }
<span class="pc bpc" id="L1524" title="1 of 2 branches missed.">        if (!mLrnQueue.isEmpty()) {</span>
<span class="nc" id="L1525">            return true;</span>
        }
<span class="fc" id="L1527">        long cutoff = getTime().intTime() + mCol.getConf().getLong(&quot;collapseTime&quot;);</span>
<span class="pc bpc" id="L1528" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16031)) {</span>
<span class="fc" id="L1529">            mLrnQueue.clear();</span>
        }
        /* Difference with upstream: Current card can't come in the queue.
             *
             * In standard usage, a card is not requested before the previous card is marked as reviewed. However, if we
             * decide to query a second card sooner, we don't want to get the same card a second time. This simulate
             * _getLrnCard which did remove the card from the queue. _sortIntoLrn will add the card back to the queue if
             * required when the card is reviewed.
             */
<span class="fc" id="L1538">        try (Cursor cur = mCol.getDb().query(&quot;SELECT due, id FROM cards WHERE did IN &quot; + _deckLimit() + &quot; AND queue IN (&quot; + Consts.QUEUE_TYPE_LRN + &quot;, &quot; + Consts.QUEUE_TYPE_PREVIEW + &quot;) AND due &lt; ?&quot; + &quot; AND id != ? LIMIT ?&quot;, cutoff, currentCardId(), mReportLimit)) {</span>
<span class="pc bpc" id="L1539" title="1 of 2 branches missed.">            if (!ListenerUtil.mutListener.listen(16032)) {</span>
<span class="fc" id="L1540">                mLrnQueue.setFilled();</span>
            }
<span class="pc bpc" id="L1542" title="1 of 2 branches missed.">            if (!ListenerUtil.mutListener.listen(16034)) {</span>
                {
<span class="fc" id="L1544">                    long _loopCounter313 = 0;</span>
<span class="pc bpc" id="L1545" title="1 of 2 branches missed.">                    while (cur.moveToNext()) {</span>
<span class="nc" id="L1546">                        ListenerUtil.loopListener.listen(&quot;_loopCounter313&quot;, ++_loopCounter313);</span>
<span class="nc bnc" id="L1547" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(16033)) {</span>
<span class="nc" id="L1548">                            mLrnQueue.add(cur.getLong(0), cur.getLong(1));</span>
                        }
                    }
                }
            }
<span class="pc bpc" id="L1553" title="1 of 2 branches missed.">            if (!ListenerUtil.mutListener.listen(16035)) {</span>
                // as it arrives sorted by did first, we need to sort it
<span class="fc" id="L1555">                mLrnQueue.sort();</span>
            }
<span class="pc bpc" id="L1557" title="1 of 2 branches missed.">            return !mLrnQueue.isEmpty();</span>
        }
    }

    // Overidden: no _maybeResetLrn in V1
    @Nullable
    protected Card _getLrnCard(boolean collapse) {
<span class="pc bpc" id="L1564" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16042)) {</span>
<span class="pc bpc" id="L1565" title="48 of 50 branches missed.">            _maybeResetLrn((ListenerUtil.mutListener.listen(16041) ? (collapse || (ListenerUtil.mutListener.listen(16040) ? (mLrnCount &gt;= 0) : (ListenerUtil.mutListener.listen(16039) ? (mLrnCount &lt;= 0) : (ListenerUtil.mutListener.listen(16038) ? (mLrnCount &gt; 0) : (ListenerUtil.mutListener.listen(16037) ? (mLrnCount &lt; 0) : (ListenerUtil.mutListener.listen(16036) ? (mLrnCount != 0) : (mLrnCount == 0))))))) : (collapse &amp;&amp; (ListenerUtil.mutListener.listen(16040) ? (mLrnCount &gt;= 0) : (ListenerUtil.mutListener.listen(16039) ? (mLrnCount &lt;= 0) : (ListenerUtil.mutListener.listen(16038) ? (mLrnCount &gt; 0) : (ListenerUtil.mutListener.listen(16037) ? (mLrnCount &lt; 0) : (ListenerUtil.mutListener.listen(16036) ? (mLrnCount != 0) : (mLrnCount == 0)))))))));</span>
        }
<span class="pc bpc" id="L1567" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16051)) {</span>
<span class="pc bpc" id="L1568" title="1 of 2 branches missed.">            if (_fillLrn()) {</span>
<span class="nc" id="L1569">                long cutoff = getTime().intTime();</span>
<span class="nc bnc" id="L1570" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16044)) {</span>
<span class="nc bnc" id="L1571" title="All 2 branches missed.">                    if (collapse) {</span>
<span class="nc bnc" id="L1572" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(16043)) {</span>
<span class="nc" id="L1573">                            cutoff += mCol.getConf().getInt(&quot;collapseTime&quot;);</span>
                        }
                    }
                }
<span class="nc bnc" id="L1577" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16050)) {</span>
<span class="nc bnc" id="L1578" title="All 22 branches missed.">                    if ((ListenerUtil.mutListener.listen(16049) ? (mLrnQueue.getFirstDue() &gt;= cutoff) : (ListenerUtil.mutListener.listen(16048) ? (mLrnQueue.getFirstDue() &lt;= cutoff) : (ListenerUtil.mutListener.listen(16047) ? (mLrnQueue.getFirstDue() &gt; cutoff) : (ListenerUtil.mutListener.listen(16046) ? (mLrnQueue.getFirstDue() != cutoff) : (ListenerUtil.mutListener.listen(16045) ? (mLrnQueue.getFirstDue() == cutoff) : (mLrnQueue.getFirstDue() &lt; cutoff))))))) {</span>
<span class="nc" id="L1579">                        return mLrnQueue.removeFirstCard();</span>
                    }
                }
            }
        }
<span class="fc" id="L1584">        return null;</span>
    }

    protected boolean _preloadLrnCard(boolean collapse) {
<span class="nc bnc" id="L1588" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16058)) {</span>
<span class="nc bnc" id="L1589" title="All 50 branches missed.">            _maybeResetLrn((ListenerUtil.mutListener.listen(16057) ? (collapse || (ListenerUtil.mutListener.listen(16056) ? (mLrnCount &gt;= 0) : (ListenerUtil.mutListener.listen(16055) ? (mLrnCount &lt;= 0) : (ListenerUtil.mutListener.listen(16054) ? (mLrnCount &gt; 0) : (ListenerUtil.mutListener.listen(16053) ? (mLrnCount &lt; 0) : (ListenerUtil.mutListener.listen(16052) ? (mLrnCount != 0) : (mLrnCount == 0))))))) : (collapse &amp;&amp; (ListenerUtil.mutListener.listen(16056) ? (mLrnCount &gt;= 0) : (ListenerUtil.mutListener.listen(16055) ? (mLrnCount &lt;= 0) : (ListenerUtil.mutListener.listen(16054) ? (mLrnCount &gt; 0) : (ListenerUtil.mutListener.listen(16053) ? (mLrnCount &lt; 0) : (ListenerUtil.mutListener.listen(16052) ? (mLrnCount != 0) : (mLrnCount == 0)))))))));</span>
        }
<span class="nc bnc" id="L1591" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16066)) {</span>
<span class="nc bnc" id="L1592" title="All 2 branches missed.">            if (_fillLrn()) {</span>
<span class="nc" id="L1593">                long cutoff = getTime().intTime();</span>
<span class="nc bnc" id="L1594" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16060)) {</span>
<span class="nc bnc" id="L1595" title="All 2 branches missed.">                    if (collapse) {</span>
<span class="nc bnc" id="L1596" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(16059)) {</span>
<span class="nc" id="L1597">                            cutoff += mCol.getConf().getInt(&quot;collapseTime&quot;);</span>
                        }
                    }
                }
                // mLrnCount -= 1; see decrementCounts()
<span class="nc bnc" id="L1602" title="All 22 branches missed.">                return (ListenerUtil.mutListener.listen(16065) ? (mLrnQueue.getFirstDue() &gt;= cutoff) : (ListenerUtil.mutListener.listen(16064) ? (mLrnQueue.getFirstDue() &lt;= cutoff) : (ListenerUtil.mutListener.listen(16063) ? (mLrnQueue.getFirstDue() &gt; cutoff) : (ListenerUtil.mutListener.listen(16062) ? (mLrnQueue.getFirstDue() != cutoff) : (ListenerUtil.mutListener.listen(16061) ? (mLrnQueue.getFirstDue() == cutoff) : (mLrnQueue.getFirstDue() &lt; cutoff))))));</span>
            }
        }
<span class="nc" id="L1605">        return false;</span>
    }

    // daily learning
    protected boolean _fillLrnDay() {
<span class="pc bpc" id="L1610" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16073)) {</span>
<span class="pc bpc" id="L1611" title="48 of 50 branches missed.">            if ((ListenerUtil.mutListener.listen(16072) ? (mHaveCounts || (ListenerUtil.mutListener.listen(16071) ? (mLrnCount &gt;= 0) : (ListenerUtil.mutListener.listen(16070) ? (mLrnCount &lt;= 0) : (ListenerUtil.mutListener.listen(16069) ? (mLrnCount &gt; 0) : (ListenerUtil.mutListener.listen(16068) ? (mLrnCount &lt; 0) : (ListenerUtil.mutListener.listen(16067) ? (mLrnCount != 0) : (mLrnCount == 0))))))) : (mHaveCounts &amp;&amp; (ListenerUtil.mutListener.listen(16071) ? (mLrnCount &gt;= 0) : (ListenerUtil.mutListener.listen(16070) ? (mLrnCount &lt;= 0) : (ListenerUtil.mutListener.listen(16069) ? (mLrnCount &gt; 0) : (ListenerUtil.mutListener.listen(16068) ? (mLrnCount &lt; 0) : (ListenerUtil.mutListener.listen(16067) ? (mLrnCount != 0) : (mLrnCount == 0))))))))) {</span>
<span class="nc" id="L1612">                return false;</span>
            }
        }
<span class="pc bpc" id="L1615" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16074)) {</span>
<span class="pc bpc" id="L1616" title="1 of 2 branches missed.">            if (!mLrnDayQueue.isEmpty()) {</span>
<span class="nc" id="L1617">                return true;</span>
            }
        }
<span class="pc bpc" id="L1620" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16089)) {</span>
            {
<span class="fc" id="L1622">                long _loopCounter315 = 0;</span>
<span class="fc bfc" id="L1623" title="All 2 branches covered.">                while (!mLrnDids.isEmpty()) {</span>
<span class="fc" id="L1624">                    ListenerUtil.loopListener.listen(&quot;_loopCounter315&quot;, ++_loopCounter315);</span>
<span class="fc" id="L1625">                    long did = mLrnDids.getFirst();</span>
<span class="pc bpc" id="L1626" title="1 of 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(16075)) {</span>
                        // fill the queue with the current did
<span class="fc" id="L1628">                        mLrnDayQueue.clear();</span>
                    }
<span class="pc bpc" id="L1630" title="1 of 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(16077)) {</span>
                        {
<span class="fc" id="L1632">                            long _loopCounter314 = 0;</span>
                            /* Difference with upstream:
                 * Current card can't come in the queue.
                 *
                 * In standard usage, a card is not requested before
                 * the previous card is marked as reviewed. However,
                 * if we decide to query a second card sooner, we
                 * don't want to get the same card a second time. This
                 * simulate _getLrnDayCard which did remove the card
                 * from the queue.
                 */
<span class="pc bpc" id="L1643" title="1 of 2 branches missed.">                            for (long cid : mCol.getDb().queryLongList(&quot;SELECT id FROM cards WHERE did = ? AND queue = &quot; + Consts.QUEUE_TYPE_DAY_LEARN_RELEARN + &quot; AND due &lt;= ? and id != ? LIMIT ?&quot;, did, mToday, currentCardId(), mQueueLimit)) {</span>
<span class="nc" id="L1644">                                ListenerUtil.loopListener.listen(&quot;_loopCounter314&quot;, ++_loopCounter314);</span>
<span class="nc bnc" id="L1645" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(16076)) {</span>
<span class="nc" id="L1646">                                    mLrnDayQueue.add(cid);</span>
                                }
<span class="nc" id="L1648">                            }</span>
                        }
                    }
<span class="pc bpc" id="L1651" title="1 of 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(16087)) {</span>
<span class="pc bpc" id="L1652" title="1 of 2 branches missed.">                        if (!mLrnDayQueue.isEmpty()) {</span>
                            // order
<span class="nc" id="L1654">                            Random r = new Random();</span>
<span class="nc bnc" id="L1655" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(16078)) {</span>
<span class="nc" id="L1656">                                r.setSeed(mToday);</span>
                            }
<span class="nc bnc" id="L1658" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(16079)) {</span>
<span class="nc" id="L1659">                                mLrnDayQueue.shuffle(r);</span>
                            }
<span class="nc bnc" id="L1661" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(16086)) {</span>
                                // is the current did empty?
<span class="nc bnc" id="L1663" title="All 22 branches missed.">                                if ((ListenerUtil.mutListener.listen(16084) ? (mLrnDayQueue.size() &gt;= mQueueLimit) : (ListenerUtil.mutListener.listen(16083) ? (mLrnDayQueue.size() &lt;= mQueueLimit) : (ListenerUtil.mutListener.listen(16082) ? (mLrnDayQueue.size() &gt; mQueueLimit) : (ListenerUtil.mutListener.listen(16081) ? (mLrnDayQueue.size() != mQueueLimit) : (ListenerUtil.mutListener.listen(16080) ? (mLrnDayQueue.size() == mQueueLimit) : (mLrnDayQueue.size() &lt; mQueueLimit))))))) {</span>
<span class="nc bnc" id="L1664" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(16085)) {</span>
<span class="nc" id="L1665">                                        mLrnDids.remove();</span>
                                    }
                                }
                            }
<span class="nc" id="L1669">                            return true;</span>
                        }
                    }
<span class="pc bpc" id="L1672" title="1 of 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(16088)) {</span>
                        // nothing left in the deck; move to next
<span class="fc" id="L1674">                        mLrnDids.remove();</span>
                    }
<span class="fc" id="L1676">                }</span>
            }
        }
<span class="fc" id="L1679">        return false;</span>
    }

    @Nullable
    protected Card _getLrnDayCard() {
<span class="pc bpc" id="L1684" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16090)) {</span>
<span class="pc bpc" id="L1685" title="1 of 2 branches missed.">            if (_fillLrnDay()) {</span>
                // mLrnCount -= 1; see decrementCounts()
<span class="nc" id="L1687">                return mLrnDayQueue.removeFirstCard();</span>
            }
        }
<span class="fc" id="L1690">        return null;</span>
    }

    // Overriden
    protected void _answerLrnCard(@NonNull Card card, @Consts.BUTTON_TYPE int ease) {
<span class="nc" id="L1695">        JSONObject conf = _lrnConf(card);</span>
        @Consts.CARD_TYPE
        int type;
<span class="nc bnc" id="L1698" title="All 90 branches missed.">        if ((ListenerUtil.mutListener.listen(16101) ? ((ListenerUtil.mutListener.listen(16095) ? (card.getType() &gt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16094) ? (card.getType() &lt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16093) ? (card.getType() &gt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16092) ? (card.getType() &lt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16091) ? (card.getType() != Consts.CARD_TYPE_REV) : (card.getType() == Consts.CARD_TYPE_REV)))))) &amp;&amp; (ListenerUtil.mutListener.listen(16100) ? (card.getType() &gt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16099) ? (card.getType() &lt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16098) ? (card.getType() &gt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16097) ? (card.getType() &lt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16096) ? (card.getType() != Consts.CARD_TYPE_RELEARNING) : (card.getType() == Consts.CARD_TYPE_RELEARNING))))))) : ((ListenerUtil.mutListener.listen(16095) ? (card.getType() &gt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16094) ? (card.getType() &lt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16093) ? (card.getType() &gt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16092) ? (card.getType() &lt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16091) ? (card.getType() != Consts.CARD_TYPE_REV) : (card.getType() == Consts.CARD_TYPE_REV)))))) || (ListenerUtil.mutListener.listen(16100) ? (card.getType() &gt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16099) ? (card.getType() &lt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16098) ? (card.getType() &gt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16097) ? (card.getType() &lt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16096) ? (card.getType() != Consts.CARD_TYPE_RELEARNING) : (card.getType() == Consts.CARD_TYPE_RELEARNING))))))))) {</span>
<span class="nc" id="L1699">            type = Consts.CARD_TYPE_REV;</span>
        } else {
<span class="nc" id="L1701">            type = Consts.CARD_TYPE_NEW;</span>
        }
        // lrnCount was decremented once when card was fetched
<span class="nc" id="L1704">        int lastLeft = card.getLeft();</span>
<span class="nc" id="L1705">        boolean leaving = false;</span>
<span class="nc bnc" id="L1706" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16138)) {</span>
            // immediate graduate?
<span class="nc bnc" id="L1708" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(16106) ? (ease &gt;= Consts.BUTTON_FOUR) : (ListenerUtil.mutListener.listen(16105) ? (ease &lt;= Consts.BUTTON_FOUR) : (ListenerUtil.mutListener.listen(16104) ? (ease &gt; Consts.BUTTON_FOUR) : (ListenerUtil.mutListener.listen(16103) ? (ease &lt; Consts.BUTTON_FOUR) : (ListenerUtil.mutListener.listen(16102) ? (ease != Consts.BUTTON_FOUR) : (ease == Consts.BUTTON_FOUR))))))) {</span>
<span class="nc bnc" id="L1709" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16136)) {</span>
<span class="nc" id="L1710">                    _rescheduleAsRev(card, conf, true);</span>
                }
<span class="nc bnc" id="L1712" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16137)) {</span>
<span class="nc" id="L1713">                    leaving = true;</span>
                }
<span class="nc bnc" id="L1715" title="All 22 branches missed.">            } else if ((ListenerUtil.mutListener.listen(16111) ? (ease &gt;= Consts.BUTTON_THREE) : (ListenerUtil.mutListener.listen(16110) ? (ease &lt;= Consts.BUTTON_THREE) : (ListenerUtil.mutListener.listen(16109) ? (ease &gt; Consts.BUTTON_THREE) : (ListenerUtil.mutListener.listen(16108) ? (ease &lt; Consts.BUTTON_THREE) : (ListenerUtil.mutListener.listen(16107) ? (ease != Consts.BUTTON_THREE) : (ease == Consts.BUTTON_THREE))))))) {</span>
<span class="nc bnc" id="L1716" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16135)) {</span>
                    // graduation time?
<span class="nc bnc" id="L1718" title="All 310 branches missed.">                    if ((ListenerUtil.mutListener.listen(16131) ? ((ListenerUtil.mutListener.listen(16126) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) % 1) : (ListenerUtil.mutListener.listen(16125) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) / 1) : (ListenerUtil.mutListener.listen(16124) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) * 1) : (ListenerUtil.mutListener.listen(16123) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) + 1) : (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) - 1))))) &gt;= 0) : (ListenerUtil.mutListener.listen(16130) ? ((ListenerUtil.mutListener.listen(16126) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) % 1) : (ListenerUtil.mutListener.listen(16125) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) / 1) : (ListenerUtil.mutListener.listen(16124) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) * 1) : (ListenerUtil.mutListener.listen(16123) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) + 1) : (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) - 1))))) &gt; 0) : (ListenerUtil.mutListener.listen(16129) ? ((ListenerUtil.mutListener.listen(16126) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) % 1) : (ListenerUtil.mutListener.listen(16125) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) / 1) : (ListenerUtil.mutListener.listen(16124) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) * 1) : (ListenerUtil.mutListener.listen(16123) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) + 1) : (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) - 1))))) &lt; 0) : (ListenerUtil.mutListener.listen(16128) ? ((ListenerUtil.mutListener.listen(16126) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) % 1) : (ListenerUtil.mutListener.listen(16125) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) / 1) : (ListenerUtil.mutListener.listen(16124) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) * 1) : (ListenerUtil.mutListener.listen(16123) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) + 1) : (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) - 1))))) != 0) : (ListenerUtil.mutListener.listen(16127) ? ((ListenerUtil.mutListener.listen(16126) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) % 1) : (ListenerUtil.mutListener.listen(16125) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) / 1) : (ListenerUtil.mutListener.listen(16124) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) * 1) : (ListenerUtil.mutListener.listen(16123) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) + 1) : (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) - 1))))) == 0) : ((ListenerUtil.mutListener.listen(16126) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) % 1) : (ListenerUtil.mutListener.listen(16125) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) / 1) : (ListenerUtil.mutListener.listen(16124) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) * 1) : (ListenerUtil.mutListener.listen(16123) ? (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) + 1) : (((ListenerUtil.mutListener.listen(16122) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16121) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16120) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16119) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) - 1))))) &lt;= 0))))))) {</span>
<span class="nc bnc" id="L1719" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(16133)) {</span>
<span class="nc" id="L1720">                            _rescheduleAsRev(card, conf, false);</span>
                        }
<span class="nc bnc" id="L1722" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(16134)) {</span>
<span class="nc" id="L1723">                            leaving = true;</span>
                        }
                    } else {
<span class="nc bnc" id="L1726" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(16132)) {</span>
<span class="nc" id="L1727">                            _moveToNextStep(card, conf);</span>
                        }
                    }
                }
<span class="nc bnc" id="L1731" title="All 22 branches missed.">            } else if ((ListenerUtil.mutListener.listen(16116) ? (ease &gt;= Consts.BUTTON_TWO) : (ListenerUtil.mutListener.listen(16115) ? (ease &lt;= Consts.BUTTON_TWO) : (ListenerUtil.mutListener.listen(16114) ? (ease &gt; Consts.BUTTON_TWO) : (ListenerUtil.mutListener.listen(16113) ? (ease &lt; Consts.BUTTON_TWO) : (ListenerUtil.mutListener.listen(16112) ? (ease != Consts.BUTTON_TWO) : (ease == Consts.BUTTON_TWO))))))) {</span>
<span class="nc bnc" id="L1732" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16118)) {</span>
<span class="nc" id="L1733">                    _repeatStep(card, conf);</span>
                }
            } else {
<span class="nc bnc" id="L1736" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16117)) {</span>
                    // move back to first step
<span class="nc" id="L1738">                    _moveToFirstStep(card, conf);</span>
                }
            }
        }
<span class="nc bnc" id="L1742" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16139)) {</span>
<span class="nc" id="L1743">            _logLrn(card, ease, conf, leaving, type, lastLeft);</span>
        }
<span class="nc" id="L1745">    }</span>

    protected void _updateRevIvlOnFail(@NonNull Card card, @NonNull JSONObject conf) {
<span class="nc bnc" id="L1748" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16140)) {</span>
<span class="nc" id="L1749">            card.setLastIvl(card.getIvl());</span>
        }
<span class="nc bnc" id="L1751" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16141)) {</span>
<span class="nc" id="L1752">            card.setIvl(_lapseIvl(card, conf));</span>
        }
<span class="nc" id="L1754">    }</span>

    private int _moveToFirstStep(@NonNull Card card, @NonNull JSONObject conf) {
<span class="nc bnc" id="L1757" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16142)) {</span>
<span class="nc" id="L1758">            card.setLeft(_startingLeft(card));</span>
        }
<span class="nc bnc" id="L1760" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16149)) {</span>
            // relearning card?
<span class="nc bnc" id="L1762" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(16147) ? (card.getType() &gt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16146) ? (card.getType() &lt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16145) ? (card.getType() &gt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16144) ? (card.getType() &lt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16143) ? (card.getType() != Consts.CARD_TYPE_RELEARNING) : (card.getType() == Consts.CARD_TYPE_RELEARNING))))))) {</span>
<span class="nc bnc" id="L1763" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16148)) {</span>
<span class="nc" id="L1764">                    _updateRevIvlOnFail(card, conf);</span>
                }
            }
        }
<span class="nc" id="L1768">        return _rescheduleLrnCard(card, conf);</span>
    }

    private void _moveToNextStep(@NonNull Card card, @NonNull JSONObject conf) {
        // decrement real left count and recalculate left today
<span class="nc bnc" id="L1773" title="All 48 branches missed.">        int left = (ListenerUtil.mutListener.listen(16157) ? (((ListenerUtil.mutListener.listen(16153) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16152) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16151) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16150) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) % 1) : (ListenerUtil.mutListener.listen(16156) ? (((ListenerUtil.mutListener.listen(16153) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16152) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16151) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16150) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) / 1) : (ListenerUtil.mutListener.listen(16155) ? (((ListenerUtil.mutListener.listen(16153) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16152) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16151) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16150) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) * 1) : (ListenerUtil.mutListener.listen(16154) ? (((ListenerUtil.mutListener.listen(16153) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16152) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16151) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16150) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) + 1) : (((ListenerUtil.mutListener.listen(16153) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16152) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16151) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16150) ? (card.getLeft() + 1000) : (card.getLeft() % 1000)))))) - 1)))));</span>
<span class="nc bnc" id="L1774" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16162)) {</span>
<span class="nc bnc" id="L1775" title="All 8 branches missed.">            card.setLeft((ListenerUtil.mutListener.listen(16161) ? (_leftToday(conf.getJSONArray(&quot;delays&quot;), left) % 1000) : (ListenerUtil.mutListener.listen(16160) ? (_leftToday(conf.getJSONArray(&quot;delays&quot;), left) / 1000) : (ListenerUtil.mutListener.listen(16159) ? (_leftToday(conf.getJSONArray(&quot;delays&quot;), left) - 1000) : (ListenerUtil.mutListener.listen(16158) ? (_leftToday(conf.getJSONArray(&quot;delays&quot;), left) + 1000) : (_leftToday(conf.getJSONArray(&quot;delays&quot;), left) * 1000))))) + left);</span>
        }
<span class="nc bnc" id="L1777" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16163)) {</span>
<span class="nc" id="L1778">            _rescheduleLrnCard(card, conf);</span>
        }
<span class="nc" id="L1780">    }</span>

    private void _repeatStep(@NonNull Card card, @NonNull JSONObject conf) {
<span class="nc" id="L1783">        int delay = _delayForRepeatingGrade(conf, card.getLeft());</span>
<span class="nc bnc" id="L1784" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16164)) {</span>
<span class="nc" id="L1785">            _rescheduleLrnCard(card, conf, delay);</span>
        }
<span class="nc" id="L1787">    }</span>

    private int _rescheduleLrnCard(@NonNull Card card, @NonNull JSONObject conf) {
<span class="nc" id="L1790">        return _rescheduleLrnCard(card, conf, null);</span>
    }

    private int _rescheduleLrnCard(@NonNull Card card, @NonNull JSONObject conf, @Nullable Integer delay) {
<span class="nc bnc" id="L1794" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16166)) {</span>
            // normal delay for the current step?
<span class="nc bnc" id="L1796" title="All 2 branches missed.">            if (delay == null) {</span>
<span class="nc bnc" id="L1797" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16165)) {</span>
<span class="nc" id="L1798">                    delay = _delayForGrade(conf, card.getLeft());</span>
                }
            }
        }
<span class="nc bnc" id="L1802" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16167)) {</span>
<span class="nc" id="L1803">            card.setDue(getTime().intTime() + delay);</span>
        }
<span class="nc bnc" id="L1805" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16221)) {</span>
            // due today?
<span class="nc bnc" id="L1807" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(16172) ? (card.getDue() &gt;= mDayCutoff) : (ListenerUtil.mutListener.listen(16171) ? (card.getDue() &lt;= mDayCutoff) : (ListenerUtil.mutListener.listen(16170) ? (card.getDue() &gt; mDayCutoff) : (ListenerUtil.mutListener.listen(16169) ? (card.getDue() != mDayCutoff) : (ListenerUtil.mutListener.listen(16168) ? (card.getDue() == mDayCutoff) : (card.getDue() &lt; mDayCutoff))))))) {</span>
                // Add some randomness, up to 5 minutes or 25%
<span class="nc bnc" id="L1809" title="All 8 branches missed.">                int maxExtra = Math.min(300, (int) ((ListenerUtil.mutListener.listen(16194) ? (delay % 0.25) : (ListenerUtil.mutListener.listen(16193) ? (delay / 0.25) : (ListenerUtil.mutListener.listen(16192) ? (delay - 0.25) : (ListenerUtil.mutListener.listen(16191) ? (delay + 0.25) : (delay * 0.25)))))));</span>
<span class="nc" id="L1810">                int fuzz = new Random().nextInt(maxExtra);</span>
<span class="nc bnc" id="L1811" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16203)) {</span>
<span class="nc bnc" id="L1812" title="All 16 branches missed.">                    card.setDue(Math.min((ListenerUtil.mutListener.listen(16198) ? (mDayCutoff % 1) : (ListenerUtil.mutListener.listen(16197) ? (mDayCutoff / 1) : (ListenerUtil.mutListener.listen(16196) ? (mDayCutoff * 1) : (ListenerUtil.mutListener.listen(16195) ? (mDayCutoff + 1) : (mDayCutoff - 1))))), (ListenerUtil.mutListener.listen(16202) ? (card.getDue() % fuzz) : (ListenerUtil.mutListener.listen(16201) ? (card.getDue() / fuzz) : (ListenerUtil.mutListener.listen(16200) ? (card.getDue() * fuzz) : (ListenerUtil.mutListener.listen(16199) ? (card.getDue() - fuzz) : (card.getDue() + fuzz)))))));</span>
                }
<span class="nc bnc" id="L1814" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16204)) {</span>
<span class="nc" id="L1815">                    card.setQueue(Consts.QUEUE_TYPE_LRN);</span>
                }
<span class="nc bnc" id="L1817" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16220)) {</span>
<span class="nc bnc" id="L1818" title="All 22 branches missed.">                    if ((ListenerUtil.mutListener.listen(16209) ? (card.getDue() &gt;= (getTime().intTime() + mCol.getConf().getInt(&quot;collapseTime&quot;))) : (ListenerUtil.mutListener.listen(16208) ? (card.getDue() &lt;= (getTime().intTime() + mCol.getConf().getInt(&quot;collapseTime&quot;))) : (ListenerUtil.mutListener.listen(16207) ? (card.getDue() &gt; (getTime().intTime() + mCol.getConf().getInt(&quot;collapseTime&quot;))) : (ListenerUtil.mutListener.listen(16206) ? (card.getDue() != (getTime().intTime() + mCol.getConf().getInt(&quot;collapseTime&quot;))) : (ListenerUtil.mutListener.listen(16205) ? (card.getDue() == (getTime().intTime() + mCol.getConf().getInt(&quot;collapseTime&quot;))) : (card.getDue() &lt; (getTime().intTime() + mCol.getConf().getInt(&quot;collapseTime&quot;))))))))) {</span>
<span class="nc bnc" id="L1819" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(16210)) {</span>
<span class="nc" id="L1820">                            mLrnCount += 1;</span>
                        }
<span class="nc bnc" id="L1822" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(16218)) {</span>
                            // it twice in a row
<span class="nc bnc" id="L1824" title="All 26 branches missed.">                            if ((ListenerUtil.mutListener.listen(16212) ? ((ListenerUtil.mutListener.listen(16211) ? (!mLrnQueue.isEmpty() || revCount() == 0) : (!mLrnQueue.isEmpty() &amp;&amp; revCount() == 0)) || newCount() == 0) : ((ListenerUtil.mutListener.listen(16211) ? (!mLrnQueue.isEmpty() || revCount() == 0) : (!mLrnQueue.isEmpty() &amp;&amp; revCount() == 0)) &amp;&amp; newCount() == 0))) {</span>
<span class="nc" id="L1825">                                long smallestDue = mLrnQueue.getFirstDue();</span>
<span class="nc bnc" id="L1826" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(16217)) {</span>
<span class="nc bnc" id="L1827" title="All 8 branches missed.">                                    card.setDue(Math.max(card.getDue(), (ListenerUtil.mutListener.listen(16216) ? (smallestDue % 1) : (ListenerUtil.mutListener.listen(16215) ? (smallestDue / 1) : (ListenerUtil.mutListener.listen(16214) ? (smallestDue * 1) : (ListenerUtil.mutListener.listen(16213) ? (smallestDue - 1) : (smallestDue + 1)))))));</span>
                                }
                            }
                        }
<span class="nc bnc" id="L1831" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(16219)) {</span>
<span class="nc" id="L1832">                            _sortIntoLrn(card.getDue(), card.getId());</span>
                        }
                    }
                }
<span class="nc" id="L1836">            } else {</span>
                // the card is due in one or more days, so we need to use the day learn queue
<span class="nc bnc" id="L1838" title="All 248 branches missed.">                long ahead = (ListenerUtil.mutListener.listen(16184) ? (((ListenerUtil.mutListener.listen(16180) ? (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16179) ? (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) * SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16178) ? (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16177) ? (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) + SECONDS_PER_DAY) : (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) / SECONDS_PER_DAY)))))) % 1) : (ListenerUtil.mutListener.listen(16183) ? (((ListenerUtil.mutListener.listen(16180) ? (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16179) ? (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) * SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16178) ? (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16177) ? (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) + SECONDS_PER_DAY) : (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) / SECONDS_PER_DAY)))))) / 1) : (ListenerUtil.mutListener.listen(16182) ? (((ListenerUtil.mutListener.listen(16180) ? (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16179) ? (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) * SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16178) ? (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16177) ? (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) + SECONDS_PER_DAY) : (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) / SECONDS_PER_DAY)))))) * 1) : (ListenerUtil.mutListener.listen(16181) ? (((ListenerUtil.mutListener.listen(16180) ? (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16179) ? (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) * SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16178) ? (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16177) ? (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) + SECONDS_PER_DAY) : (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) / SECONDS_PER_DAY)))))) - 1) : (((ListenerUtil.mutListener.listen(16180) ? (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16179) ? (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) * SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16178) ? (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16177) ? (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) + SECONDS_PER_DAY) : (((ListenerUtil.mutListener.listen(16176) ? (card.getDue() % mDayCutoff) : (ListenerUtil.mutListener.listen(16175) ? (card.getDue() / mDayCutoff) : (ListenerUtil.mutListener.listen(16174) ? (card.getDue() * mDayCutoff) : (ListenerUtil.mutListener.listen(16173) ? (card.getDue() + mDayCutoff) : (card.getDue() - mDayCutoff)))))) / SECONDS_PER_DAY)))))) + 1)))));</span>
<span class="nc bnc" id="L1839" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16189)) {</span>
<span class="nc bnc" id="L1840" title="All 8 branches missed.">                    card.setDue((ListenerUtil.mutListener.listen(16188) ? (mToday % ahead) : (ListenerUtil.mutListener.listen(16187) ? (mToday / ahead) : (ListenerUtil.mutListener.listen(16186) ? (mToday * ahead) : (ListenerUtil.mutListener.listen(16185) ? (mToday - ahead) : (mToday + ahead))))));</span>
                }
<span class="nc bnc" id="L1842" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16190)) {</span>
<span class="nc" id="L1843">                    card.setQueue(Consts.QUEUE_TYPE_DAY_LEARN_RELEARN);</span>
                }
            }
        }
<span class="nc" id="L1847">        return delay;</span>
    }

    protected int _delayForGrade(JSONObject conf, int left) {
<span class="nc bnc" id="L1851" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16226)) {</span>
<span class="nc bnc" id="L1852" title="All 8 branches missed.">            left = (ListenerUtil.mutListener.listen(16225) ? (left / 1000) : (ListenerUtil.mutListener.listen(16224) ? (left * 1000) : (ListenerUtil.mutListener.listen(16223) ? (left - 1000) : (ListenerUtil.mutListener.listen(16222) ? (left + 1000) : (left % 1000)))));</span>
        }
        try {
            double delay;
<span class="nc" id="L1856">            JSONArray delays = conf.getJSONArray(&quot;delays&quot;);</span>
<span class="nc" id="L1857">            int len = delays.length();</span>
            try {
<span class="nc bnc" id="L1859" title="All 8 branches missed.">                delay = delays.getDouble((ListenerUtil.mutListener.listen(16235) ? (len % left) : (ListenerUtil.mutListener.listen(16234) ? (len / left) : (ListenerUtil.mutListener.listen(16233) ? (len * left) : (ListenerUtil.mutListener.listen(16232) ? (len + left) : (len - left))))));</span>
<span class="nc" id="L1860">            } catch (JSONException e) {</span>
<span class="nc bnc" id="L1861" title="All 22 branches missed.">                if ((ListenerUtil.mutListener.listen(16231) ? (conf.getJSONArray(&quot;delays&quot;).length() &gt;= 0) : (ListenerUtil.mutListener.listen(16230) ? (conf.getJSONArray(&quot;delays&quot;).length() &lt;= 0) : (ListenerUtil.mutListener.listen(16229) ? (conf.getJSONArray(&quot;delays&quot;).length() &lt; 0) : (ListenerUtil.mutListener.listen(16228) ? (conf.getJSONArray(&quot;delays&quot;).length() != 0) : (ListenerUtil.mutListener.listen(16227) ? (conf.getJSONArray(&quot;delays&quot;).length() == 0) : (conf.getJSONArray(&quot;delays&quot;).length() &gt; 0))))))) {</span>
<span class="nc" id="L1862">                    delay = conf.getJSONArray(&quot;delays&quot;).getDouble(0);</span>
                } else {
                    // user deleted final step; use dummy value
<span class="nc" id="L1865">                    delay = 1.0;</span>
                }
<span class="nc" id="L1867">            }</span>
<span class="nc bnc" id="L1868" title="All 8 branches missed.">            return (int) ((ListenerUtil.mutListener.listen(16239) ? (delay % 60.0) : (ListenerUtil.mutListener.listen(16238) ? (delay / 60.0) : (ListenerUtil.mutListener.listen(16237) ? (delay - 60.0) : (ListenerUtil.mutListener.listen(16236) ? (delay + 60.0) : (delay * 60.0))))));</span>
<span class="nc" id="L1869">        } catch (JSONException e) {</span>
<span class="nc" id="L1870">            throw new RuntimeException(e);</span>
        }
    }

    private int _delayForRepeatingGrade(@NonNull JSONObject conf, int left) {
        // halfway between last and  next
<span class="nc" id="L1876">        int delay1 = _delayForGrade(conf, left);</span>
        int delay2;
<span class="nc bnc" id="L1878" title="All 22 branches missed.">        if ((ListenerUtil.mutListener.listen(16244) ? (conf.getJSONArray(&quot;delays&quot;).length() &gt;= 1) : (ListenerUtil.mutListener.listen(16243) ? (conf.getJSONArray(&quot;delays&quot;).length() &lt;= 1) : (ListenerUtil.mutListener.listen(16242) ? (conf.getJSONArray(&quot;delays&quot;).length() &lt; 1) : (ListenerUtil.mutListener.listen(16241) ? (conf.getJSONArray(&quot;delays&quot;).length() != 1) : (ListenerUtil.mutListener.listen(16240) ? (conf.getJSONArray(&quot;delays&quot;).length() == 1) : (conf.getJSONArray(&quot;delays&quot;).length() &gt; 1))))))) {</span>
<span class="nc bnc" id="L1879" title="All 8 branches missed.">            delay2 = _delayForGrade(conf, (ListenerUtil.mutListener.listen(16252) ? (left % 1) : (ListenerUtil.mutListener.listen(16251) ? (left / 1) : (ListenerUtil.mutListener.listen(16250) ? (left * 1) : (ListenerUtil.mutListener.listen(16249) ? (left + 1) : (left - 1))))));</span>
        } else {
<span class="nc bnc" id="L1881" title="All 8 branches missed.">            delay2 = (ListenerUtil.mutListener.listen(16248) ? (delay1 % 2) : (ListenerUtil.mutListener.listen(16247) ? (delay1 / 2) : (ListenerUtil.mutListener.listen(16246) ? (delay1 - 2) : (ListenerUtil.mutListener.listen(16245) ? (delay1 + 2) : (delay1 * 2)))));</span>
        }
<span class="nc bnc" id="L1883" title="All 48 branches missed.">        return (ListenerUtil.mutListener.listen(16260) ? (((ListenerUtil.mutListener.listen(16256) ? (delay1 % Math.max(delay1, delay2)) : (ListenerUtil.mutListener.listen(16255) ? (delay1 / Math.max(delay1, delay2)) : (ListenerUtil.mutListener.listen(16254) ? (delay1 * Math.max(delay1, delay2)) : (ListenerUtil.mutListener.listen(16253) ? (delay1 - Math.max(delay1, delay2)) : (delay1 + Math.max(delay1, delay2))))))) % 2) : (ListenerUtil.mutListener.listen(16259) ? (((ListenerUtil.mutListener.listen(16256) ? (delay1 % Math.max(delay1, delay2)) : (ListenerUtil.mutListener.listen(16255) ? (delay1 / Math.max(delay1, delay2)) : (ListenerUtil.mutListener.listen(16254) ? (delay1 * Math.max(delay1, delay2)) : (ListenerUtil.mutListener.listen(16253) ? (delay1 - Math.max(delay1, delay2)) : (delay1 + Math.max(delay1, delay2))))))) * 2) : (ListenerUtil.mutListener.listen(16258) ? (((ListenerUtil.mutListener.listen(16256) ? (delay1 % Math.max(delay1, delay2)) : (ListenerUtil.mutListener.listen(16255) ? (delay1 / Math.max(delay1, delay2)) : (ListenerUtil.mutListener.listen(16254) ? (delay1 * Math.max(delay1, delay2)) : (ListenerUtil.mutListener.listen(16253) ? (delay1 - Math.max(delay1, delay2)) : (delay1 + Math.max(delay1, delay2))))))) - 2) : (ListenerUtil.mutListener.listen(16257) ? (((ListenerUtil.mutListener.listen(16256) ? (delay1 % Math.max(delay1, delay2)) : (ListenerUtil.mutListener.listen(16255) ? (delay1 / Math.max(delay1, delay2)) : (ListenerUtil.mutListener.listen(16254) ? (delay1 * Math.max(delay1, delay2)) : (ListenerUtil.mutListener.listen(16253) ? (delay1 - Math.max(delay1, delay2)) : (delay1 + Math.max(delay1, delay2))))))) + 2) : (((ListenerUtil.mutListener.listen(16256) ? (delay1 % Math.max(delay1, delay2)) : (ListenerUtil.mutListener.listen(16255) ? (delay1 / Math.max(delay1, delay2)) : (ListenerUtil.mutListener.listen(16254) ? (delay1 * Math.max(delay1, delay2)) : (ListenerUtil.mutListener.listen(16253) ? (delay1 - Math.max(delay1, delay2)) : (delay1 + Math.max(delay1, delay2))))))) / 2)))));</span>
    }

    // Overridden: RELEARNING does not exists in V1
    @NonNull
    protected JSONObject _lrnConf(@NonNull Card card) {
<span class="nc bnc" id="L1889" title="All 90 branches missed.">        if ((ListenerUtil.mutListener.listen(16271) ? ((ListenerUtil.mutListener.listen(16265) ? (card.getType() &gt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16264) ? (card.getType() &lt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16263) ? (card.getType() &gt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16262) ? (card.getType() &lt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16261) ? (card.getType() != Consts.CARD_TYPE_REV) : (card.getType() == Consts.CARD_TYPE_REV)))))) &amp;&amp; (ListenerUtil.mutListener.listen(16270) ? (card.getType() &gt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16269) ? (card.getType() &lt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16268) ? (card.getType() &gt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16267) ? (card.getType() &lt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16266) ? (card.getType() != Consts.CARD_TYPE_RELEARNING) : (card.getType() == Consts.CARD_TYPE_RELEARNING))))))) : ((ListenerUtil.mutListener.listen(16265) ? (card.getType() &gt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16264) ? (card.getType() &lt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16263) ? (card.getType() &gt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16262) ? (card.getType() &lt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16261) ? (card.getType() != Consts.CARD_TYPE_REV) : (card.getType() == Consts.CARD_TYPE_REV)))))) || (ListenerUtil.mutListener.listen(16270) ? (card.getType() &gt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16269) ? (card.getType() &lt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16268) ? (card.getType() &gt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16267) ? (card.getType() &lt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16266) ? (card.getType() != Consts.CARD_TYPE_RELEARNING) : (card.getType() == Consts.CARD_TYPE_RELEARNING))))))))) {</span>
<span class="nc" id="L1890">            return _lapseConf(card);</span>
        } else {
<span class="nc" id="L1892">            return _newConf(card);</span>
        }
    }

    // Overriden
    protected void _rescheduleAsRev(@NonNull Card card, @NonNull JSONObject conf, boolean early) {
<span class="nc bnc" id="L1898" title="All 90 branches missed.">        boolean lapse = ((ListenerUtil.mutListener.listen(16282) ? ((ListenerUtil.mutListener.listen(16276) ? (card.getType() &gt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16275) ? (card.getType() &lt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16274) ? (card.getType() &gt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16273) ? (card.getType() &lt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16272) ? (card.getType() != Consts.CARD_TYPE_REV) : (card.getType() == Consts.CARD_TYPE_REV)))))) &amp;&amp; (ListenerUtil.mutListener.listen(16281) ? (card.getType() &gt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16280) ? (card.getType() &lt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16279) ? (card.getType() &gt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16278) ? (card.getType() &lt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16277) ? (card.getType() != Consts.CARD_TYPE_RELEARNING) : (card.getType() == Consts.CARD_TYPE_RELEARNING))))))) : ((ListenerUtil.mutListener.listen(16276) ? (card.getType() &gt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16275) ? (card.getType() &lt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16274) ? (card.getType() &gt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16273) ? (card.getType() &lt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16272) ? (card.getType() != Consts.CARD_TYPE_REV) : (card.getType() == Consts.CARD_TYPE_REV)))))) || (ListenerUtil.mutListener.listen(16281) ? (card.getType() &gt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16280) ? (card.getType() &lt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16279) ? (card.getType() &gt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16278) ? (card.getType() &lt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16277) ? (card.getType() != Consts.CARD_TYPE_RELEARNING) : (card.getType() == Consts.CARD_TYPE_RELEARNING)))))))));</span>
<span class="nc bnc" id="L1899" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16285)) {</span>
<span class="nc bnc" id="L1900" title="All 2 branches missed.">            if (lapse) {</span>
<span class="nc bnc" id="L1901" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16284)) {</span>
<span class="nc" id="L1902">                    _rescheduleGraduatingLapse(card, early);</span>
                }
            } else {
<span class="nc bnc" id="L1905" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16283)) {</span>
<span class="nc" id="L1906">                    _rescheduleNew(card, conf, early);</span>
                }
            }
        }
<span class="nc bnc" id="L1910" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16287)) {</span>
            // if we were dynamic, graduating means moving back to the old deck
<span class="nc bnc" id="L1912" title="All 2 branches missed.">            if (card.isInDynamicDeck()) {</span>
<span class="nc bnc" id="L1913" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16286)) {</span>
<span class="nc" id="L1914">                    _removeFromFiltered(card);</span>
                }
            }
        }
<span class="nc" id="L1918">    }</span>

    private void _rescheduleGraduatingLapse(@NonNull Card card, boolean early) {
<span class="nc bnc" id="L1921" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16293)) {</span>
<span class="nc bnc" id="L1922" title="All 2 branches missed.">            if (early) {</span>
<span class="nc bnc" id="L1923" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16292)) {</span>
<span class="nc bnc" id="L1924" title="All 8 branches missed.">                    card.setIvl((ListenerUtil.mutListener.listen(16291) ? (card.getIvl() % 1) : (ListenerUtil.mutListener.listen(16290) ? (card.getIvl() / 1) : (ListenerUtil.mutListener.listen(16289) ? (card.getIvl() * 1) : (ListenerUtil.mutListener.listen(16288) ? (card.getIvl() - 1) : (card.getIvl() + 1))))));</span>
                }
            }
        }
<span class="nc bnc" id="L1928" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16298)) {</span>
<span class="nc bnc" id="L1929" title="All 8 branches missed.">            card.setDue((ListenerUtil.mutListener.listen(16297) ? (mToday % card.getIvl()) : (ListenerUtil.mutListener.listen(16296) ? (mToday / card.getIvl()) : (ListenerUtil.mutListener.listen(16295) ? (mToday * card.getIvl()) : (ListenerUtil.mutListener.listen(16294) ? (mToday - card.getIvl()) : (mToday + card.getIvl()))))));</span>
        }
<span class="nc bnc" id="L1931" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16299)) {</span>
<span class="nc" id="L1932">            card.setQueue(Consts.QUEUE_TYPE_REV);</span>
        }
<span class="nc bnc" id="L1934" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16300)) {</span>
<span class="nc" id="L1935">            card.setType(Consts.CARD_TYPE_REV);</span>
        }
<span class="nc" id="L1937">    }</span>

    // Overriden: V1 has type rev for relearinng
    protected int _startingLeft(@NonNull Card card) {
        JSONObject conf;
<span class="nc bnc" id="L1942" title="All 22 branches missed.">        if ((ListenerUtil.mutListener.listen(16305) ? (card.getType() &gt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16304) ? (card.getType() &lt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16303) ? (card.getType() &gt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16302) ? (card.getType() &lt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16301) ? (card.getType() != Consts.CARD_TYPE_RELEARNING) : (card.getType() == Consts.CARD_TYPE_RELEARNING))))))) {</span>
<span class="nc" id="L1943">            conf = _lapseConf(card);</span>
        } else {
<span class="nc" id="L1945">            conf = _lrnConf(card);</span>
        }
<span class="nc" id="L1947">        int tot = conf.getJSONArray(&quot;delays&quot;).length();</span>
<span class="nc" id="L1948">        int tod = _leftToday(conf.getJSONArray(&quot;delays&quot;), tot);</span>
<span class="nc bnc" id="L1949" title="All 48 branches missed.">        return (ListenerUtil.mutListener.listen(16313) ? (tot % (ListenerUtil.mutListener.listen(16309) ? (tod % 1000) : (ListenerUtil.mutListener.listen(16308) ? (tod / 1000) : (ListenerUtil.mutListener.listen(16307) ? (tod - 1000) : (ListenerUtil.mutListener.listen(16306) ? (tod + 1000) : (tod * 1000)))))) : (ListenerUtil.mutListener.listen(16312) ? (tot / (ListenerUtil.mutListener.listen(16309) ? (tod % 1000) : (ListenerUtil.mutListener.listen(16308) ? (tod / 1000) : (ListenerUtil.mutListener.listen(16307) ? (tod - 1000) : (ListenerUtil.mutListener.listen(16306) ? (tod + 1000) : (tod * 1000)))))) : (ListenerUtil.mutListener.listen(16311) ? (tot * (ListenerUtil.mutListener.listen(16309) ? (tod % 1000) : (ListenerUtil.mutListener.listen(16308) ? (tod / 1000) : (ListenerUtil.mutListener.listen(16307) ? (tod - 1000) : (ListenerUtil.mutListener.listen(16306) ? (tod + 1000) : (tod * 1000)))))) : (ListenerUtil.mutListener.listen(16310) ? (tot - (ListenerUtil.mutListener.listen(16309) ? (tod % 1000) : (ListenerUtil.mutListener.listen(16308) ? (tod / 1000) : (ListenerUtil.mutListener.listen(16307) ? (tod - 1000) : (ListenerUtil.mutListener.listen(16306) ? (tod + 1000) : (tod * 1000)))))) : (tot + (ListenerUtil.mutListener.listen(16309) ? (tod % 1000) : (ListenerUtil.mutListener.listen(16308) ? (tod / 1000) : (ListenerUtil.mutListener.listen(16307) ? (tod - 1000) : (ListenerUtil.mutListener.listen(16306) ? (tod + 1000) : (tod * 1000))))))))));</span>
    }

    /**
     * the number of steps that can be completed by the day cutoff
     */
    protected int _leftToday(@NonNull JSONArray delays, int left) {
<span class="nc" id="L1956">        return _leftToday(delays, left, 0);</span>
    }

    private int _leftToday(@NonNull JSONArray delays, int left, long now) {
<span class="nc bnc" id="L1960" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16320)) {</span>
<span class="nc bnc" id="L1961" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(16318) ? (now &gt;= 0) : (ListenerUtil.mutListener.listen(16317) ? (now &lt;= 0) : (ListenerUtil.mutListener.listen(16316) ? (now &gt; 0) : (ListenerUtil.mutListener.listen(16315) ? (now &lt; 0) : (ListenerUtil.mutListener.listen(16314) ? (now != 0) : (now == 0))))))) {</span>
<span class="nc bnc" id="L1962" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16319)) {</span>
<span class="nc" id="L1963">                    now = getTime().intTime();</span>
                }
            }
        }
<span class="nc" id="L1967">        int ok = 0;</span>
<span class="nc" id="L1968">        int offset = Math.min(left, delays.length());</span>
<span class="nc bnc" id="L1969" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16342)) {</span>
            {
<span class="nc" id="L1971">                long _loopCounter316 = 0;</span>
<span class="nc bnc" id="L1972" title="All 22 branches missed.">                for (int i = 0; (ListenerUtil.mutListener.listen(16341) ? (i &gt;= offset) : (ListenerUtil.mutListener.listen(16340) ? (i &lt;= offset) : (ListenerUtil.mutListener.listen(16339) ? (i &gt; offset) : (ListenerUtil.mutListener.listen(16338) ? (i != offset) : (ListenerUtil.mutListener.listen(16337) ? (i == offset) : (i &lt; offset)))))); i++) {</span>
<span class="nc" id="L1973">                    ListenerUtil.loopListener.listen(&quot;_loopCounter316&quot;, ++_loopCounter316);</span>
<span class="nc bnc" id="L1974" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(16329)) {</span>
<span class="nc bnc" id="L1975" title="All 48 branches missed.">                        now += (int) ((ListenerUtil.mutListener.listen(16328) ? (delays.getDouble((ListenerUtil.mutListener.listen(16324) ? (delays.length() % offset) : (ListenerUtil.mutListener.listen(16323) ? (delays.length() / offset) : (ListenerUtil.mutListener.listen(16322) ? (delays.length() * offset) : (ListenerUtil.mutListener.listen(16321) ? (delays.length() + offset) : (delays.length() - offset))))) + i) % 60.0) : (ListenerUtil.mutListener.listen(16327) ? (delays.getDouble((ListenerUtil.mutListener.listen(16324) ? (delays.length() % offset) : (ListenerUtil.mutListener.listen(16323) ? (delays.length() / offset) : (ListenerUtil.mutListener.listen(16322) ? (delays.length() * offset) : (ListenerUtil.mutListener.listen(16321) ? (delays.length() + offset) : (delays.length() - offset))))) + i) / 60.0) : (ListenerUtil.mutListener.listen(16326) ? (delays.getDouble((ListenerUtil.mutListener.listen(16324) ? (delays.length() % offset) : (ListenerUtil.mutListener.listen(16323) ? (delays.length() / offset) : (ListenerUtil.mutListener.listen(16322) ? (delays.length() * offset) : (ListenerUtil.mutListener.listen(16321) ? (delays.length() + offset) : (delays.length() - offset))))) + i) - 60.0) : (ListenerUtil.mutListener.listen(16325) ? (delays.getDouble((ListenerUtil.mutListener.listen(16324) ? (delays.length() % offset) : (ListenerUtil.mutListener.listen(16323) ? (delays.length() / offset) : (ListenerUtil.mutListener.listen(16322) ? (delays.length() * offset) : (ListenerUtil.mutListener.listen(16321) ? (delays.length() + offset) : (delays.length() - offset))))) + i) + 60.0) : (delays.getDouble((ListenerUtil.mutListener.listen(16324) ? (delays.length() % offset) : (ListenerUtil.mutListener.listen(16323) ? (delays.length() / offset) : (ListenerUtil.mutListener.listen(16322) ? (delays.length() * offset) : (ListenerUtil.mutListener.listen(16321) ? (delays.length() + offset) : (delays.length() - offset))))) + i) * 60.0))))));</span>
                    }
<span class="nc bnc" id="L1977" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(16335)) {</span>
<span class="nc bnc" id="L1978" title="All 22 branches missed.">                        if ((ListenerUtil.mutListener.listen(16334) ? (now &gt;= mDayCutoff) : (ListenerUtil.mutListener.listen(16333) ? (now &lt;= mDayCutoff) : (ListenerUtil.mutListener.listen(16332) ? (now &lt; mDayCutoff) : (ListenerUtil.mutListener.listen(16331) ? (now != mDayCutoff) : (ListenerUtil.mutListener.listen(16330) ? (now == mDayCutoff) : (now &gt; mDayCutoff))))))) {</span>
<span class="nc" id="L1979">                            break;</span>
                        }
                    }
<span class="nc bnc" id="L1982" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(16336)) {</span>
<span class="nc" id="L1983">                        ok = i;</span>
                    }
                }
            }
        }
<span class="nc bnc" id="L1988" title="All 8 branches missed.">        return (ListenerUtil.mutListener.listen(16346) ? (ok % 1) : (ListenerUtil.mutListener.listen(16345) ? (ok / 1) : (ListenerUtil.mutListener.listen(16344) ? (ok * 1) : (ListenerUtil.mutListener.listen(16343) ? (ok - 1) : (ok + 1)))));</span>
    }

    protected int _graduatingIvl(@NonNull Card card, @NonNull JSONObject conf, boolean early) {
<span class="nc" id="L1992">        return _graduatingIvl(card, conf, early, true);</span>
    }

    private int _graduatingIvl(@NonNull Card card, @NonNull JSONObject conf, boolean early, boolean fuzz) {
<span class="nc bnc" id="L1996" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16362)) {</span>
<span class="nc bnc" id="L1997" title="All 90 branches missed.">            if ((ListenerUtil.mutListener.listen(16357) ? ((ListenerUtil.mutListener.listen(16351) ? (card.getType() &gt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16350) ? (card.getType() &lt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16349) ? (card.getType() &gt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16348) ? (card.getType() &lt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16347) ? (card.getType() != Consts.CARD_TYPE_REV) : (card.getType() == Consts.CARD_TYPE_REV)))))) &amp;&amp; (ListenerUtil.mutListener.listen(16356) ? (card.getType() &gt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16355) ? (card.getType() &lt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16354) ? (card.getType() &gt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16353) ? (card.getType() &lt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16352) ? (card.getType() != Consts.CARD_TYPE_RELEARNING) : (card.getType() == Consts.CARD_TYPE_RELEARNING))))))) : ((ListenerUtil.mutListener.listen(16351) ? (card.getType() &gt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16350) ? (card.getType() &lt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16349) ? (card.getType() &gt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16348) ? (card.getType() &lt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16347) ? (card.getType() != Consts.CARD_TYPE_REV) : (card.getType() == Consts.CARD_TYPE_REV)))))) || (ListenerUtil.mutListener.listen(16356) ? (card.getType() &gt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16355) ? (card.getType() &lt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16354) ? (card.getType() &gt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16353) ? (card.getType() &lt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16352) ? (card.getType() != Consts.CARD_TYPE_RELEARNING) : (card.getType() == Consts.CARD_TYPE_RELEARNING))))))))) {</span>
<span class="nc bnc" id="L1998" title="All 2 branches missed.">                int bonus = early ? 1 : 0;</span>
<span class="nc bnc" id="L1999" title="All 8 branches missed.">                return (ListenerUtil.mutListener.listen(16361) ? (card.getIvl() % bonus) : (ListenerUtil.mutListener.listen(16360) ? (card.getIvl() / bonus) : (ListenerUtil.mutListener.listen(16359) ? (card.getIvl() * bonus) : (ListenerUtil.mutListener.listen(16358) ? (card.getIvl() - bonus) : (card.getIvl() + bonus)))));</span>
            }
        }
        int ideal;
<span class="nc" id="L2003">        JSONArray ints = conf.getJSONArray(&quot;ints&quot;);</span>
<span class="nc bnc" id="L2004" title="All 2 branches missed.">        if (!early) {</span>
            // graduate
<span class="nc" id="L2006">            ideal = ints.getInt(0);</span>
        } else {
            // early remove
<span class="nc" id="L2009">            ideal = ints.getInt(1);</span>
        }
<span class="nc bnc" id="L2011" title="All 2 branches missed.">        if (fuzz) {</span>
<span class="nc" id="L2012">            ideal = _fuzzedIvl(ideal);</span>
        }
<span class="nc" id="L2014">        return ideal;</span>
    }

    /**
     * Reschedule a new card that's graduated for the first time.
     * Overriden: V1 does not set type and queue
     */
    private void _rescheduleNew(@NonNull Card card, @NonNull JSONObject conf, boolean early) {
<span class="nc bnc" id="L2022" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16363)) {</span>
<span class="nc" id="L2023">            card.setIvl(_graduatingIvl(card, conf, early));</span>
        }
<span class="nc bnc" id="L2025" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16368)) {</span>
<span class="nc bnc" id="L2026" title="All 8 branches missed.">            card.setDue((ListenerUtil.mutListener.listen(16367) ? (mToday % card.getIvl()) : (ListenerUtil.mutListener.listen(16366) ? (mToday / card.getIvl()) : (ListenerUtil.mutListener.listen(16365) ? (mToday * card.getIvl()) : (ListenerUtil.mutListener.listen(16364) ? (mToday - card.getIvl()) : (mToday + card.getIvl()))))));</span>
        }
<span class="nc bnc" id="L2028" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16369)) {</span>
<span class="nc" id="L2029">            card.setFactor(conf.getInt(&quot;initialFactor&quot;));</span>
        }
<span class="nc bnc" id="L2031" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16370)) {</span>
<span class="nc" id="L2032">            card.setType(Consts.CARD_TYPE_REV);</span>
        }
<span class="nc bnc" id="L2034" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16371)) {</span>
<span class="nc" id="L2035">            card.setQueue(Consts.QUEUE_TYPE_REV);</span>
        }
<span class="nc" id="L2037">    }</span>

    protected void _logLrn(@NonNull Card card, @Consts.BUTTON_TYPE int ease, @NonNull JSONObject conf, boolean leaving, @Consts.REVLOG_TYPE int type, int lastLeft) {
<span class="nc" id="L2040">        int lastIvl = -(_delayForGrade(conf, lastLeft));</span>
<span class="nc bnc" id="L2041" title="All 2 branches missed.">        int ivl = leaving ? card.getIvl() : -(_delayForGrade(conf, card.getLeft()));</span>
<span class="nc bnc" id="L2042" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16372)) {</span>
<span class="nc" id="L2043">            log(card.getId(), mCol.usn(), ease, ivl, lastIvl, card.getFactor(), card.timeTaken(), type);</span>
        }
<span class="nc" id="L2045">    }</span>

    @Override
    public int logCount() {
<span class="nc" id="L2049">        return mCol.getDb().queryScalar(&quot;SELECT count() FROM revlog&quot;);</span>
    }

    protected void log(long id, int usn, @Consts.BUTTON_TYPE int ease, int ivl, int lastIvl, int factor, int timeTaken, @Consts.REVLOG_TYPE int type) {
        try {
<span class="nc bnc" id="L2054" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(16375)) {</span>
<span class="nc" id="L2055">                mCol.getDb().execute(&quot;INSERT INTO revlog VALUES (?,?,?,?,?,?,?,?,?)&quot;, getTime().intTimeMS(), id, usn, ease, ivl, lastIvl, factor, timeTaken, type);</span>
            }
<span class="nc" id="L2057">        } catch (SQLiteConstraintException e) {</span>
            try {
<span class="nc bnc" id="L2059" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16373)) {</span>
<span class="nc" id="L2060">                    Thread.sleep(10);</span>
                }
<span class="nc" id="L2062">            } catch (InterruptedException e1) {</span>
<span class="nc" id="L2063">                throw new RuntimeException(e1);</span>
<span class="nc" id="L2064">            }</span>
<span class="nc bnc" id="L2065" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(16374)) {</span>
<span class="nc" id="L2066">                log(id, usn, ease, ivl, lastIvl, factor, timeTaken, type);</span>
            }
<span class="nc" id="L2068">        }</span>
<span class="nc" id="L2069">    }</span>

    // Overriden: uses left/1000 in V1
    private int _lrnForDeck(long did) {
        try {
<span class="nc" id="L2074">            int cnt = mCol.getDb().queryScalar(&quot;SELECT count() FROM (SELECT null FROM cards WHERE did = ?&quot; + &quot; AND queue = &quot; + Consts.QUEUE_TYPE_LRN + &quot; AND due &lt; ?&quot; + &quot; LIMIT ?)&quot;, did, (getTime().intTime() + mCol.getConf().getInt(&quot;collapseTime&quot;)), mReportLimit);</span>
<span class="nc bnc" id="L2075" title="All 8 branches missed.">            return (ListenerUtil.mutListener.listen(16379) ? (cnt % mCol.getDb().queryScalar(&quot;SELECT count() FROM (SELECT null FROM cards WHERE did = ?&quot; + &quot; AND queue = &quot; + Consts.QUEUE_TYPE_DAY_LEARN_RELEARN + &quot; AND due &lt;= ?&quot; + &quot; LIMIT ?)&quot;, did, mToday, mReportLimit)) : (ListenerUtil.mutListener.listen(16378) ? (cnt / mCol.getDb().queryScalar(&quot;SELECT count() FROM (SELECT null FROM cards WHERE did = ?&quot; + &quot; AND queue = &quot; + Consts.QUEUE_TYPE_DAY_LEARN_RELEARN + &quot; AND due &lt;= ?&quot; + &quot; LIMIT ?)&quot;, did, mToday, mReportLimit)) : (ListenerUtil.mutListener.listen(16377) ? (cnt * mCol.getDb().queryScalar(&quot;SELECT count() FROM (SELECT null FROM cards WHERE did = ?&quot; + &quot; AND queue = &quot; + Consts.QUEUE_TYPE_DAY_LEARN_RELEARN + &quot; AND due &lt;= ?&quot; + &quot; LIMIT ?)&quot;, did, mToday, mReportLimit)) : (ListenerUtil.mutListener.listen(16376) ? (cnt - mCol.getDb().queryScalar(&quot;SELECT count() FROM (SELECT null FROM cards WHERE did = ?&quot; + &quot; AND queue = &quot; + Consts.QUEUE_TYPE_DAY_LEARN_RELEARN + &quot; AND due &lt;= ?&quot; + &quot; LIMIT ?)&quot;, did, mToday, mReportLimit)) : (cnt + mCol.getDb().queryScalar(&quot;SELECT count() FROM (SELECT null FROM cards WHERE did = ?&quot; + &quot; AND queue = &quot; + Consts.QUEUE_TYPE_DAY_LEARN_RELEARN + &quot; AND due &lt;= ?&quot; + &quot; LIMIT ?)&quot;, did, mToday, mReportLimit))))));</span>
<span class="nc" id="L2076">        } catch (SQLException e) {</span>
<span class="nc" id="L2077">            throw new RuntimeException(e);</span>
        }
    }

    /**
     * Maximal number of rev card still to see today in current deck. It's computed as:
     * the number of rev card to see by day according to the deck optinos
     * minus the number of rev cards seen today in this deck or a descendant
     * plus the number of extra cards to see today in this deck, a parent or a descendant.
     *
     * Respects the limits of its ancestor. Current card is treated the same way as other cards.
     * @param considerCurrentCard whether the current card should be taken from the limit (if it belongs to this deck)
     */
    private int _currentRevLimit(boolean considerCurrentCard) {
<span class="fc" id="L2091">        Deck d = mCol.getDecks().get(mCol.getDecks().selected(), false);</span>
<span class="fc" id="L2092">        return _deckRevLimitSingle(d, considerCurrentCard);</span>
    }

    /**
     * Maximal number of rev card still to see today in deck d. It's computed as:
     * the number of rev card to see by day according to the deck optinos
     * minus the number of rev cards seen today in deck d or a descendant
     * plus the number of extra cards to see today in deck d, a parent or a descendant.
     *
     * Respects the limits of its ancestor
     * Overridden: V1 does not consider parents limit
     * @param considerCurrentCard whether the current card should be taken from the limit (if it belongs to this deck)
     */
    protected int _deckRevLimitSingle(@Nullable Deck d, boolean considerCurrentCard) {
<span class="fc" id="L2106">        return _deckRevLimitSingle(d, null, considerCurrentCard);</span>
    }

    /**
     * Maximal number of rev card still to see today in deck d. It's computed as:
     * the number of rev card to see by day according to the deck optinos
     * minus the number of rev cards seen today in deck d or a descendant
     * plus the number of extra cards to see today in deck d, a parent or a descendant.
     *
     * Respects the limits of its ancestor, either given as parentLimit, or through direct computation.
     * @param parentLimit Limit of the parent, this is an upper bound on the limit of this deck
     * @param considerCurrentCard whether the current card should be taken from the limit (if it belongs to this deck)
     */
    private int _deckRevLimitSingle(@Nullable Deck d, Integer parentLimit, boolean considerCurrentCard) {
        // invalid deck selected?
<span class="pc bpc" id="L2121" title="1 of 2 branches missed.">        if (d == null) {</span>
<span class="nc" id="L2122">            return 0;</span>
        }
<span class="pc bpc" id="L2124" title="1 of 2 branches missed.">        if (d.getInt(&quot;dyn&quot;) == DECK_DYN) {</span>
<span class="nc" id="L2125">            return mDynReportLimit;</span>
        }
<span class="fc" id="L2127">        long did = d.getLong(&quot;id&quot;);</span>
        @NonNull
<span class="fc" id="L2129">        DeckConfig c = mCol.getDecks().confForDid(did);</span>
<span class="pc bpc" id="L2130" title="4 of 8 branches missed.">        int lim = Math.max(0, (ListenerUtil.mutListener.listen(16383) ? (c.getJSONObject(&quot;rev&quot;).getInt(&quot;perDay&quot;) % d.getJSONArray(&quot;revToday&quot;).getInt(1)) : (ListenerUtil.mutListener.listen(16382) ? (c.getJSONObject(&quot;rev&quot;).getInt(&quot;perDay&quot;) / d.getJSONArray(&quot;revToday&quot;).getInt(1)) : (ListenerUtil.mutListener.listen(16381) ? (c.getJSONObject(&quot;rev&quot;).getInt(&quot;perDay&quot;) * d.getJSONArray(&quot;revToday&quot;).getInt(1)) : (ListenerUtil.mutListener.listen(16380) ? (c.getJSONObject(&quot;rev&quot;).getInt(&quot;perDay&quot;) + d.getJSONArray(&quot;revToday&quot;).getInt(1)) : (c.getJSONObject(&quot;rev&quot;).getInt(&quot;perDay&quot;) - d.getJSONArray(&quot;revToday&quot;).getInt(1)))))));</span>
<span class="pc bpc" id="L2131" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16386)) {</span>
            // So currentCard does not have to be taken into consideration in this method
<span class="pc bpc" id="L2133" title="7 of 10 branches missed.">            if ((ListenerUtil.mutListener.listen(16384) ? (considerCurrentCard || currentCardIsInQueueWithDeck(Consts.QUEUE_TYPE_REV, did)) : (considerCurrentCard &amp;&amp; currentCardIsInQueueWithDeck(Consts.QUEUE_TYPE_REV, did)))) {</span>
<span class="nc bnc" id="L2134" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16385)) {</span>
<span class="nc" id="L2135">                    lim--;</span>
                }
            }
        }
<span class="pc bpc" id="L2139" title="1 of 2 branches missed.">        if (parentLimit != null) {</span>
<span class="nc" id="L2140">            return Math.min(parentLimit, lim);</span>
<span class="pc bpc" id="L2141" title="1 of 2 branches missed.">        } else if (!d.getString(&quot;name&quot;).contains(&quot;::&quot;)) {</span>
<span class="fc" id="L2142">            return lim;</span>
        } else {
<span class="nc bnc" id="L2144" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(16388)) {</span>
                {
<span class="nc" id="L2146">                    long _loopCounter317 = 0;</span>
<span class="nc bnc" id="L2147" title="All 2 branches missed.">                    for (@NonNull Deck parent : mCol.getDecks().parents(did)) {</span>
<span class="nc" id="L2148">                        ListenerUtil.loopListener.listen(&quot;_loopCounter317&quot;, ++_loopCounter317);</span>
<span class="nc bnc" id="L2149" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(16387)) {</span>
                            // pass in dummy parentLimit so we don't do parent lookup again
<span class="nc" id="L2151">                            lim = Math.min(lim, _deckRevLimitSingle(parent, lim, considerCurrentCard));</span>
                        }
<span class="nc" id="L2153">                    }</span>
                }
            }
<span class="nc" id="L2156">            return lim;</span>
        }
    }

    protected int _revForDeck(long did, int lim, @NonNull Decks.Node childMap) {
<span class="nc" id="L2161">        List&lt;Long&gt; dids = mCol.getDecks().childDids(did, childMap);</span>
<span class="nc bnc" id="L2162" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16389)) {</span>
<span class="nc" id="L2163">            dids.add(0, did);</span>
        }
<span class="nc bnc" id="L2165" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16390)) {</span>
<span class="nc" id="L2166">            lim = Math.min(lim, mReportLimit);</span>
        }
<span class="nc" id="L2168">        return mCol.getDb().queryScalar(&quot;SELECT count() FROM (SELECT 1 FROM cards WHERE did in &quot; + Utils.ids2str(dids) + &quot; AND queue = &quot; + Consts.QUEUE_TYPE_REV + &quot; AND due &lt;= ? LIMIT ?)&quot;, mToday, lim);</span>
    }

    // Overriden: V1 uses _walkingCount
    protected void _resetRevCount() {
<span class="nc bnc" id="L2173" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16391)) {</span>
<span class="nc" id="L2174">            _resetRevCount(null);</span>
        }
<span class="nc" id="L2176">    }</span>

    protected void _resetRevCount(@Nullable CancelListener cancelListener) {
<span class="fc" id="L2179">        int lim = _currentRevLimit(true);</span>
<span class="pc bpc" id="L2180" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16392)) {</span>
<span class="pc bpc" id="L2181" title="1 of 2 branches missed.">            if (isCancelled(cancelListener))</span>
<span class="nc" id="L2182">                return;</span>
        }
<span class="pc bpc" id="L2184" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16393)) {</span>
<span class="fc" id="L2185">            mRevCount = mCol.getDb().queryScalar(&quot;SELECT count() FROM (SELECT id FROM cards WHERE did in &quot; + _deckLimit() + &quot; AND queue = &quot; + Consts.QUEUE_TYPE_REV + &quot; AND due &lt;= ? AND id != ? LIMIT ?)&quot;, mToday, currentCardId(), lim);</span>
        }
<span class="fc" id="L2187">    }</span>

    // Overridden: V1 remove clear
    protected void _resetRev() {
<span class="nc bnc" id="L2191" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16394)) {</span>
<span class="nc" id="L2192">            _resetRevCount();</span>
        }
<span class="nc bnc" id="L2194" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16395)) {</span>
<span class="nc" id="L2195">            _resetRevQueue();</span>
        }
<span class="nc" id="L2197">    }</span>

    protected void _resetRevQueue() {
<span class="pc bpc" id="L2200" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16396)) {</span>
<span class="fc" id="L2201">            mRevQueue.clear();</span>
        }
<span class="fc" id="L2203">    }</span>

    protected boolean _fillRev() {
<span class="fc" id="L2206">        return _fillRev(false);</span>
    }

    // Override: V1 loops over dids
    protected boolean _fillRev(boolean allowSibling) {
<span class="pc bpc" id="L2211" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16397)) {</span>
<span class="pc bpc" id="L2212" title="1 of 2 branches missed.">            if (!mRevQueue.isEmpty()) {</span>
<span class="nc" id="L2213">                return true;</span>
            }
        }
<span class="pc bpc" id="L2216" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16404)) {</span>
<span class="pc bpc" id="L2217" title="48 of 50 branches missed.">            if ((ListenerUtil.mutListener.listen(16403) ? (mHaveCounts || (ListenerUtil.mutListener.listen(16402) ? (mRevCount &gt;= 0) : (ListenerUtil.mutListener.listen(16401) ? (mRevCount &lt;= 0) : (ListenerUtil.mutListener.listen(16400) ? (mRevCount &gt; 0) : (ListenerUtil.mutListener.listen(16399) ? (mRevCount &lt; 0) : (ListenerUtil.mutListener.listen(16398) ? (mRevCount != 0) : (mRevCount == 0))))))) : (mHaveCounts &amp;&amp; (ListenerUtil.mutListener.listen(16402) ? (mRevCount &gt;= 0) : (ListenerUtil.mutListener.listen(16401) ? (mRevCount &lt;= 0) : (ListenerUtil.mutListener.listen(16400) ? (mRevCount &gt; 0) : (ListenerUtil.mutListener.listen(16399) ? (mRevCount &lt; 0) : (ListenerUtil.mutListener.listen(16398) ? (mRevCount != 0) : (mRevCount == 0))))))))) {</span>
<span class="nc" id="L2218">                return false;</span>
            }
        }
<span class="fc" id="L2221">        int lim = Math.min(mQueueLimit, _currentRevLimit(true));</span>
<span class="pc bpc" id="L2222" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16414)) {</span>
<span class="pc bpc" id="L2223" title="16 of 22 branches missed.">            if ((ListenerUtil.mutListener.listen(16409) ? (lim &gt;= 0) : (ListenerUtil.mutListener.listen(16408) ? (lim &lt;= 0) : (ListenerUtil.mutListener.listen(16407) ? (lim &gt; 0) : (ListenerUtil.mutListener.listen(16406) ? (lim &lt; 0) : (ListenerUtil.mutListener.listen(16405) ? (lim == 0) : (lim != 0))))))) {</span>
<span class="pc bpc" id="L2224" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16410)) {</span>
<span class="fc" id="L2225">                    mRevQueue.clear();</span>
                }
                // fill the queue with the current did
<span class="pc bpc" id="L2228" title="1 of 2 branches missed.">                String idName = (allowSibling) ? &quot;id&quot; : &quot;nid&quot;;</span>
<span class="pc bpc" id="L2229" title="1 of 2 branches missed.">                long id = (allowSibling) ? currentCardId() : currentCardNid();</span>
                // fill the queue with the current did
<span class="fc" id="L2231">                try (Cursor cur = mCol.getDb().query(&quot;SELECT id FROM cards WHERE did in &quot; + _deckLimit() + &quot; AND queue = &quot; + Consts.QUEUE_TYPE_REV + &quot; AND due &lt;= ? AND &quot; + idName + &quot; != ?&quot; + &quot; ORDER BY due, random()  LIMIT ?&quot;, mToday, id, lim)) {</span>
<span class="pc bpc" id="L2232" title="1 of 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(16412)) {</span>
                        {
<span class="fc" id="L2234">                            long _loopCounter318 = 0;</span>
<span class="pc bpc" id="L2235" title="1 of 2 branches missed.">                            while (cur.moveToNext()) {</span>
<span class="nc" id="L2236">                                ListenerUtil.loopListener.listen(&quot;_loopCounter318&quot;, ++_loopCounter318);</span>
<span class="nc bnc" id="L2237" title="All 2 branches missed.">                                if (!ListenerUtil.mutListener.listen(16411)) {</span>
<span class="nc" id="L2238">                                    mRevQueue.add(cur.getLong(0));</span>
                                }
                            }
                        }
                    }
                }
<span class="pc bpc" id="L2244" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16413)) {</span>
<span class="pc bpc" id="L2245" title="1 of 2 branches missed.">                    if (!mRevQueue.isEmpty()) {</span>
                        // in _getRevCard().
<span class="nc" id="L2247">                        return true;</span>
                    }
                }
            }
        }
<span class="pc bpc" id="L2252" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16422)) {</span>
<span class="pc bpc" id="L2253" title="48 of 50 branches missed.">            if ((ListenerUtil.mutListener.listen(16420) ? (mHaveCounts || (ListenerUtil.mutListener.listen(16419) ? (mRevCount &gt;= 0) : (ListenerUtil.mutListener.listen(16418) ? (mRevCount &lt;= 0) : (ListenerUtil.mutListener.listen(16417) ? (mRevCount &gt; 0) : (ListenerUtil.mutListener.listen(16416) ? (mRevCount &lt; 0) : (ListenerUtil.mutListener.listen(16415) ? (mRevCount == 0) : (mRevCount != 0))))))) : (mHaveCounts &amp;&amp; (ListenerUtil.mutListener.listen(16419) ? (mRevCount &gt;= 0) : (ListenerUtil.mutListener.listen(16418) ? (mRevCount &lt;= 0) : (ListenerUtil.mutListener.listen(16417) ? (mRevCount &gt; 0) : (ListenerUtil.mutListener.listen(16416) ? (mRevCount &lt; 0) : (ListenerUtil.mutListener.listen(16415) ? (mRevCount == 0) : (mRevCount != 0))))))))) {</span>
<span class="nc bnc" id="L2254" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16421)) {</span>
                    // removed from the queue but not buried
<span class="nc" id="L2256">                    _resetRev();</span>
                }
<span class="nc" id="L2258">                return _fillRev(true);</span>
            }
        }
<span class="fc" id="L2261">        return false;</span>
    }

    @Nullable
    protected Card _getRevCard() {
<span class="pc bpc" id="L2266" title="1 of 2 branches missed.">        if (_fillRev()) {</span>
            // mRevCount -= 1; see decrementCounts()
<span class="nc" id="L2268">            return mRevQueue.removeFirstCard();</span>
        } else {
<span class="fc" id="L2270">            return null;</span>
        }
    }

    public int totalRevForCurrentDeck() {
<span class="nc" id="L2275">        return mCol.getDb().queryScalar(&quot;SELECT count() FROM cards WHERE id IN (SELECT id FROM cards WHERE did IN &quot; + _deckLimit() + &quot;  AND queue = &quot; + Consts.QUEUE_TYPE_REV + &quot; AND due &lt;= ? LIMIT ?)&quot;, mToday, mReportLimit);</span>
    }

    // Overridden: v1 does not deal with early
    protected void _answerRevCard(@NonNull Card card, @Consts.BUTTON_TYPE int ease) {
<span class="nc" id="L2280">        int delay = 0;</span>
<span class="nc bnc" id="L2281" title="All 50 branches missed.">        boolean early = (ListenerUtil.mutListener.listen(16428) ? (card.isInDynamicDeck() || ((ListenerUtil.mutListener.listen(16427) ? (card.getODue() &gt;= mToday) : (ListenerUtil.mutListener.listen(16426) ? (card.getODue() &lt;= mToday) : (ListenerUtil.mutListener.listen(16425) ? (card.getODue() &lt; mToday) : (ListenerUtil.mutListener.listen(16424) ? (card.getODue() != mToday) : (ListenerUtil.mutListener.listen(16423) ? (card.getODue() == mToday) : (card.getODue() &gt; mToday)))))))) : (card.isInDynamicDeck() &amp;&amp; ((ListenerUtil.mutListener.listen(16427) ? (card.getODue() &gt;= mToday) : (ListenerUtil.mutListener.listen(16426) ? (card.getODue() &lt;= mToday) : (ListenerUtil.mutListener.listen(16425) ? (card.getODue() &lt; mToday) : (ListenerUtil.mutListener.listen(16424) ? (card.getODue() != mToday) : (ListenerUtil.mutListener.listen(16423) ? (card.getODue() == mToday) : (card.getODue() &gt; mToday)))))))));</span>
<span class="nc bnc" id="L2282" title="All 2 branches missed.">        int type = early ? 3 : 1;</span>
<span class="nc bnc" id="L2283" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16436)) {</span>
<span class="nc bnc" id="L2284" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(16433) ? (ease &gt;= Consts.BUTTON_ONE) : (ListenerUtil.mutListener.listen(16432) ? (ease &lt;= Consts.BUTTON_ONE) : (ListenerUtil.mutListener.listen(16431) ? (ease &gt; Consts.BUTTON_ONE) : (ListenerUtil.mutListener.listen(16430) ? (ease &lt; Consts.BUTTON_ONE) : (ListenerUtil.mutListener.listen(16429) ? (ease != Consts.BUTTON_ONE) : (ease == Consts.BUTTON_ONE))))))) {</span>
<span class="nc bnc" id="L2285" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16435)) {</span>
<span class="nc" id="L2286">                    delay = _rescheduleLapse(card);</span>
                }
            } else {
<span class="nc bnc" id="L2289" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16434)) {</span>
<span class="nc" id="L2290">                    _rescheduleRev(card, ease, early);</span>
                }
            }
        }
<span class="nc bnc" id="L2294" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16437)) {</span>
<span class="nc" id="L2295">            _logRev(card, ease, delay, type);</span>
        }
<span class="nc" id="L2297">    }</span>

    // Overriden
    protected int _rescheduleLapse(@NonNull Card card) {
<span class="nc" id="L2301">        JSONObject conf = _lapseConf(card);</span>
<span class="nc bnc" id="L2302" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16442)) {</span>
<span class="nc bnc" id="L2303" title="All 8 branches missed.">            card.setLapses((ListenerUtil.mutListener.listen(16441) ? (card.getLapses() % 1) : (ListenerUtil.mutListener.listen(16440) ? (card.getLapses() / 1) : (ListenerUtil.mutListener.listen(16439) ? (card.getLapses() * 1) : (ListenerUtil.mutListener.listen(16438) ? (card.getLapses() - 1) : (card.getLapses() + 1))))));</span>
        }
<span class="nc bnc" id="L2305" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16447)) {</span>
<span class="nc bnc" id="L2306" title="All 8 branches missed.">            card.setFactor(Math.max(1300, (ListenerUtil.mutListener.listen(16446) ? (card.getFactor() % 200) : (ListenerUtil.mutListener.listen(16445) ? (card.getFactor() / 200) : (ListenerUtil.mutListener.listen(16444) ? (card.getFactor() * 200) : (ListenerUtil.mutListener.listen(16443) ? (card.getFactor() + 200) : (card.getFactor() - 200)))))));</span>
        }
        int delay;
<span class="nc bnc" id="L2309" title="All 50 branches missed.">        boolean suspended = (ListenerUtil.mutListener.listen(16453) ? (_checkLeech(card, conf) || (ListenerUtil.mutListener.listen(16452) ? (card.getQueue() &gt;= Consts.QUEUE_TYPE_SUSPENDED) : (ListenerUtil.mutListener.listen(16451) ? (card.getQueue() &lt;= Consts.QUEUE_TYPE_SUSPENDED) : (ListenerUtil.mutListener.listen(16450) ? (card.getQueue() &gt; Consts.QUEUE_TYPE_SUSPENDED) : (ListenerUtil.mutListener.listen(16449) ? (card.getQueue() &lt; Consts.QUEUE_TYPE_SUSPENDED) : (ListenerUtil.mutListener.listen(16448) ? (card.getQueue() != Consts.QUEUE_TYPE_SUSPENDED) : (card.getQueue() == Consts.QUEUE_TYPE_SUSPENDED))))))) : (_checkLeech(card, conf) &amp;&amp; (ListenerUtil.mutListener.listen(16452) ? (card.getQueue() &gt;= Consts.QUEUE_TYPE_SUSPENDED) : (ListenerUtil.mutListener.listen(16451) ? (card.getQueue() &lt;= Consts.QUEUE_TYPE_SUSPENDED) : (ListenerUtil.mutListener.listen(16450) ? (card.getQueue() &gt; Consts.QUEUE_TYPE_SUSPENDED) : (ListenerUtil.mutListener.listen(16449) ? (card.getQueue() &lt; Consts.QUEUE_TYPE_SUSPENDED) : (ListenerUtil.mutListener.listen(16448) ? (card.getQueue() != Consts.QUEUE_TYPE_SUSPENDED) : (card.getQueue() == Consts.QUEUE_TYPE_SUSPENDED))))))));</span>
<span class="nc bnc" id="L2310" title="All 10 branches missed.">        if ((ListenerUtil.mutListener.listen(16454) ? (conf.getJSONArray(&quot;delays&quot;).length() != 0 || !suspended) : (conf.getJSONArray(&quot;delays&quot;).length() != 0 &amp;&amp; !suspended))) {</span>
<span class="nc bnc" id="L2311" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(16459)) {</span>
<span class="nc" id="L2312">                card.setType(Consts.CARD_TYPE_RELEARNING);</span>
            }
<span class="nc" id="L2314">            delay = _moveToFirstStep(card, conf);</span>
        } else {
<span class="nc bnc" id="L2316" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(16455)) {</span>
                // no relearning steps
<span class="nc" id="L2318">                _updateRevIvlOnFail(card, conf);</span>
            }
<span class="nc bnc" id="L2320" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(16456)) {</span>
<span class="nc" id="L2321">                _rescheduleAsRev(card, conf, false);</span>
            }
<span class="nc bnc" id="L2323" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(16458)) {</span>
                // need to reset the queue after rescheduling
<span class="nc bnc" id="L2325" title="All 2 branches missed.">                if (suspended) {</span>
<span class="nc bnc" id="L2326" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(16457)) {</span>
<span class="nc" id="L2327">                        card.setQueue(Consts.QUEUE_TYPE_SUSPENDED);</span>
                    }
                }
            }
<span class="nc" id="L2331">            delay = 0;</span>
        }
<span class="nc" id="L2333">        return delay;</span>
    }

    private int _lapseIvl(@NonNull Card card, @NonNull JSONObject conf) {
<span class="nc bnc" id="L2337" title="All 8 branches missed.">        return Math.max(1, Math.max(conf.getInt(&quot;minInt&quot;), (int) ((ListenerUtil.mutListener.listen(16463) ? (card.getIvl() % conf.getDouble(&quot;mult&quot;)) : (ListenerUtil.mutListener.listen(16462) ? (card.getIvl() / conf.getDouble(&quot;mult&quot;)) : (ListenerUtil.mutListener.listen(16461) ? (card.getIvl() - conf.getDouble(&quot;mult&quot;)) : (ListenerUtil.mutListener.listen(16460) ? (card.getIvl() + conf.getDouble(&quot;mult&quot;)) : (card.getIvl() * conf.getDouble(&quot;mult&quot;)))))))));</span>
    }

    protected void _rescheduleRev(@NonNull Card card, @Consts.BUTTON_TYPE int ease, boolean early) {
<span class="nc bnc" id="L2341" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16464)) {</span>
            // update interval
<span class="nc" id="L2343">            card.setLastIvl(card.getIvl());</span>
        }
<span class="nc bnc" id="L2345" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16467)) {</span>
<span class="nc bnc" id="L2346" title="All 2 branches missed.">            if (early) {</span>
<span class="nc bnc" id="L2347" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16466)) {</span>
<span class="nc" id="L2348">                    _updateEarlyRevIvl(card, ease);</span>
                }
            } else {
<span class="nc bnc" id="L2351" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16465)) {</span>
<span class="nc" id="L2352">                    _updateRevIvl(card, ease);</span>
                }
            }
        }
<span class="nc bnc" id="L2356" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16476)) {</span>
            // then the rest
<span class="nc bnc" id="L2358" title="All 48 branches missed.">            card.setFactor(Math.max(1300, (ListenerUtil.mutListener.listen(16475) ? (card.getFactor() % FACTOR_ADDITION_VALUES[(ListenerUtil.mutListener.listen(16471) ? (ease % 2) : (ListenerUtil.mutListener.listen(16470) ? (ease / 2) : (ListenerUtil.mutListener.listen(16469) ? (ease * 2) : (ListenerUtil.mutListener.listen(16468) ? (ease + 2) : (ease - 2)))))]) : (ListenerUtil.mutListener.listen(16474) ? (card.getFactor() / FACTOR_ADDITION_VALUES[(ListenerUtil.mutListener.listen(16471) ? (ease % 2) : (ListenerUtil.mutListener.listen(16470) ? (ease / 2) : (ListenerUtil.mutListener.listen(16469) ? (ease * 2) : (ListenerUtil.mutListener.listen(16468) ? (ease + 2) : (ease - 2)))))]) : (ListenerUtil.mutListener.listen(16473) ? (card.getFactor() * FACTOR_ADDITION_VALUES[(ListenerUtil.mutListener.listen(16471) ? (ease % 2) : (ListenerUtil.mutListener.listen(16470) ? (ease / 2) : (ListenerUtil.mutListener.listen(16469) ? (ease * 2) : (ListenerUtil.mutListener.listen(16468) ? (ease + 2) : (ease - 2)))))]) : (ListenerUtil.mutListener.listen(16472) ? (card.getFactor() - FACTOR_ADDITION_VALUES[(ListenerUtil.mutListener.listen(16471) ? (ease % 2) : (ListenerUtil.mutListener.listen(16470) ? (ease / 2) : (ListenerUtil.mutListener.listen(16469) ? (ease * 2) : (ListenerUtil.mutListener.listen(16468) ? (ease + 2) : (ease - 2)))))]) : (card.getFactor() + FACTOR_ADDITION_VALUES[(ListenerUtil.mutListener.listen(16471) ? (ease % 2) : (ListenerUtil.mutListener.listen(16470) ? (ease / 2) : (ListenerUtil.mutListener.listen(16469) ? (ease * 2) : (ListenerUtil.mutListener.listen(16468) ? (ease + 2) : (ease - 2)))))])))))));</span>
        }
<span class="nc bnc" id="L2360" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16481)) {</span>
<span class="nc bnc" id="L2361" title="All 8 branches missed.">            card.setDue((ListenerUtil.mutListener.listen(16480) ? (mToday % card.getIvl()) : (ListenerUtil.mutListener.listen(16479) ? (mToday / card.getIvl()) : (ListenerUtil.mutListener.listen(16478) ? (mToday * card.getIvl()) : (ListenerUtil.mutListener.listen(16477) ? (mToday - card.getIvl()) : (mToday + card.getIvl()))))));</span>
        }
<span class="nc bnc" id="L2363" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16482)) {</span>
            // card leaves filtered deck
<span class="nc" id="L2365">            _removeFromFiltered(card);</span>
        }
<span class="nc" id="L2367">    }</span>

    protected void _logRev(@NonNull Card card, @Consts.BUTTON_TYPE int ease, int delay, int type) {
<span class="nc bnc" id="L2370" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16488)) {</span>
<span class="nc bnc" id="L2371" title="All 22 branches missed.">            log(card.getId(), mCol.usn(), ease, (((ListenerUtil.mutListener.listen(16487) ? (delay &gt;= 0) : (ListenerUtil.mutListener.listen(16486) ? (delay &lt;= 0) : (ListenerUtil.mutListener.listen(16485) ? (delay &gt; 0) : (ListenerUtil.mutListener.listen(16484) ? (delay &lt; 0) : (ListenerUtil.mutListener.listen(16483) ? (delay == 0) : (delay != 0))))))) ? (-delay) : card.getIvl()), card.getLastIvl(), card.getFactor(), card.timeTaken(), type);</span>
        }
<span class="nc" id="L2373">    }</span>

    /**
     * Next interval for CARD, given EASE.
     */
    protected int _nextRevIvl(@NonNull Card card, @Consts.BUTTON_TYPE int ease, boolean fuzz) {
<span class="nc" id="L2379">        long delay = _daysLate(card);</span>
<span class="nc" id="L2380">        JSONObject conf = _revConf(card);</span>
<span class="nc bnc" id="L2381" title="All 8 branches missed.">        double fct = (ListenerUtil.mutListener.listen(16492) ? (card.getFactor() % 1000.0) : (ListenerUtil.mutListener.listen(16491) ? (card.getFactor() * 1000.0) : (ListenerUtil.mutListener.listen(16490) ? (card.getFactor() - 1000.0) : (ListenerUtil.mutListener.listen(16489) ? (card.getFactor() + 1000.0) : (card.getFactor() / 1000.0)))));</span>
<span class="nc" id="L2382">        double hardFactor = conf.optDouble(&quot;hardFactor&quot;, 1.2);</span>
        int hardMin;
<span class="nc bnc" id="L2384" title="All 22 branches missed.">        if ((ListenerUtil.mutListener.listen(16497) ? (hardFactor &gt;= 1) : (ListenerUtil.mutListener.listen(16496) ? (hardFactor &lt;= 1) : (ListenerUtil.mutListener.listen(16495) ? (hardFactor &lt; 1) : (ListenerUtil.mutListener.listen(16494) ? (hardFactor != 1) : (ListenerUtil.mutListener.listen(16493) ? (hardFactor == 1) : (hardFactor &gt; 1))))))) {</span>
<span class="nc" id="L2385">            hardMin = card.getIvl();</span>
        } else {
<span class="nc" id="L2387">            hardMin = 0;</span>
        }
<span class="nc bnc" id="L2389" title="All 8 branches missed.">        int ivl2 = _constrainedIvl((ListenerUtil.mutListener.listen(16501) ? (card.getIvl() % hardFactor) : (ListenerUtil.mutListener.listen(16500) ? (card.getIvl() / hardFactor) : (ListenerUtil.mutListener.listen(16499) ? (card.getIvl() - hardFactor) : (ListenerUtil.mutListener.listen(16498) ? (card.getIvl() + hardFactor) : (card.getIvl() * hardFactor))))), conf, hardMin, fuzz);</span>
<span class="nc bnc" id="L2390" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16507)) {</span>
<span class="nc bnc" id="L2391" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(16506) ? (ease &gt;= Consts.BUTTON_TWO) : (ListenerUtil.mutListener.listen(16505) ? (ease &lt;= Consts.BUTTON_TWO) : (ListenerUtil.mutListener.listen(16504) ? (ease &gt; Consts.BUTTON_TWO) : (ListenerUtil.mutListener.listen(16503) ? (ease &lt; Consts.BUTTON_TWO) : (ListenerUtil.mutListener.listen(16502) ? (ease != Consts.BUTTON_TWO) : (ease == Consts.BUTTON_TWO))))))) {</span>
<span class="nc" id="L2392">                return ivl2;</span>
            }
        }
<span class="nc bnc" id="L2395" title="All 248 branches missed.">        int ivl3 = _constrainedIvl((ListenerUtil.mutListener.listen(16519) ? (((ListenerUtil.mutListener.listen(16515) ? (card.getIvl() % (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2)))))) : (ListenerUtil.mutListener.listen(16514) ? (card.getIvl() / (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2)))))) : (ListenerUtil.mutListener.listen(16513) ? (card.getIvl() * (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2)))))) : (ListenerUtil.mutListener.listen(16512) ? (card.getIvl() - (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2)))))) : (card.getIvl() + (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2))))))))))) % fct) : (ListenerUtil.mutListener.listen(16518) ? (((ListenerUtil.mutListener.listen(16515) ? (card.getIvl() % (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2)))))) : (ListenerUtil.mutListener.listen(16514) ? (card.getIvl() / (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2)))))) : (ListenerUtil.mutListener.listen(16513) ? (card.getIvl() * (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2)))))) : (ListenerUtil.mutListener.listen(16512) ? (card.getIvl() - (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2)))))) : (card.getIvl() + (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2))))))))))) / fct) : (ListenerUtil.mutListener.listen(16517) ? (((ListenerUtil.mutListener.listen(16515) ? (card.getIvl() % (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2)))))) : (ListenerUtil.mutListener.listen(16514) ? (card.getIvl() / (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2)))))) : (ListenerUtil.mutListener.listen(16513) ? (card.getIvl() * (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2)))))) : (ListenerUtil.mutListener.listen(16512) ? (card.getIvl() - (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2)))))) : (card.getIvl() + (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2))))))))))) - fct) : (ListenerUtil.mutListener.listen(16516) ? (((ListenerUtil.mutListener.listen(16515) ? (card.getIvl() % (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2)))))) : (ListenerUtil.mutListener.listen(16514) ? (card.getIvl() / (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2)))))) : (ListenerUtil.mutListener.listen(16513) ? (card.getIvl() * (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2)))))) : (ListenerUtil.mutListener.listen(16512) ? (card.getIvl() - (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2)))))) : (card.getIvl() + (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2))))))))))) + fct) : (((ListenerUtil.mutListener.listen(16515) ? (card.getIvl() % (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2)))))) : (ListenerUtil.mutListener.listen(16514) ? (card.getIvl() / (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2)))))) : (ListenerUtil.mutListener.listen(16513) ? (card.getIvl() * (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2)))))) : (ListenerUtil.mutListener.listen(16512) ? (card.getIvl() - (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2)))))) : (card.getIvl() + (ListenerUtil.mutListener.listen(16511) ? (delay % 2) : (ListenerUtil.mutListener.listen(16510) ? (delay * 2) : (ListenerUtil.mutListener.listen(16509) ? (delay - 2) : (ListenerUtil.mutListener.listen(16508) ? (delay + 2) : (delay / 2))))))))))) * fct))))), conf, ivl2, fuzz);</span>
<span class="nc bnc" id="L2396" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16525)) {</span>
<span class="nc bnc" id="L2397" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(16524) ? (ease &gt;= Consts.BUTTON_THREE) : (ListenerUtil.mutListener.listen(16523) ? (ease &lt;= Consts.BUTTON_THREE) : (ListenerUtil.mutListener.listen(16522) ? (ease &gt; Consts.BUTTON_THREE) : (ListenerUtil.mutListener.listen(16521) ? (ease &lt; Consts.BUTTON_THREE) : (ListenerUtil.mutListener.listen(16520) ? (ease != Consts.BUTTON_THREE) : (ease == Consts.BUTTON_THREE))))))) {</span>
<span class="nc" id="L2398">                return ivl3;</span>
            }
        }
<span class="nc bnc" id="L2401" title="All 248 branches missed.">        return _constrainedIvl(((ListenerUtil.mutListener.listen(16537) ? ((ListenerUtil.mutListener.listen(16533) ? (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) % fct) : (ListenerUtil.mutListener.listen(16532) ? (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) / fct) : (ListenerUtil.mutListener.listen(16531) ? (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) - fct) : (ListenerUtil.mutListener.listen(16530) ? (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) + fct) : (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) * fct))))) % conf.getDouble(&quot;ease4&quot;)) : (ListenerUtil.mutListener.listen(16536) ? ((ListenerUtil.mutListener.listen(16533) ? (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) % fct) : (ListenerUtil.mutListener.listen(16532) ? (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) / fct) : (ListenerUtil.mutListener.listen(16531) ? (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) - fct) : (ListenerUtil.mutListener.listen(16530) ? (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) + fct) : (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) * fct))))) / conf.getDouble(&quot;ease4&quot;)) : (ListenerUtil.mutListener.listen(16535) ? ((ListenerUtil.mutListener.listen(16533) ? (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) % fct) : (ListenerUtil.mutListener.listen(16532) ? (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) / fct) : (ListenerUtil.mutListener.listen(16531) ? (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) - fct) : (ListenerUtil.mutListener.listen(16530) ? (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) + fct) : (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) * fct))))) - conf.getDouble(&quot;ease4&quot;)) : (ListenerUtil.mutListener.listen(16534) ? ((ListenerUtil.mutListener.listen(16533) ? (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) % fct) : (ListenerUtil.mutListener.listen(16532) ? (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) / fct) : (ListenerUtil.mutListener.listen(16531) ? (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) - fct) : (ListenerUtil.mutListener.listen(16530) ? (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) + fct) : (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) * fct))))) + conf.getDouble(&quot;ease4&quot;)) : ((ListenerUtil.mutListener.listen(16533) ? (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) % fct) : (ListenerUtil.mutListener.listen(16532) ? (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) / fct) : (ListenerUtil.mutListener.listen(16531) ? (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) - fct) : (ListenerUtil.mutListener.listen(16530) ? (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) + fct) : (((ListenerUtil.mutListener.listen(16529) ? (card.getIvl() % delay) : (ListenerUtil.mutListener.listen(16528) ? (card.getIvl() / delay) : (ListenerUtil.mutListener.listen(16527) ? (card.getIvl() * delay) : (ListenerUtil.mutListener.listen(16526) ? (card.getIvl() - delay) : (card.getIvl() + delay)))))) * fct))))) * conf.getDouble(&quot;ease4&quot;))))))), conf, ivl3, fuzz);</span>
    }

    public int _fuzzedIvl(int ivl) {
<span class="nc" id="L2405">        Pair&lt;Integer, Integer&gt; minMax = _fuzzIvlRange(ivl);</span>
        // returns x in [0, b-a), hence the +1 diff with libanki
<span class="nc bnc" id="L2407" title="All 8 branches missed.">        return (new Random().nextInt((ListenerUtil.mutListener.listen(16541) ? (minMax.second % minMax.first) : (ListenerUtil.mutListener.listen(16540) ? (minMax.second / minMax.first) : (ListenerUtil.mutListener.listen(16539) ? (minMax.second * minMax.first) : (ListenerUtil.mutListener.listen(16538) ? (minMax.second + minMax.first) : (minMax.second - minMax.first))))) + 1)) + minMax.first;</span>
    }

    @NonNull
    public Pair&lt;Integer, Integer&gt; _fuzzIvlRange(int ivl) {
        int fuzz;
<span class="nc bnc" id="L2413" title="All 22 branches missed.">        if ((ListenerUtil.mutListener.listen(16546) ? (ivl &gt;= 2) : (ListenerUtil.mutListener.listen(16545) ? (ivl &lt;= 2) : (ListenerUtil.mutListener.listen(16544) ? (ivl &gt; 2) : (ListenerUtil.mutListener.listen(16543) ? (ivl != 2) : (ListenerUtil.mutListener.listen(16542) ? (ivl == 2) : (ivl &lt; 2))))))) {</span>
<span class="nc" id="L2414">            return new Pair&lt;&gt;(1, 1);</span>
<span class="nc bnc" id="L2415" title="All 22 branches missed.">        } else if ((ListenerUtil.mutListener.listen(16551) ? (ivl &gt;= 2) : (ListenerUtil.mutListener.listen(16550) ? (ivl &lt;= 2) : (ListenerUtil.mutListener.listen(16549) ? (ivl &gt; 2) : (ListenerUtil.mutListener.listen(16548) ? (ivl &lt; 2) : (ListenerUtil.mutListener.listen(16547) ? (ivl != 2) : (ivl == 2))))))) {</span>
<span class="nc" id="L2416">            return new Pair&lt;&gt;(2, 3);</span>
<span class="nc bnc" id="L2417" title="All 22 branches missed.">        } else if ((ListenerUtil.mutListener.listen(16556) ? (ivl &gt;= 7) : (ListenerUtil.mutListener.listen(16555) ? (ivl &lt;= 7) : (ListenerUtil.mutListener.listen(16554) ? (ivl &gt; 7) : (ListenerUtil.mutListener.listen(16553) ? (ivl != 7) : (ListenerUtil.mutListener.listen(16552) ? (ivl == 7) : (ivl &lt; 7))))))) {</span>
<span class="nc bnc" id="L2418" title="All 8 branches missed.">            fuzz = (int) ((ListenerUtil.mutListener.listen(16573) ? (ivl % 0.25) : (ListenerUtil.mutListener.listen(16572) ? (ivl / 0.25) : (ListenerUtil.mutListener.listen(16571) ? (ivl - 0.25) : (ListenerUtil.mutListener.listen(16570) ? (ivl + 0.25) : (ivl * 0.25))))));</span>
<span class="nc bnc" id="L2419" title="All 22 branches missed.">        } else if ((ListenerUtil.mutListener.listen(16561) ? (ivl &gt;= 30) : (ListenerUtil.mutListener.listen(16560) ? (ivl &lt;= 30) : (ListenerUtil.mutListener.listen(16559) ? (ivl &gt; 30) : (ListenerUtil.mutListener.listen(16558) ? (ivl != 30) : (ListenerUtil.mutListener.listen(16557) ? (ivl == 30) : (ivl &lt; 30))))))) {</span>
<span class="nc bnc" id="L2420" title="All 8 branches missed.">            fuzz = Math.max(2, (int) ((ListenerUtil.mutListener.listen(16569) ? (ivl % 0.15) : (ListenerUtil.mutListener.listen(16568) ? (ivl / 0.15) : (ListenerUtil.mutListener.listen(16567) ? (ivl - 0.15) : (ListenerUtil.mutListener.listen(16566) ? (ivl + 0.15) : (ivl * 0.15)))))));</span>
        } else {
<span class="nc bnc" id="L2422" title="All 8 branches missed.">            fuzz = Math.max(4, (int) ((ListenerUtil.mutListener.listen(16565) ? (ivl % 0.05) : (ListenerUtil.mutListener.listen(16564) ? (ivl / 0.05) : (ListenerUtil.mutListener.listen(16563) ? (ivl - 0.05) : (ListenerUtil.mutListener.listen(16562) ? (ivl + 0.05) : (ivl * 0.05)))))));</span>
        }
        // fuzz at least a day
<span class="nc" id="L2425">        fuzz = Math.max(fuzz, 1);</span>
<span class="nc bnc" id="L2426" title="All 16 branches missed.">        return new Pair&lt;&gt;((ListenerUtil.mutListener.listen(16577) ? (ivl % fuzz) : (ListenerUtil.mutListener.listen(16576) ? (ivl / fuzz) : (ListenerUtil.mutListener.listen(16575) ? (ivl * fuzz) : (ListenerUtil.mutListener.listen(16574) ? (ivl + fuzz) : (ivl - fuzz))))), (ListenerUtil.mutListener.listen(16581) ? (ivl % fuzz) : (ListenerUtil.mutListener.listen(16580) ? (ivl / fuzz) : (ListenerUtil.mutListener.listen(16579) ? (ivl * fuzz) : (ListenerUtil.mutListener.listen(16578) ? (ivl - fuzz) : (ivl + fuzz))))));</span>
    }

    protected int _constrainedIvl(double ivl, @NonNull JSONObject conf, double prev, boolean fuzz) {
<span class="nc bnc" id="L2430" title="All 8 branches missed.">        int newIvl = (int) ((ListenerUtil.mutListener.listen(16585) ? (ivl % conf.optDouble(&quot;ivlFct&quot;, 1)) : (ListenerUtil.mutListener.listen(16584) ? (ivl / conf.optDouble(&quot;ivlFct&quot;, 1)) : (ListenerUtil.mutListener.listen(16583) ? (ivl - conf.optDouble(&quot;ivlFct&quot;, 1)) : (ListenerUtil.mutListener.listen(16582) ? (ivl + conf.optDouble(&quot;ivlFct&quot;, 1)) : (ivl * conf.optDouble(&quot;ivlFct&quot;, 1)))))));</span>
<span class="nc bnc" id="L2431" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16587)) {</span>
<span class="nc bnc" id="L2432" title="All 2 branches missed.">            if (fuzz) {</span>
<span class="nc bnc" id="L2433" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16586)) {</span>
<span class="nc" id="L2434">                    newIvl = _fuzzedIvl(newIvl);</span>
                }
            }
        }
<span class="nc bnc" id="L2438" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16592)) {</span>
<span class="nc bnc" id="L2439" title="All 8 branches missed.">            newIvl = (int) Math.max(Math.max(newIvl, (ListenerUtil.mutListener.listen(16591) ? (prev % 1) : (ListenerUtil.mutListener.listen(16590) ? (prev / 1) : (ListenerUtil.mutListener.listen(16589) ? (prev * 1) : (ListenerUtil.mutListener.listen(16588) ? (prev - 1) : (prev + 1)))))), 1);</span>
        }
<span class="nc bnc" id="L2441" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16593)) {</span>
<span class="nc" id="L2442">            newIvl = Math.min(newIvl, conf.getInt(&quot;maxIvl&quot;));</span>
        }
<span class="nc" id="L2444">        return newIvl;</span>
    }

    /**
     * Number of days later than scheduled.
     */
    protected long _daysLate(Card card) {
<span class="nc bnc" id="L2451" title="All 2 branches missed.">        long due = card.isInDynamicDeck() ? card.getODue() : card.getDue();</span>
<span class="nc bnc" id="L2452" title="All 8 branches missed.">        return Math.max(0, (ListenerUtil.mutListener.listen(16597) ? (mToday % due) : (ListenerUtil.mutListener.listen(16596) ? (mToday / due) : (ListenerUtil.mutListener.listen(16595) ? (mToday * due) : (ListenerUtil.mutListener.listen(16594) ? (mToday + due) : (mToday - due))))));</span>
    }

    // Overriden
    protected void _updateRevIvl(@NonNull Card card, @Consts.BUTTON_TYPE int ease) {
<span class="nc bnc" id="L2457" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16598)) {</span>
<span class="nc" id="L2458">            card.setIvl(_nextRevIvl(card, ease, true));</span>
        }
<span class="nc" id="L2460">    }</span>

    private void _updateEarlyRevIvl(@NonNull Card card, @Consts.BUTTON_TYPE int ease) {
<span class="nc bnc" id="L2463" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16599)) {</span>
<span class="nc" id="L2464">            card.setIvl(_earlyReviewIvl(card, ease));</span>
        }
<span class="nc" id="L2466">    }</span>

    /**
     * next interval for card when answered early+correctly
     */
    private int _earlyReviewIvl(@NonNull Card card, @Consts.BUTTON_TYPE int ease) {
<span class="nc bnc" id="L2472" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16612)) {</span>
<span class="nc bnc" id="L2473" title="All 146 branches missed.">            if ((ListenerUtil.mutListener.listen(16611) ? ((ListenerUtil.mutListener.listen(16605) ? (!card.isInDynamicDeck() &amp;&amp; (ListenerUtil.mutListener.listen(16604) ? (card.getType() &gt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16603) ? (card.getType() &lt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16602) ? (card.getType() &gt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16601) ? (card.getType() &lt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16600) ? (card.getType() == Consts.CARD_TYPE_REV) : (card.getType() != Consts.CARD_TYPE_REV))))))) : (!card.isInDynamicDeck() || (ListenerUtil.mutListener.listen(16604) ? (card.getType() &gt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16603) ? (card.getType() &lt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16602) ? (card.getType() &gt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16601) ? (card.getType() &lt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16600) ? (card.getType() == Consts.CARD_TYPE_REV) : (card.getType() != Consts.CARD_TYPE_REV)))))))) &amp;&amp; (ListenerUtil.mutListener.listen(16610) ? (card.getFactor() &gt;= 0) : (ListenerUtil.mutListener.listen(16609) ? (card.getFactor() &lt;= 0) : (ListenerUtil.mutListener.listen(16608) ? (card.getFactor() &gt; 0) : (ListenerUtil.mutListener.listen(16607) ? (card.getFactor() &lt; 0) : (ListenerUtil.mutListener.listen(16606) ? (card.getFactor() != 0) : (card.getFactor() == 0))))))) : ((ListenerUtil.mutListener.listen(16605) ? (!card.isInDynamicDeck() &amp;&amp; (ListenerUtil.mutListener.listen(16604) ? (card.getType() &gt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16603) ? (card.getType() &lt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16602) ? (card.getType() &gt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16601) ? (card.getType() &lt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16600) ? (card.getType() == Consts.CARD_TYPE_REV) : (card.getType() != Consts.CARD_TYPE_REV))))))) : (!card.isInDynamicDeck() || (ListenerUtil.mutListener.listen(16604) ? (card.getType() &gt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16603) ? (card.getType() &lt;= Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16602) ? (card.getType() &gt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16601) ? (card.getType() &lt; Consts.CARD_TYPE_REV) : (ListenerUtil.mutListener.listen(16600) ? (card.getType() == Consts.CARD_TYPE_REV) : (card.getType() != Consts.CARD_TYPE_REV)))))))) || (ListenerUtil.mutListener.listen(16610) ? (card.getFactor() &gt;= 0) : (ListenerUtil.mutListener.listen(16609) ? (card.getFactor() &lt;= 0) : (ListenerUtil.mutListener.listen(16608) ? (card.getFactor() &gt; 0) : (ListenerUtil.mutListener.listen(16607) ? (card.getFactor() &lt; 0) : (ListenerUtil.mutListener.listen(16606) ? (card.getFactor() != 0) : (card.getFactor() == 0))))))))) {</span>
<span class="nc" id="L2474">                throw new RuntimeException(&quot;Unexpected card parameters&quot;);</span>
            }
        }
<span class="nc bnc" id="L2477" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16618)) {</span>
<span class="nc bnc" id="L2478" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(16617) ? (ease &gt;= 1) : (ListenerUtil.mutListener.listen(16616) ? (ease &gt; 1) : (ListenerUtil.mutListener.listen(16615) ? (ease &lt; 1) : (ListenerUtil.mutListener.listen(16614) ? (ease != 1) : (ListenerUtil.mutListener.listen(16613) ? (ease == 1) : (ease &lt;= 1))))))) {</span>
<span class="nc" id="L2479">                throw new RuntimeException(&quot;Ease must be greater than 1&quot;);</span>
            }
        }
<span class="nc bnc" id="L2482" title="All 48 branches missed.">        long elapsed = (ListenerUtil.mutListener.listen(16626) ? (card.getIvl() % ((ListenerUtil.mutListener.listen(16622) ? (card.getODue() % mToday) : (ListenerUtil.mutListener.listen(16621) ? (card.getODue() / mToday) : (ListenerUtil.mutListener.listen(16620) ? (card.getODue() * mToday) : (ListenerUtil.mutListener.listen(16619) ? (card.getODue() + mToday) : (card.getODue() - mToday))))))) : (ListenerUtil.mutListener.listen(16625) ? (card.getIvl() / ((ListenerUtil.mutListener.listen(16622) ? (card.getODue() % mToday) : (ListenerUtil.mutListener.listen(16621) ? (card.getODue() / mToday) : (ListenerUtil.mutListener.listen(16620) ? (card.getODue() * mToday) : (ListenerUtil.mutListener.listen(16619) ? (card.getODue() + mToday) : (card.getODue() - mToday))))))) : (ListenerUtil.mutListener.listen(16624) ? (card.getIvl() * ((ListenerUtil.mutListener.listen(16622) ? (card.getODue() % mToday) : (ListenerUtil.mutListener.listen(16621) ? (card.getODue() / mToday) : (ListenerUtil.mutListener.listen(16620) ? (card.getODue() * mToday) : (ListenerUtil.mutListener.listen(16619) ? (card.getODue() + mToday) : (card.getODue() - mToday))))))) : (ListenerUtil.mutListener.listen(16623) ? (card.getIvl() + ((ListenerUtil.mutListener.listen(16622) ? (card.getODue() % mToday) : (ListenerUtil.mutListener.listen(16621) ? (card.getODue() / mToday) : (ListenerUtil.mutListener.listen(16620) ? (card.getODue() * mToday) : (ListenerUtil.mutListener.listen(16619) ? (card.getODue() + mToday) : (card.getODue() - mToday))))))) : (card.getIvl() - ((ListenerUtil.mutListener.listen(16622) ? (card.getODue() % mToday) : (ListenerUtil.mutListener.listen(16621) ? (card.getODue() / mToday) : (ListenerUtil.mutListener.listen(16620) ? (card.getODue() * mToday) : (ListenerUtil.mutListener.listen(16619) ? (card.getODue() + mToday) : (card.getODue() - mToday)))))))))));</span>
        @NonNull
<span class="nc" id="L2484">        JSONObject conf = _revConf(card);</span>
<span class="nc" id="L2485">        double easyBonus = 1;</span>
        // early 3/4 reviews shouldn't decrease previous interval
<span class="nc" id="L2487">        double minNewIvl = 1;</span>
        double factor;
<span class="nc bnc" id="L2489" title="All 22 branches missed.">        if ((ListenerUtil.mutListener.listen(16631) ? (ease &gt;= Consts.BUTTON_TWO) : (ListenerUtil.mutListener.listen(16630) ? (ease &lt;= Consts.BUTTON_TWO) : (ListenerUtil.mutListener.listen(16629) ? (ease &gt; Consts.BUTTON_TWO) : (ListenerUtil.mutListener.listen(16628) ? (ease &lt; Consts.BUTTON_TWO) : (ListenerUtil.mutListener.listen(16627) ? (ease != Consts.BUTTON_TWO) : (ease == Consts.BUTTON_TWO))))))) {</span>
<span class="nc" id="L2490">            factor = conf.optDouble(&quot;hardFactor&quot;, 1.2);</span>
<span class="nc bnc" id="L2491" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(16662)) {</span>
                // of the normal factor
<span class="nc bnc" id="L2493" title="All 8 branches missed.">                minNewIvl = (ListenerUtil.mutListener.listen(16661) ? (factor % 2) : (ListenerUtil.mutListener.listen(16660) ? (factor * 2) : (ListenerUtil.mutListener.listen(16659) ? (factor - 2) : (ListenerUtil.mutListener.listen(16658) ? (factor + 2) : (factor / 2)))));</span>
            }
<span class="nc bnc" id="L2495" title="All 22 branches missed.">        } else if ((ListenerUtil.mutListener.listen(16636) ? (ease &gt;= 3) : (ListenerUtil.mutListener.listen(16635) ? (ease &lt;= 3) : (ListenerUtil.mutListener.listen(16634) ? (ease &gt; 3) : (ListenerUtil.mutListener.listen(16633) ? (ease &lt; 3) : (ListenerUtil.mutListener.listen(16632) ? (ease != 3) : (ease == 3))))))) {</span>
<span class="nc bnc" id="L2496" title="All 8 branches missed.">            factor = (ListenerUtil.mutListener.listen(16657) ? (card.getFactor() % 1000.0) : (ListenerUtil.mutListener.listen(16656) ? (card.getFactor() * 1000.0) : (ListenerUtil.mutListener.listen(16655) ? (card.getFactor() - 1000.0) : (ListenerUtil.mutListener.listen(16654) ? (card.getFactor() + 1000.0) : (card.getFactor() / 1000.0)))));</span>
        } else {
            // ease == 4
<span class="nc bnc" id="L2499" title="All 8 branches missed.">            factor = (ListenerUtil.mutListener.listen(16640) ? (card.getFactor() % 1000.0) : (ListenerUtil.mutListener.listen(16639) ? (card.getFactor() * 1000.0) : (ListenerUtil.mutListener.listen(16638) ? (card.getFactor() - 1000.0) : (ListenerUtil.mutListener.listen(16637) ? (card.getFactor() + 1000.0) : (card.getFactor() / 1000.0)))));</span>
<span class="nc" id="L2500">            double ease4 = conf.getDouble(&quot;ease4&quot;);</span>
<span class="nc bnc" id="L2501" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(16653)) {</span>
                // 1.3 -&gt; 1.15
<span class="nc bnc" id="L2503" title="All 248 branches missed.">                easyBonus = (ListenerUtil.mutListener.listen(16652) ? (ease4 % (ListenerUtil.mutListener.listen(16648) ? (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) % 2) : (ListenerUtil.mutListener.listen(16647) ? (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) * 2) : (ListenerUtil.mutListener.listen(16646) ? (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) - 2) : (ListenerUtil.mutListener.listen(16645) ? (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) + 2) : (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) / 2)))))) : (ListenerUtil.mutListener.listen(16651) ? (ease4 / (ListenerUtil.mutListener.listen(16648) ? (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) % 2) : (ListenerUtil.mutListener.listen(16647) ? (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) * 2) : (ListenerUtil.mutListener.listen(16646) ? (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) - 2) : (ListenerUtil.mutListener.listen(16645) ? (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) + 2) : (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) / 2)))))) : (ListenerUtil.mutListener.listen(16650) ? (ease4 * (ListenerUtil.mutListener.listen(16648) ? (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) % 2) : (ListenerUtil.mutListener.listen(16647) ? (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) * 2) : (ListenerUtil.mutListener.listen(16646) ? (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) - 2) : (ListenerUtil.mutListener.listen(16645) ? (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) + 2) : (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) / 2)))))) : (ListenerUtil.mutListener.listen(16649) ? (ease4 + (ListenerUtil.mutListener.listen(16648) ? (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) % 2) : (ListenerUtil.mutListener.listen(16647) ? (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) * 2) : (ListenerUtil.mutListener.listen(16646) ? (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) - 2) : (ListenerUtil.mutListener.listen(16645) ? (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) + 2) : (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) / 2)))))) : (ease4 - (ListenerUtil.mutListener.listen(16648) ? (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) % 2) : (ListenerUtil.mutListener.listen(16647) ? (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) * 2) : (ListenerUtil.mutListener.listen(16646) ? (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) - 2) : (ListenerUtil.mutListener.listen(16645) ? (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) + 2) : (((ListenerUtil.mutListener.listen(16644) ? (ease4 % 1) : (ListenerUtil.mutListener.listen(16643) ? (ease4 / 1) : (ListenerUtil.mutListener.listen(16642) ? (ease4 * 1) : (ListenerUtil.mutListener.listen(16641) ? (ease4 + 1) : (ease4 - 1)))))) / 2))))))))));</span>
            }
        }
<span class="nc bnc" id="L2506" title="All 8 branches missed.">        double ivl = Math.max((ListenerUtil.mutListener.listen(16666) ? (elapsed % factor) : (ListenerUtil.mutListener.listen(16665) ? (elapsed / factor) : (ListenerUtil.mutListener.listen(16664) ? (elapsed - factor) : (ListenerUtil.mutListener.listen(16663) ? (elapsed + factor) : (elapsed * factor))))), 1);</span>
<span class="nc bnc" id="L2507" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16675)) {</span>
            // cap interval decreases
<span class="nc bnc" id="L2509" title="All 48 branches missed.">            ivl = (ListenerUtil.mutListener.listen(16674) ? (Math.max((ListenerUtil.mutListener.listen(16670) ? (card.getIvl() % minNewIvl) : (ListenerUtil.mutListener.listen(16669) ? (card.getIvl() / minNewIvl) : (ListenerUtil.mutListener.listen(16668) ? (card.getIvl() - minNewIvl) : (ListenerUtil.mutListener.listen(16667) ? (card.getIvl() + minNewIvl) : (card.getIvl() * minNewIvl))))), ivl) % easyBonus) : (ListenerUtil.mutListener.listen(16673) ? (Math.max((ListenerUtil.mutListener.listen(16670) ? (card.getIvl() % minNewIvl) : (ListenerUtil.mutListener.listen(16669) ? (card.getIvl() / minNewIvl) : (ListenerUtil.mutListener.listen(16668) ? (card.getIvl() - minNewIvl) : (ListenerUtil.mutListener.listen(16667) ? (card.getIvl() + minNewIvl) : (card.getIvl() * minNewIvl))))), ivl) / easyBonus) : (ListenerUtil.mutListener.listen(16672) ? (Math.max((ListenerUtil.mutListener.listen(16670) ? (card.getIvl() % minNewIvl) : (ListenerUtil.mutListener.listen(16669) ? (card.getIvl() / minNewIvl) : (ListenerUtil.mutListener.listen(16668) ? (card.getIvl() - minNewIvl) : (ListenerUtil.mutListener.listen(16667) ? (card.getIvl() + minNewIvl) : (card.getIvl() * minNewIvl))))), ivl) - easyBonus) : (ListenerUtil.mutListener.listen(16671) ? (Math.max((ListenerUtil.mutListener.listen(16670) ? (card.getIvl() % minNewIvl) : (ListenerUtil.mutListener.listen(16669) ? (card.getIvl() / minNewIvl) : (ListenerUtil.mutListener.listen(16668) ? (card.getIvl() - minNewIvl) : (ListenerUtil.mutListener.listen(16667) ? (card.getIvl() + minNewIvl) : (card.getIvl() * minNewIvl))))), ivl) + easyBonus) : (Math.max((ListenerUtil.mutListener.listen(16670) ? (card.getIvl() % minNewIvl) : (ListenerUtil.mutListener.listen(16669) ? (card.getIvl() / minNewIvl) : (ListenerUtil.mutListener.listen(16668) ? (card.getIvl() - minNewIvl) : (ListenerUtil.mutListener.listen(16667) ? (card.getIvl() + minNewIvl) : (card.getIvl() * minNewIvl))))), ivl) * easyBonus)))));</span>
        }
<span class="nc" id="L2511">        return _constrainedIvl(ivl, conf, 0, false);</span>
    }

    /**
     * Rebuild a dynamic deck.
     */
    protected void rebuildDyn() {
<span class="nc bnc" id="L2518" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16676)) {</span>
<span class="nc" id="L2519">            rebuildDyn(0);</span>
        }
<span class="nc" id="L2521">    }</span>

    // Overridden, because upstream implements exactly the same method in two different way for unknown reason
    public void rebuildDyn(long did) {
<span class="nc bnc" id="L2525" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16683)) {</span>
<span class="nc bnc" id="L2526" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(16681) ? (did &gt;= 0) : (ListenerUtil.mutListener.listen(16680) ? (did &lt;= 0) : (ListenerUtil.mutListener.listen(16679) ? (did &gt; 0) : (ListenerUtil.mutListener.listen(16678) ? (did &lt; 0) : (ListenerUtil.mutListener.listen(16677) ? (did != 0) : (did == 0))))))) {</span>
<span class="nc bnc" id="L2527" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16682)) {</span>
<span class="nc" id="L2528">                    did = mCol.getDecks().selected();</span>
                }
            }
        }
<span class="nc" id="L2532">        Deck deck = mCol.getDecks().get(did);</span>
<span class="nc bnc" id="L2533" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16685)) {</span>
<span class="nc bnc" id="L2534" title="All 2 branches missed.">            if (deck.getInt(&quot;dyn&quot;) == DECK_STD) {</span>
<span class="nc bnc" id="L2535" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16684)) {</span>
<span class="nc" id="L2536">                    Timber.e(&quot;error: deck is not a filtered deck&quot;);</span>
                }
<span class="nc" id="L2538">                return;</span>
            }
        }
<span class="nc bnc" id="L2541" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16686)) {</span>
            // move any existing cards back first, then fill
<span class="nc" id="L2543">            emptyDyn(did);</span>
        }
<span class="nc" id="L2545">        int cnt = _fillDyn(deck);</span>
<span class="nc bnc" id="L2546" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16692)) {</span>
<span class="nc bnc" id="L2547" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(16691) ? (cnt &gt;= 0) : (ListenerUtil.mutListener.listen(16690) ? (cnt &lt;= 0) : (ListenerUtil.mutListener.listen(16689) ? (cnt &gt; 0) : (ListenerUtil.mutListener.listen(16688) ? (cnt &lt; 0) : (ListenerUtil.mutListener.listen(16687) ? (cnt != 0) : (cnt == 0))))))) {</span>
<span class="nc" id="L2548">                return;</span>
            }
        }
<span class="nc bnc" id="L2551" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16693)) {</span>
            // and change to our new deck
<span class="nc" id="L2553">            mCol.getDecks().select(did);</span>
        }
<span class="nc" id="L2555">    }</span>

    /**
     * Whether the filtered deck is empty
     * Overriden
     */
    private int _fillDyn(Deck deck) {
<span class="nc" id="L2562">        int start = -100000;</span>
<span class="nc" id="L2563">        int total = 0;</span>
        List&lt;Long&gt; ids;
<span class="nc" id="L2565">        JSONArray terms = deck.getJSONArray(&quot;terms&quot;);</span>
        {
<span class="nc" id="L2567">            long _loopCounter319 = 0;</span>
<span class="nc bnc" id="L2568" title="All 2 branches missed.">            for (JSONArray term : terms.jsonArrayIterable()) {</span>
<span class="nc" id="L2569">                ListenerUtil.loopListener.listen(&quot;_loopCounter319&quot;, ++_loopCounter319);</span>
<span class="nc" id="L2570">                String search = term.getString(0);</span>
<span class="nc" id="L2571">                int limit = term.getInt(1);</span>
<span class="nc" id="L2572">                int order = term.getInt(2);</span>
<span class="nc" id="L2573">                String orderlimit = _dynOrder(order, limit);</span>
<span class="nc bnc" id="L2574" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16695)) {</span>
<span class="nc bnc" id="L2575" title="All 2 branches missed.">                    if (!TextUtils.isEmpty(search.trim())) {</span>
<span class="nc bnc" id="L2576" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(16694)) {</span>
<span class="nc" id="L2577">                            search = String.format(Locale.US, &quot;(%s)&quot;, search);</span>
                        }
                    }
                }
<span class="nc bnc" id="L2581" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16696)) {</span>
<span class="nc" id="L2582">                    search = String.format(Locale.US, &quot;%s -is:suspended -is:buried -deck:filtered&quot;, search);</span>
                }
<span class="nc" id="L2584">                ids = mCol.findCards(search, orderlimit);</span>
<span class="nc bnc" id="L2585" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16697)) {</span>
<span class="nc bnc" id="L2586" title="All 2 branches missed.">                    if (ids.isEmpty()) {</span>
<span class="nc" id="L2587">                        return total;</span>
                    }
                }
<span class="nc bnc" id="L2590" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16698)) {</span>
                    // move the cards over
<span class="nc" id="L2592">                    mCol.log(deck.getLong(&quot;id&quot;), ids);</span>
                }
<span class="nc bnc" id="L2594" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16703)) {</span>
<span class="nc bnc" id="L2595" title="All 8 branches missed.">                    _moveToDyn(deck.getLong(&quot;id&quot;), ids, (ListenerUtil.mutListener.listen(16702) ? (start % total) : (ListenerUtil.mutListener.listen(16701) ? (start / total) : (ListenerUtil.mutListener.listen(16700) ? (start * total) : (ListenerUtil.mutListener.listen(16699) ? (start - total) : (start + total))))));</span>
                }
<span class="nc bnc" id="L2597" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16704)) {</span>
<span class="nc" id="L2598">                    total += ids.size();</span>
                }
<span class="nc" id="L2600">            }</span>
        }
<span class="nc" id="L2602">        return total;</span>
    }

    public void emptyDyn(long did) {
<span class="nc bnc" id="L2606" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16705)) {</span>
<span class="nc" id="L2607">            emptyDyn(did, null);</span>
        }
<span class="nc" id="L2609">    }</span>

    // Overriden: other queue in V1
    public void emptyDyn(long did, String lim) {
<span class="nc bnc" id="L2613" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16707)) {</span>
<span class="nc bnc" id="L2614" title="All 2 branches missed.">            if (lim == null) {</span>
<span class="nc bnc" id="L2615" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16706)) {</span>
<span class="nc" id="L2616">                    lim = &quot;did = &quot; + did;</span>
                }
            }
        }
<span class="nc bnc" id="L2620" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16708)) {</span>
<span class="nc" id="L2621">            mCol.log(mCol.getDb().queryLongList(&quot;select id from cards where &quot; + lim));</span>
        }
<span class="nc bnc" id="L2623" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16709)) {</span>
<span class="nc" id="L2624">            mCol.getDb().execute(&quot;update cards set did = odid, &quot; + _restoreQueueWhenEmptyingSnippet() + &quot;, due = (case when odue&gt;0 then odue else due end), odue = 0, odid = 0, usn = ? where &quot; + lim, mCol.usn());</span>
        }
<span class="nc" id="L2626">    }</span>

    public void remFromDyn(long[] cids) {
<span class="nc bnc" id="L2629" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16710)) {</span>
<span class="nc" id="L2630">            emptyDyn(0, &quot;id IN &quot; + Utils.ids2str(cids) + &quot; AND odid&quot;);</span>
        }
<span class="nc" id="L2632">    }</span>

    public void remFromDyn(List&lt;Long&gt; cids) {
<span class="nc bnc" id="L2635" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16711)) {</span>
<span class="nc" id="L2636">            emptyDyn(0, &quot;id IN &quot; + Utils.ids2str(cids) + &quot; AND odid&quot;);</span>
        }
<span class="nc" id="L2638">    }</span>

    /**
     * Generates the required SQL for order by and limit clauses, for dynamic decks.
     *
     * @param o deck[&quot;order&quot;]
     * @param l deck[&quot;limit&quot;]
     * @return The generated SQL to be suffixed to &quot;select ... from ... order by &quot;
     */
    @NonNull
    protected String _dynOrder(@Consts.DYN_PRIORITY int o, int l) {
        String t;
<span class="nc bnc" id="L2650" title="All 9 branches missed.">        switch(o) {</span>
            case Consts.DYN_OLDEST:
<span class="nc" id="L2652">                t = &quot;c.mod&quot;;</span>
<span class="nc" id="L2653">                break;</span>
            case Consts.DYN_RANDOM:
<span class="nc" id="L2655">                t = &quot;random()&quot;;</span>
<span class="nc" id="L2656">                break;</span>
            case Consts.DYN_SMALLINT:
<span class="nc" id="L2658">                t = &quot;ivl&quot;;</span>
<span class="nc" id="L2659">                break;</span>
            case Consts.DYN_BIGINT:
<span class="nc" id="L2661">                t = &quot;ivl desc&quot;;</span>
<span class="nc" id="L2662">                break;</span>
            case Consts.DYN_LAPSES:
<span class="nc" id="L2664">                t = &quot;lapses desc&quot;;</span>
<span class="nc" id="L2665">                break;</span>
            case Consts.DYN_ADDED:
<span class="nc" id="L2667">                t = &quot;n.id&quot;;</span>
<span class="nc" id="L2668">                break;</span>
            case Consts.DYN_REVADDED:
<span class="nc" id="L2670">                t = &quot;n.id desc&quot;;</span>
<span class="nc" id="L2671">                break;</span>
            case Consts.DYN_DUEPRIORITY:
<span class="nc" id="L2673">                t = String.format(Locale.US, &quot;(case when queue=&quot; + Consts.QUEUE_TYPE_REV + &quot; and due &lt;= %d then (ivl / cast(%d-due+0.001 as real)) else 100000+due end)&quot;, mToday, mToday);</span>
<span class="nc" id="L2674">                break;</span>
            case Consts.DYN_DUE:
            default:
                // if we don't understand the term, default to due order
<span class="nc" id="L2678">                t = &quot;c.due&quot;;</span>
                break;
        }
<span class="nc" id="L2681">        return t + &quot; limit &quot; + l;</span>
    }

    protected void _moveToDyn(long did, @NonNull List&lt;Long&gt; ids, int start) {
<span class="nc" id="L2685">        Deck deck = mCol.getDecks().get(did);</span>
<span class="nc" id="L2686">        ArrayList&lt;Object[]&gt; data = new ArrayList&lt;&gt;(ids.size());</span>
<span class="nc" id="L2687">        int u = mCol.usn();</span>
<span class="nc" id="L2688">        int due = start;</span>
<span class="nc bnc" id="L2689" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16714)) {</span>
            {
<span class="nc" id="L2691">                long _loopCounter320 = 0;</span>
<span class="nc bnc" id="L2692" title="All 2 branches missed.">                for (Long id : ids) {</span>
<span class="nc" id="L2693">                    ListenerUtil.loopListener.listen(&quot;_loopCounter320&quot;, ++_loopCounter320);</span>
<span class="nc bnc" id="L2694" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(16712)) {</span>
<span class="nc" id="L2695">                        data.add(new Object[] { did, due, u, id });</span>
                    }
<span class="nc bnc" id="L2697" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(16713)) {</span>
<span class="nc" id="L2698">                        due += 1;</span>
                    }
<span class="nc" id="L2700">                }</span>
            }
        }
<span class="nc" id="L2703">        String queue = &quot;&quot;;</span>
<span class="nc bnc" id="L2704" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16716)) {</span>
<span class="nc bnc" id="L2705" title="All 2 branches missed.">            if (!deck.getBoolean(&quot;resched&quot;)) {</span>
<span class="nc bnc" id="L2706" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16715)) {</span>
<span class="nc" id="L2707">                    queue = &quot;, queue = &quot; + Consts.QUEUE_TYPE_REV + &quot;&quot;;</span>
                }
            }
        }
<span class="nc bnc" id="L2711" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16717)) {</span>
<span class="nc" id="L2712">            mCol.getDb().executeMany(&quot;UPDATE cards SET odid = did, &quot; + &quot;odue = due, did = ?, due = (case when due &lt;= 0 then due else ? end), usn = ? &quot; + queue + &quot; WHERE id = ?&quot;, data);</span>
        }
<span class="nc" id="L2714">    }</span>

    private void _removeFromFiltered(@NonNull Card card) {
<span class="nc bnc" id="L2717" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16721)) {</span>
<span class="nc bnc" id="L2718" title="All 2 branches missed.">            if (card.isInDynamicDeck()) {</span>
<span class="nc bnc" id="L2719" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16718)) {</span>
<span class="nc" id="L2720">                    card.setDid(card.getODid());</span>
                }
<span class="nc bnc" id="L2722" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16719)) {</span>
<span class="nc" id="L2723">                    card.setODue(0);</span>
                }
<span class="nc bnc" id="L2725" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16720)) {</span>
<span class="nc" id="L2726">                    card.setODid(0);</span>
                }
            }
        }
<span class="nc" id="L2730">    }</span>

    private void _restorePreviewCard(@NonNull Card card) {
<span class="nc bnc" id="L2733" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16722)) {</span>
<span class="nc bnc" id="L2734" title="All 2 branches missed.">            if (!card.isInDynamicDeck()) {</span>
<span class="nc" id="L2735">                throw new RuntimeException(&quot;ODid wasn't set&quot;);</span>
            }
        }
<span class="nc bnc" id="L2738" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16723)) {</span>
<span class="nc" id="L2739">            card.setDue(card.getODue());</span>
        }
<span class="nc bnc" id="L2741" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16744)) {</span>
            // other types map directly to queues
<span class="nc bnc" id="L2743" title="All 90 branches missed.">            if ((ListenerUtil.mutListener.listen(16734) ? ((ListenerUtil.mutListener.listen(16728) ? (card.getType() &gt;= Consts.CARD_TYPE_LRN) : (ListenerUtil.mutListener.listen(16727) ? (card.getType() &lt;= Consts.CARD_TYPE_LRN) : (ListenerUtil.mutListener.listen(16726) ? (card.getType() &gt; Consts.CARD_TYPE_LRN) : (ListenerUtil.mutListener.listen(16725) ? (card.getType() &lt; Consts.CARD_TYPE_LRN) : (ListenerUtil.mutListener.listen(16724) ? (card.getType() != Consts.CARD_TYPE_LRN) : (card.getType() == Consts.CARD_TYPE_LRN)))))) &amp;&amp; (ListenerUtil.mutListener.listen(16733) ? (card.getType() &gt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16732) ? (card.getType() &lt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16731) ? (card.getType() &gt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16730) ? (card.getType() &lt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16729) ? (card.getType() != Consts.CARD_TYPE_RELEARNING) : (card.getType() == Consts.CARD_TYPE_RELEARNING))))))) : ((ListenerUtil.mutListener.listen(16728) ? (card.getType() &gt;= Consts.CARD_TYPE_LRN) : (ListenerUtil.mutListener.listen(16727) ? (card.getType() &lt;= Consts.CARD_TYPE_LRN) : (ListenerUtil.mutListener.listen(16726) ? (card.getType() &gt; Consts.CARD_TYPE_LRN) : (ListenerUtil.mutListener.listen(16725) ? (card.getType() &lt; Consts.CARD_TYPE_LRN) : (ListenerUtil.mutListener.listen(16724) ? (card.getType() != Consts.CARD_TYPE_LRN) : (card.getType() == Consts.CARD_TYPE_LRN)))))) || (ListenerUtil.mutListener.listen(16733) ? (card.getType() &gt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16732) ? (card.getType() &lt;= Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16731) ? (card.getType() &gt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16730) ? (card.getType() &lt; Consts.CARD_TYPE_RELEARNING) : (ListenerUtil.mutListener.listen(16729) ? (card.getType() != Consts.CARD_TYPE_RELEARNING) : (card.getType() == Consts.CARD_TYPE_RELEARNING))))))))) {</span>
<span class="nc bnc" id="L2744" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16743)) {</span>
<span class="nc bnc" id="L2745" title="All 22 branches missed.">                    if ((ListenerUtil.mutListener.listen(16740) ? (card.getODue() &gt;= 1000000000) : (ListenerUtil.mutListener.listen(16739) ? (card.getODue() &lt;= 1000000000) : (ListenerUtil.mutListener.listen(16738) ? (card.getODue() &lt; 1000000000) : (ListenerUtil.mutListener.listen(16737) ? (card.getODue() != 1000000000) : (ListenerUtil.mutListener.listen(16736) ? (card.getODue() == 1000000000) : (card.getODue() &gt; 1000000000))))))) {</span>
<span class="nc bnc" id="L2746" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(16742)) {</span>
<span class="nc" id="L2747">                            card.setQueue(Consts.QUEUE_TYPE_LRN);</span>
                        }
                    } else {
<span class="nc bnc" id="L2750" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(16741)) {</span>
<span class="nc" id="L2751">                            card.setQueue(Consts.QUEUE_TYPE_DAY_LEARN_RELEARN);</span>
                        }
                    }
                }
            } else {
<span class="nc bnc" id="L2756" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16735)) {</span>
<span class="nc" id="L2757">                    card.setQueue(card.getType());</span>
                }
            }
        }
<span class="nc" id="L2761">    }</span>

    /**
     * Leech handler. True if card was a leech.
     *        Overridden: in V1, due and did are changed
     */
    protected boolean _checkLeech(@NonNull Card card, @NonNull JSONObject conf) {
<span class="nc" id="L2768">        int lf = conf.getInt(&quot;leechFails&quot;);</span>
<span class="nc bnc" id="L2769" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16750)) {</span>
<span class="nc bnc" id="L2770" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(16749) ? (lf &gt;= 0) : (ListenerUtil.mutListener.listen(16748) ? (lf &lt;= 0) : (ListenerUtil.mutListener.listen(16747) ? (lf &gt; 0) : (ListenerUtil.mutListener.listen(16746) ? (lf &lt; 0) : (ListenerUtil.mutListener.listen(16745) ? (lf != 0) : (lf == 0))))))) {</span>
<span class="nc" id="L2771">                return false;</span>
            }
        }
<span class="nc bnc" id="L2774" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16785)) {</span>
            // if over threshold or every half threshold reps after that
<span class="nc bnc" id="L2776" title="All 1146 branches missed.">            if ((ListenerUtil.mutListener.listen(16773) ? ((ListenerUtil.mutListener.listen(16755) ? (card.getLapses() &lt;= lf) : (ListenerUtil.mutListener.listen(16754) ? (card.getLapses() &gt; lf) : (ListenerUtil.mutListener.listen(16753) ? (card.getLapses() &lt; lf) : (ListenerUtil.mutListener.listen(16752) ? (card.getLapses() != lf) : (ListenerUtil.mutListener.listen(16751) ? (card.getLapses() == lf) : (card.getLapses() &gt;= lf)))))) || (ListenerUtil.mutListener.listen(16772) ? ((ListenerUtil.mutListener.listen(16767) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) / Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16766) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) * Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16765) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) - Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16764) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) + Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) % Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)))))) &gt;= 0) : (ListenerUtil.mutListener.listen(16771) ? ((ListenerUtil.mutListener.listen(16767) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) / Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16766) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) * Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16765) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) - Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16764) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) + Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) % Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)))))) &lt;= 0) : (ListenerUtil.mutListener.listen(16770) ? ((ListenerUtil.mutListener.listen(16767) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) / Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16766) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) * Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16765) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) - Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16764) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) + Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) % Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)))))) &gt; 0) : (ListenerUtil.mutListener.listen(16769) ? ((ListenerUtil.mutListener.listen(16767) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) / Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16766) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) * Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16765) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) - Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16764) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) + Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) % Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)))))) &lt; 0) : (ListenerUtil.mutListener.listen(16768) ? ((ListenerUtil.mutListener.listen(16767) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) / Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16766) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) * Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16765) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) - Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16764) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) + Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) % Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)))))) != 0) : ((ListenerUtil.mutListener.listen(16767) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) / Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16766) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) * Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16765) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) - Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16764) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) + Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) % Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)))))) == 0))))))) : ((ListenerUtil.mutListener.listen(16755) ? (card.getLapses() &lt;= lf) : (ListenerUtil.mutListener.listen(16754) ? (card.getLapses() &gt; lf) : (ListenerUtil.mutListener.listen(16753) ? (card.getLapses() &lt; lf) : (ListenerUtil.mutListener.listen(16752) ? (card.getLapses() != lf) : (ListenerUtil.mutListener.listen(16751) ? (card.getLapses() == lf) : (card.getLapses() &gt;= lf)))))) &amp;&amp; (ListenerUtil.mutListener.listen(16772) ? ((ListenerUtil.mutListener.listen(16767) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) / Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16766) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) * Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16765) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) - Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16764) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) + Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) % Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)))))) &gt;= 0) : (ListenerUtil.mutListener.listen(16771) ? ((ListenerUtil.mutListener.listen(16767) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) / Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16766) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) * Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16765) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) - Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16764) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) + Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) % Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)))))) &lt;= 0) : (ListenerUtil.mutListener.listen(16770) ? ((ListenerUtil.mutListener.listen(16767) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) / Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16766) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) * Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16765) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) - Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16764) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) + Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) % Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)))))) &gt; 0) : (ListenerUtil.mutListener.listen(16769) ? ((ListenerUtil.mutListener.listen(16767) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) / Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16766) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) * Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16765) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) - Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16764) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) + Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) % Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)))))) &lt; 0) : (ListenerUtil.mutListener.listen(16768) ? ((ListenerUtil.mutListener.listen(16767) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) / Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16766) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) * Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16765) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) - Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16764) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) + Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) % Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)))))) != 0) : ((ListenerUtil.mutListener.listen(16767) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) / Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16766) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) * Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16765) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) - Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (ListenerUtil.mutListener.listen(16764) ? (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) + Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)) : (((ListenerUtil.mutListener.listen(16759) ? (card.getLapses() % lf) : (ListenerUtil.mutListener.listen(16758) ? (card.getLapses() / lf) : (ListenerUtil.mutListener.listen(16757) ? (card.getLapses() * lf) : (ListenerUtil.mutListener.listen(16756) ? (card.getLapses() + lf) : (card.getLapses() - lf)))))) % Math.max((ListenerUtil.mutListener.listen(16763) ? (lf % 2) : (ListenerUtil.mutListener.listen(16762) ? (lf * 2) : (ListenerUtil.mutListener.listen(16761) ? (lf - 2) : (ListenerUtil.mutListener.listen(16760) ? (lf + 2) : (lf / 2))))), 1)))))) == 0))))))))) {</span>
                // add a leech tag
<span class="nc" id="L2778">                Note n = card.note();</span>
<span class="nc bnc" id="L2779" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16774)) {</span>
<span class="nc" id="L2780">                    n.addTag(&quot;leech&quot;);</span>
                }
<span class="nc bnc" id="L2782" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16775)) {</span>
<span class="nc" id="L2783">                    n.flush();</span>
                }
<span class="nc bnc" id="L2785" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16782)) {</span>
                    // handle
<span class="nc bnc" id="L2787" title="All 22 branches missed.">                    if ((ListenerUtil.mutListener.listen(16780) ? (conf.getInt(&quot;leechAction&quot;) &gt;= Consts.LEECH_SUSPEND) : (ListenerUtil.mutListener.listen(16779) ? (conf.getInt(&quot;leechAction&quot;) &lt;= Consts.LEECH_SUSPEND) : (ListenerUtil.mutListener.listen(16778) ? (conf.getInt(&quot;leechAction&quot;) &gt; Consts.LEECH_SUSPEND) : (ListenerUtil.mutListener.listen(16777) ? (conf.getInt(&quot;leechAction&quot;) &lt; Consts.LEECH_SUSPEND) : (ListenerUtil.mutListener.listen(16776) ? (conf.getInt(&quot;leechAction&quot;) != Consts.LEECH_SUSPEND) : (conf.getInt(&quot;leechAction&quot;) == Consts.LEECH_SUSPEND))))))) {</span>
<span class="nc bnc" id="L2788" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(16781)) {</span>
<span class="nc" id="L2789">                            card.setQueue(Consts.QUEUE_TYPE_SUSPENDED);</span>
                        }
                    }
                }
<span class="nc bnc" id="L2793" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16784)) {</span>
                    // notify UI
<span class="nc bnc" id="L2795" title="All 2 branches missed.">                    if (mContextReference != null) {</span>
<span class="nc" id="L2796">                        Activity context = mContextReference.get();</span>
<span class="nc bnc" id="L2797" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(16783)) {</span>
<span class="nc" id="L2798">                            leech(card, context);</span>
                        }
                    }
                }
<span class="nc" id="L2802">                return true;</span>
            }
        }
<span class="nc" id="L2805">        return false;</span>
    }

    @NonNull
    public DeckConfig _cardConf(@NonNull Card card) {
<span class="fc" id="L2810">        return mCol.getDecks().confForDid(card.getDid());</span>
    }

    // Overridden: different delays for filtered cards.
    @NonNull
    protected JSONObject _newConf(@NonNull Card card) {
<span class="fc" id="L2816">        DeckConfig conf = _cardConf(card);</span>
<span class="pc bpc" id="L2817" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16786)) {</span>
<span class="pc bpc" id="L2818" title="1 of 2 branches missed.">            if (!card.isInDynamicDeck()) {</span>
<span class="fc" id="L2819">                return conf.getJSONObject(&quot;new&quot;);</span>
            }
        }
        // dynamic deck; override some attributes, use original deck for others
<span class="nc" id="L2823">        DeckConfig oconf = mCol.getDecks().confForDid(card.getODid());</span>
<span class="nc" id="L2824">        JSONObject dict = new JSONObject();</span>
<span class="nc bnc" id="L2825" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16787)) {</span>
            // original deck
<span class="nc" id="L2827">            dict.put(&quot;ints&quot;, oconf.getJSONObject(&quot;new&quot;).getJSONArray(&quot;ints&quot;));</span>
        }
<span class="nc bnc" id="L2829" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16788)) {</span>
<span class="nc" id="L2830">            dict.put(&quot;initialFactor&quot;, oconf.getJSONObject(&quot;new&quot;).getInt(&quot;initialFactor&quot;));</span>
        }
<span class="nc bnc" id="L2832" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16789)) {</span>
<span class="nc" id="L2833">            dict.put(&quot;bury&quot;, oconf.getJSONObject(&quot;new&quot;).optBoolean(&quot;bury&quot;, true));</span>
        }
<span class="nc bnc" id="L2835" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16790)) {</span>
<span class="nc" id="L2836">            dict.put(&quot;delays&quot;, oconf.getJSONObject(&quot;new&quot;).getJSONArray(&quot;delays&quot;));</span>
        }
<span class="nc bnc" id="L2838" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16791)) {</span>
            // overrides
<span class="nc" id="L2840">            dict.put(&quot;separate&quot;, conf.getBoolean(&quot;separate&quot;));</span>
        }
<span class="nc bnc" id="L2842" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16792)) {</span>
<span class="nc" id="L2843">            dict.put(&quot;order&quot;, Consts.NEW_CARDS_DUE);</span>
        }
<span class="nc bnc" id="L2845" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16793)) {</span>
<span class="nc" id="L2846">            dict.put(&quot;perDay&quot;, mReportLimit);</span>
        }
<span class="nc" id="L2848">        return dict;</span>
    }

    // Overridden: different delays for filtered cards.
    @NonNull
    protected JSONObject _lapseConf(@NonNull Card card) {
<span class="nc" id="L2854">        DeckConfig conf = _cardConf(card);</span>
<span class="nc bnc" id="L2855" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16794)) {</span>
<span class="nc bnc" id="L2856" title="All 2 branches missed.">            if (!card.isInDynamicDeck()) {</span>
<span class="nc" id="L2857">                return conf.getJSONObject(&quot;lapse&quot;);</span>
            }
        }
        // dynamic deck; override some attributes, use original deck for others
<span class="nc" id="L2861">        DeckConfig oconf = mCol.getDecks().confForDid(card.getODid());</span>
<span class="nc" id="L2862">        JSONObject dict = new JSONObject();</span>
<span class="nc bnc" id="L2863" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16795)) {</span>
            // original deck
<span class="nc" id="L2865">            dict.put(&quot;minInt&quot;, oconf.getJSONObject(&quot;lapse&quot;).getInt(&quot;minInt&quot;));</span>
        }
<span class="nc bnc" id="L2867" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16796)) {</span>
<span class="nc" id="L2868">            dict.put(&quot;leechFails&quot;, oconf.getJSONObject(&quot;lapse&quot;).getInt(&quot;leechFails&quot;));</span>
        }
<span class="nc bnc" id="L2870" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16797)) {</span>
<span class="nc" id="L2871">            dict.put(&quot;leechAction&quot;, oconf.getJSONObject(&quot;lapse&quot;).getInt(&quot;leechAction&quot;));</span>
        }
<span class="nc bnc" id="L2873" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16798)) {</span>
<span class="nc" id="L2874">            dict.put(&quot;mult&quot;, oconf.getJSONObject(&quot;lapse&quot;).getDouble(&quot;mult&quot;));</span>
        }
<span class="nc bnc" id="L2876" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16799)) {</span>
<span class="nc" id="L2877">            dict.put(&quot;delays&quot;, oconf.getJSONObject(&quot;lapse&quot;).getJSONArray(&quot;delays&quot;));</span>
        }
<span class="nc bnc" id="L2879" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16800)) {</span>
            // overrides
<span class="nc" id="L2881">            dict.put(&quot;resched&quot;, conf.getBoolean(&quot;resched&quot;));</span>
        }
<span class="nc" id="L2883">        return dict;</span>
    }

    @NonNull
    protected JSONObject _revConf(@NonNull Card card) {
<span class="fc" id="L2888">        DeckConfig conf = _cardConf(card);</span>
<span class="pc bpc" id="L2889" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16801)) {</span>
<span class="pc bpc" id="L2890" title="1 of 2 branches missed.">            if (!card.isInDynamicDeck()) {</span>
<span class="fc" id="L2891">                return conf.getJSONObject(&quot;rev&quot;);</span>
            }
        }
<span class="nc" id="L2894">        return mCol.getDecks().confForDid(card.getODid()).getJSONObject(&quot;rev&quot;);</span>
    }

    @NonNull
    public String _deckLimit() {
<span class="fc" id="L2899">        return Utils.ids2str(mCol.getDecks().active());</span>
    }

    private boolean _previewingCard(@NonNull Card card) {
<span class="nc" id="L2903">        DeckConfig conf = _cardConf(card);</span>
<span class="nc bnc" id="L2904" title="All 10 branches missed.">        return (ListenerUtil.mutListener.listen(16802) ? (conf.getInt(&quot;dyn&quot;) == DECK_DYN || !conf.getBoolean(&quot;resched&quot;)) : (conf.getInt(&quot;dyn&quot;) == DECK_DYN &amp;&amp; !conf.getBoolean(&quot;resched&quot;)));</span>
    }

    private int _previewDelay(@NonNull Card card) {
<span class="nc bnc" id="L2908" title="All 8 branches missed.">        return (ListenerUtil.mutListener.listen(16806) ? (_cardConf(card).optInt(&quot;previewDelay&quot;, 10) % 60) : (ListenerUtil.mutListener.listen(16805) ? (_cardConf(card).optInt(&quot;previewDelay&quot;, 10) / 60) : (ListenerUtil.mutListener.listen(16804) ? (_cardConf(card).optInt(&quot;previewDelay&quot;, 10) - 60) : (ListenerUtil.mutListener.listen(16803) ? (_cardConf(card).optInt(&quot;previewDelay&quot;, 10) + 60) : (_cardConf(card).optInt(&quot;previewDelay&quot;, 10) * 60)))));</span>
    }

    /* Overriden: other way to count time*/
    public void _updateCutoff() {
<span class="fc bfc" id="L2913" title="All 2 branches covered.">        int oldToday = mToday == null ? 0 : mToday;</span>
<span class="pc bpc" id="L2914" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16807)) {</span>
            // days since col created
<span class="fc" id="L2916">            mToday = _daysSinceCreation();</span>
        }
<span class="pc bpc" id="L2918" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16808)) {</span>
            // end of day cutoff
<span class="fc" id="L2920">            mDayCutoff = _dayCutoff();</span>
        }
<span class="pc bpc" id="L2922" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16815)) {</span>
<span class="pc bpc" id="L2923" title="15 of 22 branches missed.">            if ((ListenerUtil.mutListener.listen(16813) ? (oldToday &gt;= mToday) : (ListenerUtil.mutListener.listen(16812) ? (oldToday &lt;= mToday) : (ListenerUtil.mutListener.listen(16811) ? (oldToday &gt; mToday) : (ListenerUtil.mutListener.listen(16810) ? (oldToday &lt; mToday) : (ListenerUtil.mutListener.listen(16809) ? (oldToday == mToday) : (oldToday != mToday))))))) {</span>
<span class="pc bpc" id="L2924" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16814)) {</span>
<span class="fc" id="L2925">                    mCol.log(mToday, mDayCutoff);</span>
                }
            }
        }
<span class="pc bpc" id="L2929" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16817)) {</span>
            {
<span class="fc" id="L2931">                long _loopCounter321 = 0;</span>
                // instead
<span class="fc bfc" id="L2933" title="All 2 branches covered.">                for (Deck deck : mCol.getDecks().all()) {</span>
<span class="fc" id="L2934">                    ListenerUtil.loopListener.listen(&quot;_loopCounter321&quot;, ++_loopCounter321);</span>
<span class="pc bpc" id="L2935" title="1 of 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(16816)) {</span>
<span class="fc" id="L2936">                        update(deck);</span>
                    }
<span class="fc" id="L2938">                }</span>
            }
        }
        // unbury if the day has rolled over
<span class="fc" id="L2942">        int unburied = mCol.getConf().optInt(&quot;lastUnburied&quot;, 0);</span>
<span class="pc bpc" id="L2943" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16825)) {</span>
<span class="pc bpc" id="L2944" title="16 of 22 branches missed.">            if ((ListenerUtil.mutListener.listen(16822) ? (unburied &gt;= mToday) : (ListenerUtil.mutListener.listen(16821) ? (unburied &lt;= mToday) : (ListenerUtil.mutListener.listen(16820) ? (unburied &gt; mToday) : (ListenerUtil.mutListener.listen(16819) ? (unburied != mToday) : (ListenerUtil.mutListener.listen(16818) ? (unburied == mToday) : (unburied &lt; mToday))))))) {</span>
<span class="nc bnc" id="L2945" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16823)) {</span>
<span class="nc" id="L2946">                    SyncStatus.ignoreDatabaseModification(this::unburyCards);</span>
                }
<span class="nc bnc" id="L2948" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16824)) {</span>
<span class="nc" id="L2949">                    mCol.getConf().put(&quot;lastUnburied&quot;, mToday);</span>
                }
            }
        }
<span class="fc" id="L2953">    }</span>

    private long _dayCutoff() {
<span class="fc" id="L2956">        int rolloverTime = mCol.getConf().optInt(&quot;rollover&quot;, 4);</span>
<span class="pc bpc" id="L2957" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16836)) {</span>
<span class="pc bpc" id="L2958" title="16 of 22 branches missed.">            if ((ListenerUtil.mutListener.listen(16830) ? (rolloverTime &gt;= 0) : (ListenerUtil.mutListener.listen(16829) ? (rolloverTime &lt;= 0) : (ListenerUtil.mutListener.listen(16828) ? (rolloverTime &gt; 0) : (ListenerUtil.mutListener.listen(16827) ? (rolloverTime != 0) : (ListenerUtil.mutListener.listen(16826) ? (rolloverTime == 0) : (rolloverTime &lt; 0))))))) {</span>
<span class="nc bnc" id="L2959" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16835)) {</span>
<span class="nc bnc" id="L2960" title="All 8 branches missed.">                    rolloverTime = (ListenerUtil.mutListener.listen(16834) ? (24 % rolloverTime) : (ListenerUtil.mutListener.listen(16833) ? (24 / rolloverTime) : (ListenerUtil.mutListener.listen(16832) ? (24 * rolloverTime) : (ListenerUtil.mutListener.listen(16831) ? (24 - rolloverTime) : (24 + rolloverTime)))));</span>
                }
            }
        }
<span class="fc" id="L2964">        Calendar date = getTime().calendar();</span>
<span class="pc bpc" id="L2965" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16837)) {</span>
<span class="fc" id="L2966">            date.set(Calendar.HOUR_OF_DAY, rolloverTime);</span>
        }
<span class="pc bpc" id="L2968" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16838)) {</span>
<span class="fc" id="L2969">            date.set(Calendar.MINUTE, 0);</span>
        }
<span class="pc bpc" id="L2971" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16839)) {</span>
<span class="fc" id="L2972">            date.set(Calendar.SECOND, 0);</span>
        }
<span class="pc bpc" id="L2974" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16840)) {</span>
<span class="fc" id="L2975">            date.set(Calendar.MILLISECOND, 0);</span>
        }
<span class="fc" id="L2977">        Calendar today = getTime().calendar();</span>
<span class="pc bpc" id="L2978" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16842)) {</span>
<span class="pc bpc" id="L2979" title="1 of 2 branches missed.">            if (date.before(today)) {</span>
<span class="pc bpc" id="L2980" title="1 of 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16841)) {</span>
<span class="fc" id="L2981">                    date.add(Calendar.DAY_OF_MONTH, 1);</span>
                }
            }
        }
<span class="pc bpc" id="L2985" title="4 of 8 branches missed.">        return (ListenerUtil.mutListener.listen(16846) ? (date.getTimeInMillis() % 1000) : (ListenerUtil.mutListener.listen(16845) ? (date.getTimeInMillis() * 1000) : (ListenerUtil.mutListener.listen(16844) ? (date.getTimeInMillis() - 1000) : (ListenerUtil.mutListener.listen(16843) ? (date.getTimeInMillis() + 1000) : (date.getTimeInMillis() / 1000)))));</span>
    }

    private int _daysSinceCreation() {
<span class="fc" id="L2989">        Calendar c = mCol.crtCalendar();</span>
<span class="pc bpc" id="L2990" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16847)) {</span>
<span class="fc" id="L2991">            c.set(Calendar.HOUR, mCol.getConf().optInt(&quot;rollover&quot;, 4));</span>
        }
<span class="pc bpc" id="L2993" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16848)) {</span>
<span class="fc" id="L2994">            c.set(Calendar.MINUTE, 0);</span>
        }
<span class="pc bpc" id="L2996" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16849)) {</span>
<span class="fc" id="L2997">            c.set(Calendar.SECOND, 0);</span>
        }
<span class="pc bpc" id="L2999" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16850)) {</span>
<span class="fc" id="L3000">            c.set(Calendar.MILLISECOND, 0);</span>
        }
<span class="pc bpc" id="L3002" title="236 of 248 branches missed.">        return (int) ((ListenerUtil.mutListener.listen(16862) ? (((ListenerUtil.mutListener.listen(16858) ? (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) % 1000) : (ListenerUtil.mutListener.listen(16857) ? (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) * 1000) : (ListenerUtil.mutListener.listen(16856) ? (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) - 1000) : (ListenerUtil.mutListener.listen(16855) ? (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) + 1000) : (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) / 1000)))))) % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16861) ? (((ListenerUtil.mutListener.listen(16858) ? (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) % 1000) : (ListenerUtil.mutListener.listen(16857) ? (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) * 1000) : (ListenerUtil.mutListener.listen(16856) ? (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) - 1000) : (ListenerUtil.mutListener.listen(16855) ? (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) + 1000) : (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) / 1000)))))) * SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16860) ? (((ListenerUtil.mutListener.listen(16858) ? (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) % 1000) : (ListenerUtil.mutListener.listen(16857) ? (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) * 1000) : (ListenerUtil.mutListener.listen(16856) ? (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) - 1000) : (ListenerUtil.mutListener.listen(16855) ? (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) + 1000) : (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) / 1000)))))) - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16859) ? (((ListenerUtil.mutListener.listen(16858) ? (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) % 1000) : (ListenerUtil.mutListener.listen(16857) ? (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) * 1000) : (ListenerUtil.mutListener.listen(16856) ? (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) - 1000) : (ListenerUtil.mutListener.listen(16855) ? (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) + 1000) : (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) / 1000)))))) + SECONDS_PER_DAY) : (((ListenerUtil.mutListener.listen(16858) ? (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) % 1000) : (ListenerUtil.mutListener.listen(16857) ? (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) * 1000) : (ListenerUtil.mutListener.listen(16856) ? (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) - 1000) : (ListenerUtil.mutListener.listen(16855) ? (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) + 1000) : (((ListenerUtil.mutListener.listen(16854) ? (getTime().intTimeMS() % c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16853) ? (getTime().intTimeMS() / c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16852) ? (getTime().intTimeMS() * c.getTimeInMillis()) : (ListenerUtil.mutListener.listen(16851) ? (getTime().intTimeMS() + c.getTimeInMillis()) : (getTime().intTimeMS() - c.getTimeInMillis())))))) / 1000)))))) / SECONDS_PER_DAY))))));</span>
    }

    protected void update(@NonNull Deck g) {
<span class="pc bpc" id="L3006" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16866)) {</span>
            {
<span class="fc" id="L3008">                long _loopCounter322 = 0;</span>
<span class="fc bfc" id="L3009" title="All 2 branches covered.">                for (String t : new String[] { &quot;new&quot;, &quot;rev&quot;, &quot;lrn&quot;, &quot;time&quot; }) {</span>
<span class="fc" id="L3010">                    ListenerUtil.loopListener.listen(&quot;_loopCounter322&quot;, ++_loopCounter322);</span>
<span class="fc" id="L3011">                    String key = t + &quot;Today&quot;;</span>
<span class="fc" id="L3012">                    JSONArray tToday = g.getJSONArray(key);</span>
<span class="pc bpc" id="L3013" title="1 of 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(16865)) {</span>
<span class="fc bfc" id="L3014" title="All 2 branches covered.">                        if (g.getJSONArray(key).getInt(0) != mToday) {</span>
<span class="pc bpc" id="L3015" title="1 of 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(16863)) {</span>
<span class="fc" id="L3016">                                tToday.put(0, mToday);</span>
                            }
<span class="pc bpc" id="L3018" title="1 of 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(16864)) {</span>
<span class="fc" id="L3019">                                tToday.put(1, 0);</span>
                            }
                        }
                    }
                }
            }
        }
<span class="fc" id="L3026">    }</span>

    public void _checkDay() {
<span class="pc bpc" id="L3029" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16873)) {</span>
            // check if the day has rolled over
<span class="pc bpc" id="L3031" title="16 of 22 branches missed.">            if ((ListenerUtil.mutListener.listen(16871) ? (getTime().intTime() &gt;= mDayCutoff) : (ListenerUtil.mutListener.listen(16870) ? (getTime().intTime() &lt;= mDayCutoff) : (ListenerUtil.mutListener.listen(16869) ? (getTime().intTime() &lt; mDayCutoff) : (ListenerUtil.mutListener.listen(16868) ? (getTime().intTime() != mDayCutoff) : (ListenerUtil.mutListener.listen(16867) ? (getTime().intTime() == mDayCutoff) : (getTime().intTime() &gt; mDayCutoff))))))) {</span>
<span class="nc bnc" id="L3032" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16872)) {</span>
<span class="nc" id="L3033">                    reset();</span>
                }
            }
        }
<span class="fc" id="L3037">    }</span>

    @NonNull
    public CharSequence finishedMsg(@NonNull Context context) {
<span class="nc" id="L3041">        SpannableStringBuilder sb = new SpannableStringBuilder();</span>
<span class="nc bnc" id="L3042" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16874)) {</span>
<span class="nc" id="L3043">            sb.append(context.getString(R.string.studyoptions_congrats_finished));</span>
        }
<span class="nc" id="L3045">        StyleSpan boldSpan = new StyleSpan(Typeface.BOLD);</span>
<span class="nc bnc" id="L3046" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16875)) {</span>
<span class="nc" id="L3047">            sb.setSpan(boldSpan, 0, sb.length(), 0);</span>
        }
<span class="nc bnc" id="L3049" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16876)) {</span>
<span class="nc" id="L3050">            sb.append(_nextDueMsg(context));</span>
        }
        // sb.append(_tomorrowDueMsg(context));
<span class="nc" id="L3053">        return sb;</span>
    }

    @NonNull
    public String _nextDueMsg(@NonNull Context context) {
<span class="nc" id="L3058">        StringBuilder sb = new StringBuilder();</span>
<span class="nc bnc" id="L3059" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16879)) {</span>
<span class="nc bnc" id="L3060" title="All 2 branches missed.">            if (revDue()) {</span>
<span class="nc bnc" id="L3061" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16877)) {</span>
<span class="nc" id="L3062">                    sb.append(&quot;\n\n&quot;);</span>
                }
<span class="nc bnc" id="L3064" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16878)) {</span>
<span class="nc" id="L3065">                    sb.append(context.getString(R.string.studyoptions_congrats_more_rev));</span>
                }
            }
        }
<span class="nc bnc" id="L3069" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16882)) {</span>
<span class="nc bnc" id="L3070" title="All 2 branches missed.">            if (newDue()) {</span>
<span class="nc bnc" id="L3071" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16880)) {</span>
<span class="nc" id="L3072">                    sb.append(&quot;\n\n&quot;);</span>
                }
<span class="nc bnc" id="L3074" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16881)) {</span>
<span class="nc" id="L3075">                    sb.append(context.getString(R.string.studyoptions_congrats_more_new));</span>
                }
            }
        }
<span class="nc bnc" id="L3079" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16885)) {</span>
<span class="nc bnc" id="L3080" title="All 2 branches missed.">            if (haveBuried()) {</span>
<span class="nc" id="L3081">                String now = &quot; &quot; + context.getString(R.string.sched_unbury_action);</span>
<span class="nc bnc" id="L3082" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16883)) {</span>
<span class="nc" id="L3083">                    sb.append(&quot;\n\n&quot;);</span>
                }
<span class="nc bnc" id="L3085" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16884)) {</span>
<span class="nc" id="L3086">                    sb.append(&quot;&quot;).append(context.getString(R.string.sched_has_buried)).append(now);</span>
                }
            }
        }
<span class="nc bnc" id="L3090" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16888)) {</span>
<span class="nc bnc" id="L3091" title="All 2 branches missed.">            if (mCol.getDecks().current().getInt(&quot;dyn&quot;) == DECK_STD) {</span>
<span class="nc bnc" id="L3092" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16886)) {</span>
<span class="nc" id="L3093">                    sb.append(&quot;\n\n&quot;);</span>
                }
<span class="nc bnc" id="L3095" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16887)) {</span>
<span class="nc" id="L3096">                    sb.append(context.getString(R.string.studyoptions_congrats_custom));</span>
                }
            }
        }
<span class="nc" id="L3100">        return sb.toString();</span>
    }

    /**
     * true if there are any rev cards due.
     */
    public boolean revDue() {
<span class="nc bnc" id="L3107" title="All 2 branches missed.">        return mCol.getDb().queryScalar(&quot;SELECT 1 FROM cards WHERE did IN &quot; + _deckLimit() + &quot; AND queue = &quot; + Consts.QUEUE_TYPE_REV + &quot; AND due &lt;= ?&quot; + &quot; LIMIT 1&quot;, mToday) != 0;</span>
    }

    /* not in upstream anki. As revDue and newDue, it's used to check
     * what to do when a deck is selected in deck picker. When this
     * method is called, we already know that no cards is due
     * immedietly. It answers whether cards will be due later in the
     * same deck. */
    public boolean hasCardsTodayAfterStudyAheadLimit() {
<span class="nc bnc" id="L3116" title="All 2 branches missed.">        return mCol.getDb().queryScalar(&quot;SELECT 1 FROM cards WHERE did IN &quot; + _deckLimit() + &quot; AND queue = &quot; + Consts.QUEUE_TYPE_LRN + &quot; LIMIT 1&quot;) != 0;</span>
    }

    /**
     * true if there are any new cards due.
     */
    public boolean newDue() {
<span class="nc bnc" id="L3123" title="All 2 branches missed.">        return mCol.getDb().queryScalar(&quot;SELECT 1 FROM cards WHERE did IN &quot; + _deckLimit() + &quot; AND queue = &quot; + Consts.QUEUE_TYPE_NEW + &quot; LIMIT 1&quot;) != 0;</span>
    }

    public boolean haveBuriedSiblings() {
<span class="nc" id="L3127">        return haveBuriedSiblings(mCol.getDecks().active());</span>
    }

    private boolean haveBuriedSiblings(@NonNull List&lt;Long&gt; allDecks) {
        // Refactored to allow querying an arbitrary deck
<span class="nc" id="L3132">        String sdids = Utils.ids2str(allDecks);</span>
<span class="nc" id="L3133">        int cnt = mCol.getDb().queryScalar(&quot;select 1 from cards where queue = &quot; + Consts.QUEUE_TYPE_SIBLING_BURIED + &quot; and did in &quot; + sdids + &quot; limit 1&quot;);</span>
<span class="nc bnc" id="L3134" title="All 22 branches missed.">        return (ListenerUtil.mutListener.listen(16893) ? (cnt &gt;= 0) : (ListenerUtil.mutListener.listen(16892) ? (cnt &lt;= 0) : (ListenerUtil.mutListener.listen(16891) ? (cnt &gt; 0) : (ListenerUtil.mutListener.listen(16890) ? (cnt &lt; 0) : (ListenerUtil.mutListener.listen(16889) ? (cnt == 0) : (cnt != 0))))));</span>
    }

    public boolean haveManuallyBuried() {
<span class="nc" id="L3138">        return haveManuallyBuried(mCol.getDecks().active());</span>
    }

    private boolean haveManuallyBuried(@NonNull List&lt;Long&gt; allDecks) {
        // Refactored to allow querying an arbitrary deck
<span class="nc" id="L3143">        String sdids = Utils.ids2str(allDecks);</span>
<span class="nc" id="L3144">        int cnt = mCol.getDb().queryScalar(&quot;select 1 from cards where queue = &quot; + Consts.QUEUE_TYPE_MANUALLY_BURIED + &quot; and did in &quot; + sdids + &quot; limit 1&quot;);</span>
<span class="nc bnc" id="L3145" title="All 22 branches missed.">        return (ListenerUtil.mutListener.listen(16898) ? (cnt &gt;= 0) : (ListenerUtil.mutListener.listen(16897) ? (cnt &lt;= 0) : (ListenerUtil.mutListener.listen(16896) ? (cnt &gt; 0) : (ListenerUtil.mutListener.listen(16895) ? (cnt &lt; 0) : (ListenerUtil.mutListener.listen(16894) ? (cnt == 0) : (cnt != 0))))));</span>
    }

    public boolean haveBuried() {
<span class="nc bnc" id="L3149" title="All 10 branches missed.">        return (ListenerUtil.mutListener.listen(16899) ? (haveManuallyBuried() &amp;&amp; haveBuriedSiblings()) : (haveManuallyBuried() || haveBuriedSiblings()));</span>
    }

    /**
     * Return the next interval for a card and ease as a string.
     *
     * For a given card and ease, this returns a string that shows when the card will be shown again when the
     * specific ease button (AGAIN, GOOD etc.) is touched. This uses unit symbols like “s” rather than names
     * (“second”), like Anki desktop.
     *
     * @param context The app context, used for localization
     * @param card The card being reviewed
     * @param ease The button number (easy, good etc.)
     * @return A string like “1 min” or “1.7 mo”
     */
    @NonNull
    public String nextIvlStr(@NonNull Context context, @NonNull Card card, @Consts.BUTTON_TYPE int ease) {
<span class="nc" id="L3166">        long ivl = nextIvl(card, ease);</span>
<span class="nc bnc" id="L3167" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16905)) {</span>
<span class="nc bnc" id="L3168" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(16904) ? (ivl &gt;= 0) : (ListenerUtil.mutListener.listen(16903) ? (ivl &lt;= 0) : (ListenerUtil.mutListener.listen(16902) ? (ivl &gt; 0) : (ListenerUtil.mutListener.listen(16901) ? (ivl &lt; 0) : (ListenerUtil.mutListener.listen(16900) ? (ivl != 0) : (ivl == 0))))))) {</span>
<span class="nc" id="L3169">                return context.getString(R.string.sched_end);</span>
            }
        }
<span class="nc" id="L3172">        String s = Utils.timeQuantityNextIvl(context, ivl);</span>
<span class="nc bnc" id="L3173" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16912)) {</span>
<span class="nc bnc" id="L3174" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(16910) ? (ivl &gt;= mCol.getConf().getInt(&quot;collapseTime&quot;)) : (ListenerUtil.mutListener.listen(16909) ? (ivl &lt;= mCol.getConf().getInt(&quot;collapseTime&quot;)) : (ListenerUtil.mutListener.listen(16908) ? (ivl &gt; mCol.getConf().getInt(&quot;collapseTime&quot;)) : (ListenerUtil.mutListener.listen(16907) ? (ivl != mCol.getConf().getInt(&quot;collapseTime&quot;)) : (ListenerUtil.mutListener.listen(16906) ? (ivl == mCol.getConf().getInt(&quot;collapseTime&quot;)) : (ivl &lt; mCol.getConf().getInt(&quot;collapseTime&quot;)))))))) {</span>
<span class="nc bnc" id="L3175" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16911)) {</span>
<span class="nc" id="L3176">                    s = context.getString(R.string.less_than_time, s);</span>
                }
            }
        }
<span class="nc" id="L3180">        return s;</span>
    }

    // Overriden
    protected long nextIvl(@NonNull Card card, @Consts.BUTTON_TYPE int ease) {
        // preview mode?
<span class="nc bnc" id="L3186" title="All 2 branches missed.">        if (_previewingCard(card)) {</span>
<span class="nc bnc" id="L3187" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(16917) ? (ease &gt;= Consts.BUTTON_ONE) : (ListenerUtil.mutListener.listen(16916) ? (ease &lt;= Consts.BUTTON_ONE) : (ListenerUtil.mutListener.listen(16915) ? (ease &gt; Consts.BUTTON_ONE) : (ListenerUtil.mutListener.listen(16914) ? (ease &lt; Consts.BUTTON_ONE) : (ListenerUtil.mutListener.listen(16913) ? (ease != Consts.BUTTON_ONE) : (ease == Consts.BUTTON_ONE))))))) {</span>
<span class="nc" id="L3188">                return _previewDelay(card);</span>
            }
<span class="nc" id="L3190">            return 0;</span>
        }
        // (re)learning?
<span class="nc bnc" id="L3193" title="All 226 branches missed.">        if ((ListenerUtil.mutListener.listen(16934) ? ((ListenerUtil.mutListener.listen(16928) ? ((ListenerUtil.mutListener.listen(16922) ? (card.getQueue() &gt;= Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(16921) ? (card.getQueue() &lt;= Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(16920) ? (card.getQueue() &gt; Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(16919) ? (card.getQueue() &lt; Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(16918) ? (card.getQueue() != Consts.QUEUE_TYPE_NEW) : (card.getQueue() == Consts.QUEUE_TYPE_NEW)))))) &amp;&amp; (ListenerUtil.mutListener.listen(16927) ? (card.getQueue() &gt;= Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(16926) ? (card.getQueue() &lt;= Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(16925) ? (card.getQueue() &gt; Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(16924) ? (card.getQueue() &lt; Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(16923) ? (card.getQueue() != Consts.QUEUE_TYPE_LRN) : (card.getQueue() == Consts.QUEUE_TYPE_LRN))))))) : ((ListenerUtil.mutListener.listen(16922) ? (card.getQueue() &gt;= Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(16921) ? (card.getQueue() &lt;= Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(16920) ? (card.getQueue() &gt; Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(16919) ? (card.getQueue() &lt; Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(16918) ? (card.getQueue() != Consts.QUEUE_TYPE_NEW) : (card.getQueue() == Consts.QUEUE_TYPE_NEW)))))) || (ListenerUtil.mutListener.listen(16927) ? (card.getQueue() &gt;= Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(16926) ? (card.getQueue() &lt;= Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(16925) ? (card.getQueue() &gt; Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(16924) ? (card.getQueue() &lt; Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(16923) ? (card.getQueue() != Consts.QUEUE_TYPE_LRN) : (card.getQueue() == Consts.QUEUE_TYPE_LRN)))))))) &amp;&amp; (ListenerUtil.mutListener.listen(16933) ? (card.getQueue() &gt;= Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(16932) ? (card.getQueue() &lt;= Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(16931) ? (card.getQueue() &gt; Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(16930) ? (card.getQueue() &lt; Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(16929) ? (card.getQueue() != Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (card.getQueue() == Consts.QUEUE_TYPE_DAY_LEARN_RELEARN))))))) : ((ListenerUtil.mutListener.listen(16928) ? ((ListenerUtil.mutListener.listen(16922) ? (card.getQueue() &gt;= Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(16921) ? (card.getQueue() &lt;= Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(16920) ? (card.getQueue() &gt; Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(16919) ? (card.getQueue() &lt; Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(16918) ? (card.getQueue() != Consts.QUEUE_TYPE_NEW) : (card.getQueue() == Consts.QUEUE_TYPE_NEW)))))) &amp;&amp; (ListenerUtil.mutListener.listen(16927) ? (card.getQueue() &gt;= Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(16926) ? (card.getQueue() &lt;= Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(16925) ? (card.getQueue() &gt; Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(16924) ? (card.getQueue() &lt; Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(16923) ? (card.getQueue() != Consts.QUEUE_TYPE_LRN) : (card.getQueue() == Consts.QUEUE_TYPE_LRN))))))) : ((ListenerUtil.mutListener.listen(16922) ? (card.getQueue() &gt;= Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(16921) ? (card.getQueue() &lt;= Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(16920) ? (card.getQueue() &gt; Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(16919) ? (card.getQueue() &lt; Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(16918) ? (card.getQueue() != Consts.QUEUE_TYPE_NEW) : (card.getQueue() == Consts.QUEUE_TYPE_NEW)))))) || (ListenerUtil.mutListener.listen(16927) ? (card.getQueue() &gt;= Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(16926) ? (card.getQueue() &lt;= Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(16925) ? (card.getQueue() &gt; Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(16924) ? (card.getQueue() &lt; Consts.QUEUE_TYPE_LRN) : (ListenerUtil.mutListener.listen(16923) ? (card.getQueue() != Consts.QUEUE_TYPE_LRN) : (card.getQueue() == Consts.QUEUE_TYPE_LRN)))))))) || (ListenerUtil.mutListener.listen(16933) ? (card.getQueue() &gt;= Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(16932) ? (card.getQueue() &lt;= Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(16931) ? (card.getQueue() &gt; Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(16930) ? (card.getQueue() &lt; Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(16929) ? (card.getQueue() != Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (card.getQueue() == Consts.QUEUE_TYPE_DAY_LEARN_RELEARN))))))))) {</span>
<span class="nc" id="L3194">            return _nextLrnIvl(card, ease);</span>
<span class="nc bnc" id="L3195" title="All 22 branches missed.">        } else if ((ListenerUtil.mutListener.listen(16939) ? (ease &gt;= Consts.BUTTON_ONE) : (ListenerUtil.mutListener.listen(16938) ? (ease &lt;= Consts.BUTTON_ONE) : (ListenerUtil.mutListener.listen(16937) ? (ease &gt; Consts.BUTTON_ONE) : (ListenerUtil.mutListener.listen(16936) ? (ease &lt; Consts.BUTTON_ONE) : (ListenerUtil.mutListener.listen(16935) ? (ease != Consts.BUTTON_ONE) : (ease == Consts.BUTTON_ONE))))))) {</span>
            // lapse
<span class="nc" id="L3197">            JSONObject conf = _lapseConf(card);</span>
<span class="nc bnc" id="L3198" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(16958) ? (conf.getJSONArray(&quot;delays&quot;).length() &gt;= 0) : (ListenerUtil.mutListener.listen(16957) ? (conf.getJSONArray(&quot;delays&quot;).length() &lt;= 0) : (ListenerUtil.mutListener.listen(16956) ? (conf.getJSONArray(&quot;delays&quot;).length() &lt; 0) : (ListenerUtil.mutListener.listen(16955) ? (conf.getJSONArray(&quot;delays&quot;).length() != 0) : (ListenerUtil.mutListener.listen(16954) ? (conf.getJSONArray(&quot;delays&quot;).length() == 0) : (conf.getJSONArray(&quot;delays&quot;).length() &gt; 0))))))) {</span>
<span class="nc bnc" id="L3199" title="All 8 branches missed.">                return (long) ((ListenerUtil.mutListener.listen(16962) ? (conf.getJSONArray(&quot;delays&quot;).getDouble(0) % 60.0) : (ListenerUtil.mutListener.listen(16961) ? (conf.getJSONArray(&quot;delays&quot;).getDouble(0) / 60.0) : (ListenerUtil.mutListener.listen(16960) ? (conf.getJSONArray(&quot;delays&quot;).getDouble(0) - 60.0) : (ListenerUtil.mutListener.listen(16959) ? (conf.getJSONArray(&quot;delays&quot;).getDouble(0) + 60.0) : (conf.getJSONArray(&quot;delays&quot;).getDouble(0) * 60.0))))));</span>
            }
<span class="nc bnc" id="L3201" title="All 8 branches missed.">            return (ListenerUtil.mutListener.listen(16966) ? (_lapseIvl(card, conf) % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16965) ? (_lapseIvl(card, conf) / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16964) ? (_lapseIvl(card, conf) - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16963) ? (_lapseIvl(card, conf) + SECONDS_PER_DAY) : (_lapseIvl(card, conf) * SECONDS_PER_DAY)))));</span>
        } else {
            // review
<span class="nc bnc" id="L3204" title="All 50 branches missed.">            boolean early = (ListenerUtil.mutListener.listen(16945) ? (card.isInDynamicDeck() || ((ListenerUtil.mutListener.listen(16944) ? (card.getODue() &gt;= mToday) : (ListenerUtil.mutListener.listen(16943) ? (card.getODue() &lt;= mToday) : (ListenerUtil.mutListener.listen(16942) ? (card.getODue() &lt; mToday) : (ListenerUtil.mutListener.listen(16941) ? (card.getODue() != mToday) : (ListenerUtil.mutListener.listen(16940) ? (card.getODue() == mToday) : (card.getODue() &gt; mToday)))))))) : (card.isInDynamicDeck() &amp;&amp; ((ListenerUtil.mutListener.listen(16944) ? (card.getODue() &gt;= mToday) : (ListenerUtil.mutListener.listen(16943) ? (card.getODue() &lt;= mToday) : (ListenerUtil.mutListener.listen(16942) ? (card.getODue() &lt; mToday) : (ListenerUtil.mutListener.listen(16941) ? (card.getODue() != mToday) : (ListenerUtil.mutListener.listen(16940) ? (card.getODue() == mToday) : (card.getODue() &gt; mToday)))))))));</span>
<span class="nc bnc" id="L3205" title="All 2 branches missed.">            if (early) {</span>
<span class="nc bnc" id="L3206" title="All 8 branches missed.">                return (ListenerUtil.mutListener.listen(16953) ? (_earlyReviewIvl(card, ease) % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16952) ? (_earlyReviewIvl(card, ease) / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16951) ? (_earlyReviewIvl(card, ease) - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16950) ? (_earlyReviewIvl(card, ease) + SECONDS_PER_DAY) : (_earlyReviewIvl(card, ease) * SECONDS_PER_DAY)))));</span>
            } else {
<span class="nc bnc" id="L3208" title="All 8 branches missed.">                return (ListenerUtil.mutListener.listen(16949) ? (_nextRevIvl(card, ease, false) % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16948) ? (_nextRevIvl(card, ease, false) / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16947) ? (_nextRevIvl(card, ease, false) - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(16946) ? (_nextRevIvl(card, ease, false) + SECONDS_PER_DAY) : (_nextRevIvl(card, ease, false) * SECONDS_PER_DAY)))));</span>
            }
        }
    }

    // Overriden
    protected long _nextLrnIvl(@NonNull Card card, @Consts.BUTTON_TYPE int ease) {
<span class="nc bnc" id="L3215" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(16973)) {</span>
<span class="nc bnc" id="L3216" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(16971) ? (card.getQueue() &gt;= Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(16970) ? (card.getQueue() &lt;= Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(16969) ? (card.getQueue() &gt; Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(16968) ? (card.getQueue() &lt; Consts.QUEUE_TYPE_NEW) : (ListenerUtil.mutListener.listen(16967) ? (card.getQueue() != Consts.QUEUE_TYPE_NEW) : (card.getQueue() == Consts.QUEUE_TYPE_NEW))))))) {</span>
<span class="nc bnc" id="L3217" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(16972)) {</span>
<span class="nc" id="L3218">                    card.setLeft(_startingLeft(card));</span>
                }
            }
        }
<span class="nc" id="L3222">        JSONObject conf = _lrnConf(card);</span>
<span class="nc bnc" id="L3223" title="All 22 branches missed.">        if ((ListenerUtil.mutListener.listen(16978) ? (ease &gt;= Consts.BUTTON_ONE) : (ListenerUtil.mutListener.listen(16977) ? (ease &lt;= Consts.BUTTON_ONE) : (ListenerUtil.mutListener.listen(16976) ? (ease &gt; Consts.BUTTON_ONE) : (ListenerUtil.mutListener.listen(16975) ? (ease &lt; Consts.BUTTON_ONE) : (ListenerUtil.mutListener.listen(16974) ? (ease != Consts.BUTTON_ONE) : (ease == Consts.BUTTON_ONE))))))) {</span>
            // fail
<span class="nc" id="L3225">            return _delayForGrade(conf, conf.getJSONArray(&quot;delays&quot;).length());</span>
<span class="nc bnc" id="L3226" title="All 22 branches missed.">        } else if ((ListenerUtil.mutListener.listen(16983) ? (ease &gt;= Consts.BUTTON_TWO) : (ListenerUtil.mutListener.listen(16982) ? (ease &lt;= Consts.BUTTON_TWO) : (ListenerUtil.mutListener.listen(16981) ? (ease &gt; Consts.BUTTON_TWO) : (ListenerUtil.mutListener.listen(16980) ? (ease &lt; Consts.BUTTON_TWO) : (ListenerUtil.mutListener.listen(16979) ? (ease != Consts.BUTTON_TWO) : (ease == Consts.BUTTON_TWO))))))) {</span>
<span class="nc" id="L3227">            return _delayForRepeatingGrade(conf, card.getLeft());</span>
<span class="nc bnc" id="L3228" title="All 22 branches missed.">        } else if ((ListenerUtil.mutListener.listen(16988) ? (ease &gt;= Consts.BUTTON_FOUR) : (ListenerUtil.mutListener.listen(16987) ? (ease &lt;= Consts.BUTTON_FOUR) : (ListenerUtil.mutListener.listen(16986) ? (ease &gt; Consts.BUTTON_FOUR) : (ListenerUtil.mutListener.listen(16985) ? (ease &lt; Consts.BUTTON_FOUR) : (ListenerUtil.mutListener.listen(16984) ? (ease != Consts.BUTTON_FOUR) : (ease == Consts.BUTTON_FOUR))))))) {</span>
<span class="nc bnc" id="L3229" title="All 8 branches missed.">            return (ListenerUtil.mutListener.listen(17009) ? (_graduatingIvl(card, conf, true, false) % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17008) ? (_graduatingIvl(card, conf, true, false) / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17007) ? (_graduatingIvl(card, conf, true, false) - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17006) ? (_graduatingIvl(card, conf, true, false) + SECONDS_PER_DAY) : (_graduatingIvl(card, conf, true, false) * SECONDS_PER_DAY)))));</span>
        } else {
            // ease == 3
<span class="nc bnc" id="L3232" title="All 48 branches missed.">            int left = (ListenerUtil.mutListener.listen(16996) ? ((ListenerUtil.mutListener.listen(16992) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16991) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16990) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16989) ? (card.getLeft() + 1000) : (card.getLeft() % 1000))))) % 1) : (ListenerUtil.mutListener.listen(16995) ? ((ListenerUtil.mutListener.listen(16992) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16991) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16990) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16989) ? (card.getLeft() + 1000) : (card.getLeft() % 1000))))) / 1) : (ListenerUtil.mutListener.listen(16994) ? ((ListenerUtil.mutListener.listen(16992) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16991) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16990) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16989) ? (card.getLeft() + 1000) : (card.getLeft() % 1000))))) * 1) : (ListenerUtil.mutListener.listen(16993) ? ((ListenerUtil.mutListener.listen(16992) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16991) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16990) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16989) ? (card.getLeft() + 1000) : (card.getLeft() % 1000))))) + 1) : ((ListenerUtil.mutListener.listen(16992) ? (card.getLeft() / 1000) : (ListenerUtil.mutListener.listen(16991) ? (card.getLeft() * 1000) : (ListenerUtil.mutListener.listen(16990) ? (card.getLeft() - 1000) : (ListenerUtil.mutListener.listen(16989) ? (card.getLeft() + 1000) : (card.getLeft() % 1000))))) - 1)))));</span>
<span class="nc bnc" id="L3233" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(17001) ? (left &gt;= 0) : (ListenerUtil.mutListener.listen(17000) ? (left &gt; 0) : (ListenerUtil.mutListener.listen(16999) ? (left &lt; 0) : (ListenerUtil.mutListener.listen(16998) ? (left != 0) : (ListenerUtil.mutListener.listen(16997) ? (left == 0) : (left &lt;= 0))))))) {</span>
                // graduate
<span class="nc bnc" id="L3235" title="All 8 branches missed.">                return (ListenerUtil.mutListener.listen(17005) ? (_graduatingIvl(card, conf, false, false) % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17004) ? (_graduatingIvl(card, conf, false, false) / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17003) ? (_graduatingIvl(card, conf, false, false) - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17002) ? (_graduatingIvl(card, conf, false, false) + SECONDS_PER_DAY) : (_graduatingIvl(card, conf, false, false) * SECONDS_PER_DAY)))));</span>
            } else {
<span class="nc" id="L3237">                return _delayForGrade(conf, left);</span>
            }
        }
    }

    /**
     * learning and relearning cards may be seconds-based or day-based;
     * other types map directly to queues
     *
     * Overriden: in V1, queue becomes type.
     */
    @NonNull
    protected String _restoreQueueSnippet() {
<span class="nc" id="L3250">        return &quot;queue = (case when type in (&quot; + Consts.CARD_TYPE_LRN + &quot;,&quot; + Consts.CARD_TYPE_RELEARNING + &quot;) then\n&quot; + &quot;  (case when (case when odue then odue else due end) &gt; 1000000000 then 1 else &quot; + Consts.QUEUE_TYPE_DAY_LEARN_RELEARN + &quot; end)\n&quot; + &quot;else\n&quot; + &quot;  type\n&quot; + &quot;end)  &quot;;</span>
    }

    /**
     * ugly fix for suspended cards being unsuspended when filtered deck emptied
     * https://github.com/ankitects/anki/commit/fe493e31c4d73ae2bbd0c4d8c6b835974c0e290c
     */
    @NonNull
    protected String _restoreQueueWhenEmptyingSnippet() {
<span class="nc" id="L3259">        return &quot;queue = (case when queue &lt; 0 then queue&quot; + &quot;    when type in (1,&quot; + CARD_TYPE_RELEARNING + &quot;) then &quot; + &quot;(case when (case when odue then odue else due end) &gt; 1000000000 then 1 else &quot; + &quot;    &quot; + QUEUE_TYPE_DAY_LEARN_RELEARN + &quot; end) &quot; + &quot;else &quot; + &quot;    type &quot; + &quot;end)&quot;;</span>
    }

    /**
     * Overridden: in V1 only sibling buried exits.
     */
    @NonNull
    protected String queueIsBuriedSnippet() {
<span class="nc" id="L3267">        return &quot; queue in (&quot; + Consts.QUEUE_TYPE_SIBLING_BURIED + &quot;, &quot; + Consts.QUEUE_TYPE_MANUALLY_BURIED + &quot;) &quot;;</span>
    }

    /**
     * Suspend cards.
     *
     * Overridden: in V1 remove from dyn and lrn
     */
    public void suspendCards(@NonNull long[] ids) {
<span class="nc bnc" id="L3276" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17010)) {</span>
<span class="nc" id="L3277">            mCol.log(ids);</span>
        }
<span class="nc bnc" id="L3279" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17011)) {</span>
<span class="nc" id="L3280">            mCol.getDb().execute(&quot;UPDATE cards SET queue = &quot; + Consts.QUEUE_TYPE_SUSPENDED + &quot;, mod = ?, usn = ? WHERE id IN &quot; + Utils.ids2str(ids), getTime().intTime(), mCol.usn());</span>
        }
<span class="nc" id="L3282">    }</span>

    /**
     * Unsuspend cards
     */
    public void unsuspendCards(@NonNull long[] ids) {
<span class="nc bnc" id="L3288" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17012)) {</span>
<span class="nc" id="L3289">            mCol.log(ids);</span>
        }
<span class="nc bnc" id="L3291" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17013)) {</span>
<span class="nc" id="L3292">            mCol.getDb().execute(&quot;UPDATE cards SET &quot; + _restoreQueueSnippet() + &quot;, mod = ?, usn = ?&quot; + &quot; WHERE queue = &quot; + Consts.QUEUE_TYPE_SUSPENDED + &quot; AND id IN &quot; + Utils.ids2str(ids), getTime().intTime(), mCol.usn());</span>
        }
<span class="nc" id="L3294">    }</span>

    // Overriden. manual is false by default in V1
    public void buryCards(@NonNull long[] cids) {
<span class="nc bnc" id="L3298" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17014)) {</span>
<span class="nc" id="L3299">            buryCards(cids, true);</span>
        }
<span class="nc" id="L3301">    }</span>

    @Override
    // Overriden: V1 also remove from dyns and lrn
    @VisibleForTesting
    public void buryCards(@NonNull long[] cids, boolean manual) {
<span class="nc bnc" id="L3307" title="All 2 branches missed.">        int queue = manual ? Consts.QUEUE_TYPE_MANUALLY_BURIED : Consts.QUEUE_TYPE_SIBLING_BURIED;</span>
<span class="nc bnc" id="L3308" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17015)) {</span>
<span class="nc" id="L3309">            mCol.log(cids);</span>
        }
<span class="nc bnc" id="L3311" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17016)) {</span>
<span class="nc" id="L3312">            mCol.getDb().execute(&quot;update cards set queue=?,mod=?,usn=? where id in &quot; + Utils.ids2str(cids), queue, getTime().intTime(), mCol.usn());</span>
        }
<span class="nc" id="L3314">    }</span>

    /**
     * Unbury all buried cards in all decks
     * Overriden: V1 change lastUnburied
     */
    public void unburyCards() {
<span class="nc bnc" id="L3321" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17017)) {</span>
<span class="nc" id="L3322">            mCol.log(mCol.getDb().queryLongList(&quot;select id from cards where &quot; + queueIsBuriedSnippet()));</span>
        }
<span class="nc bnc" id="L3324" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17018)) {</span>
<span class="nc" id="L3325">            mCol.getDb().execute(&quot;update cards set &quot; + _restoreQueueSnippet() + &quot; where &quot; + queueIsBuriedSnippet());</span>
        }
<span class="nc" id="L3327">    }</span>

    // Overridden
    public void unburyCardsForDeck() {
<span class="nc bnc" id="L3331" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17019)) {</span>
<span class="nc" id="L3332">            unburyCardsForDeck(ALL);</span>
        }
<span class="nc" id="L3334">    }</span>

    public void unburyCardsForDeck(@NonNull UnburyType type) {
<span class="nc bnc" id="L3337" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17020)) {</span>
<span class="nc" id="L3338">            unburyCardsForDeck(type, null);</span>
        }
<span class="nc" id="L3340">    }</span>

    public void unburyCardsForDeck(@NonNull UnburyType type, @Nullable List&lt;Long&gt; allDecks) {
        String queue;
<span class="nc bnc" id="L3344" title="All 4 branches missed.">        switch(type) {</span>
            case ALL:
<span class="nc" id="L3346">                queue = queueIsBuriedSnippet();</span>
<span class="nc" id="L3347">                break;</span>
            case MANUAL:
<span class="nc" id="L3349">                queue = &quot;queue = &quot; + Consts.QUEUE_TYPE_MANUALLY_BURIED;</span>
<span class="nc" id="L3350">                break;</span>
            case SIBLINGS:
<span class="nc" id="L3352">                queue = &quot;queue = &quot; + Consts.QUEUE_TYPE_SIBLING_BURIED;</span>
<span class="nc" id="L3353">                break;</span>
            default:
<span class="nc" id="L3355">                throw new RuntimeException(&quot;unknown type&quot;);</span>
        }
<span class="nc bnc" id="L3357" title="All 2 branches missed.">        String sids = Utils.ids2str(allDecks != null ? allDecks : mCol.getDecks().active());</span>
<span class="nc bnc" id="L3358" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17021)) {</span>
<span class="nc" id="L3359">            mCol.log(mCol.getDb().queryLongList(&quot;select id from cards where &quot; + queue + &quot; and did in &quot; + sids));</span>
        }
<span class="nc bnc" id="L3361" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17022)) {</span>
<span class="nc" id="L3362">            mCol.getDb().execute(&quot;update cards set mod=?,usn=?, &quot; + _restoreQueueSnippet() + &quot; where &quot; + queue + &quot; and did in &quot; + sids, getTime().intTime(), mCol.usn());</span>
        }
<span class="nc" id="L3364">    }</span>

    /**
     * Bury all cards for note until next session.
     * @param nid The id of the targeted note.
     */
    public void buryNote(long nid) {
<span class="nc" id="L3371">        long[] cids = Utils.collection2Array(mCol.getDb().queryLongList(&quot;SELECT id FROM cards WHERE nid = ? AND queue &gt;= &quot; + Consts.CARD_TYPE_NEW, nid));</span>
<span class="nc bnc" id="L3372" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17023)) {</span>
<span class="nc" id="L3373">            buryCards(cids);</span>
        }
<span class="nc" id="L3375">    }</span>

    protected void _burySiblings(@NonNull Card card) {
<span class="fc" id="L3378">        ArrayList&lt;Long&gt; toBury = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L3379">        JSONObject nconf = _newConf(card);</span>
<span class="fc" id="L3380">        boolean buryNew = nconf.optBoolean(&quot;bury&quot;, true);</span>
<span class="fc" id="L3381">        JSONObject rconf = _revConf(card);</span>
<span class="fc" id="L3382">        boolean buryRev = rconf.optBoolean(&quot;bury&quot;, true);</span>
        // loop through and remove from queues
<span class="fc" id="L3384">        try (Cursor cur = mCol.getDb().query(&quot;select id, queue from cards where nid=? and id!=? &quot; + &quot;and (queue=&quot; + Consts.QUEUE_TYPE_NEW + &quot; or (queue=&quot; + Consts.QUEUE_TYPE_REV + &quot; and due&lt;=?))&quot;, card.getNid(), card.getId(), mToday)) {</span>
<span class="pc bpc" id="L3385" title="1 of 2 branches missed.">            if (!ListenerUtil.mutListener.listen(17034)) {</span>
                {
<span class="fc" id="L3387">                    long _loopCounter323 = 0;</span>
<span class="pc bpc" id="L3388" title="1 of 2 branches missed.">                    while (cur.moveToNext()) {</span>
<span class="nc" id="L3389">                        ListenerUtil.loopListener.listen(&quot;_loopCounter323&quot;, ++_loopCounter323);</span>
<span class="nc" id="L3390">                        long cid = cur.getLong(0);</span>
<span class="nc" id="L3391">                        int queue = cur.getInt(1);</span>
                        SimpleCardQueue queue_object;
<span class="nc bnc" id="L3393" title="All 22 branches missed.">                        if ((ListenerUtil.mutListener.listen(17028) ? (queue &gt;= Consts.QUEUE_TYPE_REV) : (ListenerUtil.mutListener.listen(17027) ? (queue &lt;= Consts.QUEUE_TYPE_REV) : (ListenerUtil.mutListener.listen(17026) ? (queue &gt; Consts.QUEUE_TYPE_REV) : (ListenerUtil.mutListener.listen(17025) ? (queue &lt; Consts.QUEUE_TYPE_REV) : (ListenerUtil.mutListener.listen(17024) ? (queue != Consts.QUEUE_TYPE_REV) : (queue == Consts.QUEUE_TYPE_REV))))))) {</span>
<span class="nc" id="L3394">                            queue_object = mRevQueue;</span>
<span class="nc bnc" id="L3395" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(17032)) {</span>
<span class="nc bnc" id="L3396" title="All 2 branches missed.">                                if (buryRev) {</span>
<span class="nc bnc" id="L3397" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(17031)) {</span>
<span class="nc" id="L3398">                                        toBury.add(cid);</span>
                                    }
                                }
                            }
                        } else {
<span class="nc" id="L3403">                            queue_object = mNewQueue;</span>
<span class="nc bnc" id="L3404" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(17030)) {</span>
<span class="nc bnc" id="L3405" title="All 2 branches missed.">                                if (buryNew) {</span>
<span class="nc bnc" id="L3406" title="All 2 branches missed.">                                    if (!ListenerUtil.mutListener.listen(17029)) {</span>
<span class="nc" id="L3407">                                        toBury.add(cid);</span>
                                    }
                                }
                            }
                        }
<span class="nc bnc" id="L3412" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(17033)) {</span>
                            // same-day spacing
<span class="nc" id="L3414">                            queue_object.remove(cid);</span>
                        }
<span class="nc" id="L3416">                    }</span>
                }
            }
        }
<span class="pc bpc" id="L3420" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17036)) {</span>
            // then bury
<span class="pc bpc" id="L3422" title="1 of 2 branches missed.">            if (!toBury.isEmpty()) {</span>
<span class="nc bnc" id="L3423" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(17035)) {</span>
<span class="nc" id="L3424">                    buryCards(Utils.collection2Array(toBury), false);</span>
                }
            }
        }
<span class="fc" id="L3428">    }</span>

    /**
     * Put cards at the end of the new queue.
     */
    public void forgetCards(@NonNull List&lt;Long&gt; ids) {
<span class="nc bnc" id="L3434" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17037)) {</span>
<span class="nc" id="L3435">            remFromDyn(ids);</span>
        }
<span class="nc bnc" id="L3437" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17038)) {</span>
<span class="nc" id="L3438">            mCol.getDb().execute(&quot;update cards set type=&quot; + Consts.CARD_TYPE_NEW + &quot;,queue=&quot; + Consts.QUEUE_TYPE_NEW + &quot;,ivl=0,due=0,odue=0,factor=&quot; + Consts.STARTING_FACTOR + &quot; where id in &quot; + Utils.ids2str(ids));</span>
        }
<span class="nc" id="L3440">        int pmax = mCol.getDb().queryScalar(&quot;SELECT max(due) FROM cards WHERE type=&quot; + Consts.CARD_TYPE_NEW + &quot;&quot;);</span>
<span class="nc bnc" id="L3441" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17043)) {</span>
            // takes care of mod + usn
<span class="nc bnc" id="L3443" title="All 8 branches missed.">            sortCards(ids, (ListenerUtil.mutListener.listen(17042) ? (pmax % 1) : (ListenerUtil.mutListener.listen(17041) ? (pmax / 1) : (ListenerUtil.mutListener.listen(17040) ? (pmax * 1) : (ListenerUtil.mutListener.listen(17039) ? (pmax - 1) : (pmax + 1))))));</span>
        }
<span class="nc bnc" id="L3445" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17044)) {</span>
<span class="nc" id="L3446">            mCol.log(ids);</span>
        }
<span class="nc" id="L3448">    }</span>

    /**
     * Put cards in review queue with a new interval in days (min, max).
     *
     * @param ids The list of card ids to be affected
     * @param imin the minimum interval (inclusive)
     * @param imax The maximum interval (inclusive)
     */
    public void reschedCards(@NonNull List&lt;Long&gt; ids, int imin, int imax) {
<span class="nc" id="L3458">        ArrayList&lt;Object[]&gt; d = new ArrayList&lt;&gt;(ids.size());</span>
<span class="nc" id="L3459">        int t = mToday;</span>
<span class="nc" id="L3460">        long mod = getTime().intTime();</span>
<span class="nc" id="L3461">        Random rnd = new Random();</span>
<span class="nc bnc" id="L3462" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17062)) {</span>
            {
<span class="nc" id="L3464">                long _loopCounter324 = 0;</span>
<span class="nc bnc" id="L3465" title="All 2 branches missed.">                for (long id : ids) {</span>
<span class="nc" id="L3466">                    ListenerUtil.loopListener.listen(&quot;_loopCounter324&quot;, ++_loopCounter324);</span>
<span class="nc bnc" id="L3467" title="All 248 branches missed.">                    int r = (ListenerUtil.mutListener.listen(17056) ? (rnd.nextInt((ListenerUtil.mutListener.listen(17052) ? ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) % 1) : (ListenerUtil.mutListener.listen(17051) ? ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) / 1) : (ListenerUtil.mutListener.listen(17050) ? ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) * 1) : (ListenerUtil.mutListener.listen(17049) ? ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) - 1) : ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) + 1)))))) % imin) : (ListenerUtil.mutListener.listen(17055) ? (rnd.nextInt((ListenerUtil.mutListener.listen(17052) ? ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) % 1) : (ListenerUtil.mutListener.listen(17051) ? ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) / 1) : (ListenerUtil.mutListener.listen(17050) ? ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) * 1) : (ListenerUtil.mutListener.listen(17049) ? ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) - 1) : ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) + 1)))))) / imin) : (ListenerUtil.mutListener.listen(17054) ? (rnd.nextInt((ListenerUtil.mutListener.listen(17052) ? ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) % 1) : (ListenerUtil.mutListener.listen(17051) ? ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) / 1) : (ListenerUtil.mutListener.listen(17050) ? ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) * 1) : (ListenerUtil.mutListener.listen(17049) ? ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) - 1) : ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) + 1)))))) * imin) : (ListenerUtil.mutListener.listen(17053) ? (rnd.nextInt((ListenerUtil.mutListener.listen(17052) ? ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) % 1) : (ListenerUtil.mutListener.listen(17051) ? ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) / 1) : (ListenerUtil.mutListener.listen(17050) ? ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) * 1) : (ListenerUtil.mutListener.listen(17049) ? ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) - 1) : ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) + 1)))))) - imin) : (rnd.nextInt((ListenerUtil.mutListener.listen(17052) ? ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) % 1) : (ListenerUtil.mutListener.listen(17051) ? ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) / 1) : (ListenerUtil.mutListener.listen(17050) ? ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) * 1) : (ListenerUtil.mutListener.listen(17049) ? ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) - 1) : ((ListenerUtil.mutListener.listen(17048) ? (imax % imin) : (ListenerUtil.mutListener.listen(17047) ? (imax / imin) : (ListenerUtil.mutListener.listen(17046) ? (imax * imin) : (ListenerUtil.mutListener.listen(17045) ? (imax + imin) : (imax - imin))))) + 1)))))) + imin)))));</span>
<span class="nc bnc" id="L3468" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(17061)) {</span>
<span class="nc bnc" id="L3469" title="All 8 branches missed.">                        d.add(new Object[] { Math.max(1, r), (ListenerUtil.mutListener.listen(17060) ? (r % t) : (ListenerUtil.mutListener.listen(17059) ? (r / t) : (ListenerUtil.mutListener.listen(17058) ? (r * t) : (ListenerUtil.mutListener.listen(17057) ? (r - t) : (r + t))))), mCol.usn(), mod, RESCHEDULE_FACTOR, id });</span>
                    }
<span class="nc" id="L3471">                }</span>
            }
        }
<span class="nc bnc" id="L3474" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17063)) {</span>
<span class="nc" id="L3475">            remFromDyn(ids);</span>
        }
<span class="nc bnc" id="L3477" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17064)) {</span>
<span class="nc" id="L3478">            mCol.getDb().executeMany(&quot;update cards set type=&quot; + Consts.CARD_TYPE_REV + &quot;,queue=&quot; + Consts.QUEUE_TYPE_REV + &quot;,ivl=?,due=?,odue=0, &quot; + &quot;usn=?,mod=?,factor=? where id=?&quot;, d);</span>
        }
<span class="nc bnc" id="L3480" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17065)) {</span>
<span class="nc" id="L3481">            mCol.log(ids);</span>
        }
<span class="nc" id="L3483">    }</span>

    /**
     * Completely reset cards for export.
     */
    public void resetCards(@NonNull Long[] ids) {
<span class="nc" id="L3489">        List&lt;Long&gt; nonNew = mCol.getDb().queryLongList(&quot;select id from cards where id in &quot; + Utils.ids2str(ids) + &quot; and (queue != &quot; + Consts.QUEUE_TYPE_NEW + &quot; or type != &quot; + Consts.CARD_TYPE_NEW + &quot;)&quot;);</span>
<span class="nc bnc" id="L3490" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17066)) {</span>
<span class="nc" id="L3491">            mCol.getDb().execute(&quot;update cards set reps=0, lapses=0 where id in &quot; + Utils.ids2str(nonNew));</span>
        }
<span class="nc bnc" id="L3493" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17067)) {</span>
<span class="nc" id="L3494">            forgetCards(nonNew);</span>
        }
<span class="nc bnc" id="L3496" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17068)) {</span>
            // Cast useful to indicate to indicate how to interpret varargs
<span class="nc" id="L3498">            mCol.log((Object[]) ids);</span>
        }
<span class="nc" id="L3500">    }</span>

    public void sortCards(@NonNull List&lt;Long&gt; cids, int start) {
<span class="nc bnc" id="L3503" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17069)) {</span>
<span class="nc" id="L3504">            sortCards(cids, start, 1, false, false);</span>
        }
<span class="nc" id="L3506">    }</span>

    public void sortCards(@NonNull List&lt;Long&gt; cids, int start, int step, boolean shuffle, boolean shift) {
<span class="nc" id="L3509">        String scids = Utils.ids2str(cids);</span>
<span class="nc" id="L3510">        long now = getTime().intTime();</span>
<span class="nc" id="L3511">        ArrayList&lt;Long&gt; nids = new ArrayList&lt;&gt;(cids.size());</span>
<span class="nc bnc" id="L3512" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17072)) {</span>
            {
<span class="nc" id="L3514">                long _loopCounter325 = 0;</span>
<span class="nc bnc" id="L3515" title="All 2 branches missed.">                for (long id : cids) {</span>
<span class="nc" id="L3516">                    ListenerUtil.loopListener.listen(&quot;_loopCounter325&quot;, ++_loopCounter325);</span>
<span class="nc" id="L3517">                    long nid = mCol.getDb().queryLongScalar(&quot;SELECT nid FROM cards WHERE id = ?&quot;, id);</span>
<span class="nc bnc" id="L3518" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(17071)) {</span>
<span class="nc bnc" id="L3519" title="All 2 branches missed.">                        if (!nids.contains(nid)) {</span>
<span class="nc bnc" id="L3520" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(17070)) {</span>
<span class="nc" id="L3521">                                nids.add(nid);</span>
                            }
                        }
                    }
<span class="nc" id="L3525">                }</span>
            }
        }
<span class="nc bnc" id="L3528" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17073)) {</span>
<span class="nc bnc" id="L3529" title="All 2 branches missed.">            if (nids.isEmpty()) {</span>
                // no new cards
<span class="nc" id="L3531">                return;</span>
            }
        }
        // determine nid ordering
<span class="nc" id="L3535">        HashMap&lt;Long, Long&gt; due = new HashMap&lt;&gt;(nids.size());</span>
<span class="nc bnc" id="L3536" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17075)) {</span>
<span class="nc bnc" id="L3537" title="All 2 branches missed.">            if (shuffle) {</span>
<span class="nc bnc" id="L3538" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(17074)) {</span>
<span class="nc" id="L3539">                    Collections.shuffle(nids);</span>
                }
            }
        }
<span class="nc bnc" id="L3543" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17090)) {</span>
            {
<span class="nc" id="L3545">                long _loopCounter326 = 0;</span>
<span class="nc bnc" id="L3546" title="All 22 branches missed.">                for (int c = 0; (ListenerUtil.mutListener.listen(17089) ? (c &gt;= nids.size()) : (ListenerUtil.mutListener.listen(17088) ? (c &lt;= nids.size()) : (ListenerUtil.mutListener.listen(17087) ? (c &gt; nids.size()) : (ListenerUtil.mutListener.listen(17086) ? (c != nids.size()) : (ListenerUtil.mutListener.listen(17085) ? (c == nids.size()) : (c &lt; nids.size())))))); c++) {</span>
<span class="nc" id="L3547">                    ListenerUtil.loopListener.listen(&quot;_loopCounter326&quot;, ++_loopCounter326);</span>
<span class="nc bnc" id="L3548" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(17084)) {</span>
<span class="nc bnc" id="L3549" title="All 48 branches missed.">                        due.put(nids.get(c), (long) ((ListenerUtil.mutListener.listen(17083) ? (start % (ListenerUtil.mutListener.listen(17079) ? (c % step) : (ListenerUtil.mutListener.listen(17078) ? (c / step) : (ListenerUtil.mutListener.listen(17077) ? (c - step) : (ListenerUtil.mutListener.listen(17076) ? (c + step) : (c * step)))))) : (ListenerUtil.mutListener.listen(17082) ? (start / (ListenerUtil.mutListener.listen(17079) ? (c % step) : (ListenerUtil.mutListener.listen(17078) ? (c / step) : (ListenerUtil.mutListener.listen(17077) ? (c - step) : (ListenerUtil.mutListener.listen(17076) ? (c + step) : (c * step)))))) : (ListenerUtil.mutListener.listen(17081) ? (start * (ListenerUtil.mutListener.listen(17079) ? (c % step) : (ListenerUtil.mutListener.listen(17078) ? (c / step) : (ListenerUtil.mutListener.listen(17077) ? (c - step) : (ListenerUtil.mutListener.listen(17076) ? (c + step) : (c * step)))))) : (ListenerUtil.mutListener.listen(17080) ? (start - (ListenerUtil.mutListener.listen(17079) ? (c % step) : (ListenerUtil.mutListener.listen(17078) ? (c / step) : (ListenerUtil.mutListener.listen(17077) ? (c - step) : (ListenerUtil.mutListener.listen(17076) ? (c + step) : (c * step)))))) : (start + (ListenerUtil.mutListener.listen(17079) ? (c % step) : (ListenerUtil.mutListener.listen(17078) ? (c / step) : (ListenerUtil.mutListener.listen(17077) ? (c - step) : (ListenerUtil.mutListener.listen(17076) ? (c + step) : (c * step))))))))))));</span>
                    }
                }
            }
        }
<span class="nc bnc" id="L3554" title="All 248 branches missed.">        int high = (ListenerUtil.mutListener.listen(17102) ? (start % (ListenerUtil.mutListener.listen(17098) ? (step % ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1))))))) : (ListenerUtil.mutListener.listen(17097) ? (step / ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1))))))) : (ListenerUtil.mutListener.listen(17096) ? (step - ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1))))))) : (ListenerUtil.mutListener.listen(17095) ? (step + ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1))))))) : (step * ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1)))))))))))) : (ListenerUtil.mutListener.listen(17101) ? (start / (ListenerUtil.mutListener.listen(17098) ? (step % ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1))))))) : (ListenerUtil.mutListener.listen(17097) ? (step / ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1))))))) : (ListenerUtil.mutListener.listen(17096) ? (step - ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1))))))) : (ListenerUtil.mutListener.listen(17095) ? (step + ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1))))))) : (step * ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1)))))))))))) : (ListenerUtil.mutListener.listen(17100) ? (start * (ListenerUtil.mutListener.listen(17098) ? (step % ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1))))))) : (ListenerUtil.mutListener.listen(17097) ? (step / ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1))))))) : (ListenerUtil.mutListener.listen(17096) ? (step - ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1))))))) : (ListenerUtil.mutListener.listen(17095) ? (step + ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1))))))) : (step * ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1)))))))))))) : (ListenerUtil.mutListener.listen(17099) ? (start - (ListenerUtil.mutListener.listen(17098) ? (step % ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1))))))) : (ListenerUtil.mutListener.listen(17097) ? (step / ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1))))))) : (ListenerUtil.mutListener.listen(17096) ? (step - ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1))))))) : (ListenerUtil.mutListener.listen(17095) ? (step + ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1))))))) : (step * ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1)))))))))))) : (start + (ListenerUtil.mutListener.listen(17098) ? (step % ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1))))))) : (ListenerUtil.mutListener.listen(17097) ? (step / ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1))))))) : (ListenerUtil.mutListener.listen(17096) ? (step - ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1))))))) : (ListenerUtil.mutListener.listen(17095) ? (step + ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1))))))) : (step * ((ListenerUtil.mutListener.listen(17094) ? (nids.size() % 1) : (ListenerUtil.mutListener.listen(17093) ? (nids.size() / 1) : (ListenerUtil.mutListener.listen(17092) ? (nids.size() * 1) : (ListenerUtil.mutListener.listen(17091) ? (nids.size() + 1) : (nids.size() - 1))))))))))))))));</span>
<span class="nc bnc" id="L3555" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17118)) {</span>
            // shift?
<span class="nc bnc" id="L3557" title="All 2 branches missed.">            if (shift) {</span>
<span class="nc" id="L3558">                int low = mCol.getDb().queryScalar(&quot;SELECT min(due) FROM cards WHERE due &gt;= ? AND type = &quot; + Consts.CARD_TYPE_NEW + &quot; AND id NOT IN &quot; + scids, start);</span>
<span class="nc bnc" id="L3559" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(17117)) {</span>
<span class="nc bnc" id="L3560" title="All 22 branches missed.">                    if ((ListenerUtil.mutListener.listen(17107) ? (low &gt;= 0) : (ListenerUtil.mutListener.listen(17106) ? (low &lt;= 0) : (ListenerUtil.mutListener.listen(17105) ? (low &gt; 0) : (ListenerUtil.mutListener.listen(17104) ? (low &lt; 0) : (ListenerUtil.mutListener.listen(17103) ? (low == 0) : (low != 0))))))) {</span>
<span class="nc bnc" id="L3561" title="All 48 branches missed.">                        int shiftby = (ListenerUtil.mutListener.listen(17115) ? ((ListenerUtil.mutListener.listen(17111) ? (high % low) : (ListenerUtil.mutListener.listen(17110) ? (high / low) : (ListenerUtil.mutListener.listen(17109) ? (high * low) : (ListenerUtil.mutListener.listen(17108) ? (high + low) : (high - low))))) % 1) : (ListenerUtil.mutListener.listen(17114) ? ((ListenerUtil.mutListener.listen(17111) ? (high % low) : (ListenerUtil.mutListener.listen(17110) ? (high / low) : (ListenerUtil.mutListener.listen(17109) ? (high * low) : (ListenerUtil.mutListener.listen(17108) ? (high + low) : (high - low))))) / 1) : (ListenerUtil.mutListener.listen(17113) ? ((ListenerUtil.mutListener.listen(17111) ? (high % low) : (ListenerUtil.mutListener.listen(17110) ? (high / low) : (ListenerUtil.mutListener.listen(17109) ? (high * low) : (ListenerUtil.mutListener.listen(17108) ? (high + low) : (high - low))))) * 1) : (ListenerUtil.mutListener.listen(17112) ? ((ListenerUtil.mutListener.listen(17111) ? (high % low) : (ListenerUtil.mutListener.listen(17110) ? (high / low) : (ListenerUtil.mutListener.listen(17109) ? (high * low) : (ListenerUtil.mutListener.listen(17108) ? (high + low) : (high - low))))) - 1) : ((ListenerUtil.mutListener.listen(17111) ? (high % low) : (ListenerUtil.mutListener.listen(17110) ? (high / low) : (ListenerUtil.mutListener.listen(17109) ? (high * low) : (ListenerUtil.mutListener.listen(17108) ? (high + low) : (high - low))))) + 1)))));</span>
<span class="nc bnc" id="L3562" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(17116)) {</span>
<span class="nc" id="L3563">                            mCol.getDb().execute(&quot;UPDATE cards SET mod = ?, usn = ?, due = due + ?&quot; + &quot; WHERE id NOT IN &quot; + scids + &quot; AND due &gt;= ? AND queue = &quot; + Consts.QUEUE_TYPE_NEW, now, mCol.usn(), shiftby, low);</span>
                        }
                    }
                }
            }
        }
        // reorder cards
<span class="nc" id="L3570">        ArrayList&lt;Object[]&gt; d = new ArrayList&lt;&gt;(cids.size());</span>
<span class="nc" id="L3571">        try (Cursor cur = mCol.getDb().query(&quot;SELECT id, nid FROM cards WHERE type = &quot; + Consts.CARD_TYPE_NEW + &quot; AND id IN &quot; + scids)) {</span>
<span class="nc bnc" id="L3572" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(17120)) {</span>
                {
<span class="nc" id="L3574">                    long _loopCounter327 = 0;</span>
<span class="nc bnc" id="L3575" title="All 2 branches missed.">                    while (cur.moveToNext()) {</span>
<span class="nc" id="L3576">                        ListenerUtil.loopListener.listen(&quot;_loopCounter327&quot;, ++_loopCounter327);</span>
<span class="nc" id="L3577">                        long nid = cur.getLong(1);</span>
<span class="nc bnc" id="L3578" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(17119)) {</span>
<span class="nc" id="L3579">                            d.add(new Object[] { due.get(nid), now, mCol.usn(), cur.getLong(0) });</span>
                        }
<span class="nc" id="L3581">                    }</span>
                }
            }
        }
<span class="nc bnc" id="L3585" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17121)) {</span>
<span class="nc" id="L3586">            mCol.getDb().executeMany(&quot;UPDATE cards SET due = ?, mod = ?, usn = ? WHERE id = ?&quot;, d);</span>
        }
<span class="nc" id="L3588">    }</span>

    public void randomizeCards(long did) {
<span class="nc" id="L3591">        List&lt;Long&gt; cids = mCol.getDb().queryLongList(&quot;select id from cards where did = ?&quot;, did);</span>
<span class="nc bnc" id="L3592" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17122)) {</span>
<span class="nc" id="L3593">            sortCards(cids, 1, 1, true, false);</span>
        }
<span class="nc" id="L3595">    }</span>

    public void orderCards(long did) {
<span class="nc" id="L3598">        List&lt;Long&gt; cids = mCol.getDb().queryLongList(&quot;SELECT id FROM cards WHERE did = ? ORDER BY nid&quot;, did);</span>
<span class="nc bnc" id="L3599" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17123)) {</span>
<span class="nc" id="L3600">            sortCards(cids, 1, 1, false, false);</span>
        }
<span class="nc" id="L3602">    }</span>

    public void resortConf(@NonNull DeckConfig conf) {
<span class="nc" id="L3605">        List&lt;Long&gt; dids = mCol.getDecks().didsForConf(conf);</span>
<span class="nc bnc" id="L3606" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17127)) {</span>
            {
<span class="nc" id="L3608">                long _loopCounter328 = 0;</span>
<span class="nc bnc" id="L3609" title="All 2 branches missed.">                for (long did : dids) {</span>
<span class="nc" id="L3610">                    ListenerUtil.loopListener.listen(&quot;_loopCounter328&quot;, ++_loopCounter328);</span>
<span class="nc bnc" id="L3611" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(17126)) {</span>
<span class="nc bnc" id="L3612" title="All 2 branches missed.">                        if (conf.getJSONObject(&quot;new&quot;).getLong(&quot;order&quot;) == 0) {</span>
<span class="nc bnc" id="L3613" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(17125)) {</span>
<span class="nc" id="L3614">                                randomizeCards(did);</span>
                            }
                        } else {
<span class="nc bnc" id="L3617" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(17124)) {</span>
<span class="nc" id="L3618">                                orderCards(did);</span>
                            }
                        }
                    }
<span class="nc" id="L3622">                }</span>
            }
        }
<span class="nc" id="L3625">    }</span>

    /**
     * for post-import
     */
    public void maybeRandomizeDeck() {
<span class="nc bnc" id="L3631" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17128)) {</span>
<span class="nc" id="L3632">            maybeRandomizeDeck(null);</span>
        }
<span class="nc" id="L3634">    }</span>

    public void maybeRandomizeDeck(@Nullable Long did) {
<span class="nc bnc" id="L3637" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17130)) {</span>
<span class="nc bnc" id="L3638" title="All 2 branches missed.">            if (did == null) {</span>
<span class="nc bnc" id="L3639" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(17129)) {</span>
<span class="nc" id="L3640">                    did = mCol.getDecks().selected();</span>
                }
            }
        }
<span class="nc" id="L3644">        DeckConfig conf = mCol.getDecks().confForDid(did);</span>
<span class="nc bnc" id="L3645" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17132)) {</span>
            // in order due?
<span class="nc bnc" id="L3647" title="All 2 branches missed.">            if (conf.getJSONObject(&quot;new&quot;).getInt(&quot;order&quot;) == Consts.NEW_CARDS_RANDOM) {</span>
<span class="nc bnc" id="L3648" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(17131)) {</span>
<span class="nc" id="L3649">                    randomizeCards(did);</span>
                }
            }
        }
<span class="nc" id="L3653">    }</span>

    private void _emptyAllFiltered() {
<span class="nc bnc" id="L3656" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17133)) {</span>
<span class="nc" id="L3657">            mCol.getDb().execute(&quot;update cards set did = odid, queue = (case when type = &quot; + Consts.CARD_TYPE_LRN + &quot; then &quot; + Consts.QUEUE_TYPE_NEW + &quot; when type = &quot; + Consts.CARD_TYPE_RELEARNING + &quot; then &quot; + Consts.QUEUE_TYPE_REV + &quot; else type end), type = (case when type = &quot; + Consts.CARD_TYPE_LRN + &quot; then &quot; + Consts.CARD_TYPE_NEW + &quot; when type = &quot; + Consts.CARD_TYPE_RELEARNING + &quot; then &quot; + Consts.CARD_TYPE_REV + &quot; else type end), due = odue, odue = 0, odid = 0, usn = ? where odid != 0&quot;, mCol.usn());</span>
        }
<span class="nc" id="L3659">    }</span>

    private void _removeAllFromLearning() {
<span class="nc bnc" id="L3662" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17134)) {</span>
<span class="nc" id="L3663">            _removeAllFromLearning(2);</span>
        }
<span class="nc" id="L3665">    }</span>

    private void _removeAllFromLearning(int schedVer) {
<span class="nc bnc" id="L3668" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17142)) {</span>
            // remove review cards from relearning
<span class="nc bnc" id="L3670" title="All 22 branches missed.">            if ((ListenerUtil.mutListener.listen(17139) ? (schedVer &gt;= 1) : (ListenerUtil.mutListener.listen(17138) ? (schedVer &lt;= 1) : (ListenerUtil.mutListener.listen(17137) ? (schedVer &gt; 1) : (ListenerUtil.mutListener.listen(17136) ? (schedVer &lt; 1) : (ListenerUtil.mutListener.listen(17135) ? (schedVer != 1) : (schedVer == 1))))))) {</span>
<span class="nc bnc" id="L3671" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(17141)) {</span>
<span class="nc" id="L3672">                    mCol.getDb().execute(&quot;update cards set due = odue, queue = &quot; + Consts.QUEUE_TYPE_REV + &quot;, type = &quot; + Consts.CARD_TYPE_REV + &quot;, mod = ?, usn = ?, odue = 0 where queue in (&quot; + Consts.QUEUE_TYPE_LRN + &quot;,&quot; + Consts.QUEUE_TYPE_DAY_LEARN_RELEARN + &quot;) and type in (&quot; + Consts.CARD_TYPE_REV + &quot;,&quot; + Consts.CARD_TYPE_RELEARNING + &quot;)&quot;, getTime().intTime(), mCol.usn());</span>
                }
            } else {
<span class="nc bnc" id="L3675" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(17140)) {</span>
<span class="nc" id="L3676">                    mCol.getDb().execute(&quot;update cards set due = ?+ivl, queue = &quot; + Consts.QUEUE_TYPE_REV + &quot;, type = &quot; + Consts.CARD_TYPE_REV + &quot;, mod = ?, usn = ?, odue = 0 where queue in (&quot; + Consts.QUEUE_TYPE_LRN + &quot;,&quot; + Consts.QUEUE_TYPE_DAY_LEARN_RELEARN + &quot;) and type in (&quot; + Consts.CARD_TYPE_REV + &quot;,&quot; + Consts.CARD_TYPE_RELEARNING + &quot;)&quot;, mToday, getTime().intTime(), mCol.usn());</span>
                }
            }
        }
<span class="nc bnc" id="L3680" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17143)) {</span>
            // remove new cards from learning
<span class="nc" id="L3682">            forgetCards(mCol.getDb().queryLongList(&quot;select id from cards where queue in (&quot; + Consts.QUEUE_TYPE_LRN + &quot;,&quot; + Consts.QUEUE_TYPE_DAY_LEARN_RELEARN + &quot;)&quot;));</span>
        }
<span class="nc" id="L3684">    }</span>

    // v1 doesn't support buried/suspended (re)learning cards
    private void _resetSuspendedLearning() {
<span class="nc bnc" id="L3688" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17144)) {</span>
<span class="nc" id="L3689">            mCol.getDb().execute(&quot;update cards set type = (case when type = &quot; + Consts.CARD_TYPE_LRN + &quot; then &quot; + Consts.CARD_TYPE_NEW + &quot; when type in (&quot; + Consts.CARD_TYPE_REV + &quot;, &quot; + Consts.CARD_TYPE_RELEARNING + &quot;) then &quot; + Consts.CARD_TYPE_REV + &quot; else type end), due = (case when odue then odue else due end), odue = 0, mod = ?, usn = ? where queue &lt; 0&quot;, getTime().intTime(), mCol.usn());</span>
        }
<span class="nc" id="L3691">    }</span>

    // no 'manually buried' queue in v1
    private void _moveManuallyBuried() {
<span class="nc bnc" id="L3695" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17145)) {</span>
<span class="nc" id="L3696">            mCol.getDb().execute(&quot;update cards set queue=&quot; + Consts.QUEUE_TYPE_SIBLING_BURIED + &quot;, mod=? where queue=&quot; + Consts.QUEUE_TYPE_MANUALLY_BURIED, getTime().intTime());</span>
        }
<span class="nc" id="L3698">    }</span>

    // up or down
    private void _remapLearningAnswers(@NonNull String sql) {
<span class="nc bnc" id="L3702" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17146)) {</span>
<span class="nc" id="L3703">            mCol.getDb().execute(&quot;update revlog set &quot; + sql + &quot; and type in (&quot; + Consts.REVLOG_LRN + &quot;, &quot; + Consts.REVLOG_RELRN + &quot;)&quot;);</span>
        }
<span class="nc" id="L3705">    }</span>

    public void moveToV1() {
<span class="nc bnc" id="L3708" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17147)) {</span>
<span class="nc" id="L3709">            _emptyAllFiltered();</span>
        }
<span class="nc bnc" id="L3711" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17148)) {</span>
<span class="nc" id="L3712">            _removeAllFromLearning();</span>
        }
<span class="nc bnc" id="L3714" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17149)) {</span>
<span class="nc" id="L3715">            _moveManuallyBuried();</span>
        }
<span class="nc bnc" id="L3717" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17150)) {</span>
<span class="nc" id="L3718">            _resetSuspendedLearning();</span>
        }
<span class="nc bnc" id="L3720" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17151)) {</span>
<span class="nc" id="L3721">            _remapLearningAnswers(&quot;ease=ease-1 where ease in (&quot; + Consts.BUTTON_THREE + &quot;,&quot; + Consts.BUTTON_FOUR + &quot;)&quot;);</span>
        }
<span class="nc" id="L3723">    }</span>

    public void moveToV2() {
<span class="nc bnc" id="L3726" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17152)) {</span>
<span class="nc" id="L3727">            _emptyAllFiltered();</span>
        }
<span class="nc bnc" id="L3729" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17153)) {</span>
<span class="nc" id="L3730">            _removeAllFromLearning(1);</span>
        }
<span class="nc bnc" id="L3732" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17154)) {</span>
<span class="nc" id="L3733">            _remapLearningAnswers(&quot;ease=ease+1 where ease in (&quot; + Consts.BUTTON_TWO + &quot;,&quot; + Consts.BUTTON_THREE + &quot;)&quot;);</span>
        }
<span class="nc" id="L3735">    }</span>

    // Overriden: In sched v1, a single type of burying exist
    public boolean haveBuried(long did) {
<span class="nc" id="L3739">        List&lt;Long&gt; all = new ArrayList&lt;&gt;(mCol.getDecks().children(did).values());</span>
<span class="nc bnc" id="L3740" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17155)) {</span>
<span class="nc" id="L3741">            all.add(did);</span>
        }
<span class="nc bnc" id="L3743" title="All 10 branches missed.">        return (ListenerUtil.mutListener.listen(17156) ? (haveBuriedSiblings(all) &amp;&amp; haveManuallyBuried(all)) : (haveBuriedSiblings(all) || haveManuallyBuried(all)));</span>
    }

    public void unburyCardsForDeck(long did) {
<span class="nc" id="L3747">        List&lt;Long&gt; all = new ArrayList&lt;&gt;(mCol.getDecks().children(did).values());</span>
<span class="nc bnc" id="L3748" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17157)) {</span>
<span class="nc" id="L3749">            all.add(did);</span>
        }
<span class="nc bnc" id="L3751" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17158)) {</span>
<span class="nc" id="L3752">            unburyCardsForDeck(ALL, all);</span>
        }
<span class="nc" id="L3754">    }</span>

    @NonNull
    public String getName() {
<span class="fc" id="L3758">        return &quot;std2&quot;;</span>
    }

    public int getToday() {
<span class="nc" id="L3762">        return mToday;</span>
    }

    public void setToday(int today) {
<span class="nc bnc" id="L3766" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17159)) {</span>
<span class="nc" id="L3767">            mToday = today;</span>
        }
<span class="nc" id="L3769">    }</span>

    public long getDayCutoff() {
<span class="nc" id="L3772">        return mDayCutoff;</span>
    }

    public int getReps() {
<span class="nc" id="L3776">        return mReps;</span>
    }

    protected void incrReps() {
<span class="pc bpc" id="L3780" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17160)) {</span>
<span class="fc" id="L3781">            mReps++;</span>
        }
<span class="fc" id="L3783">    }</span>

    protected void decrReps() {
<span class="nc bnc" id="L3786" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17161)) {</span>
<span class="nc" id="L3787">            mReps--;</span>
        }
<span class="nc" id="L3789">    }</span>

    public int cardCount() {
<span class="nc" id="L3792">        String dids = _deckLimit();</span>
<span class="nc" id="L3793">        return mCol.getDb().queryScalar(&quot;SELECT count() FROM cards WHERE did IN &quot; + dids);</span>
    }

    public int eta(Counts counts) {
<span class="nc" id="L3797">        return eta(counts, true);</span>
    }

    // Overridden because of the different queues in SchedV1 and V2
    public int eta(Counts counts, boolean reload) {
        double newRate;
        double newTime;
        double revRate;
        double revTime;
        double relrnRate;
        double relrnTime;
<span class="nc bnc" id="L3808" title="All 50 branches missed.">        if ((ListenerUtil.mutListener.listen(17167) ? (reload &amp;&amp; (ListenerUtil.mutListener.listen(17166) ? (mEtaCache[0] &gt;= -1) : (ListenerUtil.mutListener.listen(17165) ? (mEtaCache[0] &lt;= -1) : (ListenerUtil.mutListener.listen(17164) ? (mEtaCache[0] &gt; -1) : (ListenerUtil.mutListener.listen(17163) ? (mEtaCache[0] &lt; -1) : (ListenerUtil.mutListener.listen(17162) ? (mEtaCache[0] != -1) : (mEtaCache[0] == -1))))))) : (reload || (ListenerUtil.mutListener.listen(17166) ? (mEtaCache[0] &gt;= -1) : (ListenerUtil.mutListener.listen(17165) ? (mEtaCache[0] &lt;= -1) : (ListenerUtil.mutListener.listen(17164) ? (mEtaCache[0] &gt; -1) : (ListenerUtil.mutListener.listen(17163) ? (mEtaCache[0] &lt; -1) : (ListenerUtil.mutListener.listen(17162) ? (mEtaCache[0] != -1) : (mEtaCache[0] == -1))))))))) {</span>
<span class="nc bnc" id="L3809" title="All 248 branches missed.">            try (Cursor cur = mCol.getDb().query(&quot;select &quot; + &quot;avg(case when type = &quot; + Consts.CARD_TYPE_NEW + &quot; then case when ease &gt; 1 then 1.0 else 0.0 end else null end) as newRate, avg(case when type = &quot; + Consts.CARD_TYPE_NEW + &quot; then time else null end) as newTime, &quot; + &quot;avg(case when type in (&quot; + Consts.CARD_TYPE_LRN + &quot;, &quot; + Consts.CARD_TYPE_RELEARNING + &quot;) then case when ease &gt; 1 then 1.0 else 0.0 end else null end) as revRate, avg(case when type in (&quot; + Consts.CARD_TYPE_LRN + &quot;, &quot; + Consts.CARD_TYPE_RELEARNING + &quot;) then time else null end) as revTime, &quot; + &quot;avg(case when type = &quot; + Consts.CARD_TYPE_REV + &quot; then case when ease &gt; 1 then 1.0 else 0.0 end else null end) as relrnRate, avg(case when type = &quot; + Consts.CARD_TYPE_REV + &quot; then time else null end) as relrnTime &quot; + &quot;from revlog where id &gt; &quot; + &quot;?&quot;, (ListenerUtil.mutListener.listen(17179) ? (((ListenerUtil.mutListener.listen(17175) ? (mCol.getSched().getDayCutoff() % ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY))))))) : (ListenerUtil.mutListener.listen(17174) ? (mCol.getSched().getDayCutoff() / ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY))))))) : (ListenerUtil.mutListener.listen(17173) ? (mCol.getSched().getDayCutoff() * ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY))))))) : (ListenerUtil.mutListener.listen(17172) ? (mCol.getSched().getDayCutoff() + ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY))))))) : (mCol.getSched().getDayCutoff() - ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY)))))))))))) % 1000) : (ListenerUtil.mutListener.listen(17178) ? (((ListenerUtil.mutListener.listen(17175) ? (mCol.getSched().getDayCutoff() % ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY))))))) : (ListenerUtil.mutListener.listen(17174) ? (mCol.getSched().getDayCutoff() / ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY))))))) : (ListenerUtil.mutListener.listen(17173) ? (mCol.getSched().getDayCutoff() * ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY))))))) : (ListenerUtil.mutListener.listen(17172) ? (mCol.getSched().getDayCutoff() + ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY))))))) : (mCol.getSched().getDayCutoff() - ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY)))))))))))) / 1000) : (ListenerUtil.mutListener.listen(17177) ? (((ListenerUtil.mutListener.listen(17175) ? (mCol.getSched().getDayCutoff() % ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY))))))) : (ListenerUtil.mutListener.listen(17174) ? (mCol.getSched().getDayCutoff() / ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY))))))) : (ListenerUtil.mutListener.listen(17173) ? (mCol.getSched().getDayCutoff() * ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY))))))) : (ListenerUtil.mutListener.listen(17172) ? (mCol.getSched().getDayCutoff() + ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY))))))) : (mCol.getSched().getDayCutoff() - ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY)))))))))))) - 1000) : (ListenerUtil.mutListener.listen(17176) ? (((ListenerUtil.mutListener.listen(17175) ? (mCol.getSched().getDayCutoff() % ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY))))))) : (ListenerUtil.mutListener.listen(17174) ? (mCol.getSched().getDayCutoff() / ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY))))))) : (ListenerUtil.mutListener.listen(17173) ? (mCol.getSched().getDayCutoff() * ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY))))))) : (ListenerUtil.mutListener.listen(17172) ? (mCol.getSched().getDayCutoff() + ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY))))))) : (mCol.getSched().getDayCutoff() - ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY)))))))))))) + 1000) : (((ListenerUtil.mutListener.listen(17175) ? (mCol.getSched().getDayCutoff() % ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY))))))) : (ListenerUtil.mutListener.listen(17174) ? (mCol.getSched().getDayCutoff() / ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY))))))) : (ListenerUtil.mutListener.listen(17173) ? (mCol.getSched().getDayCutoff() * ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY))))))) : (ListenerUtil.mutListener.listen(17172) ? (mCol.getSched().getDayCutoff() + ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY))))))) : (mCol.getSched().getDayCutoff() - ((ListenerUtil.mutListener.listen(17171) ? (10 % SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17170) ? (10 / SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17169) ? (10 - SECONDS_PER_DAY) : (ListenerUtil.mutListener.listen(17168) ? (10 + SECONDS_PER_DAY) : (10 * SECONDS_PER_DAY)))))))))))) * 1000))))))) {</span>
<span class="nc bnc" id="L3810" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(17180)) {</span>
<span class="nc bnc" id="L3811" title="All 2 branches missed.">                    if (!cur.moveToFirst()) {</span>
<span class="nc" id="L3812">                        return -1;</span>
                    }
                }
<span class="nc" id="L3815">                newRate = cur.getDouble(0);</span>
<span class="nc" id="L3816">                newTime = cur.getDouble(1);</span>
<span class="nc" id="L3817">                revRate = cur.getDouble(2);</span>
<span class="nc" id="L3818">                revTime = cur.getDouble(3);</span>
<span class="nc" id="L3819">                relrnRate = cur.getDouble(4);</span>
<span class="nc" id="L3820">                relrnTime = cur.getDouble(5);</span>
<span class="nc bnc" id="L3821" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(17182)) {</span>
<span class="nc bnc" id="L3822" title="All 2 branches missed.">                    if (!cur.isClosed()) {</span>
<span class="nc bnc" id="L3823" title="All 2 branches missed.">                        if (!ListenerUtil.mutListener.listen(17181)) {</span>
<span class="nc" id="L3824">                            cur.close();</span>
                        }
                    }
                }
<span class="nc bnc" id="L3828" title="All 2 branches missed.">            }</span>
            // If the collection has no revlog data to work with, assume a 20 second average rep for that type
<span class="nc bnc" id="L3830" title="All 22 branches missed.">            newTime = (ListenerUtil.mutListener.listen(17187) ? (newTime &gt;= 0) : (ListenerUtil.mutListener.listen(17186) ? (newTime &lt;= 0) : (ListenerUtil.mutListener.listen(17185) ? (newTime &gt; 0) : (ListenerUtil.mutListener.listen(17184) ? (newTime &lt; 0) : (ListenerUtil.mutListener.listen(17183) ? (newTime != 0) : (newTime == 0)))))) ? 20000 : newTime;</span>
<span class="nc bnc" id="L3831" title="All 22 branches missed.">            revTime = (ListenerUtil.mutListener.listen(17192) ? (revTime &gt;= 0) : (ListenerUtil.mutListener.listen(17191) ? (revTime &lt;= 0) : (ListenerUtil.mutListener.listen(17190) ? (revTime &gt; 0) : (ListenerUtil.mutListener.listen(17189) ? (revTime &lt; 0) : (ListenerUtil.mutListener.listen(17188) ? (revTime != 0) : (revTime == 0)))))) ? 20000 : revTime;</span>
<span class="nc bnc" id="L3832" title="All 22 branches missed.">            relrnTime = (ListenerUtil.mutListener.listen(17197) ? (relrnTime &gt;= 0) : (ListenerUtil.mutListener.listen(17196) ? (relrnTime &lt;= 0) : (ListenerUtil.mutListener.listen(17195) ? (relrnTime &gt; 0) : (ListenerUtil.mutListener.listen(17194) ? (relrnTime &lt; 0) : (ListenerUtil.mutListener.listen(17193) ? (relrnTime != 0) : (relrnTime == 0)))))) ? 20000 : relrnTime;</span>
            // And a 100% success rate
<span class="nc bnc" id="L3834" title="All 22 branches missed.">            newRate = (ListenerUtil.mutListener.listen(17202) ? (newRate &gt;= 0) : (ListenerUtil.mutListener.listen(17201) ? (newRate &lt;= 0) : (ListenerUtil.mutListener.listen(17200) ? (newRate &gt; 0) : (ListenerUtil.mutListener.listen(17199) ? (newRate &lt; 0) : (ListenerUtil.mutListener.listen(17198) ? (newRate != 0) : (newRate == 0)))))) ? 1 : newRate;</span>
<span class="nc bnc" id="L3835" title="All 22 branches missed.">            revRate = (ListenerUtil.mutListener.listen(17207) ? (revRate &gt;= 0) : (ListenerUtil.mutListener.listen(17206) ? (revRate &lt;= 0) : (ListenerUtil.mutListener.listen(17205) ? (revRate &gt; 0) : (ListenerUtil.mutListener.listen(17204) ? (revRate &lt; 0) : (ListenerUtil.mutListener.listen(17203) ? (revRate != 0) : (revRate == 0)))))) ? 1 : revRate;</span>
<span class="nc bnc" id="L3836" title="All 22 branches missed.">            relrnRate = (ListenerUtil.mutListener.listen(17212) ? (relrnRate &gt;= 0) : (ListenerUtil.mutListener.listen(17211) ? (relrnRate &lt;= 0) : (ListenerUtil.mutListener.listen(17210) ? (relrnRate &gt; 0) : (ListenerUtil.mutListener.listen(17209) ? (relrnRate &lt; 0) : (ListenerUtil.mutListener.listen(17208) ? (relrnRate != 0) : (relrnRate == 0)))))) ? 1 : relrnRate;</span>
<span class="nc bnc" id="L3837" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(17213)) {</span>
<span class="nc" id="L3838">                mEtaCache[0] = newRate;</span>
            }
<span class="nc bnc" id="L3840" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(17214)) {</span>
<span class="nc" id="L3841">                mEtaCache[1] = newTime;</span>
            }
<span class="nc bnc" id="L3843" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(17215)) {</span>
<span class="nc" id="L3844">                mEtaCache[2] = revRate;</span>
            }
<span class="nc bnc" id="L3846" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(17216)) {</span>
<span class="nc" id="L3847">                mEtaCache[3] = revTime;</span>
            }
<span class="nc bnc" id="L3849" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(17217)) {</span>
<span class="nc" id="L3850">                mEtaCache[4] = relrnRate;</span>
            }
<span class="nc bnc" id="L3852" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(17218)) {</span>
<span class="nc" id="L3853">                mEtaCache[5] = relrnTime;</span>
            }
        } else {
<span class="nc" id="L3856">            newRate = mEtaCache[0];</span>
<span class="nc" id="L3857">            newTime = mEtaCache[1];</span>
<span class="nc" id="L3858">            revRate = mEtaCache[2];</span>
<span class="nc" id="L3859">            revTime = mEtaCache[3];</span>
<span class="nc" id="L3860">            relrnRate = mEtaCache[4];</span>
<span class="nc" id="L3861">            relrnTime = mEtaCache[5];</span>
        }
        // Calculate the total time for each queue based on the historical average duration per rep
<span class="nc bnc" id="L3864" title="All 8 branches missed.">        double newTotal = (ListenerUtil.mutListener.listen(17222) ? (newTime % counts.getNew()) : (ListenerUtil.mutListener.listen(17221) ? (newTime / counts.getNew()) : (ListenerUtil.mutListener.listen(17220) ? (newTime - counts.getNew()) : (ListenerUtil.mutListener.listen(17219) ? (newTime + counts.getNew()) : (newTime * counts.getNew())))));</span>
<span class="nc bnc" id="L3865" title="All 8 branches missed.">        double relrnTotal = (ListenerUtil.mutListener.listen(17226) ? (relrnTime % counts.getLrn()) : (ListenerUtil.mutListener.listen(17225) ? (relrnTime / counts.getLrn()) : (ListenerUtil.mutListener.listen(17224) ? (relrnTime - counts.getLrn()) : (ListenerUtil.mutListener.listen(17223) ? (relrnTime + counts.getLrn()) : (relrnTime * counts.getLrn())))));</span>
<span class="nc bnc" id="L3866" title="All 8 branches missed.">        double revTotal = (ListenerUtil.mutListener.listen(17230) ? (revTime % counts.getRev()) : (ListenerUtil.mutListener.listen(17229) ? (revTime / counts.getRev()) : (ListenerUtil.mutListener.listen(17228) ? (revTime - counts.getRev()) : (ListenerUtil.mutListener.listen(17227) ? (revTime + counts.getRev()) : (revTime * counts.getRev())))));</span>
        // Assume every new card becomes 1 relrn
<span class="nc" id="L3868">        int toRelrn = counts.getNew();</span>
<span class="nc bnc" id="L3869" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17239)) {</span>
<span class="nc bnc" id="L3870" title="All 48 branches missed.">            toRelrn += Math.ceil((ListenerUtil.mutListener.listen(17238) ? (((ListenerUtil.mutListener.listen(17234) ? (1 % relrnRate) : (ListenerUtil.mutListener.listen(17233) ? (1 / relrnRate) : (ListenerUtil.mutListener.listen(17232) ? (1 * relrnRate) : (ListenerUtil.mutListener.listen(17231) ? (1 + relrnRate) : (1 - relrnRate)))))) % counts.getLrn()) : (ListenerUtil.mutListener.listen(17237) ? (((ListenerUtil.mutListener.listen(17234) ? (1 % relrnRate) : (ListenerUtil.mutListener.listen(17233) ? (1 / relrnRate) : (ListenerUtil.mutListener.listen(17232) ? (1 * relrnRate) : (ListenerUtil.mutListener.listen(17231) ? (1 + relrnRate) : (1 - relrnRate)))))) / counts.getLrn()) : (ListenerUtil.mutListener.listen(17236) ? (((ListenerUtil.mutListener.listen(17234) ? (1 % relrnRate) : (ListenerUtil.mutListener.listen(17233) ? (1 / relrnRate) : (ListenerUtil.mutListener.listen(17232) ? (1 * relrnRate) : (ListenerUtil.mutListener.listen(17231) ? (1 + relrnRate) : (1 - relrnRate)))))) - counts.getLrn()) : (ListenerUtil.mutListener.listen(17235) ? (((ListenerUtil.mutListener.listen(17234) ? (1 % relrnRate) : (ListenerUtil.mutListener.listen(17233) ? (1 / relrnRate) : (ListenerUtil.mutListener.listen(17232) ? (1 * relrnRate) : (ListenerUtil.mutListener.listen(17231) ? (1 + relrnRate) : (1 - relrnRate)))))) + counts.getLrn()) : (((ListenerUtil.mutListener.listen(17234) ? (1 % relrnRate) : (ListenerUtil.mutListener.listen(17233) ? (1 / relrnRate) : (ListenerUtil.mutListener.listen(17232) ? (1 * relrnRate) : (ListenerUtil.mutListener.listen(17231) ? (1 + relrnRate) : (1 - relrnRate)))))) * counts.getLrn()))))));</span>
        }
<span class="nc bnc" id="L3872" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17248)) {</span>
<span class="nc bnc" id="L3873" title="All 48 branches missed.">            toRelrn += Math.ceil((ListenerUtil.mutListener.listen(17247) ? (((ListenerUtil.mutListener.listen(17243) ? (1 % revRate) : (ListenerUtil.mutListener.listen(17242) ? (1 / revRate) : (ListenerUtil.mutListener.listen(17241) ? (1 * revRate) : (ListenerUtil.mutListener.listen(17240) ? (1 + revRate) : (1 - revRate)))))) % counts.getRev()) : (ListenerUtil.mutListener.listen(17246) ? (((ListenerUtil.mutListener.listen(17243) ? (1 % revRate) : (ListenerUtil.mutListener.listen(17242) ? (1 / revRate) : (ListenerUtil.mutListener.listen(17241) ? (1 * revRate) : (ListenerUtil.mutListener.listen(17240) ? (1 + revRate) : (1 - revRate)))))) / counts.getRev()) : (ListenerUtil.mutListener.listen(17245) ? (((ListenerUtil.mutListener.listen(17243) ? (1 % revRate) : (ListenerUtil.mutListener.listen(17242) ? (1 / revRate) : (ListenerUtil.mutListener.listen(17241) ? (1 * revRate) : (ListenerUtil.mutListener.listen(17240) ? (1 + revRate) : (1 - revRate)))))) - counts.getRev()) : (ListenerUtil.mutListener.listen(17244) ? (((ListenerUtil.mutListener.listen(17243) ? (1 % revRate) : (ListenerUtil.mutListener.listen(17242) ? (1 / revRate) : (ListenerUtil.mutListener.listen(17241) ? (1 * revRate) : (ListenerUtil.mutListener.listen(17240) ? (1 + revRate) : (1 - revRate)))))) + counts.getRev()) : (((ListenerUtil.mutListener.listen(17243) ? (1 % revRate) : (ListenerUtil.mutListener.listen(17242) ? (1 / revRate) : (ListenerUtil.mutListener.listen(17241) ? (1 * revRate) : (ListenerUtil.mutListener.listen(17240) ? (1 + revRate) : (1 - revRate)))))) * counts.getRev()))))));</span>
        }
        // negative for other reasons). 5% seems reasonable to ensure the loop doesn't iterate too much.
<span class="nc" id="L3876">        relrnRate = Math.max(relrnRate, 0.05);</span>
<span class="nc" id="L3877">        int futureReps = 0;</span>
<span class="nc bnc" id="L3878" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17264)) {</span>
            {
<span class="nc" id="L3880">                long _loopCounter329 = 0;</span>
                do {
<span class="nc" id="L3882">                    ListenerUtil.loopListener.listen(&quot;_loopCounter329&quot;, ++_loopCounter329);</span>
                    // Truncation ensures the failure rate always decreases
<span class="nc bnc" id="L3884" title="All 48 branches missed.">                    int failures = (int) ((ListenerUtil.mutListener.listen(17256) ? (((ListenerUtil.mutListener.listen(17252) ? (1 % relrnRate) : (ListenerUtil.mutListener.listen(17251) ? (1 / relrnRate) : (ListenerUtil.mutListener.listen(17250) ? (1 * relrnRate) : (ListenerUtil.mutListener.listen(17249) ? (1 + relrnRate) : (1 - relrnRate)))))) % toRelrn) : (ListenerUtil.mutListener.listen(17255) ? (((ListenerUtil.mutListener.listen(17252) ? (1 % relrnRate) : (ListenerUtil.mutListener.listen(17251) ? (1 / relrnRate) : (ListenerUtil.mutListener.listen(17250) ? (1 * relrnRate) : (ListenerUtil.mutListener.listen(17249) ? (1 + relrnRate) : (1 - relrnRate)))))) / toRelrn) : (ListenerUtil.mutListener.listen(17254) ? (((ListenerUtil.mutListener.listen(17252) ? (1 % relrnRate) : (ListenerUtil.mutListener.listen(17251) ? (1 / relrnRate) : (ListenerUtil.mutListener.listen(17250) ? (1 * relrnRate) : (ListenerUtil.mutListener.listen(17249) ? (1 + relrnRate) : (1 - relrnRate)))))) - toRelrn) : (ListenerUtil.mutListener.listen(17253) ? (((ListenerUtil.mutListener.listen(17252) ? (1 % relrnRate) : (ListenerUtil.mutListener.listen(17251) ? (1 / relrnRate) : (ListenerUtil.mutListener.listen(17250) ? (1 * relrnRate) : (ListenerUtil.mutListener.listen(17249) ? (1 + relrnRate) : (1 - relrnRate)))))) + toRelrn) : (((ListenerUtil.mutListener.listen(17252) ? (1 % relrnRate) : (ListenerUtil.mutListener.listen(17251) ? (1 / relrnRate) : (ListenerUtil.mutListener.listen(17250) ? (1 * relrnRate) : (ListenerUtil.mutListener.listen(17249) ? (1 + relrnRate) : (1 - relrnRate)))))) * toRelrn))))));</span>
<span class="nc bnc" id="L3885" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(17257)) {</span>
<span class="nc" id="L3886">                        futureReps += failures;</span>
                    }
<span class="nc bnc" id="L3888" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(17258)) {</span>
<span class="nc" id="L3889">                        toRelrn = failures;</span>
                    }
<span class="nc bnc" id="L3891" title="All 22 branches missed.">                } while ((ListenerUtil.mutListener.listen(17263) ? (toRelrn &gt;= 1) : (ListenerUtil.mutListener.listen(17262) ? (toRelrn &lt;= 1) : (ListenerUtil.mutListener.listen(17261) ? (toRelrn &lt; 1) : (ListenerUtil.mutListener.listen(17260) ? (toRelrn != 1) : (ListenerUtil.mutListener.listen(17259) ? (toRelrn == 1) : (toRelrn &gt; 1)))))));</span>
            }
        }
<span class="nc bnc" id="L3894" title="All 8 branches missed.">        double futureRelrnTotal = (ListenerUtil.mutListener.listen(17268) ? (relrnTime % futureReps) : (ListenerUtil.mutListener.listen(17267) ? (relrnTime / futureReps) : (ListenerUtil.mutListener.listen(17266) ? (relrnTime - futureReps) : (ListenerUtil.mutListener.listen(17265) ? (relrnTime + futureReps) : (relrnTime * futureReps)))));</span>
<span class="nc bnc" id="L3895" title="All 1248 branches missed.">        return (int) Math.round((ListenerUtil.mutListener.listen(17284) ? (((ListenerUtil.mutListener.listen(17280) ? ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) % futureRelrnTotal) : (ListenerUtil.mutListener.listen(17279) ? ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) / futureRelrnTotal) : (ListenerUtil.mutListener.listen(17278) ? ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) * futureRelrnTotal) : (ListenerUtil.mutListener.listen(17277) ? ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) - futureRelrnTotal) : ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) + futureRelrnTotal)))))) % 60000) : (ListenerUtil.mutListener.listen(17283) ? (((ListenerUtil.mutListener.listen(17280) ? ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) % futureRelrnTotal) : (ListenerUtil.mutListener.listen(17279) ? ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) / futureRelrnTotal) : (ListenerUtil.mutListener.listen(17278) ? ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) * futureRelrnTotal) : (ListenerUtil.mutListener.listen(17277) ? ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) - futureRelrnTotal) : ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) + futureRelrnTotal)))))) * 60000) : (ListenerUtil.mutListener.listen(17282) ? (((ListenerUtil.mutListener.listen(17280) ? ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) % futureRelrnTotal) : (ListenerUtil.mutListener.listen(17279) ? ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) / futureRelrnTotal) : (ListenerUtil.mutListener.listen(17278) ? ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) * futureRelrnTotal) : (ListenerUtil.mutListener.listen(17277) ? ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) - futureRelrnTotal) : ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) + futureRelrnTotal)))))) - 60000) : (ListenerUtil.mutListener.listen(17281) ? (((ListenerUtil.mutListener.listen(17280) ? ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) % futureRelrnTotal) : (ListenerUtil.mutListener.listen(17279) ? ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) / futureRelrnTotal) : (ListenerUtil.mutListener.listen(17278) ? ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) * futureRelrnTotal) : (ListenerUtil.mutListener.listen(17277) ? ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) - futureRelrnTotal) : ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) + futureRelrnTotal)))))) + 60000) : (((ListenerUtil.mutListener.listen(17280) ? ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) % futureRelrnTotal) : (ListenerUtil.mutListener.listen(17279) ? ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) / futureRelrnTotal) : (ListenerUtil.mutListener.listen(17278) ? ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) * futureRelrnTotal) : (ListenerUtil.mutListener.listen(17277) ? ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) - futureRelrnTotal) : ((ListenerUtil.mutListener.listen(17276) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) % revTotal) : (ListenerUtil.mutListener.listen(17275) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) / revTotal) : (ListenerUtil.mutListener.listen(17274) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) * revTotal) : (ListenerUtil.mutListener.listen(17273) ? ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) - revTotal) : ((ListenerUtil.mutListener.listen(17272) ? (newTotal % relrnTotal) : (ListenerUtil.mutListener.listen(17271) ? (newTotal / relrnTotal) : (ListenerUtil.mutListener.listen(17270) ? (newTotal * relrnTotal) : (ListenerUtil.mutListener.listen(17269) ? (newTotal - relrnTotal) : (newTotal + relrnTotal))))) + revTotal))))) + futureRelrnTotal)))))) / 60000))))));</span>
    }

    /**
     * Change the counts to reflect that `card` should not be counted anymore. In practice, it means that the card has
     * been sent to the reviewer. Either through `getCard()` or through `undo`. Assumes that card's queue has not yet
     * changed.
     * Overridden
     */
    public void decrementCounts(@Nullable Card discardCard) {
<span class="pc bpc" id="L3905" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17285)) {</span>
<span class="pc bpc" id="L3906" title="1 of 2 branches missed.">            if (discardCard == null) {</span>
<span class="nc" id="L3907">                return;</span>
            }
        }
<span class="pc bpc" id="L3910" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17289)) {</span>
<span class="pc bpc" id="L3911" title="3 of 4 branches missed.">            switch(discardCard.getQueue()) {</span>
                case Consts.QUEUE_TYPE_NEW:
<span class="pc bpc" id="L3913" title="1 of 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(17286)) {</span>
<span class="fc" id="L3914">                        mNewCount--;</span>
                    }
                    break;
                case Consts.QUEUE_TYPE_LRN:
                case Consts.QUEUE_TYPE_DAY_LEARN_RELEARN:
                case Consts.QUEUE_TYPE_PREVIEW:
<span class="nc bnc" id="L3920" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(17287)) {</span>
<span class="nc" id="L3921">                        mLrnCount--;</span>
                    }
                    // In the case of QUEUE_TYPE_LRN, it is -= discardCard.getLeft() / 1000; in sched v1
                    break;
                case Consts.QUEUE_TYPE_REV:
<span class="nc bnc" id="L3926" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(17288)) {</span>
<span class="nc" id="L3927">                        mRevCount--;</span>
                    }
                    break;
            }
        }
<span class="fc" id="L3932">    }</span>

    /**
     * Sorts a card into the lrn queue LIBANKI: not in libanki
     */
    protected void _sortIntoLrn(long due, long id) {
<span class="nc bnc" id="L3938" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17290)) {</span>
<span class="nc bnc" id="L3939" title="All 2 branches missed.">            if (!mLrnQueue.isFilled()) {</span>
                // Adding anything is useless while the queue awaits beeing filled
<span class="nc" id="L3941">                return;</span>
            }
        }
<span class="nc" id="L3944">        ListIterator&lt;LrnCard&gt; i = mLrnQueue.listIterator();</span>
<span class="nc bnc" id="L3945" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17298)) {</span>
            {
<span class="nc" id="L3947">                long _loopCounter330 = 0;</span>
<span class="nc bnc" id="L3948" title="All 2 branches missed.">                while (i.hasNext()) {</span>
<span class="nc" id="L3949">                    ListenerUtil.loopListener.listen(&quot;_loopCounter330&quot;, ++_loopCounter330);</span>
<span class="nc bnc" id="L3950" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(17297)) {</span>
<span class="nc bnc" id="L3951" title="All 22 branches missed.">                        if ((ListenerUtil.mutListener.listen(17295) ? (i.next().getDue() &gt;= due) : (ListenerUtil.mutListener.listen(17294) ? (i.next().getDue() &lt;= due) : (ListenerUtil.mutListener.listen(17293) ? (i.next().getDue() &lt; due) : (ListenerUtil.mutListener.listen(17292) ? (i.next().getDue() != due) : (ListenerUtil.mutListener.listen(17291) ? (i.next().getDue() == due) : (i.next().getDue() &gt; due))))))) {</span>
<span class="nc bnc" id="L3952" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(17296)) {</span>
<span class="nc" id="L3953">                                i.previous();</span>
                            }
                            break;
                        }
                    }
                }
            }
        }
<span class="nc bnc" id="L3961" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17299)) {</span>
<span class="nc" id="L3962">            i.add(new LrnCard(mCol, due, id));</span>
        }
<span class="nc" id="L3964">    }</span>

    public boolean leechActionSuspend(@NonNull Card card) {
<span class="nc" id="L3967">        JSONObject conf = _cardConf(card).getJSONObject(&quot;lapse&quot;);</span>
<span class="nc bnc" id="L3968" title="All 22 branches missed.">        return (ListenerUtil.mutListener.listen(17304) ? (conf.getInt(&quot;leechAction&quot;) &gt;= Consts.LEECH_SUSPEND) : (ListenerUtil.mutListener.listen(17303) ? (conf.getInt(&quot;leechAction&quot;) &lt;= Consts.LEECH_SUSPEND) : (ListenerUtil.mutListener.listen(17302) ? (conf.getInt(&quot;leechAction&quot;) &gt; Consts.LEECH_SUSPEND) : (ListenerUtil.mutListener.listen(17301) ? (conf.getInt(&quot;leechAction&quot;) &lt; Consts.LEECH_SUSPEND) : (ListenerUtil.mutListener.listen(17300) ? (conf.getInt(&quot;leechAction&quot;) != Consts.LEECH_SUSPEND) : (conf.getInt(&quot;leechAction&quot;) == Consts.LEECH_SUSPEND))))));</span>
    }

    public void setContext(@Nullable WeakReference&lt;Activity&gt; contextReference) {
<span class="nc bnc" id="L3972" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17305)) {</span>
<span class="nc" id="L3973">            mContextReference = contextReference;</span>
        }
<span class="nc" id="L3975">    }</span>

    /**
     * not in libAnki. Added due to #5666: inconsistent selected deck card counts on sync
     */
    @Override
    public void setReportLimit(int reportLimit) {
<span class="nc bnc" id="L3982" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17306)) {</span>
<span class="nc" id="L3983">            this.mReportLimit = reportLimit;</span>
        }
<span class="nc" id="L3985">    }</span>

    @Override
    public void undoReview(@NonNull Card oldCardData, boolean wasLeech) {
<span class="nc bnc" id="L3989" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17310)) {</span>
            // remove leech tag if it didn't have it before
<span class="nc bnc" id="L3991" title="All 10 branches missed.">            if ((ListenerUtil.mutListener.listen(17307) ? (!wasLeech || oldCardData.note().hasTag(&quot;leech&quot;)) : (!wasLeech &amp;&amp; oldCardData.note().hasTag(&quot;leech&quot;)))) {</span>
<span class="nc bnc" id="L3992" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(17308)) {</span>
<span class="nc" id="L3993">                    oldCardData.note().delTag(&quot;leech&quot;);</span>
                }
<span class="nc bnc" id="L3995" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(17309)) {</span>
<span class="nc" id="L3996">                    oldCardData.note().flush();</span>
                }
            }
        }
<span class="nc bnc" id="L4000" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17311)) {</span>
<span class="nc" id="L4001">            Timber.i(&quot;Undo Review of card %d, leech: %b&quot;, oldCardData.getId(), wasLeech);</span>
        }
<span class="nc bnc" id="L4003" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17312)) {</span>
            // write old data
<span class="nc" id="L4005">            oldCardData.flush(false);</span>
        }
<span class="nc" id="L4007">        DeckConfig conf = _cardConf(oldCardData);</span>
<span class="nc bnc" id="L4008" title="All 10 branches missed.">        boolean previewing = (ListenerUtil.mutListener.listen(17313) ? (conf.getInt(&quot;dyn&quot;) == DECK_DYN || !conf.getBoolean(&quot;resched&quot;)) : (conf.getInt(&quot;dyn&quot;) == DECK_DYN &amp;&amp; !conf.getBoolean(&quot;resched&quot;)));</span>
<span class="nc bnc" id="L4009" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17315)) {</span>
<span class="nc bnc" id="L4010" title="All 2 branches missed.">            if (!previewing) {</span>
                // and delete revlog entry
<span class="nc" id="L4012">                long last = mCol.getDb().queryLongScalar(&quot;SELECT id FROM revlog WHERE cid = ? ORDER BY id DESC LIMIT 1&quot;, oldCardData.getId());</span>
<span class="nc bnc" id="L4013" title="All 2 branches missed.">                if (!ListenerUtil.mutListener.listen(17314)) {</span>
<span class="nc" id="L4014">                    mCol.getDb().execute(&quot;DELETE FROM revlog WHERE id = &quot; + last);</span>
                }
            }
        }
<span class="nc bnc" id="L4018" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17316)) {</span>
            // restore any siblings
<span class="nc" id="L4020">            mCol.getDb().execute(&quot;update cards set queue=type,mod=?,usn=? where queue=&quot; + Consts.QUEUE_TYPE_SIBLING_BURIED + &quot; and nid=?&quot;, getTime().intTime(), mCol.usn(), oldCardData.getNid());</span>
        }
        // and finally, update daily count
        @Consts.CARD_QUEUE
<span class="nc bnc" id="L4024" title="All 90 branches missed.">        int n = ((ListenerUtil.mutListener.listen(17327) ? ((ListenerUtil.mutListener.listen(17321) ? (oldCardData.getQueue() &gt;= Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(17320) ? (oldCardData.getQueue() &lt;= Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(17319) ? (oldCardData.getQueue() &gt; Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(17318) ? (oldCardData.getQueue() &lt; Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(17317) ? (oldCardData.getQueue() != Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (oldCardData.getQueue() == Consts.QUEUE_TYPE_DAY_LEARN_RELEARN)))))) &amp;&amp; (ListenerUtil.mutListener.listen(17326) ? (oldCardData.getQueue() &gt;= Consts.QUEUE_TYPE_PREVIEW) : (ListenerUtil.mutListener.listen(17325) ? (oldCardData.getQueue() &lt;= Consts.QUEUE_TYPE_PREVIEW) : (ListenerUtil.mutListener.listen(17324) ? (oldCardData.getQueue() &gt; Consts.QUEUE_TYPE_PREVIEW) : (ListenerUtil.mutListener.listen(17323) ? (oldCardData.getQueue() &lt; Consts.QUEUE_TYPE_PREVIEW) : (ListenerUtil.mutListener.listen(17322) ? (oldCardData.getQueue() != Consts.QUEUE_TYPE_PREVIEW) : (oldCardData.getQueue() == Consts.QUEUE_TYPE_PREVIEW))))))) : ((ListenerUtil.mutListener.listen(17321) ? (oldCardData.getQueue() &gt;= Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(17320) ? (oldCardData.getQueue() &lt;= Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(17319) ? (oldCardData.getQueue() &gt; Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(17318) ? (oldCardData.getQueue() &lt; Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (ListenerUtil.mutListener.listen(17317) ? (oldCardData.getQueue() != Consts.QUEUE_TYPE_DAY_LEARN_RELEARN) : (oldCardData.getQueue() == Consts.QUEUE_TYPE_DAY_LEARN_RELEARN)))))) || (ListenerUtil.mutListener.listen(17326) ? (oldCardData.getQueue() &gt;= Consts.QUEUE_TYPE_PREVIEW) : (ListenerUtil.mutListener.listen(17325) ? (oldCardData.getQueue() &lt;= Consts.QUEUE_TYPE_PREVIEW) : (ListenerUtil.mutListener.listen(17324) ? (oldCardData.getQueue() &gt; Consts.QUEUE_TYPE_PREVIEW) : (ListenerUtil.mutListener.listen(17323) ? (oldCardData.getQueue() &lt; Consts.QUEUE_TYPE_PREVIEW) : (ListenerUtil.mutListener.listen(17322) ? (oldCardData.getQueue() != Consts.QUEUE_TYPE_PREVIEW) : (oldCardData.getQueue() == Consts.QUEUE_TYPE_PREVIEW))))))))) ? Consts.QUEUE_TYPE_LRN : oldCardData.getQueue();</span>
<span class="nc" id="L4025">        String type = (new String[] { &quot;new&quot;, &quot;lrn&quot;, &quot;rev&quot; })[n];</span>
<span class="nc bnc" id="L4026" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17328)) {</span>
<span class="nc" id="L4027">            _updateStats(oldCardData, type, -1);</span>
        }
<span class="nc bnc" id="L4029" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17329)) {</span>
<span class="nc" id="L4030">            decrReps();</span>
        }
<span class="nc" id="L4032">    }</span>

    @NonNull
    public Time getTime() {
<span class="fc" id="L4036">        return mCol.getTime();</span>
    }

    /**
     * End #5666
     */
    public void discardCurrentCard() {
<span class="pc bpc" id="L4043" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17330)) {</span>
<span class="fc" id="L4044">            mCurrentCard = null;</span>
        }
<span class="pc bpc" id="L4046" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17331)) {</span>
<span class="fc" id="L4047">            mCurrentCardParentsDid = null;</span>
        }
<span class="fc" id="L4049">    }</span>

    /**
     * This imitate the action of the method answerCard, except that it does not change the state of any card.
     *
     * It means in particular that: + it removes the siblings of card from all queues + change the next card if required
     * it also set variables, so that when querying the next card, the current card can be taken into account.
     */
    public void setCurrentCard(@NonNull Card card) {
<span class="pc bpc" id="L4058" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17332)) {</span>
<span class="fc" id="L4059">            mCurrentCard = card;</span>
        }
<span class="fc" id="L4061">        long did = card.getDid();</span>
<span class="fc" id="L4062">        List&lt;Deck&gt; parents = mCol.getDecks().parents(did);</span>
<span class="pc bpc" id="L4063" title="4 of 8 branches missed.">        List&lt;Long&gt; currentCardParentsDid = new ArrayList&lt;&gt;((ListenerUtil.mutListener.listen(17336) ? (parents.size() % 1) : (ListenerUtil.mutListener.listen(17335) ? (parents.size() / 1) : (ListenerUtil.mutListener.listen(17334) ? (parents.size() * 1) : (ListenerUtil.mutListener.listen(17333) ? (parents.size() - 1) : (parents.size() + 1))))));</span>
<span class="pc bpc" id="L4064" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17338)) {</span>
            {
<span class="fc" id="L4066">                long _loopCounter331 = 0;</span>
<span class="pc bpc" id="L4067" title="1 of 2 branches missed.">                for (JSONObject parent : parents) {</span>
<span class="nc" id="L4068">                    ListenerUtil.loopListener.listen(&quot;_loopCounter331&quot;, ++_loopCounter331);</span>
<span class="nc bnc" id="L4069" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(17337)) {</span>
<span class="nc" id="L4070">                        currentCardParentsDid.add(parent.getLong(&quot;id&quot;));</span>
                    }
<span class="nc" id="L4072">                }</span>
            }
        }
<span class="pc bpc" id="L4075" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17339)) {</span>
<span class="fc" id="L4076">            currentCardParentsDid.add(did);</span>
        }
<span class="pc bpc" id="L4078" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17340)) {</span>
            // were called during `setCurrentCard`.
<span class="fc" id="L4080">            mCurrentCardParentsDid = currentCardParentsDid;</span>
        }
<span class="pc bpc" id="L4082" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17341)) {</span>
<span class="fc" id="L4083">            _burySiblings(card);</span>
        }
<span class="pc bpc" id="L4085" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17342)) {</span>
            // if current card is next card or in the queue
<span class="fc" id="L4087">            mRevQueue.remove(card.getId());</span>
        }
<span class="pc bpc" id="L4089" title="1 of 2 branches missed.">        if (!ListenerUtil.mutListener.listen(17343)) {</span>
<span class="fc" id="L4090">            mNewQueue.remove(card.getId());</span>
        }
<span class="fc" id="L4092">    }</span>

    protected boolean currentCardIsInQueueWithDeck(@Consts.CARD_QUEUE int queue, long did) {
        // mCurrentCard may be set to null when the reviewer gets closed. So we copy it to be sure to avoid NullPointerException
<span class="fc" id="L4096">        Card currentCard = mCurrentCard;</span>
<span class="fc" id="L4097">        List&lt;Long&gt; currentCardParentsDid = mCurrentCardParentsDid;</span>
<span class="pc bpc" id="L4098" title="204 of 218 branches missed.">        return (ListenerUtil.mutListener.listen(17351) ? ((ListenerUtil.mutListener.listen(17350) ? ((ListenerUtil.mutListener.listen(17349) ? (currentCard != null || (ListenerUtil.mutListener.listen(17348) ? (currentCard.getQueue() &gt;= queue) : (ListenerUtil.mutListener.listen(17347) ? (currentCard.getQueue() &lt;= queue) : (ListenerUtil.mutListener.listen(17346) ? (currentCard.getQueue() &gt; queue) : (ListenerUtil.mutListener.listen(17345) ? (currentCard.getQueue() &lt; queue) : (ListenerUtil.mutListener.listen(17344) ? (currentCard.getQueue() != queue) : (currentCard.getQueue() == queue))))))) : (currentCard != null &amp;&amp; (ListenerUtil.mutListener.listen(17348) ? (currentCard.getQueue() &gt;= queue) : (ListenerUtil.mutListener.listen(17347) ? (currentCard.getQueue() &lt;= queue) : (ListenerUtil.mutListener.listen(17346) ? (currentCard.getQueue() &gt; queue) : (ListenerUtil.mutListener.listen(17345) ? (currentCard.getQueue() &lt; queue) : (ListenerUtil.mutListener.listen(17344) ? (currentCard.getQueue() != queue) : (currentCard.getQueue() == queue)))))))) || currentCardParentsDid != null) : ((ListenerUtil.mutListener.listen(17349) ? (currentCard != null || (ListenerUtil.mutListener.listen(17348) ? (currentCard.getQueue() &gt;= queue) : (ListenerUtil.mutListener.listen(17347) ? (currentCard.getQueue() &lt;= queue) : (ListenerUtil.mutListener.listen(17346) ? (currentCard.getQueue() &gt; queue) : (ListenerUtil.mutListener.listen(17345) ? (currentCard.getQueue() &lt; queue) : (ListenerUtil.mutListener.listen(17344) ? (currentCard.getQueue() != queue) : (currentCard.getQueue() == queue))))))) : (currentCard != null &amp;&amp; (ListenerUtil.mutListener.listen(17348) ? (currentCard.getQueue() &gt;= queue) : (ListenerUtil.mutListener.listen(17347) ? (currentCard.getQueue() &lt;= queue) : (ListenerUtil.mutListener.listen(17346) ? (currentCard.getQueue() &gt; queue) : (ListenerUtil.mutListener.listen(17345) ? (currentCard.getQueue() &lt; queue) : (ListenerUtil.mutListener.listen(17344) ? (currentCard.getQueue() != queue) : (currentCard.getQueue() == queue)))))))) &amp;&amp; currentCardParentsDid != null)) || currentCardParentsDid.contains(did)) : ((ListenerUtil.mutListener.listen(17350) ? ((ListenerUtil.mutListener.listen(17349) ? (currentCard != null || (ListenerUtil.mutListener.listen(17348) ? (currentCard.getQueue() &gt;= queue) : (ListenerUtil.mutListener.listen(17347) ? (currentCard.getQueue() &lt;= queue) : (ListenerUtil.mutListener.listen(17346) ? (currentCard.getQueue() &gt; queue) : (ListenerUtil.mutListener.listen(17345) ? (currentCard.getQueue() &lt; queue) : (ListenerUtil.mutListener.listen(17344) ? (currentCard.getQueue() != queue) : (currentCard.getQueue() == queue))))))) : (currentCard != null &amp;&amp; (ListenerUtil.mutListener.listen(17348) ? (currentCard.getQueue() &gt;= queue) : (ListenerUtil.mutListener.listen(17347) ? (currentCard.getQueue() &lt;= queue) : (ListenerUtil.mutListener.listen(17346) ? (currentCard.getQueue() &gt; queue) : (ListenerUtil.mutListener.listen(17345) ? (currentCard.getQueue() &lt; queue) : (ListenerUtil.mutListener.listen(17344) ? (currentCard.getQueue() != queue) : (currentCard.getQueue() == queue)))))))) || currentCardParentsDid != null) : ((ListenerUtil.mutListener.listen(17349) ? (currentCard != null || (ListenerUtil.mutListener.listen(17348) ? (currentCard.getQueue() &gt;= queue) : (ListenerUtil.mutListener.listen(17347) ? (currentCard.getQueue() &lt;= queue) : (ListenerUtil.mutListener.listen(17346) ? (currentCard.getQueue() &gt; queue) : (ListenerUtil.mutListener.listen(17345) ? (currentCard.getQueue() &lt; queue) : (ListenerUtil.mutListener.listen(17344) ? (currentCard.getQueue() != queue) : (currentCard.getQueue() == queue))))))) : (currentCard != null &amp;&amp; (ListenerUtil.mutListener.listen(17348) ? (currentCard.getQueue() &gt;= queue) : (ListenerUtil.mutListener.listen(17347) ? (currentCard.getQueue() &lt;= queue) : (ListenerUtil.mutListener.listen(17346) ? (currentCard.getQueue() &gt; queue) : (ListenerUtil.mutListener.listen(17345) ? (currentCard.getQueue() &lt; queue) : (ListenerUtil.mutListener.listen(17344) ? (currentCard.getQueue() != queue) : (currentCard.getQueue() == queue)))))))) &amp;&amp; currentCardParentsDid != null)) &amp;&amp; currentCardParentsDid.contains(did)));</span>
    }

    @NonNull
    public Collection getCol() {
<span class="fc" id="L4103">        return mCol;</span>
    }

    @Override
    @VisibleForTesting
    @Consts.BUTTON_TYPE
    public int getGoodNewButton() {
<span class="nc" id="L4110">        return Consts.BUTTON_THREE;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>