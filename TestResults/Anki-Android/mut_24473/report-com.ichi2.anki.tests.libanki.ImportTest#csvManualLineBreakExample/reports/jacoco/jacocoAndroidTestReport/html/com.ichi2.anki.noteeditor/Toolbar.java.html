<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Toolbar.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">AnkiDroid</a> &gt; <a href="index.source.html" class="el_package">com.ichi2.anki.noteeditor</a> &gt; <span class="el_source">Toolbar.java</span></div><h1>Toolbar.java</h1><pre class="source lang-java linenums">/*
 *  Copyright (c) 2020 David Allison &lt;davidallisongithub@gmail.com&gt;
 *
 *  This program is free software; you can redistribute it and/or modify it under
 *  the terms of the GNU General Public License as published by the Free Software
 *  Foundation; either version 3 of the License, or (at your option) any later
 *  version.
 *
 *  This program is distributed in the hope that it will be useful, but WITHOUT ANY
 *  WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
 *  PARTICULAR PURPOSE. See the GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License along with
 *  this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.
 */
package com.ichi2.anki.noteeditor;

import android.app.Activity;
import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.graphics.drawable.BitmapDrawable;
import android.graphics.drawable.Drawable;
import android.os.Build;
import android.util.AttributeSet;
import android.util.DisplayMetrics;
import android.util.TypedValue;
import android.view.ContextThemeWrapper;
import android.view.Gravity;
import android.view.KeyEvent;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.FrameLayout;
import android.widget.LinearLayout;
import com.afollestad.materialdialogs.MaterialDialog;
import com.ichi2.anki.R;
import com.ichi2.libanki.Utils;
import com.ichi2.utils.ViewGroupUtils;
import java.util.ArrayList;
import java.util.List;
import androidx.annotation.DrawableRes;
import androidx.annotation.IdRes;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.annotation.RequiresApi;
import androidx.appcompat.widget.AppCompatImageButton;
import androidx.vectordrawable.graphics.drawable.VectorDrawableCompat;
import timber.log.Timber;
import br.ufmg.labsoft.mutvariants.listeners.ListenerUtil;

public class Toolbar extends FrameLayout {

    private TextFormatListener mFormatCallback;

    private LinearLayout mToolbar;

<span class="nc" id="L60">    private List&lt;View&gt; mCustomButtons = new ArrayList&lt;&gt;();</span>

    private View mClozeIcon;

    private Paint mStringPaint;

    public Toolbar(@NonNull Context context) {
<span class="nc" id="L67">        super(context);</span>
<span class="nc bnc" id="L68" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2281)) {</span>
<span class="nc" id="L69">            init();</span>
        }
<span class="nc" id="L71">    }</span>

    public Toolbar(@NonNull Context context, @Nullable AttributeSet attrs) {
<span class="nc" id="L74">        super(context, attrs);</span>
<span class="nc bnc" id="L75" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2282)) {</span>
<span class="nc" id="L76">            init();</span>
        }
<span class="nc" id="L78">    }</span>

    public Toolbar(@NonNull Context context, @Nullable AttributeSet attrs, int defStyleAttr) {
<span class="nc" id="L81">        super(context, attrs, defStyleAttr);</span>
<span class="nc bnc" id="L82" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2283)) {</span>
<span class="nc" id="L83">            init();</span>
        }
<span class="nc" id="L85">    }</span>

    public Toolbar(@NonNull Context context, @Nullable AttributeSet attrs, int defStyleAttr, int defStyleRes) {
<span class="nc" id="L88">        super(context, attrs, defStyleAttr, defStyleRes);</span>
<span class="nc bnc" id="L89" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2284)) {</span>
<span class="nc" id="L90">            init();</span>
        }
<span class="nc" id="L92">    }</span>

    private void init() {
<span class="nc bnc" id="L95" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2285)) {</span>
<span class="nc" id="L96">            LayoutInflater.from(getContext()).inflate(R.layout.note_editor_toolbar, this, true);</span>
        }
<span class="nc" id="L98">        int paintSize = dpToPixels(28);</span>
<span class="nc bnc" id="L99" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2286)) {</span>
<span class="nc" id="L100">            mStringPaint = new Paint(Paint.ANTI_ALIAS_FLAG);</span>
        }
<span class="nc bnc" id="L102" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2287)) {</span>
<span class="nc" id="L103">            mStringPaint.setTextSize(paintSize);</span>
        }
<span class="nc bnc" id="L105" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2288)) {</span>
<span class="nc" id="L106">            mStringPaint.setColor(Color.BLACK);</span>
        }
<span class="nc bnc" id="L108" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2289)) {</span>
<span class="nc" id="L109">            mStringPaint.setTextAlign(Paint.Align.CENTER);</span>
        }
<span class="nc bnc" id="L111" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2290)) {</span>
<span class="nc" id="L112">            this.mToolbar = findViewById(R.id.editor_toolbar_internal);</span>
        }
<span class="nc bnc" id="L114" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2291)) {</span>
<span class="nc" id="L115">            setClick(R.id.note_editor_toolbar_button_bold, &quot;&lt;b&gt;&quot;, &quot;&lt;/b&gt;&quot;);</span>
        }
<span class="nc bnc" id="L117" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2292)) {</span>
<span class="nc" id="L118">            setClick(R.id.note_editor_toolbar_button_italic, &quot;&lt;em&gt;&quot;, &quot;&lt;/em&gt;&quot;);</span>
        }
<span class="nc bnc" id="L120" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2293)) {</span>
<span class="nc" id="L121">            setClick(R.id.note_editor_toolbar_button_underline, &quot;&lt;u&gt;&quot;, &quot;&lt;/u&gt;&quot;);</span>
        }
<span class="nc bnc" id="L123" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2294)) {</span>
<span class="nc" id="L124">            setClick(R.id.note_editor_toolbar_button_insert_mathjax, &quot;\\(&quot;, &quot;\\)&quot;);</span>
        }
<span class="nc bnc" id="L126" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2295)) {</span>
<span class="nc" id="L127">            setClick(R.id.note_editor_toolbar_button_horizontal_rule, &quot;&lt;hr&gt;&quot;, &quot;&quot;);</span>
        }
<span class="nc bnc" id="L129" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2296)) {</span>
<span class="nc" id="L130">            findViewById(R.id.note_editor_toolbar_button_font_size).setOnClickListener(l -&gt; displayFontSizeDialog());</span>
        }
<span class="nc bnc" id="L132" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2297)) {</span>
<span class="nc" id="L133">            findViewById(R.id.note_editor_toolbar_button_title).setOnClickListener(l -&gt; displayInsertHeadingDialog());</span>
        }
<span class="nc bnc" id="L135" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2298)) {</span>
<span class="nc" id="L136">            this.mClozeIcon = findViewById(R.id.note_editor_toolbar_button_cloze);</span>
        }
<span class="nc" id="L138">    }</span>

    @Override
    public boolean onKeyUp(int keyCode, KeyEvent event) {
<span class="nc bnc" id="L142" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2302)) {</span>
            // I'll avoid checking &quot;function&quot; here as it may be required to press Ctrl
<span class="nc bnc" id="L144" title="All 58 branches missed.">            if ((ListenerUtil.mutListener.listen(2301) ? ((ListenerUtil.mutListener.listen(2300) ? ((ListenerUtil.mutListener.listen(2299) ? (!event.isCtrlPressed() &amp;&amp; event.isAltPressed()) : (!event.isCtrlPressed() || event.isAltPressed())) &amp;&amp; event.isShiftPressed()) : ((ListenerUtil.mutListener.listen(2299) ? (!event.isCtrlPressed() &amp;&amp; event.isAltPressed()) : (!event.isCtrlPressed() || event.isAltPressed())) || event.isShiftPressed())) &amp;&amp; event.isMetaPressed()) : ((ListenerUtil.mutListener.listen(2300) ? ((ListenerUtil.mutListener.listen(2299) ? (!event.isCtrlPressed() &amp;&amp; event.isAltPressed()) : (!event.isCtrlPressed() || event.isAltPressed())) &amp;&amp; event.isShiftPressed()) : ((ListenerUtil.mutListener.listen(2299) ? (!event.isCtrlPressed() &amp;&amp; event.isAltPressed()) : (!event.isCtrlPressed() || event.isAltPressed())) || event.isShiftPressed())) || event.isMetaPressed()))) {</span>
<span class="nc" id="L145">                return false;</span>
            }
        }
        char c;
        try {
<span class="nc" id="L150">            c = (char) event.getUnicodeChar(0);</span>
<span class="nc" id="L151">        } catch (Exception e) {</span>
<span class="nc" id="L152">            return false;</span>
<span class="nc" id="L153">        }</span>
<span class="nc bnc" id="L154" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2303)) {</span>
<span class="nc bnc" id="L155" title="All 2 branches missed.">            if (c == '\0') {</span>
<span class="nc" id="L156">                return false;</span>
            }
        }
<span class="nc" id="L159">        String expected = Character.toString(c);</span>
<span class="nc bnc" id="L160" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2307)) {</span>
            {
<span class="nc" id="L162">                long _loopCounter40 = 0;</span>
<span class="nc bnc" id="L163" title="All 2 branches missed.">                for (View v : ViewGroupUtils.getAllChildrenRecursive(this)) {</span>
<span class="nc" id="L164">                    ListenerUtil.loopListener.listen(&quot;_loopCounter40&quot;, ++_loopCounter40);</span>
<span class="nc bnc" id="L165" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2306)) {</span>
<span class="nc bnc" id="L166" title="All 2 branches missed.">                        if (Utils.equals(expected, v.getTag())) {</span>
<span class="nc bnc" id="L167" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2304)) {</span>
<span class="nc" id="L168">                                Timber.i(&quot;Handling Ctrl + %s&quot;, c);</span>
                            }
<span class="nc bnc" id="L170" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2305)) {</span>
<span class="nc" id="L171">                                v.performClick();</span>
                            }
<span class="nc" id="L173">                            return true;</span>
                        }
                    }
<span class="nc" id="L176">                }</span>
            }
        }
<span class="nc" id="L179">        return super.onKeyUp(keyCode, event);</span>
    }

    private int dpToPixels(int value) {
<span class="nc" id="L183">        return (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP, value, getResources().getDisplayMetrics());</span>
    }

    public View getClozeIcon() {
        // HACK until API 21 FIXME can this be altered now?
<span class="nc" id="L188">        return mClozeIcon;</span>
    }

    @NonNull
    public AppCompatImageButton insertItem(@IdRes int id, @DrawableRes int drawable, Runnable runnable) {
        // A null theme can be passed after colorControlNormal is defined (API 25)
<span class="nc" id="L194">        Context themeContext = new ContextThemeWrapper(getContext(), R.style.Theme_Light_Compat);</span>
<span class="nc" id="L195">        VectorDrawableCompat d = VectorDrawableCompat.create(getContext().getResources(), drawable, themeContext.getTheme());</span>
<span class="nc" id="L196">        return insertItem(id, d, runnable);</span>
    }

    @NonNull
    public View insertItem(int id, Drawable drawable, TextFormatter formatter) {
<span class="nc" id="L201">        return insertItem(id, drawable, () -&gt; onFormat(formatter));</span>
    }

    @NonNull
    public AppCompatImageButton insertItem(@IdRes int id, Drawable drawable, Runnable runnable) {
<span class="nc" id="L206">        Context context = getContext();</span>
<span class="nc" id="L207">        AppCompatImageButton button = new AppCompatImageButton(context);</span>
<span class="nc bnc" id="L208" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2308)) {</span>
<span class="nc" id="L209">            button.setId(id);</span>
        }
<span class="nc bnc" id="L211" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2309)) {</span>
<span class="nc" id="L212">            button.setBackgroundDrawable(drawable);</span>
        }
        // apply style
<span class="nc" id="L215">        LinearLayout.LayoutParams params = new LinearLayout.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT, ViewGroup.LayoutParams.WRAP_CONTENT);</span>
<span class="nc bnc" id="L216" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2310)) {</span>
<span class="nc" id="L217">            params.gravity = Gravity.CENTER;</span>
        }
<span class="nc bnc" id="L219" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2311)) {</span>
<span class="nc" id="L220">            button.setLayoutParams(params);</span>
        }
<span class="nc bnc" id="L222" title="All 8 branches missed.">        int fourDp = (int) Math.ceil((ListenerUtil.mutListener.listen(2315) ? (4 % context.getResources().getDisplayMetrics().density) : (ListenerUtil.mutListener.listen(2314) ? (4 * context.getResources().getDisplayMetrics().density) : (ListenerUtil.mutListener.listen(2313) ? (4 - context.getResources().getDisplayMetrics().density) : (ListenerUtil.mutListener.listen(2312) ? (4 + context.getResources().getDisplayMetrics().density) : (4 / context.getResources().getDisplayMetrics().density))))));</span>
<span class="nc bnc" id="L223" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2316)) {</span>
<span class="nc" id="L224">            button.setPadding(fourDp, fourDp, fourDp, fourDp);</span>
        }
<span class="nc bnc" id="L226" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2317)) {</span>
<span class="nc" id="L227">            this.mToolbar.addView(button, mToolbar.getChildCount());</span>
        }
<span class="nc bnc" id="L229" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2318)) {</span>
<span class="nc" id="L230">            mCustomButtons.add(button);</span>
        }
<span class="nc bnc" id="L232" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2319)) {</span>
<span class="nc" id="L233">            button.setOnClickListener(l -&gt; runnable.run());</span>
        }
        // Hack - items are truncated from the scrollview
<span class="nc" id="L236">        View v = findViewById(R.id.editor_toolbar_internal);</span>
<span class="nc bnc" id="L237" title="All 8 branches missed.">        int expectedWidth = (ListenerUtil.mutListener.listen(2323) ? (getVisibleItemCount() % dpToPixels(32)) : (ListenerUtil.mutListener.listen(2322) ? (getVisibleItemCount() / dpToPixels(32)) : (ListenerUtil.mutListener.listen(2321) ? (getVisibleItemCount() - dpToPixels(32)) : (ListenerUtil.mutListener.listen(2320) ? (getVisibleItemCount() + dpToPixels(32)) : (getVisibleItemCount() * dpToPixels(32))))));</span>
<span class="nc" id="L238">        int width = getScreenWidth();</span>
<span class="nc" id="L239">        LayoutParams p = new LayoutParams(v.getLayoutParams());</span>
<span class="nc bnc" id="L240" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2329)) {</span>
<span class="nc bnc" id="L241" title="All 22 branches missed.">            p.gravity = Gravity.CENTER_VERTICAL | (((ListenerUtil.mutListener.listen(2328) ? (expectedWidth &gt;= width) : (ListenerUtil.mutListener.listen(2327) ? (expectedWidth &lt;= width) : (ListenerUtil.mutListener.listen(2326) ? (expectedWidth &lt; width) : (ListenerUtil.mutListener.listen(2325) ? (expectedWidth != width) : (ListenerUtil.mutListener.listen(2324) ? (expectedWidth == width) : (expectedWidth &gt; width))))))) ? Gravity.LEFT : Gravity.CENTER_HORIZONTAL);</span>
        }
<span class="nc bnc" id="L243" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2330)) {</span>
<span class="nc" id="L244">            v.setLayoutParams(p);</span>
        }
<span class="nc" id="L246">        return button;</span>
    }

    protected int getScreenWidth() {
<span class="nc" id="L250">        DisplayMetrics displayMetrics = new DisplayMetrics();</span>
<span class="nc bnc" id="L251" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2331)) {</span>
<span class="nc" id="L252">            ((Activity) getContext()).getWindowManager().getDefaultDisplay().getMetrics(displayMetrics);</span>
        }
<span class="nc" id="L254">        return displayMetrics.widthPixels;</span>
    }

    public void clearCustomItems() {
<span class="nc bnc" id="L258" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2333)) {</span>
            {
<span class="nc" id="L260">                long _loopCounter41 = 0;</span>
<span class="nc bnc" id="L261" title="All 2 branches missed.">                for (View v : mCustomButtons) {</span>
<span class="nc" id="L262">                    ListenerUtil.loopListener.listen(&quot;_loopCounter41&quot;, ++_loopCounter41);</span>
<span class="nc bnc" id="L263" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2332)) {</span>
<span class="nc" id="L264">                        mToolbar.removeView(v);</span>
                    }
<span class="nc" id="L266">                }</span>
            }
        }
<span class="nc bnc" id="L269" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2334)) {</span>
<span class="nc" id="L270">            mCustomButtons.clear();</span>
        }
<span class="nc" id="L272">    }</span>

    public void setFormatListener(TextFormatListener formatter) {
<span class="nc bnc" id="L275" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2335)) {</span>
<span class="nc" id="L276">            mFormatCallback = formatter;</span>
        }
<span class="nc" id="L278">    }</span>

    private void displayFontSizeDialog() {
<span class="nc" id="L281">        String[] results = getResources().getStringArray(R.array.html_size_codes);</span>
<span class="nc bnc" id="L282" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2336)) {</span>
            // Might be better to add this as a fragment - let's see.
<span class="nc" id="L284">            new MaterialDialog.Builder(getContext()).items(R.array.html_size_code_labels).itemsCallback((dialog, view, pos, string) -&gt; {</span>
<span class="nc" id="L285">                String prefix = &quot;&lt;span style=\&quot;font-size:&quot; + results[pos] + &quot;\&quot;&gt;&quot;;</span>
<span class="nc" id="L286">                String suffix = &quot;&lt;/span&gt;&quot;;</span>
<span class="nc" id="L287">                TextWrapper formatter = new TextWrapper(prefix, suffix);</span>
<span class="nc" id="L288">                onFormat(formatter);</span>
<span class="nc" id="L289">            }).title(R.string.menu_font_size).show();</span>
        }
<span class="nc" id="L291">    }</span>

    private void displayInsertHeadingDialog() {
<span class="nc bnc" id="L294" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2337)) {</span>
<span class="nc" id="L295">            new MaterialDialog.Builder(getContext()).items(new String[] { &quot;h1&quot;, &quot;h2&quot;, &quot;h3&quot;, &quot;h4&quot;, &quot;h5&quot; }).itemsCallback((dialog, view, pos, string) -&gt; {</span>
<span class="nc" id="L296">                String prefix = &quot;&lt;&quot; + string + &quot;&gt;&quot;;</span>
<span class="nc" id="L297">                String suffix = &quot;&lt;/&quot; + string + &quot;&gt;&quot;;</span>
<span class="nc" id="L298">                TextWrapper formatter = new TextWrapper(prefix, suffix);</span>
<span class="nc" id="L299">                onFormat(formatter);</span>
<span class="nc" id="L300">            }).title(R.string.insert_heading).show();</span>
        }
<span class="nc" id="L302">    }</span>

    @NonNull
    public Drawable createDrawableForString(String text) {
<span class="nc" id="L306">        float baseline = -mStringPaint.ascent();</span>
<span class="nc" id="L307">        int size = (int) (baseline + mStringPaint.descent() + 0.5f);</span>
<span class="nc" id="L308">        Bitmap image = Bitmap.createBitmap(size, size, Bitmap.Config.ARGB_8888);</span>
<span class="nc" id="L309">        Canvas canvas = new Canvas(image);</span>
<span class="nc bnc" id="L310" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2342)) {</span>
<span class="nc bnc" id="L311" title="All 8 branches missed.">            canvas.drawText(text, (ListenerUtil.mutListener.listen(2341) ? (size % 2f) : (ListenerUtil.mutListener.listen(2340) ? (size * 2f) : (ListenerUtil.mutListener.listen(2339) ? (size - 2f) : (ListenerUtil.mutListener.listen(2338) ? (size + 2f) : (size / 2f))))), baseline, mStringPaint);</span>
        }
<span class="nc" id="L313">        return new BitmapDrawable(getResources(), image);</span>
    }

    private int getVisibleItemCount() {
<span class="nc" id="L317">        int count = 0;</span>
<span class="nc bnc" id="L318" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2350)) {</span>
            {
<span class="nc" id="L320">                long _loopCounter42 = 0;</span>
<span class="nc bnc" id="L321" title="All 22 branches missed.">                for (int i = 0; (ListenerUtil.mutListener.listen(2349) ? (i &gt;= mToolbar.getChildCount()) : (ListenerUtil.mutListener.listen(2348) ? (i &lt;= mToolbar.getChildCount()) : (ListenerUtil.mutListener.listen(2347) ? (i &gt; mToolbar.getChildCount()) : (ListenerUtil.mutListener.listen(2346) ? (i != mToolbar.getChildCount()) : (ListenerUtil.mutListener.listen(2345) ? (i == mToolbar.getChildCount()) : (i &lt; mToolbar.getChildCount())))))); i++) {</span>
<span class="nc" id="L322">                    ListenerUtil.loopListener.listen(&quot;_loopCounter42&quot;, ++_loopCounter42);</span>
<span class="nc bnc" id="L323" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2344)) {</span>
<span class="nc bnc" id="L324" title="All 2 branches missed.">                        if (mToolbar.getChildAt(i).getVisibility() == View.VISIBLE) {</span>
<span class="nc bnc" id="L325" title="All 2 branches missed.">                            if (!ListenerUtil.mutListener.listen(2343)) {</span>
<span class="nc" id="L326">                                count++;</span>
                            }
                        }
                    }
                }
            }
        }
<span class="nc" id="L333">        return count;</span>
    }

    private void setClick(@IdRes int id, String prefix, String suffix) {
<span class="nc bnc" id="L337" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2351)) {</span>
<span class="nc" id="L338">            setClick(id, new TextWrapper(prefix, suffix));</span>
        }
<span class="nc" id="L340">    }</span>

    private void setClick(int id, TextFormatter textWrapper) {
<span class="nc bnc" id="L343" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2352)) {</span>
<span class="nc" id="L344">            findViewById(id).setOnClickListener(l -&gt; onFormat(textWrapper));</span>
        }
<span class="nc" id="L346">    }</span>

    public void onFormat(TextFormatter formatter) {
<span class="nc bnc" id="L349" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2353)) {</span>
<span class="nc bnc" id="L350" title="All 2 branches missed.">            if (mFormatCallback == null) {</span>
<span class="nc" id="L351">                return;</span>
            }
        }
<span class="nc bnc" id="L354" title="All 2 branches missed.">        if (!ListenerUtil.mutListener.listen(2354)) {</span>
<span class="nc" id="L355">            mFormatCallback.performFormat(formatter);</span>
        }
<span class="nc" id="L357">    }</span>

    public interface TextFormatListener {

        void performFormat(TextFormatter formatter);
    }

    public interface TextFormatter {

        TextWrapper.StringFormat format(String s);
    }

    public static class TextWrapper implements TextFormatter {

        private final String mPrefix;

        private final String mSuffix;

<span class="nc" id="L375">        public TextWrapper(String prefix, String suffix) {</span>
<span class="nc" id="L376">            this.mPrefix = prefix;</span>
<span class="nc" id="L377">            this.mSuffix = suffix;</span>
<span class="nc" id="L378">        }</span>

        @Override
        public StringFormat format(String s) {
<span class="nc" id="L382">            StringFormat stringFormat = new StringFormat();</span>
<span class="nc bnc" id="L383" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2355)) {</span>
<span class="nc" id="L384">                stringFormat.result = mPrefix + s + mSuffix;</span>
            }
<span class="nc bnc" id="L386" title="All 2 branches missed.">            if (!ListenerUtil.mutListener.listen(2365)) {</span>
<span class="nc bnc" id="L387" title="All 22 branches missed.">                if ((ListenerUtil.mutListener.listen(2360) ? (s.length() &gt;= 0) : (ListenerUtil.mutListener.listen(2359) ? (s.length() &lt;= 0) : (ListenerUtil.mutListener.listen(2358) ? (s.length() &gt; 0) : (ListenerUtil.mutListener.listen(2357) ? (s.length() &lt; 0) : (ListenerUtil.mutListener.listen(2356) ? (s.length() != 0) : (s.length() == 0))))))) {</span>
<span class="nc bnc" id="L388" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2363)) {</span>
<span class="nc" id="L389">                        stringFormat.start = mPrefix.length();</span>
                    }
<span class="nc bnc" id="L391" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2364)) {</span>
<span class="nc" id="L392">                        stringFormat.end = mPrefix.length();</span>
                    }
                } else {
<span class="nc bnc" id="L395" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2361)) {</span>
<span class="nc" id="L396">                        stringFormat.start = 0;</span>
                    }
<span class="nc bnc" id="L398" title="All 2 branches missed.">                    if (!ListenerUtil.mutListener.listen(2362)) {</span>
<span class="nc" id="L399">                        stringFormat.end = stringFormat.result.length();</span>
                    }
                }
            }
<span class="nc" id="L403">            return stringFormat;</span>
        }

<span class="nc" id="L406">        public static class StringFormat {</span>

            public String result;

            public int start;

            public int end;
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>