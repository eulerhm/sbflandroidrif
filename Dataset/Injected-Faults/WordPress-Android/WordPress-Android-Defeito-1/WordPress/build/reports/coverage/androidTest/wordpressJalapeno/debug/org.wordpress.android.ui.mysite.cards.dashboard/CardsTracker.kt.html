<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>CardsTracker.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">wordpressJalapenoDebug</a> &gt; <a href="index.source.html" class="el_package">org.wordpress.android.ui.mysite.cards.dashboard</a> &gt; <span class="el_source">CardsTracker.kt</span></div><h1>CardsTracker.kt</h1><pre class="source lang-java linenums">package org.wordpress.android.ui.mysite.cards.dashboard

import org.wordpress.android.analytics.AnalyticsTracker.Stat
import org.wordpress.android.fluxc.store.QuickStartStore.QuickStartTaskType
import org.wordpress.android.ui.mysite.MySiteCardAndItem.Card.DashboardCards
import org.wordpress.android.ui.mysite.MySiteCardAndItem.DashboardCardType
import org.wordpress.android.ui.mysite.cards.dashboard.CardsTracker.PostSubtype
import org.wordpress.android.ui.mysite.cards.dashboard.CardsTracker.QuickStartSubtype
import org.wordpress.android.ui.mysite.cards.dashboard.CardsTracker.Type
import org.wordpress.android.ui.mysite.cards.dashboard.posts.PostCardType
import org.wordpress.android.ui.quickstart.QuickStartTracker
import org.wordpress.android.ui.quickstart.QuickStartType
import org.wordpress.android.util.analytics.AnalyticsTrackerWrapper
import javax.inject.Inject

<span class="nc" id="L16">@Suppress(&quot;TooManyFunctions&quot;)</span>
<span class="nc" id="L17">class CardsTracker @Inject constructor(</span>
<span class="nc" id="L18">    private val cardsShownTracker: CardsShownTracker,</span>
<span class="nc" id="L19">    private val analyticsTrackerWrapper: AnalyticsTrackerWrapper,</span>
<span class="nc" id="L20">    private val quickStartTracker: QuickStartTracker</span>
) {
<span class="nc" id="L22">    enum class Type(val label: String) {</span>
<span class="nc" id="L23">        ERROR(&quot;error&quot;),</span>
<span class="nc" id="L24">        QUICK_START(&quot;quick_start&quot;),</span>
<span class="nc" id="L25">        STATS(&quot;stats&quot;),</span>
<span class="nc" id="L26">        POST(&quot;post&quot;),</span>
<span class="nc" id="L27">        BLOGGING_PROMPT(&quot;blogging_prompt&quot;)</span>
    }

<span class="nc" id="L30">    enum class QuickStartSubtype(val label: String) {</span>
<span class="nc" id="L31">        CUSTOMIZE(&quot;customize&quot;),</span>
<span class="nc" id="L32">        GROW(&quot;grow&quot;),</span>
<span class="nc" id="L33">        GET_TO_KNOW_APP(&quot;get_to_know_app&quot;),</span>
<span class="nc" id="L34">        UNKNOWN(&quot;unkown&quot;)</span>
    }

<span class="nc" id="L37">    enum class StatsSubtype(val label: String) {</span>
<span class="nc" id="L38">        TODAYS_STATS(&quot;todays_stats&quot;),</span>
<span class="nc" id="L39">        TODAYS_STATS_NUDGE(&quot;todays_stats_nudge&quot;)</span>
    }

<span class="nc" id="L42">    enum class PostSubtype(val label: String) {</span>
<span class="nc" id="L43">        CREATE_FIRST(&quot;create_first&quot;),</span>
<span class="nc" id="L44">        CREATE_NEXT(&quot;create_next&quot;),</span>
<span class="nc" id="L45">        DRAFT(&quot;draft&quot;),</span>
<span class="nc" id="L46">        SCHEDULED(&quot;scheduled&quot;)</span>
    }

    fun trackQuickStartCardItemClicked(quickStartTaskType: QuickStartTaskType) {
<span class="nc" id="L50">        trackCardItemClicked(Type.QUICK_START.label, quickStartTaskType.toSubtypeValue().label)</span>
<span class="nc" id="L51">    }</span>

    fun trackTodaysStatsCardGetMoreViewsNudgeClicked() {
<span class="nc" id="L54">        trackCardItemClicked(Type.STATS.label, StatsSubtype.TODAYS_STATS_NUDGE.label)</span>
<span class="nc" id="L55">    }</span>

    fun trackTodaysStatsCardFooterLinkClicked() {
<span class="nc" id="L58">        trackCardFooterLinkClicked(Type.STATS.label, StatsSubtype.TODAYS_STATS.label)</span>
<span class="nc" id="L59">    }</span>

    fun trackTodaysStatsCardClicked() {
<span class="nc" id="L62">        trackCardItemClicked(Type.STATS.label, StatsSubtype.TODAYS_STATS.label)</span>
<span class="nc" id="L63">    }</span>

    fun trackPostCardFooterLinkClicked(postCardType: PostCardType) {
<span class="nc" id="L66">        trackCardFooterLinkClicked(Type.POST.label, postCardType.toSubtypeValue().label)</span>
<span class="nc" id="L67">    }</span>

    fun trackPostItemClicked(postCardType: PostCardType) {
<span class="nc" id="L70">        trackCardItemClicked(Type.POST.label, postCardType.toSubtypeValue().label)</span>
<span class="nc" id="L71">    }</span>

    private fun trackCardFooterLinkClicked(type: String, subtype: String) {
<span class="nc" id="L74">        analyticsTrackerWrapper.track(</span>
<span class="nc" id="L75">                Stat.MY_SITE_DASHBOARD_CARD_FOOTER_ACTION_TAPPED,</span>
<span class="nc" id="L76">                mapOf(</span>
<span class="nc" id="L77">                        TYPE to type,</span>
<span class="nc" id="L78">                        SUBTYPE to subtype</span>
                )
        )
<span class="nc" id="L81">    }</span>

    private fun trackCardItemClicked(type: String, subtype: String) {
<span class="nc" id="L84">        val props = mapOf(TYPE to type, SUBTYPE to subtype)</span>
<span class="nc bnc" id="L85" title="All 2 branches missed.">        if (type == Type.QUICK_START.label) {</span>
<span class="nc" id="L86">            quickStartTracker.track(Stat.MY_SITE_DASHBOARD_CARD_ITEM_TAPPED, props)</span>
        } else {
<span class="nc" id="L88">            analyticsTrackerWrapper.track(Stat.MY_SITE_DASHBOARD_CARD_ITEM_TAPPED, props)</span>
        }
<span class="nc" id="L90">    }</span>

    fun resetShown() {
<span class="nc" id="L93">        cardsShownTracker.reset()</span>
<span class="nc" id="L94">    }</span>

    fun trackShown(dashboardCards: DashboardCards) {
<span class="nc" id="L97">        cardsShownTracker.track(dashboardCards)</span>
<span class="nc" id="L98">    }</span>

    fun trackQuickStartCardShown(quickStartType: QuickStartType) {
<span class="nc" id="L101">        cardsShownTracker.trackQuickStartCardShown(quickStartType)</span>
<span class="nc" id="L102">    }</span>

    companion object {
        const val TYPE = &quot;type&quot;
        const val SUBTYPE = &quot;subtype&quot;
        const val STATS = &quot;stats&quot;
    }
}

fun DashboardCardType.toTypeValue(): Type {
<span class="nc bnc" id="L112" title="All 8 branches missed.">    return when (this) {</span>
<span class="nc" id="L113">        DashboardCardType.ERROR_CARD -&gt; Type.ERROR</span>
<span class="nc" id="L114">        DashboardCardType.QUICK_START_CARD -&gt; Type.QUICK_START</span>
<span class="nc" id="L115">        DashboardCardType.TODAYS_STATS_CARD_ERROR -&gt; Type.ERROR</span>
<span class="nc" id="L116">        DashboardCardType.TODAYS_STATS_CARD -&gt; Type.STATS</span>
<span class="nc" id="L117">        DashboardCardType.POST_CARD_ERROR -&gt; Type.ERROR</span>
<span class="nc" id="L118">        DashboardCardType.POST_CARD_WITHOUT_POST_ITEMS -&gt; Type.POST</span>
<span class="nc" id="L119">        DashboardCardType.POST_CARD_WITH_POST_ITEMS -&gt; Type.POST</span>
<span class="nc" id="L120">        DashboardCardType.BLOGGING_PROMPT_CARD -&gt; Type.BLOGGING_PROMPT</span>
    }
}

fun PostCardType.toSubtypeValue(): PostSubtype {
<span class="nc bnc" id="L125" title="All 4 branches missed.">    return when (this) {</span>
<span class="nc" id="L126">        PostCardType.CREATE_FIRST -&gt; PostSubtype.CREATE_FIRST</span>
<span class="nc" id="L127">        PostCardType.CREATE_NEXT -&gt; PostSubtype.CREATE_NEXT</span>
<span class="nc" id="L128">        PostCardType.DRAFT -&gt; PostSubtype.DRAFT</span>
<span class="nc" id="L129">        PostCardType.SCHEDULED -&gt; PostSubtype.SCHEDULED</span>
    }
}

fun QuickStartTaskType.toSubtypeValue(): QuickStartSubtype {
<span class="nc bnc" id="L134" title="All 4 branches missed.">    return when (this) {</span>
<span class="nc" id="L135">        QuickStartTaskType.CUSTOMIZE -&gt; QuickStartSubtype.CUSTOMIZE</span>
<span class="nc" id="L136">        QuickStartTaskType.GROW -&gt; QuickStartSubtype.GROW</span>
<span class="nc" id="L137">        QuickStartTaskType.GET_TO_KNOW_APP -&gt; QuickStartSubtype.GET_TO_KNOW_APP</span>
<span class="nc" id="L138">        QuickStartTaskType.UNKNOWN -&gt; QuickStartSubtype.UNKNOWN</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span>Generated by the Android Gradle plugin 7.1.1</div></body></html>