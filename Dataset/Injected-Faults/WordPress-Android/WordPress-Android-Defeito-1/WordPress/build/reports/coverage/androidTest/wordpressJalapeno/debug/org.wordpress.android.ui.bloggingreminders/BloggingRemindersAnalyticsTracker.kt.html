<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>BloggingRemindersAnalyticsTracker.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">wordpressJalapenoDebug</a> &gt; <a href="index.source.html" class="el_package">org.wordpress.android.ui.bloggingreminders</a> &gt; <span class="el_source">BloggingRemindersAnalyticsTracker.kt</span></div><h1>BloggingRemindersAnalyticsTracker.kt</h1><pre class="source lang-java linenums">package org.wordpress.android.ui.bloggingreminders

import org.wordpress.android.analytics.AnalyticsTracker.Stat
import org.wordpress.android.analytics.AnalyticsTracker.Stat.BLOGGING_REMINDERS_BUTTON_PRESSED
import org.wordpress.android.analytics.AnalyticsTracker.Stat.BLOGGING_REMINDERS_CANCELLED
import org.wordpress.android.analytics.AnalyticsTracker.Stat.BLOGGING_REMINDERS_FLOW_COMPLETED
import org.wordpress.android.analytics.AnalyticsTracker.Stat.BLOGGING_REMINDERS_FLOW_DISMISSED
import org.wordpress.android.analytics.AnalyticsTracker.Stat.BLOGGING_REMINDERS_FLOW_START
import org.wordpress.android.analytics.AnalyticsTracker.Stat.BLOGGING_REMINDERS_NOTIFICATION_RECEIVED
import org.wordpress.android.analytics.AnalyticsTracker.Stat.BLOGGING_REMINDERS_SCHEDULED
import org.wordpress.android.analytics.AnalyticsTracker.Stat.BLOGGING_REMINDERS_SCREEN_SHOWN
import org.wordpress.android.fluxc.store.SiteStore
import org.wordpress.android.ui.bloggingreminders.BloggingRemindersAnalyticsTracker.Button.CONTINUE
import org.wordpress.android.ui.bloggingreminders.BloggingRemindersAnalyticsTracker.SiteType.SELF_HOSTED
import org.wordpress.android.ui.bloggingreminders.BloggingRemindersAnalyticsTracker.SiteType.WORDPRESS_COM
import org.wordpress.android.ui.bloggingreminders.BloggingRemindersViewModel.Screen
import org.wordpress.android.util.analytics.AnalyticsTrackerWrapper
import javax.inject.Inject

<span class="fc" id="L20">@Suppress(&quot;TooManyFunctions&quot;)</span>
<span class="fc" id="L21">class BloggingRemindersAnalyticsTracker @Inject constructor(</span>
<span class="fc" id="L22">    private val analyticsTracker: AnalyticsTrackerWrapper,</span>
<span class="fc" id="L23">    private val siteStore: SiteStore</span>
) {
    private var siteType: SiteType? = null

<span class="nc bnc" id="L27" title="All 2 branches missed.">    fun setSite(siteId: Int) = siteStore.getSiteByLocalId(siteId)?.let { site -&gt;</span>
<span class="nc bnc" id="L28" title="All 2 branches missed.">        siteType = if (site.isWPCom) WORDPRESS_COM else SELF_HOSTED</span>
<span class="nc" id="L29">    }</span>

<span class="nc" id="L31">    fun trackScreenShown(screen: Screen) = track(</span>
<span class="nc" id="L32">            BLOGGING_REMINDERS_SCREEN_SHOWN,</span>
<span class="nc" id="L33">            mapOf(SCREEN_KEY to screen.trackingName)</span>
<span class="nc" id="L34">    )</span>

<span class="nc" id="L36">    fun trackPrimaryButtonPressed(screen: Screen) = trackButtonPressed(screen, CONTINUE)</span>

<span class="nc" id="L38">    private fun trackButtonPressed(screen: Screen, button: Button) = track(</span>
<span class="nc" id="L39">            BLOGGING_REMINDERS_BUTTON_PRESSED,</span>
<span class="nc" id="L40">            mapOf(</span>
<span class="nc" id="L41">                    SCREEN_KEY to screen.trackingName,</span>
<span class="nc" id="L42">                    BUTTON_KEY to button.trackingName</span>
            )
<span class="nc" id="L44">    )</span>

<span class="nc" id="L46">    fun trackFlowStart(source: Source) = track(</span>
<span class="nc" id="L47">            BLOGGING_REMINDERS_FLOW_START,</span>
<span class="nc" id="L48">            mapOf(SOURCE_KEY to source.trackingName)</span>
<span class="nc" id="L49">    )</span>

<span class="nc" id="L51">    fun trackFlowDismissed(source: Screen) = track(</span>
<span class="nc" id="L52">            BLOGGING_REMINDERS_FLOW_DISMISSED,</span>
<span class="nc" id="L53">            mapOf(SOURCE_KEY to source.trackingName)</span>
<span class="nc" id="L54">    )</span>

<span class="nc" id="L56">    fun trackFlowCompleted() = track(BLOGGING_REMINDERS_FLOW_COMPLETED)</span>

<span class="nc" id="L58">    fun trackRemindersScheduled(daysCount: Int, timeSelected: CharSequence) = track(</span>
<span class="nc" id="L59">            BLOGGING_REMINDERS_SCHEDULED,</span>
<span class="nc" id="L60">            mapOf(DAYS_OF_WEEK_COUNT_KEY to daysCount, SELECTED_TIME_KEY to timeSelected)</span>
<span class="nc" id="L61">    )</span>

<span class="nc" id="L63">    fun trackRemindersCancelled() = track(BLOGGING_REMINDERS_CANCELLED)</span>

<span class="nc" id="L65">    fun trackNotificationReceived(promptIncluded: Boolean) = track(</span>
<span class="nc" id="L66">            BLOGGING_REMINDERS_NOTIFICATION_RECEIVED, mapOf(PROMPT_INCLUDED to &quot;$promptIncluded&quot;)</span>
<span class="nc" id="L67">    )</span>

    fun trackRemindersIncludePromptPressed(promptEnabled: Boolean) =
<span class="nc" id="L70">            track(Stat.BLOGGING_REMINDERS_INCLUDE_PROMPT_TAPPED, mapOf(PROMPT_ENABLED_KEY to &quot;$promptEnabled&quot;))</span>

<span class="nc" id="L72">    fun trackRemindersIncludePromptHelpPressed() = track(Stat.BLOGGING_REMINDERS_INCLUDE_PROMPT_HELP_TAPPED)</span>

<span class="nc" id="L74">    private fun track(stat: Stat, properties: Map&lt;String, Any?&gt; = emptyMap()) = analyticsTracker.track(</span>
<span class="nc" id="L75">            stat,</span>
<span class="nc bnc" id="L76" title="All 2 branches missed.">            properties + (BLOG_TYPE_KEY to siteType?.trackingName)</span>
<span class="nc" id="L77">    )</span>

<span class="nc" id="L79">    private enum class SiteType(val trackingName: String) {</span>
<span class="nc" id="L80">        WORDPRESS_COM(&quot;wpcom&quot;),</span>
<span class="nc" id="L81">        SELF_HOSTED(&quot;self_hosted&quot;)</span>
    }

    // We only track the primary button for now, as we don't have a dismiss button like WPiOS does.
<span class="nc" id="L85">    private enum class Button(val trackingName: String) {</span>
<span class="nc" id="L86">        CONTINUE(&quot;continue&quot;)</span>
    }

<span class="nc" id="L89">    enum class Source(val trackingName: String) {</span>
<span class="nc" id="L90">        PUBLISH_FLOW(&quot;publish_flow&quot;),</span>
<span class="nc" id="L91">        BLOG_SETTINGS(&quot;blog_settings&quot;),</span>
<span class="nc" id="L92">        NOTIFICATION_SETTINGS(&quot;notification_settings&quot;),</span>
<span class="nc" id="L93">        BLOGGING_PROMPTS_ONBOARDING(&quot;blogging_prompts_onboarding&quot;),</span>
    }

    companion object {
        private const val BLOG_TYPE_KEY = &quot;blog_type&quot;
        private const val SCREEN_KEY = &quot;screen&quot;
        private const val BUTTON_KEY = &quot;button&quot;
        private const val SOURCE_KEY = &quot;source&quot;
        private const val PROMPT_ENABLED_KEY = &quot;enabled&quot;
        private const val DAYS_OF_WEEK_COUNT_KEY = &quot;days_of_week_count&quot;
        private const val SELECTED_TIME_KEY = &quot;selected_time&quot;
        private const val PROMPT_INCLUDED = &quot;prompt_included&quot;
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span>Generated by the Android Gradle plugin 7.1.1</div></body></html>