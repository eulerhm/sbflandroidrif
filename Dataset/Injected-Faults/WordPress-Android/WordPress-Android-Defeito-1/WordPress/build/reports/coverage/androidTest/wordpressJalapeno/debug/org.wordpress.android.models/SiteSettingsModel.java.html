<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SiteSettingsModel.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">wordpressJalapenoDebug</a> &gt; <a href="index.source.html" class="el_package">org.wordpress.android.models</a> &gt; <span class="el_source">SiteSettingsModel.java</span></div><h1>SiteSettingsModel.java</h1><pre class="source lang-java linenums">package org.wordpress.android.models;

import android.content.ContentValues;
import android.database.Cursor;
import android.text.TextUtils;

import androidx.collection.SparseArrayCompat;

import java.util.ArrayList;
import java.util.Collections;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

/**
 * Holds blog settings and provides methods to (de) serialize .com and self-hosted network calls.
 */

<span class="nc" id="L19">public class SiteSettingsModel {</span>
    private static final int RELATED_POSTS_ENABLED_FLAG = 0x1;
    private static final int RELATED_POST_HEADER_FLAG = 0x2;
    private static final int RELATED_POST_IMAGE_FLAG = 0x4;

    // Settings table column names
    public static final String ID_COLUMN_NAME = &quot;id&quot;;
    private static final String ADDRESS_COLUMN_NAME = &quot;address&quot;;
    private static final String USERNAME_COLUMN_NAME = &quot;username&quot;;
    private static final String PASSWORD_COLUMN_NAME = &quot;password&quot;;
    private static final String TITLE_COLUMN_NAME = &quot;title&quot;;
    private static final String TAGLINE_COLUMN_NAME = &quot;tagline&quot;;
    private static final String LANGUAGE_COLUMN_NAME = &quot;language&quot;;
    private static final String SITE_ICON_COLUMN_NAME = &quot;siteIcon&quot;;
    private static final String PRIVACY_COLUMN_NAME = &quot;privacy&quot;;
    private static final String LOCATION_COLUMN_NAME = &quot;location&quot;;
    private static final String DEF_CATEGORY_COLUMN_NAME = &quot;defaultCategory&quot;;
    private static final String DEF_POST_FORMAT_COLUMN_NAME = &quot;defaultPostFormat&quot;;
    private static final String CATEGORIES_COLUMN_NAME = &quot;categories&quot;;
    private static final String POST_FORMATS_COLUMN_NAME = &quot;postFormats&quot;;
    private static final String CREDS_VERIFIED_COLUMN_NAME = &quot;credsVerified&quot;;
    private static final String RELATED_POSTS_COLUMN_NAME = &quot;relatedPosts&quot;;
    private static final String ALLOW_COMMENTS_COLUMN_NAME = &quot;allowComments&quot;;
    private static final String SEND_PINGBACKS_COLUMN_NAME = &quot;sendPingbacks&quot;;
    private static final String RECEIVE_PINGBACKS_COLUMN_NAME = &quot;receivePingbacks&quot;;
    private static final String SHOULD_CLOSE_AFTER_COLUMN_NAME = &quot;shouldCloseAfter&quot;;
    private static final String CLOSE_AFTER_COLUMN_NAME = &quot;closeAfter&quot;;
    private static final String SORT_BY_COLUMN_NAME = &quot;sortBy&quot;;
    private static final String SHOULD_THREAD_COLUMN_NAME = &quot;shouldThread&quot;;
    private static final String THREADING_COLUMN_NAME = &quot;threading&quot;;
    private static final String SHOULD_PAGE_COLUMN_NAME = &quot;shouldPage&quot;;
    private static final String PAGING_COLUMN_NAME = &quot;paging&quot;;
    private static final String MANUAL_APPROVAL_COLUMN_NAME = &quot;manualApproval&quot;;
    private static final String IDENTITY_REQUIRED_COLUMN_NAME = &quot;identityRequired&quot;;
    private static final String USER_ACCOUNT_REQUIRED_COLUMN_NAME = &quot;userAccountRequired&quot;;
    private static final String ALLOWLIST_COLUMN_NAME = &quot;whitelist&quot;;
    private static final String MODERATION_KEYS_COLUMN_NAME = &quot;moderationKeys&quot;;
    private static final String DENYLIST_KEYS_COLUMN_NAME = &quot;blacklistKeys&quot;;
    private static final String SHARING_LABEL_COLUMN_NAME = &quot;sharingLabel&quot;;
    private static final String SHARING_BUTTON_STYLE_COLUMN_NAME = &quot;sharingButtonStyle&quot;;
    private static final String ALLOW_REBLOG_BUTTON_COLUMN_NAME = &quot;allowReblogButton&quot;;
    private static final String ALLOW_LIKE_BUTTON_COLUMN_NAME = &quot;allowLikeButton&quot;;
    private static final String ALLOW_COMMENT_LIKES_COLUMN_NAME = &quot;allowCommentLikes&quot;;
    private static final String TWITTER_USERNAME_COLUMN_NAME = &quot;twitterUsername&quot;;
    private static final String START_OF_WEEK_COLUMN_NAME = &quot;startOfWeek&quot;;
    private static final String DATE_FORMAT_COLUMN_NAME = &quot;dateFormat&quot;;
    private static final String TIME_FORMAT_COLUMN_NAME = &quot;timeFormat&quot;;
    private static final String TIMEZONE_COLUMN_NAME = &quot;siteTimezone&quot;;
    private static final String POSTS_PER_PAGE_COLUMN_NAME = &quot;postsPerPage&quot;;
    private static final String AMP_SUPPORTED_COLUMN_NAME = &quot;ampSupported&quot;;
    private static final String AMP_ENABLED_COLUMN_NAME = &quot;ampEnabled&quot;;
    private static final String JETPACK_SEARCH_SUPPORTED_COLUMN_NAME = &quot;jetpackSearchSupported&quot;;
    private static final String JETPACK_SEARCH_ENABLED_COLUMN_NAME = &quot;jetpackSearchEnabled&quot;;

    public static final String SETTINGS_TABLE_NAME = &quot;site_settings&quot;;

    public static final String ADD_SHARING_LABEL = &quot;alter table &quot; + SETTINGS_TABLE_NAME
                                                   + &quot; add &quot; + SHARING_LABEL_COLUMN_NAME + &quot; TEXT;&quot;;
    public static final String ADD_SHARING_BUTTON_STYLE = &quot;alter table &quot; + SETTINGS_TABLE_NAME
                                                          + &quot; add &quot; + SHARING_BUTTON_STYLE_COLUMN_NAME + &quot; TEXT;&quot;;
    public static final String ADD_ALLOW_REBLOG_BUTTON = &quot;alter table &quot; + SETTINGS_TABLE_NAME
                                                         + &quot; add &quot; + ALLOW_REBLOG_BUTTON_COLUMN_NAME + &quot; BOOLEAN;&quot;;
    public static final String ADD_ALLOW_LIKE_BUTTON = &quot;alter table &quot; + SETTINGS_TABLE_NAME
                                                       + &quot; add &quot; + ALLOW_LIKE_BUTTON_COLUMN_NAME + &quot; BOOLEAN;&quot;;
    public static final String ADD_ALLOW_COMMENT_LIKES = &quot;alter table &quot; + SETTINGS_TABLE_NAME
                                                         + &quot; add &quot; + ALLOW_COMMENT_LIKES_COLUMN_NAME + &quot; BOOLEAN;&quot;;
    public static final String ADD_TWITTER_USERNAME = &quot;alter table &quot; + SETTINGS_TABLE_NAME
                                                      + &quot; add &quot; + TWITTER_USERNAME_COLUMN_NAME + &quot; TEXT;&quot;;
    public static final String ADD_START_OF_WEEK = &quot;alter table &quot; + SETTINGS_TABLE_NAME
                                                   + &quot; add &quot; + START_OF_WEEK_COLUMN_NAME + &quot; TEXT;&quot;;
    public static final String ADD_TIME_FORMAT = &quot;alter table &quot; + SETTINGS_TABLE_NAME
                                                 + &quot; add &quot; + TIME_FORMAT_COLUMN_NAME + &quot; TEXT;&quot;;
    public static final String ADD_DATE_FORMAT = &quot;alter table &quot; + SETTINGS_TABLE_NAME
                                                 + &quot; add &quot; + DATE_FORMAT_COLUMN_NAME + &quot; TEXT;&quot;;
    public static final String ADD_TIMEZONE = &quot;alter table &quot; + SETTINGS_TABLE_NAME
                                              + &quot; add &quot; + TIMEZONE_COLUMN_NAME + &quot; TEXT;&quot;;
    public static final String ADD_POSTS_PER_PAGE = &quot;alter table &quot; + SETTINGS_TABLE_NAME
                                                    + &quot; add &quot; + POSTS_PER_PAGE_COLUMN_NAME + &quot; INTEGER;&quot;;
    public static final String ADD_AMP_ENABLED = &quot;alter table &quot; + SETTINGS_TABLE_NAME
                                                 + &quot; add &quot; + AMP_ENABLED_COLUMN_NAME + &quot; BOOLEAN;&quot;;
    public static final String ADD_AMP_SUPPORTED = &quot;alter table &quot; + SETTINGS_TABLE_NAME
                                                   + &quot; add &quot; + AMP_SUPPORTED_COLUMN_NAME + &quot; BOOLEAN;&quot;;
    public static final String ADD_JETPACK_SEARCH_ENABLED = &quot;alter table &quot; + SETTINGS_TABLE_NAME
                                                 + &quot; add &quot; + JETPACK_SEARCH_ENABLED_COLUMN_NAME + &quot; BOOLEAN;&quot;;
    public static final String ADD_JETPACK_SEARCH_SUPPORTED = &quot;alter table &quot; + SETTINGS_TABLE_NAME
                                                   + &quot; add &quot; + JETPACK_SEARCH_SUPPORTED_COLUMN_NAME + &quot; BOOLEAN;&quot;;
    public static final String ADD_SITE_ICON = &quot;alter table &quot; + SETTINGS_TABLE_NAME
                                               + &quot; add &quot; + SITE_ICON_COLUMN_NAME + &quot; INTEGER;&quot;;

    public static final String CREATE_SETTINGS_TABLE_SQL =
            &quot;CREATE TABLE IF NOT EXISTS &quot;
            + SETTINGS_TABLE_NAME
            + &quot; (&quot;
            + ID_COLUMN_NAME + &quot; INTEGER PRIMARY KEY, &quot;
            + ADDRESS_COLUMN_NAME + &quot; TEXT, &quot;
            + USERNAME_COLUMN_NAME + &quot; TEXT, &quot;
            + PASSWORD_COLUMN_NAME + &quot; TEXT, &quot;
            + TITLE_COLUMN_NAME + &quot; TEXT, &quot;
            + TAGLINE_COLUMN_NAME + &quot; TEXT, &quot;
            + LANGUAGE_COLUMN_NAME + &quot; INTEGER, &quot;
            + PRIVACY_COLUMN_NAME + &quot; INTEGER, &quot;
            + LOCATION_COLUMN_NAME + &quot; BOOLEAN, &quot;
            + DEF_CATEGORY_COLUMN_NAME + &quot; TEXT, &quot;
            + DEF_POST_FORMAT_COLUMN_NAME + &quot; TEXT, &quot;
            + CATEGORIES_COLUMN_NAME + &quot; TEXT, &quot;
            + POST_FORMATS_COLUMN_NAME + &quot; TEXT, &quot;
            + CREDS_VERIFIED_COLUMN_NAME + &quot; BOOLEAN, &quot;
            + RELATED_POSTS_COLUMN_NAME + &quot; INTEGER, &quot;
            + ALLOW_COMMENTS_COLUMN_NAME + &quot; BOOLEAN, &quot;
            + SEND_PINGBACKS_COLUMN_NAME + &quot; BOOLEAN, &quot;
            + RECEIVE_PINGBACKS_COLUMN_NAME + &quot; BOOLEAN, &quot;
            + SHOULD_CLOSE_AFTER_COLUMN_NAME + &quot; BOOLEAN, &quot;
            + CLOSE_AFTER_COLUMN_NAME + &quot; INTEGER, &quot;
            + SORT_BY_COLUMN_NAME + &quot; INTEGER, &quot;
            + SHOULD_THREAD_COLUMN_NAME + &quot; BOOLEAN, &quot;
            + THREADING_COLUMN_NAME + &quot; INTEGER, &quot;
            + SHOULD_PAGE_COLUMN_NAME + &quot; BOOLEAN, &quot;
            + PAGING_COLUMN_NAME + &quot; INTEGER, &quot;
            + MANUAL_APPROVAL_COLUMN_NAME + &quot; BOOLEAN, &quot;
            + IDENTITY_REQUIRED_COLUMN_NAME + &quot; BOOLEAN, &quot;
            + USER_ACCOUNT_REQUIRED_COLUMN_NAME + &quot; BOOLEAN, &quot;
            + ALLOWLIST_COLUMN_NAME + &quot; BOOLEAN, &quot;
            + MODERATION_KEYS_COLUMN_NAME + &quot; TEXT, &quot;
            + DENYLIST_KEYS_COLUMN_NAME + &quot; TEXT&quot;
            + &quot;);&quot;;

    public boolean isInLocalTable;
    public boolean hasVerifiedCredentials;
    public long localTableId;
    public String address;
    public String username;
    public String password;
    public String title;
    public String tagline;
    public String language;
    public int siteIconMediaId;
    public int languageId;
    public int privacy;
    public boolean location;
    public int defaultCategory;
    public CategoryModel[] categories;
    public String defaultPostFormat;
    public Map&lt;String, String&gt; postFormats;
    public boolean showRelatedPosts;
    public boolean showRelatedPostHeader;
    public boolean showRelatedPostImages;
    public boolean allowComments;
    public boolean sendPingbacks;
    public boolean receivePingbacks;
    public boolean shouldCloseAfter;
    public int closeCommentAfter;
    public int sortCommentsBy;
    public boolean shouldThreadComments;
    public int threadingLevels;
    public boolean shouldPageComments;
    public int commentsPerPage;
    public boolean commentApprovalRequired;
    public boolean commentsRequireIdentity;
    public boolean commentsRequireUserAccount;
    public boolean commentAutoApprovalKnownUsers;
    public int maxLinks;
    public List&lt;String&gt; holdForModeration;
    public List&lt;String&gt; denylist;
    public String sharingLabel;
    public String sharingButtonStyle;
    public boolean allowReblogButton;
    public boolean allowLikeButton;
    public boolean allowCommentLikes;
    public String twitterUsername;
    public String startOfWeek;
    public String dateFormat;
    public String timeFormat;
    public String timezone;
    public int postsPerPage;
    public boolean ampSupported;
    public boolean ampEnabled;
    public boolean jetpackSearchSupported;
    public boolean jetpackSearchEnabled;
    public String quotaDiskSpace;

    @Override
    public boolean equals(Object other) {
<span class="nc bnc" id="L201" title="All 2 branches missed.">        if (!(other instanceof SiteSettingsModel)) {</span>
<span class="nc" id="L202">            return false;</span>
        }
<span class="nc" id="L204">        SiteSettingsModel otherModel = (SiteSettingsModel) other;</span>

<span class="nc bnc" id="L206" title="All 2 branches missed.">        return localTableId == otherModel.localTableId</span>
<span class="nc bnc" id="L207" title="All 2 branches missed.">               &amp;&amp; equals(address, otherModel.address)</span>
<span class="nc bnc" id="L208" title="All 2 branches missed.">               &amp;&amp; equals(username, otherModel.username)</span>
<span class="nc bnc" id="L209" title="All 2 branches missed.">               &amp;&amp; equals(password, otherModel.password)</span>
<span class="nc bnc" id="L210" title="All 2 branches missed.">               &amp;&amp; equals(title, otherModel.title)</span>
<span class="nc bnc" id="L211" title="All 2 branches missed.">               &amp;&amp; equals(tagline, otherModel.tagline)</span>
<span class="nc bnc" id="L212" title="All 2 branches missed.">               &amp;&amp; equals(defaultPostFormat, otherModel.defaultPostFormat)</span>
<span class="nc bnc" id="L213" title="All 2 branches missed.">               &amp;&amp; equals(startOfWeek, otherModel.startOfWeek)</span>
<span class="nc bnc" id="L214" title="All 2 branches missed.">               &amp;&amp; equals(dateFormat, otherModel.dateFormat)</span>
<span class="nc bnc" id="L215" title="All 2 branches missed.">               &amp;&amp; equals(timeFormat, otherModel.timeFormat)</span>
<span class="nc bnc" id="L216" title="All 52 branches missed.">               &amp;&amp; equals(timezone, otherModel.timezone)</span>
               &amp;&amp; languageId == otherModel.languageId
               &amp;&amp; siteIconMediaId == otherModel.siteIconMediaId
               &amp;&amp; privacy == otherModel.privacy
               &amp;&amp; location == otherModel.location
               &amp;&amp; defaultCategory == otherModel.defaultCategory
               &amp;&amp; showRelatedPosts == otherModel.showRelatedPosts
               &amp;&amp; showRelatedPostHeader == otherModel.showRelatedPostHeader
               &amp;&amp; showRelatedPostImages == otherModel.showRelatedPostImages
               &amp;&amp; allowComments == otherModel.allowComments
               &amp;&amp; sendPingbacks == otherModel.sendPingbacks
               &amp;&amp; receivePingbacks == otherModel.receivePingbacks
               &amp;&amp; closeCommentAfter == otherModel.closeCommentAfter
               &amp;&amp; sortCommentsBy == otherModel.sortCommentsBy
               &amp;&amp; threadingLevels == otherModel.threadingLevels
               &amp;&amp; commentsPerPage == otherModel.commentsPerPage
               &amp;&amp; commentApprovalRequired == otherModel.commentApprovalRequired
               &amp;&amp; commentsRequireIdentity == otherModel.commentsRequireIdentity
               &amp;&amp; commentsRequireUserAccount == otherModel.commentsRequireUserAccount
               &amp;&amp; commentAutoApprovalKnownUsers == otherModel.commentAutoApprovalKnownUsers
               &amp;&amp; postsPerPage == otherModel.postsPerPage
               &amp;&amp; ampEnabled == otherModel.ampEnabled
               &amp;&amp; ampSupported == otherModel.ampSupported
               &amp;&amp; jetpackSearchEnabled == otherModel.jetpackSearchEnabled
               &amp;&amp; jetpackSearchSupported == otherModel.jetpackSearchSupported
               &amp;&amp; maxLinks == otherModel.maxLinks
<span class="nc bnc" id="L242" title="All 4 branches missed.">               &amp;&amp; equals(defaultPostFormat, otherModel.defaultPostFormat)</span>
               &amp;&amp; holdForModeration != null
<span class="nc bnc" id="L244" title="All 4 branches missed.">               &amp;&amp; holdForModeration.equals(otherModel.holdForModeration)</span>
<span class="nc bnc" id="L245" title="All 4 branches missed.">               &amp;&amp; denylist != null &amp;&amp; denylist.equals(otherModel.denylist)</span>
<span class="nc bnc" id="L246" title="All 4 branches missed.">               &amp;&amp; sharingLabel != null &amp;&amp; sharingLabel.equals(otherModel.sharingLabel)</span>
<span class="nc bnc" id="L247" title="All 10 branches missed.">               &amp;&amp; sharingButtonStyle != null &amp;&amp; sharingButtonStyle.equals(otherModel.sharingButtonStyle)</span>
               &amp;&amp; allowReblogButton == otherModel.allowReblogButton
               &amp;&amp; allowLikeButton == otherModel.allowLikeButton
               &amp;&amp; allowCommentLikes == otherModel.allowCommentLikes
<span class="nc bnc" id="L251" title="All 2 branches missed.">               &amp;&amp; twitterUsername != null &amp;&amp; twitterUsername.equals(otherModel.twitterUsername);</span>
    }

    /**
     * Copies data from another {@link SiteSettingsModel}.
     */
    public void copyFrom(SiteSettingsModel other) {
<span class="nc bnc" id="L258" title="All 2 branches missed.">        if (other == null) {</span>
<span class="nc" id="L259">            return;</span>
        }

<span class="nc" id="L262">        isInLocalTable = other.isInLocalTable;</span>
<span class="nc" id="L263">        hasVerifiedCredentials = other.hasVerifiedCredentials;</span>
<span class="nc" id="L264">        localTableId = other.localTableId;</span>
<span class="nc" id="L265">        address = other.address;</span>
<span class="nc" id="L266">        username = other.username;</span>
<span class="nc" id="L267">        password = other.password;</span>
<span class="nc" id="L268">        title = other.title;</span>
<span class="nc" id="L269">        tagline = other.tagline;</span>
<span class="nc" id="L270">        language = other.language;</span>
<span class="nc" id="L271">        languageId = other.languageId;</span>
<span class="nc" id="L272">        siteIconMediaId = other.siteIconMediaId;</span>
<span class="nc" id="L273">        privacy = other.privacy;</span>
<span class="nc" id="L274">        location = other.location;</span>
<span class="nc" id="L275">        defaultCategory = other.defaultCategory;</span>
<span class="nc" id="L276">        categories = other.categories;</span>
<span class="nc" id="L277">        defaultPostFormat = other.defaultPostFormat;</span>
<span class="nc" id="L278">        postFormats = other.postFormats;</span>
<span class="nc" id="L279">        showRelatedPosts = other.showRelatedPosts;</span>
<span class="nc" id="L280">        showRelatedPostHeader = other.showRelatedPostHeader;</span>
<span class="nc" id="L281">        showRelatedPostImages = other.showRelatedPostImages;</span>
<span class="nc" id="L282">        allowComments = other.allowComments;</span>
<span class="nc" id="L283">        sendPingbacks = other.sendPingbacks;</span>
<span class="nc" id="L284">        receivePingbacks = other.receivePingbacks;</span>
<span class="nc" id="L285">        shouldCloseAfter = other.shouldCloseAfter;</span>
<span class="nc" id="L286">        closeCommentAfter = other.closeCommentAfter;</span>
<span class="nc" id="L287">        sortCommentsBy = other.sortCommentsBy;</span>
<span class="nc" id="L288">        shouldThreadComments = other.shouldThreadComments;</span>
<span class="nc" id="L289">        threadingLevels = other.threadingLevels;</span>
<span class="nc" id="L290">        shouldPageComments = other.shouldPageComments;</span>
<span class="nc" id="L291">        commentsPerPage = other.commentsPerPage;</span>
<span class="nc" id="L292">        commentApprovalRequired = other.commentApprovalRequired;</span>
<span class="nc" id="L293">        commentsRequireIdentity = other.commentsRequireIdentity;</span>
<span class="nc" id="L294">        commentsRequireUserAccount = other.commentsRequireUserAccount;</span>
<span class="nc" id="L295">        commentAutoApprovalKnownUsers = other.commentAutoApprovalKnownUsers;</span>
<span class="nc" id="L296">        maxLinks = other.maxLinks;</span>
<span class="nc" id="L297">        startOfWeek = other.startOfWeek;</span>
<span class="nc" id="L298">        dateFormat = other.dateFormat;</span>
<span class="nc" id="L299">        timeFormat = other.timeFormat;</span>
<span class="nc" id="L300">        timezone = other.timezone;</span>
<span class="nc" id="L301">        postsPerPage = other.postsPerPage;</span>
<span class="nc" id="L302">        ampSupported = other.ampSupported;</span>
<span class="nc" id="L303">        ampEnabled = other.ampEnabled;</span>
<span class="nc" id="L304">        jetpackSearchSupported = other.jetpackSearchSupported;</span>
<span class="nc" id="L305">        jetpackSearchEnabled = other.jetpackSearchEnabled;</span>
<span class="nc bnc" id="L306" title="All 2 branches missed.">        if (other.holdForModeration != null) {</span>
<span class="nc" id="L307">            holdForModeration = new ArrayList&lt;&gt;(other.holdForModeration);</span>
        }
<span class="nc bnc" id="L309" title="All 2 branches missed.">        if (other.denylist != null) {</span>
<span class="nc" id="L310">            denylist = new ArrayList&lt;&gt;(other.denylist);</span>
        }
<span class="nc bnc" id="L312" title="All 2 branches missed.">        if (other.sharingLabel != null) {</span>
<span class="nc" id="L313">            sharingLabel = other.sharingLabel;</span>
        }
<span class="nc bnc" id="L315" title="All 2 branches missed.">        if (other.sharingButtonStyle != null) {</span>
<span class="nc" id="L316">            sharingButtonStyle = other.sharingButtonStyle;</span>
        }
<span class="nc" id="L318">        allowReblogButton = other.allowReblogButton;</span>
<span class="nc" id="L319">        allowLikeButton = other.allowLikeButton;</span>
<span class="nc" id="L320">        allowCommentLikes = other.allowCommentLikes;</span>
<span class="nc bnc" id="L321" title="All 2 branches missed.">        if (other.twitterUsername != null) {</span>
<span class="nc" id="L322">            twitterUsername = other.twitterUsername;</span>
        }
<span class="nc" id="L324">    }</span>

    /**
     * Sets values from a local database {@link Cursor}.
     */
    public void deserializeOptionsDatabaseCursor(Cursor cursor, SparseArrayCompat&lt;CategoryModel&gt; models) {
<span class="nc bnc" id="L330" title="All 6 branches missed.">        if (cursor == null || !cursor.moveToFirst() || cursor.getCount() == 0) {</span>
<span class="nc" id="L331">            return;</span>
        }

<span class="nc" id="L334">        localTableId = getIntFromCursor(cursor, ID_COLUMN_NAME);</span>
<span class="nc" id="L335">        address = getStringFromCursor(cursor, ADDRESS_COLUMN_NAME);</span>
<span class="nc" id="L336">        username = getStringFromCursor(cursor, USERNAME_COLUMN_NAME);</span>
<span class="nc" id="L337">        password = getStringFromCursor(cursor, PASSWORD_COLUMN_NAME);</span>
<span class="nc" id="L338">        title = getStringFromCursor(cursor, TITLE_COLUMN_NAME);</span>
<span class="nc" id="L339">        tagline = getStringFromCursor(cursor, TAGLINE_COLUMN_NAME);</span>
<span class="nc" id="L340">        languageId = getIntFromCursor(cursor, LANGUAGE_COLUMN_NAME);</span>
<span class="nc" id="L341">        siteIconMediaId = getIntFromCursor(cursor, SITE_ICON_COLUMN_NAME);</span>
<span class="nc" id="L342">        privacy = getIntFromCursor(cursor, PRIVACY_COLUMN_NAME);</span>
<span class="nc" id="L343">        defaultCategory = getIntFromCursor(cursor, DEF_CATEGORY_COLUMN_NAME);</span>
<span class="nc" id="L344">        defaultPostFormat = getStringFromCursor(cursor, DEF_POST_FORMAT_COLUMN_NAME);</span>
<span class="nc" id="L345">        location = getBooleanFromCursor(cursor, LOCATION_COLUMN_NAME);</span>
<span class="nc" id="L346">        hasVerifiedCredentials = getBooleanFromCursor(cursor, CREDS_VERIFIED_COLUMN_NAME);</span>
<span class="nc" id="L347">        allowComments = getBooleanFromCursor(cursor, ALLOW_COMMENTS_COLUMN_NAME);</span>
<span class="nc" id="L348">        sendPingbacks = getBooleanFromCursor(cursor, SEND_PINGBACKS_COLUMN_NAME);</span>
<span class="nc" id="L349">        receivePingbacks = getBooleanFromCursor(cursor, RECEIVE_PINGBACKS_COLUMN_NAME);</span>
<span class="nc" id="L350">        shouldCloseAfter = getBooleanFromCursor(cursor, SHOULD_CLOSE_AFTER_COLUMN_NAME);</span>
<span class="nc" id="L351">        closeCommentAfter = getIntFromCursor(cursor, CLOSE_AFTER_COLUMN_NAME);</span>
<span class="nc" id="L352">        sortCommentsBy = getIntFromCursor(cursor, SORT_BY_COLUMN_NAME);</span>
<span class="nc" id="L353">        shouldThreadComments = getBooleanFromCursor(cursor, SHOULD_THREAD_COLUMN_NAME);</span>
<span class="nc" id="L354">        threadingLevels = getIntFromCursor(cursor, THREADING_COLUMN_NAME);</span>
<span class="nc" id="L355">        shouldPageComments = getBooleanFromCursor(cursor, SHOULD_PAGE_COLUMN_NAME);</span>
<span class="nc" id="L356">        commentsPerPage = getIntFromCursor(cursor, PAGING_COLUMN_NAME);</span>
<span class="nc" id="L357">        commentApprovalRequired = getBooleanFromCursor(cursor, MANUAL_APPROVAL_COLUMN_NAME);</span>
<span class="nc" id="L358">        commentsRequireIdentity = getBooleanFromCursor(cursor, IDENTITY_REQUIRED_COLUMN_NAME);</span>
<span class="nc" id="L359">        commentsRequireUserAccount = getBooleanFromCursor(cursor, USER_ACCOUNT_REQUIRED_COLUMN_NAME);</span>
<span class="nc" id="L360">        commentAutoApprovalKnownUsers = getBooleanFromCursor(cursor, ALLOWLIST_COLUMN_NAME);</span>
<span class="nc" id="L361">        startOfWeek = getStringFromCursor(cursor, START_OF_WEEK_COLUMN_NAME);</span>
<span class="nc" id="L362">        dateFormat = getStringFromCursor(cursor, DATE_FORMAT_COLUMN_NAME);</span>
<span class="nc" id="L363">        timeFormat = getStringFromCursor(cursor, TIME_FORMAT_COLUMN_NAME);</span>
<span class="nc" id="L364">        timezone = getStringFromCursor(cursor, TIMEZONE_COLUMN_NAME);</span>
<span class="nc" id="L365">        postsPerPage = getIntFromCursor(cursor, POSTS_PER_PAGE_COLUMN_NAME);</span>
<span class="nc" id="L366">        ampSupported = getBooleanFromCursor(cursor, AMP_SUPPORTED_COLUMN_NAME);</span>
<span class="nc" id="L367">        ampEnabled = getBooleanFromCursor(cursor, AMP_ENABLED_COLUMN_NAME);</span>
<span class="nc" id="L368">        jetpackSearchSupported = getBooleanFromCursor(cursor, JETPACK_SEARCH_SUPPORTED_COLUMN_NAME);</span>
<span class="nc" id="L369">        jetpackSearchEnabled = getBooleanFromCursor(cursor, JETPACK_SEARCH_ENABLED_COLUMN_NAME);</span>

<span class="nc" id="L371">        String moderationKeys = getStringFromCursor(cursor, MODERATION_KEYS_COLUMN_NAME);</span>
<span class="nc" id="L372">        String denylistKeys = getStringFromCursor(cursor, DENYLIST_KEYS_COLUMN_NAME);</span>
<span class="nc" id="L373">        holdForModeration = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L374">        denylist = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L375" title="All 2 branches missed.">        if (!TextUtils.isEmpty(moderationKeys)) {</span>
<span class="nc" id="L376">            Collections.addAll(holdForModeration, moderationKeys.split(&quot;\n&quot;));</span>
        }
<span class="nc bnc" id="L378" title="All 2 branches missed.">        if (!TextUtils.isEmpty(denylistKeys)) {</span>
<span class="nc" id="L379">            Collections.addAll(denylist, denylistKeys.split(&quot;\n&quot;));</span>
        }

<span class="nc" id="L382">        sharingLabel = getStringFromCursor(cursor, SHARING_LABEL_COLUMN_NAME);</span>
<span class="nc" id="L383">        sharingButtonStyle = getStringFromCursor(cursor, SHARING_BUTTON_STYLE_COLUMN_NAME);</span>
<span class="nc" id="L384">        allowReblogButton = getBooleanFromCursor(cursor, ALLOW_REBLOG_BUTTON_COLUMN_NAME);</span>
<span class="nc" id="L385">        allowLikeButton = getBooleanFromCursor(cursor, ALLOW_LIKE_BUTTON_COLUMN_NAME);</span>
<span class="nc" id="L386">        allowCommentLikes = getBooleanFromCursor(cursor, ALLOW_COMMENT_LIKES_COLUMN_NAME);</span>
<span class="nc" id="L387">        twitterUsername = getStringFromCursor(cursor, TWITTER_USERNAME_COLUMN_NAME);</span>

<span class="nc" id="L389">        setRelatedPostsFlags(Math.max(0, getIntFromCursor(cursor, RELATED_POSTS_COLUMN_NAME)));</span>

<span class="nc" id="L391">        String cachedCategories = getStringFromCursor(cursor, CATEGORIES_COLUMN_NAME);</span>
<span class="nc" id="L392">        String cachedFormats = getStringFromCursor(cursor, POST_FORMATS_COLUMN_NAME);</span>
<span class="nc bnc" id="L393" title="All 4 branches missed.">        if (models != null &amp;&amp; !TextUtils.isEmpty(cachedCategories)) {</span>
<span class="nc" id="L394">            String[] split = cachedCategories.split(&quot;,&quot;);</span>
<span class="nc" id="L395">            categories = new CategoryModel[split.length];</span>
<span class="nc bnc" id="L396" title="All 2 branches missed.">            for (int i = 0; i &lt; split.length; ++i) {</span>
<span class="nc" id="L397">                int catId = Integer.parseInt(split[i]);</span>
<span class="nc" id="L398">                categories[i] = models.get(catId);</span>
            }
        }
<span class="nc bnc" id="L401" title="All 2 branches missed.">        if (!TextUtils.isEmpty(cachedFormats)) {</span>
<span class="nc" id="L402">            String[] split = cachedFormats.split(&quot;;&quot;);</span>
<span class="nc" id="L403">            postFormats = new HashMap&lt;&gt;();</span>
<span class="nc bnc" id="L404" title="All 2 branches missed.">            for (String format : split) {</span>
<span class="nc" id="L405">                String[] kvp = format.split(&quot;,&quot;);</span>
<span class="nc" id="L406">                postFormats.put(kvp[0], kvp[1]);</span>
            }
        }

<span class="nc" id="L410">        int cachedRelatedPosts = getIntFromCursor(cursor, RELATED_POSTS_COLUMN_NAME);</span>
<span class="nc bnc" id="L411" title="All 2 branches missed.">        if (cachedRelatedPosts != -1) {</span>
<span class="nc" id="L412">            setRelatedPostsFlags(cachedRelatedPosts);</span>
        }

<span class="nc" id="L415">        isInLocalTable = true;</span>
<span class="nc" id="L416">    }</span>

    /**
     * Creates the {@link ContentValues} object to store this category data in a local database.
     */
    public ContentValues serializeToDatabase() {
<span class="nc" id="L422">        ContentValues values = new ContentValues();</span>
<span class="nc" id="L423">        values.put(ID_COLUMN_NAME, localTableId);</span>
<span class="nc" id="L424">        values.put(ADDRESS_COLUMN_NAME, address);</span>
<span class="nc" id="L425">        values.put(USERNAME_COLUMN_NAME, username);</span>
<span class="nc" id="L426">        values.put(PASSWORD_COLUMN_NAME, password);</span>
<span class="nc" id="L427">        values.put(TITLE_COLUMN_NAME, title);</span>
<span class="nc" id="L428">        values.put(TAGLINE_COLUMN_NAME, tagline);</span>
<span class="nc" id="L429">        values.put(PRIVACY_COLUMN_NAME, privacy);</span>
<span class="nc" id="L430">        values.put(LANGUAGE_COLUMN_NAME, languageId);</span>
<span class="nc" id="L431">        values.put(SITE_ICON_COLUMN_NAME, siteIconMediaId);</span>
<span class="nc" id="L432">        values.put(LOCATION_COLUMN_NAME, location);</span>
<span class="nc" id="L433">        values.put(DEF_CATEGORY_COLUMN_NAME, defaultCategory);</span>
<span class="nc" id="L434">        values.put(CATEGORIES_COLUMN_NAME, categoryIdList(categories));</span>
<span class="nc" id="L435">        values.put(DEF_POST_FORMAT_COLUMN_NAME, defaultPostFormat);</span>
<span class="nc" id="L436">        values.put(POST_FORMATS_COLUMN_NAME, postFormatList(postFormats));</span>
<span class="nc" id="L437">        values.put(CREDS_VERIFIED_COLUMN_NAME, hasVerifiedCredentials);</span>
<span class="nc" id="L438">        values.put(RELATED_POSTS_COLUMN_NAME, getRelatedPostsFlags());</span>
<span class="nc" id="L439">        values.put(ALLOW_COMMENTS_COLUMN_NAME, allowComments);</span>
<span class="nc" id="L440">        values.put(SEND_PINGBACKS_COLUMN_NAME, sendPingbacks);</span>
<span class="nc" id="L441">        values.put(RECEIVE_PINGBACKS_COLUMN_NAME, receivePingbacks);</span>
<span class="nc" id="L442">        values.put(SHOULD_CLOSE_AFTER_COLUMN_NAME, shouldCloseAfter);</span>
<span class="nc" id="L443">        values.put(CLOSE_AFTER_COLUMN_NAME, closeCommentAfter);</span>
<span class="nc" id="L444">        values.put(SORT_BY_COLUMN_NAME, sortCommentsBy);</span>
<span class="nc" id="L445">        values.put(SHOULD_THREAD_COLUMN_NAME, shouldThreadComments);</span>
<span class="nc" id="L446">        values.put(THREADING_COLUMN_NAME, threadingLevels);</span>
<span class="nc" id="L447">        values.put(SHOULD_PAGE_COLUMN_NAME, shouldPageComments);</span>
<span class="nc" id="L448">        values.put(PAGING_COLUMN_NAME, commentsPerPage);</span>
<span class="nc" id="L449">        values.put(MANUAL_APPROVAL_COLUMN_NAME, commentApprovalRequired);</span>
<span class="nc" id="L450">        values.put(IDENTITY_REQUIRED_COLUMN_NAME, commentsRequireIdentity);</span>
<span class="nc" id="L451">        values.put(USER_ACCOUNT_REQUIRED_COLUMN_NAME, commentsRequireUserAccount);</span>
<span class="nc" id="L452">        values.put(ALLOWLIST_COLUMN_NAME, commentAutoApprovalKnownUsers);</span>
<span class="nc" id="L453">        values.put(START_OF_WEEK_COLUMN_NAME, startOfWeek);</span>
<span class="nc" id="L454">        values.put(DATE_FORMAT_COLUMN_NAME, dateFormat);</span>
<span class="nc" id="L455">        values.put(TIME_FORMAT_COLUMN_NAME, timeFormat);</span>
<span class="nc" id="L456">        values.put(TIMEZONE_COLUMN_NAME, timezone);</span>
<span class="nc" id="L457">        values.put(POSTS_PER_PAGE_COLUMN_NAME, postsPerPage);</span>
<span class="nc" id="L458">        values.put(AMP_SUPPORTED_COLUMN_NAME, ampSupported);</span>
<span class="nc" id="L459">        values.put(AMP_ENABLED_COLUMN_NAME, ampEnabled);</span>
<span class="nc" id="L460">        values.put(JETPACK_SEARCH_SUPPORTED_COLUMN_NAME, jetpackSearchSupported);</span>
<span class="nc" id="L461">        values.put(JETPACK_SEARCH_ENABLED_COLUMN_NAME, jetpackSearchEnabled);</span>

<span class="nc" id="L463">        StringBuilder moderationKeys = new StringBuilder();</span>
<span class="nc bnc" id="L464" title="All 2 branches missed.">        if (holdForModeration != null) {</span>
<span class="nc bnc" id="L465" title="All 2 branches missed.">            for (String key : holdForModeration) {</span>
<span class="nc" id="L466">                moderationKeys.append(key).append(&quot;\n&quot;);</span>
<span class="nc" id="L467">            }</span>
        }
<span class="nc" id="L469">        StringBuilder denylistKeys = new StringBuilder();</span>
<span class="nc bnc" id="L470" title="All 2 branches missed.">        if (denylist != null) {</span>
<span class="nc bnc" id="L471" title="All 2 branches missed.">            for (String key : denylist) {</span>
<span class="nc" id="L472">                denylistKeys.append(key).append(&quot;\n&quot;);</span>
<span class="nc" id="L473">            }</span>
        }
<span class="nc" id="L475">        values.put(MODERATION_KEYS_COLUMN_NAME, moderationKeys.toString());</span>
<span class="nc" id="L476">        values.put(DENYLIST_KEYS_COLUMN_NAME, denylistKeys.toString());</span>
<span class="nc" id="L477">        values.put(SHARING_LABEL_COLUMN_NAME, sharingLabel);</span>
<span class="nc" id="L478">        values.put(SHARING_BUTTON_STYLE_COLUMN_NAME, sharingButtonStyle);</span>
<span class="nc" id="L479">        values.put(ALLOW_REBLOG_BUTTON_COLUMN_NAME, allowReblogButton);</span>
<span class="nc" id="L480">        values.put(ALLOW_LIKE_BUTTON_COLUMN_NAME, allowLikeButton);</span>
<span class="nc" id="L481">        values.put(ALLOW_COMMENT_LIKES_COLUMN_NAME, allowCommentLikes);</span>
<span class="nc" id="L482">        values.put(TWITTER_USERNAME_COLUMN_NAME, twitterUsername);</span>

<span class="nc" id="L484">        return values;</span>
    }

    private int getRelatedPostsFlags() {
<span class="nc" id="L488">        int flags = 0;</span>

<span class="nc bnc" id="L490" title="All 2 branches missed.">        if (showRelatedPosts) {</span>
<span class="nc" id="L491">            flags |= RELATED_POSTS_ENABLED_FLAG;</span>
        }
<span class="nc bnc" id="L493" title="All 2 branches missed.">        if (showRelatedPostHeader) {</span>
<span class="nc" id="L494">            flags |= RELATED_POST_HEADER_FLAG;</span>
        }
<span class="nc bnc" id="L496" title="All 2 branches missed.">        if (showRelatedPostImages) {</span>
<span class="nc" id="L497">            flags |= RELATED_POST_IMAGE_FLAG;</span>
        }

<span class="nc" id="L500">        return flags;</span>
    }

    private void setRelatedPostsFlags(int flags) {
<span class="nc bnc" id="L504" title="All 2 branches missed.">        showRelatedPosts = (flags &amp; RELATED_POSTS_ENABLED_FLAG) &gt; 0;</span>
<span class="nc bnc" id="L505" title="All 2 branches missed.">        showRelatedPostHeader = (flags &amp; RELATED_POST_HEADER_FLAG) &gt; 0;</span>
<span class="nc bnc" id="L506" title="All 2 branches missed.">        showRelatedPostImages = (flags &amp; RELATED_POST_IMAGE_FLAG) &gt; 0;</span>
<span class="nc" id="L507">    }</span>

    /**
     * Used to serialize post formats to store in a local database.
     *
     * @param formats map of post formats where the key is the format ID and the value is the format name
     * @return a String of semi-colon separated KVP's of Post Formats; Post Format ID -&gt; Post Format Name
     */
    private static String postFormatList(Map&lt;String, String&gt; formats) {
<span class="nc bnc" id="L516" title="All 4 branches missed.">        if (formats == null || formats.size() == 0) {</span>
<span class="nc" id="L517">            return &quot;&quot;;</span>
        }

<span class="nc" id="L520">        StringBuilder builder = new StringBuilder();</span>
<span class="nc bnc" id="L521" title="All 2 branches missed.">        for (String key : formats.keySet()) {</span>
<span class="nc" id="L522">            builder.append(key).append(&quot;,&quot;).append(formats.get(key)).append(&quot;;&quot;);</span>
<span class="nc" id="L523">        }</span>
<span class="nc" id="L524">        builder.setLength(builder.length() - 1);</span>

<span class="nc" id="L526">        return builder.toString();</span>
    }

    /**
     * Used to serialize categories to store in a local database.
     *
     * @param elements {@link CategoryModel} array to create String ID list from
     * @return a String of comma-separated integer Category ID's
     */
    private static String categoryIdList(CategoryModel[] elements) {
<span class="nc bnc" id="L536" title="All 4 branches missed.">        if (elements == null || elements.length == 0) {</span>
<span class="nc" id="L537">            return &quot;&quot;;</span>
        }

<span class="nc" id="L540">        StringBuilder builder = new StringBuilder();</span>
<span class="nc bnc" id="L541" title="All 2 branches missed.">        for (CategoryModel element : elements) {</span>
<span class="nc" id="L542">            builder.append(String.valueOf(element.id)).append(&quot;,&quot;);</span>
        }
<span class="nc" id="L544">        builder.setLength(builder.length() - 1);</span>

<span class="nc" id="L546">        return builder.toString();</span>
    }

    /**
     * Helper method to get an integer value from a given column in a Cursor.
     */
    private int getIntFromCursor(Cursor cursor, String columnName) {
<span class="nc" id="L553">        int columnIndex = cursor.getColumnIndex(columnName);</span>
<span class="nc bnc" id="L554" title="All 2 branches missed.">        return columnIndex != -1 ? cursor.getInt(columnIndex) : -1;</span>
    }

    /**
     * Helper method to get a String value from a given column in a Cursor.
     */
    private String getStringFromCursor(Cursor cursor, String columnName) {
<span class="nc" id="L561">        int columnIndex = cursor.getColumnIndex(columnName);</span>
<span class="nc bnc" id="L562" title="All 2 branches missed.">        return columnIndex != -1 ? cursor.getString(columnIndex) : &quot;&quot;;</span>
    }

    /**
     * Helper method to get a boolean value (stored as an int) from a given column in a Cursor.
     */
    private boolean getBooleanFromCursor(Cursor cursor, String columnName) {
<span class="nc" id="L569">        int columnIndex = cursor.getColumnIndex(columnName);</span>
<span class="nc bnc" id="L570" title="All 4 branches missed.">        return columnIndex != -1 &amp;&amp; cursor.getInt(columnIndex) != 0;</span>
    }

    /**
     * Helper method to check if two String are equals or not
     */
    private boolean equals(String first, String second) {
<span class="nc bnc" id="L577" title="All 6 branches missed.">        return (first == null &amp;&amp; second == null)</span>
<span class="nc bnc" id="L578" title="All 2 branches missed.">               || (first != null &amp;&amp; first.equals(second));</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span>Generated by the Android Gradle plugin 7.1.1</div></body></html>