<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ActivityLauncher.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">wordpressJalapenoDebug</a> &gt; <a href="index.source.html" class="el_package">org.wordpress.android.ui</a> &gt; <span class="el_source">ActivityLauncher.java</span></div><h1>ActivityLauncher.java</h1><pre class="source lang-java linenums">package org.wordpress.android.ui;

import android.app.Activity;
import android.app.PendingIntent;
import android.content.ActivityNotFoundException;
import android.content.Context;
import android.content.Intent;
import android.content.pm.ResolveInfo;
import android.net.Uri;
import android.os.Bundle;
import android.text.TextUtils;

import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.annotation.StringRes;
import androidx.core.app.TaskStackBuilder;
import androidx.fragment.app.Fragment;

import com.wordpress.stories.compose.frame.FrameSaveNotifier;
import com.wordpress.stories.compose.frame.StorySaveEvents.StorySaveResult;

import org.wordpress.android.R;
import org.wordpress.android.WordPress;
import org.wordpress.android.analytics.AnalyticsTracker;
import org.wordpress.android.analytics.AnalyticsTracker.Stat;
import org.wordpress.android.datasets.ReaderPostTable;
import org.wordpress.android.fluxc.model.LocalOrRemoteId.LocalId;
import org.wordpress.android.fluxc.model.PostImmutableModel;
import org.wordpress.android.fluxc.model.PostModel;
import org.wordpress.android.fluxc.model.SiteModel;
import org.wordpress.android.fluxc.model.bloggingprompts.BloggingPromptModel;
import org.wordpress.android.fluxc.model.page.PageModel;
import org.wordpress.android.fluxc.network.utils.StatsGranularity;
import org.wordpress.android.imageeditor.EditImageActivity;
import org.wordpress.android.imageeditor.preview.PreviewImageFragment.Companion.EditImageData;
import org.wordpress.android.login.LoginMode;
import org.wordpress.android.models.ReaderPost;
import org.wordpress.android.networking.SSLCertsViewActivity;
import org.wordpress.android.push.NotificationType;
import org.wordpress.android.ui.accounts.HelpActivity;
import org.wordpress.android.ui.accounts.HelpActivity.Origin;
import org.wordpress.android.ui.accounts.LoginActivity;
import org.wordpress.android.ui.accounts.LoginEpilogueActivity;
import org.wordpress.android.ui.accounts.PostSignupInterstitialActivity;
import org.wordpress.android.ui.accounts.SignupEpilogueActivity;
import org.wordpress.android.ui.activitylog.detail.ActivityLogDetailActivity;
import org.wordpress.android.ui.activitylog.list.ActivityLogListActivity;
import org.wordpress.android.ui.comments.unified.UnifiedCommentsActivity;
import org.wordpress.android.ui.comments.unified.UnifiedCommentsDetailsActivity;
import org.wordpress.android.ui.debug.cookies.DebugCookiesActivity;
import org.wordpress.android.ui.domains.DomainRegistrationActivity;
import org.wordpress.android.ui.domains.DomainRegistrationActivity.DomainRegistrationPurpose;
import org.wordpress.android.ui.domains.DomainsDashboardActivity;
import org.wordpress.android.ui.engagement.EngagedPeopleListActivity;
import org.wordpress.android.ui.engagement.EngagementNavigationSource;
import org.wordpress.android.ui.engagement.HeaderData;
import org.wordpress.android.ui.engagement.ListScenario;
import org.wordpress.android.ui.engagement.ListScenarioType;
import org.wordpress.android.ui.history.HistoryDetailActivity;
import org.wordpress.android.ui.history.HistoryDetailContainerFragment;
import org.wordpress.android.ui.history.HistoryListItem.Revision;
import org.wordpress.android.ui.jetpack.backup.download.BackupDownloadActivity;
import org.wordpress.android.ui.jetpack.restore.RestoreActivity;
import org.wordpress.android.ui.jetpack.scan.ScanActivity;
import org.wordpress.android.ui.jetpack.scan.details.ThreatDetailsActivity;
import org.wordpress.android.ui.jetpack.scan.history.ScanHistoryActivity;
import org.wordpress.android.ui.main.MeActivity;
import org.wordpress.android.ui.main.SitePickerActivity;
import org.wordpress.android.ui.main.SitePickerAdapter.SitePickerMode;
import org.wordpress.android.ui.main.WPMainActivity;
import org.wordpress.android.ui.media.MediaBrowserActivity;
import org.wordpress.android.ui.media.MediaBrowserType;
import org.wordpress.android.ui.pages.PageParentActivity;
import org.wordpress.android.ui.pages.PagesActivity;
import org.wordpress.android.ui.people.PeopleManagementActivity;
import org.wordpress.android.ui.photopicker.MediaPickerConstants;
import org.wordpress.android.ui.photopicker.PhotoPickerActivity;
import org.wordpress.android.ui.plans.PlansActivity;
import org.wordpress.android.ui.plugins.PluginBrowserActivity;
import org.wordpress.android.ui.plugins.PluginDetailActivity;
import org.wordpress.android.ui.plugins.PluginUtils;
import org.wordpress.android.ui.posts.EditPostActivity;
import org.wordpress.android.ui.posts.JetpackSecuritySettingsActivity;
import org.wordpress.android.ui.posts.PostListType;
import org.wordpress.android.ui.posts.PostUtils;
import org.wordpress.android.ui.posts.PostUtils.EntryPoint;
import org.wordpress.android.ui.posts.PostsListActivity;
import org.wordpress.android.ui.posts.RemotePreviewLogicHelper.RemotePreviewType;
import org.wordpress.android.ui.prefs.AccountSettingsActivity;
import org.wordpress.android.ui.prefs.AppSettingsActivity;
import org.wordpress.android.ui.prefs.BlogPreferencesActivity;
import org.wordpress.android.ui.prefs.MyProfileActivity;
import org.wordpress.android.ui.prefs.categories.detail.CategoryDetailActivity;
import org.wordpress.android.ui.prefs.categories.list.CategoriesListActivity;
import org.wordpress.android.ui.prefs.notifications.NotificationsSettingsActivity;
import org.wordpress.android.ui.publicize.PublicizeListActivity;
import org.wordpress.android.ui.qrcodeauth.QRCodeAuthActivity;
import org.wordpress.android.ui.reader.ReaderActivityLauncher;
import org.wordpress.android.ui.reader.ReaderConstants;
import org.wordpress.android.ui.sitecreation.SiteCreationActivity;
import org.wordpress.android.ui.sitecreation.misc.SiteCreationSource;
import org.wordpress.android.ui.stats.StatsConnectJetpackActivity;
import org.wordpress.android.ui.stats.StatsConstants;
import org.wordpress.android.ui.stats.StatsTimeframe;
import org.wordpress.android.ui.stats.StatsViewType;
import org.wordpress.android.ui.stats.refresh.StatsActivity;
import org.wordpress.android.ui.stats.refresh.StatsActivity.StatsLaunchedFrom;
import org.wordpress.android.ui.stats.refresh.StatsViewAllActivity;
import org.wordpress.android.ui.stats.refresh.lists.StatsListViewModel.StatsSection;
import org.wordpress.android.ui.stats.refresh.lists.detail.StatsDetailActivity;
import org.wordpress.android.ui.stats.refresh.lists.sections.granular.SelectedDateProvider.SelectedDate;
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.management.InsightsManagementActivity;
import org.wordpress.android.ui.stockmedia.StockMediaPickerActivity;
import org.wordpress.android.ui.stories.StoryComposerActivity;
import org.wordpress.android.ui.suggestion.SuggestionActivity;
import org.wordpress.android.ui.suggestion.SuggestionType;
import org.wordpress.android.ui.themes.ThemeBrowserActivity;
import org.wordpress.android.util.AppLog;
import org.wordpress.android.util.AppLog.T;
import org.wordpress.android.util.ToastUtils;
import org.wordpress.android.util.UrlUtils;
import org.wordpress.android.util.WPActivityUtils;
import org.wordpress.android.util.analytics.AnalyticsUtils;

import java.io.UnsupportedEncodingException;
import java.net.URLEncoder;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import static com.wordpress.stories.util.BundleUtilsKt.KEY_STORY_INDEX;
import static com.wordpress.stories.util.BundleUtilsKt.KEY_STORY_SAVE_RESULT;
import static org.wordpress.android.analytics.AnalyticsTracker.ACTIVITY_LOG_ACTIVITY_ID_KEY;
import static org.wordpress.android.analytics.AnalyticsTracker.Stat.POST_LIST_ACCESS_ERROR;
import static org.wordpress.android.analytics.AnalyticsTracker.Stat.READER_ARTICLE_DETAIL_REBLOGGED;
import static org.wordpress.android.analytics.AnalyticsTracker.Stat.READER_ARTICLE_REBLOGGED;
import static org.wordpress.android.analytics.AnalyticsTracker.Stat.STATS_ACCESS_ERROR;
import static org.wordpress.android.editor.gutenberg.GutenbergEditorFragment.ARG_STORY_BLOCK_ID;
import static org.wordpress.android.imageeditor.preview.PreviewImageFragment.ARG_EDIT_IMAGE_DATA;
import static org.wordpress.android.login.LoginMode.JETPACK_LOGIN_ONLY;
import static org.wordpress.android.login.LoginMode.WPCOM_LOGIN_ONLY;
import static org.wordpress.android.push.NotificationsProcessingService.ARG_NOTIFICATION_TYPE;
import static org.wordpress.android.ui.WPWebViewActivity.ENCODING_UTF8;
import static org.wordpress.android.ui.jetpack.backup.download.BackupDownloadViewModelKt.KEY_BACKUP_DOWNLOAD_ACTIVITY_ID_KEY;
import static org.wordpress.android.ui.jetpack.restore.RestoreViewModelKt.KEY_RESTORE_ACTIVITY_ID_KEY;
import static org.wordpress.android.ui.jetpack.scan.ScanFragment.ARG_THREAT_ID;
import static org.wordpress.android.ui.media.MediaBrowserActivity.ARG_BROWSER_TYPE;
import static org.wordpress.android.ui.pages.PagesActivityKt.EXTRA_PAGE_REMOTE_ID_KEY;
import static org.wordpress.android.ui.stories.StoryComposerActivity.KEY_ALL_UNFLATTENED_LOADED_SLIDES;
import static org.wordpress.android.ui.stories.StoryComposerActivity.KEY_LAUNCHED_FROM_GUTENBERG;
import static org.wordpress.android.ui.stories.StoryComposerActivity.KEY_POST_LOCAL_ID;
import static org.wordpress.android.viewmodel.activitylog.ActivityLogDetailViewModelKt.ACTIVITY_LOG_ARE_BUTTONS_VISIBLE_KEY;
import static org.wordpress.android.viewmodel.activitylog.ActivityLogDetailViewModelKt.ACTIVITY_LOG_ID_KEY;
import static org.wordpress.android.viewmodel.activitylog.ActivityLogDetailViewModelKt.ACTIVITY_LOG_IS_RESTORE_HIDDEN_KEY;
import static org.wordpress.android.viewmodel.activitylog.ActivityLogViewModelKt.ACTIVITY_LOG_REWINDABLE_ONLY_KEY;

<span class="nc" id="L158">public class ActivityLauncher {</span>
    public static final String SOURCE_TRACK_EVENT_PROPERTY_KEY = &quot;source&quot;;
    public static final String BACKUP_TRACK_EVENT_PROPERTY_VALUE = &quot;backup&quot;;
    public static final String ACTIVITY_LOG_TRACK_EVENT_PROPERTY_VALUE = &quot;activity_log&quot;;
    private static final String CATEGORY_DETAIL_ID = &quot;category_detail_key&quot;;

    public static void showMainActivityAndLoginEpilogue(Activity activity, ArrayList&lt;Integer&gt; oldSitesIds,
                                                        boolean doLoginUpdate) {
<span class="nc" id="L166">        Intent intent = new Intent(activity, WPMainActivity.class);</span>
<span class="nc" id="L167">        intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);</span>
<span class="nc" id="L168">        intent.putExtra(WPMainActivity.ARG_DO_LOGIN_UPDATE, doLoginUpdate);</span>
<span class="nc" id="L169">        intent.putExtra(WPMainActivity.ARG_SHOW_LOGIN_EPILOGUE, true);</span>
<span class="nc" id="L170">        intent.putIntegerArrayListExtra(WPMainActivity.ARG_OLD_SITES_IDS, oldSitesIds);</span>
<span class="nc" id="L171">        activity.startActivity(intent);</span>
<span class="nc" id="L172">    }</span>

    public static void showMainActivityAndSignupEpilogue(Activity activity, String name, String email, String photoUrl,
                                                         String username) {
<span class="nc" id="L176">        Intent intent = new Intent(activity, WPMainActivity.class);</span>
<span class="nc" id="L177">        intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);</span>
<span class="nc" id="L178">        intent.putExtra(WPMainActivity.ARG_SHOW_SIGNUP_EPILOGUE, true);</span>
<span class="nc" id="L179">        intent.putExtra(SignupEpilogueActivity.EXTRA_SIGNUP_DISPLAY_NAME, name);</span>
<span class="nc" id="L180">        intent.putExtra(SignupEpilogueActivity.EXTRA_SIGNUP_EMAIL_ADDRESS, email);</span>
<span class="nc" id="L181">        intent.putExtra(SignupEpilogueActivity.EXTRA_SIGNUP_PHOTO_URL, photoUrl);</span>
<span class="nc" id="L182">        intent.putExtra(SignupEpilogueActivity.EXTRA_SIGNUP_USERNAME, username);</span>
<span class="nc" id="L183">        activity.startActivity(intent);</span>
<span class="nc" id="L184">    }</span>

    /**
     * Presents the site picker and expects the selection result
     *
     * @param activity the activity that starts the site picker and expects the result
     * @param site     the preselected site
     */
    public static void showSitePickerForResult(Activity activity, SiteModel site) {
<span class="nc" id="L193">        Intent intent = createSitePickerIntent(activity, site, SitePickerMode.DEFAULT_MODE);</span>
<span class="nc" id="L194">        activity.startActivityForResult(intent, RequestCodes.SITE_PICKER);</span>
<span class="nc" id="L195">    }</span>

    /**
     * Presents the site picker and expects the selection result
     *
     * @param fragment the fragment that starts the site picker and expects the result
     * @param site     the preselected site
     * @param mode     site picker mode
     */
    public static void showSitePickerForResult(Fragment fragment, SiteModel site, SitePickerMode mode) {
<span class="nc" id="L205">        Intent intent = createSitePickerIntent(fragment.getContext(), site, mode);</span>
<span class="nc" id="L206">        fragment.startActivityForResult(intent, RequestCodes.SITE_PICKER);</span>
<span class="nc" id="L207">    }</span>

    /**
     * Creates a site picker intent
     *
     * @param context the context to use for the intent creation
     * @param site    the preselected site
     * @param mode    site picker mode
     * @return the site picker intent
     */
    private static Intent createSitePickerIntent(Context context, SiteModel site, SitePickerMode mode) {
<span class="nc" id="L218">        Intent intent = new Intent(context, SitePickerActivity.class);</span>
<span class="nc" id="L219">        intent.putExtra(SitePickerActivity.KEY_SITE_LOCAL_ID, site.getId());</span>
<span class="nc" id="L220">        intent.putExtra(SitePickerActivity.KEY_SITE_PICKER_MODE, mode);</span>
<span class="nc" id="L221">        return intent;</span>
    }

    /**
     * Use {@link org.wordpress.android.ui.photopicker.MediaPickerLauncher::showPhotoPickerForResult}  instead
     */
    @Deprecated
    public static void showPhotoPickerForResult(Activity activity,
                                                @NonNull MediaBrowserType browserType,
                                                @Nullable SiteModel site,
                                                @Nullable Integer localPostId) {
<span class="nc" id="L232">        Intent intent = createShowPhotoPickerIntent(activity, browserType, site, localPostId);</span>
<span class="nc" id="L233">        activity.startActivityForResult(intent, RequestCodes.PHOTO_PICKER);</span>
<span class="nc" id="L234">    }</span>

    private static Intent createShowPhotoPickerIntent(Context context,
                                                      @NonNull MediaBrowserType browserType,
                                                      @Nullable SiteModel site,
                                                      @Nullable Integer localPostId) {
<span class="nc" id="L240">        Intent intent = new Intent(context, PhotoPickerActivity.class);</span>
<span class="nc" id="L241">        intent.putExtra(ARG_BROWSER_TYPE, browserType);</span>
<span class="nc bnc" id="L242" title="All 2 branches missed.">        if (site != null) {</span>
<span class="nc" id="L243">            intent.putExtra(WordPress.SITE, site);</span>
        }
<span class="nc bnc" id="L245" title="All 2 branches missed.">        if (localPostId != null) {</span>
<span class="nc" id="L246">            intent.putExtra(MediaPickerConstants.LOCAL_POST_ID, localPostId.intValue());</span>
        }
<span class="nc" id="L248">        return intent;</span>
    }

    /**
     * Use {@link org.wordpress.android.ui.photopicker.MediaPickerLauncher::showStockMediaPickerForResult}  instead
     */
    @Deprecated
    public static void showStockMediaPickerForResult(Activity activity,
                                                     @NonNull SiteModel site,
                                                     int requestCode) {
<span class="nc" id="L258">        Map&lt;String, String&gt; properties = new HashMap&lt;&gt;();</span>
<span class="nc" id="L259">        properties.put(&quot;from&quot;, activity.getClass().getSimpleName());</span>
<span class="nc" id="L260">        AnalyticsTracker.track(AnalyticsTracker.Stat.STOCK_MEDIA_ACCESSED, properties);</span>

<span class="nc" id="L262">        Intent intent = new Intent(activity, StockMediaPickerActivity.class);</span>
<span class="nc" id="L263">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L264">        intent.putExtra(StockMediaPickerActivity.KEY_REQUEST_CODE, requestCode);</span>

<span class="nc" id="L266">        activity.startActivityForResult(intent, requestCode);</span>
<span class="nc" id="L267">    }</span>

    public static void startJetpackInstall(Context context, JetpackConnectionSource source, SiteModel site) {
<span class="nc" id="L270">        Intent intent = new Intent(context, JetpackRemoteInstallActivity.class);</span>
<span class="nc" id="L271">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L272">        intent.putExtra(JetpackRemoteInstallFragment.TRACKING_SOURCE_KEY, source);</span>
<span class="nc" id="L273">        context.startActivity(intent);</span>
<span class="nc" id="L274">    }</span>

    public static void continueJetpackConnect(Context context, JetpackConnectionSource source, SiteModel site) {
<span class="nc bnc" id="L277" title="All 3 branches missed.">        switch (source) {</span>
            case NOTIFICATIONS:
<span class="nc" id="L279">                continueJetpackConnectForNotifications(context, site);</span>
<span class="nc" id="L280">                break;</span>
            case STATS:
<span class="nc" id="L282">                continueJetpackConnectForStats(context, site);</span>
                break;
        }
<span class="nc" id="L285">    }</span>

    private static void continueJetpackConnectForNotifications(Context context, SiteModel site) {
<span class="nc" id="L288">        Intent intent = new Intent(context, WPMainActivity.class);</span>
<span class="nc" id="L289">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L290">        intent.putExtra(WPMainActivity.ARG_CONTINUE_JETPACK_CONNECT, true);</span>
<span class="nc" id="L291">        context.startActivity(intent);</span>
<span class="nc" id="L292">    }</span>

    private static void continueJetpackConnectForStats(Context context, SiteModel site) {
<span class="nc" id="L295">        Intent intent = new Intent(context, StatsConnectJetpackActivity.class);</span>
<span class="nc" id="L296">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L297">        intent.putExtra(StatsConnectJetpackActivity.ARG_CONTINUE_JETPACK_CONNECT, true);</span>
<span class="nc" id="L298">        context.startActivity(intent);</span>
<span class="nc" id="L299">    }</span>

    public static void viewNotifications(Context context) {
<span class="nc" id="L302">        Intent intent = new Intent(context, WPMainActivity.class);</span>
<span class="nc" id="L303">        intent.putExtra(WPMainActivity.ARG_OPEN_PAGE, WPMainActivity.ARG_NOTIFICATIONS);</span>
<span class="nc" id="L304">        intent.addFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP);</span>
<span class="nc" id="L305">        context.startActivity(intent);</span>
<span class="nc" id="L306">    }</span>

    public static void viewNotificationsInNewStack(Context context) {
<span class="nc" id="L309">        Intent intent = getMainActivityInNewStack(context);</span>
<span class="nc" id="L310">        intent.putExtra(WPMainActivity.ARG_OPEN_PAGE, WPMainActivity.ARG_NOTIFICATIONS);</span>
<span class="nc" id="L311">        context.startActivity(intent);</span>
<span class="nc" id="L312">    }</span>

    public static void viewMySiteInNewStack(Context context) {
<span class="nc" id="L315">        Intent intent = getMainActivityInNewStack(context);</span>
<span class="nc" id="L316">        intent.putExtra(WPMainActivity.ARG_OPEN_PAGE, WPMainActivity.ARG_MY_SITE);</span>
<span class="nc" id="L317">        context.startActivity(intent);</span>
<span class="nc" id="L318">    }</span>

    public static void viewReader(Context context) {
<span class="nc" id="L321">        Intent intent = new Intent(context, WPMainActivity.class);</span>
<span class="nc" id="L322">        intent.putExtra(WPMainActivity.ARG_OPEN_PAGE, WPMainActivity.ARG_READER);</span>
<span class="nc" id="L323">        intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);</span>
<span class="nc" id="L324">        context.startActivity(intent);</span>
<span class="nc" id="L325">    }</span>

    public static void viewReaderInNewStack(Context context) {
<span class="nc" id="L328">        Intent intent = getMainActivityInNewStack(context);</span>
<span class="nc" id="L329">        intent.putExtra(WPMainActivity.ARG_OPEN_PAGE, WPMainActivity.ARG_READER);</span>
<span class="nc" id="L330">        context.startActivity(intent);</span>
<span class="nc" id="L331">    }</span>

    public static void viewPostDeeplinkInNewStack(Context context, Uri uri) {
<span class="nc" id="L334">        Intent mainActivityIntent = getMainActivityInNewStack(context)</span>
<span class="nc" id="L335">                .putExtra(WPMainActivity.ARG_OPEN_PAGE, WPMainActivity.ARG_READER);</span>
<span class="nc" id="L336">        Intent viewPostIntent = new Intent(ReaderConstants.ACTION_VIEW_POST, uri);</span>
<span class="nc" id="L337">        TaskStackBuilder.create(context)</span>
<span class="nc" id="L338">                        .addNextIntent(mainActivityIntent)</span>
<span class="nc" id="L339">                        .addNextIntent(viewPostIntent)</span>
<span class="nc" id="L340">                        .startActivities();</span>
<span class="nc" id="L341">    }</span>

    public static void viewReaderPostDetailInNewStack(Context context, long blogId, long postId, Uri uri) {
<span class="nc" id="L344">        Intent mainActivityIntent = getMainActivityInNewStack(context)</span>
<span class="nc" id="L345">                .putExtra(WPMainActivity.ARG_OPEN_PAGE, WPMainActivity.ARG_READER);</span>
<span class="nc" id="L346">        Intent viewPostIntent = ReaderActivityLauncher.buildReaderPostDetailIntent(</span>
                context,
                false,
                blogId,
                postId,
                null,
                0,
                false,
<span class="nc" id="L354">                uri.toString()</span>
        );
<span class="nc" id="L356">        TaskStackBuilder.create(context)</span>
<span class="nc" id="L357">                        .addNextIntent(mainActivityIntent)</span>
<span class="nc" id="L358">                        .addNextIntent(viewPostIntent)</span>
<span class="nc" id="L359">                        .startActivities();</span>
<span class="nc" id="L360">    }</span>

    public static void openEditorInNewStack(Context context) {
<span class="nc" id="L363">        Intent intent = getMainActivityInNewStack(context);</span>
<span class="nc" id="L364">        intent.putExtra(WPMainActivity.ARG_OPEN_PAGE, WPMainActivity.ARG_EDITOR);</span>
<span class="nc" id="L365">        context.startActivity(intent);</span>
<span class="nc" id="L366">    }</span>

    public static Intent openEditorWithBloggingPrompt(
            @NonNull final Context context,
            final int promptId,
            final EntryPoint entryPoint
    ) {
<span class="nc" id="L373">        final Intent intent = getMainActivityInNewStack(context);</span>
<span class="nc" id="L374">        intent.putExtra(WPMainActivity.ARG_OPEN_PAGE, WPMainActivity.ARG_EDITOR);</span>
<span class="nc" id="L375">        intent.putExtra(WPMainActivity.ARG_EDITOR_PROMPT_ID, promptId);</span>
<span class="nc" id="L376">        intent.putExtra(WPMainActivity.ARG_EDITOR_ORIGIN, entryPoint);</span>
<span class="nc" id="L377">        return intent;</span>
    }

    public static Intent openEditorWithPromptAndDismissNotificationIntent(
        @NonNull final Context context,
        final int notificationId,
        final BloggingPromptModel bloggingPrompt,
        @Nullable final Stat stat,
        final EntryPoint entryPoint
    ) {
<span class="nc" id="L387">        final Intent intent = getMainActivityInNewStack(context);</span>
<span class="nc" id="L388">        intent.putExtra(WPMainActivity.ARG_OPEN_PAGE, WPMainActivity.ARG_EDITOR);</span>
<span class="nc" id="L389">        intent.putExtra(WPMainActivity.ARG_EDITOR_PROMPT_ID, bloggingPrompt.getId());</span>
<span class="nc" id="L390">        intent.putExtra(WPMainActivity.ARG_DISMISS_NOTIFICATION, notificationId);</span>
<span class="nc" id="L391">        intent.putExtra(WPMainActivity.ARG_EDITOR_ORIGIN, entryPoint);</span>
<span class="nc" id="L392">        intent.putExtra(WPMainActivity.ARG_STAT_TO_TRACK, stat);</span>
<span class="nc" id="L393">        return intent;</span>
    }

    public static void openEditorForSiteInNewStack(Context context, @NonNull SiteModel site) {
<span class="nc" id="L397">        TaskStackBuilder taskStackBuilder = TaskStackBuilder.create(context);</span>
<span class="nc" id="L398">        Intent mainActivityIntent = getMainActivityInNewStack(context);</span>

<span class="nc" id="L400">        Intent editorIntent = new Intent(context, EditPostActivity.class);</span>
<span class="nc" id="L401">        editorIntent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L402">        editorIntent.putExtra(EditPostActivity.EXTRA_IS_PAGE, false);</span>

<span class="nc" id="L404">        taskStackBuilder.addNextIntent(mainActivityIntent);</span>
<span class="nc" id="L405">        taskStackBuilder.addNextIntent(editorIntent);</span>
<span class="nc" id="L406">        taskStackBuilder.startActivities();</span>
<span class="nc" id="L407">    }</span>


    public static void openEditorForPostInNewStack(Context context, @NonNull SiteModel site, int localPostId) {
<span class="nc" id="L411">        TaskStackBuilder taskStackBuilder = TaskStackBuilder.create(context);</span>
<span class="nc" id="L412">        Intent mainActivityIntent = getMainActivityInNewStack(context);</span>

<span class="nc" id="L414">        Intent editorIntent = new Intent(context, EditPostActivity.class);</span>
<span class="nc" id="L415">        editorIntent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L416">        editorIntent.putExtra(EditPostActivity.EXTRA_POST_LOCAL_ID, localPostId);</span>
<span class="nc" id="L417">        editorIntent.putExtra(EditPostActivity.EXTRA_IS_PAGE, false);</span>

<span class="nc" id="L419">        taskStackBuilder.addNextIntent(mainActivityIntent);</span>
<span class="nc" id="L420">        taskStackBuilder.addNextIntent(editorIntent);</span>
<span class="nc" id="L421">        taskStackBuilder.startActivities();</span>
<span class="nc" id="L422">    }</span>

    /**
     * Opens the editor and passes the information needed for a reblog action
     *
     * @param activity the calling activity
     * @param site     the site on which the post should be reblogged
     * @param post     the post to be reblogged
     */
    public static void openEditorForReblog(
            Activity activity,
            @Nullable SiteModel site,
            @Nullable ReaderPost post,
            PagePostCreationSourcesDetail reblogSource
    ) {
<span class="nc bnc" id="L437" title="All 2 branches missed.">        if (post == null) {</span>
<span class="nc" id="L438">            ToastUtils.showToast(activity, R.string.post_not_found, ToastUtils.Duration.SHORT);</span>
<span class="nc" id="L439">            return;</span>
        }

<span class="nc bnc" id="L442" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L443">            ToastUtils.showToast(activity, R.string.blog_not_found, ToastUtils.Duration.SHORT);</span>
<span class="nc" id="L444">            return;</span>
        }

<span class="nc" id="L447">        AnalyticsUtils.trackWithReblogDetails(</span>
<span class="nc bnc" id="L448" title="All 2 branches missed.">            reblogSource == PagePostCreationSourcesDetail.POST_FROM_REBLOG</span>
<span class="nc" id="L449">                    ? READER_ARTICLE_REBLOGGED</span>
<span class="nc" id="L450">                    : READER_ARTICLE_DETAIL_REBLOGGED,</span>
            post.blogId,
            post.postId,
<span class="nc" id="L453">            site.getSiteId()</span>
        );

<span class="nc" id="L456">        Intent editorIntent = new Intent(activity, EditPostActivity.class);</span>
<span class="nc" id="L457">        editorIntent.putExtra(EditPostActivity.EXTRA_REBLOG_POST_TITLE, post.getTitle());</span>
<span class="nc" id="L458">        editorIntent.putExtra(EditPostActivity.EXTRA_REBLOG_POST_QUOTE, post.getExcerpt());</span>
<span class="nc" id="L459">        editorIntent.putExtra(EditPostActivity.EXTRA_REBLOG_POST_IMAGE, post.getFeaturedImage());</span>
<span class="nc" id="L460">        editorIntent.putExtra(EditPostActivity.EXTRA_REBLOG_POST_CITATION, post.getUrl());</span>
<span class="nc" id="L461">        editorIntent.setAction(EditPostActivity.ACTION_REBLOG);</span>

<span class="nc" id="L463">        addNewPostForResult(editorIntent, activity, site, false, reblogSource, -1, null);</span>
<span class="nc" id="L464">    }</span>

    public static void viewStatsInNewStack(Context context, SiteModel site) {
<span class="nc" id="L467">        viewStatsInNewStack(context, site, null);</span>
<span class="nc" id="L468">    }</span>

    public static void viewStatsInNewStack(Context context, SiteModel site, @Nullable StatsTimeframe statsTimeframe) {
<span class="nc" id="L471">        viewStatsInNewStack(context, site, statsTimeframe, null);</span>
<span class="nc" id="L472">    }</span>

    public static void viewStatsInNewStack(Context context, SiteModel site, @Nullable StatsTimeframe statsTimeframe,
                                           @Nullable String period) {
<span class="nc bnc" id="L476" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L477">            handleMissingSite(context);</span>
<span class="nc" id="L478">            return;</span>
        }
<span class="nc" id="L480">        runIntentOverMainActivityInNewStack(context, StatsActivity.buildIntent(context, site, statsTimeframe, period));</span>
<span class="nc" id="L481">    }</span>

    private static void handleMissingSite(Context context) {
<span class="nc" id="L484">        AppLog.e(T.STATS, &quot;SiteModel is null when opening the stats from the deeplink.&quot;);</span>
<span class="nc" id="L485">        AnalyticsTracker.track(</span>
                STATS_ACCESS_ERROR,
<span class="nc" id="L487">                ActivityLauncher.class.getName(),</span>
                &quot;NullPointerException&quot;,
                &quot;Failed to open Stats from the deeplink because of the null SiteModel&quot;
        );
<span class="nc" id="L491">        ToastUtils.showToast(context, R.string.stats_cannot_be_started, ToastUtils.Duration.SHORT);</span>
<span class="nc" id="L492">    }</span>

    private static void runIntentOverMainActivityInNewStack(Context context, Intent intent) {
<span class="nc" id="L495">        buildIntentOverMainActivityInNewStack(context, intent).startActivities();</span>
<span class="nc" id="L496">    }</span>

    public static PendingIntent buildStatsPendingIntentOverMainActivityInNewStack(Context context, SiteModel site,
                                                                                  @Nullable StatsTimeframe timeframe,
                                                                                  @Nullable String period,
                                                                                  @Nullable NotificationType type,
                                                                                  int requestCode, int flags) {
<span class="nc" id="L503">        return buildPendingIntentOverMainActivityInNewStack(context,</span>
<span class="nc" id="L504">                StatsActivity.buildIntent(context, site, timeframe, period, type), requestCode, flags);</span>
    }

    private static PendingIntent buildPendingIntentOverMainActivityInNewStack(Context context, Intent intent,
                                                                              int requestCode, int flags) {
<span class="nc" id="L509">        return buildIntentOverMainActivityInNewStack(context, intent).getPendingIntent(requestCode, flags);</span>
    }

    private static TaskStackBuilder buildIntentOverMainActivityInNewStack(Context context, Intent intent) {
<span class="nc" id="L513">        TaskStackBuilder taskStackBuilder = TaskStackBuilder.create(context);</span>

<span class="nc" id="L515">        Intent mainActivityIntent = getMainActivityInNewStack(context);</span>

<span class="nc" id="L517">        taskStackBuilder.addNextIntent(mainActivityIntent);</span>
<span class="nc" id="L518">        taskStackBuilder.addNextIntent(intent);</span>
<span class="nc" id="L519">        return taskStackBuilder;</span>
    }

    public static void viewStatsInNewStack(Context context) {
<span class="nc" id="L523">        Intent intent = getMainActivityInNewStack(context);</span>
<span class="nc" id="L524">        intent.putExtra(WPMainActivity.ARG_OPEN_PAGE, WPMainActivity.ARG_STATS);</span>
<span class="nc" id="L525">        context.startActivity(intent);</span>
<span class="nc" id="L526">    }</span>

    public static void viewStatsForTimeframeInNewStack(Context context, StatsTimeframe statsTimeframe) {
<span class="nc" id="L529">        Intent intent = getMainActivityInNewStack(context);</span>
<span class="nc" id="L530">        intent.putExtra(WPMainActivity.ARG_OPEN_PAGE, WPMainActivity.ARG_STATS);</span>
<span class="nc" id="L531">        intent.putExtra(WPMainActivity.ARG_STATS_TIMEFRAME, statsTimeframe);</span>
<span class="nc" id="L532">        context.startActivity(intent);</span>
<span class="nc" id="L533">    }</span>

    private static Intent getMainActivityInNewStack(Context context) {
<span class="nc" id="L536">        Intent mainActivityIntent = new Intent(context, WPMainActivity.class);</span>
<span class="nc" id="L537">        mainActivityIntent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TASK | Intent.FLAG_ACTIVITY_NEW_TASK);</span>

<span class="nc" id="L539">        return mainActivityIntent;</span>
    }

    public static void viewSavedPostsListInReader(Context context) {
<span class="nc" id="L543">        ReaderPostTable.purgeUnbookmarkedPostsWithBookmarkTag();</span>
<span class="nc" id="L544">        Intent intent = new Intent(context, WPMainActivity.class);</span>
<span class="nc" id="L545">        intent.putExtra(WPMainActivity.ARG_OPEN_PAGE, WPMainActivity.ARG_READER);</span>
<span class="nc" id="L546">        intent.putExtra(WPMainActivity.ARG_READER_BOOKMARK_TAB, true);</span>
<span class="nc" id="L547">        intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_SINGLE_TOP);</span>
<span class="nc" id="L548">        context.startActivity(intent);</span>
<span class="nc" id="L549">    }</span>

    public static void viewBlogStats(Context context, SiteModel site) {
<span class="nc bnc" id="L552" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L553">            AppLog.e(T.STATS, &quot;SiteModel is null when opening the stats.&quot;);</span>
<span class="nc" id="L554">            AnalyticsTracker.track(</span>
                    STATS_ACCESS_ERROR,
<span class="nc" id="L556">                    ActivityLauncher.class.getName(),</span>
                    &quot;NullPointerException&quot;,
                    &quot;Failed to open Stats because of the null SiteModel&quot;
                                  );
<span class="nc" id="L560">            ToastUtils.showToast(context, R.string.stats_cannot_be_started, ToastUtils.Duration.SHORT);</span>
        } else {
<span class="nc" id="L562">            StatsActivity.start(context, site);</span>
        }
<span class="nc" id="L564">    }</span>

    public static void openBlogStats(Context context, SiteModel site) {
<span class="nc bnc" id="L567" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L568">            AppLog.e(T.STATS, &quot;SiteModel is null when opening the stats.&quot;);</span>
<span class="nc" id="L569">            AnalyticsTracker.track(</span>
                    STATS_ACCESS_ERROR,
<span class="nc" id="L571">                    ActivityLauncher.class.getName(),</span>
                    &quot;NullPointerException&quot;,
                    &quot;Failed to open Stats because of the null SiteModel&quot;
            );
<span class="nc" id="L575">            ToastUtils.showToast(context, R.string.stats_cannot_be_started, ToastUtils.Duration.SHORT);</span>
        } else {
<span class="nc" id="L577">            Intent intent = new Intent(context, StatsActivity.class);</span>
<span class="nc" id="L578">            intent.putExtra(StatsActivity.ARG_LAUNCHED_FROM, StatsLaunchedFrom.FEATURE_ANNOUNCEMENT);</span>
<span class="nc" id="L579">            intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L580">            context.startActivity(intent);</span>
        }
<span class="nc" id="L582">    }</span>

    public static void viewBlogStatsForTimeframe(Context context, SiteModel site, StatsTimeframe statsTimeframe) {
<span class="nc bnc" id="L585" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L586">            AppLog.e(T.STATS, &quot;SiteModel is null when opening the stats.&quot;);</span>
<span class="nc" id="L587">            AnalyticsTracker.track(</span>
                    STATS_ACCESS_ERROR,
<span class="nc" id="L589">                    ActivityLauncher.class.getName(),</span>
                    &quot;NullPointerException&quot;,
                    &quot;Failed to open Stats because of the null SiteModel&quot;
                                  );
<span class="nc" id="L593">            ToastUtils.showToast(context, R.string.stats_cannot_be_started, ToastUtils.Duration.SHORT);</span>
        } else {
<span class="nc" id="L595">            StatsActivity.start(context, site, statsTimeframe);</span>
        }
<span class="nc" id="L597">    }</span>

    public static void viewAllTabbedInsightsStats(Context context, StatsViewType statsType, int selectedTab,
                                                  int localSiteId) {
<span class="nc" id="L601">        StatsViewAllActivity.startForTabbedInsightsStats(context, statsType, selectedTab, localSiteId);</span>
<span class="nc" id="L602">    }</span>

    public static void viewAllInsightsStats(Context context, StatsViewType statsType, int localSiteId) {
<span class="nc" id="L605">        StatsViewAllActivity.startForInsights(context, statsType, localSiteId);</span>
<span class="nc" id="L606">    }</span>

    public static void viewAllGranularStats(Context context, StatsGranularity granularity, SelectedDate selectedDate,
                                            StatsViewType statsType, int localSiteId) {
<span class="nc" id="L610">        StatsViewAllActivity.startForGranularStats(context, statsType, granularity, selectedDate, localSiteId);</span>
<span class="nc" id="L611">    }</span>

    public static void viewInsightsManagement(Context context, int localSiteId) {
<span class="nc" id="L614">        Intent intent = new Intent(context, InsightsManagementActivity.class);</span>
<span class="nc" id="L615">        intent.putExtra(WordPress.LOCAL_SITE_ID, localSiteId);</span>
<span class="nc" id="L616">        context.startActivity(intent);</span>
<span class="nc" id="L617">    }</span>

    public static void viewBlogStatsAfterJetpackSetup(Context context, SiteModel site) {
<span class="nc bnc" id="L620" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L621">            AppLog.e(T.STATS, &quot;SiteModel is null when opening the stats.&quot;);</span>
<span class="nc" id="L622">            AnalyticsTracker.track(</span>
                    STATS_ACCESS_ERROR,
<span class="nc" id="L624">                    ActivityLauncher.class.getName(),</span>
                    &quot;NullPointerException&quot;,
                    &quot;Failed to open Stats because of the null SiteModel&quot;
                                  );
<span class="nc" id="L628">            ToastUtils.showToast(context, R.string.stats_cannot_be_started, ToastUtils.Duration.SHORT);</span>
<span class="nc" id="L629">            return;</span>
        }
<span class="nc" id="L631">        StatsActivity.start(context, site);</span>
<span class="nc" id="L632">    }</span>

    public static void viewConnectJetpackForStats(Context context, SiteModel site) {
<span class="nc" id="L635">        Intent intent = new Intent(context, StatsConnectJetpackActivity.class);</span>
<span class="nc" id="L636">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L637">        context.startActivity(intent);</span>
<span class="nc" id="L638">    }</span>

    public static void viewBlogPlans(Context context, SiteModel site) {
<span class="nc" id="L641">        Intent intent = new Intent(context, PlansActivity.class);</span>
<span class="nc" id="L642">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L643">        context.startActivity(intent);</span>
<span class="nc" id="L644">        AnalyticsUtils.trackWithSiteDetails(Stat.OPENED_PLANS, site);</span>
<span class="nc" id="L645">    }</span>

    public static void viewCurrentBlogPosts(Context context, SiteModel site) {
<span class="nc" id="L648">        viewCurrentBlogPostsOfType(context, site, null);</span>
<span class="nc" id="L649">    }</span>

    public static void viewCurrentBlogPostsOfType(Context context, SiteModel site, PostListType postListType) {
<span class="nc bnc" id="L652" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L653">            AppLog.e(T.POSTS, &quot;Site cannot be null when opening posts&quot;);</span>
<span class="nc" id="L654">            AnalyticsTracker.track(</span>
                    POST_LIST_ACCESS_ERROR,
<span class="nc" id="L656">                    ActivityLauncher.class.getName(),</span>
                    &quot;NullPointerException&quot;,
                    &quot;Failed to open Posts because of the null SiteModel&quot;
            );
<span class="nc" id="L660">            ToastUtils.showToast(context, R.string.posts_cannot_be_started, ToastUtils.Duration.SHORT);</span>
<span class="nc" id="L661">            return;</span>
        }
<span class="nc bnc" id="L663" title="All 2 branches missed.">        if (postListType == null) {</span>
<span class="nc" id="L664">            context.startActivity(PostsListActivity.buildIntent(context, site));</span>
        } else {
<span class="nc" id="L666">            context.startActivity(PostsListActivity.buildIntent(context, site, postListType, false, null));</span>
        }
<span class="nc" id="L668">        AnalyticsUtils.trackWithSiteDetails(AnalyticsTracker.Stat.OPENED_POSTS, site);</span>
<span class="nc" id="L669">    }</span>

    public static void viewCurrentBlogMedia(Context context, SiteModel site) {
<span class="nc" id="L672">        Intent intent = new Intent(context, MediaBrowserActivity.class);</span>
<span class="nc" id="L673">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L674">        intent.putExtra(ARG_BROWSER_TYPE, MediaBrowserType.BROWSER);</span>
<span class="nc" id="L675">        context.startActivity(intent);</span>
<span class="nc" id="L676">        AnalyticsUtils.trackWithSiteDetails(AnalyticsTracker.Stat.OPENED_MEDIA_LIBRARY, site);</span>
<span class="nc" id="L677">    }</span>

    public static void viewCurrentBlogPages(@NonNull Context context, @NonNull SiteModel site) {
<span class="nc" id="L680">        Intent intent = new Intent(context, PagesActivity.class);</span>
<span class="nc" id="L681">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L682">        context.startActivity(intent);</span>
<span class="nc" id="L683">        AnalyticsUtils.trackWithSiteDetails(AnalyticsTracker.Stat.OPENED_PAGES, site);</span>
<span class="nc" id="L684">    }</span>

    public static void viewPageParentForResult(@NonNull Fragment fragment, @NonNull PageModel page) {
<span class="nc" id="L687">        Intent intent = new Intent(fragment.getContext(), PageParentActivity.class);</span>
<span class="nc" id="L688">        intent.putExtra(WordPress.SITE, page.getSite());</span>
<span class="nc" id="L689">        intent.putExtra(EXTRA_PAGE_REMOTE_ID_KEY, page.getRemoteId());</span>
<span class="nc" id="L690">        fragment.startActivityForResult(intent, RequestCodes.PAGE_PARENT);</span>

<span class="nc" id="L692">        AnalyticsUtils.trackWithSiteDetails(AnalyticsTracker.Stat.OPENED_PAGE_PARENT, page.getSite());</span>
<span class="nc" id="L693">    }</span>

    public static void viewUnifiedComments(Context context, SiteModel site) {
<span class="nc" id="L696">        Intent intent = new Intent(context, UnifiedCommentsActivity.class);</span>
<span class="nc" id="L697">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L698">        context.startActivity(intent);</span>
<span class="nc" id="L699">        AnalyticsUtils.trackWithSiteDetails(AnalyticsTracker.Stat.OPENED_COMMENTS, site);</span>
<span class="nc" id="L700">    }</span>

    public static void viewUnifiedCommentsDetails(Context context, SiteModel site) {
<span class="nc" id="L703">        Intent intent = new Intent(context, UnifiedCommentsDetailsActivity.class);</span>
<span class="nc" id="L704">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L705">        context.startActivity(intent);</span>
<span class="nc" id="L706">    }</span>

    public static void viewCurrentBlogThemes(Context context, SiteModel site) {
<span class="nc" id="L709">        Intent intent = new Intent(context, ThemeBrowserActivity.class);</span>
<span class="nc" id="L710">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L711">        context.startActivity(intent);</span>
<span class="nc" id="L712">        AnalyticsUtils.trackWithSiteDetails(AnalyticsTracker.Stat.THEMES_ACCESSED_THEMES_BROWSER, site);</span>
<span class="nc" id="L713">    }</span>

    public static void viewCurrentBlogPeople(Context context, SiteModel site) {
<span class="nc" id="L716">        Intent intent = new Intent(context, PeopleManagementActivity.class);</span>
<span class="nc" id="L717">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L718">        context.startActivity(intent);</span>
<span class="nc" id="L719">        AnalyticsUtils.trackWithSiteDetails(AnalyticsTracker.Stat.OPENED_PEOPLE_MANAGEMENT, site);</span>
<span class="nc" id="L720">    }</span>

    public static void viewPluginBrowser(Context context, SiteModel site) {
<span class="nc bnc" id="L723" title="All 2 branches missed.">        if (PluginUtils.isPluginFeatureAvailable(site)) {</span>
<span class="nc" id="L724">            AnalyticsUtils.trackWithSiteDetails(AnalyticsTracker.Stat.OPENED_PLUGIN_DIRECTORY, site);</span>
<span class="nc" id="L725">            Intent intent = new Intent(context, PluginBrowserActivity.class);</span>
<span class="nc" id="L726">            intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L727">            context.startActivity(intent);</span>
        }
<span class="nc" id="L729">    }</span>

    public static void viewPluginDetail(Activity context, SiteModel site, String slug) {
<span class="nc bnc" id="L732" title="All 2 branches missed.">        if (PluginUtils.isPluginFeatureAvailable(site)) {</span>
<span class="nc" id="L733">            AnalyticsUtils.trackWithSiteDetails(AnalyticsTracker.Stat.OPENED_PLUGIN_DETAIL, site);</span>
<span class="nc" id="L734">            Intent intent = new Intent(context, PluginDetailActivity.class);</span>
<span class="nc" id="L735">            intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L736">            intent.putExtra(PluginDetailActivity.KEY_PLUGIN_SLUG, slug);</span>
<span class="nc" id="L737">            context.startActivity(intent);</span>
        }
<span class="nc" id="L739">    }</span>

    public static void viewDomainsDashboardActivity(Activity activity, @NonNull SiteModel site) {
<span class="nc" id="L742">        Intent intent = new Intent(activity, DomainsDashboardActivity.class);</span>
<span class="nc" id="L743">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L744">        activity.startActivity(intent);</span>
<span class="nc" id="L745">    }</span>

    public static void viewDomainRegistrationActivityForResult(Activity activity, @NonNull SiteModel site,
                                                               @NonNull DomainRegistrationPurpose purpose) {
<span class="nc" id="L749">        Intent intent = createDomainRegistrationActivityIntent(activity, site, purpose);</span>
<span class="nc" id="L750">        activity.startActivityForResult(intent, RequestCodes.DOMAIN_REGISTRATION);</span>
<span class="nc" id="L751">    }</span>

    public static void viewDomainRegistrationActivityForResult(Fragment fragment, @NonNull SiteModel site,
                                                               @NonNull DomainRegistrationPurpose purpose) {
<span class="nc" id="L755">        Intent intent = createDomainRegistrationActivityIntent(fragment.getContext(), site, purpose);</span>
<span class="nc" id="L756">        fragment.startActivityForResult(intent, RequestCodes.DOMAIN_REGISTRATION);</span>
<span class="nc" id="L757">    }</span>

    private static Intent createDomainRegistrationActivityIntent(Context context, @NonNull SiteModel site,
                                                                   @NonNull DomainRegistrationPurpose purpose) {
<span class="nc" id="L761">        Intent intent = new Intent(context, DomainRegistrationActivity.class);</span>
<span class="nc" id="L762">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L763">        intent.putExtra(DomainRegistrationActivity.DOMAIN_REGISTRATION_PURPOSE_KEY, purpose);</span>
<span class="nc" id="L764">        return intent;</span>
    }

    public static void viewActivityLogList(Activity activity, SiteModel site) {
<span class="nc bnc" id="L768" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L769">            ToastUtils.showToast(activity, R.string.blog_not_found, ToastUtils.Duration.SHORT);</span>
<span class="nc" id="L770">            return;</span>
        }
<span class="nc" id="L772">        AnalyticsUtils.trackWithSiteDetails(AnalyticsTracker.Stat.ACTIVITY_LOG_LIST_OPENED, site);</span>
<span class="nc" id="L773">        Intent intent = new Intent(activity, ActivityLogListActivity.class);</span>
<span class="nc" id="L774">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L775">        activity.startActivity(intent);</span>
<span class="nc" id="L776">    }</span>

    public static void viewBackupList(Activity activity, SiteModel site) {
<span class="nc bnc" id="L779" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L780">            ToastUtils.showToast(activity, R.string.blog_not_found, ToastUtils.Duration.SHORT);</span>
<span class="nc" id="L781">            return;</span>
        }
<span class="nc" id="L783">        AnalyticsUtils.trackWithSiteDetails(AnalyticsTracker.Stat.JETPACK_BACKUP_LIST_OPENED, site);</span>
<span class="nc" id="L784">        Intent intent = new Intent(activity, ActivityLogListActivity.class);</span>
<span class="nc" id="L785">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L786">        intent.putExtra(ACTIVITY_LOG_REWINDABLE_ONLY_KEY, true);</span>
<span class="nc" id="L787">        activity.startActivity(intent);</span>
<span class="nc" id="L788">    }</span>

    public static void viewActivityLogDetailForResult(
            Activity activity,
            SiteModel site,
            String activityId,
            boolean isButtonVisible,
            boolean isRestoreHidden,
            boolean rewindableOnly
    ) {
<span class="nc" id="L798">        Map&lt;String, Object&gt; properties = new HashMap&lt;&gt;();</span>
<span class="nc" id="L799">        properties.put(ACTIVITY_LOG_ACTIVITY_ID_KEY, activityId);</span>
        String source;
<span class="nc bnc" id="L801" title="All 2 branches missed.">        if (rewindableOnly) {</span>
<span class="nc" id="L802">            source = BACKUP_TRACK_EVENT_PROPERTY_VALUE;</span>
        } else {
<span class="nc" id="L804">            source = ACTIVITY_LOG_TRACK_EVENT_PROPERTY_VALUE;</span>
        }
<span class="nc" id="L806">        properties.put(SOURCE_TRACK_EVENT_PROPERTY_KEY, source);</span>
<span class="nc" id="L807">        AnalyticsUtils.trackWithSiteDetails(AnalyticsTracker.Stat.ACTIVITY_LOG_DETAIL_OPENED, site, properties);</span>

<span class="nc" id="L809">        Intent intent = new Intent(activity, ActivityLogDetailActivity.class);</span>
<span class="nc" id="L810">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L811">        intent.putExtra(ACTIVITY_LOG_ID_KEY, activityId);</span>
<span class="nc" id="L812">        intent.putExtra(ACTIVITY_LOG_ARE_BUTTONS_VISIBLE_KEY, isButtonVisible);</span>
<span class="nc" id="L813">        intent.putExtra(ACTIVITY_LOG_IS_RESTORE_HIDDEN_KEY, isRestoreHidden);</span>
<span class="nc" id="L814">        intent.putExtra(SOURCE_TRACK_EVENT_PROPERTY_KEY, source);</span>
<span class="nc" id="L815">        activity.startActivityForResult(intent, RequestCodes.ACTIVITY_LOG_DETAIL);</span>
<span class="nc" id="L816">    }</span>

    public static void viewScan(Activity activity, SiteModel site) {
<span class="nc bnc" id="L819" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L820">            ToastUtils.showToast(activity, R.string.blog_not_found, ToastUtils.Duration.SHORT);</span>
<span class="nc" id="L821">            return;</span>
        }
<span class="nc" id="L823">        AnalyticsTracker.track(Stat.JETPACK_SCAN_ACCESSED);</span>
<span class="nc" id="L824">        Intent intent = new Intent(activity, ScanActivity.class);</span>
<span class="nc" id="L825">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L826">        intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_SINGLE_TOP);</span>
<span class="nc" id="L827">        activity.startActivity(intent);</span>
<span class="nc" id="L828">    }</span>

    public static void viewScanRequestScanState(Activity activity, SiteModel site, @StringRes int messageRes) {
<span class="nc bnc" id="L831" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L832">            ToastUtils.showToast(activity, R.string.blog_not_found, ToastUtils.Duration.SHORT);</span>
<span class="nc" id="L833">            return;</span>
        }
<span class="nc" id="L835">        Intent intent = new Intent(activity, ScanActivity.class);</span>
<span class="nc" id="L836">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L837">        intent.putExtra(ScanActivity.REQUEST_SCAN_STATE, messageRes);</span>
<span class="nc" id="L838">        intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_SINGLE_TOP);</span>
<span class="nc" id="L839">        activity.startActivity(intent);</span>
<span class="nc" id="L840">    }</span>

    public static void viewScanRequestFixState(Activity activity, SiteModel site, long threatId) {
<span class="nc bnc" id="L843" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L844">            ToastUtils.showToast(activity, R.string.blog_not_found, ToastUtils.Duration.SHORT);</span>
<span class="nc" id="L845">            return;</span>
        }
<span class="nc" id="L847">        Intent intent = new Intent(activity, ScanActivity.class);</span>
<span class="nc" id="L848">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L849">        intent.putExtra(ScanActivity.REQUEST_FIX_STATE, threatId);</span>
<span class="nc" id="L850">        intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_SINGLE_TOP);</span>
<span class="nc" id="L851">        activity.startActivity(intent);</span>
<span class="nc" id="L852">    }</span>

    public static void viewScanHistory(Activity activity, SiteModel site) {
<span class="nc bnc" id="L855" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L856">            ToastUtils.showToast(activity, R.string.blog_not_found, ToastUtils.Duration.SHORT);</span>
<span class="nc" id="L857">            return;</span>
        }
<span class="nc" id="L859">        AnalyticsTracker.track(Stat.JETPACK_SCAN_HISTORY_ACCESSED);</span>
<span class="nc" id="L860">        Intent intent = new Intent(activity, ScanHistoryActivity.class);</span>
<span class="nc" id="L861">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L862">        activity.startActivity(intent);</span>
<span class="nc" id="L863">    }</span>

    public static void viewThreatDetails(@NonNull Fragment fragment, SiteModel site, @NonNull Long threatId) {
<span class="nc" id="L866">        Intent intent = new Intent(fragment.getContext(), ThreatDetailsActivity.class);</span>
<span class="nc" id="L867">        intent.putExtra(ARG_THREAT_ID, threatId);</span>
<span class="nc" id="L868">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L869">        fragment.startActivity(intent);</span>
<span class="nc" id="L870">    }</span>

    public static void viewBlogSettingsForResult(Activity activity, SiteModel site) {
<span class="nc" id="L873">        Intent intent = new Intent(activity, BlogPreferencesActivity.class);</span>
<span class="nc" id="L874">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L875">        activity.startActivityForResult(intent, RequestCodes.SITE_SETTINGS);</span>
<span class="nc" id="L876">        AnalyticsUtils.trackWithSiteDetails(AnalyticsTracker.Stat.OPENED_BLOG_SETTINGS, site);</span>
<span class="nc" id="L877">    }</span>

    public static void viewBlogSharing(Context context, SiteModel site) {
<span class="nc" id="L880">        Intent intent = new Intent(context, PublicizeListActivity.class);</span>
<span class="nc" id="L881">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L882">        context.startActivity(intent);</span>
<span class="nc" id="L883">        AnalyticsUtils.trackWithSiteDetails(Stat.OPENED_SHARING_MANAGEMENT, site);</span>
<span class="nc" id="L884">    }</span>

    public static void viewCurrentSite(Context context, SiteModel site, boolean openFromHeader) {
<span class="nc bnc" id="L887" title="All 2 branches missed.">        AnalyticsTracker.Stat stat = openFromHeader ? AnalyticsTracker.Stat.OPENED_VIEW_SITE_FROM_HEADER</span>
<span class="nc" id="L888">                : AnalyticsTracker.Stat.OPENED_VIEW_SITE;</span>
<span class="nc" id="L889">        AnalyticsUtils.trackWithSiteDetails(stat, site);</span>

<span class="nc bnc" id="L891" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L892">            ToastUtils.showToast(context, R.string.blog_not_found, ToastUtils.Duration.SHORT);</span>
<span class="nc bnc" id="L893" title="All 2 branches missed.">        } else if (site.getUrl() == null) {</span>
<span class="nc" id="L894">            ToastUtils.showToast(context, R.string.blog_not_found, ToastUtils.Duration.SHORT);</span>
<span class="nc" id="L895">            AppLog.w(AppLog.T.UTILS, &quot;Site URL is null. Login URL: &quot; + site.getLoginUrl());</span>
        } else {
<span class="nc" id="L897">            String siteUrl = site.getUrl();</span>
<span class="nc bnc" id="L898" title="All 2 branches missed.">            if (site.isWPCom()) {</span>
                // Show wp.com sites authenticated
<span class="nc" id="L900">                WPWebViewActivity.openUrlByUsingGlobalWPCOMCredentials(context, siteUrl, true);</span>
<span class="nc bnc" id="L901" title="All 4 branches missed.">            } else if (!TextUtils.isEmpty(site.getUsername()) &amp;&amp; !TextUtils.isEmpty(site.getPassword())) {</span>
                // Show self-hosted sites as authenticated since we should have the username &amp; password
<span class="nc" id="L903">                WPWebViewActivity</span>
<span class="nc" id="L904">                        .openUrlByUsingBlogCredentials(context, site, null, siteUrl, new String[]{}, false, true,</span>
                                false);
            } else {
                // Show non-wp.com sites without a password unauthenticated. These would be Jetpack sites that are
                // connected through REST API.
<span class="nc bnc" id="L909" title="All 2 branches missed.">                WPWebViewActivity.openURL(context, siteUrl, true, site.isPrivateWPComAtomic() ? site.getSiteId() : 0);</span>
            }
        }
<span class="nc" id="L912">    }</span>

    public static void viewBlogAdmin(Context context, SiteModel site) {
<span class="nc bnc" id="L915" title="All 4 branches missed.">        if (site == null || site.getAdminUrl() == null) {</span>
<span class="nc" id="L916">            ToastUtils.showToast(context, R.string.blog_not_found, ToastUtils.Duration.SHORT);</span>
<span class="nc" id="L917">            return;</span>
        }
<span class="nc" id="L919">        AnalyticsUtils.trackWithSiteDetails(AnalyticsTracker.Stat.OPENED_VIEW_ADMIN, site);</span>
<span class="nc" id="L920">        openUrlExternal(context, site.getAdminUrl());</span>
<span class="nc" id="L921">    }</span>

    public static void addNewPostForResult(
            Activity activity,
            SiteModel site,
            boolean isPromo,
            PagePostCreationSourcesDetail source,
            final int promptId,
            final EntryPoint entryPoint
    ) {
<span class="nc" id="L931">        addNewPostForResult(</span>
            new Intent(activity, EditPostActivity.class), activity, site, isPromo, source, promptId, entryPoint
        );
<span class="nc" id="L934">    }</span>

    public static void addNewPostForResult(
            Intent intent,
            Activity activity,
            SiteModel site,
            boolean isPromo,
            PagePostCreationSourcesDetail source,
            final int promptId,
            final EntryPoint entryPoint
    ) {
<span class="nc bnc" id="L945" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L946">            return;</span>
        }

<span class="nc" id="L949">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L950">        intent.putExtra(EditPostActivity.EXTRA_IS_PAGE, false);</span>
<span class="nc" id="L951">        intent.putExtra(EditPostActivity.EXTRA_IS_PROMO, isPromo);</span>
<span class="nc" id="L952">        intent.putExtra(AnalyticsUtils.EXTRA_CREATION_SOURCE_DETAIL, source);</span>
<span class="nc" id="L953">        intent.putExtra(EditPostActivity.EXTRA_PROMPT_ID, promptId);</span>
<span class="nc" id="L954">        intent.putExtra(EditPostActivity.EXTRA_ENTRY_POINT, entryPoint);</span>
<span class="nc" id="L955">        activity.startActivityForResult(intent, RequestCodes.EDIT_POST);</span>
<span class="nc" id="L956">    }</span>

    public static void addNewStoryForResult(
            Activity activity,
            SiteModel site,
            PagePostCreationSourcesDetail source
    ) {
<span class="nc bnc" id="L963" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L964">            return;</span>
        }

<span class="nc" id="L967">        Intent intent = new Intent(activity, StoryComposerActivity.class);</span>
<span class="nc" id="L968">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L969">        intent.putExtra(AnalyticsUtils.EXTRA_CREATION_SOURCE_DETAIL, source);</span>
<span class="nc" id="L970">        intent.putExtra(MediaPickerConstants.EXTRA_LAUNCH_WPSTORIES_CAMERA_REQUESTED, true);</span>
<span class="nc" id="L971">        activity.startActivityForResult(intent, RequestCodes.CREATE_STORY);</span>
<span class="nc" id="L972">    }</span>

    public static void addNewStoryWithMediaIdsForResult(
            Activity activity,
            SiteModel site,
            PagePostCreationSourcesDetail source,
            long[] mediaIds
    ) {
<span class="nc bnc" id="L980" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L981">            return;</span>
        }

<span class="nc" id="L984">        Intent intent = new Intent(activity, StoryComposerActivity.class);</span>
<span class="nc" id="L985">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L986">        intent.putExtra(MediaBrowserActivity.RESULT_IDS, mediaIds);</span>
<span class="nc" id="L987">        intent.putExtra(AnalyticsUtils.EXTRA_CREATION_SOURCE_DETAIL, source);</span>
<span class="nc" id="L988">        activity.startActivityForResult(intent, RequestCodes.CREATE_STORY);</span>
<span class="nc" id="L989">    }</span>

    public static void addNewStoryWithMediaUrisForResult(
            Activity activity,
            SiteModel site,
            PagePostCreationSourcesDetail source,
            String[] mediaUris
    ) {
<span class="nc bnc" id="L997" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L998">            return;</span>
        }

<span class="nc" id="L1001">            Intent intent = new Intent(activity, StoryComposerActivity.class);</span>
<span class="nc" id="L1002">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L1003">        intent.putExtra(MediaPickerConstants.EXTRA_MEDIA_URIS, mediaUris);</span>
<span class="nc" id="L1004">        intent.putExtra(AnalyticsUtils.EXTRA_CREATION_SOURCE_DETAIL, source);</span>
<span class="nc" id="L1005">        activity.startActivityForResult(intent, RequestCodes.CREATE_STORY);</span>
<span class="nc" id="L1006">    }</span>

    public static void editStoryWithMediaIdsForResult(
            Activity activity,
            SiteModel site,
            long[] mediaIds,
            boolean launchingFromGutenberg
    ) {
<span class="nc bnc" id="L1014" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L1015">            return;</span>
        }

<span class="nc" id="L1018">        Intent intent = new Intent(activity, StoryComposerActivity.class);</span>
<span class="nc" id="L1019">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L1020">        intent.putExtra(MediaBrowserActivity.RESULT_IDS, mediaIds);</span>
<span class="nc" id="L1021">        activity.startActivityForResult(intent, RequestCodes.EDIT_STORY);</span>
<span class="nc" id="L1022">    }</span>

    public static void editStoryForResult(
            Activity activity,
            SiteModel site,
            LocalId localPostId,
            int storyIndex,
            boolean allStorySlidesAreEditable,
            boolean launchedFromGutenberg,
            String storyBlockId
    ) {
<span class="nc bnc" id="L1033" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L1034">            return;</span>
        }

<span class="nc" id="L1037">        Intent intent = new Intent(activity, StoryComposerActivity.class);</span>
<span class="nc" id="L1038">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L1039">        intent.putExtra(KEY_POST_LOCAL_ID, localPostId.getValue());</span>
<span class="nc" id="L1040">        intent.putExtra(KEY_STORY_INDEX, storyIndex);</span>
<span class="nc" id="L1041">        intent.putExtra(KEY_LAUNCHED_FROM_GUTENBERG, launchedFromGutenberg);</span>
<span class="nc" id="L1042">        intent.putExtra(KEY_ALL_UNFLATTENED_LOADED_SLIDES, allStorySlidesAreEditable);</span>
<span class="nc" id="L1043">        intent.putExtra(ARG_STORY_BLOCK_ID, storyBlockId);</span>
<span class="nc" id="L1044">        activity.startActivityForResult(intent, RequestCodes.EDIT_STORY);</span>
<span class="nc" id="L1045">    }</span>

    public static void editEmptyStoryForResult(
            Activity activity,
            SiteModel site,
            LocalId localPostId,
            int storyIndex,
            String storyBlockId
    ) {
<span class="nc bnc" id="L1054" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L1055">            return;</span>
        }

<span class="nc" id="L1058">        AnalyticsTracker.track(Stat.STORY_BLOCK_ADD_MEDIA_TAPPED);</span>
<span class="nc" id="L1059">        Intent intent = new Intent(activity, StoryComposerActivity.class);</span>
<span class="nc" id="L1060">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L1061">        intent.putExtra(KEY_LAUNCHED_FROM_GUTENBERG, true);</span>
<span class="nc" id="L1062">        intent.putExtra(MediaPickerConstants.EXTRA_LAUNCH_WPSTORIES_MEDIA_PICKER_REQUESTED, true);</span>
<span class="nc" id="L1063">        intent.putExtra(KEY_POST_LOCAL_ID, localPostId.getValue());</span>
<span class="nc" id="L1064">        intent.putExtra(KEY_STORY_INDEX, storyIndex);</span>
<span class="nc" id="L1065">        intent.putExtra(ARG_STORY_BLOCK_ID, storyBlockId);</span>
<span class="nc" id="L1066">        activity.startActivityForResult(intent, RequestCodes.EDIT_STORY);</span>
<span class="nc" id="L1067">    }</span>

    public static void editPostOrPageForResult(Activity activity, SiteModel site, PostModel post) {
<span class="nc" id="L1070">        editPostOrPageForResult(new Intent(activity, EditPostActivity.class), activity, site, post.getId(), false);</span>
<span class="nc" id="L1071">    }</span>

    public static void editPostOrPageForResult(Activity activity, SiteModel site, PostModel post,
                                               boolean loadAutoSaveRevision) {
<span class="nc" id="L1075">        editPostOrPageForResult(new Intent(activity, EditPostActivity.class), activity, site, post.getId(),</span>
                loadAutoSaveRevision);
<span class="nc" id="L1077">    }</span>

    public static void editPostOrPageForResult(Intent intent, Activity activity, SiteModel site, int postLocalId) {
<span class="nc" id="L1080">        editPostOrPageForResult(intent, activity, site, postLocalId, false);</span>
<span class="nc" id="L1081">    }</span>

    public static void editPostOrPageForResult(Intent intent, Activity activity, SiteModel site, int postLocalId,
                                               boolean loadAutoSaveRevision) {
<span class="nc bnc" id="L1085" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L1086">            return;</span>
        }

<span class="nc" id="L1089">        intent.putExtra(WordPress.SITE, site);</span>
        // PostModel objects can be quite large, since content field is not size restricted,
        // in order to avoid issues like TransactionTooLargeException it's better to pass the id of the post.
        // However, we still want to keep passing the SiteModel to avoid confusion around local &amp; remote ids.
<span class="nc" id="L1093">        intent.putExtra(EditPostActivity.EXTRA_POST_LOCAL_ID, postLocalId);</span>
<span class="nc" id="L1094">        intent.putExtra(EditPostActivity.EXTRA_LOAD_AUTO_SAVE_REVISION, loadAutoSaveRevision);</span>

<span class="nc" id="L1096">        activity.startActivityForResult(intent, RequestCodes.EDIT_POST);</span>
<span class="nc" id="L1097">    }</span>

    public static void editPageForResult(@NonNull Fragment fragment, @NonNull SiteModel site,
                                         int pageLocalId, boolean loadAutoSaveRevision) {
<span class="nc" id="L1101">        Intent intent = new Intent(fragment.getContext(), EditPostActivity.class);</span>
<span class="nc" id="L1102">        editPageForResult(intent, fragment, site, pageLocalId, loadAutoSaveRevision, RequestCodes.EDIT_POST);</span>
<span class="nc" id="L1103">    }</span>

    public static void editPageForResult(Intent intent, @NonNull Fragment fragment, @NonNull SiteModel site,
                                         int pageLocalId, boolean loadAutoSaveRevision) {
<span class="nc" id="L1107">        editPageForResult(intent, fragment, site, pageLocalId, loadAutoSaveRevision, RequestCodes.EDIT_POST);</span>
<span class="nc" id="L1108">    }</span>

    public static void editLandingPageForResult(@NonNull Fragment fragment, @NonNull SiteModel site, int homeLocalId,
                                                boolean isNewSite) {
<span class="nc" id="L1112">        Intent intent = new Intent(fragment.getContext(), EditPostActivity.class);</span>
<span class="nc" id="L1113">        intent.putExtra(EditPostActivity.EXTRA_IS_LANDING_EDITOR, true);</span>
<span class="nc" id="L1114">        intent.putExtra(EditPostActivity.EXTRA_IS_LANDING_EDITOR_OPENED_FOR_NEW_SITE, isNewSite);</span>
<span class="nc" id="L1115">        editPageForResult(intent, fragment, site, homeLocalId, false, RequestCodes.EDIT_LANDING_PAGE);</span>
<span class="nc" id="L1116">    }</span>

    public static void editPageForResult(Intent intent, @NonNull Fragment fragment, @NonNull SiteModel site,
                                         int pageLocalId, boolean loadAutoSaveRevision, int requestCode) {
<span class="nc" id="L1120">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L1121">        intent.putExtra(EditPostActivity.EXTRA_POST_LOCAL_ID, pageLocalId);</span>
<span class="nc" id="L1122">        intent.putExtra(EditPostActivity.EXTRA_LOAD_AUTO_SAVE_REVISION, loadAutoSaveRevision);</span>
<span class="nc" id="L1123">        fragment.startActivityForResult(intent, requestCode);</span>
<span class="nc" id="L1124">    }</span>

    public static void addNewPageForResult(
            @NonNull Activity activity,
            @NonNull SiteModel site,
            @NonNull String title,
            @NonNull String content,
            @Nullable String template,
            @NonNull PagePostCreationSourcesDetail source
    ) {
<span class="nc" id="L1134">        Intent intent = new Intent(activity, EditPostActivity.class);</span>
<span class="nc" id="L1135">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L1136">        intent.putExtra(EditPostActivity.EXTRA_IS_PAGE, true);</span>
<span class="nc" id="L1137">        intent.putExtra(EditPostActivity.EXTRA_IS_PROMO, false);</span>
<span class="nc" id="L1138">        intent.putExtra(EditPostActivity.EXTRA_PAGE_TITLE, title);</span>
<span class="nc" id="L1139">        intent.putExtra(EditPostActivity.EXTRA_PAGE_CONTENT, content);</span>
<span class="nc" id="L1140">        intent.putExtra(EditPostActivity.EXTRA_PAGE_TEMPLATE, template);</span>
<span class="nc" id="L1141">        intent.putExtra(AnalyticsUtils.EXTRA_CREATION_SOURCE_DETAIL, source);</span>
<span class="nc" id="L1142">        activity.startActivityForResult(intent, RequestCodes.EDIT_POST);</span>
<span class="nc" id="L1143">    }</span>

    public static void addNewPageForResult(
            @NonNull Fragment fragment,
            @NonNull SiteModel site,
            @NonNull String title,
            @NonNull String content,
            @Nullable String template,
            @NonNull PagePostCreationSourcesDetail source) {
<span class="nc" id="L1152">        Intent intent = new Intent(fragment.getContext(), EditPostActivity.class);</span>
<span class="nc" id="L1153">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L1154">        intent.putExtra(EditPostActivity.EXTRA_IS_PAGE, true);</span>
<span class="nc" id="L1155">        intent.putExtra(EditPostActivity.EXTRA_IS_PROMO, false);</span>
<span class="nc" id="L1156">        intent.putExtra(EditPostActivity.EXTRA_PAGE_TITLE, title);</span>
<span class="nc" id="L1157">        intent.putExtra(EditPostActivity.EXTRA_PAGE_CONTENT, content);</span>
<span class="nc" id="L1158">        intent.putExtra(EditPostActivity.EXTRA_PAGE_TEMPLATE, template);</span>
<span class="nc" id="L1159">        intent.putExtra(AnalyticsUtils.EXTRA_CREATION_SOURCE_DETAIL, source);</span>
<span class="nc" id="L1160">        fragment.startActivityForResult(intent, RequestCodes.EDIT_POST);</span>
<span class="nc" id="L1161">    }</span>

    public static void viewHistoryDetailForResult(@NonNull final Activity activity, @NonNull final Revision revision,
                                                  @NonNull final long[] previousRevisionsIds, final long postId,
                                                  final long siteId) {
<span class="nc" id="L1166">        Intent intent = new Intent(activity, HistoryDetailActivity.class);</span>
<span class="nc" id="L1167">        intent.putExtra(HistoryDetailContainerFragment.EXTRA_CURRENT_REVISION, revision);</span>
<span class="nc" id="L1168">        final Bundle extras = new Bundle();</span>
<span class="nc" id="L1169">        extras.putLongArray(HistoryDetailContainerFragment.EXTRA_PREVIOUS_REVISIONS_IDS, previousRevisionsIds);</span>
<span class="nc" id="L1170">        extras.putLong(HistoryDetailContainerFragment.EXTRA_POST_ID, postId);</span>
<span class="nc" id="L1171">        extras.putLong(HistoryDetailContainerFragment.EXTRA_SITE_ID, siteId);</span>
<span class="nc" id="L1172">        intent.putExtras(extras);</span>
<span class="nc" id="L1173">        activity.startActivityForResult(intent, RequestCodes.HISTORY_DETAIL);</span>
<span class="nc" id="L1174">    }</span>

    /*
     * Load the post preview as an authenticated URL so stats aren't bumped
     */
    public static void browsePostOrPage(Context context, SiteModel site, PostImmutableModel post) {
<span class="nc" id="L1180">        browsePostOrPageEx(context, site, post, RemotePreviewType.NOT_A_REMOTE_PREVIEW);</span>
<span class="nc" id="L1181">    }</span>

    public static void previewPostOrPageForResult(
            Activity activity,
            SiteModel site,
            PostImmutableModel post,
            RemotePreviewType remotePreviewType
    ) {
<span class="nc" id="L1189">        browsePostOrPageEx(activity, site, post, remotePreviewType);</span>
<span class="nc" id="L1190">    }</span>

    private static void browsePostOrPageEx(
            Context context,
            SiteModel site,
            PostImmutableModel post,
            RemotePreviewType remotePreviewType) {
<span class="nc bnc" id="L1197" title="All 6 branches missed.">        if (site == null || post == null || TextUtils.isEmpty(post.getLink())) {</span>
<span class="nc" id="L1198">            return;</span>
        }

<span class="nc bnc" id="L1201" title="All 2 branches missed.">        if (remotePreviewType == RemotePreviewType.REMOTE_PREVIEW_WITH_REMOTE_AUTO_SAVE</span>
<span class="nc bnc" id="L1202" title="All 2 branches missed.">                        &amp;&amp; TextUtils.isEmpty(post.getAutoSavePreviewUrl())) {</span>
<span class="nc" id="L1203">            return;</span>
        }

<span class="nc" id="L1206">        String url = PostUtils.getPreviewUrlForPost(remotePreviewType, post);</span>

<span class="nc" id="L1208">        String shareableUrl = post.getLink();</span>
<span class="nc" id="L1209">        String shareSubject = post.getTitle();</span>
<span class="nc bnc" id="L1210" title="All 2 branches missed.">        boolean startPreviewForResult = remotePreviewType != RemotePreviewType.NOT_A_REMOTE_PREVIEW;</span>

<span class="nc bnc" id="L1212" title="All 2 branches missed.">        if (site.isWPCom()) {</span>
<span class="nc" id="L1213">            WPWebViewActivity.openPostUrlByUsingGlobalWPCOMCredentials(</span>
                    context,
                    url,
                    shareableUrl,
                    shareSubject,
                    true,
                    startPreviewForResult);
<span class="nc bnc" id="L1220" title="All 4 branches missed.">        } else if (site.isWPComAtomic() &amp;&amp; !site.isPrivateWPComAtomic()) {</span>
<span class="nc" id="L1221">            openAtomicBlogPostPreview(</span>
                    context,
                    url,
<span class="nc" id="L1224">                    site.getLoginUrl(),</span>
<span class="nc" id="L1225">                    site.getFrameNonce());</span>
<span class="nc bnc" id="L1226" title="All 4 branches missed.">        } else if (site.isJetpackConnected() &amp;&amp; site.isUsingWpComRestApi()) {</span>
<span class="nc" id="L1227">            WPWebViewActivity</span>
<span class="nc" id="L1228">                    .openJetpackBlogPostPreview(</span>
                            context,
                            url,
                            shareableUrl,
                            shareSubject,
<span class="nc" id="L1233">                            site.getFrameNonce(),</span>
                            true,
                            startPreviewForResult,
<span class="nc bnc" id="L1236" title="All 2 branches missed.">                            site.isPrivateWPComAtomic() ? site.getSiteId() : 0);</span>
        } else {
            // Add the original post URL to the list of allowed URLs.
            // This is necessary because links are disabled in the webview, but WP removes &quot;?preview=true&quot;
            // from the passed URL, and internally redirects to it. EX:Published posts on a site with Plain
            // permalink structure settings.
            // Ref: https://github.com/wordpress-mobile/WordPress-Android/issues/4873
<span class="nc" id="L1243">            WPWebViewActivity.openUrlByUsingBlogCredentials(</span>
                    context,
                    site,
                    post,
                    url,
<span class="nc" id="L1248">                    new String[]{post.getLink()},</span>
                    true,
                    true,
                    startPreviewForResult);
        }
<span class="nc" id="L1253">    }</span>

    private static void openAtomicBlogPostPreview(Context context, String url, String authenticationUrl,
                                                 String frameNonce) {
        try {
<span class="nc" id="L1258">            Intent intent = new Intent(Intent.ACTION_VIEW);</span>
<span class="nc" id="L1259">            intent.setData(Uri.parse(authenticationUrl + &quot;?redirect_to=&quot; + URLEncoder</span>
<span class="nc" id="L1260">                    .encode(url + &quot;&amp;frame-nonce=&quot; + UrlUtils.urlEncode(frameNonce), ENCODING_UTF8)));</span>
<span class="nc" id="L1261">            context.startActivity(intent);</span>
<span class="nc" id="L1262">        } catch (UnsupportedEncodingException e) {</span>
<span class="nc" id="L1263">            e.printStackTrace();</span>
<span class="nc" id="L1264">        }</span>
<span class="nc" id="L1265">    }</span>

    public static void showActionableEmptyView(
            Context context,
            WPWebViewUsageCategory actionableState,
            String postTitle
    ) {
<span class="nc" id="L1272">        WPWebViewActivity.openActionableEmptyViewDirectly(context, actionableState, postTitle);</span>
<span class="nc" id="L1273">    }</span>

    public static void viewMyProfile(Context context) {
<span class="nc" id="L1276">        Intent intent = new Intent(context, MyProfileActivity.class);</span>
<span class="nc" id="L1277">        AnalyticsTracker.track(AnalyticsTracker.Stat.OPENED_MY_PROFILE);</span>
<span class="nc" id="L1278">        context.startActivity(intent);</span>
<span class="nc" id="L1279">    }</span>

    public static void viewMeActivityForResult(Activity activity) {
<span class="nc" id="L1282">        Intent intent = new Intent(activity, MeActivity.class);</span>
<span class="nc" id="L1283">        AnalyticsTracker.track(AnalyticsTracker.Stat.ME_ACCESSED);</span>
<span class="nc" id="L1284">        activity.startActivityForResult(intent, RequestCodes.APP_SETTINGS);</span>
<span class="nc" id="L1285">    }</span>

    public static void viewPostLikesListActivity(
            Activity activity,
            long siteId,
            long postId,
            HeaderData headerData,
            EngagementNavigationSource source
    ) {
<span class="nc" id="L1294">        Intent intent = new Intent(activity, EngagedPeopleListActivity.class);</span>
<span class="nc" id="L1295">        intent.putExtra(</span>
                EngagedPeopleListActivity.KEY_LIST_SCENARIO,
                new ListScenario(
                        ListScenarioType.LOAD_POST_LIKES,
                        source,
                        siteId,
                        postId,
                        0L,
                        &quot;&quot;,
                        headerData
                )
        );
<span class="nc" id="L1307">        activity.startActivity(intent);</span>
<span class="nc" id="L1308">    }</span>

    public static void viewAccountSettings(Context context) {
<span class="nc" id="L1311">        Intent intent = new Intent(context, AccountSettingsActivity.class);</span>
<span class="nc" id="L1312">        AnalyticsTracker.track(AnalyticsTracker.Stat.OPENED_ACCOUNT_SETTINGS);</span>
<span class="nc" id="L1313">        context.startActivity(intent);</span>
<span class="nc" id="L1314">    }</span>

    public static void viewAppSettingsForResult(Activity activity) {
<span class="nc" id="L1317">        Intent intent = new Intent(activity, AppSettingsActivity.class);</span>
<span class="nc" id="L1318">        AnalyticsTracker.track(AnalyticsTracker.Stat.OPENED_APP_SETTINGS);</span>
<span class="nc" id="L1319">        activity.startActivityForResult(intent, RequestCodes.APP_SETTINGS);</span>
<span class="nc" id="L1320">    }</span>

    public static void viewNotificationsSettings(Activity activity) {
<span class="nc" id="L1323">        Intent intent = new Intent(activity, NotificationsSettingsActivity.class);</span>
<span class="nc" id="L1324">        activity.startActivity(intent);</span>
<span class="nc" id="L1325">    }</span>

    public static void viewJetpackSecuritySettings(Activity activity, SiteModel site) {
<span class="nc" id="L1328">        AnalyticsTracker.track(Stat.SITE_SETTINGS_JETPACK_SECURITY_SETTINGS_VIEWED);</span>
<span class="nc" id="L1329">        Intent intent = new Intent(activity, JetpackSecuritySettingsActivity.class);</span>
<span class="nc" id="L1330">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L1331">        activity.startActivity(intent);</span>
<span class="nc" id="L1332">    }</span>

    public static void viewStories(Activity activity, SiteModel site, StorySaveResult event) {
<span class="nc" id="L1335">        Intent intent = new Intent(activity, StoryComposerActivity.class);</span>
<span class="nc" id="L1336">        intent.putExtra(KEY_STORY_SAVE_RESULT, event);</span>
<span class="nc" id="L1337">        intent.putExtra(WordPress.SITE, site);</span>

        // we need to have a way to cancel the related error notification when the user comes
        // from tapping on MANAGE on the snackbar (otherwise they'll be able to discard the
        // errored story but the error notification will remain existing in the system dashboard)
<span class="nc" id="L1342">        intent.setAction(String.valueOf(FrameSaveNotifier.getNotificationIdForError(</span>
                StoryComposerActivity.BASE_FRAME_MEDIA_ERROR_NOTIFICATION_ID,
<span class="nc" id="L1344">                event.getStoryIndex()</span>
        )));

<span class="nc" id="L1347">        activity.startActivity(intent);</span>
<span class="nc" id="L1348">    }</span>

    public static void viewJetpackSecuritySettingsForResult(Activity activity, SiteModel site) {
<span class="nc" id="L1351">        AnalyticsTracker.track(Stat.SITE_SETTINGS_JETPACK_SECURITY_SETTINGS_VIEWED);</span>
<span class="nc" id="L1352">        Intent intent = new Intent(activity, JetpackSecuritySettingsActivity.class);</span>
<span class="nc" id="L1353">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L1354">        activity.startActivityForResult(intent, JetpackSecuritySettingsActivity.JETPACK_SECURITY_SETTINGS_REQUEST_CODE);</span>
<span class="nc" id="L1355">    }</span>

    public static void viewHelpAndSupportInNewStack(@NonNull Context context, @NonNull Origin origin,
                                          @Nullable SiteModel selectedSite, @Nullable List&lt;String&gt; extraSupportTags) {
<span class="nc" id="L1359">        Map&lt;String, String&gt; properties = new HashMap&lt;&gt;();</span>
<span class="nc" id="L1360">        properties.put(&quot;origin&quot;, origin.name());</span>
<span class="nc" id="L1361">        AnalyticsTracker.track(Stat.SUPPORT_OPENED, properties);</span>

<span class="nc" id="L1363">        TaskStackBuilder taskStackBuilder = TaskStackBuilder.create(context);</span>
<span class="nc" id="L1364">        Intent mainActivityIntent = getMainActivityInNewStack(context);</span>
<span class="nc" id="L1365">        mainActivityIntent.addFlags(Intent.FLAG_ACTIVITY_NO_ANIMATION);</span>
<span class="nc" id="L1366">        Intent meIntent = new Intent(context, MeActivity.class);</span>
<span class="nc" id="L1367">        meIntent.addFlags(Intent.FLAG_ACTIVITY_NO_ANIMATION);</span>
<span class="nc" id="L1368">        Intent helpIntent = HelpActivity.createIntent(context, origin, selectedSite, extraSupportTags);</span>

<span class="nc" id="L1370">        taskStackBuilder.addNextIntent(mainActivityIntent);</span>
<span class="nc" id="L1371">        taskStackBuilder.addNextIntent(meIntent);</span>
<span class="nc" id="L1372">        taskStackBuilder.addNextIntent(helpIntent);</span>
<span class="nc" id="L1373">        taskStackBuilder.startActivities();</span>
<span class="nc" id="L1374">    }</span>

    public static void viewHelpAndSupport(@NonNull Context context, @NonNull Origin origin,
                                          @Nullable SiteModel selectedSite, @Nullable List&lt;String&gt; extraSupportTags) {
<span class="nc" id="L1378">        Map&lt;String, String&gt; properties = new HashMap&lt;&gt;();</span>
<span class="nc" id="L1379">        properties.put(&quot;origin&quot;, origin.name());</span>
<span class="nc" id="L1380">        AnalyticsTracker.track(Stat.SUPPORT_OPENED, properties);</span>
<span class="nc" id="L1381">        context.startActivity(HelpActivity.createIntent(context, origin, selectedSite, extraSupportTags));</span>
<span class="nc" id="L1382">    }</span>

    public static void viewZendeskTickets(@NonNull Context context,
                                          @Nullable SiteModel selectedSite) {
<span class="nc" id="L1386">        viewHelpAndSupportInNewStack(context, Origin.ZENDESK_NOTIFICATION, selectedSite, null);</span>
<span class="nc" id="L1387">    }</span>

    public static void viewSSLCerts(Context context, String certificateString) {
<span class="nc" id="L1390">        Intent intent = new Intent(context, SSLCertsViewActivity.class);</span>
<span class="nc" id="L1391">        intent.putExtra(SSLCertsViewActivity.CERT_DETAILS_KEYS, certificateString.replaceAll(&quot;\n&quot;, &quot;&lt;br/&gt;&quot;));</span>
<span class="nc" id="L1392">        context.startActivity(intent);</span>
<span class="nc" id="L1393">    }</span>

    public static void newBlogForResult(Activity activity, SiteCreationSource source) {
<span class="nc" id="L1396">        Intent intent = new Intent(activity, SiteCreationActivity.class);</span>
<span class="nc" id="L1397">        intent.putExtra(SiteCreationActivity.ARG_CREATE_SITE_SOURCE, source.getLabel());</span>
<span class="nc" id="L1398">        activity.startActivityForResult(intent, RequestCodes.CREATE_SITE);</span>
<span class="nc" id="L1399">    }</span>

    public static void showMainActivityAndSiteCreationActivity(Activity activity, SiteCreationSource source) {
        // If we just wanted to have WPMainActivity in the back stack after starting SiteCreationActivity, we could have
        // used a TaskStackBuilder to do so. However, since we want to handle the SiteCreationActivity result in
        // WPMainActivity, we must start it this way.
<span class="nc" id="L1405">        final Intent intent = createMainActivityAndSiteCreationActivityIntent(activity, null, source);</span>
<span class="nc" id="L1406">        activity.startActivity(intent);</span>
<span class="nc" id="L1407">    }</span>

    @NonNull
    public static Intent createMainActivityAndSiteCreationActivityIntent(Context context,
                                                                         @Nullable NotificationType notificationType,
                                                                         SiteCreationSource source) {
<span class="nc" id="L1413">        final Intent intent = new Intent(context, WPMainActivity.class);</span>
<span class="nc" id="L1414">        intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);</span>
<span class="nc" id="L1415">        intent.addFlags(Intent.FLAG_ACTIVITY_NO_ANIMATION);</span>
<span class="nc" id="L1416">        intent.putExtra(WPMainActivity.ARG_SHOW_SITE_CREATION, true);</span>
<span class="nc" id="L1417">        intent.putExtra(WPMainActivity.ARG_SITE_CREATION_SOURCE, source.getLabel());</span>
<span class="nc bnc" id="L1418" title="All 2 branches missed.">        if (notificationType != null) {</span>
<span class="nc" id="L1419">            intent.putExtra(ARG_NOTIFICATION_TYPE, notificationType);</span>
        }
<span class="nc" id="L1421">        return intent;</span>
    }

    @NonNull
    public static Intent createMainActivityAndShowBloggingPromptsOnboardingActivityIntent(
            final Context context,
            @Nullable final NotificationType notificationType,
            final int notificationId
    ) {
<span class="nc" id="L1430">        final Intent intent = new Intent(context, WPMainActivity.class);</span>
<span class="nc" id="L1431">        intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);</span>
<span class="nc" id="L1432">        intent.addFlags(Intent.FLAG_ACTIVITY_NO_ANIMATION);</span>
<span class="nc" id="L1433">        intent.putExtra(WPMainActivity.ARG_BLOGGING_PROMPTS_ONBOARDING, true);</span>
<span class="nc" id="L1434">        intent.putExtra(WPMainActivity.ARG_DISMISS_NOTIFICATION, notificationId);</span>
<span class="nc bnc" id="L1435" title="All 2 branches missed.">        if (notificationType != null) {</span>
<span class="nc" id="L1436">            intent.putExtra(ARG_NOTIFICATION_TYPE, notificationType);</span>
        }
<span class="nc" id="L1438">        return intent;</span>
    }

    public static void showSignInForResult(Activity activity) {
<span class="nc" id="L1442">        showSignInForResult(activity, false);</span>
<span class="nc" id="L1443">    }</span>

    public static void showSignInForResult(Activity activity, boolean clearTop) {
<span class="nc" id="L1446">        Intent intent = new Intent(activity, LoginActivity.class);</span>
<span class="nc bnc" id="L1447" title="All 2 branches missed.">        if (clearTop) {</span>
<span class="nc" id="L1448">            intent.setFlags(</span>
                    Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);
        }
<span class="nc" id="L1451">        activity.startActivityForResult(intent, RequestCodes.ADD_ACCOUNT);</span>
<span class="nc" id="L1452">    }</span>

    public static void showSignInForResultWpComOnly(Activity activity) {
<span class="nc" id="L1455">        Intent intent = new Intent(activity, LoginActivity.class);</span>
<span class="nc" id="L1456">        WPCOM_LOGIN_ONLY.putInto(intent);</span>
<span class="nc" id="L1457">        activity.startActivityForResult(intent, RequestCodes.ADD_ACCOUNT);</span>
<span class="nc" id="L1458">    }</span>

    public static void showSignInForResultJetpackOnly(Activity activity) {
<span class="nc" id="L1461">        Intent intent = new Intent(activity, LoginActivity.class);</span>
<span class="nc" id="L1462">        intent.setFlags(</span>
                Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK);
<span class="nc" id="L1464">        JETPACK_LOGIN_ONLY.putInto(intent);</span>
<span class="nc" id="L1465">        activity.startActivityForResult(intent, RequestCodes.ADD_ACCOUNT);</span>
<span class="nc" id="L1466">    }</span>

    public static void showLoginEpilogue(
            Activity activity,
            boolean doLoginUpdate,
            ArrayList&lt;Integer&gt; oldSitesIds,
            boolean isSiteCreationEnabled
    ) {
<span class="nc" id="L1474">        Intent intent = new Intent(activity, LoginEpilogueActivity.class);</span>
<span class="nc" id="L1475">        intent.putExtra(LoginEpilogueActivity.EXTRA_DO_LOGIN_UPDATE, doLoginUpdate);</span>
<span class="nc" id="L1476">        intent.putIntegerArrayListExtra(LoginEpilogueActivity.ARG_OLD_SITES_IDS, oldSitesIds);</span>
<span class="nc bnc" id="L1477" title="All 2 branches missed.">        if (isSiteCreationEnabled) {</span>
<span class="nc" id="L1478">            activity.startActivityForResult(intent, RequestCodes.LOGIN_EPILOGUE);</span>
        } else {
<span class="nc" id="L1480">            activity.startActivity(intent);</span>
        }
<span class="nc" id="L1482">    }</span>

    public static void showLoginEpilogueForResult(Activity activity,
                                                  ArrayList&lt;Integer&gt; oldSitesIds, boolean doLoginUpdate) {
<span class="nc" id="L1486">        Intent intent = new Intent(activity, LoginEpilogueActivity.class);</span>
<span class="nc" id="L1487">        intent.putExtra(LoginEpilogueActivity.EXTRA_DO_LOGIN_UPDATE, doLoginUpdate);</span>
<span class="nc" id="L1488">        intent.putExtra(LoginEpilogueActivity.EXTRA_SHOW_AND_RETURN, true);</span>
<span class="nc" id="L1489">        intent.putIntegerArrayListExtra(LoginEpilogueActivity.ARG_OLD_SITES_IDS, oldSitesIds);</span>
<span class="nc" id="L1490">        activity.startActivityForResult(intent, RequestCodes.SHOW_LOGIN_EPILOGUE_AND_RETURN);</span>
<span class="nc" id="L1491">    }</span>

    public static void showSignupEpilogue(Activity activity, String name, String email, String photoUrl,
                                          String username, boolean isEmail) {
<span class="nc" id="L1495">        Intent intent = new Intent(activity, SignupEpilogueActivity.class);</span>
<span class="nc" id="L1496">        intent.putExtra(SignupEpilogueActivity.EXTRA_SIGNUP_DISPLAY_NAME, name);</span>
<span class="nc" id="L1497">        intent.putExtra(SignupEpilogueActivity.EXTRA_SIGNUP_EMAIL_ADDRESS, email);</span>
<span class="nc" id="L1498">        intent.putExtra(SignupEpilogueActivity.EXTRA_SIGNUP_PHOTO_URL, photoUrl);</span>
<span class="nc" id="L1499">        intent.putExtra(SignupEpilogueActivity.EXTRA_SIGNUP_USERNAME, username);</span>
<span class="nc" id="L1500">        intent.putExtra(SignupEpilogueActivity.EXTRA_SIGNUP_IS_EMAIL, isEmail);</span>
<span class="nc" id="L1501">        activity.startActivity(intent);</span>
<span class="nc" id="L1502">    }</span>

    public static void showSignupEpilogueForResult(Activity activity, String name, String email, String photoUrl,
                                                   String username, boolean isEmail) {
<span class="nc" id="L1506">        Intent intent = new Intent(activity, SignupEpilogueActivity.class);</span>
<span class="nc" id="L1507">        intent.putExtra(SignupEpilogueActivity.EXTRA_SIGNUP_DISPLAY_NAME, name);</span>
<span class="nc" id="L1508">        intent.putExtra(SignupEpilogueActivity.EXTRA_SIGNUP_EMAIL_ADDRESS, email);</span>
<span class="nc" id="L1509">        intent.putExtra(SignupEpilogueActivity.EXTRA_SIGNUP_PHOTO_URL, photoUrl);</span>
<span class="nc" id="L1510">        intent.putExtra(SignupEpilogueActivity.EXTRA_SIGNUP_USERNAME, username);</span>
<span class="nc" id="L1511">        intent.putExtra(SignupEpilogueActivity.EXTRA_SIGNUP_IS_EMAIL, isEmail);</span>
<span class="nc" id="L1512">        activity.startActivityForResult(intent, RequestCodes.SHOW_SIGNUP_EPILOGUE_AND_RETURN);</span>
<span class="nc" id="L1513">    }</span>

    public static void showPostSignupInterstitial(Context context) {
<span class="nc" id="L1516">        final Intent parentIntent = new Intent(context, WPMainActivity.class);</span>
<span class="nc" id="L1517">        parentIntent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);</span>
<span class="nc" id="L1518">        parentIntent.addFlags(Intent.FLAG_ACTIVITY_NO_ANIMATION);</span>
<span class="nc" id="L1519">        final Intent intent = new Intent(context, PostSignupInterstitialActivity.class);</span>
<span class="nc" id="L1520">        TaskStackBuilder.create(context).addNextIntent(parentIntent).addNextIntent(intent).startActivities();</span>
<span class="nc" id="L1521">    }</span>

    public static void viewStatsSinglePostDetails(Context context, SiteModel site, PostModel post) {
<span class="nc bnc" id="L1524" title="All 4 branches missed.">        if (post == null || site == null) {</span>
<span class="nc" id="L1525">            return;</span>
        }
<span class="nc" id="L1527">        StatsDetailActivity.Companion</span>
<span class="nc" id="L1528">                .start(context, site, post.getRemotePostId(), StatsConstants.ITEM_TYPE_POST, post.getTitle(),</span>
<span class="nc" id="L1529">                        post.getLink());</span>
<span class="nc" id="L1530">    }</span>

    public static void viewInsightsDetail(
            Context context,
            StatsSection statsSection,
            StatsViewType statsViewType,
            StatsGranularity granularity,
            SelectedDate selectedDate,
            int localSiteId
    ) {
<span class="nc" id="L1540">        StatsDetailActivity.startForInsightsDetail(</span>
                context,
                statsSection,
                statsViewType,
                granularity,
                selectedDate,
                localSiteId
        );
<span class="nc" id="L1548">    }</span>

    public static void showSetBloggingReminders(Context context, SiteModel site) {
<span class="nc" id="L1551">        final Intent intent = getMainActivityInNewStack(context);</span>
<span class="nc" id="L1552">        intent.putExtra(WPMainActivity.ARG_OPEN_BLOGGING_REMINDERS, true);</span>
<span class="nc" id="L1553">        intent.putExtra(WPMainActivity.ARG_SELECTED_SITE, site.getId());</span>
<span class="nc" id="L1554">        context.startActivity(intent);</span>
<span class="nc" id="L1555">    }</span>

    public static void showSchedulingPost(Context context, SiteModel site) {
<span class="nc" id="L1558">        Intent intent = PostsListActivity.buildIntent(</span>
                context,
                site,
                PostListType.DRAFTS,
                false,
                null
        );
<span class="nc" id="L1565">        context.startActivity(intent);</span>
<span class="nc" id="L1566">    }</span>

    public static void viewMediaPickerForResult(Activity activity,
                                                @NonNull SiteModel site,
                                                @NonNull MediaBrowserType browserType) {
<span class="nc" id="L1571">        Intent intent = new Intent(activity, MediaBrowserActivity.class);</span>
<span class="nc" id="L1572">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L1573">        intent.putExtra(ARG_BROWSER_TYPE, browserType);</span>
        int requestCode;
<span class="nc bnc" id="L1575" title="All 2 branches missed.">        if (browserType.canMultiselect()) {</span>
<span class="nc" id="L1576">            requestCode = RequestCodes.MULTI_SELECT_MEDIA_PICKER;</span>
        } else {
<span class="nc" id="L1578">            requestCode = RequestCodes.SINGLE_SELECT_MEDIA_PICKER;</span>
        }
<span class="nc" id="L1580">        activity.startActivityForResult(intent, requestCode);</span>
<span class="nc" id="L1581">    }</span>

    public static void viewSuggestionsForResult(@NonNull Activity activity,
                                                @NonNull SiteModel site,
                                                @NonNull SuggestionType type) {
<span class="nc" id="L1586">        Intent intent = new Intent(activity, SuggestionActivity.class);</span>
<span class="nc" id="L1587">        intent.putExtra(SuggestionActivity.INTENT_KEY_SITE_MODEL, site);</span>
<span class="nc" id="L1588">        intent.putExtra(SuggestionActivity.INTENT_KEY_SUGGESTION_TYPE, type);</span>
<span class="nc" id="L1589">        activity.startActivityForResult(intent, RequestCodes.SELECTED_USER_MENTION);</span>
<span class="nc" id="L1590">    }</span>

    public static void addSelfHostedSiteForResult(Activity activity) {
        Intent intent;
<span class="nc" id="L1594">        intent = new Intent(activity, LoginActivity.class);</span>
<span class="nc" id="L1595">        LoginMode.SELFHOSTED_ONLY.putInto(intent);</span>
<span class="nc" id="L1596">        activity.startActivityForResult(intent, RequestCodes.ADD_ACCOUNT);</span>
<span class="nc" id="L1597">    }</span>

    public static void loginForDeeplink(Activity activity) {
        Intent intent;
<span class="nc" id="L1601">        intent = new Intent(activity, LoginActivity.class);</span>
<span class="nc" id="L1602">        LoginMode.WPCOM_LOGIN_DEEPLINK.putInto(intent);</span>
<span class="nc" id="L1603">        activity.startActivityForResult(intent, RequestCodes.DO_LOGIN);</span>
<span class="nc" id="L1604">    }</span>

    public static void loginForShareIntent(Activity activity) {
<span class="nc" id="L1607">        Intent intent = new Intent(activity, LoginActivity.class);</span>
<span class="nc" id="L1608">        LoginMode.SHARE_INTENT.putInto(intent);</span>
<span class="nc" id="L1609">        activity.startActivityForResult(intent, RequestCodes.DO_LOGIN);</span>
<span class="nc" id="L1610">    }</span>

    public static void loginWithoutMagicLink(Activity activity) {
        Intent intent;
<span class="nc" id="L1614">        intent = new Intent(activity, LoginActivity.class);</span>
<span class="nc" id="L1615">        LoginMode.WPCOM_LOGIN_DEEPLINK.putInto(intent);</span>
<span class="nc" id="L1616">        activity.startActivityForResult(intent, RequestCodes.DO_LOGIN);</span>
<span class="nc" id="L1617">    }</span>

    public static void loginForJetpackStats(Fragment fragment) {
<span class="nc" id="L1620">        Intent intent = new Intent(fragment.getActivity(), LoginActivity.class);</span>
<span class="nc" id="L1621">        LoginMode.JETPACK_STATS.putInto(intent);</span>
<span class="nc" id="L1622">        fragment.startActivityForResult(intent, RequestCodes.DO_LOGIN);</span>
<span class="nc" id="L1623">    }</span>

    /*
     * open the passed url in the device's external browser
     */
    public static void openUrlExternal(Context context, @NonNull String url) {
<span class="nc" id="L1629">        Uri uri = Uri.parse(url);</span>
<span class="nc" id="L1630">        Intent intent = new Intent(Intent.ACTION_VIEW, uri);</span>
<span class="nc" id="L1631">        intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</span>

        try {
            // Disable deeplinking activity so to not catch WP URLs.
            // We'll re-enable them later - see callers of WPActivityUtils#enableReaderDeeplinks.
<span class="nc" id="L1636">            WPActivityUtils.disableReaderDeeplinks(context);</span>

<span class="nc" id="L1638">            context.startActivity(intent);</span>
<span class="nc" id="L1639">        } catch (ActivityNotFoundException e) {</span>
<span class="nc" id="L1640">            ToastUtils.showToast(context, context.getString(R.string.cant_open_url), ToastUtils.Duration.LONG);</span>
<span class="nc" id="L1641">            AppLog.e(AppLog.T.UTILS, &quot;No default app available on the device to open the link: &quot; + url, e);</span>
<span class="nc" id="L1642">        } catch (SecurityException se) {</span>
<span class="nc" id="L1643">            AppLog.e(AppLog.T.UTILS, &quot;Error opening url in default browser. Url: &quot; + url, se);</span>

<span class="nc" id="L1645">            List&lt;ResolveInfo&gt; infos = context.getPackageManager().queryIntentActivities(intent, 0);</span>
<span class="nc bnc" id="L1646" title="All 2 branches missed.">            if (infos.size() == 1) {</span>
                // there's only one handler and apparently it caused the exception so, just inform and bail
<span class="nc" id="L1648">                AppLog.d(AppLog.T.UTILS, &quot;Only one url handler found so, bailing.&quot;);</span>
<span class="nc" id="L1649">                ToastUtils.showToast(context, context.getString(R.string.cant_open_url));</span>
            } else {
<span class="nc" id="L1651">                Intent chooser = Intent.createChooser(intent, context.getString(R.string.error_please_choose_browser));</span>
<span class="nc" id="L1652">                context.startActivity(chooser);</span>
            }
<span class="nc" id="L1654">        }</span>
<span class="nc" id="L1655">    }</span>

    public static void openStatsUrl(Context context, @NonNull String url) {
<span class="nc bnc" id="L1658" title="All 4 branches missed.">        if (url.startsWith(&quot;https://wordpress.com/my-stats&quot;) || url.startsWith(&quot;http://wordpress.com/my-stats&quot;)) {</span>
            // make sure to load the no-chrome version of Stats over https
<span class="nc" id="L1660">            url = UrlUtils.makeHttps(url);</span>
<span class="nc bnc" id="L1661" title="All 2 branches missed.">            if (url.contains(&quot;?&quot;)) {</span>
                // add the no chrome parameters if not available
<span class="nc bnc" id="L1663" title="All 4 branches missed.">                if (!url.contains(&quot;?no-chrome&quot;) &amp;&amp; !url.contains(&quot;&amp;no-chrome&quot;)) {</span>
<span class="nc" id="L1664">                    url += &quot;&amp;no-chrome&quot;;</span>
                }
            } else {
<span class="nc" id="L1667">                url += &quot;?no-chrome&quot;;</span>
            }
<span class="nc" id="L1669">            WPWebViewActivity.openUrlByUsingGlobalWPCOMCredentials(context, url);</span>
<span class="nc bnc" id="L1670" title="All 4 branches missed.">        } else if (url.startsWith(&quot;https&quot;) || url.startsWith(&quot;http&quot;)) {</span>
<span class="nc" id="L1671">            WPWebViewActivity.openURL(context, url);</span>
        }
<span class="nc" id="L1673">    }</span>

    public static void openImageEditor(
        Activity activity,
        ArrayList&lt;EditImageData.InputData&gt; input
    ) {
<span class="nc" id="L1679">        Intent intent = new Intent(activity, EditImageActivity.class);</span>
<span class="nc" id="L1680">        intent.putParcelableArrayListExtra(ARG_EDIT_IMAGE_DATA, input);</span>
<span class="nc" id="L1681">        activity.startActivityForResult(intent, RequestCodes.IMAGE_EDITOR_EDIT_IMAGE);</span>
<span class="nc" id="L1682">    }</span>

    public static void viewPagesInNewStack(Context context, SiteModel site) {
<span class="nc bnc" id="L1685" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L1686">            ToastUtils.showToast(context, R.string.pages_cannot_be_started, ToastUtils.Duration.SHORT);</span>
<span class="nc" id="L1687">            return;</span>
        }

<span class="nc" id="L1690">        TaskStackBuilder taskStackBuilder = TaskStackBuilder.create(context);</span>
<span class="nc" id="L1691">        Intent mainActivityIntent = getMainActivityInNewStack(context);</span>
<span class="nc" id="L1692">        Intent pagesIntent = new Intent(context, PagesActivity.class);</span>
<span class="nc" id="L1693">        pagesIntent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L1694">        taskStackBuilder.addNextIntent(mainActivityIntent);</span>
<span class="nc" id="L1695">        taskStackBuilder.addNextIntent(pagesIntent);</span>
<span class="nc" id="L1696">        taskStackBuilder.startActivities();</span>
<span class="nc" id="L1697">    }</span>

    public static void viewPagesInNewStack(Context context) {
<span class="nc" id="L1700">        Intent intent = getMainActivityInNewStack(context);</span>
<span class="nc" id="L1701">        intent.putExtra(WPMainActivity.ARG_OPEN_PAGE, WPMainActivity.ARG_PAGES);</span>
<span class="nc" id="L1702">        context.startActivity(intent);</span>
<span class="nc" id="L1703">    }</span>

    public static void showBackupDownloadForResult(Activity activity, @NonNull SiteModel site, String activityId,
                                                   int resultCode, String source) {
<span class="nc" id="L1707">        Map&lt;String, String&gt; properties = new HashMap&lt;&gt;();</span>
<span class="nc" id="L1708">        properties.put(SOURCE_TRACK_EVENT_PROPERTY_KEY, source);</span>
<span class="nc" id="L1709">        AnalyticsTracker.track(Stat.JETPACK_BACKUP_DOWNLOAD_OPENED, properties);</span>

<span class="nc" id="L1711">        Intent intent = new Intent(activity, BackupDownloadActivity.class);</span>
<span class="nc" id="L1712">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L1713">        intent.putExtra(KEY_BACKUP_DOWNLOAD_ACTIVITY_ID_KEY, activityId);</span>
<span class="nc" id="L1714">        activity.startActivityForResult(intent, resultCode);</span>
<span class="nc" id="L1715">    }</span>

    public static void shareBackupDownloadFileLink(Context context, String url) {
<span class="nc" id="L1718">        Intent intent = new Intent(Intent.ACTION_SEND);</span>
<span class="nc" id="L1719">        intent.setType(&quot;text/plain&quot;);</span>
<span class="nc" id="L1720">        intent.putExtra(Intent.EXTRA_TEXT, url);</span>

<span class="nc" id="L1722">        context.startActivity(Intent.createChooser(intent, context.getString(R.string.share_link)));</span>
<span class="nc" id="L1723">    }</span>

    public static void downloadBackupDownloadFile(Context context, String url) {
<span class="nc" id="L1726">        Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));</span>
<span class="nc" id="L1727">        context.startActivity(intent);</span>
<span class="nc" id="L1728">    }</span>

    public static void showRestoreForResult(Activity activity, @NonNull SiteModel site, String activityId,
                                                   int resultCode, String source) {
<span class="nc" id="L1732">        Map&lt;String, String&gt; properties = new HashMap&lt;&gt;();</span>
<span class="nc" id="L1733">        properties.put(SOURCE_TRACK_EVENT_PROPERTY_KEY, source);</span>
<span class="nc" id="L1734">        AnalyticsTracker.track(Stat.JETPACK_RESTORE_OPENED, properties);</span>

<span class="nc" id="L1736">        Intent intent = new Intent(activity, RestoreActivity.class);</span>
<span class="nc" id="L1737">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L1738">        intent.putExtra(KEY_RESTORE_ACTIVITY_ID_KEY, activityId);</span>
<span class="nc" id="L1739">        activity.startActivityForResult(intent, resultCode);</span>
<span class="nc" id="L1740">    }</span>

    public static void showCategoriesList(@NonNull Context context, @NonNull SiteModel site) {
<span class="nc" id="L1743">        Intent intent = new Intent(context, CategoriesListActivity.class);</span>
<span class="nc" id="L1744">        intent.putExtra(WordPress.SITE, site);</span>
<span class="nc" id="L1745">        context.startActivity(intent);</span>
<span class="nc" id="L1746">    }</span>

    public static void showCategoryDetail(@NonNull Context context, @Nullable Long categoryId) {
<span class="nc" id="L1749">        Intent intent = new Intent(context, CategoryDetailActivity.class);</span>
<span class="nc" id="L1750">        intent.putExtra(CATEGORY_DETAIL_ID, categoryId);</span>
<span class="nc" id="L1751">        context.startActivity(intent);</span>
<span class="nc" id="L1752">    }</span>

    public static void viewDebugCookies(@NonNull Context context) {
<span class="nc" id="L1755">        context.startActivity(new Intent(context, DebugCookiesActivity.class));</span>
<span class="nc" id="L1756">    }</span>

    public static void startQRCodeAuthFlow(@NonNull Context context) {
<span class="nc" id="L1759">        QRCodeAuthActivity.start(context);</span>
<span class="nc" id="L1760">    }</span>

    public static void startQRCodeAuthFlowInNewStack(@NonNull Context context, @NonNull String uri) {
<span class="nc" id="L1763">        TaskStackBuilder taskStackBuilder = TaskStackBuilder.create(context);</span>

<span class="nc" id="L1765">        Intent mainActivityIntent = getMainActivityInNewStack(context);</span>
<span class="nc" id="L1766">        mainActivityIntent.addFlags(Intent.FLAG_ACTIVITY_NO_ANIMATION);</span>

<span class="nc" id="L1768">        Intent meIntent = new Intent(context, MeActivity.class);</span>
<span class="nc" id="L1769">        meIntent.addFlags(Intent.FLAG_ACTIVITY_NO_ANIMATION);</span>

<span class="nc" id="L1771">        Intent qrcodeAuthFlowIntent = QRCodeAuthActivity.newIntent(context, uri, true);</span>

<span class="nc" id="L1773">        taskStackBuilder.addNextIntent(mainActivityIntent);</span>
<span class="nc" id="L1774">        taskStackBuilder.addNextIntent(meIntent);</span>
<span class="nc" id="L1775">        taskStackBuilder.addNextIntent(qrcodeAuthFlowIntent);</span>

<span class="nc" id="L1777">        taskStackBuilder.startActivities();</span>
<span class="nc" id="L1778">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span>Generated by the Android Gradle plugin 7.1.1</div></body></html>