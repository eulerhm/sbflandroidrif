<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SiteUtils.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">wordpressJalapenoDebug</a> &gt; <a href="index.source.html" class="el_package">org.wordpress.android.util</a> &gt; <span class="el_source">SiteUtils.java</span></div><h1>SiteUtils.java</h1><pre class="source lang-java linenums">package org.wordpress.android.util;

import android.text.TextUtils;

import androidx.annotation.NonNull;
import androidx.annotation.Nullable;

import org.jetbrains.annotations.NotNull;
import org.wordpress.android.BuildConfig;
import org.wordpress.android.WordPress;
import org.wordpress.android.analytics.AnalyticsTracker.Stat;
import org.wordpress.android.fluxc.Dispatcher;
import org.wordpress.android.fluxc.generated.SiteActionBuilder;
import org.wordpress.android.fluxc.model.SiteModel;
import org.wordpress.android.fluxc.store.AccountStore;
import org.wordpress.android.fluxc.store.SiteStore;
import org.wordpress.android.fluxc.store.SiteStore.DesignateMobileEditorForAllSitesPayload;
import org.wordpress.android.fluxc.store.SiteStore.DesignateMobileEditorPayload;
import org.wordpress.android.fluxc.store.SiteStore.FetchSitesPayload;
import org.wordpress.android.fluxc.store.SiteStore.SiteFilter;
import org.wordpress.android.ui.plans.PlansConstants;
import org.wordpress.android.ui.prefs.AppPrefs;
import org.wordpress.android.ui.reader.utils.SiteAccessibilityInfo;
import org.wordpress.android.ui.reader.utils.SiteVisibility;
import org.wordpress.android.util.analytics.AnalyticsUtils;
import org.wordpress.android.util.analytics.AnalyticsUtils.BlockEditorEnabledSource;
import org.wordpress.android.util.image.BlavatarShape;
import org.wordpress.android.util.image.ImageType;

import java.util.ArrayList;
import java.util.List;

<span class="nc" id="L33">public class SiteUtils {</span>
    public static final String GB_EDITOR_NAME = &quot;gutenberg&quot;;
    public static final String AZTEC_EDITOR_NAME = &quot;aztec&quot;;
    public static final String WP_STORIES_CREATOR_NAME = &quot;wp_stories_creator&quot;;
    public static final String WP_STORIES_JETPACK_VERSION = &quot;9.1&quot;;
    public static final String WP_CONTACT_INFO_JETPACK_VERSION = &quot;8.5&quot;;
    public static final String WP_FACEBOOK_EMBED_JETPACK_VERSION = &quot;9.0&quot;;
    public static final String WP_INSTAGRAM_EMBED_JETPACK_VERSION = &quot;9.0&quot;;
    public static final String WP_LOOM_EMBED_JETPACK_VERSION = &quot;9.0&quot;;
    public static final String WP_SMARTFRAME_EMBED_JETPACK_VERSION = &quot;10.2&quot;;
    private static final int GB_ROLLOUT_PERCENTAGE_PHASE_1 = 100;
    private static final int GB_ROLLOUT_PERCENTAGE_PHASE_2 = 100;

    /**
     * Migrate the old app-wide editor preference value to per-site setting. wpcom sites will make a network call
     * and store the value on the backend. selfHosted sites just store the value in the local DB in FluxC
     * &lt;p&gt;
     * Strategy: Check if there is the old app-wide preference still available (v12.9 and before used it).
     * -- 12.9 ON -&gt; turn all sites ON in 13.0
     * -- 12.9 OPTED OUT (were auto-opted in but turned it OFF) -&gt; turn all sites OFF in 13.0
     */
    public static void migrateAppWideMobileEditorPreferenceToRemote(final AccountStore accountStore,
                                                                    final SiteStore siteStore,
                                                                    final Dispatcher dispatcher) {
        // Skip if the user is not signed in
<span class="nc bnc" id="L58" title="All 2 branches missed.">        if (!FluxCUtils.isSignedInWPComOrHasWPOrgSite(accountStore, siteStore)) {</span>
<span class="nc" id="L59">            return;</span>
        }

        // If the user is already in the rollout group, we can skip this the migration.
<span class="nc bnc" id="L63" title="All 2 branches missed.">        if (AppPrefs.isUserInGutenbergRolloutGroup()) {</span>
<span class="nc" id="L64">            return;</span>
        }

        // -------- Rollout: Phase 2 -------
        //
        // If user has any Aztec enabled sites, we'll migrate their sites to Gutenberg and schedule showing popup.
<span class="nc bnc" id="L70" title="All 2 branches missed.">        if (atLeastOneSiteHasAztecEnabled(siteStore)) {</span>
            // Randomly pick the user in the rollout group
<span class="nc bnc" id="L72" title="All 2 branches missed.">            if (accountStore.getAccount().getUserId() % 100 &gt;= (100 - GB_ROLLOUT_PERCENTAGE_PHASE_2)) {</span>
<span class="nc bnc" id="L73" title="All 2 branches missed.">                if (!NetworkUtils.isNetworkAvailable(WordPress.getContext())) {</span>
                    // If the network is not available, abort. We can't update the remote setting.
<span class="nc" id="L75">                    return;</span>
                }

<span class="nc bnc" id="L78" title="All 2 branches missed.">                for (SiteModel site : siteStore.getSites()) {</span>
                    // Show &quot;phase 2&quot; dialog on sites that get switched from aztec to gutenberg
<span class="nc bnc" id="L80" title="All 2 branches missed.">                    if (TextUtils.equals(site.getMobileEditor(), AZTEC_EDITOR_NAME)) {</span>
<span class="nc" id="L81">                        AppPrefs.setShowGutenbergInfoPopupPhase2ForNewPosts(site.getUrl(), true);</span>
                        // Will show the popup again, even if it was displayed in the past
<span class="nc" id="L83">                        AppPrefs.setGutenbergInfoPopupDisplayed(site.getUrl(), false);</span>
<span class="nc" id="L84">                        continue;</span>
                    }

                    // Show &quot;phase 1&quot; dialog on sites that get switched from &quot;empty&quot; (no pref) to gutenberg
<span class="nc bnc" id="L88" title="All 2 branches missed.">                    if (TextUtils.isEmpty(site.getMobileEditor())) {</span>
<span class="nc" id="L89">                        AppPrefs.setShowGutenbergInfoPopupForTheNewPosts(site.getUrl(), true);</span>
                    }
<span class="nc" id="L91">                }</span>

                // Track and enable Gutenberg for all sites using a single network call. Ideally we would track this
                // on the network response, but this would make this rollout even more complex.
                // There might be some rare events when we register a site switched to Gutenberg which is actually
                // still on Aztec.
<span class="nc" id="L97">                trackGutenbergEnabledForNonGutenbergSites(siteStore,</span>
                        BlockEditorEnabledSource.ON_PROGRESSIVE_ROLLOUT_PHASE_2);
<span class="nc" id="L99">                dispatcher.dispatch(SiteActionBuilder.newDesignateMobileEditorForAllSitesAction(</span>
                        new DesignateMobileEditorForAllSitesPayload(SiteUtils.GB_EDITOR_NAME, false)));

                // After enabling Gutenberg on these sites, we consider the user entered the rollout group
<span class="nc" id="L103">                AppPrefs.setUserInGutenbergRolloutGroup();</span>
            }
        }

        // -------- Rollout: Phase 1 -------
        //
        // Check if the user has been &quot;randomly&quot; selected to enter the rollout group.
        //
        // For self hosted sites, there are often one or two users, and the user id is probably 0, 1 in these cases.
        // If we exclude low ids, we won't get an not an homogeneous distribution over self hosted and WordPress.com
        // users, but the purpose of this is to do a progressive rollout, not an necessarily an homogeneous rollout.
        //
        // To exclude ids 0 and 1, to rollout for 10% users,
        // we'll use a test like `id % 100 &gt;= 90` instead of `id % 100 &lt; 10`.
<span class="nc bnc" id="L117" title="All 2 branches missed.">        if (accountStore.getAccount().getUserId() % 100 &gt;= (100 - GB_ROLLOUT_PERCENTAGE_PHASE_1)) {</span>
<span class="nc bnc" id="L118" title="All 2 branches missed.">            if (atLeastOneSiteHasAztecEnabled(siteStore)) {</span>
                // If the user has opt-ed out from at least one of their site, then exclude them from the cohort
<span class="nc" id="L120">                return;</span>
            }

<span class="nc bnc" id="L123" title="All 2 branches missed.">            if (!NetworkUtils.isNetworkAvailable(WordPress.getContext())) {</span>
                // If the network is not available, abort. We can't update the remote setting.
<span class="nc" id="L125">                return;</span>
            }

            // Force the dialog to be shown on updated sites
<span class="nc bnc" id="L129" title="All 2 branches missed.">            for (SiteModel site : siteStore.getSites()) {</span>
<span class="nc bnc" id="L130" title="All 2 branches missed.">                if (TextUtils.isEmpty(site.getMobileEditor())) {</span>
<span class="nc" id="L131">                    AppPrefs.setShowGutenbergInfoPopupForTheNewPosts(site.getUrl(), true);</span>
                }
<span class="nc" id="L133">            }</span>

            // Track and enable and  Gutenberg for all sites using a single network call. Ideally we would track this
            // on the network response, but this would make this rollout even more complex.
            // There might be some rare events when we register a site switched to Gutenberg which is actually
            // still on Aztec.
<span class="nc" id="L139">            trackGutenbergEnabledForNonGutenbergSites(siteStore,</span>
                    BlockEditorEnabledSource.ON_PROGRESSIVE_ROLLOUT_PHASE_1);
<span class="nc" id="L141">            dispatcher.dispatch(SiteActionBuilder.newDesignateMobileEditorForAllSitesAction(</span>
                    new DesignateMobileEditorForAllSitesPayload(SiteUtils.GB_EDITOR_NAME)));

            // After enabling Gutenberg on these sites, we consider the user entered the rollout group
<span class="nc" id="L145">            AppPrefs.setUserInGutenbergRolloutGroup();</span>
        }

<span class="nc bnc" id="L148" title="All 2 branches missed.">        if (!AppPrefs.isDefaultAppWideEditorPreferenceSet()) {</span>
<span class="nc" id="L149">            return;</span>
        }
<span class="nc" id="L151">        final boolean oldAppWidePreferenceValue = AppPrefs.isGutenbergDefaultForNewPosts();</span>

<span class="nc bnc" id="L153" title="All 2 branches missed.">        if (oldAppWidePreferenceValue) {</span>
<span class="nc" id="L154">            dispatcher.dispatch(SiteActionBuilder.newDesignateMobileEditorForAllSitesAction(</span>
                    new DesignateMobileEditorForAllSitesPayload(SiteUtils.GB_EDITOR_NAME)));
        } else {
<span class="nc" id="L157">            dispatcher.dispatch(SiteActionBuilder.newDesignateMobileEditorForAllSitesAction(</span>
                    new DesignateMobileEditorForAllSitesPayload(SiteUtils.AZTEC_EDITOR_NAME)));
        }
<span class="nc" id="L160">    }</span>

    private static void trackGutenbergEnabledForNonGutenbergSites(final SiteStore siteStore,
                                                                  final BlockEditorEnabledSource source) {
<span class="nc bnc" id="L164" title="All 2 branches missed.">        for (SiteModel site : siteStore.getSites()) {</span>
<span class="nc bnc" id="L165" title="All 2 branches missed.">            if (!TextUtils.equals(site.getMobileEditor(), GB_EDITOR_NAME)) {</span>
<span class="nc" id="L166">                AnalyticsUtils.trackWithSiteDetails(Stat.EDITOR_GUTENBERG_ENABLED, site, source.asPropertyMap());</span>
            }
<span class="nc" id="L168">        }</span>
<span class="nc" id="L169">    }</span>

    private static boolean atLeastOneSiteHasAztecEnabled(final SiteStore siteStore) {
        // We want to make sure to enable Gutenberg only on the sites they didn't opt-out.
<span class="nc bnc" id="L173" title="All 2 branches missed.">        for (SiteModel site : siteStore.getSites()) {</span>
<span class="nc bnc" id="L174" title="All 2 branches missed.">            if (TextUtils.equals(site.getMobileEditor(), AZTEC_EDITOR_NAME)) {</span>
<span class="nc" id="L175">                return true;</span>
            }
<span class="nc" id="L177">        }</span>
<span class="nc" id="L178">        return false;</span>
    }

    public static boolean enableBlockEditorOnSiteCreation(Dispatcher dispatcher, SiteStore siteStore,
                                                          int siteLocalSiteID) {
<span class="nc" id="L183">        SiteModel newSiteModel = siteStore.getSiteByLocalId(siteLocalSiteID);</span>
<span class="nc bnc" id="L184" title="All 2 branches missed.">        if (newSiteModel != null) {</span>
<span class="nc" id="L185">            enableBlockEditor(dispatcher, newSiteModel);</span>
<span class="nc" id="L186">            AnalyticsUtils.trackWithSiteDetails(Stat.EDITOR_GUTENBERG_ENABLED, newSiteModel,</span>
<span class="nc" id="L187">                    BlockEditorEnabledSource.ON_SITE_CREATION.asPropertyMap());</span>
<span class="nc" id="L188">            return true;</span>
        }
<span class="nc" id="L190">        return false;</span>
    }

    public static void enableBlockEditor(Dispatcher dispatcher, SiteModel siteModel) {
<span class="nc" id="L194">        dispatcher.dispatch(SiteActionBuilder.newDesignateMobileEditorAction(</span>
                new DesignateMobileEditorPayload(siteModel, GB_EDITOR_NAME)));
<span class="nc" id="L196">    }</span>

    public static void disableBlockEditor(Dispatcher dispatcher, SiteModel siteModel) {
<span class="nc" id="L199">        dispatcher.dispatch(SiteActionBuilder.newDesignateMobileEditorAction(</span>
                new DesignateMobileEditorPayload(siteModel, AZTEC_EDITOR_NAME)));
<span class="nc" id="L201">    }</span>

    public static boolean isBlockEditorDefaultForNewPost(@Nullable SiteModel site) {
<span class="nc bnc" id="L204" title="All 2 branches missed.">        if (site == null) {</span>
<span class="nc" id="L205">            return true;</span>
        }
<span class="nc bnc" id="L207" title="All 2 branches missed.">        if (TextUtils.isEmpty(site.getMobileEditor())) {</span>
            // Default to block editor when mobile editor setting is empty
<span class="nc" id="L209">            return true;</span>
        } else {
<span class="nc bnc" id="L211" title="All 4 branches missed.">            return alwaysDefaultToGutenberg(site) || site.getMobileEditor().equals(SiteUtils.GB_EDITOR_NAME);</span>
        }
    }

    public static boolean alwaysDefaultToGutenberg(SiteModel site) {
<span class="nc bnc" id="L216" title="All 4 branches missed.">        return site.isWPCom() &amp;&amp; !site.isWPComAtomic();</span>
    }

    public static String getSiteNameOrHomeURL(SiteModel site) {
<span class="nc" id="L220">        String siteName = site.getName();</span>
<span class="nc bnc" id="L221" title="All 2 branches missed.">        if (siteName == null) {</span>
<span class="nc" id="L222">            return &quot;&quot;;</span>
        }
<span class="nc bnc" id="L224" title="All 2 branches missed.">        if (siteName.trim().length() == 0) {</span>
<span class="nc" id="L225">            siteName = getHomeURLOrHostName(site);</span>
        }
<span class="nc" id="L227">        return siteName;</span>
    }

    public static String getHomeURLOrHostName(SiteModel site) {
<span class="nc" id="L231">        String homeURL = UrlUtils.removeScheme(site.getUrl());</span>
<span class="nc" id="L232">        homeURL = StringUtils.removeTrailingSlash(homeURL);</span>
<span class="nc bnc" id="L233" title="All 2 branches missed.">        if (TextUtils.isEmpty(homeURL)) {</span>
<span class="nc" id="L234">            return UrlUtils.getHost(site.getXmlRpcUrl());</span>
        }
<span class="nc" id="L236">        return homeURL;</span>
    }

    /**
     * @return true if the site is WPCom or Jetpack and is not private
     */
    public static boolean isPhotonCapable(SiteModel site) {
<span class="nc bnc" id="L243" title="All 6 branches missed.">        return SiteUtils.isAccessedViaWPComRest(site) &amp;&amp; (!site.isPrivate() || site.isWPComAtomic());</span>
    }

    public static boolean isAccessedViaWPComRest(@NonNull SiteModel site) {
<span class="nc bnc" id="L247" title="All 2 branches missed.">        return site.getOrigin() == SiteModel.ORIGIN_WPCOM_REST;</span>
    }

    public static String getSiteIconUrl(SiteModel site, int size) {
<span class="nc" id="L251">        return PhotonUtils.getPhotonImageUrl(site.getIconUrl(), size, size, PhotonUtils.Quality.HIGH,</span>
<span class="nc" id="L252">                site.isPrivateWPComAtomic());</span>
    }

    public static ImageType getSiteImageType(boolean isP2, BlavatarShape shape) {
<span class="nc" id="L256">        ImageType type = ImageType.BLAVATAR;</span>
<span class="nc bnc" id="L257" title="All 2 branches missed.">        if (isP2) {</span>
<span class="nc bnc" id="L258" title="All 4 branches missed.">            switch (shape) {</span>
                case SQUARE:
<span class="nc" id="L260">                    type = ImageType.P2_BLAVATAR;</span>
<span class="nc" id="L261">                    break;</span>
                case SQUARE_WITH_ROUNDED_CORNERES:
<span class="nc" id="L263">                    type = ImageType.P2_BLAVATAR_ROUNDED_CORNERS;</span>
<span class="nc" id="L264">                    break;</span>
                case CIRCULAR:
<span class="nc" id="L266">                    type = ImageType.P2_BLAVATAR_CIRCULAR;</span>
<span class="nc" id="L267">                    break;</span>
            }
        } else {
<span class="nc bnc" id="L270" title="All 4 branches missed.">            switch (shape) {</span>
                case SQUARE:
<span class="nc" id="L272">                    type = ImageType.BLAVATAR;</span>
<span class="nc" id="L273">                    break;</span>
                case SQUARE_WITH_ROUNDED_CORNERES:
<span class="nc" id="L275">                    type = ImageType.BLAVATAR_ROUNDED_CORNERS;</span>
<span class="nc" id="L276">                    break;</span>
                case CIRCULAR:
<span class="nc" id="L278">                    type = ImageType.BLAVATAR_CIRCULAR;</span>
                    break;
            }
        }
<span class="nc" id="L282">        return type;</span>
    }

    public static SiteAccessibilityInfo getAccessibilityInfoFromSite(@NotNull SiteModel site) {
        SiteVisibility siteVisibility;

<span class="nc bnc" id="L288" title="All 2 branches missed.">        if (site.isPrivateWPComAtomic()) {</span>
<span class="nc" id="L289">            siteVisibility = SiteVisibility.PRIVATE_ATOMIC;</span>
<span class="nc bnc" id="L290" title="All 2 branches missed.">        } else if (site.isPrivate()) {</span>
<span class="nc" id="L291">            siteVisibility = SiteVisibility.PRIVATE;</span>
        } else {
<span class="nc" id="L293">            siteVisibility = SiteVisibility.PUBLIC;</span>
        }

<span class="nc" id="L296">        return new SiteAccessibilityInfo(siteVisibility, isPhotonCapable(site));</span>
    }

    public static ArrayList&lt;Integer&gt; getCurrentSiteIds(SiteStore siteStore, boolean selfhostedOnly) {
<span class="nc" id="L300">        ArrayList&lt;Integer&gt; siteIDs = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L301" title="All 2 branches missed.">        List&lt;SiteModel&gt; sites = selfhostedOnly ? siteStore.getSitesAccessedViaXMLRPC() : siteStore.getSites();</span>
<span class="nc bnc" id="L302" title="All 2 branches missed.">        for (SiteModel site : sites) {</span>
<span class="nc" id="L303">            siteIDs.add(site.getId());</span>
<span class="nc" id="L304">        }</span>

<span class="nc" id="L306">        return siteIDs;</span>
    }

    /**
     * Checks if site Jetpack version is higher than limit version
     *
     * @param site
     * @param limitVersion minimal acceptable Jetpack version
     * @return
     */
    public static boolean checkMinimalJetpackVersion(SiteModel site, String limitVersion) {
<span class="nc" id="L317">        String jetpackVersion = site.getJetpackVersion();</span>
<span class="nc bnc" id="L318" title="All 6 branches missed.">        if (site.isUsingWpComRestApi() &amp;&amp; site.isJetpackConnected() &amp;&amp; !TextUtils.isEmpty(jetpackVersion)) {</span>
            // Jetpack version field is sometimes &quot;false&quot; instead of a number on self-hosted sites that are no
            // longer active.
<span class="nc bnc" id="L321" title="All 2 branches missed.">            if (jetpackVersion.equals(&quot;false&quot;)) {</span>
<span class="nc" id="L322">                return false;</span>
            }
<span class="nc" id="L324">            return VersionUtils.checkMinimalVersion(jetpackVersion, limitVersion);</span>
        }
<span class="nc" id="L326">        return false;</span>
    }

    public static boolean checkMinimalWordPressVersion(SiteModel site, String minVersion) {
<span class="nc" id="L330">        return VersionUtils.checkMinimalVersion(site.getSoftwareVersion(), minVersion);</span>
    }

    public static boolean supportsStoriesFeature(SiteModel site) {
<span class="nc bnc" id="L334" title="All 6 branches missed.">        return site != null &amp;&amp; (site.isWPCom() || checkMinimalJetpackVersion(site, WP_STORIES_JETPACK_VERSION));</span>
    }

    public static boolean supportsContactInfoFeature(SiteModel site) {
<span class="nc bnc" id="L338" title="All 6 branches missed.">        return site != null &amp;&amp; (site.isWPCom() || checkMinimalJetpackVersion(site, WP_CONTACT_INFO_JETPACK_VERSION));</span>
    }

    public static boolean supportsLayoutGridFeature(SiteModel site) {
<span class="nc bnc" id="L342" title="All 6 branches missed.">        return site != null &amp;&amp; (site.isWPCom() || site.isWPComAtomic());</span>
    }

    public static boolean supportsTiledGalleryFeature(SiteModel site) {
<span class="nc bnc" id="L346" title="All 4 branches missed.">        return site != null &amp;&amp; site.isWPCom();</span>
    }

    public static boolean supportsEmbedVariationFeature(SiteModel site, String minimalJetpackVersion) {
<span class="nc bnc" id="L350" title="All 6 branches missed.">        return site != null &amp;&amp; (site.isWPCom() || checkMinimalJetpackVersion(site, minimalJetpackVersion));</span>
    }

    public static boolean isNonAtomicBusinessPlanSite(@Nullable SiteModel site) {
<span class="nc bnc" id="L354" title="All 6 branches missed.">        return site != null &amp;&amp; !site.isAutomatedTransfer() &amp;&amp; SiteUtils.hasNonJetpackBusinessPlan(site);</span>
    }

    public static boolean hasNonJetpackBusinessPlan(SiteModel site) {
<span class="nc bnc" id="L358" title="All 2 branches missed.">        return site.getPlanId() == PlansConstants.BUSINESS_PLAN_ID;</span>
    }

    public static boolean onFreePlan(@NonNull SiteModel site) {
<span class="nc bnc" id="L362" title="All 2 branches missed.">        return site.getPlanId() == PlansConstants.FREE_PLAN_ID;</span>
    }

    public static boolean onBloggerPlan(@NonNull SiteModel site) {
<span class="nc bnc" id="L366" title="All 2 branches missed.">        return site.getPlanId() == PlansConstants.BLOGGER_PLAN_ONE_YEAR_ID</span>
<span class="nc bnc" id="L367" title="All 2 branches missed.">               || site.getPlanId() == PlansConstants.BLOGGER_PLAN_TWO_YEARS_ID;</span>
    }

    public static boolean hasFullAccessToContent(@Nullable SiteModel site) {
<span class="nc bnc" id="L371" title="All 6 branches missed.">        return site != null &amp;&amp; (site.isSelfHostedAdmin() || site.getHasCapabilityEditPages());</span>
    }

    // TODO: Inline this method when the legacy 'MySiteFragment' class is removed.
    public static boolean isScanEnabled(boolean scanPurchased, SiteModel site) {
<span class="nc bnc" id="L376" title="All 6 branches missed.">        return scanPurchased &amp;&amp; !site.isWPCom() &amp;&amp; !site.isWPComAtomic();</span>
    }

    @NonNull
    public static FetchSitesPayload getFetchSitesPayload() {
<span class="nc" id="L381">        ArrayList&lt;SiteFilter&gt; siteFilters = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L382">        return new FetchSitesPayload(siteFilters, !BuildConfig.IS_JETPACK_APP);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span>Generated by the Android Gradle plugin 7.1.1</div></body></html>