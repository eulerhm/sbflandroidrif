<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ActivityLogTracker.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">wordpressJalapenoDebug</a> &gt; <a href="index.source.html" class="el_package">org.wordpress.android.util.analytics</a> &gt; <span class="el_source">ActivityLogTracker.kt</span></div><h1>ActivityLogTracker.kt</h1><pre class="source lang-java linenums">package org.wordpress.android.util.analytics

import androidx.core.util.Pair
import org.wordpress.android.analytics.AnalyticsTracker.Stat
import org.wordpress.android.analytics.AnalyticsTracker.Stat.ACTIVITY_LOG_FILTER_BAR_ACTIVITY_TYPE_SELECTED
import org.wordpress.android.fluxc.model.activity.ActivityTypeModel
import org.wordpress.android.util.DateTimeUtilsWrapper
import java.util.Date
import javax.inject.Inject
import javax.inject.Singleton

<span class="nc" id="L12">@Singleton</span>
<span class="nc" id="L13">class ActivityLogTracker @Inject constructor(</span>
<span class="nc" id="L14">    private val tracker: AnalyticsTrackerWrapper,</span>
<span class="nc" id="L15">    private val dateTimeUtilsWrapper: DateTimeUtilsWrapper</span>
) {
    fun trackDateRangeFilterButtonClicked(rewindableOnly: Boolean) {
<span class="nc bnc" id="L18" title="All 2 branches missed.">        if (rewindableOnly) {</span>
<span class="nc" id="L19">            tracker.track(Stat.JETPACK_BACKUP_FILTER_BAR_DATE_RANGE_BUTTON_TAPPED)</span>
        } else {
<span class="nc" id="L21">            tracker.track(Stat.ACTIVITY_LOG_FILTER_BAR_DATE_RANGE_BUTTON_TAPPED)</span>
        }
<span class="nc" id="L23">    }</span>

    fun trackDateRangeFilterSelected(dateRange: Pair&lt;Long, Long&gt;?, rewindableOnly: Boolean) {
<span class="nc bnc" id="L26" title="All 2 branches missed.">        val start = dateRange?.first</span>
<span class="nc bnc" id="L27" title="All 2 branches missed.">        val end = dateRange?.second</span>
<span class="nc bnc" id="L28" title="All 4 branches missed.">        if (start == null || end == null) {</span>
<span class="nc" id="L29">            trackDateRangeFilterCleared(rewindableOnly)</span>
        } else {
<span class="nc" id="L31">            val map = mutableMapOf&lt;String, Any&gt;()</span>
            // Number of selected days
<span class="nc" id="L33">            map[&quot;duration&quot;] = dateTimeUtilsWrapper.daysBetween(Date(start), Date(end)) + 1</span>
            // Distance from the startDate to today (in days)
<span class="nc" id="L35">            map[&quot;distance&quot;] = dateTimeUtilsWrapper.daysBetween(Date(start), Date())</span>
<span class="nc bnc" id="L36" title="All 2 branches missed.">            if (rewindableOnly) {</span>
<span class="nc" id="L37">                tracker.track(Stat.JETPACK_BACKUP_FILTER_BAR_DATE_RANGE_SELECTED, map)</span>
            } else {
<span class="nc" id="L39">                tracker.track(Stat.ACTIVITY_LOG_FILTER_BAR_DATE_RANGE_SELECTED, map)</span>
            }
        }
<span class="nc" id="L42">    }</span>

    fun trackDateRangeFilterCleared(rewindableOnly: Boolean) {
<span class="nc bnc" id="L45" title="All 2 branches missed.">        if (rewindableOnly) {</span>
<span class="nc" id="L46">            tracker.track(Stat.JETPACK_BACKUP_FILTER_BAR_DATE_RANGE_RESET)</span>
        } else {
<span class="nc" id="L48">            tracker.track(Stat.ACTIVITY_LOG_FILTER_BAR_DATE_RANGE_RESET)</span>
        }
<span class="nc" id="L50">    }</span>

    fun trackActivityTypeFilterButtonClicked() {
<span class="nc" id="L53">        tracker.track(Stat.ACTIVITY_LOG_FILTER_BAR_ACTIVITY_TYPE_BUTTON_TAPPED)</span>
<span class="nc" id="L54">    }</span>

    fun trackActivityTypeFilterSelected(selectedTypes: List&lt;ActivityTypeModel&gt;) {
<span class="nc bnc" id="L57" title="All 2 branches missed.">        if (selectedTypes.isEmpty()) {</span>
<span class="nc" id="L58">            trackActivityTypeFilterCleared()</span>
        } else {
<span class="nc" id="L60">            val map = mutableMapOf&lt;String, Any&gt;()</span>
<span class="nc" id="L61">            map[&quot;num_groups_selected&quot;] = selectedTypes.size.toString()</span>
<span class="nc" id="L62">            map[&quot;num_total_activities_selected&quot;] = selectedTypes.map { it.count }.reduce { acc, count -&gt; acc + count }</span>
<span class="nc" id="L63">            selectedTypes.forEach { map[&quot;group_${it.key}&quot;] = true }</span>
<span class="nc" id="L64">            tracker.track(ACTIVITY_LOG_FILTER_BAR_ACTIVITY_TYPE_SELECTED, map)</span>
        }
<span class="nc" id="L66">    }</span>

    fun trackActivityTypeFilterCleared() {
<span class="nc" id="L69">        tracker.track(Stat.ACTIVITY_LOG_FILTER_BAR_ACTIVITY_TYPE_RESET)</span>
<span class="nc" id="L70">    }</span>

    fun trackDownloadBackupDownloadButtonClicked(rewindableOnly: Boolean) {
<span class="nc bnc" id="L73" title="All 2 branches missed.">        if (rewindableOnly) {</span>
<span class="nc" id="L74">            tracker.track(Stat.JETPACK_BACKUP_DOWNLOAD_FILE_NOTICE_DOWNLOAD_TAPPED)</span>
        } else {
<span class="nc" id="L76">            tracker.track(Stat.ACTIVITY_LOG_DOWNLOAD_FILE_NOTICE_DOWNLOAD_TAPPED)</span>
        }
<span class="nc" id="L78">    }</span>

    fun trackDownloadBackupDismissButtonClicked(rewindableOnly: Boolean) {
<span class="nc bnc" id="L81" title="All 2 branches missed.">        if (rewindableOnly) {</span>
<span class="nc" id="L82">            tracker.track(Stat.JETPACK_BACKUP_DOWNLOAD_FILE_NOTICE_DISMISSED_TAPPED)</span>
        } else {
<span class="nc" id="L84">            tracker.track(Stat.ACTIVITY_LOG_DOWNLOAD_FILE_NOTICE_DISMISSED_TAPPED)</span>
        }
<span class="nc" id="L86">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span>Generated by the Android Gradle plugin 7.1.1</div></body></html>