<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AppPrefs.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">wordpressJalapenoDebug</a> &gt; <a href="index.source.html" class="el_package">org.wordpress.android.ui.prefs</a> &gt; <span class="el_source">AppPrefs.java</span></div><h1>AppPrefs.java</h1><pre class="source lang-java linenums">package org.wordpress.android.ui.prefs;

import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.preference.PreferenceManager;
import android.text.TextUtils;

import androidx.annotation.NonNull;
import androidx.annotation.Nullable;

import com.google.gson.Gson;

import org.wordpress.android.WordPress;
import org.wordpress.android.analytics.AnalyticsTracker;
import org.wordpress.android.analytics.AnalyticsTracker.Stat;
import org.wordpress.android.fluxc.model.JetpackCapability;
import org.wordpress.android.fluxc.model.PostModel;
import org.wordpress.android.fluxc.store.QuickStartStore.QuickStartTask;
import org.wordpress.android.models.PeopleListFilter;
import org.wordpress.android.models.ReaderTag;
import org.wordpress.android.models.ReaderTagType;
import org.wordpress.android.ui.ActivityId;
import org.wordpress.android.ui.mysite.SelectedSiteRepository;
import org.wordpress.android.ui.mysite.tabs.MySiteTabType;
import org.wordpress.android.ui.posts.AuthorFilterSelection;
import org.wordpress.android.ui.posts.PostListViewLayoutType;
import org.wordpress.android.ui.quickstart.QuickStartType;
import org.wordpress.android.ui.quickstart.QuickStartType.NewSiteQuickStartType;
import org.wordpress.android.ui.reader.tracker.ReaderTab;
import org.wordpress.android.ui.reader.utils.ReaderUtils;
import org.wordpress.android.util.StringUtils;
import org.wordpress.android.util.WPMediaUtils;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Date;
import java.util.HashSet;
import java.util.List;
import java.util.Map;
import java.util.Set;

<span class="nc" id="L42">public class AppPrefs {</span>
    public static final int SELECTED_SITE_UNAVAILABLE = -1;

    private static final int THEME_IMAGE_SIZE_WIDTH_DEFAULT = 400;
    private static final int MAX_PENDING_DRAFTS_AMOUNT = 100;

    // store twice as many recent sites as we show
    private static final int MAX_RECENTLY_PICKED_SITES_TO_SHOW = 5;
    private static final int MAX_RECENTLY_PICKED_SITES_TO_SAVE = MAX_RECENTLY_PICKED_SITES_TO_SHOW * 2;

<span class="fc" id="L52">    private static final Gson GSON = new Gson();</span>

    public interface PrefKey {
        String name();

        String toString();
    }

    /**
     * Application related preferences. When the user disconnects, these preferences are erased.
     */
<span class="fc" id="L63">    public enum DeletablePrefKey implements PrefKey {</span>
        // name of last shown activity
<span class="fc" id="L65">        LAST_ACTIVITY_STR,</span>

<span class="fc" id="L67">        READER_TAGS_UPDATE_TIMESTAMP,</span>
        // last selected tag in the reader
<span class="fc" id="L69">        READER_TAG_NAME,</span>
<span class="fc" id="L70">        READER_TAG_TYPE,</span>
<span class="fc" id="L71">        READER_TAG_WAS_FOLLOWING,</span>

        // currently active tab on the main Reader screen when the user is in Reader
<span class="fc" id="L74">        READER_ACTIVE_TAB,</span>

        // last selected subfilter in the reader
<span class="fc" id="L77">        READER_SUBFILTER,</span>

        // title of the last active page in ReaderSubsActivity
<span class="fc" id="L80">        READER_SUBS_PAGE_TITLE,</span>

        // index of the last active page in main activity
<span class="fc" id="L83">        MAIN_PAGE_INDEX,</span>

        // index of the last active item in Stats activity
<span class="fc" id="L86">        STATS_ITEM_INDEX,</span>

        // Keep the associations between each widget_id/blog_id added to the app
<span class="fc" id="L89">        STATS_WIDGET_KEYS_BLOGS,</span>

        // last data stored for the Stats Widgets
<span class="fc" id="L92">        STATS_WIDGET_DATA,</span>

        // Store the number of times Stats are loaded without errors. It's used to show the Widget promo dialog.
<span class="fc" id="L95">        STATS_WIDGET_PROMO_ANALYTICS,</span>

        // index of the last active people list filter in People Management activity
<span class="fc" id="L98">        PEOPLE_LIST_FILTER_INDEX,</span>

        // selected site in the main activity
<span class="fc" id="L101">        SELECTED_SITE_LOCAL_ID,</span>

        // wpcom ID of the last push notification received
<span class="fc" id="L104">        PUSH_NOTIFICATIONS_LAST_NOTE_ID,</span>

        // local time of the last push notification received
<span class="fc" id="L107">        PUSH_NOTIFICATIONS_LAST_NOTE_TIME,</span>

        // local IDs of sites recently chosen in the site picker
<span class="fc" id="L110">        RECENTLY_PICKED_SITE_IDS,</span>

        // list of last time a notification has been created for a draft
<span class="fc" id="L113">        PENDING_DRAFTS_NOTIFICATION_LAST_NOTIFICATION_DATES,</span>

        // Optimize Image and Video settings
<span class="fc" id="L116">        IMAGE_OPTIMIZE_ENABLED,</span>
<span class="fc" id="L117">        IMAGE_OPTIMIZE_WIDTH,</span>
<span class="fc" id="L118">        IMAGE_OPTIMIZE_QUALITY,</span>
<span class="fc" id="L119">        VIDEO_OPTIMIZE_ENABLED,</span>
<span class="fc" id="L120">        VIDEO_OPTIMIZE_WIDTH,</span>
<span class="fc" id="L121">        VIDEO_OPTIMIZE_QUALITY, // Encoder max bitrate</span>

        // Used to flag whether the app should strip geolocation from images
<span class="fc" id="L124">        STRIP_IMAGE_LOCATION,</span>

        // Used to flag the account created stat needs to be bumped after account information is synced.
<span class="fc" id="L127">        SHOULD_TRACK_MAGIC_LINK_SIGNUP,</span>

        // Support email address and name that's independent of any account or site
<span class="fc" id="L130">        SUPPORT_EMAIL,</span>
<span class="fc" id="L131">        SUPPORT_NAME,</span>

<span class="fc" id="L133">        AVATAR_VERSION,</span>
<span class="fc" id="L134">        GUTENBERG_DEFAULT_FOR_NEW_POSTS,</span>
<span class="fc" id="L135">        USER_IN_GUTENBERG_ROLLOUT_GROUP,</span>
<span class="fc" id="L136">        SHOULD_AUTO_ENABLE_GUTENBERG_FOR_THE_NEW_POSTS,</span>
<span class="fc" id="L137">        SHOULD_AUTO_ENABLE_GUTENBERG_FOR_THE_NEW_POSTS_PHASE_2,</span>
<span class="fc" id="L138">        GUTENBERG_OPT_IN_DIALOG_SHOWN,</span>
<span class="fc" id="L139">        GUTENBERG_FOCAL_POINT_PICKER_TOOLTIP_SHOWN,</span>

<span class="fc" id="L141">        IS_QUICK_START_NOTICE_REQUIRED,</span>
<span class="fc" id="L142">        LAST_SKIPPED_QUICK_START_TASK,</span>
<span class="fc" id="L143">        LAST_SELECTED_QUICK_START_TYPE,</span>

<span class="fc" id="L145">        POST_LIST_AUTHOR_FILTER,</span>
<span class="fc" id="L146">        POST_LIST_VIEW_LAYOUT_TYPE,</span>

        // Widget settings
<span class="fc" id="L149">        STATS_WIDGET_SELECTED_SITE_ID,</span>
<span class="fc" id="L150">        STATS_WIDGET_COLOR_MODE,</span>
<span class="fc" id="L151">        STATS_WIDGET_DATA_TYPE,</span>
<span class="fc" id="L152">        STATS_WIDGET_HAS_DATA,</span>

        // Keep the local_blog_id + local_post_id values that have HW Acc. turned off
<span class="fc" id="L155">        AZTEC_EDITOR_DISABLE_HW_ACC_KEYS,</span>

        // timestamp of the last update of the reader css styles
<span class="fc" id="L158">        READER_CSS_UPDATED_TIMESTAMP,</span>
        // Identifier of the next page for the discover /cards endpoint
<span class="fc" id="L160">        READER_CARDS_ENDPOINT_PAGE_HANDLE,</span>
        // used to tell the server to return a different set of data so the content on discover tab doesn't look static
<span class="fc" id="L162">        READER_CARDS_ENDPOINT_REFRESH_COUNTER,</span>

        // Used to delete recommended tags saved as followed tags in tbl_tags
        // Need to be done just once for a logged out user
<span class="fc" id="L166">        READER_RECOMMENDED_TAGS_DELETED_FOR_LOGGED_OUT_USER,</span>

<span class="fc" id="L168">        READER_DISCOVER_WELCOME_BANNER_SHOWN,</span>
<span class="fc" id="L169">        MANUAL_FEATURE_CONFIG,</span>
<span class="fc" id="L170">        SITE_JETPACK_CAPABILITIES,</span>
<span class="fc" id="L171">        REMOVED_QUICK_START_CARD_TYPE,</span>
<span class="fc" id="L172">        PINNED_DYNAMIC_CARD,</span>
<span class="fc" id="L173">        BLOGGING_REMINDERS_SHOWN,</span>
<span class="fc" id="L174">        SHOULD_SCHEDULE_CREATE_SITE_NOTIFICATION,</span>
<span class="fc" id="L175">        SHOULD_SHOW_WEEKLY_ROUNDUP_NOTIFICATION,</span>

        // Used to indicate if the variant has been assigned for the My Site Tab experiment
<span class="fc" id="L178">        MY_SITE_DEFAULT_TAB_EXPERIMENT_VARIANT_ASSIGNED,</span>

<span class="fc" id="L180">        SKIPPED_BLOGGING_PROMPT_DAY,</span>
    }

    /**
     * These preferences won't be deleted when the user disconnects. They should be used for device specifics or user
     * independent prefs.
     */
<span class="fc" id="L187">    public enum UndeletablePrefKey implements PrefKey {</span>
        // Theme image size retrieval
<span class="fc" id="L189">        THEME_IMAGE_SIZE_WIDTH,</span>

        // index of the last app-version
<span class="fc" id="L192">        LAST_APP_VERSION_INDEX,</span>

        // aztec editor enabled
<span class="fc" id="L195">        AZTEC_EDITOR_ENABLED,</span>

        // aztec editor toolbar expanded state
<span class="fc" id="L198">        AZTEC_EDITOR_TOOLBAR_EXPANDED,</span>

<span class="fc" id="L200">        BOOKMARKS_SAVED_LOCALLY_DIALOG_SHOWN,</span>

        // When we need to show the new image optimize promo dialog
<span class="fc" id="L203">        IMAGE_OPTIMIZE_PROMO_REQUIRED,</span>

        // Global plans features
<span class="fc" id="L206">        GLOBAL_PLANS_PLANS_FEATURES,</span>

        // When we need to sync IAP data with the wpcom backend
<span class="fc" id="L209">        IAP_SYNC_REQUIRED,</span>

        // When we need to show the snackbar indicating how notifications can be navigated through
<span class="fc" id="L212">        SWIPE_TO_NAVIGATE_NOTIFICATIONS,</span>

        // Same as above but for the reader
<span class="fc" id="L215">        SWIPE_TO_NAVIGATE_READER,</span>

        // smart toast counters
<span class="fc" id="L218">        SMART_TOAST_COMMENTS_LONG_PRESS_USAGE_COUNTER,</span>
<span class="fc" id="L219">        SMART_TOAST_COMMENTS_LONG_PRESS_TOAST_COUNTER,</span>

        // permission keys - set once a specific permission has been asked, regardless of response
<span class="fc" id="L222">        ASKED_PERMISSION_STORAGE_WRITE,</span>
<span class="fc" id="L223">        ASKED_PERMISSION_STORAGE_READ,</span>
<span class="fc" id="L224">        ASKED_PERMISSION_CAMERA,</span>

        // Updated after WP.com themes have been fetched
<span class="fc" id="L227">        LAST_WP_COM_THEMES_SYNC,</span>

        // user id last used to login with
<span class="fc" id="L230">        LAST_USED_USER_ID,</span>

        // last user access status in reader
<span class="fc" id="L233">        LAST_READER_KNOWN_ACCESS_TOKEN_STATUS,</span>
<span class="fc" id="L234">        LAST_READER_KNOWN_USER_ID,</span>

        // used to indicate that we already obtained and tracked the installation referrer
<span class="fc" id="L237">        IS_INSTALLATION_REFERRER_OBTAINED,</span>

        // used to indicate that user dont want to see the Gutenberg warning dialog anymore
<span class="fc" id="L240">        IS_GUTENBERG_WARNING_DIALOG_DISABLED,</span>

        // used to indicate that user dont want to see the Gutenberg informative dialog anymore
<span class="fc" id="L243">        IS_GUTENBERG_INFORMATIVE_DIALOG_DISABLED,</span>

        // indicates whether the system notifications are enabled for the app
<span class="fc" id="L246">        SYSTEM_NOTIFICATIONS_ENABLED,</span>

        // Used to indicate whether or not the the post-signup interstitial must be shown
<span class="fc" id="L249">        SHOULD_SHOW_POST_SIGNUP_INTERSTITIAL,</span>

        // used to indicate that we do not need to show the main FAB tooltip
<span class="fc" id="L252">        IS_MAIN_FAB_TOOLTIP_DISABLED,</span>

        // version of the last shown feature announcement
<span class="fc" id="L255">        FEATURE_ANNOUNCEMENT_SHOWN_VERSION,</span>

        // last app version code feature announcement was shown for
<span class="fc" id="L258">        LAST_FEATURE_ANNOUNCEMENT_APP_VERSION_CODE,</span>

        // used to indicate that we do not need to show the Post List FAB tooltip
<span class="fc" id="L261">        IS_POST_LIST_FAB_TOOLTIP_DISABLED,</span>

        // Used to indicate whether or not the stories intro screen must be shown
<span class="fc" id="L264">        SHOULD_SHOW_STORIES_INTRO,</span>

        // Used to indicate whether or not the device running out of storage warning should be shown
<span class="fc" id="L267">        SHOULD_SHOW_STORAGE_WARNING,</span>

        // Used to indicate whether or not bookmarked posts pseudo id should be updated after invalid pseudo id fix
        // (Internal Ref:p3hLNG-18u)
<span class="fc" id="L271">        SHOULD_UPDATE_BOOKMARKED_POSTS_PSEUDO_ID,</span>

        // Tracks which block types are considered &quot;new&quot; via impression counts
<span class="fc" id="L274">        GUTENBERG_BLOCK_TYPE_IMPRESSIONS,</span>

        // Used to identify the App Settings for initial screen that is updated when the variant is assigned
<span class="fc" id="L277">        wp_pref_initial_screen,</span>

<span class="fc" id="L279">        STATS_REVAMP2_FEATURE_ANNOUNCEMENT_DISPLAYED</span>
    }

    private static SharedPreferences prefs() {
<span class="fc" id="L283">        return PreferenceManager.getDefaultSharedPreferences(WordPress.getContext());</span>
    }

    private static String getString(PrefKey key) {
<span class="fc" id="L287">        return getString(key, &quot;&quot;);</span>
    }

    private static String getString(PrefKey key, String defaultValue) {
<span class="fc" id="L291">        return prefs().getString(key.name(), defaultValue);</span>
    }

    private static void setString(PrefKey key, String value) {
<span class="fc" id="L295">        SharedPreferences.Editor editor = prefs().edit();</span>
<span class="pc bpc" id="L296" title="1 of 2 branches missed.">        if (TextUtils.isEmpty(value)) {</span>
<span class="nc" id="L297">            editor.remove(key.name());</span>
        } else {
<span class="fc" id="L299">            editor.putString(key.name(), value);</span>
        }
<span class="fc" id="L301">        editor.apply();</span>
<span class="fc" id="L302">    }</span>

    private static long getLong(PrefKey key) {
<span class="nc" id="L305">        return getLong(key, 0);</span>
    }

    private static long getLong(PrefKey key, long defaultValue) {
        try {
<span class="nc" id="L310">            String value = getString(key);</span>
<span class="nc" id="L311">            return Long.parseLong(value);</span>
<span class="nc" id="L312">        } catch (NumberFormatException e) {</span>
<span class="nc" id="L313">            return defaultValue;</span>
        }
    }

    private static void setLong(PrefKey key, long value) {
<span class="nc" id="L318">        setString(key, Long.toString(value));</span>
<span class="nc" id="L319">    }</span>

    private static int getInt(PrefKey key, int def) {
        try {
<span class="fc" id="L323">            String value = getString(key);</span>
<span class="pc bpc" id="L324" title="1 of 2 branches missed.">            if (value.isEmpty()) {</span>
<span class="nc" id="L325">                return def;</span>
            }
<span class="fc" id="L327">            return Integer.parseInt(value);</span>
<span class="nc" id="L328">        } catch (NumberFormatException e) {</span>
<span class="nc" id="L329">            return def;</span>
        }
    }

    public static int getInt(PrefKey key) {
<span class="fc" id="L334">        return getInt(key, 0);</span>
    }

    public static void setInt(PrefKey key, int value) {
<span class="fc" id="L338">        setString(key, Integer.toString(value));</span>
<span class="fc" id="L339">    }</span>

    public static boolean getBoolean(PrefKey key, boolean def) {
<span class="fc" id="L342">        String value = getString(key, Boolean.toString(def));</span>
<span class="fc" id="L343">        return Boolean.parseBoolean(value);</span>
    }

    public static void setBoolean(PrefKey key, boolean value) {
<span class="nc" id="L347">        setString(key, Boolean.toString(value));</span>
<span class="nc" id="L348">    }</span>

    private static void remove(PrefKey key) {
<span class="nc" id="L351">        prefs().edit().remove(key.name()).apply();</span>
<span class="nc" id="L352">    }</span>

    public static boolean keyExists(@NonNull PrefKey key) {
<span class="nc" id="L355">        return prefs().contains(key.name());</span>
    }

    // Exposed methods

    /**
     * remove all user-related preferences
     */
    public static void reset() {
<span class="nc" id="L364">        SharedPreferences.Editor editor = prefs().edit();</span>
<span class="nc bnc" id="L365" title="All 2 branches missed.">        for (DeletablePrefKey key : DeletablePrefKey.values()) {</span>
<span class="nc" id="L366">            editor.remove(key.name());</span>
        }
<span class="nc" id="L368">        editor.apply();</span>
<span class="nc" id="L369">    }</span>

    public static ReaderTag getReaderTag() {
<span class="nc" id="L372">        String tagName = getString(DeletablePrefKey.READER_TAG_NAME);</span>
<span class="nc bnc" id="L373" title="All 2 branches missed.">        if (TextUtils.isEmpty(tagName)) {</span>
<span class="nc" id="L374">            return null;</span>
        }
<span class="nc" id="L376">        int tagType = getInt(DeletablePrefKey.READER_TAG_TYPE);</span>

<span class="nc" id="L378">        boolean wasFollowing = false;</span>

        // The intention here is to check if the `DeletablePrefKey.READER_TAG_WAS_FOLLOWING` key
        // was present at all in the Shared Prefs.
        // We could have it not set for example in cases where user is upgrading from
        // a previous version of the app. In those cases we do not have enough information as of the saved
        // tag was a Following tag or not, so (as with empty `DeletablePrefKey.READER_TAG_NAME`)
        // let's do not use this piece of information.
<span class="nc" id="L386">        String wasFallowingString = getString(DeletablePrefKey.READER_TAG_WAS_FOLLOWING);</span>
<span class="nc bnc" id="L387" title="All 2 branches missed.">        if (TextUtils.isEmpty(wasFallowingString)) return null;</span>

<span class="nc" id="L389">        wasFollowing = getBoolean(DeletablePrefKey.READER_TAG_WAS_FOLLOWING, false);</span>

<span class="nc" id="L391">        return ReaderUtils.getTagFromTagName(tagName, ReaderTagType.fromInt(tagType), wasFollowing);</span>
    }

    public static void setReaderTag(ReaderTag tag) {
<span class="nc bnc" id="L395" title="All 4 branches missed.">        if (tag != null &amp;&amp; !TextUtils.isEmpty(tag.getTagSlug())) {</span>
<span class="nc" id="L396">            setString(DeletablePrefKey.READER_TAG_NAME, tag.getTagSlug());</span>
<span class="nc" id="L397">            setInt(DeletablePrefKey.READER_TAG_TYPE, tag.tagType.toInt());</span>
<span class="nc" id="L398">            setBoolean(</span>
                    DeletablePrefKey.READER_TAG_WAS_FOLLOWING,
<span class="nc bnc" id="L400" title="All 4 branches missed.">                    tag.isFollowedSites() || tag.isDefaultInMemoryTag()</span>
            );
        } else {
<span class="nc" id="L403">            prefs().edit()</span>
<span class="nc" id="L404">                   .remove(DeletablePrefKey.READER_TAG_NAME.name())</span>
<span class="nc" id="L405">                   .remove(DeletablePrefKey.READER_TAG_TYPE.name())</span>
<span class="nc" id="L406">                   .remove(DeletablePrefKey.READER_TAG_WAS_FOLLOWING.name())</span>
<span class="nc" id="L407">                   .apply();</span>
        }
<span class="nc" id="L409">    }</span>

    public static void setReaderActiveTab(ReaderTab readerTab) {
<span class="nc bnc" id="L412" title="All 2 branches missed.">        setInt(DeletablePrefKey.READER_ACTIVE_TAB, readerTab != null ? readerTab.getId() : 0);</span>
<span class="nc" id="L413">    }</span>

    public static ReaderTab getReaderActiveTab() {
<span class="nc" id="L416">        int lastTabId = getInt(DeletablePrefKey.READER_ACTIVE_TAB);</span>
<span class="nc bnc" id="L417" title="All 2 branches missed.">        return lastTabId != 0 ? ReaderTab.Companion.fromId(lastTabId) : null;</span>
    }

    public static String getReaderSubfilter() {
<span class="nc" id="L421">        return getString(DeletablePrefKey.READER_SUBFILTER);</span>
    }

    public static void setReaderSubfilter(@NonNull String json) {
<span class="nc" id="L425">        setString(DeletablePrefKey.READER_SUBFILTER, json);</span>
<span class="nc" id="L426">    }</span>

    /**
     * title of the last active page in ReaderSubsActivity - this is stored rather than
     * the index of the page so we can re-order pages without affecting this value
     */
    public static String getReaderSubsPageTitle() {
<span class="nc" id="L433">        return getString(DeletablePrefKey.READER_SUBS_PAGE_TITLE);</span>
    }

    public static void setReaderSubsPageTitle(String pageTitle) {
<span class="nc" id="L437">        setString(DeletablePrefKey.READER_SUBS_PAGE_TITLE, pageTitle);</span>
<span class="nc" id="L438">    }</span>

    public static PeopleListFilter getPeopleListFilter() {
<span class="nc" id="L441">        int idx = getInt(DeletablePrefKey.PEOPLE_LIST_FILTER_INDEX);</span>
<span class="nc" id="L442">        PeopleListFilter[] values = PeopleListFilter.values();</span>
<span class="nc bnc" id="L443" title="All 2 branches missed.">        if (values.length &lt; idx) {</span>
<span class="nc" id="L444">            return values[0];</span>
        } else {
<span class="nc" id="L446">            return values[idx];</span>
        }
    }

    public static void setPeopleListFilter(PeopleListFilter peopleListFilter) {
<span class="nc bnc" id="L451" title="All 2 branches missed.">        if (peopleListFilter != null) {</span>
<span class="nc" id="L452">            setInt(DeletablePrefKey.PEOPLE_LIST_FILTER_INDEX, peopleListFilter.ordinal());</span>
        } else {
<span class="nc" id="L454">            prefs().edit()</span>
<span class="nc" id="L455">                   .remove(DeletablePrefKey.PEOPLE_LIST_FILTER_INDEX.name())</span>
<span class="nc" id="L456">                   .apply();</span>
        }
<span class="nc" id="L458">    }</span>

    // Store the version code of the app. Used to check it the app was upgraded.
    public static int getLastAppVersionCode() {
<span class="fc" id="L462">        return getInt(UndeletablePrefKey.LAST_APP_VERSION_INDEX);</span>
    }

    public static void setLastAppVersionCode(int versionCode) {
<span class="fc" id="L466">        setInt(UndeletablePrefKey.LAST_APP_VERSION_INDEX, versionCode);</span>
<span class="fc" id="L467">    }</span>

    public static long getLastUsedUserId() {
<span class="nc" id="L470">        return getLong(UndeletablePrefKey.LAST_USED_USER_ID);</span>
    }

    public static void setLastUsedUserId(long userId) {
<span class="nc" id="L474">        setLong(UndeletablePrefKey.LAST_USED_USER_ID, userId);</span>
<span class="nc" id="L475">    }</span>

    public static boolean getLastReaderKnownAccessTokenStatus() {
<span class="nc" id="L478">        return getBoolean(UndeletablePrefKey.LAST_READER_KNOWN_ACCESS_TOKEN_STATUS, false);</span>
    }

    public static void setLastReaderKnownAccessTokenStatus(boolean accessTokenStatus) {
<span class="nc" id="L482">        setBoolean(UndeletablePrefKey.LAST_READER_KNOWN_ACCESS_TOKEN_STATUS, accessTokenStatus);</span>
<span class="nc" id="L483">    }</span>

    public static long getLastReaderKnownUserId() {
<span class="nc" id="L486">        return getLong(UndeletablePrefKey.LAST_READER_KNOWN_USER_ID);</span>
    }

    public static void setLastReaderKnownUserId(long userId) {
<span class="nc" id="L490">        setLong(UndeletablePrefKey.LAST_READER_KNOWN_USER_ID, userId);</span>
<span class="nc" id="L491">    }</span>

    /**
     * name of the last shown activity - used at startup to restore the previously selected
     * activity, also used by analytics tracker
     */
    public static String getLastActivityStr() {
<span class="nc" id="L498">        return getString(DeletablePrefKey.LAST_ACTIVITY_STR, ActivityId.UNKNOWN.name());</span>
    }

    public static void setLastActivityStr(String value) {
<span class="nc" id="L502">        setString(DeletablePrefKey.LAST_ACTIVITY_STR, value);</span>
<span class="nc" id="L503">    }</span>

    public static void resetLastActivityStr() {
<span class="nc" id="L506">        remove(DeletablePrefKey.LAST_ACTIVITY_STR);</span>
<span class="nc" id="L507">    }</span>

    public static int getMainPageIndex(int maxIndexValue) {
<span class="nc" id="L510">        int value = getInt(DeletablePrefKey.MAIN_PAGE_INDEX);</span>
<span class="nc bnc" id="L511" title="All 2 branches missed.">        return value &gt; maxIndexValue ? 0 : value;</span>
    }

    public static void setMainPageIndex(int index) {
<span class="nc" id="L515">        setInt(DeletablePrefKey.MAIN_PAGE_INDEX, index);</span>
<span class="nc" id="L516">    }</span>

    // Stats Widgets
    public static void resetStatsWidgetsKeys() {
<span class="nc" id="L520">        remove(DeletablePrefKey.STATS_WIDGET_KEYS_BLOGS);</span>
<span class="nc" id="L521">    }</span>

    public static String getStatsWidgetsKeys() {
<span class="nc" id="L524">        return getString(DeletablePrefKey.STATS_WIDGET_KEYS_BLOGS);</span>
    }

    public static void setStatsWidgetsKeys(String widgetData) {
<span class="nc" id="L528">        setString(DeletablePrefKey.STATS_WIDGET_KEYS_BLOGS, widgetData);</span>
<span class="nc" id="L529">    }</span>

    public static String getStatsWidgetsData() {
<span class="nc" id="L532">        return getString(DeletablePrefKey.STATS_WIDGET_DATA);</span>
    }

    public static void setStatsWidgetsData(String widgetData) {
<span class="nc" id="L536">        setString(DeletablePrefKey.STATS_WIDGET_DATA, widgetData);</span>
<span class="nc" id="L537">    }</span>

    public static void resetStatsWidgetsData() {
<span class="nc" id="L540">        remove(DeletablePrefKey.STATS_WIDGET_DATA);</span>
<span class="nc" id="L541">    }</span>

    // Themes
    public static void setThemeImageSizeWidth(int width) {
<span class="nc" id="L545">        setInt(UndeletablePrefKey.THEME_IMAGE_SIZE_WIDTH, width);</span>
<span class="nc" id="L546">    }</span>

    public static int getThemeImageSizeWidth() {
<span class="nc" id="L549">        int value = getInt(UndeletablePrefKey.THEME_IMAGE_SIZE_WIDTH);</span>
<span class="nc bnc" id="L550" title="All 2 branches missed.">        if (value == 0) {</span>
<span class="nc" id="L551">            return THEME_IMAGE_SIZE_WIDTH_DEFAULT;</span>
        } else {
<span class="nc" id="L553">            return getInt(UndeletablePrefKey.THEME_IMAGE_SIZE_WIDTH);</span>
        }
    }

    // Aztec Editor
    public static void setAztecEditorEnabled(boolean isEnabled) {
<span class="nc" id="L559">        setBoolean(UndeletablePrefKey.AZTEC_EDITOR_ENABLED, isEnabled);</span>
<span class="nc bnc" id="L560" title="All 2 branches missed.">        AnalyticsTracker.track(isEnabled ? Stat.EDITOR_AZTEC_TOGGLED_ON : Stat.EDITOR_AZTEC_TOGGLED_OFF);</span>
<span class="nc" id="L561">    }</span>

    public static boolean isAztecEditorEnabled() {
        // hardcode Aztec enabled to &quot;true&quot;. It's Aztec and Gutenberg that we're going to expose to the user now.
<span class="nc" id="L565">        return true;</span>
    }

    public static boolean isAztecEditorToolbarExpanded() {
<span class="nc" id="L569">        return getBoolean(UndeletablePrefKey.AZTEC_EDITOR_TOOLBAR_EXPANDED, false);</span>
    }

    public static void setAztecEditorToolbarExpanded(boolean isExpanded) {
<span class="nc" id="L573">        setBoolean(UndeletablePrefKey.AZTEC_EDITOR_TOOLBAR_EXPANDED, isExpanded);</span>
<span class="nc" id="L574">    }</span>

    public static boolean shouldShowBookmarksSavedLocallyDialog() {
<span class="nc" id="L577">        return getBoolean(UndeletablePrefKey.BOOKMARKS_SAVED_LOCALLY_DIALOG_SHOWN, true);</span>
    }

    public static void setBookmarksSavedLocallyDialogShown() {
<span class="nc" id="L581">        setBoolean(UndeletablePrefKey.BOOKMARKS_SAVED_LOCALLY_DIALOG_SHOWN, false);</span>
<span class="nc" id="L582">    }</span>

    public static boolean isImageOptimizePromoRequired() {
<span class="nc" id="L585">        return getBoolean(UndeletablePrefKey.IMAGE_OPTIMIZE_PROMO_REQUIRED, true);</span>
    }

    public static void setImageOptimizePromoRequired(boolean required) {
<span class="nc" id="L589">        setBoolean(UndeletablePrefKey.IMAGE_OPTIMIZE_PROMO_REQUIRED, required);</span>
<span class="nc" id="L590">    }</span>

    // Store the number of times Stats are loaded successfully before showing the Promo Dialog
    public static void bumpAnalyticsForStatsWidgetPromo() {
<span class="nc" id="L594">        int current = getAnalyticsForStatsWidgetPromo();</span>
<span class="nc" id="L595">        setInt(DeletablePrefKey.STATS_WIDGET_PROMO_ANALYTICS, current + 1);</span>
<span class="nc" id="L596">    }</span>

    public static int getAnalyticsForStatsWidgetPromo() {
<span class="nc" id="L599">        return getInt(DeletablePrefKey.STATS_WIDGET_PROMO_ANALYTICS);</span>
    }

    public static boolean isInAppPurchaseRefreshRequired() {
<span class="nc" id="L603">        return getBoolean(UndeletablePrefKey.IAP_SYNC_REQUIRED, false);</span>
    }

    public static void setInAppPurchaseRefreshRequired(boolean required) {
<span class="nc" id="L607">        setBoolean(UndeletablePrefKey.IAP_SYNC_REQUIRED, required);</span>
<span class="nc" id="L608">    }</span>

    /**
     * This method should only be used by specific client classes that need access to the persisted selected site
     * instance due to the fact that the in-memory selected site instance might not be yet available.
     * &lt;p&gt;
     * The source of truth should always be the {@link SelectedSiteRepository} in-memory mechanism and as such access
     * to this method is limited to this class.
     */
    public static int getSelectedSite() {
<span class="fc" id="L618">        return getInt(DeletablePrefKey.SELECTED_SITE_LOCAL_ID, SELECTED_SITE_UNAVAILABLE);</span>
    }

    /**
     * This method should only be used by specific client classes that need to update the persisted selected site
     * instance due to the fact that the in-memory selected site instance is updated as well.
     * &lt;p&gt;
     * The source of truth should always be the {@link SelectedSiteRepository} in-memory mechanism and as such the
     * update method should be limited to this class.
     */
    public static void setSelectedSite(int siteLocalId) {
<span class="nc" id="L629">        setInt(DeletablePrefKey.SELECTED_SITE_LOCAL_ID, siteLocalId);</span>
<span class="nc" id="L630">    }</span>

    public static String getLastPushNotificationWpcomNoteId() {
<span class="nc" id="L633">        return getString(DeletablePrefKey.PUSH_NOTIFICATIONS_LAST_NOTE_ID);</span>
    }

    public static void setLastPushNotificationWpcomNoteId(String noteID) {
<span class="nc" id="L637">        setString(DeletablePrefKey.PUSH_NOTIFICATIONS_LAST_NOTE_ID, noteID);</span>
<span class="nc" id="L638">    }</span>

    public static long getLastPushNotificationTime() {
<span class="nc" id="L641">        return getLong(DeletablePrefKey.PUSH_NOTIFICATIONS_LAST_NOTE_TIME);</span>
    }

    public static void setLastPushNotificationTime(long time) {
<span class="nc" id="L645">        setLong(DeletablePrefKey.PUSH_NOTIFICATIONS_LAST_NOTE_ID, time);</span>
<span class="nc" id="L646">    }</span>

    public static boolean isNotificationsSwipeToNavigateShown() {
<span class="nc" id="L649">        return getBoolean(UndeletablePrefKey.SWIPE_TO_NAVIGATE_NOTIFICATIONS, false);</span>
    }

    public static void setNotificationsSwipeToNavigateShown(boolean alreadyShown) {
<span class="nc" id="L653">        setBoolean(UndeletablePrefKey.SWIPE_TO_NAVIGATE_NOTIFICATIONS, alreadyShown);</span>
<span class="nc" id="L654">    }</span>

    public static boolean isReaderSwipeToNavigateShown() {
<span class="nc" id="L657">        return getBoolean(UndeletablePrefKey.SWIPE_TO_NAVIGATE_READER, false);</span>
    }

    public static void setReaderSwipeToNavigateShown(boolean alreadyShown) {
<span class="nc" id="L661">        setBoolean(UndeletablePrefKey.SWIPE_TO_NAVIGATE_READER, alreadyShown);</span>
<span class="nc" id="L662">    }</span>

    public static long getPendingDraftsLastNotificationDate(PostModel post) {
<span class="nc" id="L665">        String key = DeletablePrefKey.PENDING_DRAFTS_NOTIFICATION_LAST_NOTIFICATION_DATES.name() + &quot;-&quot; + post.getId();</span>
<span class="nc" id="L666">        return prefs().getLong(key, 0);</span>
    }

    public static void setPendingDraftsLastNotificationDate(PostModel post, long timestamp) {
<span class="nc" id="L670">        String key = DeletablePrefKey.PENDING_DRAFTS_NOTIFICATION_LAST_NOTIFICATION_DATES.name() + &quot;-&quot; + post.getId();</span>
<span class="nc" id="L671">        SharedPreferences.Editor editor = prefs().edit();</span>
<span class="nc" id="L672">        editor.putLong(key, timestamp);</span>
<span class="nc" id="L673">        editor.apply();</span>
<span class="nc" id="L674">    }</span>

    public static boolean isImageOptimize() {
<span class="nc" id="L677">        return getBoolean(DeletablePrefKey.IMAGE_OPTIMIZE_ENABLED, false);</span>
    }

    public static void setImageOptimize(boolean optimize) {
<span class="nc" id="L681">        setBoolean(DeletablePrefKey.IMAGE_OPTIMIZE_ENABLED, optimize);</span>
<span class="nc" id="L682">    }</span>

    public static boolean isStripImageLocation() {
<span class="nc" id="L685">        return getBoolean(DeletablePrefKey.STRIP_IMAGE_LOCATION, false);</span>
    }

    public static void setStripImageLocation(boolean stripImageLocation) {
<span class="nc" id="L689">        setBoolean(DeletablePrefKey.STRIP_IMAGE_LOCATION, stripImageLocation);</span>
<span class="nc" id="L690">    }</span>

    public static void setImageOptimizeMaxSize(int width) {
<span class="nc" id="L693">        setInt(DeletablePrefKey.IMAGE_OPTIMIZE_WIDTH, width);</span>
<span class="nc" id="L694">    }</span>

    public static int getImageOptimizeMaxSize() {
<span class="nc" id="L697">        int resizeWidth = getInt(DeletablePrefKey.IMAGE_OPTIMIZE_WIDTH, 0);</span>
<span class="nc bnc" id="L698" title="All 2 branches missed.">        return resizeWidth == 0 ? WPMediaUtils.OPTIMIZE_IMAGE_MAX_SIZE : resizeWidth;</span>
    }

    public static void setImageOptimizeQuality(int quality) {
<span class="nc" id="L702">        setInt(DeletablePrefKey.IMAGE_OPTIMIZE_QUALITY, quality);</span>
<span class="nc" id="L703">    }</span>

    public static int getImageOptimizeQuality() {
<span class="nc" id="L706">        int quality = getInt(DeletablePrefKey.IMAGE_OPTIMIZE_QUALITY, 0);</span>
<span class="nc bnc" id="L707" title="All 2 branches missed.">        return quality &gt; 1 ? quality : WPMediaUtils.OPTIMIZE_IMAGE_ENCODER_QUALITY;</span>
    }

    public static boolean isVideoOptimize() {
<span class="nc" id="L711">        return getBoolean(DeletablePrefKey.VIDEO_OPTIMIZE_ENABLED, false);</span>
    }

    public static void setVideoOptimize(boolean optimize) {
<span class="nc" id="L715">        setBoolean(DeletablePrefKey.VIDEO_OPTIMIZE_ENABLED, optimize);</span>
<span class="nc" id="L716">    }</span>

    public static boolean isGutenbergEditorEnabled() {
        // hardcode Gutenberg enabled to &quot;true&quot;. It's Aztec and Gutenberg that we're going to expose to the user now.
<span class="nc" id="L720">        return true;</span>
    }

    /**
     * @deprecated As of release 13.0, replaced by SiteSettings mobile editor value
     */
    @Deprecated
    public static boolean isGutenbergDefaultForNewPosts() {
<span class="nc" id="L728">        return getBoolean(DeletablePrefKey.GUTENBERG_DEFAULT_FOR_NEW_POSTS, false);</span>
    }

    public static boolean isDefaultAppWideEditorPreferenceSet() {
        // Check if the default editor pref was previously set
<span class="nc bnc" id="L733" title="All 2 branches missed.">        return !&quot;&quot;.equals(getString(DeletablePrefKey.GUTENBERG_DEFAULT_FOR_NEW_POSTS));</span>
    }

    public static boolean isUserInGutenbergRolloutGroup() {
<span class="nc" id="L737">        return getBoolean(DeletablePrefKey.USER_IN_GUTENBERG_ROLLOUT_GROUP, false);</span>
    }

    public static void setUserInGutenbergRolloutGroup() {
<span class="nc" id="L741">        setBoolean(DeletablePrefKey.USER_IN_GUTENBERG_ROLLOUT_GROUP, true);</span>
<span class="nc" id="L742">    }</span>

    public static void removeAppWideEditorPreference() {
<span class="nc" id="L745">        remove(DeletablePrefKey.GUTENBERG_DEFAULT_FOR_NEW_POSTS);</span>
<span class="nc" id="L746">    }</span>

    private static boolean getShowGutenbergInfoPopupForTheNewPosts(PrefKey key, String siteURL) {
<span class="nc bnc" id="L749" title="All 2 branches missed.">        if (TextUtils.isEmpty(siteURL)) {</span>
<span class="nc" id="L750">            return false;</span>
        }

        Set&lt;String&gt; urls;
        try {
<span class="nc" id="L755">            urls = prefs().getStringSet(key.name(), null);</span>
<span class="nc" id="L756">        } catch (ClassCastException exp) {</span>
            // no operation - This should not happen.
<span class="nc" id="L758">            return false;</span>
<span class="nc" id="L759">        }</span>
        // Check if the current site address is available in the set.
<span class="nc" id="L761">        boolean flag = false;</span>
<span class="nc bnc" id="L762" title="All 2 branches missed.">        if (urls != null) {</span>
<span class="nc bnc" id="L763" title="All 2 branches missed.">            if (urls.contains(siteURL)) {</span>
<span class="nc" id="L764">                flag = true;</span>
                // remove the flag from Prefs
<span class="nc" id="L766">                setShowGutenbergInfoPopupForTheNewPosts(key, siteURL, false);</span>
            }
        }

<span class="nc" id="L770">        return flag;</span>
    }

    private static void setShowGutenbergInfoPopupForTheNewPosts(PrefKey key, String siteURL, boolean show) {
<span class="nc bnc" id="L774" title="All 2 branches missed.">        if (TextUtils.isEmpty(siteURL)) {</span>
<span class="nc" id="L775">            return;</span>
        }
        Set&lt;String&gt; urls;
        try {
<span class="nc" id="L779">            urls = prefs().getStringSet(key.name(), null);</span>
<span class="nc" id="L780">        } catch (ClassCastException exp) {</span>
            // nope - this should never happens
<span class="nc" id="L782">            return;</span>
<span class="nc" id="L783">        }</span>

<span class="nc" id="L785">        Set&lt;String&gt; newUrls = new HashSet&lt;&gt;();</span>
        // re-add the old urls here
<span class="nc bnc" id="L787" title="All 2 branches missed.">        if (urls != null) {</span>
<span class="nc" id="L788">            newUrls.addAll(urls);</span>
        }

        // 1. First remove &amp; 2. add if necessary
<span class="nc" id="L792">        newUrls.remove(siteURL);</span>
<span class="nc bnc" id="L793" title="All 2 branches missed.">        if (show) {</span>
<span class="nc" id="L794">            newUrls.add(siteURL);</span>
        }

<span class="nc" id="L797">        SharedPreferences.Editor editor = prefs().edit();</span>
<span class="nc" id="L798">        editor.putStringSet(key.name(), newUrls);</span>
<span class="nc" id="L799">        editor.apply();</span>
<span class="nc" id="L800">    }</span>

    public static boolean shouldShowGutenbergInfoPopupPhase2ForNewPosts(String siteURL) {
<span class="nc" id="L803">        return getShowGutenbergInfoPopupForTheNewPosts(</span>
                DeletablePrefKey.SHOULD_AUTO_ENABLE_GUTENBERG_FOR_THE_NEW_POSTS_PHASE_2, siteURL);
    }

    public static void setShowGutenbergInfoPopupPhase2ForNewPosts(String siteURL, boolean show) {
<span class="nc" id="L808">        setShowGutenbergInfoPopupForTheNewPosts(DeletablePrefKey.SHOULD_AUTO_ENABLE_GUTENBERG_FOR_THE_NEW_POSTS_PHASE_2,</span>
                siteURL, show);
<span class="nc" id="L810">    }</span>

    public static boolean shouldShowGutenbergInfoPopupForTheNewPosts(String siteURL) {
<span class="nc" id="L813">        return getShowGutenbergInfoPopupForTheNewPosts(</span>
                DeletablePrefKey.SHOULD_AUTO_ENABLE_GUTENBERG_FOR_THE_NEW_POSTS, siteURL);
    }

    public static void setShowGutenbergInfoPopupForTheNewPosts(String siteURL, boolean show) {
<span class="nc" id="L818">        setShowGutenbergInfoPopupForTheNewPosts(DeletablePrefKey.SHOULD_AUTO_ENABLE_GUTENBERG_FOR_THE_NEW_POSTS,</span>
                siteURL, show);
<span class="nc" id="L820">    }</span>

    public static boolean isGutenbergInfoPopupDisplayed(String siteURL) {
<span class="nc bnc" id="L823" title="All 2 branches missed.">        if (TextUtils.isEmpty(siteURL)) {</span>
<span class="nc" id="L824">            return false;</span>
        }

        Set&lt;String&gt; urls;
        try {
<span class="nc" id="L829">            urls = prefs().getStringSet(DeletablePrefKey.GUTENBERG_OPT_IN_DIALOG_SHOWN.name(), null);</span>
<span class="nc" id="L830">        } catch (ClassCastException exp) {</span>
            // no operation - This should not happen.
<span class="nc" id="L832">            return false;</span>
<span class="nc" id="L833">        }</span>

<span class="nc bnc" id="L835" title="All 4 branches missed.">        return urls != null &amp;&amp; urls.contains(siteURL);</span>
    }

    public static void setGutenbergInfoPopupDisplayed(String siteURL, boolean isDisplayed) {
<span class="nc bnc" id="L839" title="All 2 branches missed.">        if (isGutenbergInfoPopupDisplayed(siteURL)) {</span>
<span class="nc" id="L840">            return;</span>
        }
<span class="nc bnc" id="L842" title="All 2 branches missed.">        if (TextUtils.isEmpty(siteURL)) {</span>
<span class="nc" id="L843">            return;</span>
        }
        Set&lt;String&gt; urls;
        try {
<span class="nc" id="L847">            urls = prefs().getStringSet(DeletablePrefKey.GUTENBERG_OPT_IN_DIALOG_SHOWN.name(), null);</span>
<span class="nc" id="L848">        } catch (ClassCastException exp) {</span>
            // nope - this should never happens
<span class="nc" id="L850">            return;</span>
<span class="nc" id="L851">        }</span>

<span class="nc" id="L853">        Set&lt;String&gt; newUrls = new HashSet&lt;&gt;();</span>
        // re-add the old urls here
<span class="nc bnc" id="L855" title="All 2 branches missed.">        if (urls != null) {</span>
<span class="nc" id="L856">            newUrls.addAll(urls);</span>
        }
<span class="nc bnc" id="L858" title="All 2 branches missed.">        if (isDisplayed) {</span>
<span class="nc" id="L859">            newUrls.add(siteURL);</span>
        } else {
<span class="nc" id="L861">            newUrls.remove(siteURL);</span>
        }
<span class="nc" id="L863">        SharedPreferences.Editor editor = prefs().edit();</span>
<span class="nc" id="L864">        editor.putStringSet(DeletablePrefKey.GUTENBERG_OPT_IN_DIALOG_SHOWN.name(), newUrls);</span>
<span class="nc" id="L865">        editor.apply();</span>
<span class="nc" id="L866">    }</span>

    public static void setVideoOptimizeWidth(int width) {
<span class="nc" id="L869">        setInt(DeletablePrefKey.VIDEO_OPTIMIZE_WIDTH, width);</span>
<span class="nc" id="L870">    }</span>

    public static int getVideoOptimizeWidth() {
<span class="nc" id="L873">        int resizeWidth = getInt(DeletablePrefKey.VIDEO_OPTIMIZE_WIDTH, 0);</span>
<span class="nc bnc" id="L874" title="All 2 branches missed.">        return resizeWidth == 0 ? WPMediaUtils.OPTIMIZE_VIDEO_MAX_WIDTH : resizeWidth;</span>
    }

    public static void setVideoOptimizeQuality(int quality) {
<span class="nc" id="L878">        setInt(DeletablePrefKey.VIDEO_OPTIMIZE_QUALITY, quality);</span>
<span class="nc" id="L879">    }</span>

    public static int getVideoOptimizeQuality() {
<span class="nc" id="L882">        int quality = getInt(DeletablePrefKey.VIDEO_OPTIMIZE_QUALITY, 0);</span>
<span class="nc bnc" id="L883" title="All 2 branches missed.">        return quality &gt; 1 ? quality : WPMediaUtils.OPTIMIZE_VIDEO_ENCODER_BITRATE_KB;</span>
    }

    public static void setSupportEmail(String email) {
<span class="nc" id="L887">        setString(DeletablePrefKey.SUPPORT_EMAIL, email);</span>
<span class="nc" id="L888">    }</span>

    public static String getSupportEmail() {
<span class="fc" id="L891">        return getString(DeletablePrefKey.SUPPORT_EMAIL);</span>
    }

    public static void removeSupportEmail() {
<span class="nc" id="L895">        remove(DeletablePrefKey.SUPPORT_EMAIL);</span>
<span class="nc" id="L896">    }</span>

    public static void setSupportName(String name) {
<span class="nc" id="L899">        setString(DeletablePrefKey.SUPPORT_NAME, name);</span>
<span class="nc" id="L900">    }</span>

    public static String getSupportName() {
<span class="fc" id="L903">        return getString(DeletablePrefKey.SUPPORT_NAME);</span>
    }

    public static void removeSupportName() {
<span class="nc" id="L907">        remove(DeletablePrefKey.SUPPORT_NAME);</span>
<span class="nc" id="L908">    }</span>

    public static void setGutenbergFocalPointPickerTooltipShown(boolean tooltipShown) {
<span class="nc" id="L911">        setBoolean(DeletablePrefKey.GUTENBERG_FOCAL_POINT_PICKER_TOOLTIP_SHOWN, tooltipShown);</span>
<span class="nc" id="L912">    }</span>

    public static boolean getGutenbergFocalPointPickerTooltipShown() {
<span class="nc" id="L915">        return getBoolean(DeletablePrefKey.GUTENBERG_FOCAL_POINT_PICKER_TOOLTIP_SHOWN, false);</span>
    }

    public static void setGutenbergBlockTypeImpressions(Map&lt;String, Double&gt; newImpressions) {
<span class="nc" id="L919">        String json = GSON.toJson(newImpressions);</span>
<span class="nc" id="L920">        setString(UndeletablePrefKey.GUTENBERG_BLOCK_TYPE_IMPRESSIONS, json);</span>
<span class="nc" id="L921">    }</span>

    public static Map&lt;String, Double&gt; getGutenbergBlockTypeImpressions() {
<span class="nc" id="L924">        String jsonString = getString(UndeletablePrefKey.GUTENBERG_BLOCK_TYPE_IMPRESSIONS, &quot;[]&quot;);</span>
<span class="nc" id="L925">        Map&lt;String, Double&gt; impressions = GSON.fromJson(jsonString, Map.class);</span>
<span class="nc" id="L926">        return impressions;</span>
    }

    /*
     * returns a list of local IDs of sites recently chosen in the site picker
     */
    public static ArrayList&lt;Integer&gt; getRecentlyPickedSiteIds() {
<span class="nc" id="L933">        return getRecentlyPickedSiteIds(MAX_RECENTLY_PICKED_SITES_TO_SHOW);</span>
    }

    private static ArrayList&lt;Integer&gt; getRecentlyPickedSiteIds(int limit) {
<span class="nc" id="L937">        String idsAsString = getString(DeletablePrefKey.RECENTLY_PICKED_SITE_IDS, &quot;&quot;);</span>
<span class="nc" id="L938">        String[] items = idsAsString.split(&quot;,&quot;);</span>

<span class="nc" id="L940">        ArrayList&lt;Integer&gt; siteIds = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L941" title="All 2 branches missed.">        for (String item : items) {</span>
<span class="nc" id="L942">            siteIds.add(StringUtils.stringToInt(item));</span>
<span class="nc bnc" id="L943" title="All 2 branches missed.">            if (siteIds.size() == limit) {</span>
<span class="nc" id="L944">                break;</span>
            }
        }

<span class="nc" id="L948">        return siteIds;</span>
    }

    /*
     * adds a local site ID to the top of list of recently chosen sites
     */
    public static void addRecentlyPickedSiteId(Integer localId) {
<span class="nc bnc" id="L955" title="All 2 branches missed.">        if (localId == 0) {</span>
<span class="nc" id="L956">            return;</span>
        }

<span class="nc" id="L959">        ArrayList&lt;Integer&gt; currentIds = getRecentlyPickedSiteIds(MAX_RECENTLY_PICKED_SITES_TO_SAVE);</span>

        // remove this ID if it already exists in the list
<span class="nc" id="L962">        int index = currentIds.indexOf(localId);</span>
<span class="nc bnc" id="L963" title="All 2 branches missed.">        if (index &gt; -1) {</span>
<span class="nc" id="L964">            currentIds.remove(index);</span>
        }

        // add this ID to the front of the list
<span class="nc" id="L968">        currentIds.add(0, localId);</span>

        // remove at max
<span class="nc bnc" id="L971" title="All 2 branches missed.">        if (currentIds.size() &gt; MAX_RECENTLY_PICKED_SITES_TO_SAVE) {</span>
<span class="nc" id="L972">            currentIds.remove(MAX_RECENTLY_PICKED_SITES_TO_SAVE);</span>
        }

        // store in prefs
<span class="nc" id="L976">        String idsAsString = TextUtils.join(&quot;,&quot;, currentIds);</span>
<span class="nc" id="L977">        setString(DeletablePrefKey.RECENTLY_PICKED_SITE_IDS, idsAsString);</span>
<span class="nc" id="L978">    }</span>

    public static void removeRecentlyPickedSiteId(Integer localId) {
<span class="nc" id="L981">        ArrayList&lt;Integer&gt; currentIds = getRecentlyPickedSiteIds(MAX_RECENTLY_PICKED_SITES_TO_SAVE);</span>

<span class="nc" id="L983">        int index = currentIds.indexOf(localId);</span>
<span class="nc bnc" id="L984" title="All 2 branches missed.">        if (index &gt; -1) {</span>
<span class="nc" id="L985">            currentIds.remove(index);</span>
<span class="nc" id="L986">            String idsAsString = TextUtils.join(&quot;,&quot;, currentIds);</span>
<span class="nc" id="L987">            setString(DeletablePrefKey.RECENTLY_PICKED_SITE_IDS, idsAsString);</span>
        }
<span class="nc" id="L989">    }</span>

    public static long getLastWpComThemeSync() {
<span class="nc" id="L992">        return getLong(UndeletablePrefKey.LAST_WP_COM_THEMES_SYNC);</span>
    }

    public static void setLastWpComThemeSync(long time) {
<span class="nc" id="L996">        setLong(UndeletablePrefKey.LAST_WP_COM_THEMES_SYNC, time);</span>
<span class="nc" id="L997">    }</span>

    public static void setShouldTrackMagicLinkSignup(Boolean shouldTrack) {
<span class="nc" id="L1000">        setBoolean(DeletablePrefKey.SHOULD_TRACK_MAGIC_LINK_SIGNUP, shouldTrack);</span>
<span class="nc" id="L1001">    }</span>

    public static boolean getShouldTrackMagicLinkSignup() {
<span class="nc" id="L1004">        return getBoolean(DeletablePrefKey.SHOULD_TRACK_MAGIC_LINK_SIGNUP, false);</span>
    }

    public static void removeShouldTrackMagicLinkSignup() {
<span class="nc" id="L1008">        remove(DeletablePrefKey.SHOULD_TRACK_MAGIC_LINK_SIGNUP);</span>
<span class="nc" id="L1009">    }</span>

    public static void setMainFabTooltipDisabled(Boolean disable) {
<span class="nc" id="L1012">        setBoolean(UndeletablePrefKey.IS_MAIN_FAB_TOOLTIP_DISABLED, disable);</span>
<span class="nc" id="L1013">    }</span>

    public static boolean isMainFabTooltipDisabled() {
<span class="nc" id="L1016">        return getBoolean(UndeletablePrefKey.IS_MAIN_FAB_TOOLTIP_DISABLED, false);</span>
    }

    public static void setPostListFabTooltipDisabled(Boolean disable) {
<span class="nc" id="L1020">        setBoolean(UndeletablePrefKey.IS_MAIN_FAB_TOOLTIP_DISABLED, disable);</span>
<span class="nc" id="L1021">    }</span>

    public static boolean isPostListFabTooltipDisabled() {
<span class="nc" id="L1024">        return getBoolean(UndeletablePrefKey.IS_MAIN_FAB_TOOLTIP_DISABLED, false);</span>
    }

    public static void setQuickStartNoticeRequired(Boolean shown) {
<span class="nc" id="L1028">        setBoolean(DeletablePrefKey.IS_QUICK_START_NOTICE_REQUIRED, shown);</span>
<span class="nc" id="L1029">    }</span>

    public static boolean isQuickStartNoticeRequired() {
<span class="nc" id="L1032">        return getBoolean(DeletablePrefKey.IS_QUICK_START_NOTICE_REQUIRED, false);</span>
    }

    public static void setInstallationReferrerObtained(Boolean isObtained) {
<span class="nc" id="L1036">        setBoolean(UndeletablePrefKey.IS_INSTALLATION_REFERRER_OBTAINED, isObtained);</span>
<span class="nc" id="L1037">    }</span>

    public static boolean isInstallationReferrerObtained() {
<span class="nc" id="L1040">        return getBoolean(UndeletablePrefKey.IS_INSTALLATION_REFERRER_OBTAINED, false);</span>
    }

    public static int getAvatarVersion() {
<span class="nc" id="L1044">        return getInt(DeletablePrefKey.AVATAR_VERSION, 0);</span>
    }

    public static void setAvatarVersion(int version) {
<span class="nc" id="L1048">        setInt(DeletablePrefKey.AVATAR_VERSION, version);</span>
<span class="nc" id="L1049">    }</span>

    @NonNull public static AuthorFilterSelection getAuthorFilterSelection() {
<span class="nc" id="L1052">        long id = getLong(DeletablePrefKey.POST_LIST_AUTHOR_FILTER, AuthorFilterSelection.getDefaultValue().getId());</span>
<span class="nc" id="L1053">        return AuthorFilterSelection.fromId(id);</span>
    }

    public static void setAuthorFilterSelection(@NonNull AuthorFilterSelection selection) {
<span class="nc" id="L1057">        setLong(DeletablePrefKey.POST_LIST_AUTHOR_FILTER, selection.getId());</span>
<span class="nc" id="L1058">    }</span>

    @NonNull public static PostListViewLayoutType getPostsListViewLayoutType() {
<span class="nc" id="L1061">        long id = getLong(DeletablePrefKey.POST_LIST_VIEW_LAYOUT_TYPE,</span>
<span class="nc" id="L1062">                PostListViewLayoutType.getDefaultValue().getId());</span>
<span class="nc" id="L1063">        return PostListViewLayoutType.fromId(id);</span>
    }

    public static void setPostsListViewLayoutType(@NonNull PostListViewLayoutType type) {
<span class="nc" id="L1067">        setLong(DeletablePrefKey.POST_LIST_VIEW_LAYOUT_TYPE, type.getId());</span>
<span class="nc" id="L1068">    }</span>

    public static void setStatsWidgetSelectedSiteId(long siteId, int appWidgetId) {
<span class="nc" id="L1071">        prefs().edit().putLong(getSiteIdWidgetKey(appWidgetId), siteId).apply();</span>
<span class="nc" id="L1072">    }</span>

    public static long getStatsWidgetSelectedSiteId(int appWidgetId) {
<span class="nc" id="L1075">        return prefs().getLong(getSiteIdWidgetKey(appWidgetId), -1);</span>
    }

    public static void removeStatsWidgetSelectedSiteId(int appWidgetId) {
<span class="nc" id="L1079">        prefs().edit().remove(getSiteIdWidgetKey(appWidgetId)).apply();</span>
<span class="nc" id="L1080">    }</span>

    @NonNull private static String getSiteIdWidgetKey(int appWidgetId) {
<span class="nc" id="L1083">        return DeletablePrefKey.STATS_WIDGET_SELECTED_SITE_ID.name() + appWidgetId;</span>
    }

    public static void setStatsWidgetColorModeId(int colorModeId, int appWidgetId) {
<span class="nc" id="L1087">        prefs().edit().putInt(getColorModeIdWidgetKey(appWidgetId), colorModeId).apply();</span>
<span class="nc" id="L1088">    }</span>

    public static int getStatsWidgetColorModeId(int appWidgetId) {
<span class="nc" id="L1091">        return prefs().getInt(getColorModeIdWidgetKey(appWidgetId), -1);</span>
    }

    public static void removeStatsWidgetColorModeId(int appWidgetId) {
<span class="nc" id="L1095">        prefs().edit().remove(getColorModeIdWidgetKey(appWidgetId)).apply();</span>
<span class="nc" id="L1096">    }</span>

    @NonNull private static String getColorModeIdWidgetKey(int appWidgetId) {
<span class="nc" id="L1099">        return DeletablePrefKey.STATS_WIDGET_COLOR_MODE.name() + appWidgetId;</span>
    }

    public static void setStatsWidgetDataTypeId(int dataTypeId, int appWidgetId) {
<span class="nc" id="L1103">        prefs().edit().putInt(getDataTypeIdWidgetKey(appWidgetId), dataTypeId).apply();</span>
<span class="nc" id="L1104">    }</span>

    public static int getStatsWidgetDataTypeId(int appWidgetId) {
<span class="nc" id="L1107">        return prefs().getInt(getDataTypeIdWidgetKey(appWidgetId), -1);</span>
    }

    public static void removeStatsWidgetDataTypeId(int appWidgetId) {
<span class="nc" id="L1111">        prefs().edit().remove(getDataTypeIdWidgetKey(appWidgetId)).apply();</span>
<span class="nc" id="L1112">    }</span>

    @NonNull private static String getDataTypeIdWidgetKey(int appWidgetId) {
<span class="nc" id="L1115">        return DeletablePrefKey.STATS_WIDGET_DATA_TYPE.name() + appWidgetId;</span>
    }

    public static void setStatsWidgetHasData(boolean hasData, int appWidgetId) {
<span class="nc" id="L1119">        prefs().edit().putBoolean(getHasDataWidgetKey(appWidgetId), hasData).apply();</span>
<span class="nc" id="L1120">    }</span>

    public static boolean getStatsWidgetHasData(int appWidgetId) {
<span class="nc" id="L1123">        return prefs().getBoolean(getHasDataWidgetKey(appWidgetId), false);</span>
    }

    public static void removeStatsWidgetHasData(int appWidgetId) {
<span class="nc" id="L1127">        prefs().edit().remove(getHasDataWidgetKey(appWidgetId)).apply();</span>
<span class="nc" id="L1128">    }</span>

    @NonNull private static String getHasDataWidgetKey(int appWidgetId) {
<span class="nc" id="L1131">        return DeletablePrefKey.STATS_WIDGET_HAS_DATA.name() + appWidgetId;</span>
    }

    public static void setSystemNotificationsEnabled(boolean enabled) {
<span class="nc" id="L1135">        setBoolean(UndeletablePrefKey.SYSTEM_NOTIFICATIONS_ENABLED, enabled);</span>
<span class="nc" id="L1136">    }</span>

    public static boolean getSystemNotificationsEnabled() {
<span class="fc" id="L1139">        return getBoolean(UndeletablePrefKey.SYSTEM_NOTIFICATIONS_ENABLED, true);</span>
    }

    public static void setShouldShowPostSignupInterstitial(boolean shouldShow) {
<span class="nc" id="L1143">        setBoolean(UndeletablePrefKey.SHOULD_SHOW_POST_SIGNUP_INTERSTITIAL, shouldShow);</span>
<span class="nc" id="L1144">    }</span>

    public static boolean shouldShowPostSignupInterstitial() {
<span class="nc" id="L1147">        return getBoolean(UndeletablePrefKey.SHOULD_SHOW_POST_SIGNUP_INTERSTITIAL, true);</span>
    }

    private static List&lt;String&gt; getPostWithHWAccelerationOff() {
<span class="nc" id="L1151">        String idsAsString = getString(DeletablePrefKey.AZTEC_EDITOR_DISABLE_HW_ACC_KEYS, &quot;&quot;);</span>
<span class="nc" id="L1152">        return Arrays.asList(idsAsString.split(&quot;,&quot;));</span>
    }

    public static void setFeatureAnnouncementShownVersion(int version) {
<span class="nc" id="L1156">        setInt(UndeletablePrefKey.FEATURE_ANNOUNCEMENT_SHOWN_VERSION, version);</span>
<span class="nc" id="L1157">    }</span>

    public static int getFeatureAnnouncementShownVersion() {
<span class="nc" id="L1160">        return getInt(UndeletablePrefKey.FEATURE_ANNOUNCEMENT_SHOWN_VERSION, -1);</span>
    }

    public static int getLastFeatureAnnouncementAppVersionCode() {
<span class="nc" id="L1164">        return getInt(UndeletablePrefKey.LAST_FEATURE_ANNOUNCEMENT_APP_VERSION_CODE);</span>
    }

    public static void setLastFeatureAnnouncementAppVersionCode(int version) {
<span class="nc" id="L1168">        setInt(UndeletablePrefKey.LAST_FEATURE_ANNOUNCEMENT_APP_VERSION_CODE, version);</span>
<span class="nc" id="L1169">    }</span>

    public static long getReaderTagsUpdatedTimestamp() {
<span class="nc" id="L1172">        return getLong(DeletablePrefKey.READER_TAGS_UPDATE_TIMESTAMP, -1);</span>
    }

    public static void setReaderTagsUpdatedTimestamp(long timestamp) {
<span class="nc" id="L1176">        setLong(DeletablePrefKey.READER_TAGS_UPDATE_TIMESTAMP, timestamp);</span>
<span class="nc" id="L1177">    }</span>

    public static long getReaderCssUpdatedTimestamp() {
<span class="nc" id="L1180">        return getLong(DeletablePrefKey.READER_CSS_UPDATED_TIMESTAMP, 0);</span>
    }

    public static void setReaderCssUpdatedTimestamp(long timestamp) {
<span class="nc" id="L1184">        setLong(DeletablePrefKey.READER_CSS_UPDATED_TIMESTAMP, timestamp);</span>
<span class="nc" id="L1185">    }</span>

    public static String getReaderCardsPageHandle() {
<span class="nc" id="L1188">        return getString(DeletablePrefKey.READER_CARDS_ENDPOINT_PAGE_HANDLE, null);</span>
    }

    public static void setReaderCardsPageHandle(String pageHandle) {
<span class="nc" id="L1192">        setString(DeletablePrefKey.READER_CARDS_ENDPOINT_PAGE_HANDLE, pageHandle);</span>
<span class="nc" id="L1193">    }</span>

    public static int getReaderCardsRefreshCounter() {
<span class="nc" id="L1196">        return getInt(DeletablePrefKey.READER_CARDS_ENDPOINT_REFRESH_COUNTER, 0);</span>
    }

    public static void incrementReaderCardsRefreshCounter() {
<span class="nc" id="L1200">        setInt(DeletablePrefKey.READER_CARDS_ENDPOINT_REFRESH_COUNTER, getReaderCardsRefreshCounter() + 1);</span>
<span class="nc" id="L1201">    }</span>

    public static boolean getReaderRecommendedTagsDeletedForLoggedOutUser() {
<span class="nc" id="L1204">        return getBoolean(DeletablePrefKey.READER_RECOMMENDED_TAGS_DELETED_FOR_LOGGED_OUT_USER, false);</span>
    }

    public static void setReaderRecommendedTagsDeletedForLoggedOutUser(boolean deleted) {
<span class="nc" id="L1208">        setBoolean(DeletablePrefKey.READER_RECOMMENDED_TAGS_DELETED_FOR_LOGGED_OUT_USER, deleted);</span>
<span class="nc" id="L1209">    }</span>

    public static boolean getReaderDiscoverWelcomeBannerShown() {
<span class="nc" id="L1212">        return getBoolean(DeletablePrefKey.READER_DISCOVER_WELCOME_BANNER_SHOWN, false);</span>
    }

    public static void setReaderDiscoverWelcomeBannerShown(boolean shown) {
<span class="nc" id="L1216">        setBoolean(DeletablePrefKey.READER_DISCOVER_WELCOME_BANNER_SHOWN, shown);</span>
<span class="nc" id="L1217">    }</span>

    public static void setShouldShowStoriesIntro(boolean shouldShow) {
<span class="nc" id="L1220">        setBoolean(UndeletablePrefKey.SHOULD_SHOW_STORIES_INTRO, shouldShow);</span>
<span class="nc" id="L1221">    }</span>

    public static boolean shouldShowStoriesIntro() {
<span class="nc" id="L1224">        return getBoolean(UndeletablePrefKey.SHOULD_SHOW_STORIES_INTRO, true);</span>
    }

    public static void setShouldShowStorageWarning(boolean shouldShow) {
<span class="nc" id="L1228">        setBoolean(UndeletablePrefKey.SHOULD_SHOW_STORAGE_WARNING, shouldShow);</span>
<span class="nc" id="L1229">    }</span>

    public static boolean shouldShowStorageWarning() {
<span class="nc" id="L1232">        return getBoolean(UndeletablePrefKey.SHOULD_SHOW_STORAGE_WARNING, true);</span>
    }

    public static void setBookmarkPostsPseudoIdsUpdated() {
<span class="nc" id="L1236">        setBoolean(UndeletablePrefKey.SHOULD_UPDATE_BOOKMARKED_POSTS_PSEUDO_ID, false);</span>
<span class="nc" id="L1237">    }</span>

    public static boolean shouldUpdateBookmarkPostsPseudoIds(ReaderTag tag) {
<span class="nc bnc" id="L1240" title="All 2 branches missed.">        return tag != null</span>
<span class="nc bnc" id="L1241" title="All 2 branches missed.">               &amp;&amp; tag.getTagSlug().equals(ReaderUtils.sanitizeWithDashes(ReaderTag.TAG_TITLE_FOLLOWED_SITES))</span>
<span class="nc bnc" id="L1242" title="All 2 branches missed.">               &amp;&amp; getBoolean(UndeletablePrefKey.SHOULD_UPDATE_BOOKMARKED_POSTS_PSEUDO_ID, true);</span>
    }

    public static QuickStartTask getLastSkippedQuickStartTask(QuickStartType quickStartType) {
<span class="nc" id="L1246">        String taskName = getString(DeletablePrefKey.LAST_SKIPPED_QUICK_START_TASK);</span>
<span class="nc bnc" id="L1247" title="All 2 branches missed.">        if (TextUtils.isEmpty(taskName)) {</span>
<span class="nc" id="L1248">            return null;</span>
        }
<span class="nc" id="L1250">        return quickStartType.getTaskFromString(taskName);</span>
    }

    public static void setLastSkippedQuickStartTask(@Nullable QuickStartTask task) {
<span class="nc bnc" id="L1254" title="All 2 branches missed.">        if (task == null) {</span>
<span class="nc" id="L1255">            remove(DeletablePrefKey.LAST_SKIPPED_QUICK_START_TASK);</span>
<span class="nc" id="L1256">            return;</span>
        }
<span class="nc" id="L1258">        setString(DeletablePrefKey.LAST_SKIPPED_QUICK_START_TASK, task.toString());</span>
<span class="nc" id="L1259">    }</span>

    public static void setLastSelectedQuickStartTypeForSite(QuickStartType quickStartType, long siteLocalId) {
<span class="nc" id="L1262">        Editor editor = prefs().edit();</span>
<span class="nc" id="L1263">        editor.putString(</span>
<span class="nc" id="L1264">                DeletablePrefKey.LAST_SELECTED_QUICK_START_TYPE + String.valueOf(siteLocalId),</span>
<span class="nc" id="L1265">                quickStartType.getLabel()</span>
        );
<span class="nc" id="L1267">        editor.apply();</span>
<span class="nc" id="L1268">    }</span>

    public static QuickStartType getLastSelectedQuickStartTypeForSite(long siteLocalId) {
<span class="nc" id="L1271">        return QuickStartType.Companion.fromLabel(</span>
<span class="nc" id="L1272">                prefs().getString(</span>
<span class="nc" id="L1273">                        DeletablePrefKey.LAST_SELECTED_QUICK_START_TYPE + String.valueOf(siteLocalId),</span>
<span class="nc" id="L1274">                        NewSiteQuickStartType.INSTANCE.getLabel()</span>
                )
        );
    }

    public static void setManualFeatureConfig(boolean isEnabled, String featureKey) {
<span class="nc" id="L1280">        prefs().edit().putBoolean(getManualFeatureConfigKey(featureKey), isEnabled).apply();</span>
<span class="nc" id="L1281">    }</span>

    public static boolean getManualFeatureConfig(String featureKey) {
<span class="nc" id="L1284">        return prefs().getBoolean(getManualFeatureConfigKey(featureKey), false);</span>
    }

    public static boolean hasManualFeatureConfig(String featureKey) {
<span class="fc" id="L1288">        return prefs().contains(getManualFeatureConfigKey(featureKey));</span>
    }

    @NonNull private static String getManualFeatureConfigKey(String featureKey) {
<span class="fc" id="L1292">        return DeletablePrefKey.MANUAL_FEATURE_CONFIG.name() + featureKey;</span>
    }

    public static void setBloggingRemindersShown(int siteId) {
<span class="nc" id="L1296">        prefs().edit().putBoolean(getBloggingRemindersConfigKey(siteId), true).apply();</span>
<span class="nc" id="L1297">    }</span>

    public static boolean isBloggingRemindersShown(int siteId) {
<span class="nc" id="L1300">        return prefs().getBoolean(getBloggingRemindersConfigKey(siteId), false);</span>
    }

    @NonNull private static String getBloggingRemindersConfigKey(int siteId) {
<span class="nc" id="L1304">        return DeletablePrefKey.BLOGGING_REMINDERS_SHOWN.name() + siteId;</span>
    }

    public static void setShouldScheduleCreateSiteNotification(boolean shouldSchedule) {
<span class="nc" id="L1308">        setBoolean(DeletablePrefKey.SHOULD_SCHEDULE_CREATE_SITE_NOTIFICATION, shouldSchedule);</span>
<span class="nc" id="L1309">    }</span>

    public static boolean shouldScheduleCreateSiteNotification() {
<span class="nc" id="L1312">        return getBoolean(DeletablePrefKey.SHOULD_SCHEDULE_CREATE_SITE_NOTIFICATION, true);</span>
    }

    public static void setShouldShowWeeklyRoundupNotification(long remoteSiteId, boolean shouldShow) {
<span class="nc" id="L1316">        prefs().edit().putBoolean(getShouldShowWeeklyRoundupNotification(remoteSiteId), shouldShow).apply();</span>
<span class="nc" id="L1317">    }</span>

    public static boolean shouldShowWeeklyRoundupNotification(long remoteSiteId) {
<span class="nc" id="L1320">        return prefs().getBoolean(getShouldShowWeeklyRoundupNotification(remoteSiteId), true);</span>
    }

    @NonNull private static String getShouldShowWeeklyRoundupNotification(long siteId) {
<span class="nc" id="L1324">        return DeletablePrefKey.SHOULD_SHOW_WEEKLY_ROUNDUP_NOTIFICATION.name() + siteId;</span>
    }

    public static boolean shouldDisplayStatsRevampFeatureAnnouncement() {
<span class="nc" id="L1328">        return prefs().getBoolean(UndeletablePrefKey.STATS_REVAMP2_FEATURE_ANNOUNCEMENT_DISPLAYED.name(), true);</span>
    }

    public static void setShouldDisplayStatsRevampFeatureAnnouncement(boolean isDisplayed) {
<span class="nc" id="L1332">        prefs().edit().putBoolean(UndeletablePrefKey.STATS_REVAMP2_FEATURE_ANNOUNCEMENT_DISPLAYED.name(), isDisplayed)</span>
<span class="nc" id="L1333">               .apply();</span>
<span class="nc" id="L1334">    }</span>

    /*
     * adds a local site ID to the top of list of recently chosen sites
     */
    public static void addPostWithHWAccelerationOff(int localSiteId, int localPostId) {
<span class="nc bnc" id="L1340" title="All 6 branches missed.">        if (localSiteId == 0 || localPostId == 0 || isPostWithHWAccelerationOff(localSiteId, localPostId)) {</span>
<span class="nc" id="L1341">            return;</span>
        }
<span class="nc" id="L1343">        String key = localSiteId + &quot;-&quot; + localPostId;</span>
<span class="nc" id="L1344">        List&lt;String&gt; currentIds = new ArrayList&lt;&gt;(getPostWithHWAccelerationOff());</span>
<span class="nc" id="L1345">        currentIds.add(key);</span>
        // store in prefs
<span class="nc" id="L1347">        String idsAsString = TextUtils.join(&quot;,&quot;, currentIds);</span>
<span class="nc" id="L1348">        setString(DeletablePrefKey.AZTEC_EDITOR_DISABLE_HW_ACC_KEYS, idsAsString);</span>
<span class="nc" id="L1349">    }</span>

    public static boolean isPostWithHWAccelerationOff(int localSiteId, int localPostId) {
<span class="nc bnc" id="L1352" title="All 4 branches missed.">        if (localSiteId == 0 || localPostId == 0) {</span>
<span class="nc" id="L1353">            return false;</span>
        }
<span class="nc" id="L1355">        List&lt;String&gt; currentIds = getPostWithHWAccelerationOff();</span>
<span class="nc" id="L1356">        String key = localSiteId + &quot;-&quot; + localPostId;</span>
<span class="nc" id="L1357">        return currentIds.contains(key);</span>
    }

    public static void setSiteJetpackCapabilities(long remoteSiteId, List&lt;JetpackCapability&gt; capabilities) {
<span class="nc" id="L1361">        HashSet&lt;String&gt; capabilitiesSet = new HashSet(capabilities.size());</span>
<span class="nc bnc" id="L1362" title="All 2 branches missed.">        for (JetpackCapability item : capabilities) {</span>
<span class="nc" id="L1363">            capabilitiesSet.add(item.toString());</span>
<span class="nc" id="L1364">        }</span>

<span class="nc" id="L1366">        Editor editor = prefs().edit();</span>
<span class="nc" id="L1367">        editor.putStringSet(</span>
<span class="nc" id="L1368">                DeletablePrefKey.SITE_JETPACK_CAPABILITIES + String.valueOf(remoteSiteId),</span>
                capabilitiesSet
        );
<span class="nc" id="L1371">        editor.apply();</span>
<span class="nc" id="L1372">    }</span>

    public static List&lt;JetpackCapability&gt; getSiteJetpackCapabilities(long remoteSiteId) {
<span class="nc" id="L1375">        List&lt;JetpackCapability&gt; capabilities = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L1376">        Set&lt;String&gt; strings = prefs().getStringSet(</span>
<span class="nc" id="L1377">                DeletablePrefKey.SITE_JETPACK_CAPABILITIES + String.valueOf(remoteSiteId),</span>
                new HashSet&lt;&gt;()
        );
<span class="nc bnc" id="L1380" title="All 2 branches missed.">        for (String item : strings) {</span>
<span class="nc" id="L1381">            capabilities.add(JetpackCapability.Companion.fromString(item));</span>
<span class="nc" id="L1382">        }</span>
<span class="nc" id="L1383">        return capabilities;</span>
    }

    public static boolean isMySiteDefaultTabExperimentVariantAssigned() {
<span class="nc" id="L1387">        return getBoolean(</span>
                DeletablePrefKey.MY_SITE_DEFAULT_TAB_EXPERIMENT_VARIANT_ASSIGNED,
                false
        );
    }

    public static void setMySiteDefaultTabExperimentVariantAssigned() {
<span class="nc" id="L1394">        setBoolean(DeletablePrefKey.MY_SITE_DEFAULT_TAB_EXPERIMENT_VARIANT_ASSIGNED, true);</span>
<span class="nc" id="L1395">    }</span>

    public static Date getSkippedPromptDay(int siteId) {
<span class="nc" id="L1398">        long promptSkippedMillis = prefs().getLong(getSkippedBloggingPromptDayConfigKey(siteId), 0);</span>
<span class="nc bnc" id="L1399" title="All 2 branches missed.">        if (promptSkippedMillis == 0) {</span>
<span class="nc" id="L1400">            return null;</span>
        }
<span class="nc" id="L1402">        return new Date(promptSkippedMillis);</span>
    }

    public static void setSkippedPromptDay(@Nullable Date date, int siteId) {
<span class="nc bnc" id="L1406" title="All 2 branches missed.">        if (date == null) {</span>
<span class="nc" id="L1407">            prefs().edit().remove(getSkippedBloggingPromptDayConfigKey(siteId)).apply();</span>
<span class="nc" id="L1408">            return;</span>
        }
<span class="nc" id="L1410">        prefs().edit().putLong(getSkippedBloggingPromptDayConfigKey(siteId), date.getTime()).apply();</span>
<span class="nc" id="L1411">    }</span>

    @NonNull private static String getSkippedBloggingPromptDayConfigKey(int siteId) {
<span class="nc" id="L1414">        return DeletablePrefKey.SKIPPED_BLOGGING_PROMPT_DAY.name() + siteId;</span>
    }

    public static void setInitialScreenFromMySiteDefaultTabExperimentVariant(String variant) {
        // This supports the MySiteDefaultTab AB Experiment.
        // AppSettings are undeletable across logouts and keys are all lower case.
        // This method will be removed when the experiment has completed and thus
        // the settings will be maintained only from the AppSettings view{
<span class="nc bnc" id="L1422" title="All 2 branches missed.">        String initialScreen = variant.equals(MySiteTabType.SITE_MENU.getTrackingLabel())</span>
<span class="nc" id="L1423">                ? MySiteTabType.SITE_MENU.getLabel() : MySiteTabType.DASHBOARD.getLabel();</span>
<span class="nc" id="L1424">        setString(UndeletablePrefKey.wp_pref_initial_screen, initialScreen);</span>
<span class="nc" id="L1425">    }</span>

    public static String getMySiteInitialScreen() {
<span class="nc" id="L1428">        return getString(</span>
                UndeletablePrefKey.wp_pref_initial_screen,
<span class="nc" id="L1430">                MySiteTabType.SITE_MENU.getLabel()</span>
        );
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span>Generated by the Android Gradle plugin 7.1.1</div></body></html>