<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>EditorActionsProvider.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">wordpressJalapenoDebug</a> &gt; <a href="index.source.html" class="el_package">org.wordpress.android.ui.posts.editor</a> &gt; <span class="el_source">EditorActionsProvider.kt</span></div><h1>EditorActionsProvider.kt</h1><pre class="source lang-java linenums">package org.wordpress.android.ui.posts.editor

import androidx.annotation.StringRes
import dagger.Reusable
import org.wordpress.android.R
import org.wordpress.android.fluxc.model.post.PostStatus
import org.wordpress.android.util.AppLog
import org.wordpress.android.util.AppLog.T
import javax.inject.Inject

<span class="nc" id="L11">@Reusable</span>
<span class="nc" id="L12">class EditorActionsProvider @Inject constructor() {</span>
<span class="nc" id="L13">    @JvmOverloads fun getPrimaryAction(</span>
        postStatus: PostStatus,
        userCanPublish: Boolean,
<span class="nc" id="L16">        isLandingEditor: Boolean = false</span>
    ): PrimaryEditorAction {
<span class="nc bnc" id="L18" title="All 2 branches missed.">        return if (userCanPublish) {</span>
<span class="nc bnc" id="L19" title="All 5 branches missed.">            when (postStatus) {</span>
<span class="nc" id="L20">                PostStatus.SCHEDULED -&gt; PrimaryEditorAction.SCHEDULE</span>
<span class="nc" id="L21">                PostStatus.DRAFT -&gt; PrimaryEditorAction.PUBLISH_NOW</span>
<span class="nc" id="L22">                PostStatus.PENDING, PostStatus.TRASHED -&gt; PrimaryEditorAction.SAVE</span>
                PostStatus.PUBLISHED -&gt;
<span class="nc bnc" id="L24" title="All 2 branches missed.">                    if (isLandingEditor) PrimaryEditorAction.CONTINUE else PrimaryEditorAction.UPDATE</span>
<span class="nc" id="L25">                PostStatus.PRIVATE, PostStatus.UNKNOWN -&gt; PrimaryEditorAction.UPDATE</span>
            }
        } else {
            // User doesn't have publishing permissions
<span class="nc bnc" id="L29" title="All 3 branches missed.">            when (postStatus) {</span>
                PostStatus.DRAFT,
                PostStatus.PENDING,
<span class="nc" id="L32">                PostStatus.UNKNOWN -&gt; PrimaryEditorAction.SUBMIT_FOR_REVIEW</span>
                PostStatus.TRASHED -&gt; {
<span class="nc" id="L34">                    AppLog.e(T.EDITOR, &quot;User shouldn't be able to open a trashed post in an editor &quot; +</span>
                            &quot;without publishing rights.&quot;)
<span class="nc" id="L36">                    PrimaryEditorAction.SAVE</span>
                }
                PostStatus.PUBLISHED,
                PostStatus.SCHEDULED,
                PostStatus.PRIVATE -&gt; {
<span class="nc" id="L41">                    AppLog.e(T.EDITOR, &quot;User shouldn't be able to open a public ($postStatus) post in an editor &quot; +</span>
                            &quot;without publishing rights.&quot;)
<span class="nc" id="L43">                    PrimaryEditorAction.SUBMIT_FOR_REVIEW</span>
                }
            }
        }
    }

    fun getSecondaryAction(
        postStatus: PostStatus,
        userCanPublish: Boolean
    ): SecondaryEditorAction {
<span class="nc bnc" id="L53" title="All 2 branches missed.">        return if (userCanPublish) {</span>
<span class="nc bnc" id="L54" title="All 4 branches missed.">            when (postStatus) {</span>
<span class="nc" id="L55">                PostStatus.DRAFT -&gt; SecondaryEditorAction.SAVE</span>
<span class="nc" id="L56">                PostStatus.PENDING, PostStatus.SCHEDULED -&gt; SecondaryEditorAction.PUBLISH_NOW</span>
<span class="nc" id="L57">                PostStatus.PRIVATE, PostStatus.PUBLISHED -&gt; SecondaryEditorAction.NONE</span>
<span class="nc" id="L58">                PostStatus.TRASHED, PostStatus.UNKNOWN -&gt; SecondaryEditorAction.SAVE_AS_DRAFT</span>
            }
        } else {
            // User doesn't have publishing permissions
<span class="nc bnc" id="L62" title="All 3 branches missed.">            when (postStatus) {</span>
                PostStatus.DRAFT,
                PostStatus.PENDING,
<span class="nc" id="L65">                PostStatus.UNKNOWN -&gt; SecondaryEditorAction.NONE</span>
                PostStatus.TRASHED -&gt; {
<span class="nc" id="L67">                    AppLog.e(T.EDITOR, &quot;User shouldn't be able to open a trashed post in an editor &quot; +</span>
                            &quot;without publishing rights.&quot;)
<span class="nc" id="L69">                    SecondaryEditorAction.SAVE_AS_DRAFT</span>
                }
                PostStatus.PUBLISHED,
                PostStatus.SCHEDULED,
                PostStatus.PRIVATE -&gt; {
<span class="nc" id="L74">                    AppLog.e(T.EDITOR, &quot;User shouldn't be able to open a public ($postStatus) post in an editor &quot; +</span>
                            &quot;without publishing rights.&quot;)
<span class="nc" id="L76">                    SecondaryEditorAction.NONE</span>
                }
            }
        }
    }
}

<span class="nc" id="L83">enum class PrimaryEditorAction(@StringRes val titleResource: Int) {</span>
<span class="nc" id="L84">    SUBMIT_FOR_REVIEW(R.string.submit_for_review),</span>
<span class="nc" id="L85">    PUBLISH_NOW(R.string.button_publish),</span>
<span class="nc" id="L86">    SCHEDULE(R.string.schedule_verb),</span>
<span class="nc" id="L87">    UPDATE(R.string.update_verb),</span>
<span class="nc" id="L88">    CONTINUE(R.string.continue_label),</span>
<span class="nc" id="L89">    SAVE(R.string.save);</span>
}

<span class="nc" id="L92">enum class SecondaryEditorAction(@StringRes val titleResource: Int?, val isVisible: Boolean) {</span>
<span class="nc" id="L93">    SAVE_AS_DRAFT(R.string.menu_save_as_draft, isVisible = true),</span>
<span class="nc" id="L94">    SAVE(R.string.save, isVisible = true),</span>
<span class="nc" id="L95">    PUBLISH_NOW(R.string.menu_publish_now, isVisible = true),</span>
<span class="nc" id="L96">    NONE(titleResource = null, isVisible = false);</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span>Generated by the Android Gradle plugin 7.1.1</div></body></html>