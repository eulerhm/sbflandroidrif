<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>UnifiedCommentListAdapter.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">wordpressJalapenoDebug</a> &gt; <a href="index.source.html" class="el_package">org.wordpress.android.ui.comments.unified</a> &gt; <span class="el_source">UnifiedCommentListAdapter.kt</span></div><h1>UnifiedCommentListAdapter.kt</h1><pre class="source lang-java linenums">package org.wordpress.android.ui.comments.unified

import android.content.Context
import android.os.Bundle
import android.view.ViewGroup
import androidx.recyclerview.widget.ListAdapter
import org.wordpress.android.WordPress
import org.wordpress.android.ui.comments.unified.UnifiedCommentListItem.Comment
import org.wordpress.android.ui.comments.unified.UnifiedCommentListItem.CommentListItemType.COMMENT
import org.wordpress.android.ui.comments.unified.UnifiedCommentListItem.CommentListItemType.NEXT_PAGE_LOADER
import org.wordpress.android.ui.comments.unified.UnifiedCommentListItem.CommentListItemType.SUB_HEADER
import org.wordpress.android.ui.comments.unified.UnifiedCommentListItem.NextPageLoader
import org.wordpress.android.ui.comments.unified.UnifiedCommentListItem.SubHeader
import org.wordpress.android.ui.utils.AnimationUtilsWrapper
import org.wordpress.android.ui.utils.UiHelpers
import org.wordpress.android.util.GravatarUtilsWrapper
import org.wordpress.android.util.image.ImageManager
import org.wordpress.android.viewmodel.ResourceProvider
import javax.inject.Inject

<span class="nc" id="L21">class UnifiedCommentListAdapter(context: Context) : ListAdapter&lt;UnifiedCommentListItem,</span>
        UnifiedCommentListViewHolder&lt;*&gt;&gt;(
<span class="nc" id="L23">        diffCallback</span>
) {
<span class="nc bnc" id="L25" title="All 2 branches missed.">    @Inject lateinit var imageManager: ImageManager</span>
<span class="nc bnc" id="L26" title="All 2 branches missed.">    @Inject lateinit var uiHelpers: UiHelpers</span>
<span class="nc bnc" id="L27" title="All 2 branches missed.">    @Inject lateinit var commentListUiUtils: CommentListUiUtils</span>
<span class="nc bnc" id="L28" title="All 2 branches missed.">    @Inject lateinit var resourceProvider: ResourceProvider</span>
<span class="nc bnc" id="L29" title="All 2 branches missed.">    @Inject lateinit var gravatarUtilsWrapper: GravatarUtilsWrapper</span>
<span class="nc bnc" id="L30" title="All 2 branches missed.">    @Inject lateinit var animationUtilsWrapper: AnimationUtilsWrapper</span>

<span class="nc" id="L32">    init {</span>
<span class="nc bnc" id="L33" title="All 2 branches missed.">        (context.applicationContext as WordPress).component().inject(this)</span>
<span class="nc" id="L34">    }</span>

    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): UnifiedCommentListViewHolder&lt;*&gt; {
<span class="nc" id="L37">        return when (viewType) {</span>
<span class="nc bnc" id="L38" title="All 2 branches missed.">            SUB_HEADER.ordinal -&gt; UnifiedCommentSubHeaderViewHolder(parent)</span>
<span class="nc bnc" id="L39" title="All 2 branches missed.">            COMMENT.ordinal -&gt; UnifiedCommentViewHolder(</span>
<span class="nc" id="L40">                    parent,</span>
<span class="nc" id="L41">                    imageManager,</span>
<span class="nc" id="L42">                    uiHelpers,</span>
<span class="nc" id="L43">                    commentListUiUtils,</span>
<span class="nc" id="L44">                    resourceProvider,</span>
<span class="nc" id="L45">                    gravatarUtilsWrapper,</span>
<span class="nc" id="L46">                    animationUtilsWrapper</span>
            )
<span class="nc bnc" id="L48" title="All 2 branches missed.">            NEXT_PAGE_LOADER.ordinal -&gt; LoadStateViewHolder(parent)</span>
<span class="nc" id="L49">            else -&gt; throw IllegalArgumentException(&quot;Unexpected view holder in UnifiedCommentListAdapter&quot;)</span>
        }
    }

    override fun onBindViewHolder(holder: UnifiedCommentListViewHolder&lt;*&gt;, position: Int, payloads: MutableList&lt;Any&gt;) {
<span class="nc bnc" id="L54" title="All 10 branches missed.">        if (payloads.isNotEmpty() &amp;&amp; (payloads.first() as? Bundle)?.size() ?: 0 &gt; 0) {</span>
<span class="nc" id="L55">            val bundle = payloads.first() as Bundle</span>
<span class="nc bnc" id="L56" title="All 2 branches missed.">            if (bundle.containsKey(UnifiedCommentsListDiffCallback.COMMENT_SELECTION_TOGGLED)) {</span>
<span class="nc" id="L57">                val isSelected = bundle.getBoolean(UnifiedCommentsListDiffCallback.COMMENT_SELECTION_TOGGLED)</span>
<span class="nc" id="L58">                (holder as UnifiedCommentViewHolder).toggleSelected(isSelected)</span>
            }

<span class="nc bnc" id="L61" title="All 2 branches missed.">            if (bundle.containsKey(UnifiedCommentsListDiffCallback.COMMENT_PENDING_STATE_CHANGED)) {</span>
<span class="nc bnc" id="L62" title="All 2 branches missed.">                (holder as UnifiedCommentViewHolder).updateStateAndListeners(getItem(position) as Comment)</span>
            }
        } else {
<span class="nc" id="L65">            onBindViewHolder(holder, position)</span>
        }
<span class="nc" id="L67">    }</span>

    override fun onBindViewHolder(holder: UnifiedCommentListViewHolder&lt;*&gt;, position: Int) {
<span class="nc bnc" id="L70" title="All 2 branches missed.">        if (holder is UnifiedCommentSubHeaderViewHolder) {</span>
<span class="nc bnc" id="L71" title="All 2 branches missed.">            holder.bind((getItem(position) as SubHeader))</span>
<span class="nc bnc" id="L72" title="All 2 branches missed.">        } else if (holder is UnifiedCommentViewHolder) {</span>
<span class="nc bnc" id="L73" title="All 2 branches missed.">            holder.bind(getItem(position) as Comment)</span>
<span class="nc bnc" id="L74" title="All 2 branches missed.">        } else if (holder is LoadStateViewHolder) {</span>
<span class="nc bnc" id="L75" title="All 2 branches missed.">            holder.bind(getItem(position) as NextPageLoader)</span>
        }
<span class="nc" id="L77">    }</span>

    override fun getItemViewType(position: Int): Int {
<span class="nc" id="L80">        return getItem(position).type.ordinal</span>
    }

    companion object {
<span class="nc" id="L84">        private val diffCallback = UnifiedCommentsListDiffCallback()</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span>Generated by the Android Gradle plugin 7.1.1</div></body></html>