<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ContextExtensions.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">wordpressJalapenoDebug</a> &gt; <a href="index.source.html" class="el_package">org.wordpress.android.util.extensions</a> &gt; <span class="el_source">ContextExtensions.kt</span></div><h1>ContextExtensions.kt</h1><pre class="source lang-java linenums">package org.wordpress.android.util.extensions

import android.content.ClipboardManager
import android.content.Context
import android.content.res.ColorStateList
import android.graphics.drawable.Drawable
import android.util.TypedValue
import androidx.annotation.AttrRes
import androidx.annotation.ColorInt
import androidx.annotation.ColorRes
import androidx.annotation.DrawableRes
import androidx.appcompat.content.res.AppCompatResources
import androidx.core.content.ContextCompat
import androidx.core.os.ConfigurationCompat
import com.google.gson.Gson
import com.google.gson.JsonSyntaxException
import org.wordpress.android.util.AppLog
import java.io.IOException
import java.util.Locale

@ColorRes
fun Context.getColorResIdFromAttribute(@AttrRes attribute: Int) =
<span class="nc" id="L23">        TypedValue().let {</span>
<span class="nc" id="L24">            theme.resolveAttribute(attribute, it, true)</span>
<span class="nc" id="L25">            it.resourceId</span>
<span class="nc" id="L26">        }</span>

@ColorInt
fun Context.getColorFromAttribute(@AttrRes attribute: Int) =
<span class="nc" id="L30">        TypedValue().let {</span>
<span class="nc" id="L31">            theme.resolveAttribute(attribute, it, true)</span>
<span class="nc" id="L32">            ContextCompat.getColor(this, it.resourceId)</span>
<span class="nc" id="L33">        }</span>

@DrawableRes
fun Context.getDrawableResIdFromAttribute(@AttrRes attribute: Int) =
<span class="nc" id="L37">        TypedValue().let {</span>
<span class="nc" id="L38">            theme.resolveAttribute(attribute, it, true)</span>
<span class="nc" id="L39">            it.resourceId</span>
<span class="nc" id="L40">        }</span>

fun Context.getColorStateListFromAttribute(@AttrRes attribute: Int): ColorStateList =
<span class="nc" id="L43">        getColorResIdFromAttribute(attribute).let {</span>
<span class="nc" id="L44">            AppCompatResources.getColorStateList(this, it)</span>
<span class="nc" id="L45">        }</span>

// https://developer.android.com/reference/android/content/res/Configuration.html#locale
val Context.currentLocale: Locale
<span class="nc" id="L49">    get() = ConfigurationCompat.getLocales(resources.configuration)[0]</span>

/**
 * Gets the clipboard manager system service
 * @see android.content.ClipboardManager
 */
val Context.clipboardManager: ClipboardManager?
<span class="nc" id="L56">    get() = ContextCompat.getSystemService(this, ClipboardManager::class.java)</span>

fun Context.getDrawableFromAttribute(attributeId: Int): Drawable? {
<span class="nc" id="L59">    val styledAttributes = this.obtainStyledAttributes(intArrayOf(attributeId))</span>
<span class="nc" id="L60">    val styledDrawable = styledAttributes.getDrawable(0)</span>
<span class="nc" id="L61">    styledAttributes.recycle()</span>
<span class="nc" id="L62">    return styledDrawable</span>
}

/**
 * Reads an asset file as string
 * @param assetFilename the asset filename
 * @return the content of the asset file
 */
<span class="nc" id="L70">fun Context.getStringFromAsset(assetFilename: String): String? = try {</span>
<span class="nc bnc" id="L71" title="All 2 branches missed.">    assets.open(assetFilename).bufferedReader().use { it.readText() }</span>
<span class="nc" id="L72">} catch (ioException: IOException) {</span>
<span class="nc" id="L73">    AppLog.e(AppLog.T.UTILS, &quot;Error reading string from asset file: $assetFilename&quot;)</span>
<span class="nc" id="L74">    null</span>
<span class="nc" id="L75">}</span>

/**
 * Parses Json from an asset file
 * @param assetFilename the asset filename
 * @param modelClass the model class
 * @return the parsed model
 */
inline fun &lt;reified T : Any&gt; Context.parseJsonFromAsset(assetFilename: String, modelClass: Class&lt;T&gt;): T? =
        getStringFromAsset(assetFilename)?.let {
            try {
                Gson().fromJson(it, modelClass)
            } catch (e: JsonSyntaxException) {
                AppLog.e(AppLog.T.UTILS, &quot;Error parsing Json from asset file: $assetFilename&quot;)
                null
            }
        }
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span>Generated by the Android Gradle plugin 7.1.1</div></body></html>