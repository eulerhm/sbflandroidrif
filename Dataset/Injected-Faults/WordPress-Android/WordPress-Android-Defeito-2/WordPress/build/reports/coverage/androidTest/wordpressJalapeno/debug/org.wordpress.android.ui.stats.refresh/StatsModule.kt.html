<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>StatsModule.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">wordpressJalapenoDebug</a> &gt; <a href="index.source.html" class="el_package">org.wordpress.android.ui.stats.refresh</a> &gt; <span class="el_source">StatsModule.kt</span></div><h1>StatsModule.kt</h1><pre class="source lang-java linenums">package org.wordpress.android.ui.stats.refresh

import android.content.Context
import android.content.SharedPreferences
import android.preference.PreferenceManager
import dagger.Module
import dagger.Provides
import dagger.hilt.InstallIn
import dagger.hilt.android.qualifiers.ApplicationContext
import dagger.hilt.components.SingletonComponent
import kotlinx.coroutines.CoroutineDispatcher
import org.wordpress.android.BuildConfig
import org.wordpress.android.fluxc.network.utils.StatsGranularity.DAYS
import org.wordpress.android.fluxc.network.utils.StatsGranularity.MONTHS
import org.wordpress.android.fluxc.network.utils.StatsGranularity.WEEKS
import org.wordpress.android.fluxc.network.utils.StatsGranularity.YEARS
import org.wordpress.android.fluxc.store.StatsStore
import org.wordpress.android.fluxc.store.StatsStore.InsightType
import org.wordpress.android.fluxc.store.StatsStore.TimeStatsType
import org.wordpress.android.modules.BG_THREAD
import org.wordpress.android.modules.UI_THREAD
import org.wordpress.android.ui.stats.refresh.lists.BaseListUseCase
import org.wordpress.android.ui.stats.refresh.lists.StatsListViewModel.StatsSection
import org.wordpress.android.ui.stats.refresh.lists.UiModelMapper
import org.wordpress.android.ui.stats.refresh.lists.detail.PostAverageViewsPerDayUseCase.PostAverageViewsPerDayUseCaseFactory
import org.wordpress.android.ui.stats.refresh.lists.detail.PostDayViewsUseCase
import org.wordpress.android.ui.stats.refresh.lists.detail.PostHeaderUseCase
import org.wordpress.android.ui.stats.refresh.lists.detail.PostMonthsAndYearsUseCase.PostMonthsAndYearsUseCaseFactory
import org.wordpress.android.ui.stats.refresh.lists.detail.PostRecentWeeksUseCase.PostRecentWeeksUseCaseFactory
import org.wordpress.android.ui.stats.refresh.lists.sections.BaseStatsUseCase
import org.wordpress.android.ui.stats.refresh.lists.sections.BaseStatsUseCase.UseCaseMode.BLOCK
import org.wordpress.android.ui.stats.refresh.lists.sections.BaseStatsUseCase.UseCaseMode.BLOCK_DETAIL
import org.wordpress.android.ui.stats.refresh.lists.sections.BaseStatsUseCase.UseCaseMode.VIEW_ALL
import org.wordpress.android.ui.stats.refresh.lists.sections.granular.GranularUseCaseFactory
import org.wordpress.android.ui.stats.refresh.lists.sections.granular.usecases.AuthorsUseCase.AuthorsUseCaseFactory
import org.wordpress.android.ui.stats.refresh.lists.sections.granular.usecases.ClicksUseCase.ClicksUseCaseFactory
import org.wordpress.android.ui.stats.refresh.lists.sections.granular.usecases.CountryViewsUseCase.CountryViewsUseCaseFactory
import org.wordpress.android.ui.stats.refresh.lists.sections.granular.usecases.FileDownloadsUseCase.FileDownloadsUseCaseFactory
import org.wordpress.android.ui.stats.refresh.lists.sections.granular.usecases.OverviewUseCase.OverviewUseCaseFactory
import org.wordpress.android.ui.stats.refresh.lists.sections.granular.usecases.PostsAndPagesUseCase.PostsAndPagesUseCaseFactory
import org.wordpress.android.ui.stats.refresh.lists.sections.granular.usecases.ReferrersUseCase.ReferrersUseCaseFactory
import org.wordpress.android.ui.stats.refresh.lists.sections.granular.usecases.SearchTermsUseCase.SearchTermsUseCaseFactory
import org.wordpress.android.ui.stats.refresh.lists.sections.granular.usecases.TotalLikesDetailUseCase.TotalLikesGranularUseCaseFactory
import org.wordpress.android.ui.stats.refresh.lists.sections.granular.usecases.VideoPlaysUseCase.VideoPlaysUseCaseFactory
import org.wordpress.android.ui.stats.refresh.lists.sections.granular.usecases.ViewsAndVisitorsDetailUseCase.ViewsAndVisitorsGranularUseCaseFactory
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.ActionCardGrowUseCase
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.ActionCardReminderUseCase
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.ActionCardScheduleUseCase
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.AllTimeStatsUseCase
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.AnnualSiteStatsUseCase.AnnualSiteStatsUseCaseFactory
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.AuthorsCommentsUseCase
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.CommentsUseCase
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.FollowerTotalsUseCase
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.FollowerTypesUseCase
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.FollowersUseCase.FollowersUseCaseFactory
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.LatestPostSummaryUseCase
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.ManagementControlUseCase
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.ManagementNewsCardUseCase
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.MostPopularInsightsUseCase
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.PostingActivityUseCase
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.PostsCommentsUseCase
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.PublicizeUseCase.PublicizeUseCaseFactory
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.TagsAndCategoriesUseCase.TagsAndCategoriesUseCaseFactory
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.TodayStatsUseCase
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.TotalCommentsUseCase.TotalCommentsUseCaseFactory
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.TotalFollowersUseCase.TotalFollowersUseCaseFactory
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.TotalLikesUseCase.TotalLikesUseCaseFactory
import org.wordpress.android.ui.stats.refresh.lists.sections.insights.usecases.ViewsAndVisitorsUseCase.ViewsAndVisitorsUseCaseFactory
import org.wordpress.android.ui.stats.refresh.utils.StatsSiteProvider
import org.wordpress.android.util.config.StatsRevampV2FeatureConfig
import javax.inject.Named
import javax.inject.Singleton

const val INSIGHTS_USE_CASE = &quot;InsightsUseCase&quot;
const val DAY_STATS_USE_CASE = &quot;DayStatsUseCase&quot;
const val WEEK_STATS_USE_CASE = &quot;WeekStatsUseCase&quot;
const val MONTH_STATS_USE_CASE = &quot;MonthStatsUseCase&quot;
const val YEAR_STATS_USE_CASE = &quot;YearStatsUseCase&quot;
const val BLOCK_DETAIL_USE_CASE = &quot;BlockDetailUseCase&quot;
const val VIEWS_AND_VISITORS_USE_CASE = &quot;ViewsAndVisitorsUseCase&quot;
const val TOTAL_LIKES_DETAIL_USE_CASE = &quot;LikesDetailUseCase&quot;
const val TOTAL_COMMENTS_DETAIL_USE_CASE = &quot;CommentsDetailUseCase&quot;
const val TOTAL_FOLLOWERS_DETAIL_USE_CASE = &quot;FollowersDetailUseCase&quot;

const val LIST_STATS_USE_CASES = &quot;ListStatsUseCases&quot;
const val BLOCK_INSIGHTS_USE_CASES = &quot;BlockInsightsUseCases&quot;
const val VIEW_ALL_INSIGHTS_USE_CASES = &quot;ViewAllInsightsUseCases&quot;
const val GRANULAR_USE_CASE_FACTORIES = &quot;GranularUseCaseFactories&quot;

// These are injected only internally
private const val BLOCK_DETAIL_USE_CASES = &quot;BlockDetailUseCases&quot;
private const val BLOCK_VIEWS_AND_VISITORS_USE_CASES = &quot;BlockViewsAndVisitorsUseCases&quot;
private const val TOTAL_LIKES_DETAIL_USE_CASES = &quot;LikesDetailUseCases&quot;
private const val TOTAL_COMMENTS_DETAIL_USE_CASES = &quot;CommentsDetailUseCases&quot;
private const val TOTAL_FOLLOWERS_DETAIL_USE_CASES = &quot;FollowersDetailUseCases&quot;

/**
 * Module that provides use cases for Stats.
 */
<span class="fc" id="L100">@InstallIn(SingletonComponent::class)</span>
@Module
<span class="fc" id="L102">class StatsModule {</span>
    /**
     * Provides a list of use cases for the Insights screen in Stats. Modify this method when you want to add more
     * blocks to the Insights screen.
     */
    @Provides
    @Singleton
    @Named(BLOCK_INSIGHTS_USE_CASES)
    @Suppress(&quot;LongParameterList&quot;)
    fun provideBlockInsightsUseCases(
        statsRevampV2FeatureConfig: StatsRevampV2FeatureConfig,
        viewsAndVisitorsUseCaseFactory: ViewsAndVisitorsUseCaseFactory,
        allTimeStatsUseCase: AllTimeStatsUseCase,
        latestPostSummaryUseCase: LatestPostSummaryUseCase,
        todayStatsUseCase: TodayStatsUseCase,
        followersUseCaseFactory: FollowersUseCaseFactory,
        commentsUseCase: CommentsUseCase,
        mostPopularInsightsUseCase: MostPopularInsightsUseCase,
        tagsAndCategoriesUseCaseFactory: TagsAndCategoriesUseCaseFactory,
        publicizeUseCaseFactory: PublicizeUseCaseFactory,
        postingActivityUseCase: PostingActivityUseCase,
        followerTotalsUseCase: FollowerTotalsUseCase,
        totalLikesUseCaseFactory: TotalLikesUseCaseFactory,
        totalCommentsUseCaseFactory: TotalCommentsUseCaseFactory,
        totalFollowersUseCaseFactory: TotalFollowersUseCaseFactory,
        annualSiteStatsUseCaseFactory: AnnualSiteStatsUseCaseFactory,
        managementControlUseCase: ManagementControlUseCase,
        managementNewsCardUseCase: ManagementNewsCardUseCase,
        actionCardGrowUseCase: ActionCardGrowUseCase,
        actionCardReminderUseCase: ActionCardReminderUseCase,
        actionCardScheduleUseCase: ActionCardScheduleUseCase
    ): List&lt;@JvmSuppressWildcards BaseStatsUseCase&lt;*, *&gt;&gt; {
<span class="nc" id="L134">        val useCases = mutableListOf&lt;BaseStatsUseCase&lt;*, *&gt;&gt;()</span>
<span class="nc" id="L135">        if (BuildConfig.IS_JETPACK_APP &amp;&amp; statsRevampV2FeatureConfig.isEnabled()) {</span>
            useCases.add(viewsAndVisitorsUseCaseFactory.build(BLOCK))
            useCases.add(totalLikesUseCaseFactory.build(BLOCK))
            useCases.add(totalCommentsUseCaseFactory.build(BLOCK))
            useCases.add(totalFollowersUseCaseFactory.build(BLOCK))
            useCases.add(actionCardGrowUseCase)
            useCases.add(actionCardReminderUseCase)
            useCases.add(actionCardScheduleUseCase)
        } else {
<span class="nc" id="L144">            useCases.add(followerTotalsUseCase)</span>
        }
<span class="nc" id="L146">        useCases.addAll(</span>
<span class="nc" id="L147">                listOf(</span>
<span class="nc" id="L148">                    allTimeStatsUseCase,</span>
<span class="nc" id="L149">                    latestPostSummaryUseCase,</span>
<span class="nc" id="L150">                    todayStatsUseCase,</span>
<span class="nc" id="L151">                    followersUseCaseFactory.build(BLOCK),</span>
<span class="nc" id="L152">                    commentsUseCase,</span>
<span class="nc" id="L153">                    mostPopularInsightsUseCase,</span>
<span class="nc" id="L154">                    tagsAndCategoriesUseCaseFactory.build(BLOCK),</span>
<span class="nc" id="L155">                    publicizeUseCaseFactory.build(BLOCK),</span>
<span class="nc" id="L156">                    postingActivityUseCase,</span>
<span class="nc" id="L157">                    annualSiteStatsUseCaseFactory.build(BLOCK),</span>
<span class="nc" id="L158">                    managementControlUseCase,</span>
<span class="nc" id="L159">                    managementNewsCardUseCase</span>
                )
        )
<span class="nc" id="L162">        return useCases</span>
    }

    /**
     * Provides a list of use cases for the View all screen in Stats. Modify this method when you want to add more
     * blocks to the Insights screen.
     */
    @Provides
    @Singleton
    @Named(VIEW_ALL_INSIGHTS_USE_CASES)
    fun provideViewAllInsightsUseCases(
        followersUseCaseFactory: FollowersUseCaseFactory,
        tagsAndCategoriesUseCaseFactory: TagsAndCategoriesUseCaseFactory,
        publicizeUseCaseFactory: PublicizeUseCaseFactory,
        postMonthsAndYearsUseCaseFactory: PostMonthsAndYearsUseCaseFactory,
        postAverageViewsPerDayUseCaseFactory: PostAverageViewsPerDayUseCaseFactory,
        postRecentWeeksUseCaseFactory: PostRecentWeeksUseCaseFactory,
        annualSiteStatsUseCaseFactory: AnnualSiteStatsUseCaseFactory
    ): List&lt;@JvmSuppressWildcards BaseStatsUseCase&lt;*, *&gt;&gt; {
<span class="nc" id="L181">        return listOf(</span>
<span class="nc" id="L182">                followersUseCaseFactory.build(VIEW_ALL),</span>
<span class="nc" id="L183">                tagsAndCategoriesUseCaseFactory.build(VIEW_ALL),</span>
<span class="nc" id="L184">                publicizeUseCaseFactory.build(VIEW_ALL),</span>
<span class="nc" id="L185">                postMonthsAndYearsUseCaseFactory.build(VIEW_ALL),</span>
<span class="nc" id="L186">                postAverageViewsPerDayUseCaseFactory.build(VIEW_ALL),</span>
<span class="nc" id="L187">                postRecentWeeksUseCaseFactory.build(VIEW_ALL),</span>
<span class="nc" id="L188">                annualSiteStatsUseCaseFactory.build(VIEW_ALL)</span>
        )
    }

    /**
     * Provides a list of use case factories that build use cases for the Time stats screen based on the given
     * granularity (Day, Week, Month, Year).
     */
    @Provides
    @Singleton
    @Named(GRANULAR_USE_CASE_FACTORIES)
    fun provideGranularUseCaseFactories(
        postsAndPagesUseCaseFactory: PostsAndPagesUseCaseFactory,
        referrersUseCaseFactory: ReferrersUseCaseFactory,
        clicksUseCaseFactory: ClicksUseCaseFactory,
        countryViewsUseCaseFactory: CountryViewsUseCaseFactory,
        videoPlaysUseCaseFactory: VideoPlaysUseCaseFactory,
        searchTermsUseCaseFactory: SearchTermsUseCaseFactory,
        authorsUseCaseFactory: AuthorsUseCaseFactory,
        overviewUseCaseFactory: OverviewUseCaseFactory,
        fileDownloadsUseCaseFactory: FileDownloadsUseCaseFactory
    ): List&lt;@JvmSuppressWildcards GranularUseCaseFactory&gt; {
<span class="nc" id="L210">        return listOf(</span>
<span class="nc" id="L211">                postsAndPagesUseCaseFactory,</span>
<span class="nc" id="L212">                referrersUseCaseFactory,</span>
<span class="nc" id="L213">                clicksUseCaseFactory,</span>
<span class="nc" id="L214">                countryViewsUseCaseFactory,</span>
<span class="nc" id="L215">                videoPlaysUseCaseFactory,</span>
<span class="nc" id="L216">                searchTermsUseCaseFactory,</span>
<span class="nc" id="L217">                authorsUseCaseFactory,</span>
<span class="nc" id="L218">                overviewUseCaseFactory,</span>
<span class="nc" id="L219">                fileDownloadsUseCaseFactory</span>
        )
    }

    /**
     * Provides a list of use cases for the Post detail screen in Stats. Modify this method when you want to add more
     * blocks to the post detail screen.
     */
    @Provides
    @Singleton
    @Named(BLOCK_DETAIL_USE_CASES)
    fun provideDetailUseCases(
        postHeaderUseCase: PostHeaderUseCase,
        postDayViewsUseCase: PostDayViewsUseCase,
        postMonthsAndYearsUseCaseFactory: PostMonthsAndYearsUseCaseFactory,
        postAverageViewsPerDayUseCaseFactory: PostAverageViewsPerDayUseCaseFactory,
        postRecentWeeksUseCaseFactory: PostRecentWeeksUseCaseFactory
    ): List&lt;@JvmSuppressWildcards BaseStatsUseCase&lt;*, *&gt;&gt; {
<span class="nc" id="L237">        return listOf(</span>
<span class="nc" id="L238">                postHeaderUseCase,</span>
<span class="nc" id="L239">                postDayViewsUseCase,</span>
<span class="nc" id="L240">                postMonthsAndYearsUseCaseFactory.build(BLOCK),</span>
<span class="nc" id="L241">                postAverageViewsPerDayUseCaseFactory.build(BLOCK),</span>
<span class="nc" id="L242">                postRecentWeeksUseCaseFactory.build(BLOCK)</span>
        )
    }

    /**
     * Provides a singleton usecase that represents the Insights screen. It consists of list of use cases that build
     * the insights blocks.
     */
    @Provides
    @Singleton
    @Named(INSIGHTS_USE_CASE)
    fun provideInsightsUseCase(
        statsStore: StatsStore,
        @Named(BG_THREAD) bgDispatcher: CoroutineDispatcher,
        @Named(UI_THREAD) mainDispatcher: CoroutineDispatcher,
        statsSiteProvider: StatsSiteProvider,
        @Named(BLOCK_INSIGHTS_USE_CASES) useCases: List&lt;@JvmSuppressWildcards BaseStatsUseCase&lt;*, *&gt;&gt;,
        uiModelMapper: UiModelMapper
    ): BaseListUseCase {
<span class="nc" id="L261">        return BaseListUseCase(</span>
<span class="nc" id="L262">                bgDispatcher,</span>
<span class="nc" id="L263">                mainDispatcher,</span>
<span class="nc" id="L264">                statsSiteProvider,</span>
<span class="nc" id="L265">                useCases,</span>
<span class="nc" id="L266">                { statsStore.getInsightTypes(it) },</span>
<span class="nc" id="L267">                uiModelMapper::mapInsights</span>
        )
    }

    /**
     * Provides a singleton usecase that represents the Day stats screen.
     * @param useCasesFactories build the use cases for the DAYS granularity
     */
    @Provides
    @Singleton
    @Named(DAY_STATS_USE_CASE)
    fun provideDayStatsUseCase(
        statsStore: StatsStore,
        @Named(BG_THREAD) bgDispatcher: CoroutineDispatcher,
        @Named(UI_THREAD) mainDispatcher: CoroutineDispatcher,
        statsSiteProvider: StatsSiteProvider,
        @Named(GRANULAR_USE_CASE_FACTORIES) useCasesFactories: List&lt;@JvmSuppressWildcards GranularUseCaseFactory&gt;,
        uiModelMapper: UiModelMapper
    ): BaseListUseCase {
<span class="nc" id="L286">        return BaseListUseCase(</span>
<span class="nc" id="L287">                bgDispatcher,</span>
<span class="nc" id="L288">                mainDispatcher,</span>
<span class="nc" id="L289">                statsSiteProvider,</span>
<span class="nc" id="L290">                useCasesFactories.map { it.build(DAYS, BLOCK) },</span>
<span class="nc" id="L291">                { statsStore.getTimeStatsTypes(it) },</span>
<span class="nc" id="L292">                uiModelMapper::mapTimeStats</span>
        )
    }

    /**
     * Provides a singleton usecase that represents the Week stats screen.
     * @param useCasesFactories build the use cases for the WEEKS granularity
     */
    @Provides
    @Singleton
    @Named(WEEK_STATS_USE_CASE)
    fun provideWeekStatsUseCase(
        statsStore: StatsStore,
        @Named(BG_THREAD) bgDispatcher: CoroutineDispatcher,
        @Named(UI_THREAD) mainDispatcher: CoroutineDispatcher,
        statsSiteProvider: StatsSiteProvider,
        @Named(GRANULAR_USE_CASE_FACTORIES) useCasesFactories: List&lt;@JvmSuppressWildcards GranularUseCaseFactory&gt;,
        uiModelMapper: UiModelMapper
    ): BaseListUseCase {
<span class="nc" id="L311">        return BaseListUseCase(</span>
<span class="nc" id="L312">                bgDispatcher,</span>
<span class="nc" id="L313">                mainDispatcher,</span>
<span class="nc" id="L314">                statsSiteProvider,</span>
<span class="nc" id="L315">                useCasesFactories.map { it.build(WEEKS, BLOCK) },</span>
<span class="nc" id="L316">                { statsStore.getTimeStatsTypes(it) },</span>
<span class="nc" id="L317">                uiModelMapper::mapTimeStats</span>
        )
    }

    /**
     * Provides a singleton usecase that represents the Month stats screen.
     * @param useCasesFactories build the use cases for the MONTHS granularity
     */
    @Provides
    @Singleton
    @Named(MONTH_STATS_USE_CASE)
    fun provideMonthStatsUseCase(
        statsStore: StatsStore,
        @Named(BG_THREAD) bgDispatcher: CoroutineDispatcher,
        @Named(UI_THREAD) mainDispatcher: CoroutineDispatcher,
        statsSiteProvider: StatsSiteProvider,
        @Named(GRANULAR_USE_CASE_FACTORIES) useCasesFactories: List&lt;@JvmSuppressWildcards GranularUseCaseFactory&gt;,
        uiModelMapper: UiModelMapper
    ): BaseListUseCase {
<span class="nc" id="L336">        return BaseListUseCase(</span>
<span class="nc" id="L337">                bgDispatcher, mainDispatcher,</span>
<span class="nc" id="L338">                statsSiteProvider,</span>
<span class="nc" id="L339">                useCasesFactories.map { it.build(MONTHS, BLOCK) },</span>
<span class="nc" id="L340">                { statsStore.getTimeStatsTypes(it) },</span>
<span class="nc" id="L341">                uiModelMapper::mapTimeStats</span>
        )
    }

    /**
     * Provides a singleton usecase that represents the Year stats screen.
     * @param useCasesFactories build the use cases for the YEARS granularity
     */
    @Provides
    @Singleton
    @Named(YEAR_STATS_USE_CASE)
    fun provideYearStatsUseCase(
        statsStore: StatsStore,
        @Named(BG_THREAD) bgDispatcher: CoroutineDispatcher,
        @Named(UI_THREAD) mainDispatcher: CoroutineDispatcher,
        statsSiteProvider: StatsSiteProvider,
        @Named(GRANULAR_USE_CASE_FACTORIES) useCasesFactories: List&lt;@JvmSuppressWildcards GranularUseCaseFactory&gt;,
        uiModelMapper: UiModelMapper
    ): BaseListUseCase {
<span class="nc" id="L360">        return BaseListUseCase(</span>
<span class="nc" id="L361">                bgDispatcher,</span>
<span class="nc" id="L362">                mainDispatcher,</span>
<span class="nc" id="L363">                statsSiteProvider,</span>
<span class="nc" id="L364">                useCasesFactories.map { it.build(YEARS, BLOCK) },</span>
<span class="nc" id="L365">                { statsStore.getTimeStatsTypes(it) },</span>
<span class="nc" id="L366">                uiModelMapper::mapTimeStats</span>
        )
    }

    /**
     * Provides all list stats use cases
     */
    @Provides
    @Singleton
    @Named(LIST_STATS_USE_CASES)
    fun provideListStatsUseCases(
        @Named(INSIGHTS_USE_CASE) insightsUseCase: BaseListUseCase,
        @Named(DAY_STATS_USE_CASE) dayStatsUseCase: BaseListUseCase,
        @Named(WEEK_STATS_USE_CASE) weekStatsUseCase: BaseListUseCase,
        @Named(MONTH_STATS_USE_CASE) monthStatsUseCase: BaseListUseCase,
        @Named(YEAR_STATS_USE_CASE) yearStatsUseCase: BaseListUseCase
    ): Map&lt;StatsSection, BaseListUseCase&gt; {
<span class="nc" id="L383">        return mapOf(</span>
<span class="nc" id="L384">                StatsSection.INSIGHTS to insightsUseCase,</span>
<span class="nc" id="L385">                StatsSection.DAYS to dayStatsUseCase,</span>
<span class="nc" id="L386">                StatsSection.WEEKS to weekStatsUseCase,</span>
<span class="nc" id="L387">                StatsSection.MONTHS to monthStatsUseCase,</span>
<span class="nc" id="L388">                StatsSection.YEARS to yearStatsUseCase</span>
        )
    }

    /**
     * Provides a singleton usecase that represents the Year stats screen.
     * @param useCases build the use cases for the YEARS granularity
     */
    @Provides
    @Singleton
    @Named(BLOCK_DETAIL_USE_CASE)
    fun provideDetailStatsUseCase(
        statsStore: StatsStore,
        @Named(BG_THREAD) bgDispatcher: CoroutineDispatcher,
        @Named(UI_THREAD) mainDispatcher: CoroutineDispatcher,
        statsSiteProvider: StatsSiteProvider,
        @Named(BLOCK_DETAIL_USE_CASES) useCases: List&lt;@JvmSuppressWildcards BaseStatsUseCase&lt;*, *&gt;&gt;,
        uiModelMapper: UiModelMapper
    ): BaseListUseCase {
<span class="nc" id="L407">        return BaseListUseCase(</span>
<span class="nc" id="L408">                bgDispatcher,</span>
<span class="nc" id="L409">                mainDispatcher,</span>
<span class="nc" id="L410">                statsSiteProvider,</span>
<span class="nc" id="L411">                useCases,</span>
<span class="nc" id="L412">                { statsStore.getPostDetailTypes() },</span>
<span class="nc" id="L413">                uiModelMapper::mapDetailStats</span>
        )
    }

    /**
     * Provides a singleton usecase that represents Views And Visitors Details screen.
     * Update this method when you want to add more blocks to this detail screen.
     * @param useCases build the use cases for the YEARS granularity
     */
    @Provides
    @Singleton
    @Named(BLOCK_VIEWS_AND_VISITORS_USE_CASES)
    fun provideViewsAndVisitorsDetailUseCases(
        viewsAndVisitorsGranularUseCaseFactory: ViewsAndVisitorsGranularUseCaseFactory,
        referrersUseCaseFactory: ReferrersUseCaseFactory,
        countryViewsUseCaseFactory: CountryViewsUseCaseFactory
    ): List&lt;@JvmSuppressWildcards GranularUseCaseFactory&gt; {
<span class="nc" id="L430">        return listOf(</span>
<span class="nc" id="L431">                viewsAndVisitorsGranularUseCaseFactory,</span>
<span class="nc" id="L432">                referrersUseCaseFactory,</span>
<span class="nc" id="L433">                countryViewsUseCaseFactory</span>
        )
    }

    /**
     * Provides a singleton usecase that represents the Year stats screen.
     * @param useCases build the use cases for the YEARS granularity
     */
    @Provides
    @Singleton
    @Named(VIEWS_AND_VISITORS_USE_CASE)
    fun provideViewsAndVisitorsDetailUseCase(
        @Named(BG_THREAD) bgDispatcher: CoroutineDispatcher,
        @Named(UI_THREAD) mainDispatcher: CoroutineDispatcher,
        statsSiteProvider: StatsSiteProvider,
        @Named(BLOCK_VIEWS_AND_VISITORS_USE_CASES)
        useCasesFactories: List&lt;@JvmSuppressWildcards GranularUseCaseFactory&gt;,
        uiModelMapper: UiModelMapper
    ): BaseListUseCase {
<span class="nc" id="L452">        return BaseListUseCase(</span>
<span class="nc" id="L453">                bgDispatcher,</span>
<span class="nc" id="L454">                mainDispatcher,</span>
<span class="nc" id="L455">                statsSiteProvider,</span>
<span class="nc" id="L456">                useCasesFactories.map { it.build(WEEKS, BLOCK_DETAIL) },</span>
<span class="nc bnc" id="L457" title="All 2 branches missed.">                {</span>
<span class="nc" id="L458">                    listOf(InsightType.VIEWS_AND_VISITORS, TimeStatsType.REFERRERS, TimeStatsType.COUNTRIES)</span>
                },
<span class="nc" id="L460">                uiModelMapper::mapTimeStats</span>
        )
    }

    /**
     * Provides a list of use cases for the Total Likes detail screen in Stats. Modify this method when you want to
     * add more blocks to the likes detail screen.
     */
    @Provides
    @Singleton
    @Named(TOTAL_LIKES_DETAIL_USE_CASES)
    fun provideLikesDetailUseCases(
        totalLikesUseCaseFactory: TotalLikesGranularUseCaseFactory,
        postsAndPagesUseCaseFactory: PostsAndPagesUseCaseFactory
    ): List&lt;@JvmSuppressWildcards GranularUseCaseFactory&gt; {
<span class="nc" id="L475">        return listOf(</span>
<span class="nc" id="L476">                totalLikesUseCaseFactory,</span>
<span class="nc" id="L477">                postsAndPagesUseCaseFactory</span>
        )
    }

    /**
     * Provides a singleton usecase that represents the Likes detail screen.
     * @param useCases build the use cases for the DAYS granularity
     */
    @Provides
    @Singleton
    @Named(TOTAL_LIKES_DETAIL_USE_CASE)
    fun provideLikesDetailStatsUseCase(
        @Named(BG_THREAD) bgDispatcher: CoroutineDispatcher,
        @Named(UI_THREAD) mainDispatcher: CoroutineDispatcher,
        statsSiteProvider: StatsSiteProvider,
        @Named(TOTAL_LIKES_DETAIL_USE_CASES) useCasesFactories: List&lt;@JvmSuppressWildcards GranularUseCaseFactory&gt;,
        uiModelMapper: UiModelMapper
    ): BaseListUseCase {
<span class="nc" id="L495">        return BaseListUseCase(</span>
<span class="nc" id="L496">                bgDispatcher,</span>
<span class="nc" id="L497">                mainDispatcher,</span>
<span class="nc" id="L498">                statsSiteProvider,</span>
<span class="nc" id="L499">                useCasesFactories.map { it.build(WEEKS, BLOCK_DETAIL) },</span>
<span class="nc bnc" id="L500" title="All 2 branches missed.">                { listOf(InsightType.TOTAL_LIKES, TimeStatsType.POSTS_AND_PAGES) },</span>
<span class="nc" id="L501">                uiModelMapper::mapTimeStats</span>
        )
    }

    /**
     * Provides a list of use cases for the Total Comments detail screen in Stats. Modify this method when you want to
     * add more blocks to the comments detail screen.
     */
    @Provides
    @Singleton
    @Named(TOTAL_COMMENTS_DETAIL_USE_CASES)
    fun provideCommentsDetailUseCases(
        totalCommentsUseCaseFactory: TotalCommentsUseCaseFactory,
        authorsCommentsUseCase: AuthorsCommentsUseCase,
        postsCommentsUseCase: PostsCommentsUseCase
    ): List&lt;@JvmSuppressWildcards BaseStatsUseCase&lt;*, *&gt;&gt; {
<span class="nc" id="L517">        return listOf(</span>
<span class="nc" id="L518">                totalCommentsUseCaseFactory.build(BLOCK_DETAIL),</span>
<span class="nc" id="L519">                authorsCommentsUseCase,</span>
<span class="nc" id="L520">                postsCommentsUseCase</span>
        )
    }

    /**
     * Provides a singleton usecase that represents the Comments detail screen.
     * @param useCases build the use cases for the DAYS granularity
     */
    @Provides
    @Singleton
    @Named(TOTAL_COMMENTS_DETAIL_USE_CASE)
    fun provideCommentsDetailStatsUseCase(
        @Named(BG_THREAD) bgDispatcher: CoroutineDispatcher,
        @Named(UI_THREAD) mainDispatcher: CoroutineDispatcher,
        statsSiteProvider: StatsSiteProvider,
        @Named(TOTAL_COMMENTS_DETAIL_USE_CASES) useCases: List&lt;@JvmSuppressWildcards BaseStatsUseCase&lt;*, *&gt;&gt;,
        uiModelMapper: UiModelMapper
    ): BaseListUseCase {
<span class="nc" id="L538">        return BaseListUseCase(</span>
<span class="nc" id="L539">                bgDispatcher,</span>
<span class="nc" id="L540">                mainDispatcher,</span>
<span class="nc" id="L541">                statsSiteProvider,</span>
<span class="nc" id="L542">                useCases,</span>
<span class="nc bnc" id="L543" title="All 2 branches missed.">                { listOf(InsightType.TOTAL_COMMENTS, InsightType.AUTHORS_COMMENTS, InsightType.POSTS_COMMENTS) },</span>
<span class="nc" id="L544">                uiModelMapper::mapInsights</span>
        )
    }

    /**
     * Provides a list of use cases for the Total Followers detail screen in Stats. Modify this method when you want to
     * add more blocks to the followers detail screen.
     */
    @Provides
    @Singleton
    @Named(TOTAL_FOLLOWERS_DETAIL_USE_CASES)
    fun provideFollowersDetailUseCases(
        totalFollowersUseCaseFactory: TotalFollowersUseCaseFactory,
        followerTypesUseCase: FollowerTypesUseCase,
        followersUseCaseFactory: FollowersUseCaseFactory
<span class="nc" id="L559">    ): List&lt;@JvmSuppressWildcards BaseStatsUseCase&lt;*, *&gt;&gt; = listOf(</span>
<span class="nc" id="L560">            totalFollowersUseCaseFactory.build(VIEW_ALL),</span>
<span class="nc" id="L561">            followerTypesUseCase,</span>
<span class="nc" id="L562">            followersUseCaseFactory.build(BLOCK_DETAIL)</span>
<span class="nc" id="L563">    )</span>

    /**
     * Provides a singleton usecase that represents the Followers detail screen.
     * @param useCases build the use cases
     */
    @Provides
    @Singleton
    @Named(TOTAL_FOLLOWERS_DETAIL_USE_CASE)
    fun provideFollowersDetailStatsUseCase(
        @Named(BG_THREAD) bgDispatcher: CoroutineDispatcher,
        @Named(UI_THREAD) mainDispatcher: CoroutineDispatcher,
        statsSiteProvider: StatsSiteProvider,
        @Named(TOTAL_FOLLOWERS_DETAIL_USE_CASES) useCases: List&lt;@JvmSuppressWildcards BaseStatsUseCase&lt;*, *&gt;&gt;,
        uiModelMapper: UiModelMapper
<span class="nc" id="L578">    ): BaseListUseCase = BaseListUseCase(</span>
<span class="nc" id="L579">            bgDispatcher,</span>
<span class="nc" id="L580">            mainDispatcher,</span>
<span class="nc" id="L581">            statsSiteProvider,</span>
<span class="nc" id="L582">            useCases,</span>
<span class="nc bnc" id="L583" title="All 2 branches missed.">            { listOf(InsightType.TOTAL_FOLLOWERS, InsightType.FOLLOWER_TYPES, InsightType.FOLLOWERS) },</span>
<span class="nc" id="L584">            uiModelMapper::mapInsights</span>
<span class="nc" id="L585">    )</span>

    @Provides
    @Singleton
    fun provideSharedPrefs(@ApplicationContext context: Context): SharedPreferences {
<span class="fc" id="L590">        return PreferenceManager.getDefaultSharedPreferences(context)</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span>Generated by the Android Gradle plugin 7.1.1</div></body></html>