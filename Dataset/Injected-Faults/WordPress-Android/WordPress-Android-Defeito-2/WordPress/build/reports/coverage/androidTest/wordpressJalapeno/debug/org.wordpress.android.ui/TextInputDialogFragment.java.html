<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>TextInputDialogFragment.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">wordpressJalapenoDebug</a> &gt; <a href="index.source.html" class="el_package">org.wordpress.android.ui</a> &gt; <span class="el_source">TextInputDialogFragment.java</span></div><h1>TextInputDialogFragment.java</h1><pre class="source lang-java linenums">package org.wordpress.android.ui;

import android.app.Dialog;
import android.content.DialogInterface;
import android.os.Bundle;
import android.text.TextUtils;
import android.view.LayoutInflater;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;

import androidx.annotation.NonNull;
import androidx.appcompat.app.AlertDialog;
import androidx.fragment.app.DialogFragment;

import com.google.android.material.dialog.MaterialAlertDialogBuilder;

import org.wordpress.android.R;
import org.wordpress.android.util.AppLog;
import org.wordpress.android.widgets.WPTextView;

<span class="nc" id="L22">public class TextInputDialogFragment extends DialogFragment {</span>
    private static final String TITLE_TAG = &quot;title&quot;;
    private static final String INITIAL_TEXT_TAG = &quot;initial_text&quot;;
    private static final String HINT_TAG = &quot;hint&quot;;
    private static final String IS_MULTILINE_TAG = &quot;is_multiline&quot;;
    private static final String CALLBACK_ID_TAG = &quot;callback_id&quot;;
    private static final String IS_INPUT_ENABLED = &quot;is_input_enabled&quot;;

    public static final String TAG = &quot;text_input_dialog_fragment&quot;;

<span class="nc" id="L32">    public int callbackId = -1;</span>

    public static TextInputDialogFragment newInstance(String title,
                                                      String initialText,
                                                      String hint,
                                                      boolean isMultiline,
                                                      boolean isInputEnabled,
                                                      int callbackId) {
<span class="nc" id="L40">        TextInputDialogFragment textInputDialogFragment = new TextInputDialogFragment();</span>
<span class="nc" id="L41">        Bundle args = new Bundle();</span>

<span class="nc" id="L43">        args.putString(TITLE_TAG, title);</span>
<span class="nc" id="L44">        args.putString(INITIAL_TEXT_TAG, initialText);</span>
<span class="nc" id="L45">        args.putString(HINT_TAG, hint);</span>
<span class="nc" id="L46">        args.putBoolean(IS_MULTILINE_TAG, isMultiline);</span>
<span class="nc" id="L47">        args.putInt(CALLBACK_ID_TAG, callbackId);</span>
<span class="nc" id="L48">        args.putBoolean(IS_INPUT_ENABLED, isInputEnabled);</span>

<span class="nc" id="L50">        textInputDialogFragment.setArguments(args);</span>
<span class="nc" id="L51">        return textInputDialogFragment;</span>
    }

    @Override
    public Dialog onCreateDialog(Bundle savedInstanceState) {
<span class="nc" id="L56">        LayoutInflater layoutInflater = LayoutInflater.from(getActivity());</span>
        //noinspection InflateParams
<span class="nc" id="L58">        View promptView = layoutInflater.inflate(R.layout.text_input_dialog, null);</span>
<span class="nc" id="L59">        AlertDialog.Builder alertDialogBuilder = new MaterialAlertDialogBuilder(getActivity());</span>
<span class="nc" id="L60">        alertDialogBuilder.setView(promptView);</span>

<span class="nc" id="L62">        final WPTextView textView = promptView.findViewById(R.id.text_input_dialog_label);</span>
<span class="nc" id="L63">        final EditText editText = promptView.findViewById(R.id.text_input_dialog_input);</span>
<span class="nc" id="L64">        final WPTextView hintView = promptView.findViewById(R.id.text_input_dialog_hint);</span>

<span class="nc" id="L66">        Bundle args = getArguments();</span>
<span class="nc" id="L67">        String title = args.getString(TITLE_TAG);</span>
<span class="nc" id="L68">        String hint = args.getString(HINT_TAG);</span>
<span class="nc" id="L69">        boolean isMultiline = args.getBoolean(IS_MULTILINE_TAG);</span>
<span class="nc" id="L70">        String initialText = args.getString(INITIAL_TEXT_TAG);</span>
<span class="nc" id="L71">        callbackId = args.getInt(CALLBACK_ID_TAG);</span>

<span class="nc" id="L73">        textView.setText(title);</span>
<span class="nc bnc" id="L74" title="All 2 branches missed.">        if (!TextUtils.isEmpty(hint)) {</span>
<span class="nc" id="L75">            hintView.setText(hint);</span>
        } else {
<span class="nc" id="L77">            hintView.setVisibility(View.GONE);</span>
        }

<span class="nc bnc" id="L80" title="All 2 branches missed.">        if (!isMultiline) {</span>
<span class="nc" id="L81">            editText.setMaxLines(1);</span>
        }
<span class="nc bnc" id="L83" title="All 2 branches missed.">        if (!TextUtils.isEmpty(initialText)) {</span>
<span class="nc" id="L84">            editText.setText(initialText);</span>
<span class="nc" id="L85">            editText.setSelection(0, initialText.length());</span>
        }

<span class="nc" id="L88">        boolean isInputEnabled = args.getBoolean(IS_INPUT_ENABLED);</span>
<span class="nc" id="L89">        editText.setEnabled(isInputEnabled);</span>

<span class="nc" id="L91">        alertDialogBuilder.setCancelable(true)</span>
<span class="nc" id="L92">                          .setPositiveButton(android.R.string.ok, (dialog, id) -&gt; {</span>
<span class="nc bnc" id="L93" title="All 2 branches missed.">                              if (getTargetFragment() instanceof Callback) {</span>
<span class="nc" id="L94">                                  ((Callback) getTargetFragment())</span>
<span class="nc" id="L95">                                          .onSuccessfulInput(editText.getText().toString(), callbackId);</span>
                              } else {
<span class="nc" id="L97">                                  AppLog.e(AppLog.T.UTILS,</span>
                                           &quot;Target fragment doesn't implement TextInputDialogFragment.Callback&quot;);
                              }
<span class="nc" id="L100">                          })</span>
<span class="nc" id="L101">                          .setNegativeButton(R.string.cancel,</span>
<span class="nc" id="L102">                                  (dialog, id) -&gt; dialog.cancel());</span>

<span class="nc" id="L104">        AlertDialog alertDialog = alertDialogBuilder.create();</span>
<span class="nc" id="L105">        alertDialog.setOnShowListener(dialog -&gt; {</span>
<span class="nc" id="L106">            Button positiveButton = alertDialog.getButton(AlertDialog.BUTTON_POSITIVE);</span>
<span class="nc bnc" id="L107" title="All 2 branches missed.">            if (positiveButton != null) {</span>
<span class="nc" id="L108">                positiveButton.setEnabled(isInputEnabled);</span>
            }
<span class="nc" id="L110">        });</span>

<span class="nc" id="L112">        return alertDialog;</span>
    }

    @Override public void onDismiss(@NonNull DialogInterface dialog) {
<span class="nc" id="L116">        super.onDismiss(dialog);</span>
<span class="nc bnc" id="L117" title="All 2 branches missed.">        if (getTargetFragment() instanceof Callback) {</span>
<span class="nc" id="L118">            ((Callback) getTargetFragment()).onTextInputDialogDismissed(callbackId);</span>
        } else {
<span class="nc" id="L120">            AppLog.e(AppLog.T.UTILS,</span>
                    &quot;Target fragment doesn't implement TextInputDialogFragment.Callback&quot;);
        }
<span class="nc" id="L123">    }</span>

    public interface Callback {
        void onSuccessfulInput(String input, int callbackId);
        void onTextInputDialogDismissed(int callbackId);
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span>Generated by the Android Gradle plugin 7.1.1</div></body></html>