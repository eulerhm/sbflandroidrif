<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>BlockDiffCallback.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">wordpressJalapenoDebug</a> &gt; <a href="index.source.html" class="el_package">org.wordpress.android.ui.stats.refresh</a> &gt; <span class="el_source">BlockDiffCallback.kt</span></div><h1>BlockDiffCallback.kt</h1><pre class="source lang-java linenums">package org.wordpress.android.ui.stats.refresh

import androidx.recyclerview.widget.DiffUtil.Callback
import org.wordpress.android.ui.stats.refresh.BlockDiffCallback.BlockListPayload.COLUMNS_VALUE_CHANGED
import org.wordpress.android.ui.stats.refresh.BlockDiffCallback.BlockListPayload.EXPAND_CHANGED
import org.wordpress.android.ui.stats.refresh.BlockDiffCallback.BlockListPayload.SELECTED_BAR_CHANGED
import org.wordpress.android.ui.stats.refresh.BlockDiffCallback.BlockListPayload.SELECTED_COLUMN_CHANGED
import org.wordpress.android.ui.stats.refresh.BlockDiffCallback.BlockListPayload.TAB_CHANGED
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.BarChartItem
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Chips
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Columns
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.ExpandableItem
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.TabsItem
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.ACTION_CARD
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.ACTIVITY_ITEM
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.BAR_CHART
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.BIG_TITLE
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.CHART_LEGEND
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.CHART_LEGENDS_BLUE
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.CHART_LEGENDS_PURPLE
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.CHIPS
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.COLUMNS
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.DIALOG_BUTTONS
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.DIVIDER
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.EMPTY
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.EXPANDABLE_ITEM
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.GUIDE_CARD
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.HEADER
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.IMAGE_ITEM
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.INFO
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.LINE_CHART
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.LINK
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.LIST_ITEM
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.LIST_ITEM_WITH_ICON
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.LIST_ITEM_WITH_IMAGE
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.LOADING_ITEM
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.MAP
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.MAP_LEGEND
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.PIE_CHART
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.QUICK_SCAN_ITEM
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.REFERRED_ITEM
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.TABS
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.TAG_ITEM
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.TEXT
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.TITLE
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.TITLE_WITH_MORE
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.VALUES_ITEM
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.VALUE_ITEM
import org.wordpress.android.ui.stats.refresh.lists.sections.BlockListItem.Type.VALUE_WITH_CHART_ITEM

<span class="nc" id="L52">class BlockDiffCallback(</span>
<span class="nc" id="L53">    private val oldList: List&lt;BlockListItem&gt;,</span>
<span class="nc" id="L54">    private val newList: List&lt;BlockListItem&gt;</span>
<span class="nc" id="L55">) : Callback() {</span>
    enum class BlockListPayload {
<span class="nc" id="L57">        EXPAND_CHANGED, TAB_CHANGED, SELECTED_COLUMN_CHANGED, SELECTED_BAR_CHANGED, COLUMNS_VALUE_CHANGED</span>
    }

    override fun areItemsTheSame(oldItemPosition: Int, newItemPosition: Int): Boolean {
<span class="nc" id="L61">        val newItem = newList[newItemPosition]</span>
<span class="nc" id="L62">        val oldItem = oldList[oldItemPosition]</span>
<span class="nc bnc" id="L63" title="All 2 branches missed.">        return if (oldItem.type == newItem.type) {</span>
<span class="nc bnc" id="L64" title="All 2 branches missed.">            when (oldItem.type) {</span>
                LIST_ITEM_WITH_IMAGE,
                LIST_ITEM_WITH_ICON,
                EXPANDABLE_ITEM,
                TABS,
                COLUMNS,
                CHIPS,
                BAR_CHART,
                PIE_CHART,
                LINE_CHART,
                ACTIVITY_ITEM,
<span class="nc bnc" id="L75" title="All 2 branches missed.">                LIST_ITEM -&gt; oldItem.itemId == newItem.itemId</span>
                LINK,
                TEXT,
                INFO,
                HEADER,
                TITLE,
                TITLE_WITH_MORE,
                BIG_TITLE,
                VALUE_ITEM,
                VALUE_WITH_CHART_ITEM,
                VALUES_ITEM,
                DIVIDER,
                LOADING_ITEM,
                MAP,
                MAP_LEGEND,
                CHART_LEGEND,
                CHART_LEGENDS_BLUE,
                CHART_LEGENDS_PURPLE,
                REFERRED_ITEM,
                QUICK_SCAN_ITEM,
                DIALOG_BUTTONS,
                GUIDE_CARD,
                TAG_ITEM,
                IMAGE_ITEM,
                ACTION_CARD,
<span class="nc" id="L100">                EMPTY -&gt; oldItem == newItem</span>
            }
        } else {
<span class="nc" id="L103">            false</span>
        }
    }

<span class="nc" id="L107">    override fun getOldListSize(): Int = oldList.size</span>

<span class="nc" id="L109">    override fun getNewListSize(): Int = newList.size</span>

    override fun areContentsTheSame(oldItemPosition: Int, newItemPosition: Int): Boolean {
<span class="nc" id="L112">        return oldList[oldItemPosition] == newList[newItemPosition]</span>
    }

    override fun getChangePayload(oldItemPosition: Int, newItemPosition: Int): Any? {
<span class="nc" id="L116">        val newItem = newList[newItemPosition]</span>
<span class="nc" id="L117">        val oldItem = oldList[oldItemPosition]</span>
<span class="nc" id="L118">        return when {</span>
<span class="nc bnc" id="L119" title="All 6 branches missed.">            newItem is ExpandableItem &amp;&amp; oldItem is ExpandableItem &amp;&amp; oldItem.isExpanded != newItem.isExpanded -&gt;</span>
<span class="nc" id="L120">                EXPAND_CHANGED</span>
<span class="nc bnc" id="L121" title="All 6 branches missed.">            newItem is TabsItem &amp;&amp; oldItem is TabsItem &amp;&amp; oldItem.selectedTabPosition != newItem.selectedTabPosition -&gt;</span>
<span class="nc" id="L122">                TAB_CHANGED</span>
<span class="nc bnc" id="L123" title="All 6 branches missed.">            newItem is Columns &amp;&amp; oldItem is Columns &amp;&amp; oldItem.selectedColumn != newItem.selectedColumn -&gt;</span>
<span class="nc" id="L124">                return SELECTED_COLUMN_CHANGED</span>
<span class="nc bnc" id="L125" title="All 6 branches missed.">            newItem is Columns &amp;&amp; oldItem is Columns &amp;&amp; oldItem.columns != newItem.columns -&gt;</span>
<span class="nc" id="L126">                return COLUMNS_VALUE_CHANGED</span>
<span class="nc bnc" id="L127" title="All 6 branches missed.">            newItem is BarChartItem &amp;&amp; oldItem is BarChartItem &amp;&amp; oldItem.selectedItem != newItem.selectedItem -&gt;</span>
<span class="nc" id="L128">                return SELECTED_BAR_CHANGED</span>
<span class="nc bnc" id="L129" title="All 6 branches missed.">            newItem is Chips &amp;&amp; oldItem is Chips &amp;&amp; oldItem.selectedColumn != newItem.selectedColumn -&gt;</span>
<span class="nc" id="L130">                return SELECTED_COLUMN_CHANGED</span>
<span class="nc" id="L131">            else -&gt; null</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span>Generated by the Android Gradle plugin 7.1.1</div></body></html>