<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>HomepageSettingsUiState.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">wordpressJalapenoDebug</a> &gt; <a href="index.source.html" class="el_package">org.wordpress.android.ui.prefs.homepage</a> &gt; <span class="el_source">HomepageSettingsUiState.kt</span></div><h1>HomepageSettingsUiState.kt</h1><pre class="source lang-java linenums">package org.wordpress.android.ui.prefs.homepage

import org.wordpress.android.R
import org.wordpress.android.fluxc.model.SiteModel
import org.wordpress.android.ui.prefs.homepage.HomepageSettingsDataLoader.LoadingResult
import org.wordpress.android.ui.prefs.homepage.HomepageSettingsDataLoader.LoadingResult.Error
import org.wordpress.android.ui.prefs.homepage.HomepageSettingsDataLoader.LoadingResult.Loading
import org.wordpress.android.ui.prefs.homepage.HomepageSettingsDataLoader.LoadingResult.Data
import org.wordpress.android.ui.prefs.homepage.HomepageSettingsUiState.ValidityResult.Invalid
import org.wordpress.android.ui.prefs.homepage.HomepageSettingsUiState.ValidityResult.Valid

<span class="nc" id="L12">data class HomepageSettingsUiState(</span>
<span class="nc" id="L13">    val isClassicBlogState: Boolean,</span>
<span class="nc" id="L14">    val siteModel: SiteModel,</span>
<span class="nc" id="L15">    val isSaveEnabled: Boolean = true,</span>
<span class="nc" id="L16">    val isLoading: Boolean = false,</span>
<span class="nc" id="L17">    val error: Int? = null,</span>
<span class="nc" id="L18">    val pageOnFrontState: HomepageSettingsSelectorUiState? = null,</span>
<span class="nc" id="L19">    val pageForPostsState: HomepageSettingsSelectorUiState? = null</span>
) {
    fun updateWithLoadingResult(
        loadingResult: LoadingResult,
        pageForPostsId: Long?,
        pageOnFrontId: Long?
    ): HomepageSettingsUiState {
<span class="nc" id="L26">        return when (loadingResult) {</span>
<span class="nc bnc" id="L27" title="All 2 branches missed.">            is Loading -&gt; {</span>
<span class="nc" id="L28">                this.copy(isLoading = true, error = null)</span>
            }
<span class="nc bnc" id="L30" title="All 2 branches missed.">            is Error -&gt; this.copy(isLoading = false, error = loadingResult.message)</span>
<span class="nc" id="L31">            is Data -&gt; this.copy(</span>
<span class="nc" id="L32">                    isLoading = false,</span>
<span class="nc" id="L33">                    error = null,</span>
<span class="nc" id="L34">                    pageForPostsState = HomepageSettingsSelectorUiState.Builder.build(</span>
<span class="nc" id="L35">                            loadingResult.pages,</span>
<span class="nc" id="L36">                            pageForPostsId</span>
                    ),
<span class="nc" id="L38">                    pageOnFrontState = HomepageSettingsSelectorUiState.Builder.build(loadingResult.pages, pageOnFrontId)</span>
            )
        }
    }

    fun updateWithError(message: Int): HomepageSettingsUiState {
<span class="nc" id="L44">        return this.copy(error = message, isLoading = false, isSaveEnabled = true)</span>
    }

    fun updateWithLoading(): HomepageSettingsUiState {
<span class="nc" id="L48">        return this.copy(error = null, isLoading = true, isSaveEnabled = false)</span>
    }

    fun updateWithPageForPosts(pageForPostsId: Int): HomepageSettingsUiState {
<span class="nc bnc" id="L52" title="All 2 branches missed.">        return if (pageForPostsState != null) {</span>
<span class="nc" id="L53">            val validityResult = validate(newPageForPostsId = pageForPostsId)</span>
<span class="nc" id="L54">            copy(</span>
<span class="nc" id="L55">                    pageForPostsState = pageForPostsState.selectItem(pageForPostsId),</span>
<span class="nc" id="L56">                    error = validityResult.printErrorOrNull(),</span>
<span class="nc" id="L57">                    isSaveEnabled = validityResult is Valid</span>
            )
        } else {
<span class="nc" id="L60">            this</span>
        }
    }

    fun updateWithPageOnFront(pageOnFrontId: Int): HomepageSettingsUiState {
<span class="nc bnc" id="L65" title="All 2 branches missed.">        return if (pageOnFrontState != null) {</span>
<span class="nc" id="L66">            val validityResult = validate(newPageOnFrontId = pageOnFrontId)</span>
<span class="nc" id="L67">            copy(</span>
<span class="nc" id="L68">                    pageOnFrontState = pageOnFrontState.selectItem(pageOnFrontId),</span>
<span class="nc" id="L69">                    error = validityResult.printErrorOrNull(),</span>
<span class="nc" id="L70">                    isSaveEnabled = validityResult is Valid</span>
            )
        } else {
<span class="nc" id="L73">            this</span>
        }
    }

    fun updateClassicBlogState(isClassicBlogState: Boolean): HomepageSettingsUiState {
<span class="nc bnc" id="L78" title="All 2 branches missed.">        val validityResult = if (isClassicBlogState) Valid else validate()</span>
<span class="nc" id="L79">        return copy(</span>
<span class="nc" id="L80">                isClassicBlogState = isClassicBlogState,</span>
<span class="nc" id="L81">                error = validityResult.printErrorOrNull(),</span>
<span class="nc" id="L82">                isSaveEnabled = validityResult is Valid</span>
        )
    }

<span class="nc" id="L86">    private fun validate(newPageForPostsId: Int? = null, newPageOnFrontId: Int? = null): ValidityResult {</span>
<span class="nc bnc" id="L87" title="All 4 branches missed.">        val pageForPostsId = newPageForPostsId ?: pageForPostsState?.selectedItemId</span>
<span class="nc bnc" id="L88" title="All 4 branches missed.">        val pageOnFrontId = newPageOnFrontId ?: pageOnFrontState?.selectedItemId</span>
<span class="nc bnc" id="L89" title="All 6 branches missed.">        return if (pageForPostsId == null || pageOnFrontId == null || pageForPostsId != pageOnFrontId) {</span>
<span class="nc" id="L90">            Valid</span>
        } else {
<span class="nc" id="L92">            Invalid(R.string.site_settings_page_for_posts_and_homepage_cannot_be_equal)</span>
        }
    }

    sealed class ValidityResult {
<span class="nc" id="L97">        object Valid : ValidityResult()</span>
<span class="nc" id="L98">        data class Invalid(val error: Int) : ValidityResult()</span>

<span class="nc bnc" id="L100" title="All 4 branches missed.">        fun printErrorOrNull(): Int? = (this as? Invalid)?.error</span>
    }
<span class="nc" id="L102">}</span>
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span>Generated by the Android Gradle plugin 7.1.1</div></body></html>