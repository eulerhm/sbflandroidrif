<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>WPPrefView.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">wordpressJalapenoDebug</a> &gt; <a href="index.source.html" class="el_package">org.wordpress.android.widgets</a> &gt; <span class="el_source">WPPrefView.java</span></div><h1>WPPrefView.java</h1><pre class="source lang-java linenums">package org.wordpress.android.widgets;

import android.app.Activity;
import android.app.Dialog;
import android.app.DialogFragment;
import android.content.Context;
import android.content.res.TypedArray;
import android.os.Bundle;
import android.os.Parcelable;
import android.text.TextUtils;
import android.util.AttributeSet;
import android.util.SparseBooleanArray;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.CompoundButton;
import android.widget.EditText;
import android.widget.LinearLayout;
import android.widget.TextView;

import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.appcompat.app.AlertDialog;
import androidx.appcompat.widget.SwitchCompat;

import com.google.android.material.dialog.MaterialAlertDialogBuilder;

import org.wordpress.android.R;
import org.wordpress.android.util.StringUtils;

import java.io.Serializable;
import java.util.ArrayList;

/**
 * Single preference view which enables building preference screens without relying on Android's
 * built-in preference tools - enables us to be in the charge of the UI and customizing it as we
 * wish without fighting PreferenceFragment, etc.
 */

public class WPPrefView extends LinearLayout implements
        View.OnClickListener, CompoundButton.OnCheckedChangeListener {
<span class="nc" id="L42">    public enum PrefType {</span>
<span class="nc" id="L43">        TEXT, // text setting</span>
<span class="nc" id="L44">        TOGGLE, // boolean setting</span>
<span class="nc" id="L45">        CHECKLIST, // multi-select setting</span>
<span class="nc" id="L46">        RADIOLIST; // single-select setting</span>

        public static PrefType fromInt(int value) {
<span class="nc bnc" id="L49" title="All 4 branches missed.">            switch (value) {</span>
                case 1:
<span class="nc" id="L51">                    return TOGGLE;</span>
                case 2:
<span class="nc" id="L53">                    return CHECKLIST;</span>
                case 3:
<span class="nc" id="L55">                    return RADIOLIST;</span>
                default:
<span class="nc" id="L57">                    return TEXT;</span>
            }
        }
    }

    /*
     * listener for when the user changes the preference
     * TEXT use prefView.getTextEntry() to retrieve the updated setting
     * TOGGLE use prefView.isChecked() to retrieve the updated setting
     * RADIOLIST use prefView.getSelectedItem() to retrieve the updated setting
     * CHECKLIST use prefView.getSelectedItems() to retrieve the updated setting
     */
    public interface OnPrefChangedListener {
        void onPrefChanged(@NonNull WPPrefView prefView);
    }

<span class="nc" id="L73">    private PrefType mPrefType = PrefType.TEXT;</span>
<span class="nc" id="L74">    private final PrefListItems mListItems = new PrefListItems();</span>

    private TextView mHeadingTextView;
    private TextView mTitleTextView;
    private TextView mSummaryTextView;
    private SwitchCompat mToggleSwitch;

    private String mTextEntry;
    private String mTextDialogSubtitle;
    private OnPrefChangedListener mListener;

    private static final String KEY_LIST_ITEMS = &quot;prefview_listitems&quot;;
    private static final String KEY_SUPER_STATE = &quot;prefview_super_state&quot;;

    /*
     * single item when this is a list preference
     */
    public static class PrefListItem implements Serializable {
        private final String mItemName; // name to display for this item
        private final String mItemValue; // value for this item (can be same as name)
        private boolean mIsChecked; // whether this item is checked

<span class="nc" id="L96">        public PrefListItem(@NonNull String itemName, @NonNull String itemValue, boolean isChecked) {</span>
<span class="nc" id="L97">            mItemName = itemName;</span>
<span class="nc" id="L98">            mItemValue = itemValue;</span>
<span class="nc" id="L99">            mIsChecked = isChecked;</span>
<span class="nc" id="L100">        }</span>

        @SuppressWarnings(&quot;unused&quot;)
        public @NonNull String getItemName() {
<span class="nc" id="L104">            return mItemName;</span>
        }

        public @NonNull String getItemValue() {
<span class="nc" id="L108">            return mItemValue;</span>
        }
    }

    /*
     * all items when this is a list preference (both single- and multi-select)
     */
<span class="nc" id="L115">    public static class PrefListItems extends ArrayList&lt;PrefListItem&gt; {</span>
        private void setCheckedItems(@NonNull SparseBooleanArray checkedItems) {
<span class="nc bnc" id="L117" title="All 2 branches missed.">            for (int i = 0; i &lt; this.size(); i++) {</span>
<span class="nc" id="L118">                this.get(i).mIsChecked = checkedItems.get(i);</span>
            }
<span class="nc" id="L120">        }</span>

        // use this for RADIOLIST prefs to get the single-select item
        private PrefListItem getFirstSelectedItem() {
<span class="nc bnc" id="L124" title="All 2 branches missed.">            for (PrefListItem item : this) {</span>
<span class="nc bnc" id="L125" title="All 2 branches missed.">                if (item.mIsChecked) {</span>
<span class="nc" id="L126">                    return item;</span>
                }
<span class="nc" id="L128">            }</span>
<span class="nc" id="L129">            return null;</span>
        }

        // use this for CHECKLIST prefs to get all selected items
        private @NonNull PrefListItems getSelectedItems() {
<span class="nc" id="L134">            PrefListItems selectedItems = new PrefListItems();</span>
<span class="nc bnc" id="L135" title="All 2 branches missed.">            for (PrefListItem item : this) {</span>
<span class="nc bnc" id="L136" title="All 2 branches missed.">                if (item.mIsChecked) {</span>
<span class="nc" id="L137">                    selectedItems.add(item);</span>
                }
<span class="nc" id="L139">            }</span>
<span class="nc" id="L140">            return selectedItems;</span>
        }

        // use this with RADIOLIST prefs to select only the passed name
        public void setSelectedName(@NonNull String selectedName) {
<span class="nc bnc" id="L145" title="All 2 branches missed.">            for (PrefListItem item : this) {</span>
<span class="nc" id="L146">                item.mIsChecked = StringUtils.equals(selectedName, item.mItemName);</span>
<span class="nc" id="L147">            }</span>
<span class="nc" id="L148">        }</span>

        public boolean removeItems(@NonNull PrefListItems items) {
<span class="nc" id="L151">            boolean isChanged = false;</span>
<span class="nc bnc" id="L152" title="All 2 branches missed.">            for (PrefListItem item : items) {</span>
<span class="nc" id="L153">                int i = indexOfValue(item.getItemValue());</span>
<span class="nc bnc" id="L154" title="All 2 branches missed.">                if (i &gt; -1) {</span>
<span class="nc" id="L155">                    this.remove(i);</span>
<span class="nc" id="L156">                    isChanged = true;</span>
                }
<span class="nc" id="L158">            }</span>
<span class="nc" id="L159">            return isChanged;</span>
        }

        private int indexOfValue(@NonNull String value) {
<span class="nc bnc" id="L163" title="All 2 branches missed.">            for (int i = 0; i &lt; this.size(); i++) {</span>
<span class="nc bnc" id="L164" title="All 2 branches missed.">                if (this.get(i).getItemValue().equals(value)) {</span>
<span class="nc" id="L165">                    return i;</span>
                }
            }
<span class="nc" id="L168">            return -1;</span>
        }

        public boolean containsValue(@NonNull String value) {
<span class="nc bnc" id="L172" title="All 2 branches missed.">            return indexOfValue(value) &gt; -1;</span>
        }
    }

    /*
     * Wrapper that will allow us to preserve type of PrefListItems when serializing it
     */
    public static class PrefListItemsWrapper implements Serializable {
        private PrefListItems mList;

        public PrefListItems getList() {
<span class="nc" id="L183">            return mList;</span>
        }

<span class="nc" id="L186">        PrefListItemsWrapper(PrefListItems mList) {</span>
<span class="nc" id="L187">            this.mList = mList;</span>
<span class="nc" id="L188">        }</span>
    }

    public WPPrefView(Context context) {
<span class="nc" id="L192">        super(context);</span>
<span class="nc" id="L193">        initView(context, null);</span>
<span class="nc" id="L194">    }</span>

    public WPPrefView(Context context, AttributeSet attrs) {
<span class="nc" id="L197">        super(context, attrs);</span>
<span class="nc" id="L198">        initView(context, attrs);</span>
<span class="nc" id="L199">    }</span>

    public WPPrefView(Context context, AttributeSet attrs, int defStyleAttr) {
<span class="nc" id="L202">        super(context, attrs, defStyleAttr);</span>
<span class="nc" id="L203">        initView(context, attrs);</span>
<span class="nc" id="L204">    }</span>

    public WPPrefView(Context context, AttributeSet attrs, int defStyleAttr, int defStyleRes) {
<span class="nc" id="L207">        super(context, attrs, defStyleAttr, defStyleRes);</span>
<span class="nc" id="L208">        initView(context, attrs);</span>
<span class="nc" id="L209">    }</span>

    private void initView(Context context, AttributeSet attrs) {
<span class="nc" id="L212">        ViewGroup view = (ViewGroup) inflate(context, R.layout.wppref_view, this);</span>

<span class="nc" id="L214">        ViewGroup container = view.findViewById(R.id.container);</span>
<span class="nc" id="L215">        mHeadingTextView = view.findViewById(R.id.text_heading);</span>
<span class="nc" id="L216">        mTitleTextView = view.findViewById(R.id.text_title);</span>
<span class="nc" id="L217">        mSummaryTextView = view.findViewById(R.id.text_summary);</span>
<span class="nc" id="L218">        mToggleSwitch = view.findViewById(R.id.switch_view);</span>

<span class="nc" id="L220">        container.setOnClickListener(this);</span>

<span class="nc bnc" id="L222" title="All 2 branches missed.">        if (attrs != null) {</span>
<span class="nc" id="L223">            TypedArray a = context.getTheme().obtainStyledAttributes(</span>
                    attrs,
                    R.styleable.wpPrefView,
                    0, 0);
            try {
<span class="nc" id="L228">                int prefTypeInt = a.getInteger(R.styleable.wpPrefView_wpPrefType, 0);</span>
<span class="nc" id="L229">                String heading = a.getString(R.styleable.wpPrefView_wpHeading);</span>
<span class="nc" id="L230">                String title = a.getString(R.styleable.wpPrefView_wpTitle);</span>
<span class="nc" id="L231">                String summary = a.getString(R.styleable.wpPrefView_wpSummary);</span>
<span class="nc" id="L232">                String dialogSubtitle = a.getString(R.styleable.wpPrefView_wpTextDialogSubtitle);</span>
<span class="nc" id="L233">                boolean showDivider = a.getBoolean(R.styleable.wpPrefView_wpShowDivider, true);</span>

<span class="nc" id="L235">                setPrefType(PrefType.fromInt(prefTypeInt));</span>
<span class="nc" id="L236">                setHeading(heading);</span>
<span class="nc" id="L237">                setTitle(title);</span>
<span class="nc" id="L238">                setSummary(summary);</span>
<span class="nc" id="L239">                setTextDialogSubtitle(dialogSubtitle);</span>

<span class="nc" id="L241">                View divider = view.findViewById(R.id.divider);</span>
<span class="nc bnc" id="L242" title="All 2 branches missed.">                divider.setVisibility(showDivider ? View.VISIBLE : View.GONE);</span>
            } finally {
<span class="nc" id="L244">                a.recycle();</span>
            }
        }
<span class="nc" id="L247">    }</span>

    @Override
    public Parcelable onSaveInstanceState() {
<span class="nc" id="L251">        Bundle bundle = new Bundle();</span>
<span class="nc" id="L252">        bundle.putSerializable(KEY_LIST_ITEMS, new PrefListItemsWrapper(mListItems));</span>
<span class="nc" id="L253">        bundle.putParcelable(KEY_SUPER_STATE, super.onSaveInstanceState());</span>
<span class="nc" id="L254">        return bundle;</span>
    }

    @Override
    public void onRestoreInstanceState(Parcelable state) {
<span class="nc bnc" id="L259" title="All 2 branches missed.">        if (state instanceof Bundle) {</span>
<span class="nc" id="L260">            Bundle bundle = (Bundle) state;</span>
<span class="nc" id="L261">            PrefListItemsWrapper listWrapper = (PrefListItemsWrapper) bundle.getSerializable(KEY_LIST_ITEMS);</span>
<span class="nc bnc" id="L262" title="All 2 branches missed.">            if (listWrapper != null) {</span>
<span class="nc" id="L263">                PrefListItems items = listWrapper.getList();</span>
<span class="nc" id="L264">                setListItems(items);</span>
            }
<span class="nc" id="L266">            state = bundle.getParcelable(KEY_SUPER_STATE);</span>
        }
<span class="nc" id="L268">        super.onRestoreInstanceState(state);</span>
<span class="nc" id="L269">    }</span>

    public void setOnPrefChangedListener(OnPrefChangedListener listener) {
<span class="nc" id="L272">        mListener = listener;</span>
<span class="nc" id="L273">    }</span>

    private void doPrefChanged() {
<span class="nc bnc" id="L276" title="All 2 branches missed.">        if (mListener != null) {</span>
<span class="nc" id="L277">            mListener.onPrefChanged(this);</span>
        }
<span class="nc" id="L279">    }</span>

    private void setPrefType(@NonNull PrefType prefType) {
<span class="nc" id="L282">        mPrefType = prefType;</span>

<span class="nc bnc" id="L284" title="All 2 branches missed.">        boolean isToggle = mPrefType == PrefType.TOGGLE;</span>
<span class="nc bnc" id="L285" title="All 2 branches missed.">        mToggleSwitch.setVisibility(isToggle ? View.VISIBLE : View.GONE);</span>
<span class="nc bnc" id="L286" title="All 2 branches missed.">        mToggleSwitch.setOnCheckedChangeListener(isToggle ? this : null);</span>
<span class="nc" id="L287">    }</span>

    /*
     * blue heading text that should appear above the preference when it's the first in a group
     */
    public void setHeading(String heading) {
<span class="nc" id="L293">        mHeadingTextView.setText(heading);</span>
<span class="nc bnc" id="L294" title="All 2 branches missed.">        mHeadingTextView.setVisibility(TextUtils.isEmpty(heading) ? GONE : VISIBLE);</span>
<span class="nc" id="L295">    }</span>

    /*
     * title above the preference and below the optional heading
     */
    private void setTitle(String title) {
<span class="nc" id="L301">        mTitleTextView.setText(title);</span>
<span class="nc" id="L302">    }</span>

    /*
     * optional description that appears below the title
     */
    public void setSummary(String summary) {
<span class="nc" id="L308">        mSummaryTextView.setText(summary);</span>
<span class="nc bnc" id="L309" title="All 2 branches missed.">        mSummaryTextView.setVisibility(TextUtils.isEmpty(summary) ? View.GONE : View.VISIBLE);</span>
<span class="nc" id="L310">    }</span>

    /*
     * subtitle on the dialog that appears when the PrefType is TEXT
     */
    private void setTextDialogSubtitle(String subtitle) {
<span class="nc" id="L316">        mTextDialogSubtitle = subtitle;</span>
<span class="nc" id="L317">    }</span>

    /*
     * current entry when the PrefType is TEXT
     */
    public String getTextEntry() {
<span class="nc" id="L323">        return mTextEntry;</span>
    }

    public void setTextEntry(String entry) {
<span class="nc" id="L327">        mTextEntry = entry;</span>
<span class="nc" id="L328">        setSummary(entry);</span>
<span class="nc" id="L329">    }</span>

    /*
     * returns whether or not the switch is checked when the PrefType is TOGGLE
     */
    public boolean isChecked() {
<span class="nc bnc" id="L335" title="All 4 branches missed.">        return mPrefType == PrefType.TOGGLE &amp;&amp; mToggleSwitch.isChecked();</span>
    }

    public void setChecked(boolean checked) {
<span class="nc" id="L339">        mToggleSwitch.setChecked(checked);</span>
<span class="nc" id="L340">    }</span>

    public void setListItems(@NonNull PrefListItems items) {
<span class="nc" id="L343">        mListItems.clear();</span>
<span class="nc" id="L344">        mListItems.addAll(items);</span>
<span class="nc" id="L345">    }</span>

    public PrefListItem getSelectedItem() {
<span class="nc" id="L348">        return mListItems.getFirstSelectedItem();</span>
    }

    public PrefListItems getSelectedItems() {
<span class="nc" id="L352">        return mListItems.getSelectedItems();</span>
    }

    @Override
    public void onClick(View v) {
<span class="nc bnc" id="L357" title="All 3 branches missed.">        switch (mPrefType) {</span>
            case CHECKLIST:
            case RADIOLIST:
            case TEXT:
<span class="nc bnc" id="L361" title="All 2 branches missed.">                if (getContext() instanceof Activity) {</span>
<span class="nc" id="L362">                    Activity activity = (Activity) getContext();</span>
<span class="nc" id="L363">                    WPPrefDialogFragment fragment = WPPrefDialogFragment.newInstance(this);</span>
<span class="nc" id="L364">                    activity.getFragmentManager().executePendingTransactions();</span>
<span class="nc" id="L365">                    fragment.show(activity.getFragmentManager(), &quot;pref_dialog_tag&quot;);</span>
<span class="nc" id="L366">                }</span>
                break;
            case TOGGLE:
<span class="nc bnc" id="L369" title="All 2 branches missed.">                mToggleSwitch.setChecked(!mToggleSwitch.isChecked());</span>
                break;
        }
<span class="nc" id="L372">    }</span>

    /*
     * user clicked the toggle switch
     */
    @Override
    public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
<span class="nc" id="L379">        doPrefChanged();</span>
<span class="nc" id="L380">    }</span>

    /*
     * user clicked the view when the PrefType is TEXT - shows a dialog enabling the user
     * to edit the entry
     */
    private Dialog getTextDialog() {
<span class="nc" id="L387">        LayoutInflater inflater = LayoutInflater.from(getContext());</span>
        //noinspection InflateParams
<span class="nc" id="L389">        ViewGroup customView = (ViewGroup) inflater.inflate(R.layout.wppref_text_dialog, null);</span>
<span class="nc" id="L390">        final EditText editText = customView.findViewById(R.id.edit);</span>
<span class="nc" id="L391">        editText.setText(mSummaryTextView.getText());</span>
<span class="nc" id="L392">        TextView txtSubtitle = customView.findViewById(R.id.text_subtitle);</span>
<span class="nc bnc" id="L393" title="All 2 branches missed.">        if (!TextUtils.isEmpty(mTextDialogSubtitle)) {</span>
<span class="nc" id="L394">            txtSubtitle.setText(mTextDialogSubtitle);</span>
        } else {
<span class="nc" id="L396">            txtSubtitle.setVisibility(GONE);</span>
        }

<span class="nc" id="L399">        AlertDialog.Builder builder = new MaterialAlertDialogBuilder(getContext())</span>
<span class="nc" id="L400">                .setTitle(mTitleTextView.getText())</span>
<span class="nc" id="L401">                .setView(customView)</span>
<span class="nc" id="L402">                .setNegativeButton(android.R.string.cancel, null)</span>
<span class="nc" id="L403">                .setPositiveButton(android.R.string.ok, (dialog, which) -&gt; {</span>
<span class="nc" id="L404">                    setTextEntry(editText.getText().toString());</span>
<span class="nc" id="L405">                    doPrefChanged();</span>
<span class="nc" id="L406">                });</span>
<span class="nc" id="L407">        return builder.create();</span>
    }

    /*
     * user clicked the view when the PrefType is CHECKLIST - shows a multi-select dialog enabling
     * the user to modify the list
     */
    private Dialog getCheckListDialog() {
<span class="nc" id="L415">        CharSequence[] items = new CharSequence[mListItems.size()];</span>
<span class="nc" id="L416">        boolean[] checkedItems = new boolean[mListItems.size()];</span>
<span class="nc bnc" id="L417" title="All 2 branches missed.">        for (int i = 0; i &lt; mListItems.size(); i++) {</span>
<span class="nc" id="L418">            items[i] = mListItems.get(i).mItemName;</span>
<span class="nc" id="L419">            checkedItems[i] = mListItems.get(i).mIsChecked;</span>
        }

<span class="nc" id="L422">        AlertDialog.Builder builder = new MaterialAlertDialogBuilder(getContext())</span>
<span class="nc" id="L423">                .setTitle(mTitleTextView.getText())</span>
<span class="nc" id="L424">                .setNegativeButton(android.R.string.cancel, null)</span>
<span class="nc" id="L425">                .setPositiveButton(android.R.string.ok, (dialog, which) -&gt; {</span>
<span class="nc" id="L426">                    SparseBooleanArray userCheckedItems =</span>
<span class="nc" id="L427">                            ((AlertDialog) dialog).getListView().getCheckedItemPositions();</span>
<span class="nc" id="L428">                    mListItems.setCheckedItems(userCheckedItems);</span>
<span class="nc" id="L429">                    doPrefChanged();</span>
<span class="nc" id="L430">                })</span>
<span class="nc" id="L431">                .setMultiChoiceItems(items, checkedItems, null);</span>
<span class="nc" id="L432">        return builder.create();</span>
    }

    /*
     * user clicked the view when the PrefType is RADIOLIST - shows a single-select dialog enabling
     * the user to choose a different item
     */
    private Dialog getRadioListDialog() {
<span class="nc" id="L440">        CharSequence[] items = new CharSequence[mListItems.size()];</span>
<span class="nc" id="L441">        int selectedPos = 0;</span>
<span class="nc bnc" id="L442" title="All 2 branches missed.">        for (int i = 0; i &lt; mListItems.size(); i++) {</span>
<span class="nc" id="L443">            items[i] = mListItems.get(i).mItemName;</span>
<span class="nc bnc" id="L444" title="All 2 branches missed.">            if (mListItems.get(i).mIsChecked) {</span>
<span class="nc" id="L445">                selectedPos = i;</span>
            }
        }

<span class="nc" id="L449">        AlertDialog.Builder builder = new MaterialAlertDialogBuilder(getContext())</span>
<span class="nc" id="L450">                .setTitle(mTitleTextView.getText())</span>
<span class="nc" id="L451">                .setNegativeButton(android.R.string.cancel, null)</span>
<span class="nc" id="L452">                .setPositiveButton(android.R.string.ok, (dialog, which) -&gt; {</span>
<span class="nc" id="L453">                    SparseBooleanArray checkedItems =</span>
<span class="nc" id="L454">                            ((AlertDialog) dialog).getListView().getCheckedItemPositions();</span>
<span class="nc" id="L455">                    mListItems.setCheckedItems(checkedItems);</span>
<span class="nc" id="L456">                    PrefListItem item = mListItems.getFirstSelectedItem();</span>
<span class="nc bnc" id="L457" title="All 2 branches missed.">                    setSummary(item != null ? item.mItemName : &quot;&quot;);</span>
<span class="nc" id="L458">                    doPrefChanged();</span>
<span class="nc" id="L459">                })</span>
<span class="nc" id="L460">                .setSingleChoiceItems(items, selectedPos, null);</span>
<span class="nc" id="L461">        return builder.create();</span>
    }

    public static class WPPrefDialogFragment extends DialogFragment {
        private int mPrefViewId;
        private static final String ARG_PREF_VIEW_ID = &quot;pref_view_ID&quot;;

<span class="nc" id="L468">        public WPPrefDialogFragment() {</span>
            // noop
<span class="nc" id="L470">        }</span>

        public static WPPrefDialogFragment newInstance(@NonNull WPPrefView prefView) {
<span class="nc" id="L473">            WPPrefDialogFragment frag = new WPPrefDialogFragment();</span>

<span class="nc" id="L475">            Bundle args = new Bundle();</span>
<span class="nc" id="L476">            args.putInt(ARG_PREF_VIEW_ID, prefView.getId());</span>
<span class="nc" id="L477">            frag.setArguments(args);</span>

<span class="nc" id="L479">            return frag;</span>
        }

        @Override
        public void onCreate(Bundle savedInstanceState) {
<span class="nc" id="L484">            super.onCreate(savedInstanceState);</span>
<span class="nc" id="L485">            mPrefViewId = getArguments().getInt(ARG_PREF_VIEW_ID);</span>
<span class="nc" id="L486">        }</span>

        private
        @Nullable
        WPPrefView getPrefView() {
<span class="nc bnc" id="L491" title="All 2 branches missed.">            if (getActivity() != null) {</span>
<span class="nc" id="L492">                return (WPPrefView) getActivity().findViewById(mPrefViewId);</span>
            }
<span class="nc" id="L494">            return null;</span>
        }

        @Override
        public Dialog onCreateDialog(Bundle savedInstanceState) {
<span class="nc" id="L499">            WPPrefView prefView = getPrefView();</span>
<span class="nc bnc" id="L500" title="All 2 branches missed.">            if (prefView != null) {</span>
<span class="nc bnc" id="L501" title="All 4 branches missed.">                switch (prefView.mPrefType) {</span>
                    case TEXT:
<span class="nc" id="L503">                        return prefView.getTextDialog();</span>
                    case RADIOLIST:
<span class="nc" id="L505">                        return prefView.getRadioListDialog();</span>
                    case CHECKLIST:
<span class="nc" id="L507">                        return prefView.getCheckListDialog();</span>
                }
            }
<span class="nc" id="L510">            return super.onCreateDialog(savedInstanceState);</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span>Generated by the Android Gradle plugin 7.1.1</div></body></html>