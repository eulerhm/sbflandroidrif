<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ViewPagerFragment.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">wordpressJalapenoDebug</a> &gt; <a href="index.source.html" class="el_package">org.wordpress.android.ui</a> &gt; <span class="el_source">ViewPagerFragment.kt</span></div><h1>ViewPagerFragment.kt</h1><pre class="source lang-java linenums">package org.wordpress.android.ui

import android.view.View
import androidx.annotation.LayoutRes
import androidx.fragment.app.Fragment
import org.wordpress.android.R

abstract class ViewPagerFragment : Fragment {
<span class="nc" id="L9">    constructor() : super()</span>

<span class="nc" id="L11">    constructor(@LayoutRes contentLayoutId: Int) : super(contentLayoutId)</span>

    companion object {
        @JvmStatic
        fun restoreOriginalViewId(view: View) {
<span class="nc" id="L16">            val originalId = view.getTag(R.id.original_view_pager_fragment_id_tag_key)</span>
<span class="nc bnc" id="L17" title="All 2 branches missed.">            if (originalId != null) {</span>
<span class="nc" id="L18">                view.id = originalId as Int</span>
            }
<span class="nc" id="L20">        }</span>

        @JvmStatic
        fun setUniqueIdToView(view: View): Int {
<span class="nc" id="L24">            val newId = View.generateViewId()</span>
<span class="nc bnc" id="L25" title="All 2 branches missed.">            if (view.getTag(R.id.original_view_pager_fragment_id_tag_key) == null) {</span>
<span class="nc" id="L26">                view.setTag(R.id.original_view_pager_fragment_id_tag_key, view.id)</span>
            }
<span class="nc" id="L28">            view.id = newId</span>
<span class="nc" id="L29">            return newId</span>
        }
    }

    /**
     * Provide a scrollable view that will be used with &quot;lift on scroll&quot; functionality of AppBar in parent
     * fragment/activity. ID will of the scrollable view be set to unique one using View.generateViewId()
     */
    abstract fun getScrollableViewForUniqueIdProvision(): View?

    /**
     * It is expected that onResume will be called when the fragment in ViewPager becomes active.
     * This is default behavior of FragmentStateAdapter and FragmentStatePagerAdapter with
     * BEHAVIOR_RESUME_ONLY_CURRENT_FRAGMENT flag.
     *
     * onResume() is called after fragment view is created, so it's safe to change it's ID as long as you got a
     * reference to it beforehand, or in all cases when View Binding using Kotlin Extensions, since the first time you
     * access a view by original ID it's stored in cache for future access.
     */
    override fun onResume() {
<span class="nc" id="L49">        super.onResume()</span>

        // set unique ID to scrollable view and notify parent fragment/activity
<span class="nc" id="L52">        val scrollableContainer = getScrollableViewForUniqueIdProvision()</span>
<span class="nc bnc" id="L53" title="All 2 branches missed.">        scrollableContainer?.let {</span>
<span class="nc" id="L54">            val host = when {</span>
<span class="nc bnc" id="L55" title="All 2 branches missed.">                parentFragment is ScrollableViewInitializedListener -&gt; {</span>
<span class="nc" id="L56">                    parentFragment</span>
                }
<span class="nc bnc" id="L58" title="All 2 branches missed.">                activity is ScrollableViewInitializedListener -&gt; {</span>
<span class="nc" id="L59">                    activity</span>
                }
                else -&gt; {
<span class="nc" id="L62">                    null</span>
                }
            }
<span class="nc bnc" id="L65" title="All 2 branches missed.">            host?.let {</span>
<span class="nc bnc" id="L66" title="All 2 branches missed.">                (host as ScrollableViewInitializedListener).onScrollableViewInitialized(</span>
<span class="nc" id="L67">                        setUniqueIdToView(scrollableContainer)</span>
                )
<span class="nc" id="L69">            }</span>
        }
<span class="nc" id="L71">    }</span>

    override fun onPause() {
<span class="nc" id="L74">        super.onPause()</span>
<span class="nc" id="L75">        val scrollableContainer = getScrollableViewForUniqueIdProvision()</span>
<span class="nc bnc" id="L76" title="All 2 branches missed.">        scrollableContainer?.let {</span>
            // restore original view ID, so it's state could be restored correctly
<span class="nc" id="L78">            restoreOriginalViewId(scrollableContainer)</span>
<span class="nc" id="L79">        }</span>
<span class="nc" id="L80">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span>Generated by the Android Gradle plugin 7.1.1</div></body></html>