<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Person.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">wordpressJalapenoDebug</a> &gt; <a href="index.source.html" class="el_package">org.wordpress.android.models</a> &gt; <span class="el_source">Person.java</span></div><h1>Person.java</h1><pre class="source lang-java linenums">package org.wordpress.android.models;

import androidx.annotation.Nullable;

import org.apache.commons.text.StringEscapeUtils;
import org.json.JSONException;
import org.json.JSONObject;
import org.wordpress.android.util.AppLog;
import org.wordpress.android.util.DateTimeUtils;
import org.wordpress.android.util.StringUtils;

public class Person {
<span class="nc" id="L13">    public enum PersonType {</span>
<span class="nc" id="L14">        USER, FOLLOWER, EMAIL_FOLLOWER, VIEWER</span>
    }

    private long mPersonID;
    private int mLocalTableBlogId;
    private String mDisplayName;
    private String mAvatarUrl;
    private PersonType mPersonType;

    // Only users have a role
    private String mRole;

    // Users, followers &amp; viewers has a username, email followers don't
    private String mUsername;

    // Only followers &amp; email followers have a subscribed date
    private String mSubscribed;

<span class="nc" id="L32">    public Person(long personID, int localTableBlogId) {</span>
<span class="nc" id="L33">        mPersonID = personID;</span>
<span class="nc" id="L34">        mLocalTableBlogId = localTableBlogId;</span>
<span class="nc" id="L35">    }</span>

    @Nullable
    public static Person userFromJSON(JSONObject json, int localTableBlogId) throws JSONException {
<span class="nc bnc" id="L39" title="All 2 branches missed.">        if (json == null) {</span>
<span class="nc" id="L40">            return null;</span>
        }

        // Response parameters are in: https://developer.wordpress.com/docs/api/1.1/get/sites/%24site/users/%24user_id/
        try {
<span class="nc" id="L45">            long personID = Long.parseLong(json.getString(&quot;ID&quot;));</span>
<span class="nc" id="L46">            Person person = new Person(personID, localTableBlogId);</span>
<span class="nc" id="L47">            person.setUsername(json.optString(&quot;login&quot;));</span>
<span class="nc" id="L48">            person.setDisplayName(StringEscapeUtils.unescapeHtml4(json.optString(&quot;name&quot;)));</span>
<span class="nc" id="L49">            person.setAvatarUrl(json.optString(&quot;avatar_URL&quot;));</span>
<span class="nc" id="L50">            person.mPersonType = PersonType.USER;</span>
            // We don't support multiple roles, so the first role is picked just as it's in Calypso
<span class="nc" id="L52">            String role = json.getJSONArray(&quot;roles&quot;).optString(0);</span>
<span class="nc" id="L53">            person.setRole(role);</span>

<span class="nc" id="L55">            return person;</span>
<span class="nc" id="L56">        } catch (NumberFormatException e) {</span>
<span class="nc" id="L57">            AppLog.e(AppLog.T.PEOPLE, &quot;The ID parsed from the JSON couldn't be converted to long: &quot; + e);</span>
        }

<span class="nc" id="L60">        return null;</span>
    }

    @Nullable
    public static Person followerFromJSON(JSONObject json, int localTableBlogId, boolean isEmailFollower)
            throws JSONException {
<span class="nc bnc" id="L66" title="All 2 branches missed.">        if (json == null) {</span>
<span class="nc" id="L67">            return null;</span>
        }

        // Response parameters are in: https://developer.wordpress.com/docs/api/1.1/get/sites/%24site/stats/followers/
        try {
<span class="nc" id="L72">            long personID = Long.parseLong(json.getString(&quot;ID&quot;));</span>
<span class="nc" id="L73">            Person person = new Person(personID, localTableBlogId);</span>
<span class="nc" id="L74">            person.setDisplayName(StringEscapeUtils.unescapeHtml4(json.optString(&quot;label&quot;)));</span>
<span class="nc" id="L75">            person.setUsername(json.optString(&quot;login&quot;));</span>
<span class="nc" id="L76">            person.setAvatarUrl(json.optString(&quot;avatar&quot;));</span>
<span class="nc" id="L77">            person.setSubscribed(json.optString(&quot;date_subscribed&quot;));</span>
<span class="nc bnc" id="L78" title="All 2 branches missed.">            person.mPersonType = isEmailFollower ? PersonType.EMAIL_FOLLOWER : PersonType.FOLLOWER;</span>

<span class="nc" id="L80">            return person;</span>
<span class="nc" id="L81">        } catch (NumberFormatException e) {</span>
<span class="nc" id="L82">            AppLog.e(AppLog.T.PEOPLE, &quot;The ID parsed from the JSON couldn't be converted to long: &quot; + e);</span>
        }

<span class="nc" id="L85">        return null;</span>
    }

    @Nullable
    public static Person viewerFromJSON(JSONObject json, int localTableBlogId) throws JSONException {
<span class="nc bnc" id="L90" title="All 2 branches missed.">        if (json == null) {</span>
<span class="nc" id="L91">            return null;</span>
        }

        // Similar response parameters in:
        // https://developer.wordpress.com/docs/api/1.1/get/sites/%24site/users/%24user_id/
        try {
<span class="nc" id="L97">            long personID = Long.parseLong(json.getString(&quot;ID&quot;));</span>
<span class="nc" id="L98">            Person person = new Person(personID, localTableBlogId);</span>
<span class="nc" id="L99">            person.setUsername(json.optString(&quot;login&quot;));</span>
<span class="nc" id="L100">            person.setDisplayName(StringEscapeUtils.unescapeHtml4(json.optString(&quot;name&quot;)));</span>
<span class="nc" id="L101">            person.setAvatarUrl(json.optString(&quot;avatar_URL&quot;));</span>
<span class="nc" id="L102">            person.setPersonType(PersonType.VIEWER);</span>

<span class="nc" id="L104">            return person;</span>
<span class="nc" id="L105">        } catch (NumberFormatException e) {</span>
<span class="nc" id="L106">            AppLog.e(AppLog.T.PEOPLE, &quot;The ID parsed from the JSON couldn't be converted to long: &quot; + e);</span>
        }

<span class="nc" id="L109">        return null;</span>
    }

    public long getPersonID() {
<span class="nc" id="L113">        return mPersonID;</span>
    }

    public int getLocalTableBlogId() {
<span class="nc" id="L117">        return mLocalTableBlogId;</span>
    }

    public String getUsername() {
<span class="nc" id="L121">        return StringUtils.notNullStr(mUsername);</span>
    }

    public void setUsername(String username) {
<span class="nc" id="L125">        mUsername = username;</span>
<span class="nc" id="L126">    }</span>

    public String getDisplayName() {
<span class="nc" id="L129">        return StringUtils.notNullStr(mDisplayName);</span>
    }

    public void setDisplayName(String displayName) {
<span class="nc" id="L133">        mDisplayName = displayName;</span>
<span class="nc" id="L134">    }</span>

    public String getRole() {
<span class="nc" id="L137">        return mRole;</span>
    }

    public void setRole(String role) {
<span class="nc" id="L141">        mRole = role;</span>
<span class="nc" id="L142">    }</span>

    public String getAvatarUrl() {
<span class="nc" id="L145">        return StringUtils.notNullStr(mAvatarUrl);</span>
    }

    public void setAvatarUrl(String avatarUrl) {
<span class="nc" id="L149">        mAvatarUrl = avatarUrl;</span>
<span class="nc" id="L150">    }</span>

    public String getSubscribed() {
<span class="nc" id="L153">        return StringUtils.notNullStr(mSubscribed);</span>
    }

    public void setSubscribed(String subscribed) {
<span class="nc" id="L157">        mSubscribed = StringUtils.notNullStr(subscribed);</span>
<span class="nc" id="L158">    }</span>

    /*
     * converts iso8601 subscribed date to an actual java date
     */
    private transient java.util.Date mDateSubscribed;

    public java.util.Date getDateSubscribed() {
<span class="nc bnc" id="L166" title="All 2 branches missed.">        if (mDateSubscribed == null) {</span>
<span class="nc" id="L167">            mDateSubscribed = DateTimeUtils.dateFromIso8601(mSubscribed);</span>
        }
<span class="nc" id="L169">        return mDateSubscribed;</span>
    }

    public PersonType getPersonType() {
<span class="nc" id="L173">        return mPersonType;</span>
    }

    public void setPersonType(PersonType personType) {
<span class="nc" id="L177">        mPersonType = personType;</span>
<span class="nc" id="L178">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span>Generated by the Android Gradle plugin 7.1.1</div></body></html>