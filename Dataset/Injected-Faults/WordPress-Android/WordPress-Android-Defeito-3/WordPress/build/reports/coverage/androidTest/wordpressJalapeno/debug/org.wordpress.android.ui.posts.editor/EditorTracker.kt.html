<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>EditorTracker.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">wordpressJalapenoDebug</a> &gt; <a href="index.source.html" class="el_package">org.wordpress.android.ui.posts.editor</a> &gt; <span class="el_source">EditorTracker.kt</span></div><h1>EditorTracker.kt</h1><pre class="source lang-java linenums">package org.wordpress.android.ui.posts.editor

import android.content.Context
import android.net.Uri
import dagger.Reusable
import org.wordpress.android.analytics.AnalyticsTracker.Stat
import org.wordpress.android.editor.EditorFragmentAbstract.TrackableEvent
import org.wordpress.android.fluxc.model.SiteModel
import org.wordpress.android.ui.posts.editor.media.AddExistingMediaSource
import org.wordpress.android.util.AppLog
import org.wordpress.android.util.AppLog.T
import org.wordpress.android.util.analytics.AnalyticsTrackerWrapper
import org.wordpress.android.util.analytics.AnalyticsUtils
import javax.inject.Inject

<span class="fc" id="L16">@Reusable</span>
<span class="fc" id="L17">class EditorTracker @Inject constructor(</span>
<span class="fc" id="L18">    private val context: Context,</span>
<span class="fc" id="L19">    private val analyticsTrackerWrapper: AnalyticsTrackerWrapper</span>
) {
    /**
     * Analytics about media from device
     *
     * @param isNew Whether is a fresh media
     * @param isVideo Whether is a video or not
     * @param uri The URI of the media on the device, or null
     */
    fun trackAddMediaFromDevice(
        site: SiteModel,
        isNew: Boolean,
        isVideo: Boolean,
        uri: Uri?
    ) {
<span class="nc bnc" id="L34" title="All 2 branches missed.">        if (uri == null) {</span>
<span class="nc" id="L35">            AppLog.e(T.MEDIA, &quot;Cannot track new media events if both path and mediaURI are null!!&quot;)</span>
<span class="nc" id="L36">            return</span>
        }

<span class="nc" id="L39">        val properties = AnalyticsUtils.getMediaProperties(context, isVideo, uri, null)</span>
<span class="nc bnc" id="L40" title="All 2 branches missed.">        val currentStat: Stat = if (isVideo) {</span>
<span class="nc bnc" id="L41" title="All 2 branches missed.">            if (isNew) {</span>
<span class="nc" id="L42">                Stat.EDITOR_ADDED_VIDEO_NEW</span>
            } else {
<span class="nc" id="L44">                Stat.EDITOR_ADDED_VIDEO_VIA_DEVICE_LIBRARY</span>
            }
        } else {
<span class="nc bnc" id="L47" title="All 2 branches missed.">            if (isNew) {</span>
<span class="nc" id="L48">                Stat.EDITOR_ADDED_PHOTO_NEW</span>
            } else {
<span class="nc" id="L50">                Stat.EDITOR_ADDED_PHOTO_VIA_DEVICE_LIBRARY</span>
            }
        }

<span class="nc" id="L54">        AnalyticsUtils.trackWithSiteDetails(currentStat, site, properties)</span>
<span class="nc" id="L55">    }</span>

    /**
     * Analytics about media already available in the blog's library.
     * @param source where the media is being added from
     * @param isVideo if media is a video
     */
    fun trackAddMediaEvent(site: SiteModel, source: AddExistingMediaSource, isVideo: Boolean) {
<span class="nc bnc" id="L63" title="All 2 branches missed.">        val stat = when (source) {</span>
<span class="nc bnc" id="L64" title="All 2 branches missed.">            AddExistingMediaSource.WP_MEDIA_LIBRARY -&gt; if (isVideo) {</span>
<span class="nc" id="L65">                Stat.EDITOR_ADDED_VIDEO_VIA_WP_MEDIA_LIBRARY</span>
            } else {
<span class="nc" id="L67">                Stat.EDITOR_ADDED_PHOTO_VIA_WP_MEDIA_LIBRARY</span>
            }
<span class="nc" id="L69">            AddExistingMediaSource.STOCK_PHOTO_LIBRARY -&gt; Stat.EDITOR_ADDED_PHOTO_VIA_STOCK_MEDIA_LIBRARY</span>
        }
<span class="nc" id="L71">        AnalyticsUtils.trackWithSiteDetails(stat, site, null)</span>
<span class="nc" id="L72">    }</span>

    @JvmOverloads
<span class="nc" id="L75">    fun trackEditorEvent(</span>
        event: TrackableEvent,
        editorName: String,
<span class="nc" id="L78">        properties: Map&lt;String, String&gt; = mapOf()</span>
    ) {
<span class="nc bnc" id="L80" title="All 33 branches missed.">        val currentStat = when (event) {</span>
<span class="nc" id="L81">            TrackableEvent.BOLD_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_BOLD</span>
<span class="nc" id="L82">            TrackableEvent.BLOCKQUOTE_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_BLOCKQUOTE</span>
<span class="nc" id="L83">            TrackableEvent.ELLIPSIS_COLLAPSE_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_ELLIPSIS_COLLAPSE</span>
<span class="nc" id="L84">            TrackableEvent.ELLIPSIS_EXPAND_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_ELLIPSIS_EXPAND</span>
<span class="nc" id="L85">            TrackableEvent.HEADING_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_HEADING</span>
<span class="nc" id="L86">            TrackableEvent.HEADING_1_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_HEADING_1</span>
<span class="nc" id="L87">            TrackableEvent.HEADING_2_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_HEADING_2</span>
<span class="nc" id="L88">            TrackableEvent.HEADING_3_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_HEADING_3</span>
<span class="nc" id="L89">            TrackableEvent.HEADING_4_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_HEADING_4</span>
<span class="nc" id="L90">            TrackableEvent.HEADING_5_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_HEADING_5</span>
<span class="nc" id="L91">            TrackableEvent.HEADING_6_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_HEADING_6</span>
<span class="nc" id="L92">            TrackableEvent.HORIZONTAL_RULE_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_HORIZONTAL_RULE</span>
<span class="nc" id="L93">            TrackableEvent.FORMAT_ALIGN_LEFT_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_ALIGN_LEFT</span>
<span class="nc" id="L94">            TrackableEvent.FORMAT_ALIGN_CENTER_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_ALIGN_CENTER</span>
<span class="nc" id="L95">            TrackableEvent.FORMAT_ALIGN_RIGHT_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_ALIGN_RIGHT</span>
<span class="nc" id="L96">            TrackableEvent.HTML_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_HTML</span>
<span class="nc" id="L97">            TrackableEvent.IMAGE_EDITED -&gt; Stat.EDITOR_EDITED_IMAGE</span>
<span class="nc" id="L98">            TrackableEvent.ITALIC_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_ITALIC</span>
<span class="nc" id="L99">            TrackableEvent.LINK_ADDED_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_LINK_ADDED</span>
<span class="nc" id="L100">            TrackableEvent.LIST_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_LIST</span>
<span class="nc" id="L101">            TrackableEvent.LIST_ORDERED_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_LIST_ORDERED</span>
<span class="nc" id="L102">            TrackableEvent.LIST_UNORDERED_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_LIST_UNORDERED</span>
<span class="nc" id="L103">            TrackableEvent.MEDIA_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_IMAGE</span>
<span class="nc" id="L104">            TrackableEvent.NEXT_PAGE_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_NEXT_PAGE</span>
<span class="nc" id="L105">            TrackableEvent.PARAGRAPH_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_PARAGRAPH</span>
<span class="nc" id="L106">            TrackableEvent.PREFORMAT_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_PREFORMAT</span>
<span class="nc" id="L107">            TrackableEvent.READ_MORE_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_READ_MORE</span>
<span class="nc" id="L108">            TrackableEvent.STRIKETHROUGH_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_STRIKETHROUGH</span>
<span class="nc" id="L109">            TrackableEvent.UNDERLINE_BUTTON_TAPPED -&gt; Stat.EDITOR_TAPPED_UNDERLINE</span>
<span class="nc" id="L110">            TrackableEvent.REDO_TAPPED -&gt; Stat.EDITOR_TAPPED_REDO</span>
<span class="nc" id="L111">            TrackableEvent.UNDO_TAPPED -&gt; Stat.EDITOR_TAPPED_UNDO</span>
            TrackableEvent.EDITOR_GUTENBERG_UNSUPPORTED_BLOCK_WEBVIEW_CLOSED -&gt;
<span class="nc" id="L113">                Stat.EDITOR_GUTENBERG_UNSUPPORTED_BLOCK_WEBVIEW_CLOSED</span>
            TrackableEvent.EDITOR_GUTENBERG_UNSUPPORTED_BLOCK_WEBVIEW_SHOWN -&gt;
<span class="nc" id="L115">                Stat.EDITOR_GUTENBERG_UNSUPPORTED_BLOCK_WEBVIEW_SHOWN</span>
        }

<span class="nc" id="L118">        val updatedProperties = properties + (&quot;editor&quot; to editorName)</span>
<span class="nc" id="L119">        analyticsTrackerWrapper.track(currentStat, updatedProperties)</span>
<span class="nc" id="L120">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span>Generated by the Android Gradle plugin 7.1.1</div></body></html>