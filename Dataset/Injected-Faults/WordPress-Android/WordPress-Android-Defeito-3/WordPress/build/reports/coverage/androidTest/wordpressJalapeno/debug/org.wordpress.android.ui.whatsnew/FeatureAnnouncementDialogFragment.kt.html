<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>FeatureAnnouncementDialogFragment.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">wordpressJalapenoDebug</a> &gt; <a href="index.source.html" class="el_package">org.wordpress.android.ui.whatsnew</a> &gt; <span class="el_source">FeatureAnnouncementDialogFragment.kt</span></div><h1>FeatureAnnouncementDialogFragment.kt</h1><pre class="source lang-java linenums">package org.wordpress.android.ui.whatsnew

import android.app.Dialog
import android.content.Context
import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.TextView
import androidx.fragment.app.DialogFragment
import androidx.lifecycle.Observer
import androidx.lifecycle.ViewModelProvider
import androidx.recyclerview.widget.LinearLayoutManager
import androidx.recyclerview.widget.RecyclerView
import org.wordpress.android.R
import org.wordpress.android.WordPress
import org.wordpress.android.ui.WPWebViewActivity
import org.wordpress.android.util.extensions.setStatusBarAsSurfaceColor
import javax.inject.Inject

<span class="nc" id="L21">class FeatureAnnouncementDialogFragment : DialogFragment() {</span>
<span class="nc bnc" id="L22" title="All 2 branches missed.">    @Inject lateinit var viewModelFactory: ViewModelProvider.Factory</span>
    private lateinit var viewModel: FeatureAnnouncementViewModel

    companion object {
        const val TAG = &quot;FEATURE_ANNOUNCEMENT_DIALOG_FRAGMENT&quot;
    }

    override fun getTheme(): Int {
<span class="nc" id="L30">        return R.style.FeatureAnnouncementDialogFragment</span>
    }

    override fun onCreateDialog(savedInstanceState: Bundle?): Dialog {
<span class="nc" id="L34">        val dialog = super.onCreateDialog(savedInstanceState)</span>
<span class="nc" id="L35">        viewModel = ViewModelProvider(this, viewModelFactory)</span>
<span class="nc" id="L36">                .get(FeatureAnnouncementViewModel::class.java)</span>
<span class="nc" id="L37">        dialog.setStatusBarAsSurfaceColor()</span>
<span class="nc" id="L38">        return dialog</span>
    }

    override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {
<span class="nc" id="L42">        val view = inflater.inflate(R.layout.feature_announcement_dialog_fragment, container, false)</span>

<span class="nc" id="L44">        val progressIndicator = view.findViewById&lt;View&gt;(R.id.feature_list_progress_container)</span>
<span class="nc" id="L45">        val versionLabel = view.findViewById&lt;TextView&gt;(R.id.feature_announcement_version_label)</span>

<span class="nc" id="L47">        val closeButton = view.findViewById&lt;View&gt;(R.id.close_feature_announcement_button)</span>
<span class="nc bnc" id="L48" title="All 2 branches missed.">        closeButton.setOnClickListener { viewModel.onCloseDialogButtonPressed() }</span>

<span class="nc" id="L50">        val recyclerView = view.findViewById&lt;RecyclerView&gt;(R.id.feature_list)</span>
<span class="nc" id="L51">        recyclerView.layoutManager = LinearLayoutManager(recyclerView.context)</span>
<span class="nc" id="L52">        val featureAdapter = FeatureAnnouncementListAdapter(this)</span>
<span class="nc" id="L53">        recyclerView.adapter = featureAdapter</span>

<span class="nc bnc" id="L55" title="All 2 branches missed.">        viewModel.uiModel.observe(this, Observer {</span>
<span class="nc bnc" id="L56" title="All 2 branches missed.">            it?.let { uiModel -&gt;</span>
<span class="nc bnc" id="L57" title="All 2 branches missed.">                progressIndicator.visibility = if (uiModel.isProgressVisible) View.VISIBLE else View.GONE</span>
<span class="nc" id="L58">                versionLabel.text = getString(R.string.version_with_name_param, uiModel.appVersion)</span>
<span class="nc" id="L59">                featureAdapter.toggleFooterVisibility(uiModel.isFindOutMoreVisible)</span>
<span class="nc" id="L60">            }</span>
<span class="nc" id="L61">        })</span>

<span class="nc bnc" id="L63" title="All 2 branches missed.">        viewModel.onDialogClosed.observe(this, Observer {</span>
<span class="nc" id="L64">            dismiss()</span>
<span class="nc" id="L65">        })</span>

<span class="nc bnc" id="L67" title="All 2 branches missed.">        viewModel.onAnnouncementDetailsRequested.observe(this, Observer { detailsUrl -&gt;</span>
<span class="nc" id="L68">            WPWebViewActivity.openURL(context, detailsUrl)</span>
<span class="nc" id="L69">        })</span>

<span class="nc bnc" id="L71" title="All 2 branches missed.">        viewModel.featureItems.observe(this, Observer { featureItems -&gt;</span>
<span class="nc" id="L72">            featureAdapter.updateList(featureItems)</span>
<span class="nc" id="L73">        })</span>

<span class="nc bnc" id="L75" title="All 2 branches missed.">        viewModel.start()</span>
<span class="nc" id="L76">        return view</span>
    }

    override fun onAttach(context: Context) {
<span class="nc" id="L80">        super.onAttach(context)</span>
<span class="nc bnc" id="L81" title="All 2 branches missed.">        (requireActivity().applicationContext as WordPress).component().inject(this)</span>
<span class="nc" id="L82">    }</span>

    override fun onPause() {
<span class="nc" id="L85">        super.onPause()</span>
<span class="nc bnc" id="L86" title="All 2 branches missed.">        viewModel.onSessionPaused()</span>
<span class="nc" id="L87">    }</span>

    override fun onDestroy() {
<span class="nc" id="L90">        super.onDestroy()</span>
<span class="nc bnc" id="L91" title="All 2 branches missed.">        viewModel.onSessionEnded()</span>
<span class="nc" id="L92">    }</span>

    override fun onStart() {
<span class="nc" id="L95">        super.onStart()</span>
<span class="nc bnc" id="L96" title="All 2 branches missed.">        viewModel.onSessionStarted()</span>
<span class="nc" id="L97">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span>Generated by the Android Gradle plugin 7.1.1</div></body></html>