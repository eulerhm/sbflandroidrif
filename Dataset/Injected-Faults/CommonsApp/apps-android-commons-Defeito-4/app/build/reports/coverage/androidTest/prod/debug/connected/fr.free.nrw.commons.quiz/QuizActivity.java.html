<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>QuizActivity.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">prodDebug</a> &gt; <a href="index.source.html" class="el_package">fr.free.nrw.commons.quiz</a> &gt; <span class="el_source">QuizActivity.java</span></div><h1>QuizActivity.java</h1><pre class="source lang-java linenums">package fr.free.nrw.commons.quiz;

import android.content.Intent;
import android.os.Bundle;

import androidx.appcompat.app.AlertDialog;
import androidx.appcompat.app.AppCompatActivity;
import androidx.vectordrawable.graphics.drawable.VectorDrawableCompat;

import com.facebook.drawee.drawable.ProgressBarDrawable;
import com.facebook.drawee.generic.GenericDraweeHierarchyBuilder;

import fr.free.nrw.commons.databinding.ActivityQuizBinding;
import java.util.ArrayList;

import fr.free.nrw.commons.R;

<span class="nc" id="L18">public class QuizActivity extends AppCompatActivity {</span>

    private ActivityQuizBinding binding;
<span class="nc" id="L21">    private final QuizController quizController = new QuizController();</span>
<span class="nc" id="L22">    private ArrayList&lt;QuizQuestion&gt; quiz = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L23">    private int questionIndex = 0;</span>
    private int score;
    /**
     * isPositiveAnswerChecked : represents yes click event
     */
    private boolean isPositiveAnswerChecked;
    /**
     * isNegativeAnswerChecked : represents no click event
     */
    private boolean isNegativeAnswerChecked;

    @Override
    protected void onCreate(final Bundle savedInstanceState) {
<span class="nc" id="L36">        super.onCreate(savedInstanceState);</span>
<span class="nc" id="L37">        binding = ActivityQuizBinding.inflate(getLayoutInflater());</span>
<span class="nc" id="L38">        setContentView(binding.getRoot());</span>

<span class="nc" id="L40">        quizController.initialize(this);</span>
<span class="nc" id="L41">        setSupportActionBar(binding.toolbar.toolbar);</span>
<span class="nc" id="L42">        binding.nextButton.setOnClickListener(view -&gt; notKnowAnswer());</span>
<span class="nc" id="L43">        displayQuestion();</span>
<span class="nc" id="L44">    }</span>

    /**
     * to move to next question and check whether answer is selected or not
     */
    public void setNextQuestion(){
<span class="nc bnc" id="L50" title="All 6 branches missed.">        if ( questionIndex &lt;= quiz.size() &amp;&amp; (isPositiveAnswerChecked || isNegativeAnswerChecked)) {</span>
<span class="nc" id="L51">            evaluateScore();</span>
        }
<span class="nc" id="L53">    }</span>

    public void notKnowAnswer(){
<span class="nc" id="L56">        customAlert(&quot;Information&quot;, quiz.get(questionIndex).getAnswerMessage());</span>
<span class="nc" id="L57">    }</span>

    /**
     * to give warning before ending quiz
     */
    @Override
    public void onBackPressed() {
<span class="nc" id="L64">        new AlertDialog.Builder(this)</span>
<span class="nc" id="L65">            .setTitle(getResources().getString(R.string.warning))</span>
<span class="nc" id="L66">            .setMessage(getResources().getString(R.string.quiz_back_button))</span>
<span class="nc" id="L67">            .setPositiveButton(R.string.continue_message, (dialog, which) -&gt; {</span>
<span class="nc" id="L68">                final Intent intent = new Intent(this, QuizResultActivity.class);</span>
<span class="nc" id="L69">                dialog.dismiss();</span>
<span class="nc" id="L70">                intent.putExtra(&quot;QuizResult&quot;, score);</span>
<span class="nc" id="L71">                startActivity(intent);</span>
<span class="nc" id="L72">            })</span>
<span class="nc" id="L73">            .setNegativeButton(&quot;Cancel&quot;, (dialogInterface, i) -&gt; dialogInterface.dismiss())</span>
<span class="nc" id="L74">            .create()</span>
<span class="nc" id="L75">            .show();</span>
<span class="nc" id="L76">    }</span>

    /**
     * to display the question
     */
    public void displayQuestion() {
<span class="nc" id="L82">        quiz = quizController.getQuiz();</span>
<span class="nc" id="L83">        binding.question.questionText.setText(quiz.get(questionIndex).getQuestion());</span>
<span class="nc" id="L84">        binding.questionTitle.setText(</span>
<span class="nc" id="L85">            getResources().getString(R.string.question) +</span>
<span class="nc" id="L86">                quiz.get(questionIndex).getQuestionNumber()</span>
        );
<span class="nc" id="L88">        binding.question.questionImage.setHierarchy(GenericDraweeHierarchyBuilder</span>
<span class="nc" id="L89">                .newInstance(getResources())</span>
<span class="nc" id="L90">                .setFailureImage(VectorDrawableCompat.create(getResources(),</span>
<span class="nc" id="L91">                        R.drawable.ic_error_outline_black_24dp, getTheme()))</span>
<span class="nc" id="L92">                .setProgressBarImage(new ProgressBarDrawable())</span>
<span class="nc" id="L93">                .build());</span>

<span class="nc" id="L95">        binding.question.questionImage.setImageURI(quiz.get(questionIndex).getUrl());</span>
<span class="nc" id="L96">        isPositiveAnswerChecked = false;</span>
<span class="nc" id="L97">        isNegativeAnswerChecked = false;</span>
<span class="nc" id="L98">        binding.answer.quizPositiveAnswer.setOnClickListener(view -&gt; {</span>
<span class="nc" id="L99">            isPositiveAnswerChecked = true;</span>
<span class="nc" id="L100">            setNextQuestion();</span>
<span class="nc" id="L101">        });</span>
<span class="nc" id="L102">        binding.answer.quizNegativeAnswer.setOnClickListener(view -&gt; {</span>
<span class="nc" id="L103">            isNegativeAnswerChecked = true;</span>
<span class="nc" id="L104">            setNextQuestion();</span>
<span class="nc" id="L105">        });</span>
<span class="nc" id="L106">    }</span>

    /**
     * to evaluate score and check whether answer is correct or wrong
     */
    public void evaluateScore() {
<span class="nc bnc" id="L112" title="All 4 branches missed.">        if ((quiz.get(questionIndex).isAnswer() &amp;&amp; isPositiveAnswerChecked) ||</span>
<span class="nc bnc" id="L113" title="All 4 branches missed.">                (!quiz.get(questionIndex).isAnswer() &amp;&amp; isNegativeAnswerChecked) ){</span>
<span class="nc" id="L114">            customAlert(getResources().getString(R.string.correct),</span>
<span class="nc" id="L115">                quiz.get(questionIndex).getAnswerMessage());</span>
<span class="nc" id="L116">            score++;</span>
        } else {
<span class="nc" id="L118">            customAlert(getResources().getString(R.string.wrong),</span>
<span class="nc" id="L119">                quiz.get(questionIndex).getAnswerMessage());</span>
        }
<span class="nc" id="L121">    }</span>

    /**
     * to display explanation after each answer, update questionIndex and move to next question
     * @param title the alert title
     * @param Message the alert message
     */
    public void customAlert(final String title, final String Message) {
<span class="nc" id="L129">        new AlertDialog.Builder(this)</span>
<span class="nc" id="L130">            .setTitle(title)</span>
<span class="nc" id="L131">            .setMessage(Message)</span>
<span class="nc" id="L132">            .setPositiveButton(R.string.continue_message, (dialog, which) -&gt; {</span>
<span class="nc" id="L133">                questionIndex++;</span>
<span class="nc bnc" id="L134" title="All 2 branches missed.">                if (questionIndex == quiz.size()) {</span>
<span class="nc" id="L135">                    final Intent intent = new Intent(this, QuizResultActivity.class);</span>
<span class="nc" id="L136">                    dialog.dismiss();</span>
<span class="nc" id="L137">                    intent.putExtra(&quot;QuizResult&quot;, score);</span>
<span class="nc" id="L138">                    startActivity(intent);</span>
<span class="nc" id="L139">                } else {</span>
<span class="nc" id="L140">                    displayQuestion();</span>
                }
<span class="nc" id="L142">            })</span>
<span class="nc" id="L143">            .create()</span>
<span class="nc" id="L144">            .show();</span>
<span class="nc" id="L145">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span>Generated by the Android Gradle plugin 8.0.2</div></body></html>